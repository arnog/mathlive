{"version":3,"file":"mathlive.mjs","sources":["../src/common/types.ts","../src/core/font-metrics-data.ts","../src/core/font-metrics.ts","../src/core/mathstyle.ts","../src/core/context.ts","../src/core/svg-span.ts","../src/core/modes-utils.ts","../src/core/span.ts","../src/core/grapheme-splitter.ts","../src/core/tokenizer.ts","../src/core-definitions/definitions-utils.ts","../src/core/atom-class.ts","../src/core/color.ts","../src/core-atoms/group.ts","../src/core-atoms/spacing.ts","../src/core/delimiters.ts","../src/core-atoms/leftright.ts","../src/core-atoms/subsup.ts","../src/core-atoms/placeholder.ts","../src/core-atoms/error.ts","../src/core-atoms/macro.ts","../src/core/parser.ts","../src/core-atoms/accent.ts","../src/core-atoms/overunder.ts","../src/core-definitions/accents.ts","../src/core-atoms/enclose.ts","../src/core-definitions/enclose.ts","../src/core-atoms/array.ts","../src/core-definitions/environments.ts","../src/core-definitions/extensible-symbols.ts","../src/core-atoms/operator.ts","../src/core-atoms/surd.ts","../src/core-atoms/genfrac.ts","../src/core-atoms/delim.ts","../src/core-definitions/functions.ts","../src/core-definitions/mhchem.ts","../src/core-atoms/box.ts","../src/core-atoms/phantom.ts","../src/core-atoms/line.ts","../src/core-atoms/overlap.ts","../src/core-atoms/rule.ts","../src/core-definitions/styling.ts","../src/core-definitions/symbols.ts","../src/common/script-url.ts","../src/core/fonts.ts","../src/common/hash-code.ts","../src/common/stylesheet.ts","../src/editor-model/utils.ts","../src/addons/math-json.ts","../src/core/atom-utils.ts","../src/addons/math-ml.ts","../src/editor/atom-to-ascii-math.ts","../src/editor/atom-to-speakable-text.ts","../src/editor-model/listeners.ts","../src/editor-model/selection-utils.ts","../src/editor-model/model-private.ts","../src/core/modes-math.ts","../src/core-atoms/text.ts","../src/core/modes-text.ts","../src/editor/keyboard-layout.ts","../src/editor/keybindings-definitions.ts","../src/editor/keybindings.ts","../src/editor-mathfield/utils.ts","../src/editor-mathfield/buttons.ts","../src/editor/popover.ts","../src/core-atoms/command.ts","../src/editor-model/command-mode.ts","../src/editor-mathfield/render.ts","../src/editor/commands.ts","../src/editor-model/array.ts","../src/editor-model/delete.ts","../src/editor/shortcuts-definitions.ts","../src/editor/shortcuts.ts","../src/editor/parse-math-string.ts","../src/editor-model/styling.ts","../src/editor-model/selection.ts","../src/core-atoms/composition.ts","../src/editor-model/insert.ts","../src/editor-model/commands.ts","../src/editor/keyboard.ts","../src/editor/undo.ts","../src/editor/l10n-strings.ts","../src/editor/l10n.ts","../src/editor-model/find.ts","../src/editor/autocomplete.ts","../src/editor/speech.ts","../src/editor/a11y.ts","../src/editor/options.ts","../src/editor-mathfield/smartmode.ts","../src/editor-mathfield/keyboard-input.ts","../src/editor-mathfield/commands.ts","../src/editor-mathfield/styling.ts","../src/editor-mathfield/clipboard.ts","../src/editor-mathfield/pointer-input.ts","../src/editor/virtual-keyboard-utils.ts","../src/editor/virtual-keyboard-commands.ts","../src/editor-mathfield/mathfield-private.ts","../src/addons/auto-render.ts","../src/addons/debug.ts","../src/editor/speech-read-aloud.ts","../src/addons/definitions-metadata.ts","../src/public/mathfield-element.ts","../src/mathlive.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/explicit-module-boundary-types */\r\n\r\nexport function isArray(x: any): x is any[] {\r\n    return Array.isArray(x);\r\n}\r\n\r\nexport function isString(x: any): x is string {\r\n    return typeof x === 'string';\r\n}\r\n\r\nexport function isNumber(x: any): x is number {\r\n    return typeof x === 'number' && !Number.isNaN(x);\r\n}\r\n\r\nexport function isFunction(x: any): x is (...args: any[]) => void {\r\n    return typeof x === 'function';\r\n}\r\n","export default {\r\n    'AMS-Regular': {\r\n        '65': [0, 0.68889, 0, 0],\r\n        '66': [0, 0.68889, 0, 0],\r\n        '67': [0, 0.68889, 0, 0],\r\n        '68': [0, 0.68889, 0, 0],\r\n        '69': [0, 0.68889, 0, 0],\r\n        '70': [0, 0.68889, 0, 0],\r\n        '71': [0, 0.68889, 0, 0],\r\n        '72': [0, 0.68889, 0, 0],\r\n        '73': [0, 0.68889, 0, 0],\r\n        '74': [0.16667, 0.68889, 0, 0],\r\n        '75': [0, 0.68889, 0, 0],\r\n        '76': [0, 0.68889, 0, 0],\r\n        '77': [0, 0.68889, 0, 0],\r\n        '78': [0, 0.68889, 0, 0],\r\n        '79': [0.16667, 0.68889, 0, 0],\r\n        '80': [0, 0.68889, 0, 0],\r\n        '81': [0.16667, 0.68889, 0, 0],\r\n        '82': [0, 0.68889, 0, 0],\r\n        '83': [0, 0.68889, 0, 0],\r\n        '84': [0, 0.68889, 0, 0],\r\n        '85': [0, 0.68889, 0, 0],\r\n        '86': [0, 0.68889, 0, 0],\r\n        '87': [0, 0.68889, 0, 0],\r\n        '88': [0, 0.68889, 0, 0],\r\n        '89': [0, 0.68889, 0, 0],\r\n        '90': [0, 0.68889, 0, 0],\r\n        '107': [0, 0.68889, 0, 0],\r\n        '165': [0, 0.675, 0.025, 0],\r\n        '174': [0.15559, 0.69224, 0, 0],\r\n        '240': [0, 0.68889, 0, 0],\r\n        '295': [0, 0.68889, 0, 0],\r\n        '710': [0, 0.825, 0, 0],\r\n        '732': [0, 0.9, 0, 0],\r\n        '770': [0, 0.825, 0, 0],\r\n        '771': [0, 0.9, 0, 0],\r\n        '989': [0.08167, 0.58167, 0, 0],\r\n        '1008': [0, 0.43056, 0.04028, 0],\r\n        '8245': [0, 0.54986, 0, 0],\r\n        '8463': [0, 0.68889, 0, 0],\r\n        '8487': [0, 0.68889, 0, 0],\r\n        '8498': [0, 0.68889, 0, 0],\r\n        '8502': [0, 0.68889, 0, 0],\r\n        '8503': [0, 0.68889, 0, 0],\r\n        '8504': [0, 0.68889, 0, 0],\r\n        '8513': [0, 0.68889, 0, 0],\r\n        '8592': [-0.03598, 0.46402, 0, 0],\r\n        '8594': [-0.03598, 0.46402, 0, 0],\r\n        '8602': [-0.13313, 0.36687, 0, 0],\r\n        '8603': [-0.13313, 0.36687, 0, 0],\r\n        '8606': [0.01354, 0.52239, 0, 0],\r\n        '8608': [0.01354, 0.52239, 0, 0],\r\n        '8610': [0.01354, 0.52239, 0, 0],\r\n        '8611': [0.01354, 0.52239, 0, 0],\r\n        '8619': [0, 0.54986, 0, 0],\r\n        '8620': [0, 0.54986, 0, 0],\r\n        '8621': [-0.13313, 0.37788, 0, 0],\r\n        '8622': [-0.13313, 0.36687, 0, 0],\r\n        '8624': [0, 0.69224, 0, 0],\r\n        '8625': [0, 0.69224, 0, 0],\r\n        '8630': [0, 0.43056, 0, 0],\r\n        '8631': [0, 0.43056, 0, 0],\r\n        '8634': [0.08198, 0.58198, 0, 0],\r\n        '8635': [0.08198, 0.58198, 0, 0],\r\n        '8638': [0.19444, 0.69224, 0, 0],\r\n        '8639': [0.19444, 0.69224, 0, 0],\r\n        '8642': [0.19444, 0.69224, 0, 0],\r\n        '8643': [0.19444, 0.69224, 0, 0],\r\n        '8644': [0.1808, 0.675, 0, 0],\r\n        '8646': [0.1808, 0.675, 0, 0],\r\n        '8647': [0.1808, 0.675, 0, 0],\r\n        '8648': [0.19444, 0.69224, 0, 0],\r\n        '8649': [0.1808, 0.675, 0, 0],\r\n        '8650': [0.19444, 0.69224, 0, 0],\r\n        '8651': [0.01354, 0.52239, 0, 0],\r\n        '8652': [0.01354, 0.52239, 0, 0],\r\n        '8653': [-0.13313, 0.36687, 0, 0],\r\n        '8654': [-0.13313, 0.36687, 0, 0],\r\n        '8655': [-0.13313, 0.36687, 0, 0],\r\n        '8666': [0.13667, 0.63667, 0, 0],\r\n        '8667': [0.13667, 0.63667, 0, 0],\r\n        '8669': [-0.13313, 0.37788, 0, 0],\r\n        '8672': [-0.064, 0.437, 0, 0],\r\n        '8674': [-0.064, 0.437, 0, 0],\r\n        '8705': [0, 0.825, 0, 0],\r\n        '8708': [0, 0.68889, 0, 0],\r\n        '8709': [0.08167, 0.58167, 0, 0],\r\n        '8717': [0, 0.43056, 0, 0],\r\n        '8722': [-0.03598, 0.46402, 0, 0],\r\n        '8724': [0.08198, 0.69224, 0, 0],\r\n        '8726': [0.08167, 0.58167, 0, 0],\r\n        '8733': [0, 0.69224, 0, 0],\r\n        '8736': [0, 0.69224, 0, 0],\r\n        '8737': [0, 0.69224, 0, 0],\r\n        '8738': [0.03517, 0.52239, 0, 0],\r\n        '8739': [0.08167, 0.58167, 0, 0],\r\n        '8740': [0.25142, 0.74111, 0, 0],\r\n        '8741': [0.08167, 0.58167, 0, 0],\r\n        '8742': [0.25142, 0.74111, 0, 0],\r\n        '8756': [0, 0.69224, 0, 0],\r\n        '8757': [0, 0.69224, 0, 0],\r\n        '8764': [-0.13313, 0.36687, 0, 0],\r\n        '8765': [-0.13313, 0.37788, 0, 0],\r\n        '8769': [-0.13313, 0.36687, 0, 0],\r\n        '8770': [-0.03625, 0.46375, 0, 0],\r\n        '8774': [0.30274, 0.79383, 0, 0],\r\n        '8776': [-0.01688, 0.48312, 0, 0],\r\n        '8778': [0.08167, 0.58167, 0, 0],\r\n        '8782': [0.06062, 0.54986, 0, 0],\r\n        '8783': [0.06062, 0.54986, 0, 0],\r\n        '8785': [0.08198, 0.58198, 0, 0],\r\n        '8786': [0.08198, 0.58198, 0, 0],\r\n        '8787': [0.08198, 0.58198, 0, 0],\r\n        '8790': [0, 0.69224, 0, 0],\r\n        '8791': [0.22958, 0.72958, 0, 0],\r\n        '8796': [0.08198, 0.91667, 0, 0],\r\n        '8806': [0.25583, 0.75583, 0, 0],\r\n        '8807': [0.25583, 0.75583, 0, 0],\r\n        '8808': [0.25142, 0.75726, 0, 0],\r\n        '8809': [0.25142, 0.75726, 0, 0],\r\n        '8812': [0.25583, 0.75583, 0, 0],\r\n        '8814': [0.20576, 0.70576, 0, 0],\r\n        '8815': [0.20576, 0.70576, 0, 0],\r\n        '8816': [0.30274, 0.79383, 0, 0],\r\n        '8817': [0.30274, 0.79383, 0, 0],\r\n        '8818': [0.22958, 0.72958, 0, 0],\r\n        '8819': [0.22958, 0.72958, 0, 0],\r\n        '8822': [0.1808, 0.675, 0, 0],\r\n        '8823': [0.1808, 0.675, 0, 0],\r\n        '8828': [0.13667, 0.63667, 0, 0],\r\n        '8829': [0.13667, 0.63667, 0, 0],\r\n        '8830': [0.22958, 0.72958, 0, 0],\r\n        '8831': [0.22958, 0.72958, 0, 0],\r\n        '8832': [0.20576, 0.70576, 0, 0],\r\n        '8833': [0.20576, 0.70576, 0, 0],\r\n        '8840': [0.30274, 0.79383, 0, 0],\r\n        '8841': [0.30274, 0.79383, 0, 0],\r\n        '8842': [0.13597, 0.63597, 0, 0],\r\n        '8843': [0.13597, 0.63597, 0, 0],\r\n        '8847': [0.03517, 0.54986, 0, 0],\r\n        '8848': [0.03517, 0.54986, 0, 0],\r\n        '8858': [0.08198, 0.58198, 0, 0],\r\n        '8859': [0.08198, 0.58198, 0, 0],\r\n        '8861': [0.08198, 0.58198, 0, 0],\r\n        '8862': [0, 0.675, 0, 0],\r\n        '8863': [0, 0.675, 0, 0],\r\n        '8864': [0, 0.675, 0, 0],\r\n        '8865': [0, 0.675, 0, 0],\r\n        '8872': [0, 0.69224, 0, 0],\r\n        '8873': [0, 0.69224, 0, 0],\r\n        '8874': [0, 0.69224, 0, 0],\r\n        '8876': [0, 0.68889, 0, 0],\r\n        '8877': [0, 0.68889, 0, 0],\r\n        '8878': [0, 0.68889, 0, 0],\r\n        '8879': [0, 0.68889, 0, 0],\r\n        '8882': [0.03517, 0.54986, 0, 0],\r\n        '8883': [0.03517, 0.54986, 0, 0],\r\n        '8884': [0.13667, 0.63667, 0, 0],\r\n        '8885': [0.13667, 0.63667, 0, 0],\r\n        '8888': [0, 0.54986, 0, 0],\r\n        '8890': [0.19444, 0.43056, 0, 0],\r\n        '8891': [0.19444, 0.69224, 0, 0],\r\n        '8892': [0.19444, 0.69224, 0, 0],\r\n        '8901': [0, 0.54986, 0, 0],\r\n        '8903': [0.08167, 0.58167, 0, 0],\r\n        '8905': [0.08167, 0.58167, 0, 0],\r\n        '8906': [0.08167, 0.58167, 0, 0],\r\n        '8907': [0, 0.69224, 0, 0],\r\n        '8908': [0, 0.69224, 0, 0],\r\n        '8909': [-0.03598, 0.46402, 0, 0],\r\n        '8910': [0, 0.54986, 0, 0],\r\n        '8911': [0, 0.54986, 0, 0],\r\n        '8912': [0.03517, 0.54986, 0, 0],\r\n        '8913': [0.03517, 0.54986, 0, 0],\r\n        '8914': [0, 0.54986, 0, 0],\r\n        '8915': [0, 0.54986, 0, 0],\r\n        '8916': [0, 0.69224, 0, 0],\r\n        '8918': [0.0391, 0.5391, 0, 0],\r\n        '8919': [0.0391, 0.5391, 0, 0],\r\n        '8920': [0.03517, 0.54986, 0, 0],\r\n        '8921': [0.03517, 0.54986, 0, 0],\r\n        '8922': [0.38569, 0.88569, 0, 0],\r\n        '8923': [0.38569, 0.88569, 0, 0],\r\n        '8926': [0.13667, 0.63667, 0, 0],\r\n        '8927': [0.13667, 0.63667, 0, 0],\r\n        '8928': [0.30274, 0.79383, 0, 0],\r\n        '8929': [0.30274, 0.79383, 0, 0],\r\n        '8934': [0.23222, 0.74111, 0, 0],\r\n        '8935': [0.23222, 0.74111, 0, 0],\r\n        '8936': [0.23222, 0.74111, 0, 0],\r\n        '8937': [0.23222, 0.74111, 0, 0],\r\n        '8938': [0.20576, 0.70576, 0, 0],\r\n        '8939': [0.20576, 0.70576, 0, 0],\r\n        '8940': [0.30274, 0.79383, 0, 0],\r\n        '8941': [0.30274, 0.79383, 0, 0],\r\n        '8994': [0.19444, 0.69224, 0, 0],\r\n        '8995': [0.19444, 0.69224, 0, 0],\r\n        '9416': [0.15559, 0.69224, 0, 0],\r\n        '9484': [0, 0.69224, 0, 0],\r\n        '9488': [0, 0.69224, 0, 0],\r\n        '9492': [0, 0.37788, 0, 0],\r\n        '9496': [0, 0.37788, 0, 0],\r\n        '9585': [0.19444, 0.68889, 0, 0],\r\n        '9586': [0.19444, 0.74111, 0, 0],\r\n        '9632': [0, 0.675, 0, 0],\r\n        '9633': [0, 0.675, 0, 0],\r\n        '9650': [0, 0.54986, 0, 0],\r\n        '9651': [0, 0.54986, 0, 0],\r\n        '9654': [0.03517, 0.54986, 0, 0],\r\n        '9660': [0, 0.54986, 0, 0],\r\n        '9661': [0, 0.54986, 0, 0],\r\n        '9664': [0.03517, 0.54986, 0, 0],\r\n        '9674': [0.11111, 0.69224, 0, 0],\r\n        '9733': [0.19444, 0.69224, 0, 0],\r\n        '10003': [0, 0.69224, 0, 0],\r\n        '10016': [0, 0.69224, 0, 0],\r\n        '10731': [0.11111, 0.69224, 0, 0],\r\n        '10846': [0.19444, 0.75583, 0, 0],\r\n        '10877': [0.13667, 0.63667, 0, 0],\r\n        '10878': [0.13667, 0.63667, 0, 0],\r\n        '10885': [0.25583, 0.75583, 0, 0],\r\n        '10886': [0.25583, 0.75583, 0, 0],\r\n        '10887': [0.13597, 0.63597, 0, 0],\r\n        '10888': [0.13597, 0.63597, 0, 0],\r\n        '10889': [0.26167, 0.75726, 0, 0],\r\n        '10890': [0.26167, 0.75726, 0, 0],\r\n        '10891': [0.48256, 0.98256, 0, 0],\r\n        '10892': [0.48256, 0.98256, 0, 0],\r\n        '10901': [0.13667, 0.63667, 0, 0],\r\n        '10902': [0.13667, 0.63667, 0, 0],\r\n        '10933': [0.25142, 0.75726, 0, 0],\r\n        '10934': [0.25142, 0.75726, 0, 0],\r\n        '10935': [0.26167, 0.75726, 0, 0],\r\n        '10936': [0.26167, 0.75726, 0, 0],\r\n        '10937': [0.26167, 0.75726, 0, 0],\r\n        '10938': [0.26167, 0.75726, 0, 0],\r\n        '10949': [0.25583, 0.75583, 0, 0],\r\n        '10950': [0.25583, 0.75583, 0, 0],\r\n        '10955': [0.28481, 0.79383, 0, 0],\r\n        '10956': [0.28481, 0.79383, 0, 0],\r\n        '57350': [0.08167, 0.58167, 0, 0],\r\n        '57351': [0.08167, 0.58167, 0, 0],\r\n        '57352': [0.08167, 0.58167, 0, 0],\r\n        '57353': [0, 0.43056, 0.04028, 0],\r\n        '57356': [0.25142, 0.75726, 0, 0],\r\n        '57357': [0.25142, 0.75726, 0, 0],\r\n        '57358': [0.41951, 0.91951, 0, 0],\r\n        '57359': [0.30274, 0.79383, 0, 0],\r\n        '57360': [0.30274, 0.79383, 0, 0],\r\n        '57361': [0.41951, 0.91951, 0, 0],\r\n        '57366': [0.25142, 0.75726, 0, 0],\r\n        '57367': [0.25142, 0.75726, 0, 0],\r\n        '57368': [0.25142, 0.75726, 0, 0],\r\n        '57369': [0.25142, 0.75726, 0, 0],\r\n        '57370': [0.13597, 0.63597, 0, 0],\r\n        '57371': [0.13597, 0.63597, 0, 0],\r\n    },\r\n    'Caligraphic-Regular': {\r\n        '48': [0, 0.43056, 0, 0],\r\n        '49': [0, 0.43056, 0, 0],\r\n        '50': [0, 0.43056, 0, 0],\r\n        '51': [0.19444, 0.43056, 0, 0],\r\n        '52': [0.19444, 0.43056, 0, 0],\r\n        '53': [0.19444, 0.43056, 0, 0],\r\n        '54': [0, 0.64444, 0, 0],\r\n        '55': [0.19444, 0.43056, 0, 0],\r\n        '56': [0, 0.64444, 0, 0],\r\n        '57': [0.19444, 0.43056, 0, 0],\r\n        '65': [0, 0.68333, 0, 0.19445],\r\n        '66': [0, 0.68333, 0.03041, 0.13889],\r\n        '67': [0, 0.68333, 0.05834, 0.13889],\r\n        '68': [0, 0.68333, 0.02778, 0.08334],\r\n        '69': [0, 0.68333, 0.08944, 0.11111],\r\n        '70': [0, 0.68333, 0.09931, 0.11111],\r\n        '71': [0.09722, 0.68333, 0.0593, 0.11111],\r\n        '72': [0, 0.68333, 0.00965, 0.11111],\r\n        '73': [0, 0.68333, 0.07382, 0],\r\n        '74': [0.09722, 0.68333, 0.18472, 0.16667],\r\n        '75': [0, 0.68333, 0.01445, 0.05556],\r\n        '76': [0, 0.68333, 0, 0.13889],\r\n        '77': [0, 0.68333, 0, 0.13889],\r\n        '78': [0, 0.68333, 0.14736, 0.08334],\r\n        '79': [0, 0.68333, 0.02778, 0.11111],\r\n        '80': [0, 0.68333, 0.08222, 0.08334],\r\n        '81': [0.09722, 0.68333, 0, 0.11111],\r\n        '82': [0, 0.68333, 0, 0.08334],\r\n        '83': [0, 0.68333, 0.075, 0.13889],\r\n        '84': [0, 0.68333, 0.25417, 0],\r\n        '85': [0, 0.68333, 0.09931, 0.08334],\r\n        '86': [0, 0.68333, 0.08222, 0],\r\n        '87': [0, 0.68333, 0.08222, 0.08334],\r\n        '88': [0, 0.68333, 0.14643, 0.13889],\r\n        '89': [0.09722, 0.68333, 0.08222, 0.08334],\r\n        '90': [0, 0.68333, 0.07944, 0.13889],\r\n    },\r\n    'Fraktur-Regular': {\r\n        '33': [0, 0.69141, 0, 0],\r\n        '34': [0, 0.69141, 0, 0],\r\n        '38': [0, 0.69141, 0, 0],\r\n        '39': [0, 0.69141, 0, 0],\r\n        '40': [0.24982, 0.74947, 0, 0],\r\n        '41': [0.24982, 0.74947, 0, 0],\r\n        '42': [0, 0.62119, 0, 0],\r\n        '43': [0.08319, 0.58283, 0, 0],\r\n        '44': [0, 0.10803, 0, 0],\r\n        '45': [0.08319, 0.58283, 0, 0],\r\n        '46': [0, 0.10803, 0, 0],\r\n        '47': [0.24982, 0.74947, 0, 0],\r\n        '48': [0, 0.47534, 0, 0],\r\n        '49': [0, 0.47534, 0, 0],\r\n        '50': [0, 0.47534, 0, 0],\r\n        '51': [0.18906, 0.47534, 0, 0],\r\n        '52': [0.18906, 0.47534, 0, 0],\r\n        '53': [0.18906, 0.47534, 0, 0],\r\n        '54': [0, 0.69141, 0, 0],\r\n        '55': [0.18906, 0.47534, 0, 0],\r\n        '56': [0, 0.69141, 0, 0],\r\n        '57': [0.18906, 0.47534, 0, 0],\r\n        '58': [0, 0.47534, 0, 0],\r\n        '59': [0.12604, 0.47534, 0, 0],\r\n        '61': [-0.13099, 0.36866, 0, 0],\r\n        '63': [0, 0.69141, 0, 0],\r\n        '65': [0, 0.69141, 0, 0],\r\n        '66': [0, 0.69141, 0, 0],\r\n        '67': [0, 0.69141, 0, 0],\r\n        '68': [0, 0.69141, 0, 0],\r\n        '69': [0, 0.69141, 0, 0],\r\n        '70': [0.12604, 0.69141, 0, 0],\r\n        '71': [0, 0.69141, 0, 0],\r\n        '72': [0.06302, 0.69141, 0, 0],\r\n        '73': [0, 0.69141, 0, 0],\r\n        '74': [0.12604, 0.69141, 0, 0],\r\n        '75': [0, 0.69141, 0, 0],\r\n        '76': [0, 0.69141, 0, 0],\r\n        '77': [0, 0.69141, 0, 0],\r\n        '78': [0, 0.69141, 0, 0],\r\n        '79': [0, 0.69141, 0, 0],\r\n        '80': [0.18906, 0.69141, 0, 0],\r\n        '81': [0.03781, 0.69141, 0, 0],\r\n        '82': [0, 0.69141, 0, 0],\r\n        '83': [0, 0.69141, 0, 0],\r\n        '84': [0, 0.69141, 0, 0],\r\n        '85': [0, 0.69141, 0, 0],\r\n        '86': [0, 0.69141, 0, 0],\r\n        '87': [0, 0.69141, 0, 0],\r\n        '88': [0, 0.69141, 0, 0],\r\n        '89': [0.18906, 0.69141, 0, 0],\r\n        '90': [0.12604, 0.69141, 0, 0],\r\n        '91': [0.24982, 0.74947, 0, 0],\r\n        '93': [0.24982, 0.74947, 0, 0],\r\n        '94': [0, 0.69141, 0, 0],\r\n        '97': [0, 0.47534, 0, 0],\r\n        '98': [0, 0.69141, 0, 0],\r\n        '99': [0, 0.47534, 0, 0],\r\n        '100': [0, 0.62119, 0, 0],\r\n        '101': [0, 0.47534, 0, 0],\r\n        '102': [0.18906, 0.69141, 0, 0],\r\n        '103': [0.18906, 0.47534, 0, 0],\r\n        '104': [0.18906, 0.69141, 0, 0],\r\n        '105': [0, 0.69141, 0, 0],\r\n        '106': [0, 0.69141, 0, 0],\r\n        '107': [0, 0.69141, 0, 0],\r\n        '108': [0, 0.69141, 0, 0],\r\n        '109': [0, 0.47534, 0, 0],\r\n        '110': [0, 0.47534, 0, 0],\r\n        '111': [0, 0.47534, 0, 0],\r\n        '112': [0.18906, 0.52396, 0, 0],\r\n        '113': [0.18906, 0.47534, 0, 0],\r\n        '114': [0, 0.47534, 0, 0],\r\n        '115': [0, 0.47534, 0, 0],\r\n        '116': [0, 0.62119, 0, 0],\r\n        '117': [0, 0.47534, 0, 0],\r\n        '118': [0, 0.52396, 0, 0],\r\n        '119': [0, 0.52396, 0, 0],\r\n        '120': [0.18906, 0.47534, 0, 0],\r\n        '121': [0.18906, 0.47534, 0, 0],\r\n        '122': [0.18906, 0.47534, 0, 0],\r\n        '8216': [0, 0.69141, 0, 0],\r\n        '8217': [0, 0.69141, 0, 0],\r\n        '58112': [0, 0.62119, 0, 0],\r\n        '58113': [0, 0.62119, 0, 0],\r\n        '58114': [0.18906, 0.69141, 0, 0],\r\n        '58115': [0.18906, 0.69141, 0, 0],\r\n        '58116': [0.18906, 0.47534, 0, 0],\r\n        '58117': [0, 0.69141, 0, 0],\r\n        '58118': [0, 0.62119, 0, 0],\r\n        '58119': [0, 0.47534, 0, 0],\r\n    },\r\n    'Main-Bold': {\r\n        '33': [0, 0.69444, 0, 0],\r\n        '34': [0, 0.69444, 0, 0],\r\n        '35': [0.19444, 0.69444, 0, 0],\r\n        '36': [0.05556, 0.75, 0, 0],\r\n        '37': [0.05556, 0.75, 0, 0],\r\n        '38': [0, 0.69444, 0, 0],\r\n        '39': [0, 0.69444, 0, 0],\r\n        '40': [0.25, 0.75, 0, 0],\r\n        '41': [0.25, 0.75, 0, 0],\r\n        '42': [0, 0.75, 0, 0],\r\n        '43': [0.13333, 0.63333, 0, 0],\r\n        '44': [0.19444, 0.15556, 0, 0],\r\n        '45': [0, 0.44444, 0, 0],\r\n        '46': [0, 0.15556, 0, 0],\r\n        '47': [0.25, 0.75, 0, 0],\r\n        '48': [0, 0.64444, 0, 0],\r\n        '49': [0, 0.64444, 0, 0],\r\n        '50': [0, 0.64444, 0, 0],\r\n        '51': [0, 0.64444, 0, 0],\r\n        '52': [0, 0.64444, 0, 0],\r\n        '53': [0, 0.64444, 0, 0],\r\n        '54': [0, 0.64444, 0, 0],\r\n        '55': [0, 0.64444, 0, 0],\r\n        '56': [0, 0.64444, 0, 0],\r\n        '57': [0, 0.64444, 0, 0],\r\n        '58': [0, 0.44444, 0, 0],\r\n        '59': [0.19444, 0.44444, 0, 0],\r\n        '60': [0.08556, 0.58556, 0, 0],\r\n        '61': [-0.10889, 0.39111, 0, 0],\r\n        '62': [0.08556, 0.58556, 0, 0],\r\n        '63': [0, 0.69444, 0, 0],\r\n        '64': [0, 0.69444, 0, 0],\r\n        '65': [0, 0.68611, 0, 0],\r\n        '66': [0, 0.68611, 0, 0],\r\n        '67': [0, 0.68611, 0, 0],\r\n        '68': [0, 0.68611, 0, 0],\r\n        '69': [0, 0.68611, 0, 0],\r\n        '70': [0, 0.68611, 0, 0],\r\n        '71': [0, 0.68611, 0, 0],\r\n        '72': [0, 0.68611, 0, 0],\r\n        '73': [0, 0.68611, 0, 0],\r\n        '74': [0, 0.68611, 0, 0],\r\n        '75': [0, 0.68611, 0, 0],\r\n        '76': [0, 0.68611, 0, 0],\r\n        '77': [0, 0.68611, 0, 0],\r\n        '78': [0, 0.68611, 0, 0],\r\n        '79': [0, 0.68611, 0, 0],\r\n        '80': [0, 0.68611, 0, 0],\r\n        '81': [0.19444, 0.68611, 0, 0],\r\n        '82': [0, 0.68611, 0, 0],\r\n        '83': [0, 0.68611, 0, 0],\r\n        '84': [0, 0.68611, 0, 0],\r\n        '85': [0, 0.68611, 0, 0],\r\n        '86': [0, 0.68611, 0.01597, 0],\r\n        '87': [0, 0.68611, 0.01597, 0],\r\n        '88': [0, 0.68611, 0, 0],\r\n        '89': [0, 0.68611, 0.02875, 0],\r\n        '90': [0, 0.68611, 0, 0],\r\n        '91': [0.25, 0.75, 0, 0],\r\n        '92': [0.25, 0.75, 0, 0],\r\n        '93': [0.25, 0.75, 0, 0],\r\n        '94': [0, 0.69444, 0, 0],\r\n        '95': [0.31, 0.13444, 0.03194, 0],\r\n        '97': [0, 0.44444, 0, 0],\r\n        '98': [0, 0.69444, 0, 0],\r\n        '99': [0, 0.44444, 0, 0],\r\n        '100': [0, 0.69444, 0, 0],\r\n        '101': [0, 0.44444, 0, 0],\r\n        '102': [0, 0.69444, 0.10903, 0],\r\n        '103': [0.19444, 0.44444, 0.01597, 0],\r\n        '104': [0, 0.69444, 0, 0],\r\n        '105': [0, 0.69444, 0, 0],\r\n        '106': [0.19444, 0.69444, 0, 0],\r\n        '107': [0, 0.69444, 0, 0],\r\n        '108': [0, 0.69444, 0, 0],\r\n        '109': [0, 0.44444, 0, 0],\r\n        '110': [0, 0.44444, 0, 0],\r\n        '111': [0, 0.44444, 0, 0],\r\n        '112': [0.19444, 0.44444, 0, 0],\r\n        '113': [0.19444, 0.44444, 0, 0],\r\n        '114': [0, 0.44444, 0, 0],\r\n        '115': [0, 0.44444, 0, 0],\r\n        '116': [0, 0.63492, 0, 0],\r\n        '117': [0, 0.44444, 0, 0],\r\n        '118': [0, 0.44444, 0.01597, 0],\r\n        '119': [0, 0.44444, 0.01597, 0],\r\n        '120': [0, 0.44444, 0, 0],\r\n        '121': [0.19444, 0.44444, 0.01597, 0],\r\n        '122': [0, 0.44444, 0, 0],\r\n        '123': [0.25, 0.75, 0, 0],\r\n        '124': [0.25, 0.75, 0, 0],\r\n        '125': [0.25, 0.75, 0, 0],\r\n        '126': [0.35, 0.34444, 0, 0],\r\n        '168': [0, 0.69444, 0, 0],\r\n        '172': [0, 0.44444, 0, 0],\r\n        '176': [0, 0.69444, 0, 0],\r\n        '177': [0.13333, 0.63333, 0, 0],\r\n        '184': [0.17014, 0, 0, 0],\r\n        '198': [0, 0.68611, 0, 0],\r\n        '215': [0.13333, 0.63333, 0, 0],\r\n        '216': [0.04861, 0.73472, 0, 0],\r\n        '223': [0, 0.69444, 0, 0],\r\n        '230': [0, 0.44444, 0, 0],\r\n        '247': [0.13333, 0.63333, 0, 0],\r\n        '248': [0.09722, 0.54167, 0, 0],\r\n        '305': [0, 0.44444, 0, 0],\r\n        '338': [0, 0.68611, 0, 0],\r\n        '339': [0, 0.44444, 0, 0],\r\n        '567': [0.19444, 0.44444, 0, 0],\r\n        '710': [0, 0.69444, 0, 0],\r\n        '711': [0, 0.63194, 0, 0],\r\n        '713': [0, 0.59611, 0, 0],\r\n        '714': [0, 0.69444, 0, 0],\r\n        '715': [0, 0.69444, 0, 0],\r\n        '728': [0, 0.69444, 0, 0],\r\n        '729': [0, 0.69444, 0, 0],\r\n        '730': [0, 0.69444, 0, 0],\r\n        '732': [0, 0.69444, 0, 0],\r\n        '733': [0, 0.69444, 0, 0],\r\n        '915': [0, 0.68611, 0, 0],\r\n        '916': [0, 0.68611, 0, 0],\r\n        '920': [0, 0.68611, 0, 0],\r\n        '923': [0, 0.68611, 0, 0],\r\n        '926': [0, 0.68611, 0, 0],\r\n        '928': [0, 0.68611, 0, 0],\r\n        '931': [0, 0.68611, 0, 0],\r\n        '933': [0, 0.68611, 0, 0],\r\n        '934': [0, 0.68611, 0, 0],\r\n        '936': [0, 0.68611, 0, 0],\r\n        '937': [0, 0.68611, 0, 0],\r\n        '8211': [0, 0.44444, 0.03194, 0],\r\n        '8212': [0, 0.44444, 0.03194, 0],\r\n        '8216': [0, 0.69444, 0, 0],\r\n        '8217': [0, 0.69444, 0, 0],\r\n        '8220': [0, 0.69444, 0, 0],\r\n        '8221': [0, 0.69444, 0, 0],\r\n        '8224': [0.19444, 0.69444, 0, 0],\r\n        '8225': [0.19444, 0.69444, 0, 0],\r\n        '8242': [0, 0.55556, 0, 0],\r\n        '8407': [0, 0.72444, 0.15486, 0],\r\n        '8463': [0, 0.69444, 0, 0],\r\n        '8465': [0, 0.69444, 0, 0],\r\n        '8467': [0, 0.69444, 0, 0],\r\n        '8472': [0.19444, 0.44444, 0, 0],\r\n        '8476': [0, 0.69444, 0, 0],\r\n        '8501': [0, 0.69444, 0, 0],\r\n        '8592': [-0.10889, 0.39111, 0, 0],\r\n        '8593': [0.19444, 0.69444, 0, 0],\r\n        '8594': [-0.10889, 0.39111, 0, 0],\r\n        '8595': [0.19444, 0.69444, 0, 0],\r\n        '8596': [-0.10889, 0.39111, 0, 0],\r\n        '8597': [0.25, 0.75, 0, 0],\r\n        '8598': [0.19444, 0.69444, 0, 0],\r\n        '8599': [0.19444, 0.69444, 0, 0],\r\n        '8600': [0.19444, 0.69444, 0, 0],\r\n        '8601': [0.19444, 0.69444, 0, 0],\r\n        '8636': [-0.10889, 0.39111, 0, 0],\r\n        '8637': [-0.10889, 0.39111, 0, 0],\r\n        '8640': [-0.10889, 0.39111, 0, 0],\r\n        '8641': [-0.10889, 0.39111, 0, 0],\r\n        '8656': [-0.10889, 0.39111, 0, 0],\r\n        '8657': [0.19444, 0.69444, 0, 0],\r\n        '8658': [-0.10889, 0.39111, 0, 0],\r\n        '8659': [0.19444, 0.69444, 0, 0],\r\n        '8660': [-0.10889, 0.39111, 0, 0],\r\n        '8661': [0.25, 0.75, 0, 0],\r\n        '8704': [0, 0.69444, 0, 0],\r\n        '8706': [0, 0.69444, 0.06389, 0],\r\n        '8707': [0, 0.69444, 0, 0],\r\n        '8709': [0.05556, 0.75, 0, 0],\r\n        '8711': [0, 0.68611, 0, 0],\r\n        '8712': [0.08556, 0.58556, 0, 0],\r\n        '8715': [0.08556, 0.58556, 0, 0],\r\n        '8722': [0.13333, 0.63333, 0, 0],\r\n        '8723': [0.13333, 0.63333, 0, 0],\r\n        '8725': [0.25, 0.75, 0, 0],\r\n        '8726': [0.25, 0.75, 0, 0],\r\n        '8727': [-0.02778, 0.47222, 0, 0],\r\n        '8728': [-0.02639, 0.47361, 0, 0],\r\n        '8729': [-0.02639, 0.47361, 0, 0],\r\n        '8730': [0.18, 0.82, 0, 0],\r\n        '8733': [0, 0.44444, 0, 0],\r\n        '8734': [0, 0.44444, 0, 0],\r\n        '8736': [0, 0.69224, 0, 0],\r\n        '8739': [0.25, 0.75, 0, 0],\r\n        '8741': [0.25, 0.75, 0, 0],\r\n        '8743': [0, 0.55556, 0, 0],\r\n        '8744': [0, 0.55556, 0, 0],\r\n        '8745': [0, 0.55556, 0, 0],\r\n        '8746': [0, 0.55556, 0, 0],\r\n        '8747': [0.19444, 0.69444, 0.12778, 0],\r\n        '8764': [-0.10889, 0.39111, 0, 0],\r\n        '8768': [0.19444, 0.69444, 0, 0],\r\n        '8771': [0.00222, 0.50222, 0, 0],\r\n        '8776': [0.02444, 0.52444, 0, 0],\r\n        '8781': [0.00222, 0.50222, 0, 0],\r\n        '8801': [0.00222, 0.50222, 0, 0],\r\n        '8804': [0.19667, 0.69667, 0, 0],\r\n        '8805': [0.19667, 0.69667, 0, 0],\r\n        '8810': [0.08556, 0.58556, 0, 0],\r\n        '8811': [0.08556, 0.58556, 0, 0],\r\n        '8826': [0.08556, 0.58556, 0, 0],\r\n        '8827': [0.08556, 0.58556, 0, 0],\r\n        '8834': [0.08556, 0.58556, 0, 0],\r\n        '8835': [0.08556, 0.58556, 0, 0],\r\n        '8838': [0.19667, 0.69667, 0, 0],\r\n        '8839': [0.19667, 0.69667, 0, 0],\r\n        '8846': [0, 0.55556, 0, 0],\r\n        '8849': [0.19667, 0.69667, 0, 0],\r\n        '8850': [0.19667, 0.69667, 0, 0],\r\n        '8851': [0, 0.55556, 0, 0],\r\n        '8852': [0, 0.55556, 0, 0],\r\n        '8853': [0.13333, 0.63333, 0, 0],\r\n        '8854': [0.13333, 0.63333, 0, 0],\r\n        '8855': [0.13333, 0.63333, 0, 0],\r\n        '8856': [0.13333, 0.63333, 0, 0],\r\n        '8857': [0.13333, 0.63333, 0, 0],\r\n        '8866': [0, 0.69444, 0, 0],\r\n        '8867': [0, 0.69444, 0, 0],\r\n        '8868': [0, 0.69444, 0, 0],\r\n        '8869': [0, 0.69444, 0, 0],\r\n        '8900': [-0.02639, 0.47361, 0, 0],\r\n        '8901': [-0.02639, 0.47361, 0, 0],\r\n        '8902': [-0.02778, 0.47222, 0, 0],\r\n        '8968': [0.25, 0.75, 0, 0],\r\n        '8969': [0.25, 0.75, 0, 0],\r\n        '8970': [0.25, 0.75, 0, 0],\r\n        '8971': [0.25, 0.75, 0, 0],\r\n        '8994': [-0.13889, 0.36111, 0, 0],\r\n        '8995': [-0.13889, 0.36111, 0, 0],\r\n        '9651': [0.19444, 0.69444, 0, 0],\r\n        '9657': [-0.02778, 0.47222, 0, 0],\r\n        '9661': [0.19444, 0.69444, 0, 0],\r\n        '9667': [-0.02778, 0.47222, 0, 0],\r\n        '9711': [0.19444, 0.69444, 0, 0],\r\n        '9824': [0.12963, 0.69444, 0, 0],\r\n        '9825': [0.12963, 0.69444, 0, 0],\r\n        '9826': [0.12963, 0.69444, 0, 0],\r\n        '9827': [0.12963, 0.69444, 0, 0],\r\n        '9837': [0, 0.75, 0, 0],\r\n        '9838': [0.19444, 0.69444, 0, 0],\r\n        '9839': [0.19444, 0.69444, 0, 0],\r\n        '10216': [0.25, 0.75, 0, 0],\r\n        '10217': [0.25, 0.75, 0, 0],\r\n        '10815': [0, 0.68611, 0, 0],\r\n        '10927': [0.19667, 0.69667, 0, 0],\r\n        '10928': [0.19667, 0.69667, 0, 0],\r\n        '57376': [0.19444, 0.69444, 0, 0],\r\n    },\r\n    'Main-BoldItalic': {\r\n        '33': [0, 0.69444, 0.11417, 0],\r\n        '34': [0, 0.69444, 0.07939, 0],\r\n        '35': [0.19444, 0.69444, 0.06833, 0],\r\n        '37': [0.05556, 0.75, 0.12861, 0],\r\n        '38': [0, 0.69444, 0.08528, 0],\r\n        '39': [0, 0.69444, 0.12945, 0],\r\n        '40': [0.25, 0.75, 0.15806, 0],\r\n        '41': [0.25, 0.75, 0.03306, 0],\r\n        '42': [0, 0.75, 0.14333, 0],\r\n        '43': [0.10333, 0.60333, 0.03306, 0],\r\n        '44': [0.19444, 0.14722, 0, 0],\r\n        '45': [0, 0.44444, 0.02611, 0],\r\n        '46': [0, 0.14722, 0, 0],\r\n        '47': [0.25, 0.75, 0.15806, 0],\r\n        '48': [0, 0.64444, 0.13167, 0],\r\n        '49': [0, 0.64444, 0.13167, 0],\r\n        '50': [0, 0.64444, 0.13167, 0],\r\n        '51': [0, 0.64444, 0.13167, 0],\r\n        '52': [0.19444, 0.64444, 0.13167, 0],\r\n        '53': [0, 0.64444, 0.13167, 0],\r\n        '54': [0, 0.64444, 0.13167, 0],\r\n        '55': [0.19444, 0.64444, 0.13167, 0],\r\n        '56': [0, 0.64444, 0.13167, 0],\r\n        '57': [0, 0.64444, 0.13167, 0],\r\n        '58': [0, 0.44444, 0.06695, 0],\r\n        '59': [0.19444, 0.44444, 0.06695, 0],\r\n        '61': [-0.10889, 0.39111, 0.06833, 0],\r\n        '63': [0, 0.69444, 0.11472, 0],\r\n        '64': [0, 0.69444, 0.09208, 0],\r\n        '65': [0, 0.68611, 0, 0],\r\n        '66': [0, 0.68611, 0.0992, 0],\r\n        '67': [0, 0.68611, 0.14208, 0],\r\n        '68': [0, 0.68611, 0.09062, 0],\r\n        '69': [0, 0.68611, 0.11431, 0],\r\n        '70': [0, 0.68611, 0.12903, 0],\r\n        '71': [0, 0.68611, 0.07347, 0],\r\n        '72': [0, 0.68611, 0.17208, 0],\r\n        '73': [0, 0.68611, 0.15681, 0],\r\n        '74': [0, 0.68611, 0.145, 0],\r\n        '75': [0, 0.68611, 0.14208, 0],\r\n        '76': [0, 0.68611, 0, 0],\r\n        '77': [0, 0.68611, 0.17208, 0],\r\n        '78': [0, 0.68611, 0.17208, 0],\r\n        '79': [0, 0.68611, 0.09062, 0],\r\n        '80': [0, 0.68611, 0.0992, 0],\r\n        '81': [0.19444, 0.68611, 0.09062, 0],\r\n        '82': [0, 0.68611, 0.02559, 0],\r\n        '83': [0, 0.68611, 0.11264, 0],\r\n        '84': [0, 0.68611, 0.12903, 0],\r\n        '85': [0, 0.68611, 0.17208, 0],\r\n        '86': [0, 0.68611, 0.18625, 0],\r\n        '87': [0, 0.68611, 0.18625, 0],\r\n        '88': [0, 0.68611, 0.15681, 0],\r\n        '89': [0, 0.68611, 0.19803, 0],\r\n        '90': [0, 0.68611, 0.14208, 0],\r\n        '91': [0.25, 0.75, 0.1875, 0],\r\n        '93': [0.25, 0.75, 0.09972, 0],\r\n        '94': [0, 0.69444, 0.06709, 0],\r\n        '95': [0.31, 0.13444, 0.09811, 0],\r\n        '97': [0, 0.44444, 0.09426, 0],\r\n        '98': [0, 0.69444, 0.07861, 0],\r\n        '99': [0, 0.44444, 0.05222, 0],\r\n        '100': [0, 0.69444, 0.10861, 0],\r\n        '101': [0, 0.44444, 0.085, 0],\r\n        '102': [0.19444, 0.69444, 0.21778, 0],\r\n        '103': [0.19444, 0.44444, 0.105, 0],\r\n        '104': [0, 0.69444, 0.09426, 0],\r\n        '105': [0, 0.69326, 0.11387, 0],\r\n        '106': [0.19444, 0.69326, 0.1672, 0],\r\n        '107': [0, 0.69444, 0.11111, 0],\r\n        '108': [0, 0.69444, 0.10861, 0],\r\n        '109': [0, 0.44444, 0.09426, 0],\r\n        '110': [0, 0.44444, 0.09426, 0],\r\n        '111': [0, 0.44444, 0.07861, 0],\r\n        '112': [0.19444, 0.44444, 0.07861, 0],\r\n        '113': [0.19444, 0.44444, 0.105, 0],\r\n        '114': [0, 0.44444, 0.11111, 0],\r\n        '115': [0, 0.44444, 0.08167, 0],\r\n        '116': [0, 0.63492, 0.09639, 0],\r\n        '117': [0, 0.44444, 0.09426, 0],\r\n        '118': [0, 0.44444, 0.11111, 0],\r\n        '119': [0, 0.44444, 0.11111, 0],\r\n        '120': [0, 0.44444, 0.12583, 0],\r\n        '121': [0.19444, 0.44444, 0.105, 0],\r\n        '122': [0, 0.44444, 0.13889, 0],\r\n        '126': [0.35, 0.34444, 0.11472, 0],\r\n        '163': [0, 0.69444, 0, 0],\r\n        '168': [0, 0.69444, 0.11473, 0],\r\n        '176': [0, 0.69444, 0, 0],\r\n        '184': [0.17014, 0, 0, 0],\r\n        '198': [0, 0.68611, 0.11431, 0],\r\n        '216': [0.04861, 0.73472, 0.09062, 0],\r\n        '223': [0.19444, 0.69444, 0.09736, 0],\r\n        '230': [0, 0.44444, 0.085, 0],\r\n        '248': [0.09722, 0.54167, 0.09458, 0],\r\n        '305': [0, 0.44444, 0.09426, 0],\r\n        '338': [0, 0.68611, 0.11431, 0],\r\n        '339': [0, 0.44444, 0.085, 0],\r\n        '567': [0.19444, 0.44444, 0.04611, 0],\r\n        '710': [0, 0.69444, 0.06709, 0],\r\n        '711': [0, 0.63194, 0.08271, 0],\r\n        '713': [0, 0.59444, 0.10444, 0],\r\n        '714': [0, 0.69444, 0.08528, 0],\r\n        '715': [0, 0.69444, 0, 0],\r\n        '728': [0, 0.69444, 0.10333, 0],\r\n        '729': [0, 0.69444, 0.12945, 0],\r\n        '730': [0, 0.69444, 0, 0],\r\n        '732': [0, 0.69444, 0.11472, 0],\r\n        '733': [0, 0.69444, 0.11472, 0],\r\n        '915': [0, 0.68611, 0.12903, 0],\r\n        '916': [0, 0.68611, 0, 0],\r\n        '920': [0, 0.68611, 0.09062, 0],\r\n        '923': [0, 0.68611, 0, 0],\r\n        '926': [0, 0.68611, 0.15092, 0],\r\n        '928': [0, 0.68611, 0.17208, 0],\r\n        '931': [0, 0.68611, 0.11431, 0],\r\n        '933': [0, 0.68611, 0.10778, 0],\r\n        '934': [0, 0.68611, 0.05632, 0],\r\n        '936': [0, 0.68611, 0.10778, 0],\r\n        '937': [0, 0.68611, 0.0992, 0],\r\n        '8211': [0, 0.44444, 0.09811, 0],\r\n        '8212': [0, 0.44444, 0.09811, 0],\r\n        '8216': [0, 0.69444, 0.12945, 0],\r\n        '8217': [0, 0.69444, 0.12945, 0],\r\n        '8220': [0, 0.69444, 0.16772, 0],\r\n        '8221': [0, 0.69444, 0.07939, 0],\r\n    },\r\n    'Main-Italic': {\r\n        '33': [0, 0.69444, 0.12417, 0],\r\n        '34': [0, 0.69444, 0.06961, 0],\r\n        '35': [0.19444, 0.69444, 0.06616, 0],\r\n        '37': [0.05556, 0.75, 0.13639, 0],\r\n        '38': [0, 0.69444, 0.09694, 0],\r\n        '39': [0, 0.69444, 0.12417, 0],\r\n        '40': [0.25, 0.75, 0.16194, 0],\r\n        '41': [0.25, 0.75, 0.03694, 0],\r\n        '42': [0, 0.75, 0.14917, 0],\r\n        '43': [0.05667, 0.56167, 0.03694, 0],\r\n        '44': [0.19444, 0.10556, 0, 0],\r\n        '45': [0, 0.43056, 0.02826, 0],\r\n        '46': [0, 0.10556, 0, 0],\r\n        '47': [0.25, 0.75, 0.16194, 0],\r\n        '48': [0, 0.64444, 0.13556, 0],\r\n        '49': [0, 0.64444, 0.13556, 0],\r\n        '50': [0, 0.64444, 0.13556, 0],\r\n        '51': [0, 0.64444, 0.13556, 0],\r\n        '52': [0.19444, 0.64444, 0.13556, 0],\r\n        '53': [0, 0.64444, 0.13556, 0],\r\n        '54': [0, 0.64444, 0.13556, 0],\r\n        '55': [0.19444, 0.64444, 0.13556, 0],\r\n        '56': [0, 0.64444, 0.13556, 0],\r\n        '57': [0, 0.64444, 0.13556, 0],\r\n        '58': [0, 0.43056, 0.0582, 0],\r\n        '59': [0.19444, 0.43056, 0.0582, 0],\r\n        '61': [-0.13313, 0.36687, 0.06616, 0],\r\n        '63': [0, 0.69444, 0.1225, 0],\r\n        '64': [0, 0.69444, 0.09597, 0],\r\n        '65': [0, 0.68333, 0, 0],\r\n        '66': [0, 0.68333, 0.10257, 0],\r\n        '67': [0, 0.68333, 0.14528, 0],\r\n        '68': [0, 0.68333, 0.09403, 0],\r\n        '69': [0, 0.68333, 0.12028, 0],\r\n        '70': [0, 0.68333, 0.13305, 0],\r\n        '71': [0, 0.68333, 0.08722, 0],\r\n        '72': [0, 0.68333, 0.16389, 0],\r\n        '73': [0, 0.68333, 0.15806, 0],\r\n        '74': [0, 0.68333, 0.14028, 0],\r\n        '75': [0, 0.68333, 0.14528, 0],\r\n        '76': [0, 0.68333, 0, 0],\r\n        '77': [0, 0.68333, 0.16389, 0],\r\n        '78': [0, 0.68333, 0.16389, 0],\r\n        '79': [0, 0.68333, 0.09403, 0],\r\n        '80': [0, 0.68333, 0.10257, 0],\r\n        '81': [0.19444, 0.68333, 0.09403, 0],\r\n        '82': [0, 0.68333, 0.03868, 0],\r\n        '83': [0, 0.68333, 0.11972, 0],\r\n        '84': [0, 0.68333, 0.13305, 0],\r\n        '85': [0, 0.68333, 0.16389, 0],\r\n        '86': [0, 0.68333, 0.18361, 0],\r\n        '87': [0, 0.68333, 0.18361, 0],\r\n        '88': [0, 0.68333, 0.15806, 0],\r\n        '89': [0, 0.68333, 0.19383, 0],\r\n        '90': [0, 0.68333, 0.14528, 0],\r\n        '91': [0.25, 0.75, 0.1875, 0],\r\n        '93': [0.25, 0.75, 0.10528, 0],\r\n        '94': [0, 0.69444, 0.06646, 0],\r\n        '95': [0.31, 0.12056, 0.09208, 0],\r\n        '97': [0, 0.43056, 0.07671, 0],\r\n        '98': [0, 0.69444, 0.06312, 0],\r\n        '99': [0, 0.43056, 0.05653, 0],\r\n        '100': [0, 0.69444, 0.10333, 0],\r\n        '101': [0, 0.43056, 0.07514, 0],\r\n        '102': [0.19444, 0.69444, 0.21194, 0],\r\n        '103': [0.19444, 0.43056, 0.08847, 0],\r\n        '104': [0, 0.69444, 0.07671, 0],\r\n        '105': [0, 0.65536, 0.1019, 0],\r\n        '106': [0.19444, 0.65536, 0.14467, 0],\r\n        '107': [0, 0.69444, 0.10764, 0],\r\n        '108': [0, 0.69444, 0.10333, 0],\r\n        '109': [0, 0.43056, 0.07671, 0],\r\n        '110': [0, 0.43056, 0.07671, 0],\r\n        '111': [0, 0.43056, 0.06312, 0],\r\n        '112': [0.19444, 0.43056, 0.06312, 0],\r\n        '113': [0.19444, 0.43056, 0.08847, 0],\r\n        '114': [0, 0.43056, 0.10764, 0],\r\n        '115': [0, 0.43056, 0.08208, 0],\r\n        '116': [0, 0.61508, 0.09486, 0],\r\n        '117': [0, 0.43056, 0.07671, 0],\r\n        '118': [0, 0.43056, 0.10764, 0],\r\n        '119': [0, 0.43056, 0.10764, 0],\r\n        '120': [0, 0.43056, 0.12042, 0],\r\n        '121': [0.19444, 0.43056, 0.08847, 0],\r\n        '122': [0, 0.43056, 0.12292, 0],\r\n        '126': [0.35, 0.31786, 0.11585, 0],\r\n        '163': [0, 0.69444, 0, 0],\r\n        '168': [0, 0.66786, 0.10474, 0],\r\n        '176': [0, 0.69444, 0, 0],\r\n        '184': [0.17014, 0, 0, 0],\r\n        '198': [0, 0.68333, 0.12028, 0],\r\n        '216': [0.04861, 0.73194, 0.09403, 0],\r\n        '223': [0.19444, 0.69444, 0.10514, 0],\r\n        '230': [0, 0.43056, 0.07514, 0],\r\n        '248': [0.09722, 0.52778, 0.09194, 0],\r\n        '305': [0, 0.43056, 0, 0.02778],\r\n        '338': [0, 0.68333, 0.12028, 0],\r\n        '339': [0, 0.43056, 0.07514, 0],\r\n        '567': [0.19444, 0.43056, 0, 0.08334],\r\n        '710': [0, 0.69444, 0.06646, 0],\r\n        '711': [0, 0.62847, 0.08295, 0],\r\n        '713': [0, 0.56167, 0.10333, 0],\r\n        '714': [0, 0.69444, 0.09694, 0],\r\n        '715': [0, 0.69444, 0, 0],\r\n        '728': [0, 0.69444, 0.10806, 0],\r\n        '729': [0, 0.66786, 0.11752, 0],\r\n        '730': [0, 0.69444, 0, 0],\r\n        '732': [0, 0.66786, 0.11585, 0],\r\n        '733': [0, 0.69444, 0.1225, 0],\r\n        '915': [0, 0.68333, 0.13305, 0],\r\n        '916': [0, 0.68333, 0, 0],\r\n        '920': [0, 0.68333, 0.09403, 0],\r\n        '923': [0, 0.68333, 0, 0],\r\n        '926': [0, 0.68333, 0.15294, 0],\r\n        '928': [0, 0.68333, 0.16389, 0],\r\n        '931': [0, 0.68333, 0.12028, 0],\r\n        '933': [0, 0.68333, 0.11111, 0],\r\n        '934': [0, 0.68333, 0.05986, 0],\r\n        '936': [0, 0.68333, 0.11111, 0],\r\n        '937': [0, 0.68333, 0.10257, 0],\r\n        '8211': [0, 0.43056, 0.09208, 0],\r\n        '8212': [0, 0.43056, 0.09208, 0],\r\n        '8216': [0, 0.69444, 0.12417, 0],\r\n        '8217': [0, 0.69444, 0.12417, 0],\r\n        '8220': [0, 0.69444, 0.1685, 0],\r\n        '8221': [0, 0.69444, 0.06961, 0],\r\n        '8463': [0, 0.68889, 0, 0],\r\n    },\r\n    'Main-Regular': {\r\n        '32': [0, 0, 0, 0],\r\n        '33': [0, 0.69444, 0, 0],\r\n        '34': [0, 0.69444, 0, 0],\r\n        '35': [0.19444, 0.69444, 0, 0],\r\n        '36': [0.05556, 0.75, 0, 0],\r\n        '37': [0.05556, 0.75, 0, 0],\r\n        '38': [0, 0.69444, 0, 0],\r\n        '39': [0, 0.69444, 0, 0],\r\n        '40': [0.25, 0.75, 0, 0],\r\n        '41': [0.25, 0.75, 0, 0],\r\n        '42': [0, 0.75, 0, 0],\r\n        '43': [0.08333, 0.58333, 0, 0],\r\n        '44': [0.19444, 0.10556, 0, 0],\r\n        '45': [0, 0.43056, 0, 0],\r\n        '46': [0, 0.10556, 0, 0],\r\n        '47': [0.25, 0.75, 0, 0],\r\n        '48': [0, 0.64444, 0, 0],\r\n        '49': [0, 0.64444, 0, 0],\r\n        '50': [0, 0.64444, 0, 0],\r\n        '51': [0, 0.64444, 0, 0],\r\n        '52': [0, 0.64444, 0, 0],\r\n        '53': [0, 0.64444, 0, 0],\r\n        '54': [0, 0.64444, 0, 0],\r\n        '55': [0, 0.64444, 0, 0],\r\n        '56': [0, 0.64444, 0, 0],\r\n        '57': [0, 0.64444, 0, 0],\r\n        '58': [0, 0.43056, 0, 0],\r\n        '59': [0.19444, 0.43056, 0, 0],\r\n        '60': [0.0391, 0.5391, 0, 0],\r\n        '61': [-0.13313, 0.36687, 0, 0],\r\n        '62': [0.0391, 0.5391, 0, 0],\r\n        '63': [0, 0.69444, 0, 0],\r\n        '64': [0, 0.69444, 0, 0],\r\n        '65': [0, 0.68333, 0, 0],\r\n        '66': [0, 0.68333, 0, 0],\r\n        '67': [0, 0.68333, 0, 0],\r\n        '68': [0, 0.68333, 0, 0],\r\n        '69': [0, 0.68333, 0, 0],\r\n        '70': [0, 0.68333, 0, 0],\r\n        '71': [0, 0.68333, 0, 0],\r\n        '72': [0, 0.68333, 0, 0],\r\n        '73': [0, 0.68333, 0, 0],\r\n        '74': [0, 0.68333, 0, 0],\r\n        '75': [0, 0.68333, 0, 0],\r\n        '76': [0, 0.68333, 0, 0],\r\n        '77': [0, 0.68333, 0, 0],\r\n        '78': [0, 0.68333, 0, 0],\r\n        '79': [0, 0.68333, 0, 0],\r\n        '80': [0, 0.68333, 0, 0],\r\n        '81': [0.19444, 0.68333, 0, 0],\r\n        '82': [0, 0.68333, 0, 0],\r\n        '83': [0, 0.68333, 0, 0],\r\n        '84': [0, 0.68333, 0, 0],\r\n        '85': [0, 0.68333, 0, 0],\r\n        '86': [0, 0.68333, 0.01389, 0],\r\n        '87': [0, 0.68333, 0.01389, 0],\r\n        '88': [0, 0.68333, 0, 0],\r\n        '89': [0, 0.68333, 0.025, 0],\r\n        '90': [0, 0.68333, 0, 0],\r\n        '91': [0.25, 0.75, 0, 0],\r\n        '92': [0.25, 0.75, 0, 0],\r\n        '93': [0.25, 0.75, 0, 0],\r\n        '94': [0, 0.69444, 0, 0],\r\n        '95': [0.31, 0.12056, 0.02778, 0],\r\n        '97': [0, 0.43056, 0, 0],\r\n        '98': [0, 0.69444, 0, 0],\r\n        '99': [0, 0.43056, 0, 0],\r\n        '100': [0, 0.69444, 0, 0],\r\n        '101': [0, 0.43056, 0, 0],\r\n        '102': [0, 0.69444, 0.07778, 0],\r\n        '103': [0.19444, 0.43056, 0.01389, 0],\r\n        '104': [0, 0.69444, 0, 0],\r\n        '105': [0, 0.66786, 0, 0],\r\n        '106': [0.19444, 0.66786, 0, 0],\r\n        '107': [0, 0.69444, 0, 0],\r\n        '108': [0, 0.69444, 0, 0],\r\n        '109': [0, 0.43056, 0, 0],\r\n        '110': [0, 0.43056, 0, 0],\r\n        '111': [0, 0.43056, 0, 0],\r\n        '112': [0.19444, 0.43056, 0, 0],\r\n        '113': [0.19444, 0.43056, 0, 0],\r\n        '114': [0, 0.43056, 0, 0],\r\n        '115': [0, 0.43056, 0, 0],\r\n        '116': [0, 0.61508, 0, 0],\r\n        '117': [0, 0.43056, 0, 0],\r\n        '118': [0, 0.43056, 0.01389, 0],\r\n        '119': [0, 0.43056, 0.01389, 0],\r\n        '120': [0, 0.43056, 0, 0],\r\n        '121': [0.19444, 0.43056, 0.01389, 0],\r\n        '122': [0, 0.43056, 0, 0],\r\n        '123': [0.25, 0.75, 0, 0],\r\n        '124': [0.25, 0.75, 0, 0],\r\n        '125': [0.25, 0.75, 0, 0],\r\n        '126': [0.35, 0.31786, 0, 0],\r\n        '160': [0, 0, 0, 0],\r\n        '167': [0.19444, 0.69444, 0, 0],\r\n        '168': [0, 0.66786, 0, 0],\r\n        '172': [0, 0.43056, 0, 0],\r\n        '176': [0, 0.69444, 0, 0],\r\n        '177': [0.08333, 0.58333, 0, 0],\r\n        '182': [0.19444, 0.69444, 0, 0],\r\n        '184': [0.17014, 0, 0, 0],\r\n        '198': [0, 0.68333, 0, 0],\r\n        '215': [0.08333, 0.58333, 0, 0],\r\n        '216': [0.04861, 0.73194, 0, 0],\r\n        '223': [0, 0.69444, 0, 0],\r\n        '230': [0, 0.43056, 0, 0],\r\n        '247': [0.08333, 0.58333, 0, 0],\r\n        '248': [0.09722, 0.52778, 0, 0],\r\n        '305': [0, 0.43056, 0, 0],\r\n        '338': [0, 0.68333, 0, 0],\r\n        '339': [0, 0.43056, 0, 0],\r\n        '567': [0.19444, 0.43056, 0, 0],\r\n        '710': [0, 0.69444, 0, 0],\r\n        '711': [0, 0.62847, 0, 0],\r\n        '713': [0, 0.56778, 0, 0],\r\n        '714': [0, 0.69444, 0, 0],\r\n        '715': [0, 0.69444, 0, 0],\r\n        '728': [0, 0.69444, 0, 0],\r\n        '729': [0, 0.66786, 0, 0],\r\n        '730': [0, 0.69444, 0, 0],\r\n        '732': [0, 0.66786, 0, 0],\r\n        '733': [0, 0.69444, 0, 0],\r\n        '915': [0, 0.68333, 0, 0],\r\n        '916': [0, 0.68333, 0, 0],\r\n        '920': [0, 0.68333, 0, 0],\r\n        '923': [0, 0.68333, 0, 0],\r\n        '926': [0, 0.68333, 0, 0],\r\n        '928': [0, 0.68333, 0, 0],\r\n        '931': [0, 0.68333, 0, 0],\r\n        '933': [0, 0.68333, 0, 0],\r\n        '934': [0, 0.68333, 0, 0],\r\n        '936': [0, 0.68333, 0, 0],\r\n        '937': [0, 0.68333, 0, 0],\r\n        '8211': [0, 0.43056, 0.02778, 0],\r\n        '8212': [0, 0.43056, 0.02778, 0],\r\n        '8216': [0, 0.69444, 0, 0],\r\n        '8217': [0, 0.69444, 0, 0],\r\n        '8220': [0, 0.69444, 0, 0],\r\n        '8221': [0, 0.69444, 0, 0],\r\n        '8224': [0.19444, 0.69444, 0, 0],\r\n        '8225': [0.19444, 0.69444, 0, 0],\r\n        '8230': [0, 0.12, 0, 0],\r\n        '8242': [0, 0.55556, 0, 0],\r\n        '8407': [0, 0.71444, 0.15382, 0],\r\n        '8463': [0, 0.68889, 0, 0],\r\n        '8465': [0, 0.69444, 0, 0],\r\n        '8467': [0, 0.69444, 0, 0.11111],\r\n        '8472': [0.19444, 0.43056, 0, 0.11111],\r\n        '8476': [0, 0.69444, 0, 0],\r\n        '8501': [0, 0.69444, 0, 0],\r\n        '8592': [-0.13313, 0.36687, 0, 0],\r\n        '8593': [0.19444, 0.69444, 0, 0],\r\n        '8594': [-0.13313, 0.36687, 0, 0],\r\n        '8595': [0.19444, 0.69444, 0, 0],\r\n        '8596': [-0.13313, 0.36687, 0, 0],\r\n        '8597': [0.25, 0.75, 0, 0],\r\n        '8598': [0.19444, 0.69444, 0, 0],\r\n        '8599': [0.19444, 0.69444, 0, 0],\r\n        '8600': [0.19444, 0.69444, 0, 0],\r\n        '8601': [0.19444, 0.69444, 0, 0],\r\n        '8614': [0.011, 0.511, 0, 0],\r\n        '8617': [0.011, 0.511, 0, 0],\r\n        '8618': [0.011, 0.511, 0, 0],\r\n        '8636': [-0.13313, 0.36687, 0, 0],\r\n        '8637': [-0.13313, 0.36687, 0, 0],\r\n        '8640': [-0.13313, 0.36687, 0, 0],\r\n        '8641': [-0.13313, 0.36687, 0, 0],\r\n        '8652': [0.011, 0.671, 0, 0],\r\n        '8656': [-0.13313, 0.36687, 0, 0],\r\n        '8657': [0.19444, 0.69444, 0, 0],\r\n        '8658': [-0.13313, 0.36687, 0, 0],\r\n        '8659': [0.19444, 0.69444, 0, 0],\r\n        '8660': [-0.13313, 0.36687, 0, 0],\r\n        '8661': [0.25, 0.75, 0, 0],\r\n        '8704': [0, 0.69444, 0, 0],\r\n        '8706': [0, 0.69444, 0.05556, 0.08334],\r\n        '8707': [0, 0.69444, 0, 0],\r\n        '8709': [0.05556, 0.75, 0, 0],\r\n        '8711': [0, 0.68333, 0, 0],\r\n        '8712': [0.0391, 0.5391, 0, 0],\r\n        '8715': [0.0391, 0.5391, 0, 0],\r\n        '8722': [0.08333, 0.58333, 0, 0],\r\n        '8723': [0.08333, 0.58333, 0, 0],\r\n        '8725': [0.25, 0.75, 0, 0],\r\n        '8726': [0.25, 0.75, 0, 0],\r\n        '8727': [-0.03472, 0.46528, 0, 0],\r\n        '8728': [-0.05555, 0.44445, 0, 0],\r\n        '8729': [-0.05555, 0.44445, 0, 0],\r\n        '8730': [0.2, 0.8, 0, 0],\r\n        '8733': [0, 0.43056, 0, 0],\r\n        '8734': [0, 0.43056, 0, 0],\r\n        '8736': [0, 0.69224, 0, 0],\r\n        '8739': [0.25, 0.75, 0, 0],\r\n        '8741': [0.25, 0.75, 0, 0],\r\n        '8743': [0, 0.55556, 0, 0],\r\n        '8744': [0, 0.55556, 0, 0],\r\n        '8745': [0, 0.55556, 0, 0],\r\n        '8746': [0, 0.55556, 0, 0],\r\n        '8747': [0.19444, 0.69444, 0.11111, 0],\r\n        '8764': [-0.13313, 0.36687, 0, 0],\r\n        '8768': [0.19444, 0.69444, 0, 0],\r\n        '8771': [-0.03625, 0.46375, 0, 0],\r\n        '8773': [-0.022, 0.589, 0, 0],\r\n        '8776': [-0.01688, 0.48312, 0, 0],\r\n        '8781': [-0.03625, 0.46375, 0, 0],\r\n        '8784': [-0.133, 0.67, 0, 0],\r\n        '8801': [-0.03625, 0.46375, 0, 0],\r\n        '8804': [0.13597, 0.63597, 0, 0],\r\n        '8805': [0.13597, 0.63597, 0, 0],\r\n        '8810': [0.0391, 0.5391, 0, 0],\r\n        '8811': [0.0391, 0.5391, 0, 0],\r\n        '8826': [0.0391, 0.5391, 0, 0],\r\n        '8827': [0.0391, 0.5391, 0, 0],\r\n        '8834': [0.0391, 0.5391, 0, 0],\r\n        '8835': [0.0391, 0.5391, 0, 0],\r\n        '8838': [0.13597, 0.63597, 0, 0],\r\n        '8839': [0.13597, 0.63597, 0, 0],\r\n        '8846': [0, 0.55556, 0, 0],\r\n        '8849': [0.13597, 0.63597, 0, 0],\r\n        '8850': [0.13597, 0.63597, 0, 0],\r\n        '8851': [0, 0.55556, 0, 0],\r\n        '8852': [0, 0.55556, 0, 0],\r\n        '8853': [0.08333, 0.58333, 0, 0],\r\n        '8854': [0.08333, 0.58333, 0, 0],\r\n        '8855': [0.08333, 0.58333, 0, 0],\r\n        '8856': [0.08333, 0.58333, 0, 0],\r\n        '8857': [0.08333, 0.58333, 0, 0],\r\n        '8866': [0, 0.69444, 0, 0],\r\n        '8867': [0, 0.69444, 0, 0],\r\n        '8868': [0, 0.69444, 0, 0],\r\n        '8869': [0, 0.69444, 0, 0],\r\n        '8872': [0.249, 0.75, 0, 0],\r\n        '8900': [-0.05555, 0.44445, 0, 0],\r\n        '8901': [-0.05555, 0.44445, 0, 0],\r\n        '8902': [-0.03472, 0.46528, 0, 0],\r\n        '8904': [0.005, 0.505, 0, 0],\r\n        '8942': [0.03, 0.9, 0, 0],\r\n        '8943': [-0.19, 0.31, 0, 0],\r\n        '8945': [-0.1, 0.82, 0, 0],\r\n        '8968': [0.25, 0.75, 0, 0],\r\n        '8969': [0.25, 0.75, 0, 0],\r\n        '8970': [0.25, 0.75, 0, 0],\r\n        '8971': [0.25, 0.75, 0, 0],\r\n        '8994': [-0.14236, 0.35764, 0, 0],\r\n        '8995': [-0.14236, 0.35764, 0, 0],\r\n        '9136': [0.244, 0.744, 0, 0],\r\n        '9137': [0.244, 0.744, 0, 0],\r\n        '9651': [0.19444, 0.69444, 0, 0],\r\n        '9657': [-0.03472, 0.46528, 0, 0],\r\n        '9661': [0.19444, 0.69444, 0, 0],\r\n        '9667': [-0.03472, 0.46528, 0, 0],\r\n        '9711': [0.19444, 0.69444, 0, 0],\r\n        '9824': [0.12963, 0.69444, 0, 0],\r\n        '9825': [0.12963, 0.69444, 0, 0],\r\n        '9826': [0.12963, 0.69444, 0, 0],\r\n        '9827': [0.12963, 0.69444, 0, 0],\r\n        '9837': [0, 0.75, 0, 0],\r\n        '9838': [0.19444, 0.69444, 0, 0],\r\n        '9839': [0.19444, 0.69444, 0, 0],\r\n        '10216': [0.25, 0.75, 0, 0],\r\n        '10217': [0.25, 0.75, 0, 0],\r\n        '10222': [0.244, 0.744, 0, 0],\r\n        '10223': [0.244, 0.744, 0, 0],\r\n        '10229': [0.011, 0.511, 0, 0],\r\n        '10230': [0.011, 0.511, 0, 0],\r\n        '10231': [0.011, 0.511, 0, 0],\r\n        '10232': [0.024, 0.525, 0, 0],\r\n        '10233': [0.024, 0.525, 0, 0],\r\n        '10234': [0.024, 0.525, 0, 0],\r\n        '10236': [0.011, 0.511, 0, 0],\r\n        '10815': [0, 0.68333, 0, 0],\r\n        '10927': [0.13597, 0.63597, 0, 0],\r\n        '10928': [0.13597, 0.63597, 0, 0],\r\n        '57376': [0.19444, 0.69444, 0, 0],\r\n    },\r\n    'Math-BoldItalic': {\r\n        '65': [0, 0.68611, 0, 0],\r\n        '66': [0, 0.68611, 0.04835, 0],\r\n        '67': [0, 0.68611, 0.06979, 0],\r\n        '68': [0, 0.68611, 0.03194, 0],\r\n        '69': [0, 0.68611, 0.05451, 0],\r\n        '70': [0, 0.68611, 0.15972, 0],\r\n        '71': [0, 0.68611, 0, 0],\r\n        '72': [0, 0.68611, 0.08229, 0],\r\n        '73': [0, 0.68611, 0.07778, 0],\r\n        '74': [0, 0.68611, 0.10069, 0],\r\n        '75': [0, 0.68611, 0.06979, 0],\r\n        '76': [0, 0.68611, 0, 0],\r\n        '77': [0, 0.68611, 0.11424, 0],\r\n        '78': [0, 0.68611, 0.11424, 0],\r\n        '79': [0, 0.68611, 0.03194, 0],\r\n        '80': [0, 0.68611, 0.15972, 0],\r\n        '81': [0.19444, 0.68611, 0, 0],\r\n        '82': [0, 0.68611, 0.00421, 0],\r\n        '83': [0, 0.68611, 0.05382, 0],\r\n        '84': [0, 0.68611, 0.15972, 0],\r\n        '85': [0, 0.68611, 0.11424, 0],\r\n        '86': [0, 0.68611, 0.25555, 0],\r\n        '87': [0, 0.68611, 0.15972, 0],\r\n        '88': [0, 0.68611, 0.07778, 0],\r\n        '89': [0, 0.68611, 0.25555, 0],\r\n        '90': [0, 0.68611, 0.06979, 0],\r\n        '97': [0, 0.44444, 0, 0],\r\n        '98': [0, 0.69444, 0, 0],\r\n        '99': [0, 0.44444, 0, 0],\r\n        '100': [0, 0.69444, 0, 0],\r\n        '101': [0, 0.44444, 0, 0],\r\n        '102': [0.19444, 0.69444, 0.11042, 0],\r\n        '103': [0.19444, 0.44444, 0.03704, 0],\r\n        '104': [0, 0.69444, 0, 0],\r\n        '105': [0, 0.69326, 0, 0],\r\n        '106': [0.19444, 0.69326, 0.0622, 0],\r\n        '107': [0, 0.69444, 0.01852, 0],\r\n        '108': [0, 0.69444, 0.0088, 0],\r\n        '109': [0, 0.44444, 0, 0],\r\n        '110': [0, 0.44444, 0, 0],\r\n        '111': [0, 0.44444, 0, 0],\r\n        '112': [0.19444, 0.44444, 0, 0],\r\n        '113': [0.19444, 0.44444, 0.03704, 0],\r\n        '114': [0, 0.44444, 0.03194, 0],\r\n        '115': [0, 0.44444, 0, 0],\r\n        '116': [0, 0.63492, 0, 0],\r\n        '117': [0, 0.44444, 0, 0],\r\n        '118': [0, 0.44444, 0.03704, 0],\r\n        '119': [0, 0.44444, 0.02778, 0],\r\n        '120': [0, 0.44444, 0, 0],\r\n        '121': [0.19444, 0.44444, 0.03704, 0],\r\n        '122': [0, 0.44444, 0.04213, 0],\r\n        '915': [0, 0.68611, 0.15972, 0],\r\n        '916': [0, 0.68611, 0, 0],\r\n        '920': [0, 0.68611, 0.03194, 0],\r\n        '923': [0, 0.68611, 0, 0],\r\n        '926': [0, 0.68611, 0.07458, 0],\r\n        '928': [0, 0.68611, 0.08229, 0],\r\n        '931': [0, 0.68611, 0.05451, 0],\r\n        '933': [0, 0.68611, 0.15972, 0],\r\n        '934': [0, 0.68611, 0, 0],\r\n        '936': [0, 0.68611, 0.11653, 0],\r\n        '937': [0, 0.68611, 0.04835, 0],\r\n        '945': [0, 0.44444, 0, 0],\r\n        '946': [0.19444, 0.69444, 0.03403, 0],\r\n        '947': [0.19444, 0.44444, 0.06389, 0],\r\n        '948': [0, 0.69444, 0.03819, 0],\r\n        '949': [0, 0.44444, 0, 0],\r\n        '950': [0.19444, 0.69444, 0.06215, 0],\r\n        '951': [0.19444, 0.44444, 0.03704, 0],\r\n        '952': [0, 0.69444, 0.03194, 0],\r\n        '953': [0, 0.44444, 0, 0],\r\n        '954': [0, 0.44444, 0, 0],\r\n        '955': [0, 0.69444, 0, 0],\r\n        '956': [0.19444, 0.44444, 0, 0],\r\n        '957': [0, 0.44444, 0.06898, 0],\r\n        '958': [0.19444, 0.69444, 0.03021, 0],\r\n        '959': [0, 0.44444, 0, 0],\r\n        '960': [0, 0.44444, 0.03704, 0],\r\n        '961': [0.19444, 0.44444, 0, 0],\r\n        '962': [0.09722, 0.44444, 0.07917, 0],\r\n        '963': [0, 0.44444, 0.03704, 0],\r\n        '964': [0, 0.44444, 0.13472, 0],\r\n        '965': [0, 0.44444, 0.03704, 0],\r\n        '966': [0.19444, 0.44444, 0, 0],\r\n        '967': [0.19444, 0.44444, 0, 0],\r\n        '968': [0.19444, 0.69444, 0.03704, 0],\r\n        '969': [0, 0.44444, 0.03704, 0],\r\n        '977': [0, 0.69444, 0, 0],\r\n        '981': [0.19444, 0.69444, 0, 0],\r\n        '982': [0, 0.44444, 0.03194, 0],\r\n        '1009': [0.19444, 0.44444, 0, 0],\r\n        '1013': [0, 0.44444, 0, 0],\r\n    },\r\n    'Math-Italic': {\r\n        '65': [0, 0.68333, 0, 0.13889],\r\n        '66': [0, 0.68333, 0.05017, 0.08334],\r\n        '67': [0, 0.68333, 0.07153, 0.08334],\r\n        '68': [0, 0.68333, 0.02778, 0.05556],\r\n        '69': [0, 0.68333, 0.05764, 0.08334],\r\n        '70': [0, 0.68333, 0.13889, 0.08334],\r\n        '71': [0, 0.68333, 0, 0.08334],\r\n        '72': [0, 0.68333, 0.08125, 0.05556],\r\n        '73': [0, 0.68333, 0.07847, 0.11111],\r\n        '74': [0, 0.68333, 0.09618, 0.16667],\r\n        '75': [0, 0.68333, 0.07153, 0.05556],\r\n        '76': [0, 0.68333, 0, 0.02778],\r\n        '77': [0, 0.68333, 0.10903, 0.08334],\r\n        '78': [0, 0.68333, 0.10903, 0.08334],\r\n        '79': [0, 0.68333, 0.02778, 0.08334],\r\n        '80': [0, 0.68333, 0.13889, 0.08334],\r\n        '81': [0.19444, 0.68333, 0, 0.08334],\r\n        '82': [0, 0.68333, 0.00773, 0.08334],\r\n        '83': [0, 0.68333, 0.05764, 0.08334],\r\n        '84': [0, 0.68333, 0.13889, 0.08334],\r\n        '85': [0, 0.68333, 0.10903, 0.02778],\r\n        '86': [0, 0.68333, 0.22222, 0],\r\n        '87': [0, 0.68333, 0.13889, 0],\r\n        '88': [0, 0.68333, 0.07847, 0.08334],\r\n        '89': [0, 0.68333, 0.22222, 0],\r\n        '90': [0, 0.68333, 0.07153, 0.08334],\r\n        '97': [0, 0.43056, 0, 0],\r\n        '98': [0, 0.69444, 0, 0],\r\n        '99': [0, 0.43056, 0, 0.05556],\r\n        '100': [0, 0.69444, 0, 0.16667],\r\n        '101': [0, 0.43056, 0, 0.05556],\r\n        '102': [0.19444, 0.69444, 0.10764, 0.16667],\r\n        '103': [0.19444, 0.43056, 0.03588, 0.02778],\r\n        '104': [0, 0.69444, 0, 0],\r\n        '105': [0, 0.65952, 0, 0],\r\n        '106': [0.19444, 0.65952, 0.05724, 0],\r\n        '107': [0, 0.69444, 0.03148, 0],\r\n        '108': [0, 0.69444, 0.01968, 0.08334],\r\n        '109': [0, 0.43056, 0, 0],\r\n        '110': [0, 0.43056, 0, 0],\r\n        '111': [0, 0.43056, 0, 0.05556],\r\n        '112': [0.19444, 0.43056, 0, 0.08334],\r\n        '113': [0.19444, 0.43056, 0.03588, 0.08334],\r\n        '114': [0, 0.43056, 0.02778, 0.05556],\r\n        '115': [0, 0.43056, 0, 0.05556],\r\n        '116': [0, 0.61508, 0, 0.08334],\r\n        '117': [0, 0.43056, 0, 0.02778],\r\n        '118': [0, 0.43056, 0.03588, 0.02778],\r\n        '119': [0, 0.43056, 0.02691, 0.08334],\r\n        '120': [0, 0.43056, 0, 0.02778],\r\n        '121': [0.19444, 0.43056, 0.03588, 0.05556],\r\n        '122': [0, 0.43056, 0.04398, 0.05556],\r\n        '915': [0, 0.68333, 0.13889, 0.08334],\r\n        '916': [0, 0.68333, 0, 0.16667],\r\n        '920': [0, 0.68333, 0.02778, 0.08334],\r\n        '923': [0, 0.68333, 0, 0.16667],\r\n        '926': [0, 0.68333, 0.07569, 0.08334],\r\n        '928': [0, 0.68333, 0.08125, 0.05556],\r\n        '931': [0, 0.68333, 0.05764, 0.08334],\r\n        '933': [0, 0.68333, 0.13889, 0.05556],\r\n        '934': [0, 0.68333, 0, 0.08334],\r\n        '936': [0, 0.68333, 0.11, 0.05556],\r\n        '937': [0, 0.68333, 0.05017, 0.08334],\r\n        '945': [0, 0.43056, 0.0037, 0.02778],\r\n        '946': [0.19444, 0.69444, 0.05278, 0.08334],\r\n        '947': [0.19444, 0.43056, 0.05556, 0],\r\n        '948': [0, 0.69444, 0.03785, 0.05556],\r\n        '949': [0, 0.43056, 0, 0.08334],\r\n        '950': [0.19444, 0.69444, 0.07378, 0.08334],\r\n        '951': [0.19444, 0.43056, 0.03588, 0.05556],\r\n        '952': [0, 0.69444, 0.02778, 0.08334],\r\n        '953': [0, 0.43056, 0, 0.05556],\r\n        '954': [0, 0.43056, 0, 0],\r\n        '955': [0, 0.69444, 0, 0],\r\n        '956': [0.19444, 0.43056, 0, 0.02778],\r\n        '957': [0, 0.43056, 0.06366, 0.02778],\r\n        '958': [0.19444, 0.69444, 0.04601, 0.11111],\r\n        '959': [0, 0.43056, 0, 0.05556],\r\n        '960': [0, 0.43056, 0.03588, 0],\r\n        '961': [0.19444, 0.43056, 0, 0.08334],\r\n        '962': [0.09722, 0.43056, 0.07986, 0.08334],\r\n        '963': [0, 0.43056, 0.03588, 0],\r\n        '964': [0, 0.43056, 0.1132, 0.02778],\r\n        '965': [0, 0.43056, 0.03588, 0.02778],\r\n        '966': [0.19444, 0.43056, 0, 0.08334],\r\n        '967': [0.19444, 0.43056, 0, 0.05556],\r\n        '968': [0.19444, 0.69444, 0.03588, 0.11111],\r\n        '969': [0, 0.43056, 0.03588, 0],\r\n        '977': [0, 0.69444, 0, 0.08334],\r\n        '981': [0.19444, 0.69444, 0, 0.08334],\r\n        '982': [0, 0.43056, 0.02778, 0],\r\n        '1009': [0.19444, 0.43056, 0, 0.08334],\r\n        '1013': [0, 0.43056, 0, 0.05556],\r\n    },\r\n    'SansSerif-Bold': {\r\n        '33': [0, 0.69444, 0, 0],\r\n        '34': [0, 0.69444, 0, 0],\r\n        '35': [0.19444, 0.69444, 0, 0],\r\n        '36': [0.05556, 0.75, 0, 0],\r\n        '37': [0.05556, 0.75, 0, 0],\r\n        '38': [0, 0.69444, 0, 0],\r\n        '39': [0, 0.69444, 0, 0],\r\n        '40': [0.25, 0.75, 0, 0],\r\n        '41': [0.25, 0.75, 0, 0],\r\n        '42': [0, 0.75, 0, 0],\r\n        '43': [0.11667, 0.61667, 0, 0],\r\n        '44': [0.10556, 0.13056, 0, 0],\r\n        '45': [0, 0.45833, 0, 0],\r\n        '46': [0, 0.13056, 0, 0],\r\n        '47': [0.25, 0.75, 0, 0],\r\n        '48': [0, 0.69444, 0, 0],\r\n        '49': [0, 0.69444, 0, 0],\r\n        '50': [0, 0.69444, 0, 0],\r\n        '51': [0, 0.69444, 0, 0],\r\n        '52': [0, 0.69444, 0, 0],\r\n        '53': [0, 0.69444, 0, 0],\r\n        '54': [0, 0.69444, 0, 0],\r\n        '55': [0, 0.69444, 0, 0],\r\n        '56': [0, 0.69444, 0, 0],\r\n        '57': [0, 0.69444, 0, 0],\r\n        '58': [0, 0.45833, 0, 0],\r\n        '59': [0.10556, 0.45833, 0, 0],\r\n        '61': [-0.09375, 0.40625, 0, 0],\r\n        '63': [0, 0.69444, 0, 0],\r\n        '64': [0, 0.69444, 0, 0],\r\n        '65': [0, 0.69444, 0, 0],\r\n        '66': [0, 0.69444, 0, 0],\r\n        '67': [0, 0.69444, 0, 0],\r\n        '68': [0, 0.69444, 0, 0],\r\n        '69': [0, 0.69444, 0, 0],\r\n        '70': [0, 0.69444, 0, 0],\r\n        '71': [0, 0.69444, 0, 0],\r\n        '72': [0, 0.69444, 0, 0],\r\n        '73': [0, 0.69444, 0, 0],\r\n        '74': [0, 0.69444, 0, 0],\r\n        '75': [0, 0.69444, 0, 0],\r\n        '76': [0, 0.69444, 0, 0],\r\n        '77': [0, 0.69444, 0, 0],\r\n        '78': [0, 0.69444, 0, 0],\r\n        '79': [0, 0.69444, 0, 0],\r\n        '80': [0, 0.69444, 0, 0],\r\n        '81': [0.10556, 0.69444, 0, 0],\r\n        '82': [0, 0.69444, 0, 0],\r\n        '83': [0, 0.69444, 0, 0],\r\n        '84': [0, 0.69444, 0, 0],\r\n        '85': [0, 0.69444, 0, 0],\r\n        '86': [0, 0.69444, 0.01528, 0],\r\n        '87': [0, 0.69444, 0.01528, 0],\r\n        '88': [0, 0.69444, 0, 0],\r\n        '89': [0, 0.69444, 0.0275, 0],\r\n        '90': [0, 0.69444, 0, 0],\r\n        '91': [0.25, 0.75, 0, 0],\r\n        '93': [0.25, 0.75, 0, 0],\r\n        '94': [0, 0.69444, 0, 0],\r\n        '95': [0.35, 0.10833, 0.03056, 0],\r\n        '97': [0, 0.45833, 0, 0],\r\n        '98': [0, 0.69444, 0, 0],\r\n        '99': [0, 0.45833, 0, 0],\r\n        '100': [0, 0.69444, 0, 0],\r\n        '101': [0, 0.45833, 0, 0],\r\n        '102': [0, 0.69444, 0.07639, 0],\r\n        '103': [0.19444, 0.45833, 0.01528, 0],\r\n        '104': [0, 0.69444, 0, 0],\r\n        '105': [0, 0.69444, 0, 0],\r\n        '106': [0.19444, 0.69444, 0, 0],\r\n        '107': [0, 0.69444, 0, 0],\r\n        '108': [0, 0.69444, 0, 0],\r\n        '109': [0, 0.45833, 0, 0],\r\n        '110': [0, 0.45833, 0, 0],\r\n        '111': [0, 0.45833, 0, 0],\r\n        '112': [0.19444, 0.45833, 0, 0],\r\n        '113': [0.19444, 0.45833, 0, 0],\r\n        '114': [0, 0.45833, 0.01528, 0],\r\n        '115': [0, 0.45833, 0, 0],\r\n        '116': [0, 0.58929, 0, 0],\r\n        '117': [0, 0.45833, 0, 0],\r\n        '118': [0, 0.45833, 0.01528, 0],\r\n        '119': [0, 0.45833, 0.01528, 0],\r\n        '120': [0, 0.45833, 0, 0],\r\n        '121': [0.19444, 0.45833, 0.01528, 0],\r\n        '122': [0, 0.45833, 0, 0],\r\n        '126': [0.35, 0.34444, 0, 0],\r\n        '168': [0, 0.69444, 0, 0],\r\n        '176': [0, 0.69444, 0, 0],\r\n        '180': [0, 0.69444, 0, 0],\r\n        '184': [0.17014, 0, 0, 0],\r\n        '305': [0, 0.45833, 0, 0],\r\n        '567': [0.19444, 0.45833, 0, 0],\r\n        '710': [0, 0.69444, 0, 0],\r\n        '711': [0, 0.63542, 0, 0],\r\n        '713': [0, 0.63778, 0, 0],\r\n        '728': [0, 0.69444, 0, 0],\r\n        '729': [0, 0.69444, 0, 0],\r\n        '730': [0, 0.69444, 0, 0],\r\n        '732': [0, 0.69444, 0, 0],\r\n        '733': [0, 0.69444, 0, 0],\r\n        '915': [0, 0.69444, 0, 0],\r\n        '916': [0, 0.69444, 0, 0],\r\n        '920': [0, 0.69444, 0, 0],\r\n        '923': [0, 0.69444, 0, 0],\r\n        '926': [0, 0.69444, 0, 0],\r\n        '928': [0, 0.69444, 0, 0],\r\n        '931': [0, 0.69444, 0, 0],\r\n        '933': [0, 0.69444, 0, 0],\r\n        '934': [0, 0.69444, 0, 0],\r\n        '936': [0, 0.69444, 0, 0],\r\n        '937': [0, 0.69444, 0, 0],\r\n        '8211': [0, 0.45833, 0.03056, 0],\r\n        '8212': [0, 0.45833, 0.03056, 0],\r\n        '8216': [0, 0.69444, 0, 0],\r\n        '8217': [0, 0.69444, 0, 0],\r\n        '8220': [0, 0.69444, 0, 0],\r\n        '8221': [0, 0.69444, 0, 0],\r\n    },\r\n    'SansSerif-Italic': {\r\n        '33': [0, 0.69444, 0.05733, 0],\r\n        '34': [0, 0.69444, 0.00316, 0],\r\n        '35': [0.19444, 0.69444, 0.05087, 0],\r\n        '36': [0.05556, 0.75, 0.11156, 0],\r\n        '37': [0.05556, 0.75, 0.03126, 0],\r\n        '38': [0, 0.69444, 0.03058, 0],\r\n        '39': [0, 0.69444, 0.07816, 0],\r\n        '40': [0.25, 0.75, 0.13164, 0],\r\n        '41': [0.25, 0.75, 0.02536, 0],\r\n        '42': [0, 0.75, 0.11775, 0],\r\n        '43': [0.08333, 0.58333, 0.02536, 0],\r\n        '44': [0.125, 0.08333, 0, 0],\r\n        '45': [0, 0.44444, 0.01946, 0],\r\n        '46': [0, 0.08333, 0, 0],\r\n        '47': [0.25, 0.75, 0.13164, 0],\r\n        '48': [0, 0.65556, 0.11156, 0],\r\n        '49': [0, 0.65556, 0.11156, 0],\r\n        '50': [0, 0.65556, 0.11156, 0],\r\n        '51': [0, 0.65556, 0.11156, 0],\r\n        '52': [0, 0.65556, 0.11156, 0],\r\n        '53': [0, 0.65556, 0.11156, 0],\r\n        '54': [0, 0.65556, 0.11156, 0],\r\n        '55': [0, 0.65556, 0.11156, 0],\r\n        '56': [0, 0.65556, 0.11156, 0],\r\n        '57': [0, 0.65556, 0.11156, 0],\r\n        '58': [0, 0.44444, 0.02502, 0],\r\n        '59': [0.125, 0.44444, 0.02502, 0],\r\n        '61': [-0.13, 0.37, 0.05087, 0],\r\n        '63': [0, 0.69444, 0.11809, 0],\r\n        '64': [0, 0.69444, 0.07555, 0],\r\n        '65': [0, 0.69444, 0, 0],\r\n        '66': [0, 0.69444, 0.08293, 0],\r\n        '67': [0, 0.69444, 0.11983, 0],\r\n        '68': [0, 0.69444, 0.07555, 0],\r\n        '69': [0, 0.69444, 0.11983, 0],\r\n        '70': [0, 0.69444, 0.13372, 0],\r\n        '71': [0, 0.69444, 0.11983, 0],\r\n        '72': [0, 0.69444, 0.08094, 0],\r\n        '73': [0, 0.69444, 0.13372, 0],\r\n        '74': [0, 0.69444, 0.08094, 0],\r\n        '75': [0, 0.69444, 0.11983, 0],\r\n        '76': [0, 0.69444, 0, 0],\r\n        '77': [0, 0.69444, 0.08094, 0],\r\n        '78': [0, 0.69444, 0.08094, 0],\r\n        '79': [0, 0.69444, 0.07555, 0],\r\n        '80': [0, 0.69444, 0.08293, 0],\r\n        '81': [0.125, 0.69444, 0.07555, 0],\r\n        '82': [0, 0.69444, 0.08293, 0],\r\n        '83': [0, 0.69444, 0.09205, 0],\r\n        '84': [0, 0.69444, 0.13372, 0],\r\n        '85': [0, 0.69444, 0.08094, 0],\r\n        '86': [0, 0.69444, 0.1615, 0],\r\n        '87': [0, 0.69444, 0.1615, 0],\r\n        '88': [0, 0.69444, 0.13372, 0],\r\n        '89': [0, 0.69444, 0.17261, 0],\r\n        '90': [0, 0.69444, 0.11983, 0],\r\n        '91': [0.25, 0.75, 0.15942, 0],\r\n        '93': [0.25, 0.75, 0.08719, 0],\r\n        '94': [0, 0.69444, 0.0799, 0],\r\n        '95': [0.35, 0.09444, 0.08616, 0],\r\n        '97': [0, 0.44444, 0.00981, 0],\r\n        '98': [0, 0.69444, 0.03057, 0],\r\n        '99': [0, 0.44444, 0.08336, 0],\r\n        '100': [0, 0.69444, 0.09483, 0],\r\n        '101': [0, 0.44444, 0.06778, 0],\r\n        '102': [0, 0.69444, 0.21705, 0],\r\n        '103': [0.19444, 0.44444, 0.10836, 0],\r\n        '104': [0, 0.69444, 0.01778, 0],\r\n        '105': [0, 0.67937, 0.09718, 0],\r\n        '106': [0.19444, 0.67937, 0.09162, 0],\r\n        '107': [0, 0.69444, 0.08336, 0],\r\n        '108': [0, 0.69444, 0.09483, 0],\r\n        '109': [0, 0.44444, 0.01778, 0],\r\n        '110': [0, 0.44444, 0.01778, 0],\r\n        '111': [0, 0.44444, 0.06613, 0],\r\n        '112': [0.19444, 0.44444, 0.0389, 0],\r\n        '113': [0.19444, 0.44444, 0.04169, 0],\r\n        '114': [0, 0.44444, 0.10836, 0],\r\n        '115': [0, 0.44444, 0.0778, 0],\r\n        '116': [0, 0.57143, 0.07225, 0],\r\n        '117': [0, 0.44444, 0.04169, 0],\r\n        '118': [0, 0.44444, 0.10836, 0],\r\n        '119': [0, 0.44444, 0.10836, 0],\r\n        '120': [0, 0.44444, 0.09169, 0],\r\n        '121': [0.19444, 0.44444, 0.10836, 0],\r\n        '122': [0, 0.44444, 0.08752, 0],\r\n        '126': [0.35, 0.32659, 0.08826, 0],\r\n        '168': [0, 0.67937, 0.06385, 0],\r\n        '176': [0, 0.69444, 0, 0],\r\n        '184': [0.17014, 0, 0, 0],\r\n        '305': [0, 0.44444, 0.04169, 0],\r\n        '567': [0.19444, 0.44444, 0.04169, 0],\r\n        '710': [0, 0.69444, 0.0799, 0],\r\n        '711': [0, 0.63194, 0.08432, 0],\r\n        '713': [0, 0.60889, 0.08776, 0],\r\n        '714': [0, 0.69444, 0.09205, 0],\r\n        '715': [0, 0.69444, 0, 0],\r\n        '728': [0, 0.69444, 0.09483, 0],\r\n        '729': [0, 0.67937, 0.07774, 0],\r\n        '730': [0, 0.69444, 0, 0],\r\n        '732': [0, 0.67659, 0.08826, 0],\r\n        '733': [0, 0.69444, 0.09205, 0],\r\n        '915': [0, 0.69444, 0.13372, 0],\r\n        '916': [0, 0.69444, 0, 0],\r\n        '920': [0, 0.69444, 0.07555, 0],\r\n        '923': [0, 0.69444, 0, 0],\r\n        '926': [0, 0.69444, 0.12816, 0],\r\n        '928': [0, 0.69444, 0.08094, 0],\r\n        '931': [0, 0.69444, 0.11983, 0],\r\n        '933': [0, 0.69444, 0.09031, 0],\r\n        '934': [0, 0.69444, 0.04603, 0],\r\n        '936': [0, 0.69444, 0.09031, 0],\r\n        '937': [0, 0.69444, 0.08293, 0],\r\n        '8211': [0, 0.44444, 0.08616, 0],\r\n        '8212': [0, 0.44444, 0.08616, 0],\r\n        '8216': [0, 0.69444, 0.07816, 0],\r\n        '8217': [0, 0.69444, 0.07816, 0],\r\n        '8220': [0, 0.69444, 0.14205, 0],\r\n        '8221': [0, 0.69444, 0.00316, 0],\r\n    },\r\n    'SansSerif-Regular': {\r\n        '33': [0, 0.69444, 0, 0],\r\n        '34': [0, 0.69444, 0, 0],\r\n        '35': [0.19444, 0.69444, 0, 0],\r\n        '36': [0.05556, 0.75, 0, 0],\r\n        '37': [0.05556, 0.75, 0, 0],\r\n        '38': [0, 0.69444, 0, 0],\r\n        '39': [0, 0.69444, 0, 0],\r\n        '40': [0.25, 0.75, 0, 0],\r\n        '41': [0.25, 0.75, 0, 0],\r\n        '42': [0, 0.75, 0, 0],\r\n        '43': [0.08333, 0.58333, 0, 0],\r\n        '44': [0.125, 0.08333, 0, 0],\r\n        '45': [0, 0.44444, 0, 0],\r\n        '46': [0, 0.08333, 0, 0],\r\n        '47': [0.25, 0.75, 0, 0],\r\n        '48': [0, 0.65556, 0, 0],\r\n        '49': [0, 0.65556, 0, 0],\r\n        '50': [0, 0.65556, 0, 0],\r\n        '51': [0, 0.65556, 0, 0],\r\n        '52': [0, 0.65556, 0, 0],\r\n        '53': [0, 0.65556, 0, 0],\r\n        '54': [0, 0.65556, 0, 0],\r\n        '55': [0, 0.65556, 0, 0],\r\n        '56': [0, 0.65556, 0, 0],\r\n        '57': [0, 0.65556, 0, 0],\r\n        '58': [0, 0.44444, 0, 0],\r\n        '59': [0.125, 0.44444, 0, 0],\r\n        '61': [-0.13, 0.37, 0, 0],\r\n        '63': [0, 0.69444, 0, 0],\r\n        '64': [0, 0.69444, 0, 0],\r\n        '65': [0, 0.69444, 0, 0],\r\n        '66': [0, 0.69444, 0, 0],\r\n        '67': [0, 0.69444, 0, 0],\r\n        '68': [0, 0.69444, 0, 0],\r\n        '69': [0, 0.69444, 0, 0],\r\n        '70': [0, 0.69444, 0, 0],\r\n        '71': [0, 0.69444, 0, 0],\r\n        '72': [0, 0.69444, 0, 0],\r\n        '73': [0, 0.69444, 0, 0],\r\n        '74': [0, 0.69444, 0, 0],\r\n        '75': [0, 0.69444, 0, 0],\r\n        '76': [0, 0.69444, 0, 0],\r\n        '77': [0, 0.69444, 0, 0],\r\n        '78': [0, 0.69444, 0, 0],\r\n        '79': [0, 0.69444, 0, 0],\r\n        '80': [0, 0.69444, 0, 0],\r\n        '81': [0.125, 0.69444, 0, 0],\r\n        '82': [0, 0.69444, 0, 0],\r\n        '83': [0, 0.69444, 0, 0],\r\n        '84': [0, 0.69444, 0, 0],\r\n        '85': [0, 0.69444, 0, 0],\r\n        '86': [0, 0.69444, 0.01389, 0],\r\n        '87': [0, 0.69444, 0.01389, 0],\r\n        '88': [0, 0.69444, 0, 0],\r\n        '89': [0, 0.69444, 0.025, 0],\r\n        '90': [0, 0.69444, 0, 0],\r\n        '91': [0.25, 0.75, 0, 0],\r\n        '93': [0.25, 0.75, 0, 0],\r\n        '94': [0, 0.69444, 0, 0],\r\n        '95': [0.35, 0.09444, 0.02778, 0],\r\n        '97': [0, 0.44444, 0, 0],\r\n        '98': [0, 0.69444, 0, 0],\r\n        '99': [0, 0.44444, 0, 0],\r\n        '100': [0, 0.69444, 0, 0],\r\n        '101': [0, 0.44444, 0, 0],\r\n        '102': [0, 0.69444, 0.06944, 0],\r\n        '103': [0.19444, 0.44444, 0.01389, 0],\r\n        '104': [0, 0.69444, 0, 0],\r\n        '105': [0, 0.67937, 0, 0],\r\n        '106': [0.19444, 0.67937, 0, 0],\r\n        '107': [0, 0.69444, 0, 0],\r\n        '108': [0, 0.69444, 0, 0],\r\n        '109': [0, 0.44444, 0, 0],\r\n        '110': [0, 0.44444, 0, 0],\r\n        '111': [0, 0.44444, 0, 0],\r\n        '112': [0.19444, 0.44444, 0, 0],\r\n        '113': [0.19444, 0.44444, 0, 0],\r\n        '114': [0, 0.44444, 0.01389, 0],\r\n        '115': [0, 0.44444, 0, 0],\r\n        '116': [0, 0.57143, 0, 0],\r\n        '117': [0, 0.44444, 0, 0],\r\n        '118': [0, 0.44444, 0.01389, 0],\r\n        '119': [0, 0.44444, 0.01389, 0],\r\n        '120': [0, 0.44444, 0, 0],\r\n        '121': [0.19444, 0.44444, 0.01389, 0],\r\n        '122': [0, 0.44444, 0, 0],\r\n        '126': [0.35, 0.32659, 0, 0],\r\n        '168': [0, 0.67937, 0, 0],\r\n        '176': [0, 0.69444, 0, 0],\r\n        '184': [0.17014, 0, 0, 0],\r\n        '305': [0, 0.44444, 0, 0],\r\n        '567': [0.19444, 0.44444, 0, 0],\r\n        '710': [0, 0.69444, 0, 0],\r\n        '711': [0, 0.63194, 0, 0],\r\n        '713': [0, 0.60889, 0, 0],\r\n        '714': [0, 0.69444, 0, 0],\r\n        '715': [0, 0.69444, 0, 0],\r\n        '728': [0, 0.69444, 0, 0],\r\n        '729': [0, 0.67937, 0, 0],\r\n        '730': [0, 0.69444, 0, 0],\r\n        '732': [0, 0.67659, 0, 0],\r\n        '733': [0, 0.69444, 0, 0],\r\n        '915': [0, 0.69444, 0, 0],\r\n        '916': [0, 0.69444, 0, 0],\r\n        '920': [0, 0.69444, 0, 0],\r\n        '923': [0, 0.69444, 0, 0],\r\n        '926': [0, 0.69444, 0, 0],\r\n        '928': [0, 0.69444, 0, 0],\r\n        '931': [0, 0.69444, 0, 0],\r\n        '933': [0, 0.69444, 0, 0],\r\n        '934': [0, 0.69444, 0, 0],\r\n        '936': [0, 0.69444, 0, 0],\r\n        '937': [0, 0.69444, 0, 0],\r\n        '8211': [0, 0.44444, 0.02778, 0],\r\n        '8212': [0, 0.44444, 0.02778, 0],\r\n        '8216': [0, 0.69444, 0, 0],\r\n        '8217': [0, 0.69444, 0, 0],\r\n        '8220': [0, 0.69444, 0, 0],\r\n        '8221': [0, 0.69444, 0, 0],\r\n    },\r\n    'Script-Regular': {\r\n        '65': [0, 0.7, 0.22925, 0],\r\n        '66': [0, 0.7, 0.04087, 0],\r\n        '67': [0, 0.7, 0.1689, 0],\r\n        '68': [0, 0.7, 0.09371, 0],\r\n        '69': [0, 0.7, 0.18583, 0],\r\n        '70': [0, 0.7, 0.13634, 0],\r\n        '71': [0, 0.7, 0.17322, 0],\r\n        '72': [0, 0.7, 0.29694, 0],\r\n        '73': [0, 0.7, 0.19189, 0],\r\n        '74': [0.27778, 0.7, 0.19189, 0],\r\n        '75': [0, 0.7, 0.31259, 0],\r\n        '76': [0, 0.7, 0.19189, 0],\r\n        '77': [0, 0.7, 0.15981, 0],\r\n        '78': [0, 0.7, 0.3525, 0],\r\n        '79': [0, 0.7, 0.08078, 0],\r\n        '80': [0, 0.7, 0.08078, 0],\r\n        '81': [0, 0.7, 0.03305, 0],\r\n        '82': [0, 0.7, 0.06259, 0],\r\n        '83': [0, 0.7, 0.19189, 0],\r\n        '84': [0, 0.7, 0.29087, 0],\r\n        '85': [0, 0.7, 0.25815, 0],\r\n        '86': [0, 0.7, 0.27523, 0],\r\n        '87': [0, 0.7, 0.27523, 0],\r\n        '88': [0, 0.7, 0.26006, 0],\r\n        '89': [0, 0.7, 0.2939, 0],\r\n        '90': [0, 0.7, 0.24037, 0],\r\n    },\r\n    'Size1-Regular': {\r\n        '40': [0.35001, 0.85, 0, 0],\r\n        '41': [0.35001, 0.85, 0, 0],\r\n        '47': [0.35001, 0.85, 0, 0],\r\n        '91': [0.35001, 0.85, 0, 0],\r\n        '92': [0.35001, 0.85, 0, 0],\r\n        '93': [0.35001, 0.85, 0, 0],\r\n        '123': [0.35001, 0.85, 0, 0],\r\n        '125': [0.35001, 0.85, 0, 0],\r\n        '710': [0, 0.72222, 0, 0],\r\n        '732': [0, 0.72222, 0, 0],\r\n        '770': [0, 0.72222, 0, 0],\r\n        '771': [0, 0.72222, 0, 0],\r\n        '8214': [-0.00099, 0.601, 0, 0],\r\n        '8593': [1e-5, 0.6, 0, 0],\r\n        '8595': [1e-5, 0.6, 0, 0],\r\n        '8657': [1e-5, 0.6, 0, 0],\r\n        '8659': [1e-5, 0.6, 0, 0],\r\n        '8719': [0.25001, 0.75, 0, 0],\r\n        '8720': [0.25001, 0.75, 0, 0],\r\n        '8721': [0.25001, 0.75, 0, 0],\r\n        '8730': [0.35001, 0.85, 0, 0],\r\n        '8739': [-0.00599, 0.606, 0, 0],\r\n        '8741': [-0.00599, 0.606, 0, 0],\r\n        '8747': [0.30612, 0.805, 0.19445, 0],\r\n        '8748': [0.306, 0.805, 0.19445, 0],\r\n        '8749': [0.306, 0.805, 0.19445, 0],\r\n        '8750': [0.30612, 0.805, 0.19445, 0],\r\n        '8896': [0.25001, 0.75, 0, 0],\r\n        '8897': [0.25001, 0.75, 0, 0],\r\n        '8898': [0.25001, 0.75, 0, 0],\r\n        '8899': [0.25001, 0.75, 0, 0],\r\n        '8968': [0.35001, 0.85, 0, 0],\r\n        '8969': [0.35001, 0.85, 0, 0],\r\n        '8970': [0.35001, 0.85, 0, 0],\r\n        '8971': [0.35001, 0.85, 0, 0],\r\n        '9168': [-0.00099, 0.601, 0, 0],\r\n        '10216': [0.35001, 0.85, 0, 0],\r\n        '10217': [0.35001, 0.85, 0, 0],\r\n        '10752': [0.25001, 0.75, 0, 0],\r\n        '10753': [0.25001, 0.75, 0, 0],\r\n        '10754': [0.25001, 0.75, 0, 0],\r\n        '10756': [0.25001, 0.75, 0, 0],\r\n        '10758': [0.25001, 0.75, 0, 0],\r\n    },\r\n    'Size2-Regular': {\r\n        '40': [0.65002, 1.15, 0, 0],\r\n        '41': [0.65002, 1.15, 0, 0],\r\n        '47': [0.65002, 1.15, 0, 0],\r\n        '91': [0.65002, 1.15, 0, 0],\r\n        '92': [0.65002, 1.15, 0, 0],\r\n        '93': [0.65002, 1.15, 0, 0],\r\n        '123': [0.65002, 1.15, 0, 0],\r\n        '125': [0.65002, 1.15, 0, 0],\r\n        '710': [0, 0.75, 0, 0],\r\n        '732': [0, 0.75, 0, 0],\r\n        '770': [0, 0.75, 0, 0],\r\n        '771': [0, 0.75, 0, 0],\r\n        '8719': [0.55001, 1.05, 0, 0],\r\n        '8720': [0.55001, 1.05, 0, 0],\r\n        '8721': [0.55001, 1.05, 0, 0],\r\n        '8730': [0.65002, 1.15, 0, 0],\r\n        '8747': [0.86225, 1.36, 0.44445, 0],\r\n        '8748': [0.862, 1.36, 0.44445, 0],\r\n        '8749': [0.862, 1.36, 0.44445, 0],\r\n        '8750': [0.86225, 1.36, 0.44445, 0],\r\n        '8896': [0.55001, 1.05, 0, 0],\r\n        '8897': [0.55001, 1.05, 0, 0],\r\n        '8898': [0.55001, 1.05, 0, 0],\r\n        '8899': [0.55001, 1.05, 0, 0],\r\n        '8968': [0.65002, 1.15, 0, 0],\r\n        '8969': [0.65002, 1.15, 0, 0],\r\n        '8970': [0.65002, 1.15, 0, 0],\r\n        '8971': [0.65002, 1.15, 0, 0],\r\n        '10216': [0.65002, 1.15, 0, 0],\r\n        '10217': [0.65002, 1.15, 0, 0],\r\n        '10752': [0.55001, 1.05, 0, 0],\r\n        '10753': [0.55001, 1.05, 0, 0],\r\n        '10754': [0.55001, 1.05, 0, 0],\r\n        '10756': [0.55001, 1.05, 0, 0],\r\n        '10758': [0.55001, 1.05, 0, 0],\r\n    },\r\n    'Size3-Regular': {\r\n        '40': [0.95003, 1.45, 0, 0],\r\n        '41': [0.95003, 1.45, 0, 0],\r\n        '47': [0.95003, 1.45, 0, 0],\r\n        '91': [0.95003, 1.45, 0, 0],\r\n        '92': [0.95003, 1.45, 0, 0],\r\n        '93': [0.95003, 1.45, 0, 0],\r\n        '123': [0.95003, 1.45, 0, 0],\r\n        '125': [0.95003, 1.45, 0, 0],\r\n        '710': [0, 0.75, 0, 0],\r\n        '732': [0, 0.75, 0, 0],\r\n        '770': [0, 0.75, 0, 0],\r\n        '771': [0, 0.75, 0, 0],\r\n        '8730': [0.95003, 1.45, 0, 0],\r\n        '8968': [0.95003, 1.45, 0, 0],\r\n        '8969': [0.95003, 1.45, 0, 0],\r\n        '8970': [0.95003, 1.45, 0, 0],\r\n        '8971': [0.95003, 1.45, 0, 0],\r\n        '10216': [0.95003, 1.45, 0, 0],\r\n        '10217': [0.95003, 1.45, 0, 0],\r\n    },\r\n    'Size4-Regular': {\r\n        '40': [1.25003, 1.75, 0, 0],\r\n        '41': [1.25003, 1.75, 0, 0],\r\n        '47': [1.25003, 1.75, 0, 0],\r\n        '91': [1.25003, 1.75, 0, 0],\r\n        '92': [1.25003, 1.75, 0, 0],\r\n        '93': [1.25003, 1.75, 0, 0],\r\n        '123': [1.25003, 1.75, 0, 0],\r\n        '125': [1.25003, 1.75, 0, 0],\r\n        '710': [0, 0.825, 0, 0],\r\n        '732': [0, 0.825, 0, 0],\r\n        '770': [0, 0.825, 0, 0],\r\n        '771': [0, 0.825, 0, 0],\r\n        '8730': [1.25003, 1.75, 0, 0],\r\n        '8968': [1.25003, 1.75, 0, 0],\r\n        '8969': [1.25003, 1.75, 0, 0],\r\n        '8970': [1.25003, 1.75, 0, 0],\r\n        '8971': [1.25003, 1.75, 0, 0],\r\n        '9115': [0.64502, 1.155, 0, 0],\r\n        '9116': [1e-5, 0.6, 0, 0],\r\n        '9117': [0.64502, 1.155, 0, 0],\r\n        '9118': [0.64502, 1.155, 0, 0],\r\n        '9119': [1e-5, 0.6, 0, 0],\r\n        '9120': [0.64502, 1.155, 0, 0],\r\n        '9121': [0.64502, 1.155, 0, 0],\r\n        '9122': [-0.00099, 0.601, 0, 0],\r\n        '9123': [0.64502, 1.155, 0, 0],\r\n        '9124': [0.64502, 1.155, 0, 0],\r\n        '9125': [-0.00099, 0.601, 0, 0],\r\n        '9126': [0.64502, 1.155, 0, 0],\r\n        '9127': [1e-5, 0.9, 0, 0],\r\n        '9128': [0.65002, 1.15, 0, 0],\r\n        '9129': [0.90001, 0, 0, 0],\r\n        '9130': [0, 0.3, 0, 0],\r\n        '9131': [1e-5, 0.9, 0, 0],\r\n        '9132': [0.65002, 1.15, 0, 0],\r\n        '9133': [0.90001, 0, 0, 0],\r\n        '9143': [0.88502, 0.915, 0, 0],\r\n        '10216': [1.25003, 1.75, 0, 0],\r\n        '10217': [1.25003, 1.75, 0, 0],\r\n        '57344': [-0.00499, 0.605, 0, 0],\r\n        '57345': [-0.00499, 0.605, 0, 0],\r\n        '57680': [0, 0.12, 0, 0],\r\n        '57681': [0, 0.12, 0, 0],\r\n        '57682': [0, 0.12, 0, 0],\r\n        '57683': [0, 0.12, 0, 0],\r\n    },\r\n    'Typewriter-Regular': {\r\n        '32': [0, 0, 0, 0],\r\n        '33': [0, 0.61111, 0, 0],\r\n        '34': [0, 0.61111, 0, 0],\r\n        '35': [0, 0.61111, 0, 0],\r\n        '36': [0.08333, 0.69444, 0, 0],\r\n        '37': [0.08333, 0.69444, 0, 0],\r\n        '38': [0, 0.61111, 0, 0],\r\n        '39': [0, 0.61111, 0, 0],\r\n        '40': [0.08333, 0.69444, 0, 0],\r\n        '41': [0.08333, 0.69444, 0, 0],\r\n        '42': [0, 0.52083, 0, 0],\r\n        '43': [-0.08056, 0.53055, 0, 0],\r\n        '44': [0.13889, 0.125, 0, 0],\r\n        '45': [-0.08056, 0.53055, 0, 0],\r\n        '46': [0, 0.125, 0, 0],\r\n        '47': [0.08333, 0.69444, 0, 0],\r\n        '48': [0, 0.61111, 0, 0],\r\n        '49': [0, 0.61111, 0, 0],\r\n        '50': [0, 0.61111, 0, 0],\r\n        '51': [0, 0.61111, 0, 0],\r\n        '52': [0, 0.61111, 0, 0],\r\n        '53': [0, 0.61111, 0, 0],\r\n        '54': [0, 0.61111, 0, 0],\r\n        '55': [0, 0.61111, 0, 0],\r\n        '56': [0, 0.61111, 0, 0],\r\n        '57': [0, 0.61111, 0, 0],\r\n        '58': [0, 0.43056, 0, 0],\r\n        '59': [0.13889, 0.43056, 0, 0],\r\n        '60': [-0.05556, 0.55556, 0, 0],\r\n        '61': [-0.19549, 0.41562, 0, 0],\r\n        '62': [-0.05556, 0.55556, 0, 0],\r\n        '63': [0, 0.61111, 0, 0],\r\n        '64': [0, 0.61111, 0, 0],\r\n        '65': [0, 0.61111, 0, 0],\r\n        '66': [0, 0.61111, 0, 0],\r\n        '67': [0, 0.61111, 0, 0],\r\n        '68': [0, 0.61111, 0, 0],\r\n        '69': [0, 0.61111, 0, 0],\r\n        '70': [0, 0.61111, 0, 0],\r\n        '71': [0, 0.61111, 0, 0],\r\n        '72': [0, 0.61111, 0, 0],\r\n        '73': [0, 0.61111, 0, 0],\r\n        '74': [0, 0.61111, 0, 0],\r\n        '75': [0, 0.61111, 0, 0],\r\n        '76': [0, 0.61111, 0, 0],\r\n        '77': [0, 0.61111, 0, 0],\r\n        '78': [0, 0.61111, 0, 0],\r\n        '79': [0, 0.61111, 0, 0],\r\n        '80': [0, 0.61111, 0, 0],\r\n        '81': [0.13889, 0.61111, 0, 0],\r\n        '82': [0, 0.61111, 0, 0],\r\n        '83': [0, 0.61111, 0, 0],\r\n        '84': [0, 0.61111, 0, 0],\r\n        '85': [0, 0.61111, 0, 0],\r\n        '86': [0, 0.61111, 0, 0],\r\n        '87': [0, 0.61111, 0, 0],\r\n        '88': [0, 0.61111, 0, 0],\r\n        '89': [0, 0.61111, 0, 0],\r\n        '90': [0, 0.61111, 0, 0],\r\n        '91': [0.08333, 0.69444, 0, 0],\r\n        '92': [0.08333, 0.69444, 0, 0],\r\n        '93': [0.08333, 0.69444, 0, 0],\r\n        '94': [0, 0.61111, 0, 0],\r\n        '95': [0.09514, 0, 0, 0],\r\n        '96': [0, 0.61111, 0, 0],\r\n        '97': [0, 0.43056, 0, 0],\r\n        '98': [0, 0.61111, 0, 0],\r\n        '99': [0, 0.43056, 0, 0],\r\n        '100': [0, 0.61111, 0, 0],\r\n        '101': [0, 0.43056, 0, 0],\r\n        '102': [0, 0.61111, 0, 0],\r\n        '103': [0.22222, 0.43056, 0, 0],\r\n        '104': [0, 0.61111, 0, 0],\r\n        '105': [0, 0.61111, 0, 0],\r\n        '106': [0.22222, 0.61111, 0, 0],\r\n        '107': [0, 0.61111, 0, 0],\r\n        '108': [0, 0.61111, 0, 0],\r\n        '109': [0, 0.43056, 0, 0],\r\n        '110': [0, 0.43056, 0, 0],\r\n        '111': [0, 0.43056, 0, 0],\r\n        '112': [0.22222, 0.43056, 0, 0],\r\n        '113': [0.22222, 0.43056, 0, 0],\r\n        '114': [0, 0.43056, 0, 0],\r\n        '115': [0, 0.43056, 0, 0],\r\n        '116': [0, 0.55358, 0, 0],\r\n        '117': [0, 0.43056, 0, 0],\r\n        '118': [0, 0.43056, 0, 0],\r\n        '119': [0, 0.43056, 0, 0],\r\n        '120': [0, 0.43056, 0, 0],\r\n        '121': [0.22222, 0.43056, 0, 0],\r\n        '122': [0, 0.43056, 0, 0],\r\n        '123': [0.08333, 0.69444, 0, 0],\r\n        '124': [0.08333, 0.69444, 0, 0],\r\n        '125': [0.08333, 0.69444, 0, 0],\r\n        '126': [0, 0.61111, 0, 0],\r\n        '127': [0, 0.61111, 0, 0],\r\n        '160': [0, 0, 0, 0],\r\n        '176': [0, 0.61111, 0, 0],\r\n        '184': [0.19445, 0, 0, 0],\r\n        '305': [0, 0.43056, 0, 0],\r\n        '567': [0.22222, 0.43056, 0, 0],\r\n        '711': [0, 0.56597, 0, 0],\r\n        '713': [0, 0.56555, 0, 0],\r\n        '714': [0, 0.61111, 0, 0],\r\n        '715': [0, 0.61111, 0, 0],\r\n        '728': [0, 0.61111, 0, 0],\r\n        '730': [0, 0.61111, 0, 0],\r\n        '770': [0, 0.61111, 0, 0],\r\n        '771': [0, 0.61111, 0, 0],\r\n        '776': [0, 0.61111, 0, 0],\r\n        '915': [0, 0.61111, 0, 0],\r\n        '916': [0, 0.61111, 0, 0],\r\n        '920': [0, 0.61111, 0, 0],\r\n        '923': [0, 0.61111, 0, 0],\r\n        '926': [0, 0.61111, 0, 0],\r\n        '928': [0, 0.61111, 0, 0],\r\n        '931': [0, 0.61111, 0, 0],\r\n        '933': [0, 0.61111, 0, 0],\r\n        '934': [0, 0.61111, 0, 0],\r\n        '936': [0, 0.61111, 0, 0],\r\n        '937': [0, 0.61111, 0, 0],\r\n        '8216': [0, 0.61111, 0, 0],\r\n        '8217': [0, 0.61111, 0, 0],\r\n        '8242': [0, 0.61111, 0, 0],\r\n        '9251': [0.11111, 0.21944, 0, 0],\r\n    },\r\n};\r\n","/**\r\n * This module contains metrics regarding fonts and individual symbols. The sigma\r\n * and xi variables, as well as the METRICS_MAP map contain data extracted from\r\n * TeX, TeX font metrics, and the TTF files. These data are then exposed via the\r\n * `metrics` variable and the getCharacterMetrics function.\r\n */\r\nimport METRICS_MAP from './font-metrics-data';\r\n\r\n// This METRICS_MAP contains a mapping from font name and character code to character\r\n// metrics, including height, depth, italic correction, and skew (kern from the\r\n// character to the corresponding \\skewchar)\r\n// This map is generated via `make metrics`. It should not be changed manually.\r\n\r\ninterface CharacterMetrics {\r\n    defaultMetrics: boolean;\r\n    depth: number;\r\n    height: number;\r\n    italic: number;\r\n    skew: number;\r\n}\r\n// const hangulRegex = /[\\uAC00-\\uD7AF]/;\r\n\r\n// This regex combines\r\n// - Hiragana: [\\u3040-\\u309F]\r\n// - Katakana: [\\u30A0-\\u30FF]\r\n// - CJK ideograms: [\\u4E00-\\u9FAF]\r\n// - Hangul syllables: [\\uAC00-\\uD7AF]\r\n// Notably missing are half width Katakana and Romaji glyphs.\r\nconst cjkRegex = /[\\u3040-\\u309F]|[\\u30A0-\\u30FF]|[\\u4E00-\\u9FAF]|[\\uAC00-\\uD7AF]/;\r\n\r\n/*\r\n *\r\n * In TeX, there are actually three sets of dimensions, one for each of\r\n * textstyle, scriptstyle, and scriptscriptstyle.  These are provided in the\r\n * the arrays below, in that order.\r\n *\r\n * The font metrics are stored in fonts cmsy10, cmsy7, and cmsy5 respectively.\r\n * This was determined by running the following script:\r\n *``` bash\r\n      latex -interaction=nonstopmode \\\r\n      '\\documentclass{article}\\usepackage{amsmath}\\begin{document}' \\\r\n      '$a$ \\expandafter\\show\\the\\textfont2' \\\r\n      '\\expandafter\\show\\the\\scriptfont2' \\\r\n      '\\expandafter\\show\\the\\scriptscriptfont2' \\\r\n      '\\stop'\r\n  ```\r\n * The metrics themselves were retrieved using the following commands:\r\n * ``` bash\r\n      tftopl cmsy10\r\n      tftopl cmsy7\r\n      tftopl cmsy5\r\n    ```\r\n *\r\n * The output of each of these commands is quite lengthy.  The only part we\r\n * care about is the FONTDIMEN section. Each value is measured in EMs.\r\n * @memberof module:fontMetrics\r\n */\r\nexport const SIGMAS = {\r\n    slant: [0.25, 0.25, 0.25], // sigma1\r\n    space: [0.0, 0.0, 0.0], // sigma2\r\n    stretch: [0.0, 0.0, 0.0], // sigma3\r\n    shrink: [0.0, 0.0, 0.0], // sigma4\r\n    xHeight: [0.431, 0.431, 0.431], // sigma5\r\n    quad: [1.0, 1.171, 1.472], // sigma6\r\n    extraSpace: [0.0, 0.0, 0.0], // sigma7\r\n    num1: [0.677, 0.732, 0.925], // sigma8\r\n    num2: [0.394, 0.384, 0.387], // sigma9\r\n    num3: [0.444, 0.471, 0.504], // sigma10\r\n    denom1: [0.686, 0.752, 1.025], // sigma11\r\n    denom2: [0.345, 0.344, 0.532], // sigma12\r\n    sup1: [0.413, 0.503, 0.504], // sigma13\r\n    sup2: [0.363, 0.431, 0.404], // sigma14\r\n    sup3: [0.289, 0.286, 0.294], // sigma15\r\n    sub1: [0.15, 0.143, 0.2], // sigma16\r\n    sub2: [0.247, 0.286, 0.4], // sigma17\r\n    supDrop: [0.386, 0.353, 0.494], // sigma18\r\n    subDrop: [0.05, 0.071, 0.1], // sigma19\r\n    delim1: [2.39, 1.7, 1.98], // sigma20\r\n    delim2: [1.01, 1.157, 1.42], // sigma21\r\n    axisHeight: [0.25, 0.25, 0.25], // sigma22\r\n};\r\n\r\n// These font metrics are extracted from TeX by using\r\n// \\font\\a=cmex10\r\n// \\showthe\\fontdimenX\\a\r\n// where X is the corresponding variable number. These correspond to the font\r\n// parameters of the extension fonts (family 3). See the TeXbook, page 433\r\n// const xi1 = 0; // Slant per pt\r\n// const xi2 = 0; // Interword space\r\n// const xi3 = 0; // Interword stretch\r\n// const xi4 = 0; // Interword shrink\r\n// const xi5 = 0.431; // x-height\r\n// const xi6 = 1; // Quad width\r\n// const xi7 = 0; // Extra space\r\nconst xi8 = 0.04; // Default rule thickness, TexBook p.390\r\nconst xi9 = 0.111;\r\nconst xi10 = 0.166;\r\nconst xi11 = 0.2;\r\nconst xi12 = 0.6;\r\nconst xi13 = 0.1;\r\n// Note: xi14: offset from baseline for superscript TexBook p. 179\r\n// Note: xi16: offset from baseline for subscript\r\n\r\n// This value determines how large a pt is, for metrics which are defined in\r\n// terms of pts.\r\n// This value is also used in katex.less; if you change it make sure the values\r\n// match.\r\nconst ptPerEm = 10.0;\r\n\r\n/*\r\n * This is just a mapping from common names to real metrics\r\n */\r\nexport const METRICS = {\r\n    defaultRuleThickness: xi8,\r\n    bigOpSpacing1: xi9,\r\n    bigOpSpacing2: xi10,\r\n    bigOpSpacing3: xi11,\r\n    bigOpSpacing4: xi12,\r\n    bigOpSpacing5: xi13,\r\n    ptPerEm: ptPerEm,\r\n    pxPerEm: (ptPerEm * 4.0) / 3.0, // A CSS pt is fixed at 1.333px\r\n    doubleRuleSep: 2.0 / ptPerEm, // The space between adjacent `|` columns in an array definition. From\r\n    // article.cls.txt:455\r\n    arraycolsep: 5.0 / ptPerEm,\r\n    baselineskip: 12.0 / ptPerEm,\r\n    arrayrulewidth: 0.4 / ptPerEm,\r\n    fboxsep: 3 / ptPerEm, // From letter.dtx:1626\r\n    fboxrule: 0.4 / ptPerEm, // From letter.dtx:1627\r\n};\r\n\r\n// These are very rough approximations.  We default to Times New Roman which\r\n// should have Latin-1 and Cyrillic characters, but may not depending on the\r\n// operating system.  The metrics do not account for extra height from the\r\n// accents.  In the case of Cyrillic characters which have both ascenders and\r\n// descenders we prefer approximations with ascenders, primarily to prevent\r\n// the fraction bar or root line from intersecting the glyph.\r\n// TODO(kevinb) allow union of multiple glyph metrics for better accuracy.\r\nconst extraCharacterMap = {\r\n    '\\u00a0': '\\u0020', // NON-BREAKING SPACE is like space\r\n    '\\u200b': '\\u0020', // ZERO WIDTH SPACE is like space\r\n    // Latin-1\r\n    : 'A',\r\n    : 'C',\r\n    : 'D',\r\n    : 'o',\r\n    : 'a',\r\n    : 'c',\r\n    : 'd',\r\n    : 'o',\r\n\r\n    // Cyrillic\r\n    : 'A',\r\n    : 'B',\r\n    : 'B',\r\n    : 'F',\r\n    : 'A',\r\n    : 'E',\r\n    : 'K',\r\n    : '3',\r\n    : 'N',\r\n    : 'N',\r\n    : 'K',\r\n    : 'N',\r\n    : 'M',\r\n    : 'H',\r\n    : 'O',\r\n    : 'N',\r\n    : 'P',\r\n    : 'C',\r\n    : 'T',\r\n    : 'y',\r\n    : 'O',\r\n    : 'X',\r\n    : 'U',\r\n    : 'h',\r\n    : 'W',\r\n    : 'W',\r\n    : 'B',\r\n    : 'X',\r\n    : 'B',\r\n    : '3',\r\n    : 'X',\r\n    : 'R',\r\n    : 'a',\r\n    : 'b',\r\n    : 'a',\r\n    : 'r',\r\n    : 'y',\r\n    : 'e',\r\n    : 'm',\r\n    : 'e',\r\n    : 'n',\r\n    : 'n',\r\n    : 'n',\r\n    : 'n',\r\n    : 'm',\r\n    : 'n',\r\n    : 'o',\r\n    : 'n',\r\n    : 'p',\r\n    : 'c',\r\n    : 'o',\r\n    : 'y',\r\n    : 'b',\r\n    : 'x',\r\n    : 'n',\r\n    : 'n',\r\n    : 'w',\r\n    : 'w',\r\n    : 'a',\r\n    : 'm',\r\n    : 'a',\r\n    : 'e',\r\n    : 'm',\r\n    : 'r',\r\n};\r\n\r\n/**\r\n * This function is a convenience function for looking up information in the\r\n * METRICS_MAP table. It takes a character as a string, and a font name.\r\n *\r\n * Note: the `width` property may be undefined if fontMetricsData.js wasn't\r\n * built using `Make extended_metrics`.\r\n * @param fontName e.g. 'Main-Regular', 'Typewriter-Regular', etc...\r\n */\r\nexport function getCharacterMetrics(\r\n    character: string,\r\n    fontName: string\r\n): CharacterMetrics {\r\n    // console.assert(character.length === 1);\r\n    console.assert(METRICS_MAP[fontName], 'Unknown font \"' + fontName + '\"');\r\n\r\n    let ch = character.charCodeAt(0);\r\n\r\n    if (character[0] in extraCharacterMap) {\r\n        ch = extraCharacterMap[character[0]].charCodeAt(0);\r\n    } else if (cjkRegex.test(character[0])) {\r\n        ch = 77; // 'M'.charCodeAt(0);\r\n        return {\r\n            defaultMetrics: true,\r\n            depth: 0.2,\r\n            height: 0.9,\r\n            italic: 0,\r\n            skew: 0,\r\n        };\r\n    }\r\n    const metrics = METRICS_MAP[fontName][ch];\r\n\r\n    if (!metrics) {\r\n        // console.warn(\r\n        //     'No metrics for ' +\r\n        //     '\"' + character + '\" (U+' + ('000000' + ch.toString(16)).substr(-6) + ')' +\r\n        //     ' in font \"' + fontName + '\"');\r\n        // Assume default values.\r\n        // depth + height should be less than 1.0 em\r\n        if (ch === 11034) {\r\n            // Placeholder character\r\n            return {\r\n                defaultMetrics: true,\r\n                depth: 0,\r\n                height: 1.0,\r\n                italic: 0,\r\n                skew: 0,\r\n            };\r\n        }\r\n        return {\r\n            defaultMetrics: true,\r\n            depth: 0.2,\r\n            height: 0.7,\r\n            italic: 0,\r\n            skew: 0,\r\n        };\r\n    }\r\n\r\n    return {\r\n        defaultMetrics: false,\r\n        depth: metrics[0],\r\n        height: metrics[1],\r\n        italic: metrics[2],\r\n        skew: metrics[3],\r\n    };\r\n}\r\n\r\n/**\r\n *\r\n * @param value If value is a string, it may be suffixed\r\n * with a unit, which will override the `unit` paramter\r\n */\r\nexport function convertDimenToEm(\r\n    value: number | string,\r\n    unit: string,\r\n    precision = NaN\r\n): number {\r\n    if (typeof value === 'string') {\r\n        const m = value.match(/([-+]?[0-9.]*)\\s*([a-zA-Z]+)/);\r\n        if (!m) {\r\n            value = parseFloat(value);\r\n        } else {\r\n            value = parseFloat(m[1]);\r\n            unit = m[2].toLowerCase();\r\n        }\r\n    }\r\n\r\n    // If the units are missing, TeX assumes 'pt'\r\n    const f =\r\n        {\r\n            pt: 1.0,\r\n            mm: 7227 / 2540,\r\n            cm: 7227 / 254,\r\n            ex: 35271 / 8192,\r\n            px: 3.0 / 4.0,\r\n            em: METRICS.ptPerEm,\r\n            bp: 803 / 800,\r\n            dd: 1238 / 1157,\r\n            pc: 12.0,\r\n            in: 72.27,\r\n            mu: 10 / 18,\r\n        }[unit] || 1.0;\r\n\r\n    if (isFinite(precision)) {\r\n        const factor = Math.pow(10, precision);\r\n        return Math.round((value / METRICS.ptPerEm) * f * factor) / factor;\r\n    }\r\n\r\n    return (value / METRICS.ptPerEm) * f;\r\n}\r\n\r\nexport function convertDimenToPx(value: string | number, unit: string): number {\r\n    return convertDimenToEm(value, unit) * (4.0 / 3.0) * METRICS.ptPerEm;\r\n}\r\n","/**\r\n * This file contains information and classes for the 'math styles' used by TeX,\r\n * which are specific layout\r\n * algorithms for math. They get progressively smaller and tighter:\r\n * - displaystyle is used for expressions laid out on their own (in a block)\r\n * - textstyle is for expressions displayed on a line (usually wiht some text\r\n * around)\r\n * - scriptstyle is for expressions displayed as a superscript for example\r\n * - scriptscriptstyle is for expressions displayed as a superscript of a superscript\r\n * - the 'cramped' variations are used in various places, for examples a subscript\r\n * is using the 'scriptstyle', but cramped (so it's a bit more tight than a\r\n * superscript which is just using the 'scriptstyle')\r\n *\r\n * See Texbook, p.441:\r\n *\r\n * A math list is a sequence of items of the various kinds listed in Chapter 17,\r\n * and TEX typesets a formula by converting a math list to a horizontal list.\r\n * When such typesetting begins, TEX has two other pieces of information in\r\n * addition to the math list itself. (a) The starting style tells what style\r\n * should be used for the math list, unless another style is specified by a\r\n * style item. For example, the starting style for a displayed formula is D,\r\n * but for an equation in the text or an equation number it is T; and for a\r\n * subformula it can be any one of the eight styles defined in Chapter 17.\r\n *\r\n * We shall use C to stand for the current style, and we shall say that the\r\n * math list is being typeset in style C. (b) The typesetting is done either\r\n * with or without penalties. Formulas in the text of a paragraph are converted\r\n * to horizontal lists in which additional penalty items are inserted after\r\n * binary operations and relations, in order to aid in line breaking. Such\r\n * penalties are not inserted in other cases, because they would serve no\r\n * useful function.\r\n *\r\n * The eight styles are considered to be D > D > T > T > S > S > SS > SS,\r\n * in decreasing order. Thus, C  S means that the current style is S, S , SS,\r\n * or SS . Style C means the current style with a prime added if one isnt\r\n * there; for example, we have C =T if and only if C = T or C = T'.\r\n * Style C is the superscript style for C; this means style S if C is D or T,\r\n * style S if C is D or T, style SS if C is S or SS,\r\n * and style SS if C is S or SS.\r\n * Finally, style C is the subscript style, which is (C) .\r\n */\r\n\r\nimport { SIGMAS } from './font-metrics';\r\ninterface Metrics {\r\n    slant: number;\r\n    space: number;\r\n    stretch: number;\r\n    shrink: number;\r\n    xHeight: number;\r\n    quad: number;\r\n    extraSpace: number;\r\n    num1: number; // 8\r\n    num2: number; // 9\r\n    num3: number; // 10\r\n    denom1: number; // 11\r\n    denom2: number; // 12\r\n    sup1: number;\r\n    sup2: number;\r\n    sup3: number;\r\n    sub1: number;\r\n    sub2: number;\r\n    supDrop: number;\r\n    subDrop: number;\r\n    delim1: number;\r\n    delim2: number;\r\n    axisHeight: number;\r\n    emPerEx?: number;\r\n} // @revisit: belongs in ./font-metrics\r\n\r\n// IDs of the different MATHSTYLES\r\nconst D = 0; // displaystyle\r\nconst Dc = 1; // displaystyle, cramped\r\nconst T = 2; // textstyle\r\nconst Tc = 3;\r\nconst S = 4; // scriptstyle\r\nconst Sc = 5;\r\nconst SS = 6; // scriptscriptstyle\r\nconst SSc = 7;\r\n\r\n/**\r\n * @property {number} id unique id for the style\r\n * @property {number} size (which is the same for cramped and uncramped version\r\n * of a style)\r\n * @property {number}  multiplier, size multiplier which gives the size difference between\r\n * a style and textstyle.\r\n * @property {boolean}  cramped flag\r\n */\r\nexport class Mathstyle {\r\n    id: number;\r\n    size: number;\r\n    cramped: boolean;\r\n    sizeMultiplier: number; // @revisit...? Same as multiplier\r\n    metrics: Metrics;\r\n\r\n    constructor(\r\n        id: number,\r\n        size: number,\r\n        multiplier: number,\r\n        cramped: boolean\r\n    ) {\r\n        this.id = id;\r\n        this.size = size;\r\n        this.cramped = cramped;\r\n        this.sizeMultiplier = multiplier;\r\n        this.metrics = Object.keys(SIGMAS).reduce((acc, x) => {\r\n            return { ...acc, [x]: SIGMAS[x][this.size] };\r\n        }, {}) as Metrics;\r\n        this.metrics.emPerEx =\r\n            SIGMAS.xHeight[this.size] / SIGMAS.quad[this.size];\r\n    }\r\n    /**\r\n     * Get the style of a superscript given a base in the current style.\r\n     */\r\n    sup(): Mathstyle {\r\n        return MATHSTYLES[[S, Sc, S, Sc, SS, SSc, SS, SSc][this.id]];\r\n    }\r\n    /**\r\n     * Get the style of a subscript given a base in the current style.\r\n     */\r\n    sub(): Mathstyle {\r\n        return MATHSTYLES[[Sc, Sc, Sc, Sc, SSc, SSc, SSc, SSc][this.id]];\r\n    }\r\n    /**\r\n     * Get the style of a fraction numerator given the fraction in the current\r\n     * style.\r\n     */\r\n    fracNum(): Mathstyle {\r\n        return MATHSTYLES[[T, Tc, S, Sc, SS, SSc, SS, SSc][this.id]];\r\n    }\r\n    /**\r\n     * Get the style of a fraction denominator given the fraction in the current\r\n     * style.\r\n     */\r\n    fracDen(): Mathstyle {\r\n        return MATHSTYLES[[Tc, Tc, Sc, Sc, SSc, SSc, SSc, SSc][this.id]];\r\n    }\r\n    /**\r\n     * Get the cramped version of a style (in particular, cramping a cramped style\r\n     * doesn't change the style).\r\n     */\r\n    cramp(): Mathstyle {\r\n        return MATHSTYLES[[Dc, Dc, Tc, Tc, Sc, Sc, SSc, SSc][this.id]];\r\n    }\r\n    /**\r\n     * CSS class name, for example `displaystyle cramped`\r\n     */\r\n    cls(): string {\r\n        return [\r\n            'displaystyle textstyle', // @revisit. Should just be 'displaystyle'\r\n            'textstyle',\r\n            'scriptstyle',\r\n            'scriptscriptstyle',\r\n        ][this.size]; // @revisit: use this.id to include 'cramped' variants\r\n    }\r\n    /**\r\n     * CSS class name to adjust from one style to another, like 'reset-textstyle'\r\n     */\r\n    adjustTo(newStyle: Mathstyle): string {\r\n        // @revisit the values used here\r\n        let result = [\r\n            [\r\n                '', // 'reset-textstyle displaystyle textstyle',\r\n                '', // 'reset-textstyle textstyle',\r\n                'reset-textstyle scriptstyle',\r\n                'reset-textstyle scriptscriptstyle',\r\n            ],\r\n\r\n            [\r\n                'reset-textstyle displaystyle textstyle',\r\n                '', // 'reset-textstyle textstyle',\r\n                'reset-textstyle scriptstyle',\r\n                'reset-textstyle scriptscriptstyle',\r\n            ],\r\n\r\n            [\r\n                'reset-scriptstyle textstyle displaystyle',\r\n                'reset-scriptstyle textstyle',\r\n                '', // 'reset-scriptstyle scriptstyle',\r\n                'reset-scriptstyle scriptscriptstyle',\r\n            ],\r\n\r\n            [\r\n                'reset-scriptscriptstyle textstyle displaystyle', // @revisit. Should not have 'textstyle'\r\n                'reset-scriptscriptstyle textstyle',\r\n                'reset-scriptscriptstyle scriptstyle',\r\n                '', // 'reset-scriptscriptstyle scriptscriptstyle'\r\n            ],\r\n        ][this.size][newStyle.size];\r\n        if (result.length > 0) result = ' ' + result;\r\n        return result;\r\n    }\r\n    /**\r\n     * Return if this style is tightly spaced (scriptstyle/scriptscriptstyle)\r\n     */\r\n    isTight(): boolean {\r\n        return this.size >= 2;\r\n    }\r\n}\r\n\r\nexport const MATHSTYLES: {\r\n    [key: number]: Mathstyle;\r\n    displaystyle?: Mathstyle;\r\n    textstyle?: Mathstyle;\r\n    scriptstyle?: Mathstyle;\r\n    scriptscriptstyle?: Mathstyle;\r\n} = {\r\n    0: new Mathstyle(D, 0, 1.0, false),\r\n    1: new Mathstyle(Dc, 0, 1.0, true),\r\n    2: new Mathstyle(T, 1, 1.0, false),\r\n    3: new Mathstyle(Tc, 1, 1.0, true),\r\n    4: new Mathstyle(S, 2, 0.7, false),\r\n    5: new Mathstyle(Sc, 2, 0.7, true),\r\n    6: new Mathstyle(SS, 3, 0.5, false),\r\n    7: new Mathstyle(SSc, 3, 0.5, true),\r\n};\r\n\r\n// Aliases\r\nMATHSTYLES.displaystyle = MATHSTYLES[0];\r\nMATHSTYLES.textstyle = MATHSTYLES[2];\r\nMATHSTYLES.scriptstyle = MATHSTYLES[4];\r\nMATHSTYLES.scriptscriptstyle = MATHSTYLES[6];\r\n\r\nexport type MathStyleName =\r\n    | 'displaystyle'\r\n    | 'textstyle'\r\n    | 'scriptstyle'\r\n    | 'scriptscriptstyle';\r\n","import { MacroDictionary, ParseMode } from '../public/core';\r\nimport { Mathstyle, MATHSTYLES } from './mathstyle';\r\nimport { Span } from './span';\r\n\r\nexport type ArgumentType =\r\n    | ParseMode\r\n    | (\r\n          | 'auto'\r\n          | 'bbox'\r\n          | 'color' //color name, hex value: `'#fff'`, `'#a0a0a0'`\r\n          | 'colspec' // formating of a column in tabular environment, e.g. `'r@{.}l'`\r\n          | 'delim'\r\n          | 'dimen' // `'25mu'`, `'2pt'`\r\n          | 'number' //`+/-12.56`\r\n          | 'skip' // `'25mu plus 2em minus fiLll'`, `'2pt'`\r\n          | 'string' // delimiter is a non-literal token (e.g. `<}>` `<$>`, etc\r\n          | 'balanced-string' // Delimiter is a balanced closing brace\r\n      );\r\n\r\nexport interface ContextInterface {\r\n    macros?: MacroDictionary;\r\n    atomIdsSettings?: {\r\n        overrideID?: string;\r\n        groupNumbers: boolean;\r\n        seed: string | number;\r\n    };\r\n    mathstyle?: Mathstyle;\r\n    parentMathstyle?: Mathstyle;\r\n    size?: string; // @revisit: set explicit possible values, e.g. 'size5', etc...\r\n    parentSize?: string;\r\n    letterShapeStyle?: 'tex' | 'french' | 'iso' | 'upright' | 'auto';\r\n    opacity?: number;\r\n    color?: string;\r\n    smartFence?: boolean;\r\n    phantomBase?: Span[];\r\n}\r\n\r\n/**\r\n * This structure contains the rendering context of the current parse level.\r\n *\r\n * It also holds information about the parent context to handle scaling\r\n * adjustments.\r\n *\r\n * When a new scope is entered, a clone of the context is created with `.clone()`\r\n * so that any further changes remain local to the scope.\r\n *\r\n * A scope is defined for example by:\r\n * - an explicit group enclosed in braces `{...}`\r\n * - a semi-simple group enclosed in `\\bgroup...\\endgroup`\r\n * - an environment delimited by `\\begin{<envname>}...\\end{<envname>}`\r\n *\r\n * @property {Mathstyle} mathstyle\r\n * @property {number} opacity\r\n * @property {number} size\r\n * @property {object} atomIdsSettings - If not undefined, unique IDs should be\r\n * generated for each span so they can be mapped back to an atom.\r\n * The `seed` field should be a number to generate a specific range of\r\n * IDs or the string \"random\" to generate a random number.\r\n * Optionally, if a `groupNumbers` property is set to true, an additional\r\n * span will enclose strings of digits. This is used by read aloud to properly\r\n * pronounce (and highlight) numbers in expressions.\r\n * @property {Mathstyle} parentMathstyle\r\n * @property {number} parentSize\r\n * @property {object} macros A macros dictionary\r\n * @property {string} color\r\n */\r\nexport class Context implements ContextInterface {\r\n    macros: MacroDictionary;\r\n    atomIdsSettings?: {\r\n        overrideID?: string;\r\n        groupNumbers: boolean;\r\n        seed: string | number;\r\n    };\r\n    mathstyle: Mathstyle;\r\n    parentMathstyle?: Mathstyle;\r\n    size?: string; // @revisit: set explicit possible values, e.g. 'size5', etc...\r\n    parentSize?: string;\r\n    letterShapeStyle: 'tex' | 'french' | 'iso' | 'upright' | 'auto';\r\n    opacity?: number;\r\n    color?: string;\r\n    smartFence?: boolean;\r\n    phantomBase?: Span[]; // The spans to use to calculate the placement of the sup/sub\r\n    // Used by 'msubsup' scaffolding atoms\r\n\r\n    constructor(from: ContextInterface) {\r\n        this.macros = from.macros ?? {};\r\n        this.atomIdsSettings = from.atomIdsSettings;\r\n\r\n        this.mathstyle = from.mathstyle ?? MATHSTYLES.displaystyle;\r\n\r\n        this.letterShapeStyle = from.letterShapeStyle ?? 'tex';\r\n\r\n        this.size = from.size ?? 'size5'; // medium size\r\n\r\n        this.parentMathstyle = from.parentMathstyle ?? this.mathstyle;\r\n        this.parentSize = from.parentSize ?? this.size;\r\n\r\n        this.opacity = from.opacity;\r\n        this.smartFence = from.smartFence;\r\n        this.phantomBase = from.phantomBase;\r\n    }\r\n\r\n    /**\r\n     * Returns a new context with the same properties as 'this',\r\n     * except for the ones provided in `override`\r\n     */\r\n    clone(override: ContextInterface = {}): Context {\r\n        const result = new Context(this);\r\n        if (typeof override !== 'undefined') {\r\n            // `'auto'` (or undefined) to indicate that the mathstyle should in\r\n            // fact not be changed. This is used when specifying the mathstyle\r\n            // for some environments.\r\n            Object.assign(result, override);\r\n            if (!override.mathstyle) {\r\n                result.mathstyle = this.mathstyle;\r\n            } else {\r\n                result.parentMathstyle = this.mathstyle;\r\n                result.parentSize = this.size;\r\n                if (typeof override.mathstyle === 'string') {\r\n                    result.mathstyle = MATHSTYLES[override.mathstyle];\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Change the mathstyle of this context\r\n     * @param value - `'auto'` to indicate that the mathstyle should in\r\n     * fact not be changed. This is used when specifying the mathstyle for some\r\n     * environments.\r\n     */\r\n    setMathstyle(value: string): void {\r\n        if (value && value !== 'auto') {\r\n            this.mathstyle = MATHSTYLES[value];\r\n        }\r\n    }\r\n    cramp(): Context {\r\n        return this.clone({ mathstyle: this.mathstyle.cramp() });\r\n    }\r\n    sup(): Context {\r\n        return this.clone({ mathstyle: this.mathstyle.sup() });\r\n    }\r\n    sub(): Context {\r\n        return this.clone({ mathstyle: this.mathstyle.sub() });\r\n    }\r\n}\r\n","const SVG_BODY = {\r\n    // Adapted from https://github.com/KaTeX/KaTeX/blob/master/src/stretchy.js\r\n\r\n    overrightarrow: [['rightarrow'], 0.888, 522, 'xMaxYMin'],\r\n    overleftarrow: [['leftarrow'], 0.888, 522, 'xMinYMin'],\r\n    underrightarrow: [['rightarrow'], 0.888, 522, 'xMaxYMin'],\r\n    underleftarrow: [['leftarrow'], 0.888, 522, 'xMinYMin'],\r\n    xrightarrow: [['rightarrow'], 1.469, 522, 'xMaxYMin'],\r\n    xleftarrow: [['leftarrow'], 1.469, 522, 'xMinYMin'],\r\n    Overrightarrow: [['doublerightarrow'], 0.888, 560, 'xMaxYMin'],\r\n    xRightarrow: [['doublerightarrow'], 1.526, 560, 'xMaxYMin'],\r\n    xLeftarrow: [['doubleleftarrow'], 1.526, 560, 'xMinYMin'],\r\n    overleftharpoon: [['leftharpoon'], 0.888, 522, 'xMinYMin'],\r\n    xleftharpoonup: [['leftharpoon'], 0.888, 522, 'xMinYMin'],\r\n    xleftharpoondown: [['leftharpoondown'], 0.888, 522, 'xMinYMin'],\r\n    overrightharpoon: [['rightharpoon'], 0.888, 522, 'xMaxYMin'],\r\n    xrightharpoonup: [['rightharpoon'], 0.888, 522, 'xMaxYMin'],\r\n    xrightharpoondown: [['rightharpoondown'], 0.888, 522, 'xMaxYMin'],\r\n    xlongequal: [['longequal'], 0.888, 334, 'xMinYMin'],\r\n    xtwoheadleftarrow: [['twoheadleftarrow'], 0.888, 334, 'xMinYMin'],\r\n    xtwoheadrightarrow: [['twoheadrightarrow'], 0.888, 334, 'xMaxYMin'],\r\n\r\n    overleftrightarrow: [['leftarrow', 'rightarrow'], 0.888, 522],\r\n    overbrace: [['leftbrace', 'midbrace', 'rightbrace'], 1.6, 548],\r\n    underbrace: [\r\n        ['leftbraceunder', 'midbraceunder', 'rightbraceunder'],\r\n        1.6,\r\n        548,\r\n    ],\r\n    underleftrightarrow: [['leftarrow', 'rightarrow'], 0.888, 522],\r\n    xleftrightarrow: [['leftarrow', 'rightarrow'], 1.75, 522],\r\n    xLeftrightarrow: [['doubleleftarrow', 'doublerightarrow'], 1.75, 560],\r\n    xrightleftharpoons: [\r\n        ['leftharpoondownplus', 'rightharpoonplus'],\r\n        1.75,\r\n        716,\r\n    ],\r\n    xleftrightharpoons: [\r\n        ['leftharpoonplus', 'rightharpoondownplus'],\r\n        1.75,\r\n        716,\r\n    ],\r\n    xhookleftarrow: [['leftarrow', 'righthook'], 1.08, 522],\r\n    xhookrightarrow: [['lefthook', 'rightarrow'], 1.08, 522],\r\n    overlinesegment: [['leftlinesegment', 'rightlinesegment'], 0.888, 522],\r\n    underlinesegment: [['leftlinesegment', 'rightlinesegment'], 0.888, 522],\r\n    overgroup: [['leftgroup', 'rightgroup'], 0.888, 342],\r\n    undergroup: [['leftgroupunder', 'rightgroupunder'], 0.888, 342],\r\n    xmapsto: [['leftmapsto', 'rightarrow'], 1.5, 522],\r\n    xtofrom: [['leftToFrom', 'rightToFrom'], 1.75, 528],\r\n\r\n    // The next three arrows are from the mhchem package.\r\n    // In mhchem.sty, min-length is 2.0em. But these arrows might appear in the\r\n    // document as \\xrightarrow or \\xrightleftharpoons. Those have\r\n    // min-length = 1.75em, so we set min-length on these next three to match.\r\n    xrightleftarrows: [['baraboveleftarrow', 'rightarrowabovebar'], 1.75, 901],\r\n    xrightequilibrium: [\r\n        ['baraboveshortleftharpoon', 'rightharpoonaboveshortbar'],\r\n        1.75,\r\n        716,\r\n    ],\r\n    xleftequilibrium: [\r\n        ['shortbaraboveleftharpoon', 'shortrightharpoonabovebar'],\r\n        1.75,\r\n        716,\r\n    ],\r\n};\r\n\r\n// While the images above are sliced, \"accents\" are stretched\r\n// The variants (xxx1, xxx2, etc...) are used depending on the length\r\n// (in number of characters) of the base.\r\nconst SVG_ACCENTS = {\r\n    // viewBoxWidth, viewBoxHeight, height\r\n    widehat1: [1062, 239, 0.24],\r\n    widehat2: [2364, 300, 0.3],\r\n    widehat3: [2364, 360, 0.36],\r\n    widehat4: [2364, 420, 0.42],\r\n    widecheck1: [1062, 239, 0.24],\r\n    widecheck2: [2364, 300, 0.3],\r\n    widecheck3: [2364, 360, 0.36],\r\n    widecheck4: [2364, 420, 0.42],\r\n    widetilde1: [600, 260, 0.26],\r\n    widetilde2: [1033, 286, 0.286],\r\n    widetilde3: [2339, 306, 0.306],\r\n    widetilde4: [2340, 312, 0.34],\r\n};\r\n\r\n// From https://github.com/KaTeX/KaTeX/blob/master/src/svgGeometry.js\r\n\r\nconst PATHS = {\r\n    // The doubleleftarrow geometry is from glyph U+21D0 in the font KaTeX Main\r\n    doubleleftarrow: `M262 157\r\nl10-10c34-36 62.7-77 86-123 3.3-8 5-13.3 5-16 0-5.3-6.7-8-20-8-7.3\r\n 0-12.2.5-14.5 1.5-2.3 1-4.8 4.5-7.5 10.5-49.3 97.3-121.7 169.3-217 216-28\r\n 14-57.3 25-88 33-6.7 2-11 3.8-13 5.5-2 1.7-3 4.2-3 7.5s1 5.8 3 7.5\r\nc2 1.7 6.3 3.5 13 5.5 68 17.3 128.2 47.8 180.5 91.5 52.3 43.7 93.8 96.2 124.5\r\n 157.5 9.3 8 15.3 12.3 18 13h6c12-.7 18-4 18-10 0-2-1.7-7-5-15-23.3-46-52-87\r\n-86-123l-10-10h399738v-40H218c328 0 0 0 0 0l-10-8c-26.7-20-65.7-43-117-69 2.7\r\n-2 6-3.7 10-5 36.7-16 72.3-37.3 107-64l10-8h399782v-40z\r\nm8 0v40h399730v-40zm0 194v40h399730v-40z`,\r\n\r\n    // doublerightarrow is from glyph U+21D2 in font KaTeX Main\r\n    doublerightarrow: `M399738 392l\r\n-10 10c-34 36-62.7 77-86 123-3.3 8-5 13.3-5 16 0 5.3 6.7 8 20 8 7.3 0 12.2-.5\r\n 14.5-1.5 2.3-1 4.8-4.5 7.5-10.5 49.3-97.3 121.7-169.3 217-216 28-14 57.3-25 88\r\n-33 6.7-2 11-3.8 13-5.5 2-1.7 3-4.2 3-7.5s-1-5.8-3-7.5c-2-1.7-6.3-3.5-13-5.5-68\r\n-17.3-128.2-47.8-180.5-91.5-52.3-43.7-93.8-96.2-124.5-157.5-9.3-8-15.3-12.3-18\r\n-13h-6c-12 .7-18 4-18 10 0 2 1.7 7 5 15 23.3 46 52 87 86 123l10 10H0v40h399782\r\nc-328 0 0 0 0 0l10 8c26.7 20 65.7 43 117 69-2.7 2-6 3.7-10 5-36.7 16-72.3 37.3\r\n-107 64l-10 8H0v40zM0 157v40h399730v-40zm0 194v40h399730v-40z`,\r\n\r\n    // leftarrow is from glyph U+2190 in font KaTeX Main\r\n    leftarrow: `M400000 241H110l3-3c68.7-52.7 113.7-120\r\n 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8\r\n-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247\r\nc-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208\r\n 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3\r\n 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202\r\n l-3-3h399890zM100 241v40h399900v-40z`,\r\n\r\n    // overbrace is from glyphs U+23A9/23A8/23A7 in font KaTeX_Size4-Regular\r\n    leftbrace: `M6 548l-6-6v-35l6-11c56-104 135.3-181.3 238-232 57.3-28.7 117\r\n-45 179-50h399577v120H403c-43.3 7-81 15-113 26-100.7 33-179.7 91-237 174-2.7\r\n 5-6 9-10 13-.7 1-7.3 1-20 1H6z`,\r\n\r\n    leftbraceunder: `M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13\r\n 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688\r\n 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7\r\n-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z`,\r\n\r\n    // overgroup is from the MnSymbol package (public domain)\r\n    leftgroup: `M400000 80\r\nH435C64 80 168.3 229.4 21 260c-5.9 1.2-18 0-18 0-2 0-3-1-3-3v-38C76 61 257 0\r\n 435 0h399565z`,\r\n\r\n    leftgroupunder: `M400000 262\r\nH435C64 262 168.3 112.6 21 82c-5.9-1.2-18 0-18 0-2 0-3 1-3 3v38c76 158 257 219\r\n 435 219h399565z`,\r\n\r\n    // Harpoons are from glyph U+21BD in font KaTeX Main\r\n    leftharpoon: `M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3\r\n-3.3 10.2-9.5 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5\r\n-18.3 3-21-1.3-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7\r\n-196 228-6.7 4.7-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40z`,\r\n\r\n    leftharpoonplus: `M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3-3.3 10.2-9.5\r\n 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5-18.3 3-21-1.3\r\n-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7-196 228-6.7 4.7\r\n-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40zM0 435v40h400000v-40z\r\nm0 0v40h400000v-40z`,\r\n\r\n    leftharpoondown: `M7 241c-4 4-6.333 8.667-7 14 0 5.333.667 9 2 11s5.333\r\n 5.333 12 10c90.667 54 156 130 196 228 3.333 10.667 6.333 16.333 9 17 2 .667 5\r\n 1 9 1h5c10.667 0 16.667-2 18-6 2-2.667 1-9.667-3-21-32-87.333-82.667-157.667\r\n-152-211l-3-3h399907v-40zM93 281 H400000 v-40L7 241z`,\r\n\r\n    leftharpoondownplus: `M7 435c-4 4-6.3 8.7-7 14 0 5.3.7 9 2 11s5.3 5.3 12\r\n 10c90.7 54 156 130 196 228 3.3 10.7 6.3 16.3 9 17 2 .7 5 1 9 1h5c10.7 0 16.7\r\n-2 18-6 2-2.7 1-9.7-3-21-32-87.3-82.7-157.7-152-211l-3-3h399907v-40H7zm93 0\r\nv40h399900v-40zM0 241v40h399900v-40zm0 0v40h399900v-40z`,\r\n\r\n    // hook is from glyph U+21A9 in font KaTeX Main\r\n    lefthook: `M400000 281 H103s-33-11.2-61-33.5S0 197.3 0 164s14.2-61.2 42.5\r\n-83.5C70.8 58.2 104 47 142 47 c16.7 0 25 6.7 25 20 0 12-8.7 18.7-26 20-40 3.3\r\n-68.7 15.7-86 37-10 12-15 25.3-15 40 0 22.7 9.8 40.7 29.5 54 19.7 13.3 43.5 21\r\n 71.5 23h399859zM103 281v-40h399897v40z`,\r\n\r\n    leftlinesegment: `M40 281 V428 H0 V94 H40 V241 H400000 v40z\r\nM40 281 V428 H0 V94 H40 V241 H400000 v40z`,\r\n\r\n    leftmapsto: `M40 281 V448H0V74H40V241H400000v40z\r\nM40 281 V448H0V74H40V241H400000v40z`,\r\n\r\n    // tofrom is from glyph U+21C4 in font KaTeX AMS Regular\r\n    leftToFrom: `M0 147h400000v40H0zm0 214c68 40 115.7 95.7 143 167h22c15.3 0 23\r\n-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69-70-101l-7-8h399905v-40H95l7-8\r\nc28.7-32 52-65.7 70-101 10.7-23.3 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 265.3\r\n 68 321 0 361zm0-174v-40h399900v40zm100 154v40h399900v-40z`,\r\n\r\n    longequal: `M0 50 h400000 v40H0z m0 194h40000v40H0z\r\nM0 50 h400000 v40H0z m0 194h40000v40H0z`,\r\n\r\n    midbrace: `M200428 334\r\nc-100.7-8.3-195.3-44-280-108-55.3-42-101.7-93-139-153l-9-14c-2.7 4-5.7 8.7-9 14\r\n-53.3 86.7-123.7 153-211 199-66.7 36-137.3 56.3-212 62H0V214h199568c178.3-11.7\r\n 311.7-78.3 403-201 6-8 9.7-12 11-12 .7-.7 6.7-1 18-1s17.3.3 18 1c1.3 0 5 4 11\r\n 12 44.7 59.3 101.3 106.3 170 141s145.3 54.3 229 60h199572v120z`,\r\n\r\n    midbraceunder: `M199572 214\r\nc100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14\r\n 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3\r\n 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0\r\n-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z`,\r\n\r\n    oiintSize1: `M512.6 71.6c272.6 0 320.3 106.8 320.3 178.2 0 70.8-47.7 177.6\r\n-320.3 177.6S193.1 320.6 193.1 249.8c0-71.4 46.9-178.2 319.5-178.2z\r\nm368.1 178.2c0-86.4-60.9-215.4-368.1-215.4-306.4 0-367.3 129-367.3 215.4 0 85.8\r\n60.9 214.8 367.3 214.8 307.2 0 368.1-129 368.1-214.8z`,\r\n\r\n    oiintSize2: `M757.8 100.1c384.7 0 451.1 137.6 451.1 230 0 91.3-66.4 228.8\r\n-451.1 228.8-386.3 0-452.7-137.5-452.7-228.8 0-92.4 66.4-230 452.7-230z\r\nm502.4 230c0-111.2-82.4-277.2-502.4-277.2s-504 166-504 277.2\r\nc0 110 84 276 504 276s502.4-166 502.4-276z`,\r\n\r\n    oiiintSize1: `M681.4 71.6c408.9 0 480.5 106.8 480.5 178.2 0 70.8-71.6 177.6\r\n-480.5 177.6S202.1 320.6 202.1 249.8c0-71.4 70.5-178.2 479.3-178.2z\r\nm525.8 178.2c0-86.4-86.8-215.4-525.7-215.4-437.9 0-524.7 129-524.7 215.4 0\r\n85.8 86.8 214.8 524.7 214.8 438.9 0 525.7-129 525.7-214.8z`,\r\n\r\n    oiiintSize2: `M1021.2 53c603.6 0 707.8 165.8 707.8 277.2 0 110-104.2 275.8\r\n-707.8 275.8-606 0-710.2-165.8-710.2-275.8C311 218.8 415.2 53 1021.2 53z\r\nm770.4 277.1c0-131.2-126.4-327.6-770.5-327.6S248.4 198.9 248.4 330.1\r\nc0 130 128.8 326.4 772.7 326.4s770.5-196.4 770.5-326.4z`,\r\n\r\n    rightarrow: `M0 241v40h399891c-47.3 35.3-84 78-110 128\r\n-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20\r\n 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7\r\n 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85\r\n-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5\r\n-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67\r\n 151.7 139 205zm0 0v40h399900v-40z`,\r\n\r\n    rightbrace: `M400000 542l\r\n-6 6h-17c-12.7 0-19.3-.3-20-1-4-4-7.3-8.3-10-13-35.3-51.3-80.8-93.8-136.5-127.5\r\ns-117.2-55.8-184.5-66.5c-.7 0-2-.3-4-1-18.7-2.7-76-4.3-172-5H0V214h399571l6 1\r\nc124.7 8 235 61.7 331 161 31.3 33.3 59.7 72.7 85 118l7 13v35z`,\r\n\r\n    rightbraceunder: `M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3\r\n 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237\r\n-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z`,\r\n\r\n    rightgroup: `M0 80h399565c371 0 266.7 149.4 414 180 5.9 1.2 18 0 18 0 2 0\r\n 3-1 3-3v-38c-76-158-257-219-435-219H0z`,\r\n\r\n    rightgroupunder: `M0 262h399565c371 0 266.7-149.4 414-180 5.9-1.2 18 0 18\r\n 0 2 0 3 1 3 3v38c-76 158-257 219-435 219H0z`,\r\n\r\n    rightharpoon: `M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3\r\n-3.7-15.3-11-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2\r\n-10.7 0-16.7 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58\r\n 69.2 92 94.5zm0 0v40h399900v-40z`,\r\n\r\n    rightharpoonplus: `M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3-3.7-15.3-11\r\n-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2-10.7 0-16.7\r\n 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58 69.2 92 94.5z\r\nm0 0v40h399900v-40z m100 194v40h399900v-40zm0 0v40h399900v-40z`,\r\n\r\n    rightharpoondown: `M399747 511c0 7.3 6.7 11 20 11 8 0 13-.8 15-2.5s4.7-6.8\r\n 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3 8.5-5.8 9.5\r\n-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3-64.7 57-92 95\r\n-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 241v40h399900v-40z`,\r\n\r\n    rightharpoondownplus: `M399747 705c0 7.3 6.7 11 20 11 8 0 13-.8\r\n 15-2.5s4.7-6.8 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3\r\n 8.5-5.8 9.5-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3\r\n-64.7 57-92 95-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 435v40h399900v-40z\r\nm0-194v40h400000v-40zm0 0v40h400000v-40z`,\r\n\r\n    righthook: `M399859 241c-764 0 0 0 0 0 40-3.3 68.7-15.7 86-37 10-12 15-25.3\r\n 15-40 0-22.7-9.8-40.7-29.5-54-19.7-13.3-43.5-21-71.5-23-17.3-1.3-26-8-26-20 0\r\n-13.3 8.7-20 26-20 38 0 71 11.2 99 33.5 0 0 7 5.6 21 16.7 14 11.2 21 33.5 21\r\n 66.8s-14 61.2-42 83.5c-28 22.3-61 33.5-99 33.5L0 241z M0 281v-40h399859v40z`,\r\n\r\n    rightlinesegment: `M399960 241 V94 h40 V428 h-40 V281 H0 v-40z\r\nM399960 241 V94 h40 V428 h-40 V281 H0 v-40z`,\r\n\r\n    rightToFrom: `M400000 167c-70.7-42-118-97.7-142-167h-23c-15.3 0-23 .3-23\r\n 1 0 1.3 5.3 13.7 16 37 18 35.3 41.3 69 70 101l7 8H0v40h399905l-7 8c-28.7 32\r\n-52 65.7-70 101-10.7 23.3-16 35.7-16 37 0 .7 7.7 1 23 1h23c24-69.3 71.3-125 142\r\n-167z M100 147v40h399900v-40zM0 341v40h399900v-40z`,\r\n\r\n    // twoheadleftarrow is from glyph U+219E in font KaTeX AMS Regular\r\n    twoheadleftarrow: `M0 167c68 40\r\n 115.7 95.7 143 167h22c15.3 0 23-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69\r\n-70-101l-7-8h125l9 7c50.7 39.3 85 86 103 140h46c0-4.7-6.3-18.7-19-42-18-35.3\r\n-40-67.3-66-96l-9-9h399716v-40H284l9-9c26-28.7 48-60.7 66-96 12.7-23.333 19\r\n-37.333 19-42h-46c-18 54-52.3 100.7-103 140l-9 7H95l7-8c28.7-32 52-65.7 70-101\r\n 10.7-23.333 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 71.3 68 127 0 167z`,\r\n\r\n    twoheadrightarrow: `M400000 167\r\nc-68-40-115.7-95.7-143-167h-22c-15.3 0-23 .3-23 1 0 1.3 5.3 13.7 16 37 18 35.3\r\n 41.3 69 70 101l7 8h-125l-9-7c-50.7-39.3-85-86-103-140h-46c0 4.7 6.3 18.7 19 42\r\n 18 35.3 40 67.3 66 96l9 9H0v40h399716l-9 9c-26 28.7-48 60.7-66 96-12.7 23.333\r\n-19 37.333-19 42h46c18-54 52.3-100.7 103-140l9-7h125l-7 8c-28.7 32-52 65.7-70\r\n 101-10.7 23.333-16 35.7-16 37 0 .7 7.7 1 23 1h22c27.3-71.3 75-127 143-167z`,\r\n\r\n    // tilde1 is a modified version of a glyph from the MnSymbol package\r\n    widetilde1: `M200 55.538c-77 0-168 73.953-177 73.953-3 0-7\r\n-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0\r\n 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0\r\n 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128\r\n-68.267.847-113-73.952-191-73.952z`,\r\n\r\n    // ditto tilde2, tilde3, & tilde4\r\n    widetilde2: `M344 55.266c-142 0-300.638 81.316-311.5 86.418\r\n-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9\r\n 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114\r\nc1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751\r\n 181.476 676 181.476c-149 0-189-126.21-332-126.21z`,\r\n\r\n    widetilde3: `M786 59C457 59 32 175.242 13 175.242c-6 0-10-3.457\r\n-11-10.37L.15 138c-1-7 3-12 10-13l19.2-6.4C378.4 40.7 634.3 0 804.3 0c337 0\r\n 411.8 157 746.8 157 328 0 754-112 773-112 5 0 10 3 11 9l1 14.075c1 8.066-.697\r\n 16.595-6.697 17.492l-21.052 7.31c-367.9 98.146-609.15 122.696-778.15 122.696\r\n -338 0-409-156.573-744-156.573z`,\r\n\r\n    widetilde4: `M786 58C457 58 32 177.487 13 177.487c-6 0-10-3.345\r\n-11-10.035L.15 143c-1-7 3-12 10-13l22-6.7C381.2 35 637.15 0 807.15 0c337 0 409\r\n 177 744 177 328 0 754-127 773-127 5 0 10 3 11 9l1 14.794c1 7.805-3 13.38-9\r\n 14.495l-20.7 5.574c-366.85 99.79-607.3 139.372-776.3 139.372-338 0-409\r\n -175.236-744-175.236z`,\r\n\r\n    // vec is from glyph U+20D7 in font KaTeX Main\r\n    vec: `M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\r\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\r\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\r\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\r\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\r\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\r\nc-16-25.333-24-45-24-59z`,\r\n\r\n    // widehat1 is a modified version of a glyph from the MnSymbol package\r\n    widehat1: `M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22\r\nc-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z`,\r\n\r\n    // ditto widehat2, widehat3, & widehat4\r\n    widehat2: `M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10\r\n-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,\r\n\r\n    widehat3: `M1181 0h2l1171 236c6 0 10 5 10 11l-2 23c-1 6-5 10\r\n-11 10h-1L1182 67 15 280h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,\r\n\r\n    widehat4: `M1181 0h2l1171 296c6 0 10 5 10 11l-2 23c-1 6-5 10\r\n-11 10h-1L1182 67 15 340h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,\r\n\r\n    // widecheck paths are all inverted versions of widehat\r\n    widecheck1: `M529,159h5l519,-115c5,-1,9,-5,9,-10c0,-1,-1,-2,-1,-3l-4,-22c-1,\r\n-5,-5,-9,-11,-9h-2l-512,92l-513,-92h-2c-5,0,-9,4,-11,9l-5,22c-1,6,2,12,8,13z`,\r\n\r\n    widecheck2: `M1181,220h2l1171,-176c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,\r\n-11,-10h-1l-1168,153l-1167,-153h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,\r\n\r\n    widecheck3: `M1181,280h2l1171,-236c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,\r\n-11,-10h-1l-1168,213l-1167,-213h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,\r\n\r\n    widecheck4: `M1181,340h2l1171,-296c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,\r\n-11,-10h-1l-1168,273l-1167,-273h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,\r\n\r\n    // The next ten paths support reaction arrows from the mhchem package.\r\n\r\n    // Arrows for \\ce{<-->} are offset from xAxis by 0.22ex, per mhchem in LaTeX\r\n    // baraboveleftarrow is mostly from from glyph U+2190 in font KaTeX Main\r\n    baraboveleftarrow: `M400000 620h-399890l3 -3c68.7 -52.7 113.7 -120 135 -202\r\nc4 -14.7 6 -23 6 -25c0 -7.3 -7 -11 -21 -11c-8 0 -13.2 0.8 -15.5 2.5\r\nc-2.3 1.7 -4.2 5.8 -5.5 12.5c-1.3 4.7 -2.7 10.3 -4 17c-12 48.7 -34.8 92 -68.5 130\r\ns-74.2 66.3 -121.5 85c-10 4 -16 7.7 -18 11c0 8.7 6 14.3 18 17c47.3 18.7 87.8 47\r\n121.5 85s56.5 81.3 68.5 130c0.7 2 1.3 5 2 9s1.2 6.7 1.5 8c0.3 1.3 1 3.3 2 6\r\ns2.2 4.5 3.5 5.5c1.3 1 3.3 1.8 6 2.5s6 1 10 1c14 0 21 -3.7 21 -11\r\nc0 -2 -2 -10.3 -6 -25c-20 -79.3 -65 -146.7 -135 -202l-3 -3h399890z\r\nM100 620v40h399900v-40z M0 241v40h399900v-40zM0 241v40h399900v-40z`,\r\n\r\n    // rightarrowabovebar is mostly from glyph U+2192, KaTeX Main\r\n    rightarrowabovebar: `M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32\r\n-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0\r\n13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39\r\n-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5\r\n-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5\r\n-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67\r\n151.7 139 205zm96 379h399894v40H0zm0 0h399904v40H0z`,\r\n\r\n    // The short left harpoon has 0.5em (i.e. 500 units) kern on the left end.\r\n    // Ref from mhchem.sty: \\rlap{\\raisebox{-.22ex}{$\\kern0.5em\r\n    baraboveshortleftharpoon: `M507,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11\r\nc1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17\r\nc2,0.7,5,1,9,1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21\r\nc-32,-87.3,-82.7,-157.7,-152,-211c0,0,-3,-3,-3,-3l399351,0l0,-40\r\nc-398570,0,-399437,0,-399437,0z M593 435 v40 H399500 v-40z\r\nM0 281 v-40 H399908 v40z M0 281 v-40 H399908 v40z`,\r\n\r\n    rightharpoonaboveshortbar: `M0,241 l0,40c399126,0,399993,0,399993,0\r\nc4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,\r\n-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6\r\nc-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z\r\nM0 241 v40 H399908 v-40z M0 475 v-40 H399500 v40z M0 475 v-40 H399500 v40z`,\r\n\r\n    shortbaraboveleftharpoon: `M7,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11\r\nc1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17c2,0.7,5,1,9,\r\n1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21c-32,-87.3,-82.7,-157.7,\r\n-152,-211c0,0,-3,-3,-3,-3l399907,0l0,-40c-399126,0,-399993,0,-399993,0z\r\nM93 435 v40 H400000 v-40z M500 241 v40 H400000 v-40z M500 241 v40 H400000 v-40z`,\r\n\r\n    shortrightharpoonabovebar: `M53,241l0,40c398570,0,399437,0,399437,0\r\nc4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,\r\n-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6\r\nc-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z\r\nM500 241 v40 H399408 v-40z M500 435 v40 H400000 v-40z`,\r\n};\r\n\r\n/**\r\n * Generate the HTML markup to represent a SVG span.\r\n *\r\n */\r\nexport function svgBodyToMarkup(svgBodyName: string): string {\r\n    if (SVG_ACCENTS[svgBodyName]) {\r\n        const height = SVG_ACCENTS[svgBodyName][2];\r\n        const result =\r\n            `<span class=\"stretchy\" style=\"height:${height}em\">` +\r\n            `<svg width=\"100%\" height=\"${height}em\"` +\r\n            `viewBox=\"0 0 ${SVG_ACCENTS[svgBodyName][0]} ${SVG_ACCENTS[svgBodyName][1]}\"` +\r\n            `preserveAspectRatio=\"none\">` +\r\n            `<path d=\"${PATHS[svgBodyName]}\"></path>` +\r\n            `</svg></span>`;\r\n        return `<span style=\"height:${height}em;min-width:0\">${result}</span>`;\r\n    }\r\n\r\n    const [paths, minWidth, viewBoxHeight, align] = SVG_BODY[svgBodyName];\r\n    let widthClasses: string[];\r\n    let aligns: string[];\r\n    const height = viewBoxHeight / 1000;\r\n    if (paths.length === 3) {\r\n        widthClasses = ['slice-1-of-3', 'slice-2-of-3', 'slice-3-of-3'];\r\n        aligns = ['xMinYMin', 'xMidYMin', 'xMaxYMin'];\r\n    } else if (paths.length === 2) {\r\n        widthClasses = ['slice-1-of-2', 'slice-2-of-2'];\r\n        aligns = ['xMinYMin', 'xMaxYMin'];\r\n    } else {\r\n        widthClasses = ['slice-1-of-1'];\r\n        aligns = [align];\r\n    }\r\n    const body = paths\r\n        .map(\r\n            (path: string | number, i: string | number) =>\r\n                `<span class=\"${widthClasses[i]}\" style=\"height:${height}em\">` +\r\n                `<svg width=\"400em\" height=\"${height}em\"` +\r\n                `viewBox=\"0 0 400000 ${viewBoxHeight}\"` +\r\n                `preserveAspectRatio=\"${aligns[i]} slice\">` +\r\n                `<path d=\"${PATHS[path]}\"></path>` +\r\n                `</svg></span>`\r\n        )\r\n        .join('');\r\n    return `<span style=\"height:${height}em;min-width:${minWidth}em;display:inline-block;\">${body}</span>`;\r\n}\r\n\r\nexport function svgBodyHeight(svgBodyName: string): number {\r\n    if (SVG_BODY[svgBodyName]) {\r\n        return SVG_BODY[svgBodyName][2] / 1000;\r\n    }\r\n    return SVG_ACCENTS[svgBodyName][2];\r\n}\r\n","import {\r\n    ErrorListener,\r\n    Style,\r\n    MacroDictionary,\r\n    ParserErrorCode,\r\n    ParseMode,\r\n} from '../public/core';\r\n\r\nimport type { Span } from './span';\r\nimport type { Token } from './tokenizer';\r\nimport { Atom, ToLatexOptions } from './atom';\r\nimport type { ArgumentType } from './context';\r\n\r\nexport interface ParseTokensOptions {\r\n    args: (string | Atom[])[];\r\n    macros: MacroDictionary;\r\n    smartFence: boolean;\r\n    style: Style;\r\n    parse: (\r\n        mode: ArgumentType,\r\n        tokens: Token[],\r\n        options: ParseTokensOptions\r\n    ) => [Atom[], Token[]];\r\n}\r\n/*\r\n * Return an array of runs with the same mode\r\n */\r\nexport function getModeRuns(atoms: Atom[]): Atom[][] {\r\n    const result = [];\r\n    let run = [];\r\n    let currentMode = 'NONE';\r\n    atoms.forEach((atom) => {\r\n        if (atom.type === 'first') return;\r\n        if (atom.mode !== currentMode) {\r\n            if (run.length > 0) result.push(run);\r\n            run = [atom];\r\n            currentMode = atom.mode;\r\n        } else {\r\n            run.push(atom);\r\n        }\r\n    });\r\n    // Push whatever is left\r\n    if (run.length > 0) result.push(run);\r\n    return result;\r\n}\r\n\r\n/*\r\n * Return an array of runs (array of atoms with the same value\r\n *   for the specified property)\r\n */\r\nexport function getPropertyRuns(atoms: Atom[], property: string): Atom[][] {\r\n    const result = [];\r\n    let run = [];\r\n    let currentValue: string;\r\n    atoms.forEach((atom: Atom) => {\r\n        if (atom.type === 'first') return;\r\n        let value: string;\r\n        if (property === 'variant') {\r\n            value = atom.style.variant;\r\n            if (atom.style.variantStyle && atom.style.variantStyle !== 'up') {\r\n                value += '-' + atom.style.variantStyle;\r\n            }\r\n        } else if (property === 'cssClass') {\r\n            if (atom.type === 'group') {\r\n                value = atom['customClass'];\r\n            }\r\n        } else {\r\n            value = atom.style[property];\r\n        }\r\n        if (value === currentValue) {\r\n            // Same value, add it to the current run\r\n            run.push(atom);\r\n        } else {\r\n            // The value of property for this atom is different from the\r\n            // current value, start a new run\r\n            if (run.length > 0) result.push(run);\r\n            run = [atom];\r\n            currentValue = value;\r\n        }\r\n    });\r\n\r\n    // Push whatever is left\r\n    if (run.length > 0) result.push(run);\r\n    return result;\r\n}\r\n\r\nexport const MODES_REGISTRY = {};\r\n\r\nexport function register(\r\n    name: string,\r\n    definition: {\r\n        emitLatexRun: (run: Atom[], options: ToLatexOptions) => string;\r\n        applyStyle: (span: Span, style: Style) => string;\r\n        parse?: (\r\n            tokens: Token[],\r\n            onError: ErrorListener<ParserErrorCode>,\r\n            options: ParseTokensOptions\r\n        ) => Atom[];\r\n    }\r\n): void {\r\n    MODES_REGISTRY[name] = { ...definition };\r\n}\r\n\r\nexport function emitLatexRun(run: Atom[], options: ToLatexOptions): string {\r\n    if (MODES_REGISTRY[run[0].mode]?.emitLatexRun) {\r\n        return MODES_REGISTRY[run[0].mode].emitLatexRun(run, options);\r\n    }\r\n    return '';\r\n}\r\n\r\nexport function parseTokens(\r\n    mode: ParseMode,\r\n    tokens: Token[],\r\n    onError: ErrorListener<ParserErrorCode>,\r\n    options: ParseTokensOptions\r\n): Atom[] {\r\n    if (MODES_REGISTRY[mode]?.parse) {\r\n        return MODES_REGISTRY[mode].parse(tokens, onError, options);\r\n    }\r\n    return null;\r\n}\r\n\r\n/*\r\n * Apply the styling (bold, italic, etc..) as classes to the atom, and return\r\n * the effective font name to be used for metrics\r\n * ('Main-Regular', 'Caligraphic-Regualr' etc...)\r\n */\r\nexport function applyStyle(mode: ParseMode, span: Span, style: Style): string {\r\n    if (MODES_REGISTRY[mode]?.applyStyle) {\r\n        return MODES_REGISTRY[mode].applyStyle(span, style);\r\n    }\r\n    return '';\r\n}\r\n","import { isArray } from '../common/types';\r\n\r\nimport { Style, ParseMode } from '../public/core';\r\nimport { getCharacterMetrics, METRICS } from './font-metrics';\r\nimport { svgBodyToMarkup, svgBodyHeight } from './svg-span';\r\nimport { applyStyle as applyStyleForMode } from './modes-utils';\r\nimport { Context } from './context';\r\nimport { Mathstyle } from './mathstyle';\r\n\r\n/*\r\n * See https://tex.stackexchange.com/questions/81752/\r\n * for a thorough description of the TeXt atom type and their relevance to\r\n * proper kerning.\r\n */\r\n\r\nconst SPAN_TYPE = [\r\n    '',\r\n    'mord',\r\n    'mbin',\r\n    'mop',\r\n    'mrel',\r\n    'mopen',\r\n    'mclose',\r\n    'mpunct',\r\n    'minner',\r\n    'spacing',\r\n    // 'mtable',\r\n    'first',\r\n    'command',\r\n    'composition',\r\n    'error',\r\n    'placeholder',\r\n    'textord', // @revisit\r\n    'none', // @revisit. Use ''?\r\n] as const; // The const assertion prevents widening to string[]\r\nexport type SpanType = typeof SPAN_TYPE[number];\r\n\r\nexport function isSpanType(type: string): type is SpanType {\r\n    return ((SPAN_TYPE as unknown) as string[]).includes(type);\r\n}\r\n\r\n/*\r\n * See http://www.tug.org/TUGboat/tb30-3/tb96vieth.pdf for\r\n * typesetting conventions for mathematical physics (units, etc...)\r\n */\r\n\r\nconst INTER_ATOM_SPACING = {\r\n    'mord+mop': 3,\r\n    'mord+mbin': 4,\r\n    'mord+mrel': 5,\r\n    'mord+minner': 3,\r\n\r\n    'mop+mord': 3,\r\n    'mop+mop': 3,\r\n    'mop+mbin': 5,\r\n    'mop+minner': 3,\r\n\r\n    'mbin+mord': 4,\r\n    'mbin+mop': 4,\r\n    'mbin+mopen': 4,\r\n    'mbin+minner': 4,\r\n\r\n    'mrel+mord': 5,\r\n    'mrel+mop': 5,\r\n    'mrel+mopen': 5,\r\n    'mrel+minner': 5,\r\n\r\n    'mclose+mop': 3,\r\n    'mclose+mbin': 4,\r\n    'mclose+mrel': 5,\r\n    'mclose+minner': 3,\r\n\r\n    'mpunct+mord': 3,\r\n    'mpunct+mop': 3,\r\n    'mpunct+mbin': 4,\r\n    'mpunct+mrel': 5,\r\n    'mpunct+mopen': 3,\r\n    'mpunct+mpunct': 3,\r\n    'mpunct+minner': 3,\r\n};\r\n\r\nconst INTER_ATOM_TIGHT_SPACING = {\r\n    'mord+mop': 3,\r\n    'mop+mord': 3,\r\n    'mop+mop': 3,\r\n    'mclose+mop': 3,\r\n    'minner+mop': 3,\r\n};\r\n\r\n/**\r\n * Return a string made up of the concatenated arguments.\r\n * Each arguments can be either a string, which is unchanged,\r\n * or a number, which is converted to a string with at most 2 fractional digits.\r\n *\r\n */\r\nfunction toString(arg: (string | number)[] | string | number): string {\r\n    if (typeof arg === 'string') {\r\n        return arg;\r\n    }\r\n    if (typeof arg === 'number') {\r\n        return Number(Math.ceil(1e2 * arg) / 1e2).toString();\r\n    }\r\n    if (typeof arg === 'undefined') {\r\n        return '';\r\n    }\r\n    if (isArray(arg)) {\r\n        let result = '';\r\n        for (const elem of arg) {\r\n            result += toString(elem);\r\n        }\r\n        return result;\r\n        // } else if (arg) {\r\n        //     result += (arg as number).toString();\r\n    }\r\n    console.error('Span.toStringUnexpected argument type');\r\n    return '';\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n// SPAN\r\n//----------------------------------------------------------------------------\r\n/**\r\n * A span is the most elementary element that can be rendered.\r\n * It is composed of an optional body of text and an optional list\r\n * of children (other spans). Each span can be decorated with\r\n * CSS classes and style attributes.\r\n *\r\n * @param content the items 'contained' by this node\r\n * @param classes list of classes attributes associated with this node\r\n\r\n\r\n * @property  type - For example, `'command'`, `'mrel'`, etc...\r\n * @property classes - A string of space separated CSS classes\r\n * associated with this element\r\n * @property cssId - A CSS ID assigned to this span (optional)\r\n * @property children - An array, potentially empty, of spans which\r\n * this span encloses\r\n * @property body - Content of this span. Can be empty.\r\n * @property style - A set of key/value pairs specifying CSS properties\r\n * associated with this element.\r\n * @property height - The measurement from baseline to top, in em.\r\n * @property depth - The measurement from baseline to bottom, in em.\r\n * @property width\r\n */\r\nexport class Span {\r\n    type: SpanType;\r\n\r\n    children?: Span[];\r\n    value: string;\r\n\r\n    classes: string;\r\n    delim?: string; // @revisit\r\n\r\n    caret: ParseMode;\r\n    isSelected: boolean;\r\n\r\n    height?: number;\r\n    depth?: number;\r\n    skew?: number;\r\n    italic?: number;\r\n    maxFontSize?: number;\r\n\r\n    isTight?: boolean;\r\n\r\n    cssId?: string;\r\n\r\n    svgBody?: string;\r\n    svgOverlay?: string;\r\n    svgStyle?: string;\r\n\r\n    style: { [key: string]: string };\r\n    attributes?: { [key: string]: string }; // HTML attributes, for example 'data-atom-id'\r\n\r\n    constructor(\r\n        content: string | Span | Span[],\r\n        classes = '',\r\n        type: SpanType = ''\r\n    ) {\r\n        if (isArray(content)) {\r\n            // Check if isArray first, since an array is also an object\r\n            // Flatten it (i.e. [[a1, a2], b1, b2] -> [a1, a2, b1, b2]\r\n            this.children = [].concat(...content).filter((x) => x !== null);\r\n        } else if (typeof content === 'string') {\r\n            this.value = content;\r\n        } else if (content && typeof content === 'object') {\r\n            this.children = [content];\r\n        }\r\n\r\n        this.classes = classes;\r\n        this.type = type;\r\n        this.isSelected = false;\r\n\r\n        // STYLE\r\n        // CSS style, as an array of key value pairs.\r\n        // Use this.setStyle() to modify it.\r\n        this.style = null;\r\n\r\n        // Calculate the dimensions of this span based on its children\r\n        this.updateDimensions();\r\n    }\r\n    /**\r\n     * Update the dimensions of this node based on its children:\r\n     * - height: distance from bottom to top\r\n     * - depth: distance from bottom to baseline\r\n     * - maxFontSize: a size multiplier (typically set with commands such as \\huge)\r\n     */\r\n    updateDimensions(): void {\r\n        let height = 0.0;\r\n        let depth = 0.0;\r\n        let maxFontSize = 1.0;\r\n        if (this.children) {\r\n            this.children.forEach((x) => {\r\n                if (x.height > height) height = x.height;\r\n                if (x.depth > depth) depth = x.depth;\r\n                if (x.maxFontSize > maxFontSize) maxFontSize = x.maxFontSize;\r\n            });\r\n        } else if (typeof this.value === 'string') {\r\n            height = METRICS.baselineskip;\r\n            depth = 0;\r\n        }\r\n        this.height = height;\r\n        this.depth = depth;\r\n        this.maxFontSize = maxFontSize;\r\n    }\r\n\r\n    selected(isSelected: boolean): void {\r\n        this.isSelected = isSelected;\r\n        if (this.children) {\r\n            this.children.forEach((x) => x.selected(isSelected));\r\n        }\r\n    }\r\n\r\n    applyStyle(mode: ParseMode, style: Style, className?: string): void {\r\n        if (!style) return;\r\n\r\n        //\r\n        // 1. Apply color\r\n        //\r\n        if (style.color) {\r\n            if (style.color !== 'none') {\r\n                this.setStyle('color', style.color);\r\n            } else {\r\n                this.setStyle('color', '');\r\n            }\r\n        }\r\n        if (style.backgroundColor) {\r\n            if (style.backgroundColor !== 'none') {\r\n                this.setStyle('background-color', style.backgroundColor);\r\n            } else {\r\n                this.setStyle('background-color', '');\r\n            }\r\n        }\r\n\r\n        //\r\n        // 2. Add any custom style classes\r\n        //\r\n\r\n        if (className) {\r\n            this.classes += ' ' + className;\r\n        }\r\n\r\n        // If the body is null (for example for a line), we're done.\r\n        if (!this.value) return;\r\n\r\n        //\r\n        // 3. Determine the font family (i.e. 'ams', 'mathcal', etc...)\r\n        // and apply styling by adding appropriate classes to the atom\r\n        //\r\n\r\n        console.assert(typeof this.value === 'string');\r\n\r\n        const fontName = applyStyleForMode(mode, this, style);\r\n\r\n        //\r\n        // 5. Get the metrics information\r\n        //\r\n        if (fontName) {\r\n            this.maxFontSize =\r\n                {\r\n                    size1: 0.5,\r\n                    size2: 0.7,\r\n                    size3: 0.8,\r\n                    size4: 0.9,\r\n                    size5: 1.0,\r\n                    size6: 1.2,\r\n                    size7: 1.44,\r\n                    size8: 1.73,\r\n                    size9: 2.07,\r\n                    size10: 2.49,\r\n                }[style.fontSize] || 1.0;\r\n            this.height = 0.0;\r\n            this.depth = 0.0;\r\n            this.skew = 0.0;\r\n            this.italic = 0.0;\r\n            for (let i = 0; i < this.value.length; i++) {\r\n                const metrics = getCharacterMetrics(\r\n                    this.value.charAt(i),\r\n                    fontName\r\n                );\r\n                // If we were able to get metrics info for this character, store it.\r\n                if (metrics) {\r\n                    this.height = Math.max(this.height, metrics.height);\r\n                    this.depth = Math.max(this.depth, metrics.depth);\r\n                    this.skew = metrics.skew;\r\n                    this.italic = metrics.italic;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set the value of a CSS property associated with this span.\r\n     * For example, setStyle('border-right', 5.6, 'em');\r\n     *\r\n     * @param prop the CSS property to set\r\n     * @param value a series of strings and numbers that will be concatenated.\r\n     */\r\n    setStyle(prop: string, ...value: (string | number)[]): void {\r\n        const v = toString(value);\r\n        if (v.length > 0) {\r\n            if (!this.style) this.style = {};\r\n            this.style[prop] = v;\r\n        }\r\n    }\r\n\r\n    setTop(top: number): void {\r\n        if (isFinite(top) && top !== 0) {\r\n            if (!this.style) this.style = {};\r\n            this.style['top'] = toString(top) + 'em';\r\n            this.height -= top;\r\n            this.depth += top;\r\n        }\r\n    }\r\n\r\n    get left(): number {\r\n        if (this.style?.['margin-left']) {\r\n            return parseFloat(this.style['margin-left']);\r\n        }\r\n        return 0;\r\n    }\r\n    set left(value: number) {\r\n        if (!isFinite(value)) return;\r\n        if (!this.style) this.style = {};\r\n        if (value === 0) {\r\n            delete this.style['margin-left'];\r\n        } else {\r\n            this.style['margin-left'] = toString(value) + 'em';\r\n        }\r\n    }\r\n    set right(value: number) {\r\n        if (!isFinite(value)) return;\r\n        if (!this.style) this.style = {};\r\n        if (value === 0) {\r\n            delete this.style['margin-right'];\r\n        } else {\r\n            this.style['margin-right'] = toString(value) + 'em';\r\n        }\r\n    }\r\n    set width(value: number) {\r\n        if (!this.style) this.style = {};\r\n        this.style['width'] = toString(value) + 'em';\r\n    }\r\n\r\n    /**\r\n     * Generate the HTML markup to represent this span.\r\n     *\r\n     * @param hskip - Space (in mu, 1/18em) to leave on the left side\r\n     * of the span.\r\n     * This is used to adjust the inter-spacing between spans of different types,\r\n     * e.g. 'bin' and 'rel', according to the TeX rules (TexBook p.170)\r\n     *\r\n     * @param hscale - If a value is provided, the margins are scaled by\r\n     * this factor.\r\n     *\r\n     * @return HTML markup\r\n     */\r\n\r\n    toMarkup(\r\n        options: { hskip?: number; hscale?: number } = {\r\n            hskip: 0,\r\n            hscale: 1.0,\r\n        }\r\n    ): string {\r\n        let result = '';\r\n        let body = this.value ?? '';\r\n\r\n        //\r\n        // 1. Calculate the spacing between atoms, based on their type\r\n        // (`mord`, `mbin`, `mrel`, etc...)\r\n        //\r\n        if (this.children) {\r\n            let previousType = 'none';\r\n            for (let i = 0; i < this.children.length; i++) {\r\n                const child = this.children[i];\r\n                let spacing = 0;\r\n                const type = getEffectiveType(this.children, i);\r\n                const combinedType = previousType + '+' + type;\r\n                if (child.isTight) {\r\n                    spacing = INTER_ATOM_TIGHT_SPACING[combinedType] ?? 0;\r\n                } else {\r\n                    spacing = INTER_ATOM_SPACING[combinedType] ?? 0;\r\n                }\r\n                body += child.toMarkup({\r\n                    hskip: spacing,\r\n                    hscale: options.hscale,\r\n                });\r\n                previousType = type;\r\n            }\r\n        }\r\n        if (\r\n            (body === '\\u200b' || (!body && !this.svgBody)) &&\r\n            !this.classes &&\r\n            !this.cssId &&\r\n            !this.style &&\r\n            !this.svgOverlay\r\n        ) {\r\n            // 2a. Collapse 'empty' spans\r\n            result = '';\r\n        } else {\r\n            // Note: We can't omit the tag, even if it has no class and no style,\r\n            // as some layouts (vlist) depends on the presence of the tag to function\r\n            result = '<span';\r\n\r\n            if (this.cssId) {\r\n                result += ' id=\"' + this.cssId + '\" ';\r\n            }\r\n\r\n            if (this.attributes) {\r\n                result +=\r\n                    ' ' +\r\n                    Object.keys(this.attributes)\r\n                        .map((x) => `${x}=\"${this.attributes[x]}\"`)\r\n                        .join(' ');\r\n            }\r\n\r\n            const classes = this.classes.split(' ');\r\n\r\n            // Add the type (mbin, mrel, etc...) if specified\r\n            classes.push(\r\n                {\r\n                    command: 'ML__command',\r\n                    placeholder: 'ML__placeholder',\r\n                    error: 'ML__error',\r\n                }[this.type] ?? ''\r\n            );\r\n            if (this.caret === 'command') {\r\n                classes.push('ML__command-caret');\r\n            }\r\n\r\n            // Remove duplicate and empty classes\r\n            let classList = '';\r\n            if (classes.length > 1) {\r\n                classList = classes\r\n                    .filter((x, e, a) => {\r\n                        return x.length > 0 && a.indexOf(x) === e;\r\n                    })\r\n                    .join(' ');\r\n            } else {\r\n                classList = classes[0];\r\n            }\r\n\r\n            if (classList.length > 0) {\r\n                result += ` class=\"${classList}\"`;\r\n            }\r\n\r\n            // If a `hskip` value was provided, add it to the margin-left\r\n            if (options.hskip) {\r\n                this.left += options.hskip / 18;\r\n            }\r\n\r\n            if (this.style) {\r\n                const styleString = Object.keys(this.style)\r\n                    .map((x) => {\r\n                        // Render the style property, except the background\r\n                        // of selected spans\r\n                        if (x === 'background-color' && this.isSelected) {\r\n                            return '';\r\n                        }\r\n                        return x + ':' + this.style[x];\r\n                    })\r\n                    .join(';');\r\n\r\n                if (styleString.length > 0) {\r\n                    result += ' style=\"' + styleString + '\"';\r\n                }\r\n            }\r\n            result += '>';\r\n\r\n            // If there is some SVG markup associated with this span,\r\n            // include it now\r\n            if (this.svgBody) {\r\n                result += svgBodyToMarkup(this.svgBody);\r\n            } else if (this.svgOverlay) {\r\n                result += '<span style=\"';\r\n                result += 'display: inline-block;';\r\n                result += 'height:' + (this.height + this.depth) + 'em;';\r\n                result += 'vertical-align:' + this.depth + 'em;';\r\n                result += '\">';\r\n                result += body;\r\n                result += '</span>';\r\n                result += '<svg ';\r\n                result += 'style=\"position:absolute;';\r\n                result += 'overflow:overlay;';\r\n                result += 'height:' + (this.height + this.depth) + 'em;';\r\n                if (this.style?.padding) {\r\n                    result += 'top:' + this.style.padding + ';';\r\n                    result += 'left:' + this.style.padding + ';';\r\n                    result +=\r\n                        'width:calc(100% - 2 * ' + this.style.padding + ' );';\r\n                } else {\r\n                    result += 'top:0;';\r\n                    result += 'left:0;';\r\n                    result += 'width:100%;';\r\n                }\r\n                result += 'z-index:2;';\r\n                result += '\"';\r\n                if (this.svgStyle) {\r\n                    result += ' style=\"' + this.svgStyle + '\"';\r\n                }\r\n                result += '>';\r\n                result += this.svgOverlay;\r\n                result += '</svg>';\r\n            } else {\r\n                result += body;\r\n            }\r\n\r\n            result += '</span>';\r\n        }\r\n\r\n        //\r\n        // Add markup for the caret\r\n        //\r\n        if (this.caret === 'text') {\r\n            result += '<span class=\"ML__text-caret\"></span>';\r\n        } else if (this.caret === 'math') {\r\n            result += '<span class=\"ML__caret\"></span>';\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Can this span be coalesced with 'span'?\r\n     * This is used to 'coalesce' (i.e. group together) a series of spans that are\r\n     * identical except for their value, and to avoid generating redundant spans.\r\n     * That is: '12' ->\r\n     *      \"<span class='mord mathrm'>12</span>\"\r\n     * rather than:\r\n     *      \"<span class='mord mathrm'>1</span><span class='mord mathrm'>2</span>\"\r\n     */\r\n    tryCoalesceWith(span: Span): boolean {\r\n        // Don't coalesce if the tag or type are different\r\n        if (this.type !== span.type) return false;\r\n\r\n        // Don't coalesce consecutive errors, placeholders or commands\r\n        if (\r\n            this.type === 'error' ||\r\n            this.type === 'placeholder' ||\r\n            this.type === 'command'\r\n        ) {\r\n            return false;\r\n        }\r\n\r\n        // Don't coalesce if some of the content is SVG\r\n        if (this.svgBody || !this.value) return false;\r\n        if (span.svgBody || !span.value) return false;\r\n\r\n        // If this span or the candidate span have children, we can't\r\n        // coalesce them, but we'll try to coalesce their children\r\n        const hasChildren = this.children && this.children.length > 0;\r\n        const spanHasChildren = span.children && span.children.length > 0;\r\n        if (hasChildren || spanHasChildren) return false;\r\n\r\n        // If they have a different number of styles, can't coalesce\r\n        const thisStyleCount = this.style ? this.style.length : 0;\r\n        const spanStyleCount = span.style ? span.style.length : 0;\r\n        if (thisStyleCount !== spanStyleCount) return false;\r\n\r\n        // For the purpose of our comparison,\r\n        // any 'empty' classes (whitespace)\r\n        const classes = this.classes.trim().replace(/\\s+/g, ' ').split(' ');\r\n        const spanClasses = span.classes.trim().replace(/\\s+/g, ' ').split(' ');\r\n\r\n        // If they have a different number of classes, can't coalesce\r\n        if (classes.length !== spanClasses.length) return false;\r\n\r\n        // OK, let's do the more expensive comparison now.\r\n        // If they have different classes, can't coalesce\r\n        classes.sort();\r\n        spanClasses.sort();\r\n        for (let i = 0; i < classes.length; i++) {\r\n            // Don't coalesce vertical separators\r\n            // (used in column formating with {l||r} for example\r\n            if (classes[i] === 'vertical-separator') return false;\r\n            if (classes[i] !== spanClasses[i]) return false;\r\n        }\r\n\r\n        // If the styles are different, can't coalesce\r\n        if (this.style && span.style) {\r\n            for (const style in this.style) {\r\n                if (\r\n                    Object.prototype.hasOwnProperty.call(this.style, style) &&\r\n                    Object.prototype.hasOwnProperty.call(span.style, style)\r\n                ) {\r\n                    if (this.style[style] !== span.style[style]) return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        // OK, the attributes of those spans are compatible.\r\n        // Merge span into this\r\n        this.value += span.value;\r\n        this.height = Math.max(this.height, span.height);\r\n        this.depth = Math.max(this.depth, span.depth);\r\n        this.maxFontSize = Math.max(this.maxFontSize, span.maxFontSize);\r\n        // The italic correction for the coalesced spans is the\r\n        // italic correction of the last span.\r\n        this.italic = span.italic;\r\n        return true;\r\n    }\r\n}\r\n\r\nfunction getEffectiveType(xs: Span[], i: number): string {\r\n    if (i < 0 || i >= xs.length) return 'none';\r\n\r\n    const prevType = xs[i - 1]?.type ?? 'none';\r\n    const nextType = xs[i + 1]?.type ?? 'none';\r\n\r\n    let result = xs[i].type ?? 'none';\r\n\r\n    if (result === 'first') return 'none';\r\n    if (result === 'textord') return 'mord';\r\n    if (result === 'mbin') {\r\n        // If a `mbin` span, i.e. \"+\" is after or before spans\r\n        // of a certain type, consider it to be a `mord` instead.\r\n        // This is to handle proper spacing of, e.g. \"-4\" vs \"1-4\"\r\n        if (\r\n            /first|none|mrel|mpunct|mopen|mbin|mop/.test(prevType) ||\r\n            /none|mrel|mpunct|mclose/.test(nextType)\r\n        ) {\r\n            result = 'mord';\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n/**\r\n * Attempts to coalesce (merge) spans, for example consecutive text spans.\r\n * Return a new tree with coalesced spans.\r\n *\r\n */\r\nexport function coalesce(spans: Span[]): Span[] {\r\n    if (!spans || spans.length === 0) return [];\r\n\r\n    spans[0].children = coalesce(spans[0].children);\r\n    const result = [spans[0]];\r\n\r\n    for (let i = 1; i < spans.length; i++) {\r\n        if (!result[result.length - 1].tryCoalesceWith(spans[i])) {\r\n            spans[i].children = coalesce(spans[i].children);\r\n            result.push(spans[i]);\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n// UTILITY FUNCTIONS\r\n//----------------------------------------------------------------------------\r\n\r\nexport function height(spans: Span | Span[]): number {\r\n    if (!spans) return 0;\r\n    if (isArray(spans)) {\r\n        return spans.reduce((acc, x) => Math.max(acc, x.height), 0);\r\n    }\r\n    return spans.height;\r\n}\r\n\r\nexport function depth(spans: Span | Span[]): number {\r\n    if (!spans) return 0;\r\n    if (isArray(spans)) {\r\n        return spans.reduce((acc, x) => Math.max(acc, x.depth), 0);\r\n    }\r\n    return spans.depth;\r\n}\r\n\r\nexport function skew(spans: Span | Span[]): number {\r\n    if (!spans) return 0;\r\n    if (isArray(spans)) {\r\n        let result = 0;\r\n        for (const span of spans) {\r\n            result += span.skew || 0;\r\n        }\r\n        return result;\r\n    }\r\n    return spans.skew;\r\n}\r\n\r\nexport function italic(spans: Span | Span[]): number {\r\n    if (!spans) return 0;\r\n    if (isArray(spans)) {\r\n        return spans[spans.length - 1].italic;\r\n    }\r\n    return spans.italic;\r\n}\r\n\r\n/**\r\n * Make an element made of a sequence of children with classes\r\n * @param content the items 'contained' by this node\r\n * @param classes list of classes attributes associated with this node\r\n */\r\nexport function makeSpan(\r\n    content: string | Span | Span[],\r\n    classes = '',\r\n    type: SpanType = ''\r\n): Span {\r\n    return new Span(content, classes, type);\r\n}\r\n\r\nexport function makeSymbol(\r\n    fontFamily: string,\r\n    symbol: string,\r\n    classes = '',\r\n    type: SpanType = ''\r\n): Span {\r\n    const result = new Span(symbol, classes, type);\r\n\r\n    const metrics = getCharacterMetrics(symbol, fontFamily);\r\n    result.height = metrics.height;\r\n    result.depth = metrics.depth;\r\n    result.skew = metrics.skew;\r\n    result.italic = metrics.italic;\r\n    result.right = metrics.italic;\r\n\r\n    return result;\r\n}\r\n\r\n/**\r\n * Makes an element placed in each of the vlist elements to ensure that each\r\n * element has the same max font size. To do this, we create a zero-width space\r\n * with the correct font size.\r\n//  * Note: without this, even when fontSize = 0, the fraction bar is no\r\n//  * longer positioned correctly\r\n */\r\nfunction makeFontSizer(context: Context, fontSize: number): Span {\r\n    const fontSizeAdjustment = fontSize\r\n        ? fontSize / context.mathstyle.sizeMultiplier\r\n        : 0;\r\n    const fontSizeInner = new Span('\\u200b'); // ZERO WIDTH SPACE\r\n    fontSizeInner.depth = 0;\r\n    fontSizeInner.height = 0;\r\n    if (fontSizeAdjustment !== 1) {\r\n        fontSizeInner.setStyle(\r\n            'font-size',\r\n            fontSizeAdjustment,\r\n            fontSizeAdjustment > 0 ? 'em' : ''\r\n        );\r\n        fontSizeInner.attributes = {\r\n            'aria-hidden': 'true',\r\n        };\r\n    }\r\n\r\n    if (context.size !== 'size5') {\r\n        return new Span(\r\n            fontSizeInner,\r\n            'fontsize-ensurer reset-' + context.size + ' size5'\r\n        );\r\n    }\r\n    return fontSizeAdjustment !== 0 ? fontSizeInner : null;\r\n}\r\n\r\nexport function makeStruts(\r\n    content: Span,\r\n    classes = '',\r\n    type: SpanType = ''\r\n): Span {\r\n    const topStrut = makeSpan('', 'ML__strut');\r\n    topStrut.setStyle('height', Math.max(0.0, height(content)), 'em');\r\n    const struts = [topStrut];\r\n\r\n    if (depth(content) !== 0) {\r\n        const bottomStrut = makeSpan('', 'ML__strut--bottom');\r\n        bottomStrut.setStyle('height', height(content) + depth(content), 'em');\r\n        bottomStrut.setStyle('vertical-align', -depth(content), 'em');\r\n        struts.push(bottomStrut);\r\n    }\r\n    struts.push(content);\r\n    return makeSpan(struts, classes, type);\r\n}\r\n\r\nexport function makeStyleWrap(\r\n    type: SpanType,\r\n    children: Span | Span[],\r\n    fromStyle: Mathstyle,\r\n    toStyle: Mathstyle,\r\n    classes: string\r\n): Span {\r\n    const result = makeHlist(\r\n        children,\r\n        classes + ' style-wrap ' + fromStyle.adjustTo(toStyle)\r\n    );\r\n    result.type = type;\r\n\r\n    const multiplier = toStyle.sizeMultiplier / fromStyle.sizeMultiplier;\r\n    result.height *= multiplier; // @revisit. Use spanHeight()? is height set at this point?\r\n    result.depth *= multiplier;\r\n    result.maxFontSize = toStyle.sizeMultiplier;\r\n\r\n    return result;\r\n}\r\n\r\n/**\r\n * Add some SVG markup to be overlaid on top of the span\r\n */\r\nexport function addSVGOverlay(\r\n    body: Span,\r\n    svgMarkup: string,\r\n    svgStyle: string\r\n): Span {\r\n    body.svgOverlay = svgMarkup;\r\n    body.svgStyle = svgStyle;\r\n    return body;\r\n}\r\n\r\nexport function makeHlist(\r\n    spans: Span | Span[],\r\n    classes = '',\r\n    type: SpanType = ''\r\n): Span {\r\n    // Note: do not try to optimize and avoid creating the span below\r\n    // Some layouts, e.g. vlist, depend on that span being there.\r\n\r\n    const result = new Span(spans, classes, type);\r\n\r\n    let multiplier = 1.0;\r\n    if (spans instanceof Span) {\r\n        multiplier = spans.maxFontSize;\r\n    } else {\r\n        multiplier = result.children.reduce(\r\n            (acc, x) => Math.max(acc, x.maxFontSize),\r\n            multiplier\r\n        );\r\n    }\r\n    result.height *= multiplier;\r\n    result.depth *= multiplier;\r\n\r\n    return result;\r\n}\r\n\r\n/**\r\n * Create a new span of type `vlist`, a set of vertically stacked items\r\n * @param elements  An array of Span and integer. The integer can be either some kerning information\r\n * or the value of an individual shift of the preceding child if in 'individualShift' mode\r\n * @param pos The method that will be used to position the elements in the vlist.\r\n *\r\n * One of:\r\n * - `\"individualShift\"`: each child must be followed by a number indicating how much to shift it (i.e. moved downwards)\r\n * - `\"top\"`: posData specifies the topmost point of the vlist (>0 move up)\r\n * - `\"bottom\"`: posData specifies the bottommost point of the vlist (>0 move down)\r\n * - `\"shift\"`: the baseline of the vlist will be positioned posData away from the baseline\r\n * of the first child. (>0 moves down)\r\n */\r\nexport function makeVlist(\r\n    context: Context,\r\n    elements: (number | Span[] | Span)[],\r\n    pos: 'shift' | 'top' | 'bottom' | 'individualShift' = 'shift',\r\n    posData = 0\r\n): Span {\r\n    let listDepth = 0;\r\n    let currPos = 0;\r\n\r\n    // Normalize the elements so that they're all either a number or\r\n    // a single span. If a child is an array of spans,\r\n    // wrap it in a span\r\n    for (let i = 0; i < elements.length; i++) {\r\n        if (isArray(elements[i])) {\r\n            if ((elements[i] as Span[]).length === 1) {\r\n                // If that's an array made up of a single span, use that span\r\n                elements[i] = elements[i][0];\r\n            } else {\r\n                // Otherwise, wrap it in a span\r\n                elements[i] = makeSpan(elements[i] as Span[]);\r\n            }\r\n        }\r\n    }\r\n\r\n    if (pos === 'shift') {\r\n        if (elements[0]) {\r\n            console.assert(elements[0] instanceof Span);\r\n            listDepth = -(elements[0] as Span).depth - posData;\r\n        } else {\r\n            listDepth = -posData;\r\n        }\r\n    } else if (pos === 'bottom') {\r\n        listDepth = -posData;\r\n    } else if (pos === 'top') {\r\n        let bottom = posData;\r\n        for (const element of elements) {\r\n            if (element instanceof Span) {\r\n                // It's a Span, use the dimension data\r\n                bottom -= element.height + element.depth;\r\n            } else if (typeof element === 'number') {\r\n                // It's a kern adjustment\r\n                bottom -= element;\r\n            }\r\n        }\r\n        listDepth = bottom;\r\n    } else if (pos === 'individualShift') {\r\n        // Individual adjustment to each elements.\r\n        // The elements list is made up of a Span followed\r\n        // by a shift adjustment as an integer\r\n        const originalElements: (number | Span)[] = elements as (\r\n            | number\r\n            | Span\r\n        )[];\r\n        elements = [originalElements[0]];\r\n\r\n        // Add in kerns to the list of elements to get each element to be\r\n        // shifted to the correct specified shift\r\n        console.assert(originalElements[0] instanceof Span);\r\n        listDepth = -originalElements[1] - (originalElements[0] as Span).depth;\r\n        currPos = listDepth;\r\n        for (let i = 2; i < originalElements.length; i += 2) {\r\n            console.assert(originalElements[i] instanceof Span);\r\n            const diff =\r\n                -originalElements[i + 1] -\r\n                currPos -\r\n                (originalElements[i] as Span).depth;\r\n            currPos = currPos + diff;\r\n\r\n            console.assert(originalElements[i - 2] instanceof Span);\r\n            const kern =\r\n                diff -\r\n                ((originalElements[i - 2] as Span).height +\r\n                    (originalElements[i - 2] as Span).depth);\r\n\r\n            elements.push(kern);\r\n            elements.push(originalElements[i]);\r\n        }\r\n    } else {\r\n        console.assert(false, 'makeVList with unknown method: \"' + pos + '\"');\r\n    }\r\n\r\n    // Make the fontSizer\r\n    let maxFontSize = 1.0;\r\n    for (const element of elements) {\r\n        if (element instanceof Span) {\r\n            maxFontSize = Math.max(maxFontSize, element.maxFontSize);\r\n        }\r\n    }\r\n    const fontSizer = makeFontSizer(context, maxFontSize);\r\n\r\n    const newElements: Span[] = [];\r\n    currPos = listDepth;\r\n    for (const element of elements) {\r\n        if (typeof element === 'number') {\r\n            // It's a kern adjustment\r\n            currPos += element;\r\n        } else if (element instanceof Span) {\r\n            const wrap = makeSpan([fontSizer, element]);\r\n            wrap.setTop(-element.depth - currPos);\r\n            newElements.push(wrap);\r\n            currPos += element.height + element.depth;\r\n        }\r\n    }\r\n\r\n    const result = makeSpan(newElements, 'vlist');\r\n\r\n    // Fix the final height and depth, in case there were kerns at the ends\r\n    // since makeSpan won't take that into account.\r\n    result.depth = Math.max(listDepth, depth(result) ?? 0);\r\n    result.height = Math.max(-currPos, height(result) ?? 0);\r\n\r\n    return result;\r\n}\r\n\r\n/**\r\n * Create a span that consist of a (stretchy) SVG element\r\n *\r\n * @param classes list of classes attributes associated with this node\r\n */\r\nexport function makeSVGSpan(svgBodyName: string): Span {\r\n    const span = new Span(null);\r\n    span.svgBody = svgBodyName;\r\n    span.height = svgBodyHeight(svgBodyName) / 2;\r\n    span.depth = span.height;\r\n    return span;\r\n}\r\n","export function stringToCodepoints(str: string): number[] {\r\n    const result: number[] = [];\r\n    for (let i = 0; i < str.length; i++) {\r\n        let code = str.charCodeAt(i);\r\n        if (code === 0x0d && str.charCodeAt(i + 1) === 0x0a) {\r\n            code = 0x0a;\r\n            i++;\r\n        }\r\n        if (code === 0x0d || code === 0x0c) code = 0x0a;\r\n        if (code === 0x00) code = 0xfffd;\r\n\r\n        // Decode a surrogate pair into an astral codepoint.\r\n        if (code >= 0xd800 && code <= 0xdbff) {\r\n            const nextCode = str.charCodeAt(i + 1);\r\n            if (nextCode >= 0xdc00 && nextCode <= 0xdfff) {\r\n                const lead = code - 0xd800;\r\n                const trail = nextCode - 0xdc00;\r\n                code = Math.pow(2, 16) + lead * Math.pow(2, 10) + trail;\r\n                // N = ((H - 0xD800) * 0x400) + (L - 0xDC00) + 0x10000;\r\n                i++;\r\n            }\r\n        }\r\n\r\n        result.push(code);\r\n    }\r\n    return result;\r\n}\r\n\r\nconst ZWJ = 0x200d; // Zero-width joiner\r\n\r\n// const ZWSP = 0x200b; // Zero-width space\r\n\r\n/* The following codepoints should combine with the previous ones */\r\nconst EMOJI_COMBINATOR = [\r\n    [ZWJ, 1],\r\n    [0xfe0e, 2], // VS-15: text presentation, VS-16: Emoji presentation\r\n    [0x1f3fb, 5], // EMOJI_MODIFIER_FITZPATRICK_TYPE 1-6\r\n    [0x1f9b0, 4], // red hair..white hair\r\n    [0xe0020, 96], // EMOJI_TAG\r\n];\r\nlet emojiCombinator: { [code: number]: boolean };\r\n\r\n// Regional indicator: a pair of codepoints indicating some flags\r\nconst REGIONAL_INDICATOR = [0x1f1e6, 0x1f1ff];\r\n\r\nfunction isEmojiCombinator(code: number): boolean {\r\n    if (typeof emojiCombinator === 'undefined') {\r\n        emojiCombinator = {};\r\n        EMOJI_COMBINATOR.forEach((x) => {\r\n            for (let i = x[0]; i <= x[0] + x[1] - 1; i++) {\r\n                emojiCombinator[i] = true;\r\n            }\r\n        });\r\n    }\r\n    return emojiCombinator[code] ?? false;\r\n}\r\n\r\nfunction isRegionalIndicator(code: number): boolean {\r\n    return code >= REGIONAL_INDICATOR[0] && code <= REGIONAL_INDICATOR[1];\r\n}\r\n\r\n/**\r\n * Return a string or an array of graphemes.\r\n * This includes:\r\n * - emoji with skin and hair modifiers\r\n * - emoji combination (for example \"female pilot\")\r\n * - text emoji with an emoji presentation style modifier\r\n *      - U+1F512 U+FE0E \r\n *      - U+1F512 U+FE0F \r\n * - flags represented as two regional indicator codepoints\r\n * - flags represented as a flag emoji + zwj + an emoji tag\r\n * - other combinations (for example, rainbow flag)\r\n */\r\n\r\nexport function splitGraphemes(str: string): string | string[] {\r\n    // If it's all ASCII, short-circuit the grapheme splitting...\r\n    if (/^[\\x20-\\xFF]*$/.test(str)) return str;\r\n\r\n    const result: string[] = [];\r\n\r\n    const codePoints = stringToCodepoints(str);\r\n    let index = 0;\r\n    while (index < codePoints.length) {\r\n        const code = codePoints[index++];\r\n\r\n        const next = codePoints[index];\r\n        // Combine sequences\r\n        if (next === ZWJ) {\r\n            // Zero-width joiner sequences are:\r\n            // ZWJ_SEQUENCE := (CHAR + ZWJ)+\r\n            const baseIndex = index - 1;\r\n            index += 2;\r\n            while (codePoints[index] === ZWJ) {\r\n                index += 2;\r\n            }\r\n            result.push(\r\n                String.fromCodePoint(\r\n                    ...codePoints.slice(baseIndex, index - baseIndex + 1)\r\n                )\r\n            );\r\n        } else if (isEmojiCombinator(next)) {\r\n            // Combine emoji sequences\r\n            // See http://unicode.org/reports/tr51/#def_emoji_tag_sequence\r\n            const baseIndex = index - 1; // The previous character is the 'base'\r\n            while (isEmojiCombinator(codePoints[index])) {\r\n                index += codePoints[index] === ZWJ ? 2 : 1;\r\n            }\r\n            result.push(\r\n                String.fromCodePoint(\r\n                    ...codePoints.slice(baseIndex, index - baseIndex)\r\n                )\r\n            );\r\n        } else if (isRegionalIndicator(code)) {\r\n            // Some (but not all) flags are represented by a sequence of two\r\n            // \"regional indicators\" codepoints.\r\n            index += 1;\r\n            result.push(\r\n                String.fromCodePoint(...codePoints.slice(index - 2, 2))\r\n            );\r\n        } else {\r\n            result.push(String.fromCodePoint(code));\r\n        }\r\n    }\r\n    return result;\r\n}\r\n","/**\r\n * ## Reference\r\n * TeX source code:\r\n * {@link  http://tug.org/texlive/devsrc/Build/source/texk/web2c/tex.web | Tex.web}\r\n *\r\n */\r\n\r\nimport { splitGraphemes } from './grapheme-splitter';\r\n\r\n// The 'special' tokens must be of length > 1 to distinguish\r\n// them from literals.\r\n// '<space>': whitespace\r\n// '<$$>'   : display mode shift\r\n// '<$>'    : inline mode shift\r\n// '<{>'    : begin group\r\n// '<}>'    : end group\r\n// '#0'-'#9': argument\r\n// '#?'     : placeholder\r\n// '\\' + ([a-zA-Z*]+)|([^a-zAz*])  : command\r\n// other (length = 1)   : literal\r\n//  See: [TeX:289](http://tug.org/texlive/devsrc/Build/source/texk/web2c/tex.web)\r\nexport type Token = string;\r\n\r\n/**\r\n * Given a LaTeX expression represented as a character string,\r\n * the Lexer class will scan and return Tokens for the lexical\r\n * units in the string.\r\n *\r\n * @param s A string of LaTeX\r\n */\r\nclass Tokenizer {\r\n    private s: string | string[];\r\n    private pos: number;\r\n\r\n    obeyspaces = false;\r\n\r\n    constructor(s: string) {\r\n        this.s = splitGraphemes(s);\r\n        this.pos = 0;\r\n    }\r\n    /**\r\n     * @return True if we reached the end of the stream\r\n     */\r\n    end(): boolean {\r\n        return this.pos >= this.s.length;\r\n    }\r\n    /**\r\n     * Return the next char and advance\r\n     */\r\n    get(): string {\r\n        return this.pos < this.s.length ? this.s[this.pos++] : '';\r\n    }\r\n    /**\r\n     * Return the next char, but do not advance\r\n     */\r\n    peek(): string {\r\n        return this.s[this.pos];\r\n    }\r\n    /**\r\n     * Return the next substring matching regEx and advance.\r\n     */\r\n    match(regEx: RegExp): string {\r\n        // this.s can either be a string, if it's made up only of ASCII chars\r\n        // or an array of graphemes, if it's more complicated.\r\n        let execResult: (string | null)[] | null;\r\n        if (typeof this.s === 'string') {\r\n            execResult = regEx.exec(this.s.slice(this.pos));\r\n        } else {\r\n            execResult = regEx.exec(this.s.slice(this.pos).join(''));\r\n        }\r\n        if (execResult?.[0]) {\r\n            this.pos += execResult[0].length;\r\n            return execResult[0];\r\n        }\r\n        return null;\r\n    }\r\n    /**\r\n     * Return the next token, or null.\r\n     */\r\n    next(): Token | null {\r\n        // If we've reached the end, exit\r\n        if (this.end()) return null;\r\n        // Handle white space\r\n        // In text mode, spaces are significant,\r\n        // however they are coalesced unless \\obeyspaces\r\n        if (!this.obeyspaces && this.match(/^[ \\f\\n\\r\\t\\v\\xA0\\u2028\\u2029]+/)) {\r\n            // Note that browsers are inconsistent in their definitions of the\r\n            // `\\s` metacharacter, so we use an explicit pattern instead.\r\n\r\n            // - IE:          `[ \\f\\n\\r\\t\\v]`\r\n            // - Chrome:      `[ \\f\\n\\r\\t\\v\\u00A0]`\r\n            // - Firefox:     `[ \\f\\n\\r\\t\\v\\u00A0\\u2028\\u2029]`\r\n            // - \\f \\u000C: form feed (FORM FEED)\r\n            // - \\n \\u000A: linefeed (LINE FEED)\r\n            // - \\r \\u000D: carriage return\r\n            // - \\t \\u0009: tab (CHARACTER TABULATION)\r\n            // - \\v \\u000B: vertical tab (LINE TABULATION)\r\n            // - \\u00A0: NON-BREAKING SPACE\r\n            // - \\u2028: LINE SEPARATOR\r\n            // - \\u2029: PARAGRAPH SEPARATOR\r\n            return '<space>';\r\n        } else if (\r\n            this.obeyspaces &&\r\n            this.match(/^[ \\f\\n\\r\\t\\v\\xA0\\u2028\\u2029]/)\r\n        ) {\r\n            // Don't coalesce when this.obeyspaces is true (different regex from above)\r\n            return '<space>';\r\n        }\r\n        const next = this.get();\r\n        // Is it a command?\r\n        if (next === '\\\\') {\r\n            if (!this.end()) {\r\n                // A command is either a string of letters and asterisks...\r\n                let command = this.match(/^[a-zA-Z*]+/);\r\n                if (command) {\r\n                    // Spaces after a 'control word' are ignored\r\n                    // (but not after a 'control symbol' (single char)\r\n                    this.match(/^[ \\f\\n\\r\\t\\v\\xA0\\u2028\\u2029]*/);\r\n                } else {\r\n                    // ... or a single non-letter character\r\n                    command = this.get();\r\n                    if (command === ' ') {\r\n                        // The `\\ ` command is equivalent to a single space\r\n                        return '<space>';\r\n                    }\r\n                }\r\n\r\n                return '\\\\' + command;\r\n            }\r\n        } else if (next === '{') {\r\n            // This is a group start\r\n            return '<{>';\r\n        } else if (next === '}') {\r\n            // This is a group end\r\n            return '<}>';\r\n        } else if (next === '^') {\r\n            if (this.peek() === '^') {\r\n                // It might be a ^^ command (inline hex character)\r\n                this.get();\r\n                // There can be zero to six carets with the same number of hex digits\r\n                const hex = this.match(\r\n                    /^(\\^(\\^(\\^(\\^[0-9a-f])?[0-9a-f])?[0-9a-f])?[0-9a-f])?[0-9a-f][0-9a-f]/\r\n                );\r\n                if (hex) {\r\n                    return String.fromCodePoint(\r\n                        parseInt(hex.slice(hex.lastIndexOf('^') + 1), 16)\r\n                    );\r\n                }\r\n            }\r\n            return next;\r\n        } else if (next === '#') {\r\n            // This could be either a param token, or a literal # (used for\r\n            // colorspecs, for example). A param token is a '#' followed by\r\n            // - a digit 0-9 followed by a non-alpha, non-digit\r\n            // - or '?' (to indicate a placeholder)\r\n            // - or '@' (to indicate an implicit, optional, argument)\r\n            // Otherwise, it's a literal '#'.\r\n            if (!this.end()) {\r\n                let isParam = false;\r\n                if (/[0-9?@]/.test(this.peek())) {\r\n                    // Could be a param\r\n                    isParam = true;\r\n                    // Need to look ahead to the following char\r\n                    // (to exclude, e.g. '#1c1b2d': it's not a '#' token, it's a color)\r\n                    if (this.pos + 1 < this.s.length) {\r\n                        const after = this.s[this.pos + 1];\r\n                        isParam = /[^0-9A-Za-z]/.test(after);\r\n                    }\r\n                }\r\n                if (isParam) {\r\n                    return '#' + this.get();\r\n                }\r\n                return '#';\r\n            }\r\n        } else if (next === '$') {\r\n            // Mode switch\r\n            if (this.peek() === '$') {\r\n                // $$\r\n                this.get();\r\n                return '<$$>';\r\n            }\r\n            // $\r\n            return '<$>';\r\n        }\r\n        return next;\r\n    }\r\n}\r\n\r\n// Some primitive commands need to be handled in the expansion phase\r\n// (the 'gullet')\r\nfunction expand(lex: Tokenizer, args: string[]): Token[] {\r\n    let result: Token[] = [];\r\n    let token = lex.next();\r\n    if (token) {\r\n        if (token === '\\\\relax') {\r\n            // Do nothing\r\n        } else if (token === '\\\\noexpand') {\r\n            // Do not expand the next token\r\n            token = lex.next();\r\n            if (token) {\r\n                result.push(token);\r\n            }\r\n        } else if (token === '\\\\obeyspaces') {\r\n            lex.obeyspaces = true;\r\n        } else if (token === '\\\\space' || token === '~') {\r\n            // The `\\space` command is equivalent to a single space\r\n            // The ~ is an 'active character' (a single character macro)\r\n            // that maps to <space>\r\n            result.push('<space>');\r\n        } else if (token === '\\\\bgroup') {\r\n            // Begin group, synonym for opening brace\r\n            result.push('<{>');\r\n        } else if (token === '\\\\egroup') {\r\n            // End group, synonym for closing brace\r\n            result.push('<}>');\r\n        } else if (token === '\\\\string') {\r\n            // Turn the next token into a string\r\n            token = lex.next();\r\n            if (token) {\r\n                if (token[0] === '\\\\') {\r\n                    Array.from(token).forEach((x) =>\r\n                        result.push(x === '\\\\' ? '\\\\backslash' : x)\r\n                    );\r\n                } else if (token === '<{>') {\r\n                    result.push('\\\\{');\r\n                } else if (token === '<space>') {\r\n                    result.push('~');\r\n                } else if (token === '<}>') {\r\n                    result.push('\\\\}');\r\n                }\r\n            }\r\n        } else if (token === '\\\\csname') {\r\n            // Turn the next tokens, until `\\endcsname`, into a command\r\n            while (lex.peek() === '<space>') {\r\n                lex.next();\r\n            }\r\n\r\n            let command = '';\r\n            let done = false;\r\n            let tokens = [];\r\n            do {\r\n                if (tokens.length === 0) {\r\n                    // We're out of tokens to look at, get some more\r\n                    if (/^#[0-9?@]$/.test(lex.peek())) {\r\n                        // Expand parameters (but not commands)\r\n                        const param = lex.get().slice(1);\r\n                        tokens = tokenize(\r\n                            args?.[param] ?? args?.['?'] ?? '\\\\placeholder{}',\r\n                            args\r\n                        );\r\n                        token = tokens[0];\r\n                    } else {\r\n                        token = lex.next();\r\n                        tokens = token ? [token] : [];\r\n                    }\r\n                }\r\n                done = tokens.length === 0;\r\n                if (!done && token === '\\\\endcsname') {\r\n                    done = true;\r\n                    tokens.shift();\r\n                }\r\n                if (!done) {\r\n                    done =\r\n                        token === '<$>' ||\r\n                        token === '<$$>' ||\r\n                        token === '<{>' ||\r\n                        token === '<}>' ||\r\n                        (token.length > 1 && token[0] === '\\\\');\r\n                }\r\n                if (!done) {\r\n                    command += tokens.shift();\r\n                }\r\n            } while (!done);\r\n            if (command) {\r\n                result.push('\\\\' + command);\r\n            }\r\n            result = result.concat(tokens);\r\n        } else if (token === '\\\\endcsname') {\r\n            // Unexpected \\endcsname are ignored\r\n        } else if (token.length > 1 && token[0] === '#') {\r\n            // It's a parameter to expand\r\n            const param = token.slice(1);\r\n            result = result.concat(\r\n                tokenize(\r\n                    args?.[param] ?? args?.['?'] ?? '\\\\placeholder{}',\r\n                    args\r\n                )\r\n            );\r\n        } else {\r\n            result.push(token);\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\n/**\r\n * Create Tokens from a stream of LaTeX\r\n *\r\n * @param s - A string of LaTeX. It can include comments (with the `%`\r\n * marker) and multiple lines.\r\n */\r\nexport function tokenize(s: string, args: string[]): Token[] {\r\n    // Merge multiple lines into one, and remove comments\r\n    const lines = s.toString().split(/\\r?\\n/);\r\n    let stream = '';\r\n    let sep = '';\r\n    for (const line of lines) {\r\n        stream += sep;\r\n        sep = ' ';\r\n        // Remove everything after a % (comment marker)\r\n        // (but \\% should be preserved...)\r\n        const m = line.match(/((?:\\\\%)|[^%])*/);\r\n        if (m !== null) stream += m[0];\r\n    }\r\n\r\n    const tokenizer = new Tokenizer(stream);\r\n    let result: Token[] = [];\r\n    do {\r\n        result = result.concat(expand(tokenizer, args));\r\n    } while (!tokenizer.end());\r\n\r\n    return result;\r\n}\r\n\r\nexport function joinLatex(segments: string[]): string {\r\n    let sep = '';\r\n    let result = '';\r\n    for (const segment of segments) {\r\n        if (segment) {\r\n            if (/[a-zA-Z*]/.test(segment[0])) {\r\n                // If the segment begins with a char that *could* be in a command\r\n                // name... insert a separator (if one was needed for the previous segment)\r\n                result += sep;\r\n            }\r\n            // If the segment ends in a command...\r\n            if (/\\\\[a-zA-Z]+\\*?$/.test(segment)) {\r\n                // ... potentially add a space before the next segment\r\n                sep = ' ';\r\n            } else {\r\n                sep = '';\r\n            }\r\n            result += segment;\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function tokensToString(tokens: Token[]): string {\r\n    const result = joinLatex(\r\n        tokens.map((token) => {\r\n            return (\r\n                {\r\n                    '<space>': ' ',\r\n                    '<$$>': '$$',\r\n                    '<$>': '$',\r\n                    '<{>': '{',\r\n                    '<}>': '}',\r\n                }[token] ?? token\r\n            );\r\n        })\r\n    );\r\n    return result;\r\n}\r\n","import type { ArgumentType } from '../core/context';\r\nimport type { Atom, AtomType, BBoxParam } from '../core/atom-class';\r\nimport type { Colspec } from '../core-atoms/array';\r\nimport type {\r\n    Variant,\r\n    // VariantStyle,\r\n    MacroDictionary,\r\n    Style,\r\n    ParseMode,\r\n} from '../public/core';\r\n\r\nexport type FunctionArgumentDefiniton = {\r\n    isOptional: boolean;\r\n    type: ArgumentType;\r\n};\r\n\r\nexport type Argument = string | number | BBoxParam | Colspec[] | Atom[];\r\n\r\nexport type FunctionDefinition = {\r\n    params: FunctionArgumentDefiniton[];\r\n    infix: boolean;\r\n    isFunction: boolean;\r\n    ifMode: ParseMode;\r\n    applyMode: ParseMode;\r\n    createAtom: (command: string, args: Argument[], style: Style) => Atom;\r\n    applyStyle: (command: string, args: Argument[]) => Style;\r\n\r\n    frequency?: number;\r\n    category?: string;\r\n    template?: string;\r\n};\r\n\r\ntype EnvironmentDefinition = {\r\n    /* If true, the 'content' of the environment is parsed in tabular mode,\r\n        i.e. wiht '&' creating a new column and '\\\\' creating a new row */\r\n    tabular: boolean;\r\n    params: FunctionArgumentDefiniton[];\r\n    createAtom: EnvironmentConstructor;\r\n};\r\n\r\nexport type SymbolDefinition = {\r\n    type: AtomType;\r\n    value: string;\r\n    variant: Variant;\r\n    // variantStyle: VariantStyle;\r\n\r\n    frequency?: number;\r\n    category?: string;\r\n    template?: string;\r\n};\r\n\r\nexport const MATH_SYMBOLS: { [name: string]: SymbolDefinition } = {};\r\n// Map a character to some corresponding Latex\r\n// This is used for some characters such as  SUPERSCRIPT TWO.\r\n// This is also an opportunity to specify the prefered form when\r\n// a unicode character is encountered that maps to multiple commands,\r\n// for example  could map either to \\ne or \\neq\r\n// The table will also be populated by any registered symbol\r\n// from MATH_SYMBOLS\r\n// prettier-ignore\r\nexport const REVERSE_MATH_SYMBOLS = {\r\n    '<': '<',   // Also \\lt\r\n    '>': '>',   // Also \\gt\r\n    'o': 'o',    // Also \\omicron\r\n    '&': '\\\\&',  // Also \\And\r\n    '{': '\\\\{',  // Also \\lbrace\r\n    '}': '\\\\}',  // Also \\rbrace\r\n    '[': '\\\\lbrack',\r\n    ']': '\\\\rbrack',\r\n    ':': '\\\\colon', // Also :\r\n    \r\n    '\\u00a0': '~', // Also \\space\r\n    '\\u00ac': '\\\\neg',  // Also \\lnot\r\n\r\n    '\\u00b7': '\\\\cdot',\r\n    '\\u00bc': '\\\\frac{1}{4}',\r\n    '\\u00bd': '\\\\frac{1}{2}',\r\n    '\\u00be': '\\\\frac{3}{4}',\r\n    '\\u2070': '^{0}',\r\n    '\\u2071': '^{i}', // eslint-disable-line\r\n    '\\u00b9': '^{1}',\r\n    '\\u00b2': '^{2}',\r\n    '\\u00b3': '^{3}',\r\n\r\n    '\\u2020': '\\\\dagger', // Also \\dag\r\n    '\\u2021': '\\\\ddagger', // Also \\ddag\r\n    '\\u2026': '\\\\ldots',    // Also \\mathellipsis\r\n\r\n    '\\u2074': '^{4}',\r\n    '\\u2075': '^{5}',\r\n    '\\u2076': '^{6}',\r\n    '\\u2077': '^{7}',\r\n    '\\u2078': '^{8}',\r\n    '\\u2079': '^{9}',\r\n    '\\u207a': '^{+}',\r\n    '\\u207b': '^{-}',\r\n    '\\u207c': '^{=}',\r\n    '\\u207f': '^{n}', // eslint-disable-line\r\n    '\\u2080': '_{0}',\r\n    '\\u2081': '_{1}',\r\n    '\\u2082': '_{2}',\r\n    '\\u2083': '_{3}',\r\n    '\\u2084': '_{4}',\r\n    '\\u2085': '_{5}',\r\n    '\\u2086': '_{6}',\r\n    '\\u2087': '_{7}',\r\n    '\\u2088': '_{8}',\r\n    '\\u2089': '_{9}',\r\n    '\\u208a': '_{+}',\r\n    '\\u208b': '_{-}',\r\n    '\\u208c': '_{=}',\r\n    '\\u2090': '_{a}',// eslint-disable-line\r\n    '\\u2091': '_{e}',// eslint-disable-line\r\n    '\\u2092': '_{o}',// eslint-disable-line\r\n    '\\u2093': '_{x}',// eslint-disable-line\r\n\r\n    '\\u2032': '\\\\prime',\r\n    '\\'': '\\\\prime',\r\n\r\n    '\\u2190': '\\\\gets', // Also \\leftarrow\r\n    '\\u2192': '\\\\to',   // Also \\rightarrow\r\n\r\n    '\\u25b3': '\\\\triangle', // Also \\bigtriangleup, \\vartriangle\r\n    '\\u25bd': '\\\\triangledown',\r\n\r\n    '\\u220b': '\\\\owns', // Also \\ni\r\n    '\\u2217': '\\\\ast',  // Also *\r\n    '\\u2223': '\\\\vert',  // Also |, \\mvert, \\lvert, \\rvert\r\n    '\\u2225': '\\\\Vert',  // Also \\parallel \\shortparallel\r\n\r\n    '\\u2227': '\\\\land', // Also \\wedge\r\n    '\\u2228': '\\\\lor', // Also \\vee\r\n\r\n    '\\u22c5': '\\\\cdot', // Also \\centerdot, \\cdotp\r\n    '\\u22c8': '\\\\bowtie', // Also \\Joint\r\n\r\n    '\\u2260': '\\\\ne',   // Also \\neq\r\n    '\\u2264': '\\\\le',   // Also \\leq\r\n    '\\u2265': '\\\\ge',   // Also \\geq\r\n    '\\u22a5': '\\\\bot', // Also \\perp\r\n\r\n    '\\u27f7': '\\\\biconditional',    // Also longleftrightarrow\r\n    '\\u27f8': '\\\\impliedby', // Also \\Longleftarrow\r\n    '\\u27f9': '\\\\implies', // Also \\Longrightarrow\r\n\r\n    '\\u2102': '\\\\C',    // Also \\doubleStruckCapitalC\r\n    '\\u2115': '\\\\N',    // Also \\doubleStruckCapitalN\r\n    '\\u2119': '\\\\P',    // Also \\doubleStruckCapitalP\r\n    '\\u211a': '\\\\Q',    // Also \\doubleStruckCapitalQ\r\n    '\\u211d': '\\\\R',    // Also \\doubleStruckCapitalR\r\n    '\\u2124': '\\\\Z',    // Also \\doubleStruckCapitalZ\r\n};\r\nexport const FUNCTIONS: { [name: string]: FunctionDefinition } = {};\r\n\r\nexport const ENVIRONMENTS: { [name: string]: EnvironmentDefinition } = {};\r\n\r\ntype EnvironmentConstructor = (\r\n    name: string,\r\n    array: Atom[][][],\r\n    rowGaps: number[],\r\n    args: (string | number | BBoxParam | Colspec[] | Atom[])[]\r\n) => Atom;\r\n\r\nexport const MACROS: MacroDictionary = {\r\n    iff: '\\\\;\\u27fa\\\\;', //>2,000 Note: additional spaces around the arrows\r\n    nicefrac: '^{#1}\\\\!\\\\!/\\\\!_{#2}',\r\n\r\n    // From bracket.sty, Dirac notation\r\n    bra: '\\\\mathinner{\\\\langle{#1}|}',\r\n    ket: '\\\\mathinner{|{#1}\\\\rangle}',\r\n    braket: '\\\\mathinner{\\\\langle{#1}\\\\rangle}',\r\n    set: '\\\\mathinner{\\\\lbrace #1 \\\\rbrace}',\r\n    Bra: '\\\\left\\\\langle #1\\\\right|',\r\n    Ket: '\\\\left|#1\\\\right\\\\rangle',\r\n    Braket: '\\\\left\\\\langle{#1}\\\\right\\\\rangle',\r\n    Set: '\\\\left\\\\lbrace #1 \\\\right\\\\rbrace',\r\n\r\n    // Proof Wiki\r\n    rd: '\\\\mathrm{d}',\r\n    rD: '\\\\mathrm{D}',\r\n\r\n    // From Wolfram Alpha\r\n    doubleStruckCapitalN: '\\\\mathbb{N}',\r\n    doubleStruckCapitalR: '\\\\mathbb{R}',\r\n    doubleStruckCapitalQ: '\\\\mathbb{Q}',\r\n    doubleStruckCapitalZ: '\\\\mathbb{Z}',\r\n    doubleStruckCapitalP: '\\\\mathbb{P}',\r\n\r\n    scriptCapitalE: '\\\\mathscr{E}',\r\n    scriptCapitalH: '\\\\mathscr{H}',\r\n    scriptCapitalL: '\\\\mathscr{L}',\r\n    gothicCapitalC: '\\\\mathfrak{C}',\r\n    gothicCapitalH: '\\\\mathfrak{H}',\r\n    gothicCapitalI: '\\\\mathfrak{I}',\r\n    gothicCapitalR: '\\\\mathfrak{R}',\r\n\r\n    imaginaryI: '\\\\mathrm{i}', // NOTE: set in main (upright) as per ISO 80000-2:2009.\r\n    imaginaryJ: '\\\\mathrm{j}', // NOTE: set in main (upright) as per ISO 80000-2:2009.\r\n\r\n    exponentialE: '\\\\mathrm{e}', // NOTE: set in main (upright) as per ISO 80000-2:2009.\r\n    differentialD: '\\\\mathrm{d}', // NOTE: set in main (upright) as per ISO 80000-2:2009.\r\n    capitalDifferentialD: '\\\\mathrm{D}', // NOTE: set in main (upright) as per ISO 80000-2:2009.\r\n};\r\n\r\n// Body-text symbols\r\n// See http://ctan.mirrors.hoobly.com/info/symbols/comprehensive/symbols-a4.pdf, p14\r\n\r\nexport const TEXT_SYMBOLS = {\r\n    ' ': ' ',\r\n    '\\\\#': '\\u0023',\r\n    '\\\\&': '\\u0026',\r\n    '\\\\$': '$',\r\n    '\\\\%': '%',\r\n    '\\\\_': '_',\r\n    '\\\\euro': '\\u20AC',\r\n    '\\\\maltese': '\\u2720',\r\n    '\\\\{': '{',\r\n    '\\\\}': '}',\r\n    '\\\\nobreakspace': '\\u00A0',\r\n    '\\\\ldots': '\\u2026',\r\n    '\\\\textellipsis': '\\u2026',\r\n    '\\\\backslash': '\\\\',\r\n    '`': '\\u2018',\r\n    \"'\": '\\u2019',\r\n    '``': '\\u201c',\r\n    \"''\": '\\u201d',\r\n    '\\\\degree': '\\u00b0',\r\n    '\\\\textasciicircum': '^',\r\n    '\\\\textasciitilde': '~',\r\n    '\\\\textasteriskcentered': '*',\r\n    '\\\\textbackslash': '\\\\',\r\n    '\\\\textbraceleft': '{',\r\n    '\\\\textbraceright': '}',\r\n    '\\\\textbullet': '',\r\n    '\\\\textdollar': '$',\r\n    '\\\\textsterling': '',\r\n    '\\\\textdagger': '\\u2020',\r\n    '\\\\textdaggerdbl': '\\u2021',\r\n\r\n    '': '\\u2013', // EN DASH\r\n    '': '\\u2014', // EM DASH\r\n    '': '\\u2018', // LEFT SINGLE QUOTATION MARK\r\n    '': '\\u2019', // RIGHT SINGLE QUOTATION MARK\r\n    '': '\\u201C', // LEFT DOUBLE QUOTATION MARK\r\n    '': '\\u201D', // RIGHT DOUBLE QUOTATION MARK\r\n    '\"': '\\u201D', // DOUBLE PRIME\r\n    '\\\\ss': '\\u00df', // LATIN SMALL LETTER SHARP S\r\n    '\\\\ae': '\\u00E6', // LATIN SMALL LETTER AE\r\n    '\\\\oe': '\\u0153', // LATIN SMALL LIGATURE OE\r\n    '\\\\AE': '\\u00c6', // LATIN CAPITAL LETTER AE\r\n    '\\\\OE': '\\u0152', // LATIN CAPITAL LIGATURE OE\r\n    '\\\\O': '\\u00d8', // LATIN CAPITAL LETTER O WITH STROKE\r\n    '\\\\i': '\\u0131', // LATIN SMALL LETTER DOTLESS I\r\n    '\\\\j': '\\u0237', // LATIN SMALL LETTER DOTLESS J\r\n    '\\\\aa': '\\u00e5', // LATIN SMALL LETTER A WITH RING ABOVE\r\n    '\\\\AA': '\\u00c5', // LATIN CAPITAL LETTER A WITH RING ABOVE\r\n};\r\n\r\nexport const COMMAND_MODE_CHARACTERS = /[a-zA-Z0-9!@*()-=+{}[\\]\\\\';:?/.,~<>`|'$%#&^_\" ]/;\r\n\r\n// Word boundaries for Cyrillic, Polish, French, German, Italian\r\n// and Spanish. We use \\p{L} (Unicode property escapes: \"Letter\")\r\n// but Firefox doesn't support it\r\n// (https://bugzilla.mozilla.org/show_bug.cgi?id=1361876). Booo...\r\n// See also https://stackoverflow.com/questions/26133593/using-regex-to-match-international-unicode-alphanumeric-characters-in-javascript\r\nexport const LETTER =\r\n    typeof navigator !== 'undefined' &&\r\n    /firefox|edge|Trident/i.test(navigator.userAgent)\r\n        ? /[a-zA-Z]/\r\n        : new RegExp('\\\\p{Letter}', 'u');\r\n\r\nexport const LETTER_AND_DIGITS =\r\n    typeof navigator !== 'undefined' &&\r\n    /firefox|edge|Trident/i.test(navigator.userAgent)\r\n        ? /[0-9a-zA-Z]/\r\n        : new RegExp('[0-9\\\\p{Letter}]', 'u');\r\n\r\n/**\r\n * @param symbol    The LaTeX command for this symbol, for\r\n * example `\\alpha` or `+`\r\n */\r\nexport function defineSymbol(\r\n    symbol: string,\r\n    value: string,\r\n    type: AtomType = 'mord',\r\n    variant?: Variant\r\n): void {\r\n    MATH_SYMBOLS[symbol] = {\r\n        type,\r\n        variant,\r\n        value,\r\n    };\r\n    if (!REVERSE_MATH_SYMBOLS[value] && !variant) {\r\n        REVERSE_MATH_SYMBOLS[value] = symbol;\r\n    }\r\n    // We accept all math symbols in text mode as well\r\n    // which is a bit more permissive than TeX\r\n    TEXT_SYMBOLS[symbol] = value;\r\n}\r\n\r\n/**\r\n * Define a set of single-character symbols as 'mord' symbols.\r\n * @param string a string of single character symbols\r\n */\r\nexport function defineSymbols(string: string): void {\r\n    for (let i = 0; i < string.length; i++) {\r\n        const ch = string.charAt(i);\r\n        defineSymbol(ch, ch);\r\n    }\r\n}\r\n\r\n/**\r\n * Define a set of single-character symbols as a range of Unicode codepoints\r\n * @param from First Unicode codepoint\r\n * @param to Last Unicode codepoint\r\n */\r\nexport function defineSymbolRange(from: number, to: number): void {\r\n    for (let i = from; i <= to; i++) {\r\n        const ch = String.fromCodePoint(i);\r\n        defineSymbol(ch, ch);\r\n    }\r\n}\r\n\r\n/**\r\n * Given a character, return a LaTeX expression matching its Unicode codepoint.\r\n * If there is a matching symbol (e.g. \\alpha) it is returned.\r\n */\r\nexport function charToLatex(parseMode: ArgumentType, s: string): string {\r\n    if (parseMode === 'math') {\r\n        return REVERSE_MATH_SYMBOLS[s] || s;\r\n    }\r\n    if (parseMode === 'text') {\r\n        let textSymbol = Object.keys(TEXT_SYMBOLS).find(\r\n            (x) => TEXT_SYMBOLS[x] === s\r\n        );\r\n        if (!textSymbol) {\r\n            const hex = s.codePointAt(0).toString(16);\r\n            textSymbol = '^'.repeat(hex.length) + hex;\r\n        }\r\n        return textSymbol;\r\n    }\r\n    return s;\r\n}\r\n\r\n/* Some symbols in the MATHEMATICAL ALPHANUMERICAL SYMBOLS block had\r\n   been previously defined in other blocks. Remap them */\r\nconst MATH_LETTER_EXCEPTIONS = {\r\n    0x1d455: 0x0210e,\r\n    0x1d49d: 0x0212c,\r\n    0x1d4a0: 0x02130,\r\n    0x1d4a1: 0x02131,\r\n    0x1d4a3: 0x0210b,\r\n    0x1d4a4: 0x02110,\r\n    0x1d4a7: 0x02112,\r\n    0x1d4a8: 0x02133,\r\n    0x1d4ad: 0x0211b,\r\n    0x1d4ba: 0x0212f,\r\n    0x1d4bc: 0x0210a,\r\n    0x1d4c4: 0x02134,\r\n    0x1d506: 0x0212d,\r\n    0x1d50b: 0x0210c,\r\n    0x1d50c: 0x02111,\r\n    0x1d515: 0x0211c,\r\n    0x1d51d: 0x02128,\r\n    0x1d53a: 0x02102,\r\n    0x1d53f: 0x0210d,\r\n    0x1d545: 0x02115,\r\n    0x1d547: 0x02119,\r\n    0x1d548: 0x0211a,\r\n    0x1d549: 0x0211d,\r\n    0x1d551: 0x02124,\r\n};\r\n\r\nconst MATH_UNICODE_BLOCKS = [\r\n    { start: 0x1d400, len: 26, offset: 65, style: 'bold' },\r\n    { start: 0x1d41a, len: 26, offset: 97, style: 'bold' },\r\n    { start: 0x1d434, len: 26, offset: 65, style: 'italic' },\r\n    { start: 0x1d44e, len: 26, offset: 97, style: 'italic' },\r\n    { start: 0x1d468, len: 26, offset: 65, style: 'bolditalic' },\r\n    { start: 0x1d482, len: 26, offset: 97, style: 'bolditalic' },\r\n\r\n    { start: 0x1d49c, len: 26, offset: 65, variant: 'script' },\r\n    { start: 0x1d4b6, len: 26, offset: 97, variant: 'script' },\r\n    { start: 0x1d4d0, len: 26, offset: 65, variant: 'script', style: 'bold' },\r\n    { start: 0x1d4ea, len: 26, offset: 97, variant: 'script', style: 'bold' },\r\n\r\n    { start: 0x1d504, len: 26, offset: 65, variant: 'fraktur' },\r\n    { start: 0x1d51e, len: 26, offset: 97, variant: 'fraktur' },\r\n    { start: 0x1d56c, len: 26, offset: 65, variant: 'fraktur', style: 'bold' },\r\n    { start: 0x1d586, len: 26, offset: 97, variant: 'fraktur', style: 'bold' },\r\n\r\n    { start: 0x1d538, len: 26, offset: 65, variant: 'double-struck' },\r\n    { start: 0x1d552, len: 26, offset: 97, variant: 'double-struck' },\r\n\r\n    { start: 0x1d5a0, len: 26, offset: 65, variant: 'sans-serif' },\r\n    { start: 0x1d5ba, len: 26, offset: 97, variant: 'sans-serif' },\r\n    {\r\n        start: 0x1d5d4,\r\n        len: 26,\r\n        offset: 65,\r\n        variant: 'sans-serif',\r\n        style: 'bold',\r\n    },\r\n    {\r\n        start: 0x1d5ee,\r\n        len: 26,\r\n        offset: 97,\r\n        variant: 'sans-serif',\r\n        style: 'bold',\r\n    },\r\n    {\r\n        start: 0x1d608,\r\n        len: 26,\r\n        offset: 65,\r\n        variant: 'sans-serif',\r\n        style: 'italic',\r\n    },\r\n    {\r\n        start: 0x1d622,\r\n        len: 26,\r\n        offset: 97,\r\n        variant: 'sans-serif',\r\n        style: 'italic',\r\n    },\r\n    {\r\n        start: 0x1d63c,\r\n        len: 26,\r\n        offset: 65,\r\n        variant: 'sans-serif',\r\n        style: 'bolditalic',\r\n    },\r\n    {\r\n        start: 0x1d656,\r\n        len: 26,\r\n        offset: 97,\r\n        variant: 'sans-serif',\r\n        style: 'bolditalic',\r\n    },\r\n\r\n    { start: 0x1d670, len: 26, offset: 65, variant: 'monospace' },\r\n    { start: 0x1d68a, len: 26, offset: 97, variant: 'monospace' },\r\n\r\n    { start: 0x1d6a8, len: 25, offset: 0x391, style: 'bold' },\r\n    { start: 0x1d6c2, len: 25, offset: 0x3b1, style: 'bold' },\r\n    { start: 0x1d6e2, len: 25, offset: 0x391, style: 'italic' },\r\n    { start: 0x1d6fc, len: 25, offset: 0x3b1, style: 'italic' },\r\n    { start: 0x1d71c, len: 25, offset: 0x391, style: 'bolditalic' },\r\n    { start: 0x1d736, len: 25, offset: 0x3b1, style: 'bolditalic' },\r\n    {\r\n        start: 0x1d756,\r\n        len: 25,\r\n        offset: 0x391,\r\n        variant: 'sans-serif',\r\n        style: 'bold',\r\n    },\r\n    {\r\n        start: 0x1d770,\r\n        len: 25,\r\n        offset: 0x3b1,\r\n        variant: 'sans-serif',\r\n        style: 'bold',\r\n    },\r\n    {\r\n        start: 0x1d790,\r\n        len: 25,\r\n        offset: 0x391,\r\n        variant: 'sans-serif',\r\n        style: 'bolditalic',\r\n    },\r\n    {\r\n        start: 0x1d7aa,\r\n        len: 25,\r\n        offset: 0x3b1,\r\n        variant: 'sans-serif',\r\n        style: 'bolditalic',\r\n    },\r\n\r\n    { start: 0x1d7ce, len: 10, offset: 48, variant: '', style: 'bold' },\r\n    { start: 0x1d7d8, len: 10, offset: 48, variant: 'double-struck' },\r\n    { start: 0x1d7e3, len: 10, offset: 48, variant: 'sans-serif' },\r\n    {\r\n        start: 0x1d7ec,\r\n        len: 10,\r\n        offset: 48,\r\n        variant: 'sans-serif',\r\n        style: 'bold',\r\n    },\r\n    { start: 0x1d7f6, len: 10, offset: 48, variant: 'monospace' },\r\n];\r\n\r\nfunction unicodeToMathVariant(\r\n    codepoint: number\r\n): { char: string; variant?: string; style?: string } {\r\n    if (\r\n        (codepoint < 0x1d400 || codepoint > 0x1d7ff) &&\r\n        (codepoint < 0x2100 || codepoint > 0x214f)\r\n    ) {\r\n        return { char: String.fromCodePoint(codepoint) };\r\n    }\r\n\r\n    // Handle the 'gap' letters by converting them back into their logical range\r\n    for (const c in MATH_LETTER_EXCEPTIONS) {\r\n        if (Object.prototype.hasOwnProperty.call(MATH_LETTER_EXCEPTIONS, c)) {\r\n            if (MATH_LETTER_EXCEPTIONS[c] === codepoint) {\r\n                codepoint = c.codePointAt(0) ?? 0;\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    for (let i = 0; i < MATH_UNICODE_BLOCKS.length; i++) {\r\n        if (\r\n            codepoint >= MATH_UNICODE_BLOCKS[i].start &&\r\n            codepoint <\r\n                MATH_UNICODE_BLOCKS[i].start + MATH_UNICODE_BLOCKS[i].len\r\n        ) {\r\n            return {\r\n                char: String.fromCodePoint(\r\n                    codepoint -\r\n                        MATH_UNICODE_BLOCKS[i].start +\r\n                        MATH_UNICODE_BLOCKS[i].offset\r\n                ),\r\n                variant: MATH_UNICODE_BLOCKS[i].variant,\r\n                style: MATH_UNICODE_BLOCKS[i].style,\r\n            };\r\n        }\r\n    }\r\n\r\n    return { char: String.fromCodePoint(codepoint) };\r\n}\r\n\r\n/**\r\n * Given a character and variant ('double-struck', 'fraktur', etc...)\r\n * return the corresponding unicode character (a string)\r\n */\r\nexport function mathVariantToUnicode(\r\n    char: string,\r\n    variant: string,\r\n    style: string\r\n): string {\r\n    if (!/[A-Za-z0-9]/.test(char)) return char;\r\n    if (!variant && !style) return char;\r\n\r\n    const codepoint = char.codePointAt(0);\r\n\r\n    for (let i = 0; i < MATH_UNICODE_BLOCKS.length; i++) {\r\n        if (!variant || MATH_UNICODE_BLOCKS[i].variant === variant) {\r\n            if (!style || MATH_UNICODE_BLOCKS[i].style === style) {\r\n                if (\r\n                    codepoint >= MATH_UNICODE_BLOCKS[i].offset &&\r\n                    codepoint <\r\n                        MATH_UNICODE_BLOCKS[i].offset +\r\n                            MATH_UNICODE_BLOCKS[i].len\r\n                ) {\r\n                    const result =\r\n                        MATH_UNICODE_BLOCKS[i].start +\r\n                        codepoint -\r\n                        MATH_UNICODE_BLOCKS[i].offset;\r\n                    return String.fromCodePoint(\r\n                        MATH_LETTER_EXCEPTIONS[result] || result\r\n                    );\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    return char;\r\n}\r\n\r\nexport function unicodeCharToLatex(\r\n    parseMode: ArgumentType,\r\n    char: string\r\n): string {\r\n    if (parseMode === 'text') {\r\n        return charToLatex(parseMode, char) || char;\r\n    }\r\n\r\n    let result: string;\r\n    // Codepoint shortcuts have priority over variants\r\n    // That is, \"\\N\" vs \"\\mathbb{N}\"\r\n    // if (CODEPOINT_SHORTCUTS[cp]) return CODEPOINT_SHORTCUTS[cp];\r\n    result = charToLatex(parseMode, char);\r\n    if (result) return result;\r\n\r\n    const cp = char.codePointAt(0);\r\n    const v = unicodeToMathVariant(cp);\r\n    if (!v.style && !v.variant) return '';\r\n\r\n    result = v.char;\r\n    if (v.variant) {\r\n        result = '\\\\' + v.variant + '{' + result + '}';\r\n    }\r\n    if (v.style === 'bold') {\r\n        result = '\\\\mathbf{' + result + '}';\r\n    } else if (v.style === 'italic') {\r\n        result = '\\\\mathit{' + result + '}';\r\n    } else if (v.style === 'bolditalic') {\r\n        result = '\\\\mathbfit{' + result + '}';\r\n    }\r\n    return '\\\\mathord{' + result + '}';\r\n}\r\n\r\nexport function unicodeStringToLatex(\r\n    parseMode: ArgumentType,\r\n    s: string\r\n): string {\r\n    let result = '';\r\n    let needSpace = false;\r\n    for (const c of s) {\r\n        if (needSpace) {\r\n            if (parseMode === 'text') {\r\n                result += '{}';\r\n            } else {\r\n                result += ' ';\r\n            }\r\n        }\r\n        needSpace = false;\r\n        const latex = unicodeCharToLatex(parseMode, c);\r\n        if (latex) {\r\n            result += latex;\r\n            needSpace = /\\\\[a-zA-Z0-9]+\\*?$/.test(latex);\r\n        } else {\r\n            result += c;\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\n/**\r\n * Gets the value of a symbol in math mode\r\n */\r\n// export function getSymbolValue(symbol: string): string {\r\n//     return MATH_SYMBOLS[symbol]?.value ?? symbol;\r\n// }\r\n\r\nexport function getEnvironmentDefinition(name: string): EnvironmentDefinition {\r\n    return ENVIRONMENTS[name] ?? null;\r\n}\r\n\r\n/**\r\n * @param symbol    A command (e.g. '\\alpha') or a character (e.g. 'a')\r\n * @param parseMode One of 'math' or 'text'\r\n * @param macros A macros dictionary\r\n * @return {object} An info structure about the symbol, or null\r\n */\r\nexport function getInfo(\r\n    symbol: string,\r\n    parseMode: ArgumentType,\r\n    macros?: MacroDictionary\r\n): FunctionDefinition & SymbolDefinition {\r\n    if (!symbol || symbol.length === 0) return null;\r\n\r\n    let info = null;\r\n\r\n    if (symbol.charAt(0) === '\\\\') {\r\n        // This could be a function or a symbol\r\n        info = FUNCTIONS[symbol];\r\n        if (info) {\r\n            // We've got a match\r\n            return info;\r\n        }\r\n\r\n        // It wasn't a function, maybe it's a symbol?\r\n        if (parseMode === 'math') {\r\n            info = MATH_SYMBOLS[symbol];\r\n        } else if (TEXT_SYMBOLS[symbol]) {\r\n            info = { value: TEXT_SYMBOLS[symbol] };\r\n        }\r\n\r\n        if (!info) {\r\n            // Maybe it's a macro\r\n            const command = symbol.slice(1);\r\n            if (macros?.[command]) {\r\n                let def = macros[command];\r\n                if (typeof def === 'object') {\r\n                    def = def.def;\r\n                }\r\n                let argCount = 0;\r\n                // Let's see if there are arguments in the definition.\r\n                if (/(^|[^\\\\])#1/.test(def)) argCount = 1;\r\n                if (/(^|[^\\\\])#2/.test(def)) argCount = 2;\r\n                if (/(^|[^\\\\])#3/.test(def)) argCount = 3;\r\n                if (/(^|[^\\\\])#4/.test(def)) argCount = 4;\r\n                if (/(^|[^\\\\])#5/.test(def)) argCount = 5;\r\n                if (/(^|[^\\\\])#6/.test(def)) argCount = 6;\r\n                if (/(^|[^\\\\])#7/.test(def)) argCount = 7;\r\n                if (/(^|[^\\\\])#8/.test(def)) argCount = 8;\r\n                if (/(^|[^\\\\])#9/.test(def)) argCount = 9;\r\n                info = {\r\n                    type: 'group',\r\n                    mode: 'math',\r\n                    params: [],\r\n                    infix: false,\r\n                };\r\n                while (argCount >= 1) {\r\n                    info.params.push({\r\n                        isOptional: false,\r\n                        type: 'math',\r\n                    });\r\n                    argCount -= 1;\r\n                }\r\n            }\r\n        }\r\n    } else {\r\n        if (parseMode === 'math') {\r\n            info = MATH_SYMBOLS[symbol];\r\n        } else if (TEXT_SYMBOLS[symbol]) {\r\n            info = { value: TEXT_SYMBOLS[symbol] };\r\n        } else if (parseMode === 'text') {\r\n            info = { value: symbol };\r\n        }\r\n    }\r\n\r\n    // Special case `f`, `g` and `h` are recognized as functions.\r\n    if (\r\n        info &&\r\n        info.type === 'mord' &&\r\n        (info.value === 'f' || info.value === 'g' || info.value === 'h')\r\n    ) {\r\n        info.isFunction = true;\r\n    }\r\n\r\n    return info;\r\n}\r\n\r\n/**\r\n * Return an array of suggestion for completing string 's'.\r\n * For example, for 'si', it could return ['sin', 'sinh', 'sim', 'simeq', 'sigma']\r\n * Infix operators are excluded, since they are deprecated commands.\r\n */\r\nexport function suggest(s: string): { match: string; frequency: number }[] {\r\n    if (s.length <= 1) return [];\r\n    const result = [];\r\n\r\n    // Iterate over items in the dictionary\r\n    for (const p in FUNCTIONS) {\r\n        if (Object.prototype.hasOwnProperty.call(FUNCTIONS, p)) {\r\n            if (p.startsWith(s) && !FUNCTIONS[p].infix) {\r\n                result.push({ match: p, frequency: FUNCTIONS[p].frequency });\r\n            }\r\n        }\r\n    }\r\n\r\n    for (const p in MATH_SYMBOLS) {\r\n        if (Object.prototype.hasOwnProperty.call(MATH_SYMBOLS, p)) {\r\n            if (p.startsWith(s)) {\r\n                result.push({ match: p, frequency: MATH_SYMBOLS[p].frequency });\r\n            }\r\n        }\r\n    }\r\n\r\n    result.sort((a, b) => {\r\n        if (a.frequency === b.frequency) {\r\n            return a.match.length - b.match.length;\r\n        }\r\n        return (b.frequency || 0) - (a.frequency || 0);\r\n    });\r\n\r\n    return result;\r\n}\r\n\r\n/**\r\n * An argument template has the following syntax:\r\n *\r\n * <placeholder>:<type>\r\n *\r\n * where\r\n * - <placeholder> is a string whose value is displayed when the argument\r\n *   is missing\r\n * - <type> is one of 'string', 'color', 'dimen', 'auto', 'text', 'math'\r\n *\r\n */\r\nfunction parseParamTemplateArgument(argTemplate: string): ArgumentType {\r\n    let type: ArgumentType = 'auto';\r\n\r\n    // Parse the type (:type)\r\n    const r = argTemplate.match(/:([^=]+)/);\r\n    if (r) type = r[1].trim() as ArgumentType;\r\n\r\n    return type;\r\n}\r\n\r\nfunction parseParamTemplate(\r\n    paramTemplate: string\r\n): FunctionArgumentDefiniton[] {\r\n    if (!paramTemplate) return [];\r\n\r\n    let result = [];\r\n    let params = paramTemplate.split(']');\r\n    if (params[0].charAt(0) === '[') {\r\n        // We found at least one optional parameter.\r\n        result.push({\r\n            isOptional: true,\r\n            type: parseParamTemplateArgument(params[0].slice(1)),\r\n        });\r\n        // Parse the rest\r\n        for (let i = 1; i <= params.length; i++) {\r\n            result = result.concat(parseParamTemplate(params[i]));\r\n        }\r\n    } else {\r\n        params = paramTemplate.split('}');\r\n        if (params[0].charAt(0) === '{') {\r\n            // We found a required parameter\r\n            result.push({\r\n                isOptional: false,\r\n                type: parseParamTemplateArgument(params[0].slice(1)),\r\n            });\r\n            // Parse the rest\r\n            for (let i = 1; i <= params.length; i++) {\r\n                result = result.concat(parseParamTemplate(params[i]));\r\n            }\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n/**\r\n * If possible, i.e. if they are all simple atoms, return a string made up of\r\n * their body\r\n */\r\nexport function parseArgAsString(atoms: Atom[]): string {\r\n    if (!atoms) return '';\r\n    let result = '';\r\n    let success = true;\r\n    atoms.forEach((atom) => {\r\n        if (typeof atom.value === 'string') {\r\n            result += atom.value;\r\n        } else {\r\n            success = false;\r\n        }\r\n    });\r\n    return success ? result : '';\r\n}\r\n\r\n/**\r\n * Define one or more environments to be used with\r\n *         \\begin{<env-name>}...\\end{<env-name>}.\r\n *\r\n * @param params The number and type of required and optional parameters.\r\n */\r\nexport function defineEnvironment(\r\n    names: string | string[],\r\n    params: string,\r\n    parser: EnvironmentConstructor,\r\n    isTabular = false\r\n): void {\r\n    if (typeof names === 'string') {\r\n        names = [names];\r\n    }\r\n    const parsedParams = parseParamTemplate(params);\r\n\r\n    // Set default values of functions\r\n    const data: EnvironmentDefinition = {\r\n        tabular: isTabular,\r\n        // Params: the parameters for this function, an array of\r\n        // {optional, type}\r\n        params: parsedParams,\r\n\r\n        // Callback to create an atom\r\n        createAtom: parser,\r\n    };\r\n    for (const name of names) {\r\n        ENVIRONMENTS[name] = data;\r\n    }\r\n}\r\n\r\n/**\r\n * Like defineEnvironment, but for a tabular environment, i.e.\r\n * one whose content is in tabular mode, where '&' indicata a new column\r\n * and '\\\\' indicate a new row.\r\n */\r\nexport function defineTabularEnvironment(\r\n    names: string | string[],\r\n    params: string,\r\n    parser: EnvironmentConstructor\r\n): void {\r\n    defineEnvironment(names, params, parser, true);\r\n}\r\n\r\n/**\r\n * Define one of more functions.\r\n *\r\n * @param names\r\n * @param params The number and type of required and optional parameters.\r\n * For example: '{}' defines a single mandatory parameter\r\n * '[string]{auto}' defines two params, one optional, one required\r\n */\r\nexport function defineFunction(\r\n    names: string | string[],\r\n    params: string,\r\n    options: {\r\n        ifMode?: ParseMode;\r\n        applyMode?: ParseMode;\r\n        infix?: boolean;\r\n        isFunction?: boolean;\r\n        createAtom?: (name: string, args: Argument[], style: Style) => Atom;\r\n        applyStyle?: (name: string, args: Argument[]) => Style;\r\n    }\r\n): void {\r\n    if (typeof names === 'string') {\r\n        names = [names];\r\n    }\r\n\r\n    if (!options) options = {};\r\n\r\n    // Set default values of functions\r\n    const data: FunctionDefinition = {\r\n        // The parameters for this function, an array of\r\n        // {optional, type}\r\n        params: parseParamTemplate(params),\r\n\r\n        ifMode: options.ifMode,\r\n        isFunction: options.isFunction ?? false,\r\n        applyMode: options.applyMode,\r\n        infix: options.infix ?? false,\r\n        createAtom: options.createAtom,\r\n        applyStyle: options.applyStyle,\r\n    };\r\n    names.forEach((name) => {\r\n        FUNCTIONS['\\\\' + name] = data;\r\n    });\r\n}\r\n","import { isArray } from '../common/types';\n\nimport { Context, ContextInterface } from './context';\nimport { Style, ParseMode } from '../public/core';\nimport { MATHSTYLES } from './mathstyle';\nimport { METRICS as FONTMETRICS } from './font-metrics';\nimport {\n    makeSpan,\n    makeVlist,\n    depth as spanDepth,\n    height as spanHeight,\n    italic as spanItalic,\n    SpanType,\n    isSpanType,\n    Span,\n} from './span';\nimport { joinLatex } from './tokenizer';\nimport { emitLatexRun, getModeRuns, getPropertyRuns } from './modes-utils';\nimport { charToLatex } from '../core-definitions/definitions-utils';\n\nexport const ATOM_REGISTRY = {};\n\nexport type BranchName =\n    | 'above'\n    | 'body'\n    | 'below'\n    | 'superscript'\n    | 'subscript';\nexport type Branch = BranchName | [row: number, col: number];\n/**\n * The order of these branches specify the keyboard navigation order\n */\nexport const NAMED_BRANCHES: BranchName[] = [\n    'above',\n    'body',\n    'below',\n    'superscript',\n    'subscript',\n];\n\n/**\n * A \"branch\" is a set of children of an atom.\n * There are two kind of branches:\n * - **colRow** branches are used with array type of atoms. They are addressed\n * with a column and row number\n * - **named branches** used with other kind of atom. There is a fixed set of\n * possible named branches.\n */\nexport function isNamedBranch(branch: Branch): branch is BranchName {\n    return typeof branch === 'string' && NAMED_BRANCHES.includes(branch);\n}\n\nfunction isColRowBranch(branch: Branch): branch is [number, number] {\n    return Array.isArray(branch) && branch.length === 2;\n}\n\nexport type Branches = {\n    [branch in BranchName]?: Atom[];\n};\n\nexport type ToLatexOptions = {\n    expandMacro?: boolean;\n};\n\nexport type AtomType =\n    | ''\n    | 'accent'\n    | 'array' // a group, which has children arranged in rows. Used\n    // by environments such as `matrix`, `cases`, etc...\n    | 'box' // a border drawn around an expression and change its background color\n    | 'chem' // a chemical formula (mhchem)\n    | 'command' // command` indicate a command being entered. The text is displayed in blue in the editor.\n    | 'composition' // IME composition area\n    | 'delim'\n    | 'enclose'\n    | 'error' //  an unknown command, for example `\\xyzy`. The text  is displayed with a wavy red underline in the editor.\n    | 'first' // a special, empty, atom put as the first atom in math lists in\n    // order to be able to position the caret before the first element. Aside from\n    // the caret, they display nothing.\n    | 'genfrac' // a generalized fraction: a numerator and denominator, separated\n    // by an optional line, and surrounded by optional fences\n    | 'group' // a simple group of atoms, for example from a `{...}`\n    | 'leftright' // used by the `\\left` and `\\right` commands\n    | 'line' // used by `\\overline` and `\\underline`\n    | 'macro'\n    | 'mbin' // binary operator: `+`, `*`, etc...\n    | 'mclose' // closing fence: `)`, `\\rangle`, etc...\n    | 'minner' // special layout cases, overlap, `\\left...\\right`\n    | 'mop' // `mop`: operators, including special functions, `\\sin`, `\\sum`, `\\cap`.\n    | 'mopen' // opening fence: `(`, `\\langle`, etc...\n    | 'mord' // ordinary symbol, e.g. `x`, `\\alpha`\n    | 'mpunct' // punctuation: `,`, `:`, etc...\n    | 'mrel' // relational operator: `=`, `\\ne`, etc...\n    | 'msubsup'\n    | 'none' // @revisit\n    | 'overlap' // display a symbol _over_ another\n    | 'overunder' // displays an annotation above or below a symbol\n    | 'placeholder' // a temporary item. Placeholders are displayed as a dashed square in the editor.\n    | 'phantom'\n    | 'root' // a group, which has no parent (only one per formula)\n    | 'rule' // draw a line, for the `\\rule` command\n    | 'sizeddelim' // a delimiter that can grow\n    | 'space'\n    | 'spacing'\n    | 'surd' // aka square root, nth root\n    | 'text' // text mode atom\n    | 'textord';\n\nexport type BBoxParam = {\n    backgroundcolor?: string;\n    padding?: number;\n    border?: string;\n};\n\n// A table of size -> font size for the different sizing functions\nconst SIZING_MULTIPLIER = {\n    size1: 0.5,\n    size2: 0.7,\n    size3: 0.8,\n    size4: 0.9,\n    size5: 1.0,\n    size6: 1.2,\n    size7: 1.44,\n    size8: 1.73,\n    size9: 2.07,\n    size10: 2.49,\n};\n\n/**\n * An atom is an object encapsulating an elementary mathematical unit,\n * independent of its graphical representation.\n *\n * It keeps track of the content, while the dimensions, position and style\n * are tracked by Span objects which are created by the `decompose()` functions.\n *\n * @property mode - `'display'`, `'command'`, etc...\n *\n * In addition to these basic types, which correspond to the TeX atom types,\n * some atoms represent more complex compounds, including:\n * - `space` and `spacing`: blank space between atoms\n * - `mathstyle`: to change the math style used: `display` or `text`.\n * The layout rules are different for each, the latter being more compact and\n * intended to be incorporated with surrounding non-math text.\n *\n *\n * @property captureSelection if true, this atom does not let its\n * children be selected. Used by the `\\enclose` annotations, for example.\n *\n * @property skipBoundary if true, when the caret reaches the\n * first position in this element's body, it automatically moves to the\n * outside of the element. Conversely, when the caret reaches the position\n * right after this element, it automatically moves to the last position\n * inside this element.\n */\nexport class Atom {\n    parent: Atom | null;\n    // An atom can have multiple \"branches\" of children,\n    // e.g. `body` and `superscript`\n    // The `treeBranch` property indicate which branch of the parent this\n    // atom belongs to or if in an array, the row and column\n    treeBranch: Branch | [number, number];\n\n    // Used to match a DOM element to an Atom\n    // (the corresponding DOM element has a `data-atom-id` attribute)\n    id?: string;\n\n    // If true, some structural changes have been made to the atom\n    // (insertion or removal of children) or one of its children is dirty\n    _isDirty: boolean;\n    // Cached list of children, invalidated when isDirty = true\n    _children: Atom[];\n\n    type: AtomType;\n\n    // Latex command ('\\sin') or character ('a')\n    command: string;\n    // If true, the atom is an extensible symbol (affects layout of supsub)\n    isExtensibleSymbol: boolean;\n    // If true, the atom represents a function (which can be followed by parentheses)\n    // e.g. \"f\" or \"\\sin\"\n    isFunction: boolean;\n\n    skipBoundary?: boolean;\n    captureSelection?: boolean;\n\n    isSelected: boolean;\n    // If the atom or one of its descendant includes the caret\n    // (used to highligth surd or fences to make clearer where the caret is\n    containsCaret: boolean;\n    caret: ParseMode | '';\n\n    // Verbatim Latex of the command and its arguments\n    latex?: string;\n\n    // Optional, per instance, override of the `toLatex()` method\n    toLatexOverride?: (atom: Atom, options: ToLatexOptions) => string;\n\n    // How to display \"limits\" (i.e. superscript/subscript) for example\n    // with `\\sum`:\n    // - 'limits': above and below the symbold\n    // - 'nolimits': in superscript and subscript positions (for example\n    // when in `textstyle`)\n    limits?: 'limits' | 'nolimits' | 'accent' | 'overunder' | 'auto';\n    // True if the limits were set by a command\n    explicitLimits?: boolean;\n\n    value: string;\n    private branches: Branches;\n\n    private maxFontSize?: number;\n\n    // mathstyle?:\n    //     | 'auto'\n    //     | 'displaystyle'\n    //     | 'textstyle'\n    //     | 'scriptstyle'\n    //     | 'scriptscriptstyle'; // type = 'genfrac', ''\n\n    style: Style;\n    mode: ParseMode;\n\n    // color?: string;\n    // backgroundColor?: string;\n    // variant?: Variant;\n    // variantStyle?: VariantStyle;\n    // fontFamily?: string;\n    // fontShape?: FontShape;\n    // fontSeries?: FontSeries;\n    // fontSize?: string;\n    // cssId?: string;\n    // cssClass?: string; // A single CSS class, as a style decoration\n    // letterShapeStyle?: 'tex' | 'french' | 'iso' | 'upright' | 'auto';\n\n    constructor(\n        type: AtomType,\n        options?: {\n            command?: string;\n            mode?: ParseMode;\n            value?: string;\n            isExtensibleSymbol?: boolean;\n            isFunction?: boolean;\n            limits?: 'limits' | 'nolimits' | 'accent' | 'overunder' | 'auto';\n            style?: Style;\n            toLatexOverride?: (atom: Atom, options: ToLatexOptions) => string;\n        }\n    ) {\n        this.command = options?.command;\n        this.type = type;\n        if (typeof options?.value === 'string') {\n            this.value = options.value;\n        }\n        this._isDirty = false;\n\n        this.mode = options?.mode ?? 'math';\n        this.isExtensibleSymbol = options?.isExtensibleSymbol ?? false;\n        this.isFunction = options?.isFunction ?? false;\n        this.limits = options?.limits;\n        this.style = options?.style ?? {};\n        this.toLatexOverride = options?.toLatexOverride;\n    }\n    get isDirty(): boolean {\n        return this._isDirty;\n    }\n    set isDirty(dirty: boolean) {\n        this._isDirty = dirty;\n        if (dirty) {\n            this.latex = undefined;\n            this._children = null;\n            let parent = this.parent;\n            while (parent) {\n                parent._isDirty = true;\n                parent._children = null;\n                parent.latex = undefined;\n                parent = parent.parent;\n            }\n        }\n    }\n\n    /**\n     * Return a list of spans equivalent to atoms.\n     * A span is the most elementary type possible, for example 'text'\n     * or 'vlist', while the input atoms may be more abstract and complex,\n     * such as 'genfrac'\n     *\n     * @param context Font family, variant, size, color, and other info useful\n     * to render an expression\n     * @param atoms - An array of atoms\n     */\n    static render(\n        inputContext: ContextInterface,\n        atoms: Atom[] | undefined\n    ): Span[] | null {\n        function isDigit(atom: Atom): boolean {\n            return (\n                atom.type === 'mord' &&\n                Boolean(atom.value) &&\n                /^[0-9,.]$/.test(atom.value)\n            );\n        }\n        function isText(atom: Atom): boolean {\n            return atom.mode === 'text';\n        }\n        if (!atoms) return null;\n        if (atoms.length === 0) return [];\n\n        // We can be passed either a Context object, or\n        // a ContextInterface objectl literal.\n        const context: Context =\n            inputContext instanceof Context\n                ? inputContext\n                : new Context(inputContext);\n\n        // In most cases we want to display selection,\n        // except if the `atomIdsSettings.groupNumbers` flag is set which is used for\n        // read aloud.\n        const displaySelection =\n            !context.atomIdsSettings || !context.atomIdsSettings.groupNumbers;\n\n        let result: Span[] | null = [];\n        if (atoms.length === 1) {\n            result = atoms[0].render(context);\n            if (result && displaySelection && atoms[0].isSelected) {\n                result.forEach((x: Span) => x.selected(true));\n            }\n            console.assert(!result || isArray(result));\n        } else {\n            let selection: Span[] = [];\n            let digitOrTextStringID = '';\n            let lastWasDigit = true;\n            for (let i = 0; i < atoms.length; i++) {\n                if (\n                    context.atomIdsSettings?.groupNumbers &&\n                    digitOrTextStringID &&\n                    ((lastWasDigit && isDigit(atoms[i])) ||\n                        (!lastWasDigit && isText(atoms[i])))\n                ) {\n                    context.atomIdsSettings.overrideID = digitOrTextStringID;\n                }\n                const span: Span[] = atoms[i].render(context);\n                if (context.atomIdsSettings) {\n                    context.atomIdsSettings.overrideID = null;\n                }\n                if (span) {\n                    // Flatten the spans (i.e. [[a1, a2], b1, b2] -> [a1, a2, b1, b2]\n                    const flat = [].concat(...span);\n                    context.phantomBase = flat;\n\n                    // If this is a digit or text run, keep track of it\n                    if (context.atomIdsSettings?.groupNumbers) {\n                        if (isDigit(atoms[i]) || isText(atoms[i])) {\n                            if (\n                                !digitOrTextStringID ||\n                                lastWasDigit !== isDigit(atoms[i])\n                            ) {\n                                // changed from text to digits or vice-versa\n                                lastWasDigit = isDigit(atoms[i]);\n                                digitOrTextStringID = atoms[i].id;\n                            }\n                        }\n                        if (\n                            (!(isDigit(atoms[i]) || isText(atoms[i])) ||\n                                !atoms[i].hasEmptyBranch('superscript') ||\n                                !atoms[i].hasEmptyBranch('subscript')) &&\n                            digitOrTextStringID\n                        ) {\n                            // Done with digits/text\n                            digitOrTextStringID = '';\n                        }\n                    }\n\n                    if (displaySelection && atoms[i].isSelected) {\n                        selection = selection.concat(flat);\n                        selection.forEach((x: Span) => x.selected(true));\n                    } else {\n                        if (selection.length > 0) {\n                            // There was a selection, but we're out of it now\n                            // Append the selection\n                            result = [...result, ...selection];\n                            selection = [];\n                        }\n                        result = result.concat(flat);\n                    }\n                }\n            }\n\n            // Is there a leftover selection?\n            if (selection.length > 0) {\n                result = [...result, ...selection];\n                selection = [];\n            }\n        }\n\n        if (!result || result.length === 0) return null;\n\n        // If the mathstyle changed between the parent and the current atom,\n        // account for the size difference\n        if (context.mathstyle.id !== context.parentMathstyle.id) {\n            const factor =\n                context.mathstyle.sizeMultiplier /\n                context.parentMathstyle.sizeMultiplier;\n            for (const span of result) {\n                console.assert(!isArray(span));\n                console.assert(\n                    typeof span.height === 'number' && isFinite(span.height)\n                );\n                span.height *= factor;\n                span.depth *= factor;\n            }\n        }\n        // If the size changed between the parent and the current group,\n        // account for the size difference\n        if (context.size !== context.parentSize) {\n            const factor =\n                SIZING_MULTIPLIER[context.size] /\n                SIZING_MULTIPLIER[context.parentSize];\n            for (const span of result) {\n                console.assert(!isArray(span));\n                console.assert(\n                    typeof span.height === 'number' && isFinite(span.height)\n                );\n                span.height *= factor;\n                span.depth *= factor;\n            }\n        }\n\n        return result;\n    }\n\n    /**\n     * Given an atom or an array of atoms, return a LaTeX string representation\n     */\n    static toLatex(\n        value: boolean | number | string | Atom | Atom[],\n        options: ToLatexOptions\n    ): string {\n        let result = '';\n        if (isArray(value)) {\n            if (value.length > 0) result = atomsToLatex(value, options);\n        } else if (typeof value === 'number' || typeof value === 'boolean') {\n            result = value.toString();\n        } else if (typeof value === 'string') {\n            result = value.replace(/\\s/g, '~');\n        } else if (typeof value !== 'undefined') {\n            // If we have some verbatim latex for this atom, use it.\n            // This allow non-significant punctuation to be preserved when possible.\n            if (!options.expandMacro && typeof value.latex === 'string') {\n                return value.latex;\n            }\n            if (value.toLatexOverride) {\n                return value.toLatexOverride(value, options);\n            }\n            result = value.toLatex(options);\n        }\n        return result;\n    }\n    // Default Latex emmiter.\n    // Avoid calling directly, instead call `Atom.toLatex(atom)`\n    // to correctly call per-definition emitters and use the cached verbatim\n    // latex when applicable.\n    toLatex(options: ToLatexOptions): string {\n        if (this.body && this.command) {\n            // There's a command and body\n            return joinLatex([\n                this.command,\n                '{',\n                this.bodyToLatex(options),\n                '}',\n                this.supsubToLatex(options),\n            ]);\n        }\n        if (this.body) {\n            // There's a body with no command\n            return joinLatex([\n                this.bodyToLatex(options),\n                this.supsubToLatex(options),\n            ]);\n        }\n        if (this.value && this.value !== '\\u200b') {\n            // There's probably just a value (which is a unicode character)\n            return charToLatex(this.mode, this.value) ?? this.command;\n        }\n\n        return '';\n    }\n    bodyToLatex(options: ToLatexOptions): string {\n        return Atom.toLatex(this.body, options);\n    }\n    aboveToLatex(options: ToLatexOptions): string {\n        return Atom.toLatex(this.above, options);\n    }\n    belowToLatex(options: ToLatexOptions): string {\n        return Atom.toLatex(this.below, options);\n    }\n    supsubToLatex(options: ToLatexOptions): string {\n        let result = '';\n        if (!this.hasEmptyBranch('superscript')) {\n            let sup = Atom.toLatex(this.superscript, options);\n            if (sup.length === 1) {\n                if (sup === '\\u2032') {\n                    sup = '\\\\prime ';\n                } else if (sup === '\\u2033') {\n                    sup = '\\\\doubleprime ';\n                }\n                result += '^' + sup;\n            } else {\n                result += '^{' + sup + '}';\n            }\n        }\n        if (!this.hasEmptyBranch('subscript')) {\n            const sub = Atom.toLatex(this.subscript, options);\n            if (sub.length === 1) {\n                result += '_' + sub;\n            } else {\n                result += '_{' + sub + '}';\n            }\n        }\n        return result;\n    }\n    get treeDepth(): number {\n        let result = 1;\n        let atom = this.parent;\n        while (atom) {\n            atom = atom.parent;\n            result += 1;\n        }\n        return result;\n    }\n    /**\n     * Return the atoms in the branch, if it exists, otherwise null\n     */\n    branch(name: Branch | [col: number, row: number]): Atom[] | null {\n        if (!this.branches) return null;\n        if (!isNamedBranch(name)) return null;\n        return this.branches[name];\n    }\n    /**\n     * Return the atoms in the branch, if it exists, otherwise create it\n     */\n    createBranch(name: Branch): Atom[] {\n        console.assert(isNamedBranch(name));\n        if (!isNamedBranch(name)) return [];\n        if (!this.branches) {\n            this.branches = {\n                [name]: [this.makeFirstAtom(name)],\n            };\n        } else if (!this.branches[name]) {\n            this.branches[name] = [this.makeFirstAtom(name)];\n        }\n        this.isDirty = true;\n        return this.branches[name];\n    }\n    get row(): number {\n        if (!isColRowBranch(this.treeBranch)) return -1;\n        return this.treeBranch[0];\n    }\n    get col(): number {\n        if (!isColRowBranch(this.treeBranch)) return -1;\n        return this.treeBranch[1];\n    }\n    get body(): Atom[] {\n        return this.branches?.body;\n    }\n    set body(atoms: Atom[]) {\n        this.setChildren(atoms, 'body');\n    }\n    get superscript(): Atom[] {\n        return this.branches?.superscript;\n    }\n    set superscript(atoms: Atom[]) {\n        this.setChildren(atoms, 'superscript');\n    }\n    get subscript(): Atom[] {\n        return this.branches?.subscript;\n    }\n    set subscript(atoms: Atom[]) {\n        this.setChildren(atoms, 'subscript');\n    }\n    get above(): Atom[] {\n        return this.branches?.above;\n    }\n    set above(atoms: Atom[]) {\n        this.setChildren(atoms, 'above');\n    }\n    get below(): Atom[] {\n        return this.branches?.below;\n    }\n    set below(atoms: Atom[]) {\n        this.setChildren(atoms, 'below');\n    }\n    get computedStyle(): Style {\n        if (!this.parent) return this.style ?? {};\n        return { ...this.parent.computedStyle, ...this.style };\n    }\n    applyStyle(style: Style): void {\n        this.style = { ...this.style, ...style };\n\n        if (this.style.fontFamily === 'none') {\n            delete this.style.fontFamily;\n        }\n        if (this.style.fontShape === 'auto') {\n            delete this.style.fontShape;\n        }\n        if (this.style.fontSeries === 'auto') {\n            delete this.style.fontSeries;\n        }\n        if (this.style.color === 'none') {\n            delete this.style.color;\n        }\n        if (this.style.backgroundColor === 'none') {\n            delete this.style.backgroundColor;\n        }\n        if (this.style.fontSize === 'auto') {\n            delete this.style.fontSize;\n        }\n\n        if (this.style.fontSize) {\n            this.maxFontSize = SIZING_MULTIPLIER[this.style.fontSize];\n        }\n    }\n\n    getInitialBaseElement(): Atom {\n        let result: Atom;\n        if (!this.hasEmptyBranch('body')) {\n            console.assert(this.body[0].type === 'first');\n            result = this.body[1].getInitialBaseElement();\n        }\n        return result ?? this;\n    }\n\n    getFinalBaseElement(): Atom {\n        if (!this.hasEmptyBranch('body')) {\n            return this.body[this.body.length - 1].getFinalBaseElement();\n        }\n        return this;\n    }\n\n    isCharacterBox(): boolean {\n        const base = this.getInitialBaseElement();\n        return /minner|mbin|mrel|mpunct|mopen|mclose|textord/.test(base.type);\n    }\n\n    hasEmptyBranch(branch: Branch): boolean {\n        const atoms = this.branch(branch);\n        if (!atoms) return true;\n        console.assert(atoms.length > 0);\n        console.assert(atoms[0].type === 'first');\n        return atoms.length === 1;\n    }\n    /*\n     * Setting `null` does nothing\n     * Setting `[]` adds an empty list (the branch is created)\n     * The children should *not* start with a `'first'` atom:\n     * the `first` atom will be added if necessary\n     */\n    setChildren(children: Atom[], branch: Branch): void {\n        if (!children) return;\n        console.assert(isNamedBranch(branch));\n        if (!isNamedBranch(branch)) return;\n        console.assert(children[0]?.type !== 'first');\n\n        // Update the parent\n        if (!this.branches) {\n            this.branches = {\n                [branch]: [this.makeFirstAtom(branch), ...children],\n            };\n        } else {\n            this.branches[branch] = [this.makeFirstAtom(branch), ...children];\n        }\n        this.isDirty = true;\n\n        // Update the children\n        children.forEach((x) => {\n            x.parent = this;\n            x.treeBranch = branch;\n        });\n    }\n    makeFirstAtom(branch: Branch): Atom {\n        const result = new Atom('first', { mode: this.mode });\n        result.parent = this;\n        result.treeBranch = branch;\n        return result;\n    }\n\n    addChild(child: Atom, branch: Branch): void {\n        console.assert(child.type !== 'first');\n\n        this.createBranch(branch).push(child);\n        this.isDirty = true;\n\n        // Update the child\n        child.parent = this;\n        child.treeBranch = branch;\n    }\n\n    addChildBefore(child: Atom, before: Atom): void {\n        const branch = this.createBranch(before.treeBranch);\n        branch.splice(branch.indexOf(before), 0, child);\n        this.isDirty = true;\n\n        // Update the child\n        child.parent = this;\n        child.treeBranch = before.treeBranch;\n    }\n    addChildAfter(child: Atom, after: Atom): void {\n        const branch = this.createBranch(after.treeBranch);\n        branch.splice(branch.indexOf(after) + 1, 0, child);\n        this.isDirty = true;\n\n        // Update the child\n        child.parent = this;\n        child.treeBranch = after.treeBranch;\n    }\n    addChildren(children: Atom[], branch: Branch): void {\n        children.forEach((x) => this.addChild(x, branch));\n    }\n    addChildrenAfter(children: Atom[], after: Atom): void {\n        console.assert(children.length === 0 || children[0].type !== 'first');\n        const branch = this.createBranch(after.treeBranch);\n        branch.splice(branch.indexOf(after) + 1, 0, ...children);\n        this.isDirty = true;\n\n        // Update the children\n        children.forEach((x) => {\n            x.parent = this;\n            x.treeBranch = after.treeBranch;\n        });\n    }\n    removeBranch(name: Branch): Atom[] {\n        const children = this.branch(name);\n        if (isNamedBranch(name)) {\n            this.branches[name] = null;\n        }\n        children.forEach((x) => {\n            x.parent = null;\n            x.treeBranch = undefined;\n        });\n        // Drop the 'first' element\n        console.assert(children[0].type === 'first');\n        children.shift();\n        this.isDirty = true;\n        return children;\n    }\n    removeChild(child: Atom): void {\n        console.assert(child.parent === this);\n\n        // `first` atom cannot be deleted\n        if (child.type === 'first') return;\n\n        // Update the parent\n        const branch = this.branch(child.treeBranch);\n        const index = branch.indexOf(child);\n        console.assert(index >= 0);\n        branch.splice(index, 1);\n        this.isDirty = true;\n\n        // Update the child\n        child.parent = null;\n        child.treeBranch = undefined;\n    }\n    get siblings(): Atom[] {\n        if (this.type === 'root') return [];\n        return this.parent.branch(this.treeBranch);\n    }\n    get firstSibling(): Atom {\n        return this.siblings[0];\n    }\n    get lastSibling(): Atom {\n        const siblings = this.siblings;\n        return siblings[siblings.length - 1];\n    }\n    get isFirstSibling(): boolean {\n        return this === this.firstSibling;\n    }\n    get isLastSibling(): boolean {\n        return this === this.lastSibling;\n    }\n    get hasNoSiblings(): boolean {\n        return this.siblings.length === 1;\n    }\n    get leftSibling(): Atom {\n        const siblings = this.parent.branch(this.treeBranch);\n        return siblings[siblings.indexOf(this) - 1];\n    }\n    get rightSibling(): Atom {\n        const siblings = this.parent.branch(this.treeBranch);\n        return siblings[siblings.indexOf(this) + 1];\n    }\n\n    get hasChildren(): boolean {\n        // @todo array: account for colRow branches\n        return this.branches && this.children.length > 0;\n    }\n    get firstChild(): Atom {\n        console.assert(this.hasChildren);\n        return this.children[0];\n    }\n    get lastChild(): Atom {\n        console.assert(this.hasChildren);\n        const children = this.children;\n        return children[children.length - 1];\n    }\n\n    /**\n     * All the children of this atom.\n     *\n     * The order of the atoms is the order in which they\n     * are navigated using the keyboard.\n     */\n    get children(): Atom[] {\n        if (this._children) return this._children;\n        // @todo array: add colrow branches\n        const result = [];\n        if (this.branches) {\n            NAMED_BRANCHES.forEach((branch) => {\n                if (this.branches[branch]) {\n                    this.branches[branch].forEach((x) => {\n                        result.push(...x.children);\n                        result.push(x);\n                    });\n                }\n            });\n        }\n        this._children = result;\n        return result;\n    }\n\n    /**\n     * The common ancestor between two atoms\n     */\n    static commonAncestor(a: Atom, b: Atom): Atom {\n        if (a === b) return a.parent;\n\n        // Short-circuit a common case\n        if (a.parent === b.parent) return a.parent;\n\n        // Accumulate all the parents of `a`\n        const parents = new WeakSet<Atom>();\n        let parent = a.parent;\n        while (parent) {\n            parents.add(parent);\n            parent = parent.parent;\n        }\n        // Walk up the parents of `b`. If a parent of `b` is also a parent of\n        // `a`, it's the common ancestor\n        parent = b.parent;\n        while (parent) {\n            if (parents.has(parent)) return parent;\n            parent = parent.parent;\n        }\n        console.assert(!!parent); // Never reached\n        return null;\n    }\n\n    /**\n     * Render this atom as an array of Spans\n     *\n     * @param context Font variant, size, color, etc...\n     */\n    render(context: Context): Span[] | null {\n        // Render the body branch if present, even if it's empty (need to\n        // render the 'first' atom to render the caret in an empty branch\n        let result: Span = this.makeSpan(context, this.body ?? this.value);\n        if (!result) return null;\n\n        result.type = isSpanType(this.type) ? this.type : '';\n\n        if (this.containsCaret) {\n            result.classes = (result.classes || '') + ' ML__contains-caret';\n        }\n        // Finally, render any necessary superscript, subscripts\n        if (!this.limits && (this.superscript || this.subscript)) {\n            // If `limits` is set, the attachment of sup/sub was handled\n            // in the atom decomposition (e.g. mop, accent)\n            result = this.attachSupsub(context, result, result.type);\n        }\n        return [result];\n    }\n\n    attachSupsub(context: Context, nucleus: Span, type: SpanType): Span {\n        // If no superscript or subscript, nothing to do.\n        if (!this.superscript && !this.subscript) {\n            return nucleus;\n        }\n        // Superscript and subscripts are discussed in the TeXbook\n        // on page 445-446, rules 18(a-f).\n        // TeX:14859-14945\n        const mathstyle = context.mathstyle;\n        let supmid = null;\n        let submid = null;\n        if (this.branches.superscript) {\n            const sup = Atom.render(context.sup(), this.branches.superscript);\n            supmid = makeSpan(sup, mathstyle.adjustTo(mathstyle.sup()));\n        }\n        if (this.branches.subscript) {\n            const sub = Atom.render(context.sub(), this.branches.subscript);\n            submid = makeSpan(sub, mathstyle.adjustTo(mathstyle.sub()));\n        }\n        // Rule 18a, p445\n        let supShift = 0;\n        let subShift = 0;\n        if (!this.isCharacterBox()) {\n            supShift = spanHeight(nucleus) - mathstyle.metrics.supDrop;\n            subShift = spanDepth(nucleus) + mathstyle.metrics.subDrop;\n        }\n        // Rule 18c, p445\n        let minSupShift: number;\n        if (mathstyle === MATHSTYLES.displaystyle) {\n            minSupShift = mathstyle.metrics.sup1; // sigma13\n        } else if (mathstyle.cramped) {\n            minSupShift = mathstyle.metrics.sup3; // sigma15\n        } else {\n            minSupShift = mathstyle.metrics.sup2; // sigma14\n        }\n        // scriptspace is a font-size-independent size, so scale it\n        // appropriately @revisit: do we really need to do this scaling? It's in em...\n        const multiplier =\n            MATHSTYLES.textstyle.sizeMultiplier * mathstyle.sizeMultiplier;\n        const scriptspace = 0.5 / FONTMETRICS.ptPerEm / multiplier;\n        let supsub: Span | null = null;\n        if (submid && supmid) {\n            // Rule 18e\n            supShift = Math.max(\n                supShift,\n                minSupShift,\n                supmid.depth + 0.25 * mathstyle.metrics.xHeight\n            );\n            subShift = Math.max(subShift, mathstyle.metrics.sub2);\n            const ruleWidth = FONTMETRICS.defaultRuleThickness;\n            if (\n                supShift - spanDepth(supmid) - (spanHeight(submid) - subShift) <\n                4 * ruleWidth\n            ) {\n                subShift =\n                    4 * ruleWidth -\n                    (supShift - supmid.depth) +\n                    spanHeight(submid);\n                const psi =\n                    0.8 * mathstyle.metrics.xHeight -\n                    (supShift - spanDepth(supmid));\n                if (psi > 0) {\n                    supShift += psi;\n                    subShift -= psi;\n                }\n            }\n            supsub = makeVlist(\n                context,\n                [submid, subShift, supmid, -supShift],\n                'individualShift'\n            );\n            // Subscripts shouldn't be shifted by the nucleus' italic correction.\n            // Account for that by shifting the subscript back the appropriate\n            // amount. Note we only do this when the nucleus is a single symbol.\n            if (this.isExtensibleSymbol) {\n                supsub.children[0].left = -spanItalic(nucleus);\n            }\n        } else if (submid && !supmid) {\n            // Rule 18b\n            subShift = Math.max(\n                subShift,\n                mathstyle.metrics.sub1,\n                spanHeight(submid) - 0.8 * mathstyle.metrics.xHeight\n            );\n            supsub = makeVlist(context, [submid], 'shift', subShift);\n            supsub.children[0].right = scriptspace;\n            if (this.isCharacterBox()) {\n                supsub.children[0].left = -spanItalic(nucleus);\n            }\n        } else if (!submid && supmid) {\n            // Rule 18c, d\n            supShift = Math.max(\n                supShift,\n                minSupShift,\n                supmid.depth + 0.25 * mathstyle.metrics.xHeight\n            );\n            supsub = makeVlist(context, [supmid], 'shift', -supShift);\n            supsub.children[0].right = scriptspace;\n        }\n        // Display the caret *following* the superscript and subscript,\n        // so attach the caret to the 'msubsup' element.\n        const supsubContainer = makeSpan(supsub, 'msubsup');\n        if (this.caret) {\n            supsubContainer.caret = this.caret;\n            // this.caret = ''; // @revisit: we shouln't clear the **Atom** caret\n        }\n        return makeSpan([nucleus, supsubContainer], '', type);\n    }\n\n    attachLimits(\n        context: Context,\n        nucleus: Span,\n        nucleusShift: number,\n        slant: number\n    ): Span {\n        const limitAbove = this.superscript\n            ? makeSpan(\n                  Atom.render(context.sup(), this.superscript),\n                  context.mathstyle.adjustTo(context.mathstyle.sup())\n              )\n            : null;\n        const limitBelow = this.subscript\n            ? makeSpan(\n                  Atom.render(context.sub(), this.subscript),\n                  context.mathstyle.adjustTo(context.mathstyle.sub())\n              )\n            : null;\n        return makeLimitsStack(\n            context,\n            nucleus,\n            nucleusShift,\n            slant,\n            limitAbove,\n            limitBelow\n        );\n    }\n\n    /**\n     * Add an ID attribute to both the span and this atom so that the atom\n     * can be retrieved from the span later on (e.g. when the span is clicked on)\n     */\n    bind(context: Context, span: Span): Span {\n        if (this.type !== 'first' && this.value !== '\\u200b') {\n            this.id = makeID(context);\n            if (this.id) {\n                if (!span.attributes) span.attributes = {};\n                span.attributes['data-atom-id'] = this.id;\n            }\n        }\n        return span;\n    }\n\n    /**\n     * Create a span with the specified body and with a class attribute\n     * equal to the type ('mbin', 'inner', 'spacing', etc...)\n     *\n     */\n    makeSpan(context: Context, value: string | Atom[]): Span {\n        // Ensure that the atom type is a valid Span type, or use ''\n        const type: SpanType =\n            this.type === 'textord'\n                ? 'mord'\n                : isSpanType(this.type)\n                ? this.type\n                : '';\n        const result = makeSpan(\n            typeof value === 'string' ? value : Atom.render(context, value),\n            '',\n            type\n        );\n\n        // The font family is determined by:\n        // - the base font family associated with this atom (optional). For example,\n        // some atoms such as some functions ('\\sin', '\\cos', etc...) or some\n        // symbols ('\\Z') have an explicit font family. This overrides any\n        // other font family\n        // - the user-specified font family that has been explicitly applied to\n        // this atom\n        // - the font family automatically determined in math mode, for example\n        // which italicizes some characters, but which can be overridden\n\n        const style: Style = {\n            variant: 'normal', // will auto-italicize\n            ...this.style,\n            letterShapeStyle: context.letterShapeStyle,\n        };\n        result.applyStyle(this.mode, style);\n\n        // Apply size correction\n        const size = style?.fontSize ? style.fontSize : 'size5';\n        if (size !== context.parentSize) {\n            result.classes += ' sizing reset-' + context.parentSize;\n            result.classes += ' ' + size;\n        } else if (context.parentSize !== context.size) {\n            result.classes += ' sizing reset-' + context.parentSize;\n            result.classes += ' ' + context.size;\n        }\n        result.maxFontSize = Math.max(\n            result.maxFontSize,\n            context.mathstyle.sizeMultiplier ?? 1.0\n        );\n\n        // Set other attributes\n\n        if (this.mode === 'text') result.classes += ' ML__text';\n        if (context.mathstyle.isTight()) result.isTight = true;\n        // The italic correction applies only in math mode\n        if (this.mode !== 'math') result.italic = 0;\n        result.right = result.italic; // Italic correction\n\n        if (typeof context.opacity === 'number') {\n            result.setStyle('opacity', context.opacity);\n        }\n\n        // To retrieve the atom from a span, for example when the span is clicked\n        // on, attach a randomly generated ID to the span and associate it\n        // with the atom.\n        this.bind(context, result);\n        if (this.caret) {\n            // If this has a super/subscript, the caret will be attached\n            // to the 'msubsup' atom, so no need to have it here.\n            if (!this.superscript && !this.subscript) {\n                result.caret = this.caret;\n                // this.caret = ''; // @revisit: we shouln't clear the **Atom** caret\n            }\n        }\n        if (context.mathstyle.isTight()) result.isTight = true;\n        return result;\n    }\n}\n\nfunction makeID(context: Context): string {\n    let result: string;\n    if (context.atomIdsSettings) {\n        if (typeof context.atomIdsSettings.seed === 'number') {\n            result = context.atomIdsSettings.overrideID\n                ? context.atomIdsSettings.overrideID\n                : context.atomIdsSettings.seed.toString(36);\n            context.atomIdsSettings.seed += 1;\n        } else {\n            result =\n                Date.now().toString(36).slice(-2) +\n                Math.floor(Math.random() * 0x186a0).toString(36);\n        }\n    }\n    return result;\n}\n\n/* Combine a nucleus with an atom above and an atom below. Used to form\n * limits.\n *\n * @param context\n * @param nucleus The base over and under which the atoms will\n * be placed.\n * @param nucleusShift The vertical shift of the nucleus from\n * the baseline.\n * @param slant For operators that have a slant, such as \\int,\n * indicate by how much to horizontally offset the above and below atoms\n */\nfunction makeLimitsStack(\n    context: Context,\n    nucleus: Span,\n    nucleusShift: number,\n    slant: number,\n    above: Span,\n    below: Span\n): Span {\n    // If nothing above and nothing below, nothing to do.\n    if (!above && !below) return nucleus;\n\n    // IE8 clips \\int if it is in a display: inline-block. We wrap it\n    // in a new span so it is an inline, and works.\n    // @todo: revisit\n    nucleus = makeSpan(nucleus);\n\n    let aboveShift = 0;\n    let belowShift = 0;\n\n    if (above) {\n        aboveShift = Math.max(\n            FONTMETRICS.bigOpSpacing1,\n            FONTMETRICS.bigOpSpacing3 - spanDepth(above)\n        );\n    }\n    if (below) {\n        belowShift = Math.max(\n            FONTMETRICS.bigOpSpacing2,\n            FONTMETRICS.bigOpSpacing4 - spanHeight(below)\n        );\n    }\n\n    let result: Span | null = null;\n\n    if (below && above) {\n        const bottom =\n            FONTMETRICS.bigOpSpacing5 +\n            spanHeight(below) +\n            spanDepth(below) +\n            belowShift +\n            spanDepth(nucleus) +\n            nucleusShift;\n\n        result = makeVlist(\n            context,\n            [\n                FONTMETRICS.bigOpSpacing5,\n                below,\n                belowShift,\n                nucleus,\n                aboveShift,\n                above,\n                FONTMETRICS.bigOpSpacing5,\n            ],\n            'bottom',\n            bottom\n        );\n\n        // Here, we shift the limits by the slant of the symbol. Note\n        // that we are supposed to shift the limits by 1/2 of the slant,\n        // but since we are centering the limits adding a full slant of\n        // margin will shift by 1/2 that.\n        result!.children[0].left = -slant;\n        result!.children[2].left = slant;\n    } else if (below && !above) {\n        const top = spanHeight(nucleus) - nucleusShift;\n\n        result = makeVlist(\n            context,\n            [FONTMETRICS.bigOpSpacing5, below, belowShift, nucleus],\n            'top',\n            top\n        );\n\n        // See comment above about slants\n        result!.children[0].left = -slant;\n    } else if (!below && above) {\n        const bottom = spanDepth(nucleus) + nucleusShift;\n\n        result = makeVlist(\n            context,\n            [nucleus, aboveShift, above, FONTMETRICS.bigOpSpacing5],\n            'bottom',\n            bottom\n        );\n\n        // See comment above about slants\n        result!.children[1].left = slant;\n    }\n\n    return makeSpan(result, 'op-limits', 'mop');\n}\n\n/**\n *\n * @param atoms the list of atoms to emit as LaTeX\n * @param options.expandMacro true if macros should be expanded\n * @result a LaTeX string\n */\nfunction atomsToLatex(atoms: Atom[], options: ToLatexOptions): string {\n    if (atoms[0].type === 'first') {\n        if (atoms.length === 1) return '';\n        // Remove the 'first' atom, if present\n        atoms = atoms.slice(1);\n    }\n    if (atoms.length === 0) return '';\n\n    return joinLatex(\n        getPropertyRuns(atoms, 'cssClass').map((x) =>\n            joinLatex(\n                getPropertyRuns(x, 'color').map((x) =>\n                    joinLatex(\n                        getModeRuns(x).map((x) => emitLatexRun(x, options))\n                    )\n                )\n            )\n        )\n    );\n}\n","/**\r\n * This module contains some color dictionaries and algorithms to\r\n * parse a string into a hex RGB color value.s\r\n * @summary   Parsing of color strings.\r\n */\r\n\r\n/*\r\n{\\color{apricot}\\blacksquare}{\\color{aquamarine}\\blacksquare}{\\color{bittersweet}\\blacksquare}{\\color{black}\\blacksquare}{\\color{blue}\\blacksquare}{\\color{blueGreen}\\blacksquare}{\\color{blueviolet}\\blacksquare}{\\color{brickred}\\blacksquare}{\\color{brown}\\blacksquare}{\\color{burntorange}\\blacksquare}{\\color{cadetblue}\\blacksquare}{\\color{carnationpink}\\blacksquare}{\\color{cerulean}\\blacksquare}{\\color{cornflowerblue}\\blacksquare}{\\color{cyan}\\blacksquare}{\\color{dandelion}\\blacksquare}{\\color{darkorchid}\\blacksquare}{\\color{emerald}\\blacksquare}{\\color{forestgreen}\\blacksquare}{\\color{fuchsia}\\blacksquare}{\\color{goldenrod}\\blacksquare}{\\color{gray}\\blacksquare}{\\color{green}\\blacksquare}{\\color{greenyellow}\\blacksquare}{\\color{junglegreen}\\blacksquare}{\\color{lavender}\\blacksquare}{\\color{limegreen}\\blacksquare}{\\color{magenta}\\blacksquare}{\\color{mahogany}\\blacksquare}{\\color{maroon}\\blacksquare}{\\color{melon}\\blacksquare}{\\color{midnightblue}\\blacksquare}{\\color{mulberry}\\blacksquare}{\\color{navyblue}\\blacksquare}{\\color{olivegreen}\\blacksquare}{\\color{orange}\\blacksquare}{\\color{orangered}\\blacksquare}{\\color{orchid}\\blacksquare}{\\color{peach}\\blacksquare}{\\color{periwinkle}\\blacksquare}{\\color{pinegreen}\\blacksquare}{\\color{plum}\\blacksquare}{\\color{processblue}\\blacksquare}{\\color{purple}\\blacksquare}{\\color{rawsienna}\\blacksquare}{\\color{red}\\blacksquare}{\\color{redorange}\\blacksquare}{\\color{redviolet}\\blacksquare}{\\color{rhodamine}\\blacksquare}{\\color{royalblue}\\blacksquare}{\\color{royalpurple}\\blacksquare}{\\color{rubinered}\\blacksquare}{\\color{salmon}\\blacksquare}{\\color{seagreen}\\blacksquare}{\\color{sepia}\\blacksquare}{\\color{skyblue}\\blacksquare}{\\color{springgreen}\\blacksquare}{\\color{tan}\\blacksquare}{\\color{tealblue}\\blacksquare}{\\color{thistle}\\blacksquare}{\\color{turquoise}\\blacksquare}{\\color{violet}\\blacksquare}{\\color{violetred}\\blacksquare}{\\color{white}\\blacksquare}{\\color{wildstrawberry}\\blacksquare}{\\color{yellow}\\blacksquare}{\\color{yellowgreen}\\blacksquare}{\\color{yelloworange}\\blacksquare}\r\n*/\r\n\r\n/**\r\n * First 10 predefined colors used for plotting by Mathematica.\r\n *\r\n * Also known as _indexed color scheme #97_.\r\n */\r\nconst MATHEMATICA_COLORS: { [key: string]: string } = {\r\n    m0: '#3f3d99', // strong blue\r\n    m1: '#993d71', // strong cerise\r\n    m2: '#998b3d', // strong gold\r\n    m3: '#3d9956', // malachite green\r\n    m4: '#3d5a99', // strong cobalt blue\r\n    m5: '#993d90', // strong orchid\r\n    m6: '#996d3d', // strong orange\r\n    m7: '#43993d', // strong sap green\r\n    m8: '#3d7999', // cornflower blue\r\n    m9: '#843d99', // mulberry\r\n};\r\n// ColorData97 (Mathematica standard lines)\r\n// rgb(0.368417, 0.506779, 0.709798),       #5e81b5\r\n// rgb(0.880722, 0.611041, 0.142051),\r\n// rgb(0.560181, 0.691569, 0.194885),\r\n// rgb(0.922526, 0.385626, 0.209179),\r\n// rgb(0.528488, 0.470624, 0.701351),\r\n// rgb(0.772079, 0.431554, 0.102387),\r\n// rgb(0.363898, 0.618501, 0.782349),\r\n// rgb(1, 0.75, 0),\r\n// rgb(0.647624, 0.37816, 0.614037),\r\n// rgb(0.571589, 0.586483, 0.),\r\n// rgb(0.915, 0.3325, 0.2125),\r\n// rgb(0.40082222609352647, 0.5220066643438841, 0.85),\r\n// rgb(0.9728288904374106, 0.621644452187053, 0.07336199581899142),\r\n// rgb(0.736782672705901, 0.358, 0.5030266573755369),\r\n// rgb(0.28026441037696703, 0.715, 0.4292089322474965)\r\n\r\n// MathLab colors\r\n// '#0072bd' // [0, 0.4470, 0.7410]             blue\r\n// '#d95319' // [0.8500, 0.3250, 0.0980]        orange\r\n// '#edb120', // [0.9290, 0.6940, 0.1250]       yellow\r\n// '#7e2f8e', // [0.4940, 0.1840, 0.5560]       purple\r\n// '#77ac30', // [0.4660, 0.6740, 0.1880]       green\r\n// '#4dbeee', // [0.3010, 0.7450, 0.9330]       cyan\r\n// '#a2142f' // [0.6350, 0.0780, 0.1840]\t    dark red\r\n\r\n/* Area colors are most appropriate to color a large area */\r\nexport const AREA_COLORS = [\r\n    '#d35d60', // red\r\n    '#7293cb', // cobalt blue\r\n    '#e1974d', // orange\r\n    '#84bb5d', // pistachio\r\n    '#9066a7', // purple\r\n    '#aD6a58', // vermilion\r\n    '#f5a4ce', // pale rose\r\n    '#fff590', // pale gold\r\n    '#212121', // Black\r\n    '#818787', // dark grey\r\n    '#d4d5d2', // light grey\r\n    '#ffffff', // white\r\n];\r\n\r\n/* Line colors are most appropriate to color as a stroke color */\r\nexport const LINE_COLORS = [\r\n    '#cc2428', // red\r\n    '#3769b1', // cobalt blue\r\n    '#da7e30', // orange\r\n    '#409852', // malachite green\r\n    '#6b4c9a', // blue violet\r\n    '#922426', // red\r\n    '#e7298a', // brilliant rose\r\n    '#ffe907', // vivid gold\r\n    '#000000',\r\n    '#525055',\r\n    '#adafaa',\r\n    '#ffffff',\r\n];\r\n\r\n/**\r\n * 68 colors (+ white) known to dvips used in LaTeX.\r\n *\r\n * The color names are based on the names of the _Crayola Crayon_ box of\r\n * 64 crayons.\r\n *\r\n * See:\r\n * - {@link http://mirror.jmu.edu/pub/CTAN/systems/knuth/local/lib/colordvi.tex | ColorDVI.tex}\r\n * - {@link https://en.wikibooks.org/w/index.php?title=LaTeX/Colors | Wikibooks:LaTeX/Colors}\r\n */\r\nconst NAMED_COLORS: { [key: string]: string } = {\r\n    apricot: '#FBB982',\r\n    aquamarine: '#00B5BE',\r\n    bittersweet: '#C04F17',\r\n    black: '#221E1F', // Indeed.\r\n    blue: '#2D2F92',\r\n    bluegreen: '#00B3B8',\r\n    blueviolet: '#473992',\r\n    brickred: '#B6321C',\r\n    brown: '#792500',\r\n    burntorange: '#F7921D',\r\n    cadetblue: '#74729A',\r\n    carnationpink: '#F282B4',\r\n    cerulean: '#00A2E3',\r\n    cornflowerblue: '#41B0E4',\r\n    cyan: '#00AEEF',\r\n    dandelion: '#FDBC42',\r\n    darkorchid: '#A4538A',\r\n    emerald: '#00A99D',\r\n    forestgreen: '#009B55',\r\n    fuchsia: '#8C368C',\r\n    goldenrod: '#FFDF42',\r\n    gray: '#949698',\r\n    green: '#00A64F',\r\n    greenyellow: '#DFE674',\r\n    junglegreen: '#00A99A',\r\n    lavender: '#F49EC4',\r\n    limegreen: '#8DC73E',\r\n    magenta: '#EC008C',\r\n    mahogany: '#A9341F',\r\n    maroon: '#AF3235',\r\n    melon: '#F89E7B',\r\n    midnightblue: '#006795',\r\n    mulberry: '#A93C93',\r\n    navyblue: '#006EB8',\r\n    olivegreen: '#3C8031',\r\n    orange: '#F58137',\r\n    orangered: '#ED135A',\r\n    orchid: '#AF72B0',\r\n    peach: '#F7965A',\r\n    periwinkle: '#7977B8',\r\n    pinegreen: '#008B72',\r\n    plum: '#92268F',\r\n    processblue: '#00B0F0',\r\n    purple: '#99479B',\r\n    rawsienna: '#974006',\r\n    red: '#ED1B23',\r\n    redorange: '#F26035',\r\n    redviolet: '#A1246B',\r\n    rhodamine: '#EF559F',\r\n    royalblue: '#0071BC',\r\n    royalpurple: '#613F99',\r\n    rubinered: '#ED017D',\r\n    salmon: '#F69289',\r\n    seagreen: '#3FBC9D',\r\n    sepia: '#671800',\r\n    skyblue: '#46C5DD',\r\n    springgreen: '#C6DC67',\r\n    tan: '#DA9D76',\r\n    tealblue: '#00AEB3',\r\n    thistle: '#D883B7',\r\n    turquoise: '#00B4CE',\r\n    violet: '#58429B',\r\n    violetred: '#EF58A0',\r\n    white: '#FFFFFF',\r\n    wildstrawberry: '#EE2967',\r\n    yellow: '#FFF200',\r\n    yellowgreen: '#98CC70',\r\n    yelloworange: '#FAA21A',\r\n};\r\n\r\n// Other color lists: SVG colors, x11 colors\r\n/*\r\naliceblue\trgb(240, 248, 255)\r\nantiquewhite\trgb(250, 235, 215)\r\naqua\trgb( 0, 255, 255)\r\naquamarine\trgb(127, 255, 212)\r\nazure\trgb(240, 255, 255)\r\nbeige\trgb(245, 245, 220)\r\nbisque\trgb(255, 228, 196)\r\nblack\trgb( 0, 0, 0)\r\nblanchedalmond\trgb(255, 235, 205)\r\nblue\trgb( 0, 0, 255)\r\nblueviolet\trgb(138, 43, 226)\r\nbrown\trgb(165, 42, 42)\r\nburlywood\trgb(222, 184, 135)\r\ncadetblue\trgb( 95, 158, 160)\r\nchartreuse\trgb(127, 255, 0)\r\nchocolate\trgb(210, 105, 30)\r\ncoral\trgb(255, 127, 80)\r\ncornflowerblue\trgb(100, 149, 237)\r\ncornsilk\trgb(255, 248, 220)\r\ncrimson\trgb(220, 20, 60)\r\ncyan\trgb( 0, 255, 255)\r\ndarkblue\trgb( 0, 0, 139)\r\ndarkcyan\trgb( 0, 139, 139)\r\ndarkgoldenrod\trgb(184, 134, 11)\r\ndarkgray\trgb(169, 169, 169)\r\ndarkgreen\trgb( 0, 100, 0)\r\ndarkgrey\trgb(169, 169, 169)\r\ndarkkhaki\trgb(189, 183, 107)\r\ndarkmagenta\trgb(139, 0, 139)\r\ndarkolivegreen\trgb( 85, 107, 47)\r\ndarkorange\trgb(255, 140, 0)\r\ndarkorchid\trgb(153, 50, 204)\r\ndarkred\trgb(139, 0, 0)\r\ndarksalmon\trgb(233, 150, 122)\r\ndarkseagreen\trgb(143, 188, 143)\r\ndarkslateblue\trgb( 72, 61, 139)\r\ndarkslategray\trgb( 47, 79, 79)\r\ndarkslategrey\trgb( 47, 79, 79)\r\ndarkturquoise\trgb( 0, 206, 209)\r\ndarkviolet\trgb(148, 0, 211)\r\ndeeppink\trgb(255, 20, 147)\r\ndeepskyblue\trgb( 0, 191, 255)\r\ndimgray\trgb(105, 105, 105)\r\ndimgrey\trgb(105, 105, 105)\r\ndodgerblue\trgb( 30, 144, 255)\r\nfirebrick\trgb(178, 34, 34)\r\nfloralwhite\trgb(255, 250, 240)\r\nforestgreen\trgb( 34, 139, 34)\r\nfuchsia\trgb(255, 0, 255)\r\ngainsboro\trgb(220, 220, 220)\r\nghostwhite\trgb(248, 248, 255)\r\ngold\trgb(255, 215, 0)\r\ngoldenrod\trgb(218, 165, 32)\r\ngray\trgb(128, 128, 128)\r\ngrey\trgb(128, 128, 128)\r\ngreen\trgb( 0, 128, 0)\r\ngreenyellow\trgb(173, 255, 47)\r\nhoneydew\trgb(240, 255, 240)\r\nhotpink\trgb(255, 105, 180)\r\nindianred\trgb(205, 92, 92)\r\nindigo\trgb( 75, 0, 130)\r\nivory\trgb(255, 255, 240)\r\nkhaki\trgb(240, 230, 140)\r\nlavender\trgb(230, 230, 250)\r\nlavenderblush\trgb(255, 240, 245)\r\nlawngreen\trgb(124, 252, 0)\r\nlemonchiffon\trgb(255, 250, 205)\r\nlightblue\trgb(173, 216, 230)\r\nlightcoral\trgb(240, 128, 128)\r\nlightcyan\trgb(224, 255, 255)\r\nlightgoldenrodyellow\trgb(250, 250, 210)\r\nlightgray\trgb(211, 211, 211)\r\nlightgreen\trgb(144, 238, 144)\r\nlightgrey\trgb(211, 211, 211)\r\nlightpink\trgb(255, 182, 193)\r\nlightsalmon\trgb(255, 160, 122)\r\nlightseagreen\trgb( 32, 178, 170)\r\nlightskyblue\trgb(135, 206, 250)\r\nlightslategray\trgb(119, 136, 153)\r\nlightslategrey\trgb(119, 136, 153)\r\nlightsteelblue\trgb(176, 196, 222)\r\nlightyellow\trgb(255, 255, 224)\r\nlime\trgb( 0, 255, 0)\r\nlimegreen\trgb( 50, 205, 50)\r\nlinen\trgb(250, 240, 230)\r\nmagenta\trgb(255, 0, 255)\r\nmaroon\trgb(128, 0, 0)\r\nmediumaquamarine\trgb(102, 205, 170)\r\nmediumblue\trgb( 0, 0, 205)\r\nmediumorchid\trgb(186, 85, 211)\r\nmediumpurple\trgb(147, 112, 219)\r\nmediumseagreen\trgb( 60, 179, 113)\r\nmediumslateblue\trgb(123, 104, 238)\r\nmediumspringgreen\trgb( 0, 250, 154)\r\nmediumturquoise\trgb( 72, 209, 204)\r\nmediumvioletred\trgb(199, 21, 133)\r\nmidnightblue\trgb( 25, 25, 112)\r\nmintcream\trgb(245, 255, 250)\r\nmistyrose\trgb(255, 228, 225)\r\nmoccasin\trgb(255, 228, 181)\r\nnavajowhite\trgb(255, 222, 173)\r\nnavy\trgb( 0, 0, 128)\r\noldlace\trgb(253, 245, 230)\r\nolive\trgb(128, 128, 0)\r\nolivedrab\trgb(107, 142, 35)\r\norange\trgb(255, 165, 0)\r\norangered\trgb(255, 69, 0)\r\norchid\trgb(218, 112, 214)\r\npalegoldenrod\trgb(238, 232, 170)\r\npalegreen\trgb(152, 251, 152)\r\npaleturquoise\trgb(175, 238, 238)\r\npalevioletred\trgb(219, 112, 147)\r\npapayawhip\trgb(255, 239, 213)\r\npeachpuff\trgb(255, 218, 185)\r\nperu\trgb(205, 133, 63)\r\npink\trgb(255, 192, 203)\r\nplum\trgb(221, 160, 221)\r\npowderblue\trgb(176, 224, 230)\r\npurple\trgb(128, 0, 128)\r\nred\trgb(255, 0, 0)\r\nrosybrown\trgb(188, 143, 143)\r\nroyalblue\trgb( 65, 105, 225)\r\nsaddlebrown\trgb(139, 69, 19)\r\nsalmon\trgb(250, 128, 114)\r\nsandybrown\trgb(244, 164, 96)\r\nseagreen\trgb( 46, 139, 87)\r\nseashell\trgb(255, 245, 238)\r\nsienna\trgb(160, 82, 45)\r\nsilver\trgb(192, 192, 192)\r\nskyblue\trgb(135, 206, 235)\r\nslateblue\trgb(106, 90, 205)\r\nslategray\trgb(112, 128, 144)\r\nslategrey\trgb(112, 128, 144)\r\nsnow\trgb(255, 250, 250)\r\nspringgreen\trgb( 0, 255, 127)\r\nsteelblue\trgb( 70, 130, 180)\r\ntan\trgb(210, 180, 140)\r\nteal\trgb( 0, 128, 128)\r\nthistle\trgb(216, 191, 216)\r\ntomato\trgb(255, 99, 71)\r\nturquoise\trgb( 64, 224, 208)\r\nviolet\trgb(238, 130, 238)\r\nwheat\trgb(245, 222, 179)\r\nwhite\trgb(255, 255, 255)\r\nwhitesmoke\trgb(245, 245, 245)\r\nyellow\trgb(255, 255, 0)\r\nyellowgreen\trgb(154, 205, 50)\r\n \t \r\n*/\r\n\r\n/**\r\n * Return a CSS color (#rrggbb) from a string.\r\n *\r\n * Possible formats include:\r\n * - named colors from the DVI color set: 'Yellow', 'red'... Case insensitive.\r\n * - colors from the Mathematica set: 'm1'...'m9'\r\n * - 3-digit hex: `'#d50'`\r\n * - 6-digit hex: `'#dd5500'`\r\n * - RGB functional: `'rgb(240, 20, 10)'`\r\n *\r\n * In addition, colors can be mixed using the following syntax:\r\n * `<mix> = <color>![<value>][!<mix>]`\r\n * For example:\r\n * - `'blue!20'`  = 20% blue + 80% white\r\n * - `'blue!20!black'` = 20% + 80% black\r\n * - `'blue!20!black!30!green'` = (20% + 80% black) * 30 % + 70% green\r\n *\r\n * If the input string is prefixed with a dash, the complementary color\r\n * of the expression is returned.\r\n *\r\n * This creative syntax is defined by the {@link http://mirror.jmu.edu/pub/CTAN/macros/latex/contrib/xcolor/xcolor.pdf | `xcolor` LaTeX package}.\r\n *\r\n * @param s - An expression representing a color value\r\n * @return An RGB color expressed as a hex-triplet preceded by `#`\r\n */\r\nexport function stringToColor(s: string): string {\r\n    const colorSpec = s.toLowerCase().split('!');\r\n\r\n    let baseRed;\r\n    let baseGreen;\r\n    let baseBlue;\r\n    let red = 255;\r\n    let green = 255;\r\n    let blue = 255;\r\n    let mix = -1;\r\n\r\n    // If the string is prefixed with a '-', use the complementary color\r\n    const complementary =\r\n        colorSpec.length > 0 && colorSpec[0].charAt(0) === '-';\r\n    if (complementary) colorSpec[0] = colorSpec[0].slice(1);\r\n\r\n    for (let i = 0; i < colorSpec.length; i++) {\r\n        baseRed = red;\r\n        baseGreen = green;\r\n        baseBlue = blue;\r\n\r\n        const colorName = colorSpec[i].match(/([a-z0-9]*)/)?.[1];\r\n\r\n        let color = NAMED_COLORS[colorName] || MATHEMATICA_COLORS[colorName];\r\n        if (!color) color = colorSpec[i];\r\n\r\n        let m = color.match(/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i);\r\n        if (m?.[1] && m[2] && m[3]) {\r\n            // It's a six-digit hex number\r\n            red = Math.max(0, Math.min(255, parseInt(m[1], 16)));\r\n            green = Math.max(0, Math.min(255, parseInt(m[2], 16)));\r\n            blue = Math.max(0, Math.min(255, parseInt(m[3], 16)));\r\n        } else {\r\n            m = color.match(/^#([0-9a-f]{3})$/i);\r\n            if (m?.[1]) {\r\n                // It's a three-digit hex number\r\n                const r1 = parseInt(m[1][0], 16);\r\n                const g1 = parseInt(m[1][1], 16);\r\n                const b1 = parseInt(m[1][2], 16);\r\n                red = Math.max(0, Math.min(255, r1 * 16 + r1));\r\n                green = Math.max(0, Math.min(255, g1 * 16 + g1));\r\n                blue = Math.max(0, Math.min(255, b1 * 16 + b1));\r\n            } else {\r\n                // It's a rgb functional\r\n                m = color.match(\r\n                    /^rgb\\s*\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)$/i\r\n                );\r\n                if (m?.[1] && m[2] && m[3]) {\r\n                    red = Math.max(0, Math.min(255, parseInt(m[1])));\r\n                    green = Math.max(0, Math.min(255, parseInt(m[2])));\r\n                    blue = Math.max(0, Math.min(255, parseInt(m[3])));\r\n                } else {\r\n                    return null;\r\n                }\r\n            }\r\n        }\r\n        if (mix >= 0) {\r\n            red = (1.0 - mix) * red + mix * baseRed;\r\n            green = (1.0 - mix) * green + mix * baseGreen;\r\n            blue = (1.0 - mix) * blue + mix * baseBlue;\r\n            mix = -1;\r\n        }\r\n        if (i + 1 < colorSpec.length) {\r\n            mix = Math.max(0, Math.min(100, parseInt(colorSpec[++i]))) / 100.0;\r\n        }\r\n    }\r\n\r\n    if (mix >= 0) {\r\n        red = mix * red + (1.0 - mix) * baseRed;\r\n        green = mix * green + (1.0 - mix) * baseGreen;\r\n        blue = mix * blue + (1.0 - mix) * baseBlue;\r\n    }\r\n\r\n    if (complementary) {\r\n        red = 255 - red;\r\n        green = 255 - green;\r\n        blue = 255 - blue;\r\n    }\r\n\r\n    return (\r\n        '#' +\r\n        ('00' + Math.round(red).toString(16)).slice(-2) +\r\n        ('00' + Math.round(green).toString(16)).slice(-2) +\r\n        ('00' + Math.round(blue).toString(16)).slice(-2)\r\n    );\r\n}\r\n\r\nexport function colorToString(color: string): string {\r\n    if (!color) return '';\r\n    let result = color.toUpperCase();\r\n\r\n    for (const c in NAMED_COLORS) {\r\n        if (NAMED_COLORS[c] === result) {\r\n            result = c;\r\n            break;\r\n        }\r\n    }\r\n\r\n    for (const c in MATHEMATICA_COLORS) {\r\n        if (MATHEMATICA_COLORS[c] === result) {\r\n            result = c;\r\n            break;\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n","import { ParseMode, Style } from '../public/core';\n\nimport { Atom, ToLatexOptions } from '../core/atom-class';\nimport { Context } from '../core/context';\nimport { MATHSTYLES, MathStyleName } from '../core/mathstyle';\nimport { Span, makeSpan } from '../core/span';\n\nexport class GroupAtom extends Atom {\n    latexOpen?: string;\n    latexClose?: string;\n    cssId?: string;\n    customClass?: string;\n    mathStyleName: MathStyleName;\n    constructor(\n        arg: Atom[],\n        options?: {\n            mathStyleName?: MathStyleName;\n            latexOpen?: string;\n            latexClose?: string;\n            cssId?: string;\n            customClass?: string;\n            mode?: ParseMode;\n            style?: Style;\n            toLatexOverride?: (\n                atom: GroupAtom,\n                options: ToLatexOptions\n            ) => string;\n        }\n    ) {\n        super('group', {\n            mode: options?.mode ?? 'math',\n            toLatexOverride: options?.toLatexOverride,\n            style: options?.style,\n        });\n        this.body = arg;\n        this.mathStyleName = options?.mathStyleName;\n\n        this.latexOpen = options?.latexOpen;\n        this.latexClose = options?.latexClose;\n        this.cssId = options?.cssId;\n        this.customClass = options?.customClass;\n\n        this.skipBoundary = true;\n    }\n    render(context: Context): Span[] {\n        // The scope of the context is this group, so clone it\n        // so that any changes to it will be discarded when finished\n        // with this group.\n        // Note that the mathstyle property is optional and could be undefined\n        // If that's the case, clone() returns a clone of the\n        // context with the same mathstyle.\n        const localContext = context.clone({\n            mathstyle: this.mathStyleName\n                ? MATHSTYLES[this.mathStyleName]\n                : undefined,\n        });\n        const span = makeSpan(Atom.render(localContext, this.body), '', 'mord'); // @revisit\n        if (this.cssId) span.cssId = this.cssId;\n        span.applyStyle(\n            this.mode,\n            {\n                backgroundColor: this.style.backgroundColor,\n            },\n            this.customClass\n        );\n\n        if (this.caret) span.caret = this.caret;\n        // Need to bind the group so that the DOM element can be matched\n        // and the atom iterated recursively. Otherwise, it behaves\n        // as if `captureSelection === true`\n        this.bind(context, span);\n        return [span];\n    }\n    toLatex(options: ToLatexOptions): string {\n        const body = this.bodyToLatex(options);\n\n        if (typeof this.latexOpen === 'string') {\n            return this.latexOpen + body + this.latexClose;\n        }\n\n        if (this.cssId) {\n            return `\\\\cssId{${this.cssId}}${body}}`;\n        }\n\n        if (this.customClass) {\n            return `\\\\class{${this.customClass}}${body}}`;\n        }\n\n        return body;\n    }\n}\n","import { Atom, ToLatexOptions } from '../core/atom-class';\nimport { makeSpan, Span } from '../core/span';\nimport { Context } from '../core/context';\nimport { Style } from '../public/core';\n\nexport class SpacingAtom extends Atom {\n    private width: number;\n\n    constructor(command: string, style: Style, width?: number) {\n        super('spacing', { command, style });\n        this.width = width;\n    }\n    render(context: Context): Span[] {\n        let result: Span;\n        // A spacing command (\\quad, etc...)\n        // @revisit: is value needed? Is it ever set?\n        if (this.value === '\\u200b') {\n            // ZERO-WIDTH SPACE\n            result = this.makeSpan(context, '\\u200b');\n        } else if (this.value === '\\u00a0') {\n            if (this.mode === 'math') {\n                result = this.makeSpan(context, ' ');\n            } else {\n                result = this.makeSpan(context, '\\u00a0');\n            }\n        } else if (isFinite(this.width)) {\n            result = makeSpan('\\u200b', 'mspace ');\n            result.left = this.width;\n        } else {\n            const spacingCls =\n                {\n                    '\\\\qquad': 'qquad',\n                    '\\\\quad': 'quad',\n                    '\\\\enspace': 'enspace',\n                    '\\\\;': 'thickspace',\n                    '\\\\:': 'mediumspace',\n                    '\\\\,': 'thinspace',\n                    '\\\\!': 'negativethinspace',\n                }[this.command] ?? 'mediumspace';\n            result = makeSpan('\\u200b', 'mspace ' + spacingCls);\n        }\n        if (this.caret) result.caret = this.caret;\n        return [result];\n    }\n    toLatex(_options: ToLatexOptions): string {\n        // Three kinds of spacing commands:\n        // \\hskip and \\kern which take one implicit parameter\n        // \\hspace and hspace* with take one *explicit* parameter\n        // \\quad, etc... which take no parameters.\n        let result = this.command;\n        if (this.command === '\\\\hspace' || this.command === '\\\\hspace*') {\n            result += '{';\n            if (isFinite(this.width)) {\n                result += Number(this.width).toString() + 'em';\n            } else {\n                result += '0em';\n            }\n            result += '}';\n        } else {\n            result += ' ';\n            if (isFinite(this.width)) {\n                result += Number(this.width).toString() + 'em ';\n            }\n        }\n        return result;\n    }\n}\n","/**\r\n * This module deals with creating delimiters of various sizes. The TeXbook\r\n * discusses these routines on page 441-442, in the \"Another subroutine sets box\r\n * x to a specified variable delimiter\" paragraph.\r\n *\r\n * There are three main routines here. `makeSmallDelim` makes a delimiter in the\r\n * normal font, but in either text, script, or scriptscript style.\r\n * `makeLargeDelim` makes a delimiter in textstyle, but in one of the Size1,\r\n * Size2, Size3, or Size4 fonts. `makeStackedDelim` makes a delimiter out of\r\n * smaller pieces that are stacked on top of one another.\r\n *\r\n * The functions take a parameter `center`, which determines if the delimiter\r\n * should be centered around the axis.\r\n *\r\n * Then, there are three exposed functions. `sizedDelim` makes a delimiter in\r\n * one of the given sizes. This is used for things like `\\bigl`.\r\n * `customSizedDelim` makes a delimiter with a given total height+depth. It is\r\n * called in places like `\\sqrt`. `leftRightDelim` makes an appropriate\r\n * delimiter which surrounds an expression of a given height an depth. It is\r\n * used in `\\left` and `\\right`.\r\n * @summary   Handling of delimiters surrounds symbols.\r\n */\r\n\r\nimport {\r\n    makeSymbol,\r\n    makeSpan,\r\n    makeVlist,\r\n    makeStyleWrap,\r\n    SpanType,\r\n    Span,\r\n} from './span';\r\nimport { Mathstyle, MATHSTYLES } from './mathstyle';\r\nimport { getCharacterMetrics, METRICS } from './font-metrics';\r\nimport type { Context } from './context';\r\nexport const RIGHT_DELIM = {\r\n    '(': ')',\r\n    '{': '}',\r\n    '[': ']',\r\n    '|': '|',\r\n    '\\\\lbrace': '\\\\rbrace',\r\n    '\\\\{': '\\\\}',\r\n    '\\\\langle': '\\\\rangle',\r\n    '\\\\lfloor': '\\\\rfloor',\r\n    '\\\\lceil': '\\\\rceil',\r\n    '\\\\vert': '\\\\vert',\r\n    '\\\\lvert': '\\\\rvert',\r\n    '\\\\Vert': '\\\\Vert',\r\n    '\\\\lVert': '\\\\rVert',\r\n    '\\\\lbrack': '\\\\rbrack',\r\n    '\\\\ulcorner': '\\\\urcorner',\r\n    '\\\\llcorner': '\\\\lrcorner',\r\n    '\\\\lgroup': '\\\\rgroup',\r\n    '\\\\lmoustache': '\\\\rmoustache',\r\n};\r\n\r\nfunction getSymbolValue(symbol: string): string {\r\n    return (\r\n        {\r\n            '[': '[',\r\n            ']': ']',\r\n            '(': '(',\r\n            ')': ')',\r\n            '\\\\mid': '\\u2223',\r\n            '|': '\\u2223',\r\n            '\\u2223': '\\u2223', // DIVIDES\r\n            '\\u2225': '\\u2225', // PARALLEL TO\r\n            '\\\\|': '\\u2223',\r\n            '\\\\{': '{',\r\n            '\\\\}': '}',\r\n            '\\\\lbrace': '{',\r\n            '\\\\rbrace': '}',\r\n            '\\\\lbrack': '[',\r\n            '\\\\rbrack': ']',\r\n            '\\\\vert': '\\u2223',\r\n            '\\\\lvert': '\\u2223',\r\n            '\\\\mvert': '\\u2223',\r\n            '\\\\rvert': '\\u2223',\r\n            '\\\\Vert': '\\u2225',\r\n            '\\\\lVert': '\\u2225',\r\n            '\\\\mVert': '\\u2225',\r\n            '\\\\rVert': '\\u2225',\r\n            '\\\\parallel': '\\u2225',\r\n            '\\\\shortparallel': '\\u2225',\r\n            '\\\\langle': '\\u27e8',\r\n            '\\\\rangle': '\\u27e9',\r\n            '\\\\lfloor': '\\u230a',\r\n            '\\\\rfloor': '\\u230b',\r\n            '\\\\lceil': '\\u2308',\r\n            '\\\\rceil': '\\u2309',\r\n            '\\\\ulcorner': '\\u250c',\r\n            '\\\\urcorner': '\\u2510',\r\n            '\\\\llcorner': '\\u2514',\r\n            '\\\\lrcorner': '\\u2518',\r\n            '\\\\lgroup': '\\u27ee',\r\n            '\\\\rgroup': '\\u27ef',\r\n            '\\\\lmoustache': '\\u23b0',\r\n            '\\\\rmoustache': '\\u23b1',\r\n            '\\\\surd': '\\u221a',\r\n        }[symbol] ?? symbol\r\n    );\r\n}\r\n\r\n/**\r\n * Makes a small delimiter. This is a delimiter that comes in the Main-Regular\r\n * font, but is restyled to either be in textstyle, scriptstyle, or\r\n * scriptscriptstyle.\r\n */\r\nfunction makeSmallDelim(\r\n    type: SpanType,\r\n    delim: string,\r\n    style: Mathstyle,\r\n    center: boolean,\r\n    context: Context,\r\n    classes = ''\r\n): Span {\r\n    const text = makeSymbol('Main-Regular', getSymbolValue(delim));\r\n\r\n    const span = makeStyleWrap(type, text, context.mathstyle, style, classes);\r\n\r\n    if (center) {\r\n        span.setTop(\r\n            (1 - context.mathstyle.sizeMultiplier / style.sizeMultiplier) *\r\n                context.mathstyle.metrics.axisHeight\r\n        );\r\n    }\r\n    span.setStyle('color', context.color);\r\n    if (typeof context.opacity === 'number') {\r\n        span.setStyle('opacity', context.opacity);\r\n    }\r\n\r\n    return span;\r\n}\r\n\r\n/**\r\n * Makes a large delimiter. This is a delimiter that comes in the Size1, Size2,\r\n * Size3, or Size4 fonts. It is always rendered in textstyle.\r\n */\r\nfunction makeLargeDelim(\r\n    type: SpanType,\r\n    delim: string,\r\n    size: number,\r\n    center: boolean,\r\n    context: Context,\r\n    classes = ''\r\n): Span {\r\n    const result = makeStyleWrap(\r\n        type,\r\n        makeSymbol(\r\n            'Size' + size + '-Regular',\r\n            getSymbolValue(delim),\r\n            'delimsizing size' + size\r\n        ),\r\n        context.mathstyle,\r\n        MATHSTYLES.textstyle,\r\n        classes\r\n    );\r\n\r\n    if (center) {\r\n        result.setTop(\r\n            (1 - context.mathstyle.sizeMultiplier) *\r\n                context.mathstyle.metrics.axisHeight\r\n        );\r\n    }\r\n    result.setStyle('color', context.color);\r\n    if (typeof context.opacity === 'number') {\r\n        result.setStyle('opacity', context.opacity);\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n/**\r\n * Make an inner span with the given offset and in the given font. This is used\r\n * in `makeStackedDelim` to make the stacking pieces for the delimiter.\r\n */\r\nfunction makeInner(symbol: string, font: string): Span {\r\n    let sizeClass = '';\r\n    // Apply the correct CSS class to choose the right font.\r\n    if (font === 'Size1-Regular') {\r\n        sizeClass = ' delim-size1';\r\n    } else if (font === 'Size4-Regular') {\r\n        sizeClass = ' delim-size4';\r\n    }\r\n\r\n    return makeSymbol(\r\n        font,\r\n        getSymbolValue(symbol),\r\n        'delimsizinginner' + sizeClass\r\n    );\r\n}\r\n\r\n/**\r\n * Make a stacked delimiter out of a given delimiter, with the total height at\r\n * least `heightTotal`. This routine is mentioned on page 442 of the TeXbook.\r\n */\r\nfunction makeStackedDelim(\r\n    type: SpanType,\r\n    delim: string,\r\n    heightTotal: number,\r\n    center: boolean,\r\n    context: Context,\r\n    classes = ''\r\n): Span {\r\n    // There are four parts, the top, an optional middle, a repeated part, and a\r\n    // bottom.\r\n    let top: string;\r\n    let middle: string;\r\n    let repeat: string;\r\n    let bottom: string;\r\n    top = repeat = bottom = getSymbolValue(delim);\r\n    middle = null;\r\n    // Also keep track of what font the delimiters are in\r\n    let font = 'Size1-Regular';\r\n\r\n    // We set the parts and font based on the symbol. Note that we use\r\n    // '\\u23d0' instead of '|' and '\\u2016' instead of '\\\\|' for the\r\n    // repeats of the arrows\r\n    if (\r\n        delim === '\\\\vert' ||\r\n        delim === '\\\\lvert' ||\r\n        delim === '\\\\rvert' ||\r\n        delim === '\\\\mvert' ||\r\n        delim === '\\\\mid'\r\n    ) {\r\n        repeat = top = bottom = '\\u2223';\r\n    } else if (\r\n        delim === '\\\\Vert' ||\r\n        delim === '\\\\lVert' ||\r\n        delim === '\\\\rVert' ||\r\n        delim === '\\\\mVert' ||\r\n        delim === '\\\\|'\r\n    ) {\r\n        repeat = top = bottom = '\\u2225';\r\n    } else if (delim === '\\\\uparrow') {\r\n        repeat = bottom = '\\u23d0';\r\n    } else if (delim === '\\\\Uparrow') {\r\n        repeat = bottom = '\\u2016';\r\n    } else if (delim === '\\\\downarrow') {\r\n        top = repeat = '\\u23d0';\r\n    } else if (delim === '\\\\Downarrow') {\r\n        top = repeat = '\\u2016';\r\n    } else if (delim === '\\\\updownarrow') {\r\n        top = '\\u2191';\r\n        repeat = '\\u23d0';\r\n        bottom = '\\u2193';\r\n    } else if (delim === '\\\\Updownarrow') {\r\n        top = '\\u21d1';\r\n        repeat = '\\u2016';\r\n        bottom = '\\u21d3';\r\n    } else if (delim === '[' || delim === '\\\\lbrack') {\r\n        top = '\\u23a1';\r\n        repeat = '\\u23a2';\r\n        bottom = '\\u23a3';\r\n        font = 'Size4-Regular';\r\n    } else if (delim === ']' || delim === '\\\\rbrack') {\r\n        top = '\\u23a4';\r\n        repeat = '\\u23a5';\r\n        bottom = '\\u23a6';\r\n        font = 'Size4-Regular';\r\n    } else if (delim === '\\\\lfloor') {\r\n        repeat = top = '\\u23a2';\r\n        bottom = '\\u23a3';\r\n        font = 'Size4-Regular';\r\n    } else if (delim === '\\\\lceil') {\r\n        top = '\\u23a1';\r\n        repeat = bottom = '\\u23a2';\r\n        font = 'Size4-Regular';\r\n    } else if (delim === '\\\\rfloor') {\r\n        repeat = top = '\\u23a5';\r\n        bottom = '\\u23a6';\r\n        font = 'Size4-Regular';\r\n    } else if (delim === '\\\\rceil') {\r\n        top = '\\u23a4';\r\n        repeat = bottom = '\\u23a5';\r\n        font = 'Size4-Regular';\r\n    } else if (delim === '(') {\r\n        top = '\\u239b';\r\n        repeat = '\\u239c';\r\n        bottom = '\\u239d';\r\n        font = 'Size4-Regular';\r\n    } else if (delim === ')') {\r\n        top = '\\u239e';\r\n        repeat = '\\u239f';\r\n        bottom = '\\u23a0';\r\n        font = 'Size4-Regular';\r\n    } else if (delim === '\\\\{' || delim === '\\\\lbrace') {\r\n        top = '\\u23a7';\r\n        middle = '\\u23a8';\r\n        bottom = '\\u23a9';\r\n        repeat = '\\u23aa';\r\n        font = 'Size4-Regular';\r\n    } else if (delim === '\\\\}' || delim === '\\\\rbrace') {\r\n        top = '\\u23ab';\r\n        middle = '\\u23ac';\r\n        bottom = '\\u23ad';\r\n        repeat = '\\u23aa';\r\n        font = 'Size4-Regular';\r\n    } else if (delim === '\\\\lgroup') {\r\n        top = '\\u23a7';\r\n        bottom = '\\u23a9';\r\n        repeat = '\\u23aa';\r\n        font = 'Size4-Regular';\r\n    } else if (delim === '\\\\rgroup') {\r\n        top = '\\u23ab';\r\n        bottom = '\\u23ad';\r\n        repeat = '\\u23aa';\r\n        font = 'Size4-Regular';\r\n    } else if (delim === '\\\\lmoustache') {\r\n        top = '\\u23a7';\r\n        bottom = '\\u23ad';\r\n        repeat = '\\u23aa';\r\n        font = 'Size4-Regular';\r\n    } else if (delim === '\\\\rmoustache') {\r\n        top = '\\u23ab';\r\n        bottom = '\\u23a9';\r\n        repeat = '\\u23aa';\r\n        font = 'Size4-Regular';\r\n    } else if (delim === '\\\\surd') {\r\n        top = '\\ue001';\r\n        bottom = '\\u23b7';\r\n        repeat = '\\ue000';\r\n        font = 'Size4-Regular';\r\n    } else if (delim === '\\\\ulcorner') {\r\n        top = '\\u250c';\r\n        repeat = bottom = ' ';\r\n    } else if (delim === '\\\\urcorner') {\r\n        top = '\\u2510';\r\n        repeat = bottom = ' ';\r\n    } else if (delim === '\\\\llcorner') {\r\n        bottom = '\\u2514';\r\n        repeat = top = ' ';\r\n    } else if (delim === '\\\\lrcorner') {\r\n        top = '\\u2518';\r\n        repeat = top = ' ';\r\n    }\r\n\r\n    // Get the metrics of the four sections\r\n    const topMetrics = getCharacterMetrics(getSymbolValue(top), font);\r\n    const topHeightTotal = topMetrics.height + topMetrics.depth;\r\n    const repeatMetrics = getCharacterMetrics(getSymbolValue(repeat), font);\r\n    const repeatHeightTotal = repeatMetrics.height + repeatMetrics.depth;\r\n    const bottomMetrics = getCharacterMetrics(getSymbolValue(bottom), font);\r\n    const bottomHeightTotal = bottomMetrics.height + bottomMetrics.depth;\r\n    let middleHeightTotal = 0;\r\n    let middleFactor = 1;\r\n    if (middle !== null) {\r\n        const middleMetrics = getCharacterMetrics(getSymbolValue(middle), font);\r\n        middleHeightTotal = middleMetrics.height + middleMetrics.depth;\r\n        middleFactor = 2; // repeat symmetrically above and below middle\r\n    }\r\n\r\n    // Calculate the minimal height that the delimiter can have.\r\n    // It is at least the size of the top, bottom, and optional middle combined.\r\n    const minHeight = topHeightTotal + bottomHeightTotal + middleHeightTotal;\r\n\r\n    // Compute the number of copies of the repeat symbol we will need\r\n    const repeatCount = Math.ceil(\r\n        (heightTotal - minHeight) / (middleFactor * repeatHeightTotal)\r\n    );\r\n\r\n    // Compute the total height of the delimiter including all the symbols\r\n    const realHeightTotal =\r\n        minHeight + repeatCount * middleFactor * repeatHeightTotal;\r\n\r\n    // The center of the delimiter is placed at the center of the axis. Note\r\n    // that in this context, 'center' means that the delimiter should be\r\n    // centered around the axis in the current style, while normally it is\r\n    // centered around the axis in textstyle.\r\n    let axisHeight = context.mathstyle.metrics.axisHeight;\r\n    if (center) {\r\n        axisHeight *= context.mathstyle.sizeMultiplier;\r\n    }\r\n    // Calculate the depth\r\n    const depth = realHeightTotal / 2 - axisHeight;\r\n\r\n    // Now, we start building the pieces that will go into the vlist\r\n\r\n    // Keep a list of the inner pieces\r\n    const inners = [];\r\n\r\n    // Add the bottom symbol\r\n    inners.push(makeInner(bottom, font));\r\n\r\n    if (middle === null) {\r\n        // Add that many symbols\r\n        for (let i = 0; i < repeatCount; i++) {\r\n            inners.push(makeInner(repeat, font));\r\n        }\r\n    } else {\r\n        // When there is a middle bit, we need the middle part and two repeated\r\n        // sections\r\n        for (let i = 0; i < repeatCount; i++) {\r\n            inners.push(makeInner(repeat, font));\r\n        }\r\n        inners.push(makeInner(middle, font));\r\n        for (let i = 0; i < repeatCount; i++) {\r\n            inners.push(makeInner(repeat, font));\r\n        }\r\n    }\r\n\r\n    // Add the top symbol\r\n    inners.push(makeInner(top, font));\r\n\r\n    // Finally, build the vlist\r\n    const inner = makeVlist(context, inners, 'bottom', depth);\r\n    inner.setStyle('color', context.color);\r\n    if (typeof context.opacity === 'number') {\r\n        inner.setStyle('opacity', context.opacity);\r\n    }\r\n\r\n    return makeStyleWrap(\r\n        type,\r\n        makeSpan(inner, 'delimsizing mult'),\r\n        context.mathstyle,\r\n        MATHSTYLES.textstyle,\r\n        classes\r\n    );\r\n}\r\n\r\n// There are three kinds of delimiters, delimiters that stack when they become\r\n// too large\r\nconst stackLargeDelimiters = [\r\n    '(',\r\n    ')',\r\n    '[',\r\n    '\\\\lbrack',\r\n    ']',\r\n    '\\\\rbrack',\r\n    '\\\\{',\r\n    '\\\\lbrace',\r\n    '\\\\}',\r\n    '\\\\rbrace',\r\n    '\\\\lfloor',\r\n    '\\\\rfloor',\r\n    '\\\\lceil',\r\n    '\\\\rceil',\r\n    '\\\\surd',\r\n];\r\n\r\n// delimiters that always stack\r\nconst stackAlwaysDelimiters = [\r\n    '\\\\uparrow',\r\n    '\\\\downarrow',\r\n    '\\\\updownarrow',\r\n    '\\\\Uparrow',\r\n    '\\\\Downarrow',\r\n    '\\\\Updownarrow',\r\n    '|',\r\n    '\\\\|',\r\n    '\\\\vert',\r\n    '\\\\Vert',\r\n    '\\\\lvert',\r\n    '\\\\rvert',\r\n    '\\\\lVert',\r\n    '\\\\rVert',\r\n    '\\\\mvert',\r\n    '\\\\mid',\r\n    '\\\\lgroup',\r\n    '\\\\rgroup',\r\n    '\\\\lmoustache',\r\n    '\\\\rmoustache',\r\n];\r\n\r\n// and delimiters that never stack\r\nconst stackNeverDelimiters = [\r\n    '<',\r\n    '>',\r\n    '\\\\langle',\r\n    '\\\\rangle',\r\n    '/',\r\n    '\\\\backslash',\r\n    '\\\\lt',\r\n    '\\\\gt',\r\n];\r\n\r\n// Metrics of the different sizes. Found by looking at TeX's output of\r\n// $\\bigl| // \\Bigl| \\biggl| \\Biggl| \\showlists$\r\n// Used to create stacked delimiters of appropriate sizes in makeSizedDelim.\r\nconst sizeToMaxHeight = [0, 1.2, 1.8, 2.4, 3.0];\r\n\r\n/**\r\n * Used to create a delimiter of a specific size, where `size` is 1, 2, 3, or 4.\r\n */\r\nexport function makeSizedDelim(\r\n    type: SpanType,\r\n    delim: string,\r\n    size: number,\r\n    context: Context,\r\n    classes = ''\r\n): Span {\r\n    if (delim === '.') {\r\n        // Empty delimiters still count as elements, even though they don't\r\n        // show anything.\r\n        return makeNullFence(type, context, classes);\r\n        // return makeSpan('', classes);\r\n    }\r\n\r\n    // < and > turn into \\langle and \\rangle in delimiters\r\n    if (delim === '<' || delim === '\\\\lt') {\r\n        delim = '\\\\langle';\r\n    } else if (delim === '>' || delim === '\\\\gt') {\r\n        delim = '\\\\rangle';\r\n    }\r\n\r\n    // Sized delimiters are never centered.\r\n    if (\r\n        stackLargeDelimiters.includes(delim) ||\r\n        stackNeverDelimiters.includes(delim)\r\n    ) {\r\n        return makeLargeDelim(type, delim, size, false, context, classes);\r\n    } else if (stackAlwaysDelimiters.includes(delim)) {\r\n        return makeStackedDelim(\r\n            type,\r\n            delim,\r\n            sizeToMaxHeight[size],\r\n            false,\r\n            context,\r\n            classes\r\n        );\r\n    }\r\n    console.assert(false, \"Unknown delimiter '\" + delim + \"'\");\r\n    return null;\r\n}\r\n\r\n/*\r\n * There are three different sequences of delimiter sizes that the delimiters\r\n * follow depending on the kind of delimiter. This is used when creating custom\r\n * sized delimiters to decide whether to create a small, large, or stacked\r\n * delimiter.\r\n *\r\n * In real TeX, these sequences aren't explicitly defined, but are instead\r\n * defined inside the font metrics. Since there are only three sequences that\r\n * are possible for the delimiters that TeX defines, it is easier to just encode\r\n * them explicitly here.\r\n */\r\n\r\ninterface DelimiterInfo {\r\n    type: 'small' | 'large' | 'stack';\r\n    mathstyle?: Mathstyle;\r\n    size?: 1 | 2 | 3 | 4;\r\n}\r\n\r\n// Delimiters that never stack try small delimiters and large delimiters only\r\nconst stackNeverDelimiterSequence: DelimiterInfo[] = [\r\n    { type: 'small', mathstyle: MATHSTYLES.scriptscriptstyle },\r\n    { type: 'small', mathstyle: MATHSTYLES.scriptstyle },\r\n    { type: 'small', mathstyle: MATHSTYLES.textstyle },\r\n    { type: 'large', size: 1 },\r\n    { type: 'large', size: 2 },\r\n    { type: 'large', size: 3 },\r\n    { type: 'large', size: 4 },\r\n];\r\n\r\n// Delimiters that always stack try the small delimiters first, then stack\r\nconst stackAlwaysDelimiterSequence: DelimiterInfo[] = [\r\n    { type: 'small', mathstyle: MATHSTYLES.scriptscriptstyle },\r\n    { type: 'small', mathstyle: MATHSTYLES.scriptstyle },\r\n    { type: 'small', mathstyle: MATHSTYLES.textstyle },\r\n    { type: 'stack' },\r\n];\r\n\r\n// Delimiters that stack when large try the small and then large delimiters, and\r\n// stack afterwards\r\nconst stackLargeDelimiterSequence: DelimiterInfo[] = [\r\n    { type: 'small', mathstyle: MATHSTYLES.scriptscriptstyle },\r\n    { type: 'small', mathstyle: MATHSTYLES.scriptstyle },\r\n    { type: 'small', mathstyle: MATHSTYLES.textstyle },\r\n    { type: 'large', size: 1 },\r\n    { type: 'large', size: 2 },\r\n    { type: 'large', size: 3 },\r\n    { type: 'large', size: 4 },\r\n    { type: 'stack' },\r\n];\r\n\r\n/*\r\n * Get the font used in a delimiter based on what kind of delimiter it is.\r\n */\r\nfunction delimTypeToFont(info: DelimiterInfo): string {\r\n    if (info.type === 'small') {\r\n        return 'Main-Regular';\r\n    } else if (info.type === 'large') {\r\n        return 'Size' + info.size + '-Regular';\r\n    }\r\n    console.assert(info.type === 'stack');\r\n    return 'Size4-Regular';\r\n}\r\n\r\n/**\r\n * Traverse a sequence of types of delimiters to decide what kind of delimiter\r\n * should be used to create a delimiter of the given height+depth.\r\n * @param delim - a character value (not a command)\r\n */\r\nfunction traverseSequence(\r\n    delim: string,\r\n    height: number,\r\n    sequence: DelimiterInfo[],\r\n    context: Context\r\n): DelimiterInfo {\r\n    // Here, we choose the index we should start at in the sequences. In smaller\r\n    // sizes (which correspond to larger numbers in style.size) we start earlier\r\n    // in the sequence. Thus, scriptscript starts at index 3-3=0, script starts\r\n    // at index 3-2=1, text starts at 3-1=2, and display starts at min(2,3-0)=2\r\n    const start = Math.min(2, 3 - context.mathstyle.size);\r\n    for (let i = start; i < sequence.length; i++) {\r\n        if (sequence[i].type === 'stack') {\r\n            // This is always the last delimiter, so we just break the loop now.\r\n            break;\r\n        }\r\n\r\n        const metrics = getCharacterMetrics(\r\n            delim,\r\n            delimTypeToFont(sequence[i])\r\n        );\r\n        if (metrics.defaultMetrics) {\r\n            // If we don't have metrics info for this character,\r\n            // assume we'll construct as a small delimiter\r\n            return { type: 'small', mathstyle: MATHSTYLES.scriptstyle };\r\n        }\r\n        let heightDepth = metrics.height + metrics.depth;\r\n\r\n        // Small delimiters are scaled down versions of the same font, so we\r\n        // account for the style change size.\r\n\r\n        if (sequence[i].type === 'small') {\r\n            heightDepth *= sequence[i].mathstyle.sizeMultiplier;\r\n        }\r\n\r\n        // Check if the delimiter at this size works for the given height.\r\n        if (heightDepth > height) {\r\n            return sequence[i];\r\n        }\r\n    }\r\n\r\n    // If we reached the end of the sequence, return the last sequence element.\r\n    return sequence[sequence.length - 1];\r\n}\r\n\r\n/**\r\n * Make a delimiter of a given height+depth, with optional centering. Here, we\r\n * traverse the sequences, and create a delimiter that the sequence tells us to.\r\n *\r\n * @param type - 'mopen' or 'mclose'\r\n */\r\nexport function makeCustomSizedDelim(\r\n    type: SpanType,\r\n    delim: string,\r\n    height: number,\r\n    center: boolean,\r\n    context: Context,\r\n    classes = ''\r\n): Span {\r\n    if (!delim || delim.length === 0 || delim === '.') {\r\n        return makeNullFence(type, context, type);\r\n    }\r\n\r\n    if (delim === '<' || delim === '\\\\lt') {\r\n        delim = '\\\\langle';\r\n    } else if (delim === '>' || delim === '\\\\gt') {\r\n        delim = '\\\\rangle';\r\n    }\r\n\r\n    // Decide what sequence to use\r\n    let sequence: DelimiterInfo[];\r\n    if (stackNeverDelimiters.includes(delim)) {\r\n        sequence = stackNeverDelimiterSequence;\r\n    } else if (stackLargeDelimiters.includes(delim)) {\r\n        sequence = stackLargeDelimiterSequence;\r\n    } else {\r\n        sequence = stackAlwaysDelimiterSequence;\r\n    }\r\n\r\n    // Look through the sequence\r\n    const delimType = traverseSequence(\r\n        getSymbolValue(delim),\r\n        height,\r\n        sequence,\r\n        context\r\n    );\r\n\r\n    // Depending on the sequence element we decided on,\r\n    // call the appropriate function.\r\n    if (delimType.type === 'small') {\r\n        return makeSmallDelim(\r\n            type,\r\n            delim,\r\n            delimType.mathstyle,\r\n            center,\r\n            context,\r\n            'ML__small-delim ' + classes\r\n        );\r\n    }\r\n    if (delimType.type === 'large') {\r\n        return makeLargeDelim(\r\n            type,\r\n            delim,\r\n            delimType.size,\r\n            center,\r\n            context,\r\n            classes\r\n        );\r\n    }\r\n    console.assert(delimType.type === 'stack');\r\n    return makeStackedDelim(type, delim, height, center, context, classes);\r\n}\r\n\r\n/**\r\n * Make a delimiter for use with `\\left` and `\\right`, given a height and depth\r\n * of an expression that the delimiters surround.\r\n * See tex.web:14994\r\n */\r\nexport function makeLeftRightDelim(\r\n    type: SpanType,\r\n    delim: string,\r\n    height: number,\r\n    depth: number,\r\n    context: Context,\r\n    classes = ''\r\n): Span {\r\n    // If this is the empty delimiter, return a null fence\r\n    if (delim === '.') {\r\n        return makeNullFence(type, context, classes);\r\n    }\r\n\r\n    // We always center \\left/\\right delimiters, so the axis is always shifted\r\n    const axisHeight =\r\n        context.mathstyle.metrics.axisHeight * context.mathstyle.sizeMultiplier;\r\n\r\n    // Taken from TeX source, tex.web, function make_left_right\r\n    const delimiterFactor = 901; // plain.tex:327, texboox:152\r\n    const delimiterShortfall = 5.0 / METRICS.ptPerEm; // plain.tex:345, texboox:152\r\n\r\n    const maxDistFromAxis = Math.max(height - axisHeight, depth + axisHeight);\r\n    const totalHeight = Math.max(\r\n        (maxDistFromAxis / 500) * delimiterFactor,\r\n        2 * maxDistFromAxis - delimiterShortfall\r\n    );\r\n\r\n    // Finally, we defer to `makeCustomSizedDelim` with our calculated total\r\n    // height\r\n    return makeCustomSizedDelim(\r\n        type,\r\n        delim,\r\n        totalHeight,\r\n        true,\r\n        context,\r\n        classes\r\n    );\r\n}\r\n\r\n/**\r\n *\r\n * @param type either 'mopen', 'mclose' or null\r\n */\r\nfunction makeNullFence(\r\n    type: SpanType,\r\n    context: Context,\r\n    classes: string\r\n): Span {\r\n    return makeSpan(\r\n        '',\r\n        'sizing' + // @todo not useful, redundant with 'nulldelimiter'\r\n            // 'reset-' + context.size, 'size5',\r\n            // @todo: that seems like a lot of resizing... do we need both?\r\n            context.mathstyle.adjustTo(MATHSTYLES.textstyle) +\r\n            ' nulldelimiter ' + // The null delimiter has a width, specified by class 'nulldelimiter'\r\n            (classes || ''),\r\n        type\r\n    );\r\n}\r\n","import { Atom, ToLatexOptions } from '../core/atom-class';\r\nimport {\r\n    makeSpan,\r\n    depth as spanDepth,\r\n    height as spanHeight,\r\n    Span,\r\n} from '../core/span';\r\nimport { makeLeftRightDelim } from '../core/delimiters';\r\nimport { Context } from '../core/context';\r\nimport { joinLatex } from '../core/tokenizer';\r\nimport { Style } from '../public/core';\r\n\r\n/**\r\n *  \\left....\\right\r\n *\r\n * Note that we can encounter malformed \\left...\\right, for example\r\n * a \\left without a matching \\right or vice versa. In that case, the\r\n * leftDelim (resp. rightDelim) will be undefined. We still need to handle\r\n * those cases.\r\n *\r\n */\r\nexport class LeftRightAtom extends Atom {\r\n    readonly leftDelim?: string;\r\n    rightDelim?: string;\r\n    private inner: boolean; // Indicate if it's a `\\mleft` (false), or a `\\left`\r\n    constructor(\r\n        body: Atom[],\r\n        options: {\r\n            inner?: boolean;\r\n            leftDelim: string;\r\n            rightDelim: string;\r\n            style?: Style;\r\n        }\r\n    ) {\r\n        super('leftright', { style: options.style });\r\n        this.body = body;\r\n        this.inner = options.inner ?? false;\r\n        this.leftDelim = options.leftDelim;\r\n        this.rightDelim = options.rightDelim;\r\n    }\r\n    toLatex(options: ToLatexOptions): string {\r\n        let segments = [];\r\n        if (this.inner) {\r\n            segments = [\r\n                '\\\\left' + (this.leftDelim || '.'),\r\n                this.bodyToLatex(options),\r\n                '\\\\right' + (this.rightDelim || '.'),\r\n            ];\r\n        } else {\r\n            if (options.expandMacro) {\r\n                // If we're in 'expandMacro' mode (i.e. interchange format\r\n                // used, e.g., on the clipboard for maximum compatibility\r\n                // with other LaTeX renderers), drop the `\\mleft(` and `\\mright`)\r\n                // commands\r\n                segments = [\r\n                    this.leftDelim === '.' ? '' : this.leftDelim,\r\n                    this.bodyToLatex(options),\r\n                    this.rightDelim === '.' ? '' : this.rightDelim,\r\n                ];\r\n            } else {\r\n                segments = [\r\n                    '\\\\mleft' + (this.leftDelim || '.'),\r\n                    this.bodyToLatex(options),\r\n                    '\\\\mright' + (this.rightDelim || '.'),\r\n                ];\r\n            }\r\n        }\r\n        return joinLatex(segments);\r\n    }\r\n    render(context: Context): Span[] {\r\n        if (!this.body) {\r\n            // No body, only a delimiter\r\n            if (this.leftDelim) {\r\n                return new Atom('mopen', { value: this.leftDelim }).render(\r\n                    context\r\n                );\r\n            }\r\n            if (this.rightDelim) {\r\n                return new Atom('mclose', { value: this.rightDelim }).render(\r\n                    context\r\n                );\r\n            }\r\n            return null;\r\n        }\r\n        // The scope of the context is this group, so make a copy of it\r\n        // so that any changes to it will be discarded when finished\r\n        // with this group.\r\n        const localContext = context.clone();\r\n        const inner = Atom.render(localContext, this.body);\r\n        const mathstyle = localContext.mathstyle;\r\n        let innerHeight = 0;\r\n        let innerDepth = 0;\r\n        let spans: Span[] = [];\r\n        // Calculate its height and depth\r\n        // The size of delimiters is the same, regardless of what mathstyle we are\r\n        // in. Thus, to correctly calculate the size of delimiter we need around\r\n        // a group, we scale down the inner size based on the size.\r\n        innerHeight = spanHeight(inner) * mathstyle.sizeMultiplier;\r\n        innerDepth = spanDepth(inner) * mathstyle.sizeMultiplier;\r\n        // Add the left delimiter to the beginning of the expression\r\n        if (this.leftDelim) {\r\n            spans.push(\r\n                this.bind(\r\n                    context,\r\n                    makeLeftRightDelim(\r\n                        'mopen',\r\n                        this.leftDelim,\r\n                        innerHeight,\r\n                        innerDepth,\r\n                        localContext,\r\n                        'ML__open'\r\n                    )\r\n                )\r\n            );\r\n            spans[spans.length - 1].applyStyle(this.mode, this.style);\r\n        }\r\n        if (inner) {\r\n            // Replace the delim (\\middle) spans with proper ones now that we know\r\n            // the height/depth\r\n            for (let i = 0; i < inner.length; i++) {\r\n                if (inner[i].delim) {\r\n                    const savedCaret = inner[i].caret;\r\n                    inner[i] = this.bind(\r\n                        context,\r\n                        makeLeftRightDelim(\r\n                            'minner',\r\n                            inner[i].delim,\r\n                            innerHeight,\r\n                            innerDepth,\r\n                            localContext\r\n                        )\r\n                    );\r\n                    inner[i].caret = savedCaret;\r\n                }\r\n            }\r\n            spans = spans.concat(inner);\r\n        }\r\n        // Add the right delimiter to the end of the expression.\r\n        if (this.rightDelim) {\r\n            let delim = this.rightDelim;\r\n            let classes;\r\n            if (delim === '?') {\r\n                if (context.smartFence) {\r\n                    // Use a placeholder delimiter matching the open delimiter\r\n                    delim = {\r\n                        '(': ')',\r\n                        '\\\\{': '\\\\}',\r\n                        '\\\\lbrace': '\\\\rbrace',\r\n                        '\\\\langle': '\\\\rangle',\r\n                        '\\\\lfloor': '\\\\rfloor',\r\n                        '\\\\lceil': '\\\\rceil',\r\n                        '\\\\vert': '\\\\vert',\r\n                        '\\\\lvert': '\\\\rvert',\r\n                        '\\\\Vert': '\\\\Vert',\r\n                        '\\\\lVert': '\\\\rVert',\r\n                        '\\\\lbrack': '\\\\rbrack',\r\n                        '\\\\ulcorner': '\\\\urcorner',\r\n                        '\\\\llcorner': '\\\\lrcorner',\r\n                        '\\\\lgroup': '\\\\rgroup',\r\n                        '\\\\lmoustache': '\\\\rmoustache',\r\n                    }[this.leftDelim];\r\n                    delim = delim || this.leftDelim;\r\n                    classes = 'ML__smart-fence__close';\r\n                } else {\r\n                    delim = '.';\r\n                }\r\n            }\r\n            spans.push(\r\n                this.bind(\r\n                    context,\r\n                    makeLeftRightDelim(\r\n                        'mclose',\r\n                        delim,\r\n                        innerHeight,\r\n                        innerDepth,\r\n                        localContext,\r\n                        (classes || '') + ' ML__close'\r\n                    )\r\n                )\r\n            );\r\n            spans[spans.length - 1].applyStyle(this.mode, this.style);\r\n        }\r\n\r\n        if (this.containsCaret) {\r\n            // Tag the first and last atom in the\r\n            // list with the \"ML__contains-caret\" style (it's the open and\r\n            // closing fence, respectively)\r\n            spans[0].classes = (spans[0].classes ?? '') + ' ML__contains-caret';\r\n            spans[spans.length - 1].classes =\r\n                (spans[spans.length - 1].classes ?? '') + ' ML__contains-caret';\r\n        }\r\n\r\n        // If the `inner` flag is set, return the `inner` element (that's the\r\n        // behavior for the regular `\\left...\\right`\r\n        // Otherwise, include a `\\mathopen{}...\\mathclose{}`. That's the\r\n        // behavior for `\\mleft...\\mright`, which allows for tighter spacing\r\n        // for example in `\\sin\\mleft(x\\mright)`\r\n        const result = this.inner\r\n            ? makeSpan(spans, mathstyle.cls(), 'minner')\r\n            : makeSpan(spans, mathstyle.cls(), 'mclose');\r\n\r\n        if (this.caret) result.caret = this.caret;\r\n\r\n        return [this.bind(context, result)];\r\n    }\r\n}\r\n","import { Atom, AtomType, ToLatexOptions } from '../core/atom-class';\nimport {\n    Span,\n    makeSpan,\n    height as spanHeight,\n    depth as spanDepth,\n} from '../core/span';\nimport { Context } from '../core/context';\nimport { Style } from '../public/core';\n\nexport class SubsupAtom extends Atom {\n    baseType: AtomType;\n    constructor(options?: { baseType?: AtomType; style?: Style }) {\n        super('msubsup', { style: options?.style });\n        this.baseType = options?.baseType;\n    }\n    render(context: Context): Span[] {\n        // The caret for this atom type is handled by its elements\n        const baseType =\n            {\n                mbin: 'mbin',\n                mop: 'mop',\n                mrel: 'mrel',\n                mopen: 'mopen',\n                mclose: 'mclose',\n                mpunct: 'mpunct',\n                minner: 'minner',\n                spacing: 'spacing',\n            }[this.baseType] ?? 'mord';\n        const result = makeSpan('\\u200b', '', baseType);\n        if (context.phantomBase) {\n            result.height = spanHeight(context.phantomBase);\n            result.depth = spanDepth(context.phantomBase);\n        }\n        console.assert(!this.limits);\n\n        return [this.attachSupsub(context, result, result.type)];\n    }\n    toLatex(options: ToLatexOptions): string {\n        return this.supsubToLatex(options);\n    }\n}\n","import { Atom, ToLatexOptions } from '../core/atom-class';\nimport { Span } from '../core/span';\nimport { Context } from '../core/context';\nimport { ParseMode, Style } from '../public/core';\n\nexport class PlaceholderAtom extends Atom {\n    constructor(options?: { value?: string; mode?: ParseMode; style?: Style }) {\n        super('placeholder', {\n            mode: options?.mode,\n            style: options?.style,\n            value: options?.value,\n        });\n        this.captureSelection = true;\n    }\n    render(context: Context): Span[] {\n        const result = this.makeSpan(context, '');\n        if (this.caret) {\n            result.classes += 'ML__placeholder-selected';\n        }\n\n        return [result];\n    }\n    toLatex(_options: ToLatexOptions): string {\n        return `\\\\placeholder{${this.value ?? ''}}`;\n    }\n}\n","import { Atom } from '../core/atom-class';\nimport { Span } from '../core/span';\nimport { Context } from '../core/context';\n\n/*\n * An atom representing a syntactic error, such as an unknown command\n */\nexport class ErrorAtom extends Atom {\n    constructor(value: string) {\n        super('error', { value, command: value, mode: 'math' });\n        this.latex = value;\n    }\n    render(context: Context): Span[] {\n        const result = this.makeSpan(context, this.value);\n        result.classes = 'ML__error';\n\n        if (this.caret) result.caret = this.caret;\n\n        return [result];\n    }\n}\n","import { Atom, ToLatexOptions } from '../core/atom-class';\nimport { Context } from '../core/context';\nimport { Span, makeSpan } from '../core/span';\n\nexport class MacroAtom extends Atom {\n    constructor(macro: string, args: string, body: Atom[]) {\n        super('macro', { command: macro });\n        this.body = body;\n        // Set the `captureSelection` attribute so that the atom is handled\n        // as an unbreakable unit\n        this.captureSelection = true;\n        this.latex = macro + args;\n    }\n    toLatex(options: ToLatexOptions): string {\n        return options.expandMacro ? this.bodyToLatex(options) : this.latex;\n    }\n    render(context: Context): Span[] {\n        const result = makeSpan(Atom.render(context, this.body), '', 'mord');\n        if (this.caret) result.caret = this.caret;\n\n        return [result];\n    }\n}\n","import {\r\n    ErrorListener,\r\n    MacroDefinition,\r\n    Style,\r\n    ParserErrorCode,\r\n    MacroDictionary,\r\n    ParseMode,\r\n} from '../public/core';\r\n\r\nimport { isArray } from '../common/types';\r\n\r\nimport { stringToColor } from './color';\r\nimport { convertDimenToEm } from './font-metrics';\r\nimport { Token, tokenize, tokensToString } from './tokenizer';\r\nimport { Atom, BBoxParam } from './atom-class';\r\nimport { parseTokens } from './modes-utils';\r\nimport {\r\n    FunctionDefinition,\r\n    getEnvironmentDefinition,\r\n    getInfo,\r\n    SymbolDefinition,\r\n    unicodeCharToLatex,\r\n} from '../core-definitions/definitions-utils';\r\nimport { Colspec } from '../core-atoms/array';\r\nimport { GroupAtom } from '../core-atoms/group';\r\nimport { SpacingAtom } from '../core-atoms/spacing';\r\nimport { LeftRightAtom } from '../core-atoms/leftright';\r\nimport { SubsupAtom } from '../core-atoms/subsup';\r\nimport { PlaceholderAtom } from '../core-atoms/placeholder';\r\nimport { ErrorAtom } from '../core-atoms/error';\r\nimport { MacroAtom } from '../core-atoms/macro';\r\nimport { ArgumentType } from './context';\r\n\r\n// Performance to check first char of string: https://jsben.ch/QLjdZ\r\n\r\nfunction isLiteral(token: Token): boolean {\r\n    return !/^<({|}|\\$|\\$\\$|space)>$/.test(token);\r\n}\r\n\r\n/**\r\n * Transform a list of tokens into a list of atoms.\r\n *\r\n\r\n * @property tokens - An array of tokens generated by the lexer.\r\n * @property args - Optional arguments to substitute the `#` token.\r\n * @property macros - A dictionary of objects, index by the name of\r\n * the macro, with the following keys:\r\n *    * args: an integer, the number of arguments, default 0. They can be referenced as #0,\r\n *       #1, #2... inside the definition of the macro\r\n *    * def: a string, the definition of the macro, which can reference other macros\r\n * @property index - The current token to be parsed: index in `this.tokens`\r\n * @property atoms - Accumulated result of the parsing by\r\n * `parseAtom()`\r\n * @property style - The font, weight, color, etc. to apply to the\r\n * upcoming tokens\r\n * @property parseMode - The parse mode indicates the syntax rules to\r\n * use to parse the upcoming tokens.\r\n * @property tabularMode - When in tabular mode, `'&'` is interpreted as\r\n *  a column separator and `'\\'` as a row separator. Used for matrixes, etc...\r\n * @property endCount - Counter to prevent deadlock. If `end()` is\r\n * called too many times (1,000) in a row for the same token, bail.\r\n */\r\nclass Parser {\r\n    tokens: Token[];\r\n    index = 0;\r\n\r\n    args: null | (string | Atom[])[];\r\n    macros: MacroDictionary;\r\n\r\n    style: Style = {};\r\n    parseMode: ParseMode = 'math';\r\n    smartFence = false;\r\n    tabularMode = false; // For arrays, matrix, etc.: ifferent parsing rules apply.\r\n\r\n    atoms: Atom[] = [];\r\n\r\n    endCount = 0;\r\n    onError: ErrorListener<ParserErrorCode>;\r\n\r\n    /**\r\n     * @param tokens - An array of tokens generated by the lexer.\r\n     * @param args - An optional list of arguments. `#n` tokens will be\r\n     * substituted with the corresponding element in the args object. This is used\r\n     * when parsing macros.\r\n     */\r\n    constructor(\r\n        tokens: Token[],\r\n        args: null | (string | Atom[])[],\r\n        macros: MacroDictionary,\r\n        onError: ErrorListener<ParserErrorCode>\r\n    ) {\r\n        this.tokens = tokens;\r\n        this.args = args;\r\n        this.macros = macros;\r\n        this.onError = (err): void =>\r\n            onError({\r\n                before: tokensToString(\r\n                    this.tokens.slice(this.index, this.index + 10)\r\n                ),\r\n                after: tokensToString(\r\n                    this.tokens.slice(Math.max(0, this.index - 10), this.index)\r\n                ),\r\n                ...err,\r\n            });\r\n    }\r\n    swapAtoms(newAtoms: Atom[] = []): Atom[] {\r\n        const result = this.atoms;\r\n        this.atoms = newAtoms;\r\n        return result;\r\n    }\r\n    swapParseMode(mode: ParseMode): ParseMode {\r\n        const result = this.parseMode;\r\n        this.parseMode = mode;\r\n        return result;\r\n    }\r\n    /**\r\n     * True if we've reached the end of the token stream\r\n     */\r\n    end(): boolean {\r\n        // To prevent a deadlock, count how many times end() is called without the\r\n        // index advancing. If it happens more than 1,000 times in a row,\r\n        // assume something is broken and pretend the stream is finished.\r\n        this.endCount++;\r\n        return this.index >= this.tokens.length || this.endCount > 1000;\r\n    }\r\n    get(): Token {\r\n        this.endCount = 0;\r\n        return this.index < this.tokens.length ? this.tokens[this.index++] : '';\r\n    }\r\n    peek(): Token {\r\n        return this.tokens[this.index];\r\n    }\r\n    /**\r\n     * @return True if the next token matches the input, and advance\r\n     */\r\n    match(input: string): boolean {\r\n        if (this.tokens[this.index] === input) {\r\n            this.index++;\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    /**\r\n     * Return the last atom that can have a subsup attached to it.\r\n     * If there isn't one, insert a `msubsup` and return it.\r\n     */\r\n    lastSubsupAtom(): Atom {\r\n        const lastAtom =\r\n            this.atoms.length === 0\r\n                ? undefined\r\n                : this.atoms[this.atoms.length - 1];\r\n        if (\r\n            !lastAtom ||\r\n            (lastAtom.type !== 'mop' &&\r\n                lastAtom.type !== 'leftright' &&\r\n                lastAtom.type !== 'msubsup')\r\n        ) {\r\n            if (!lastAtom?.limits || lastAtom?.limits === 'nolimits') {\r\n                this.atoms.push(new SubsupAtom({ baseType: lastAtom?.type }));\r\n            }\r\n        }\r\n        return this.atoms[this.atoms.length - 1];\r\n    }\r\n\r\n    /**\r\n     * @return True if the next token matches the specified regular expression pattern.\r\n     */\r\n    hasPattern(pattern: RegExp): boolean {\r\n        return pattern.test(this.tokens[this.index]);\r\n    }\r\n\r\n    hasInfixCommand(): boolean {\r\n        const index = this.index;\r\n        if (index < this.tokens.length && this.tokens[index][0] === '\\\\') {\r\n            const info = getInfo(\r\n                this.tokens[index],\r\n                this.parseMode,\r\n                this.macros\r\n            );\r\n            if (!info) return false;\r\n            if (info.ifMode && !info.ifMode.includes(this.parseMode)) {\r\n                return false;\r\n            }\r\n            return info.infix;\r\n        }\r\n        return false;\r\n    }\r\n    matchColumnSeparator(): boolean {\r\n        const index = this.index;\r\n        if (this.tabularMode && this.tokens[index] === '&') {\r\n            this.index++;\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    matchRowSeparator(): boolean {\r\n        const index = this.index;\r\n        if (\r\n            this.tabularMode &&\r\n            (this.tokens[index] === '\\\\\\\\' || this.tokens[index] === '\\\\cr')\r\n        ) {\r\n            this.index++;\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    /**\r\n     * Return the appropriate value for a placeholder, either a default\r\n     * one, or if a value was provided for #? via args, that value.\r\n     */\r\n    placeholder(): Atom[] {\r\n        if (!this.args || typeof this.args['?'] === 'undefined') {\r\n            return [\r\n                new PlaceholderAtom({\r\n                    mode: this.parseMode,\r\n                    style: this.style,\r\n                }),\r\n            ];\r\n        }\r\n        if (typeof this.args?.['?'] === 'string') {\r\n            // If there is a specific value defined for the placeholder,\r\n            // use it.\r\n            return parseString(\r\n                this.args['?'],\r\n                this.parseMode,\r\n                null,\r\n                this.macros,\r\n                false,\r\n                this.onError\r\n            );\r\n        }\r\n        return this.args['?'];\r\n    }\r\n\r\n    // matchToken(type: string): boolean {\r\n    //     if (this.hasToken(type)) {\r\n    //         this.index++;\r\n    //         return true;\r\n    //     }\r\n    //     return false;\r\n    // }\r\n    matchWhitespace(): boolean {\r\n        let found = false;\r\n        while (this.match('<space>')) {\r\n            found = true;\r\n        }\r\n        return found;\r\n    }\r\n    skipUntilToken(input: string): void {\r\n        let token = this.tokens[this.index];\r\n        while (token && token !== input) {\r\n            token = this.tokens[++this.index];\r\n        }\r\n        if (token === input) {\r\n            this.index++;\r\n        }\r\n    }\r\n\r\n    skipFiller(): void {\r\n        let done = false;\r\n        do {\r\n            const skippedSpace = this.matchWhitespace();\r\n            const skippedRelax = this.match('\\\\relax');\r\n            done = !skippedSpace && !skippedRelax;\r\n        } while (!done);\r\n    }\r\n    /**\r\n     * Keywords are used to specify dimensions, and for various other\r\n     * syntactic constructs.\r\n     *\r\n     * Unlike commands, they are not case sensitive.\r\n     *\r\n     * There are 25 keywords:\r\n     *\r\n     * at by bp cc cm dd depth em ex fil fill filll height in minus\r\n     * mm mu pc plus pt sp spread to true width\r\n     *\r\n     * TeX: 8212\r\n     * @return true if the expected keyword is present\r\n     */\r\n    matchKeyword(keyword: string): boolean {\r\n        const savedIndex = this.index;\r\n        let done = this.end();\r\n        let value = '';\r\n        while (!done) {\r\n            const token = this.get();\r\n            if (isLiteral(token)) {\r\n                value += token;\r\n                done = this.end() || value.length >= keyword.length;\r\n            } else {\r\n                done = true;\r\n            }\r\n        }\r\n        const hasKeyword = keyword.toUpperCase() === value.toUpperCase();\r\n        if (!hasKeyword) {\r\n            this.index = savedIndex;\r\n        }\r\n        return hasKeyword;\r\n    }\r\n    /**\r\n     * Return a sequence of characters as a string.\r\n     * i.e. 'abcd' returns 'abcd'.\r\n     * Terminates on the first non-literal token encountered\r\n     * e.g. '<{>', '<}>' etc...\r\n     * Will also terminate on character literal ']'\r\n     */\r\n    scanString(): string {\r\n        let result = '';\r\n        let done = this.end();\r\n        while (!done) {\r\n            if (this.match('<space>')) {\r\n                result += ' ';\r\n            } else {\r\n                const token = this.peek();\r\n                if (token === ']') {\r\n                    done = true;\r\n                } else if (isLiteral(token)) {\r\n                    result += this.get();\r\n                } else if (token[0] === '\\\\') {\r\n                    // TeX will give a 'Missing \\endcsname inserted' error\r\n                    // if it encounters any command when expecting a string.\r\n                    // We're a bit more lax.\r\n                    this.onError({ code: 'unbalanced-braces' });\r\n                    result += this.get();\r\n                } else {\r\n                    // It's '<{>', '<}>', '<$>' or '<$$>\r\n                    done = true;\r\n                }\r\n            }\r\n            done = done || this.end();\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Return a sequence of characters as a string.\r\n     * Terminates on a balanced closing bracket\r\n     * This is used by the `\\ce` command\r\n     */\r\n    scanBalancedString(): string {\r\n        let result = '';\r\n        let done = this.end();\r\n        let level = 1;\r\n        while (!done) {\r\n            if (this.match('<space>')) {\r\n                result += ' ';\r\n            } else {\r\n                const token = this.get();\r\n                if (token === '<{>') {\r\n                    result += '{';\r\n                    level += 1;\r\n                } else if (token === '<}>') {\r\n                    level -= 1;\r\n                    if (level > 0) {\r\n                        result += '}';\r\n                    } else {\r\n                        this.index -= 1;\r\n                    }\r\n                } else if (token === '<$>') {\r\n                    result += '$';\r\n                } else if (token === '<$$>') {\r\n                    result += '$$';\r\n                } else {\r\n                    result += token;\r\n                }\r\n            }\r\n            done = level === 0 || this.end();\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Return the literal tokens, as a string, until a matching closing \"}\"\r\n     */\r\n    matchLiteralArg(): string {\r\n        let result = '';\r\n        if (this.match('<{>')) {\r\n            let depth = 1;\r\n            while (depth > 0 && !this.end()) {\r\n                const token = this.get()!;\r\n                if (token === '<}>') {\r\n                    depth -= 1;\r\n                    if (depth > 0) {\r\n                        // Don't include final '}'\r\n                        result += '}';\r\n                    }\r\n                } else if (token === '<{>') {\r\n                    depth += 1;\r\n                    result += '{';\r\n                } else {\r\n                    result +=\r\n                        {\r\n                            '<space>': ' ',\r\n                            '<$$>': '$$',\r\n                            '<$>': '$',\r\n                        }[token] ?? token;\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Return a CSS color (#rrggbb)\r\n     */\r\n    scanColor(): string {\r\n        return stringToColor(this.scanString());\r\n    }\r\n    /**\r\n     * Return as a number a group of characters representing a\r\n     * numerical quantity.\r\n     *\r\n     * From TeX:8695 (scan_int):\r\n     * An integer number can be preceded by any number of spaces and `+' or\r\n     * `-' signs. Then comes either a decimal constant (i.e., radix 10), an\r\n     * octal constant (i.e., radix 8, preceded by '), a hexadecimal constant\r\n     * (radix 16, preceded by \"), an alphabetic constant (preceded by `), or\r\n     * an internal variable.\r\n     */\r\n    scanNumber(isInteger = true): number {\r\n        let negative = false;\r\n        let token = this.peek();\r\n        while (token === '<space>' || token === '+' || token === '-') {\r\n            this.get();\r\n            if (token === '-') negative = !negative;\r\n            token = this.peek();\r\n        }\r\n\r\n        isInteger = Boolean(isInteger);\r\n\r\n        let radix = 10;\r\n        let digits = /[0-9]/;\r\n        if (this.match(\"'\")) {\r\n            // Apostrophe indicates an octal value\r\n            radix = 8;\r\n            digits = /[0-7]/;\r\n            isInteger = true;\r\n        } else if (this.match('\"') || this.match('x')) {\r\n            // Double-quote indicates a hex value\r\n            // The 'x' prefix notation for the hexadecimal numbers is a MathJax extension.\r\n            // For example: 'x3a'\r\n            radix = 16;\r\n            // Hex digits have to be upper-case\r\n            digits = /[0-9A-F]/;\r\n            isInteger = true;\r\n        } else if (this.match('`')) {\r\n            // A backtick indicates an alphabetic constant: a letter, or a single-letter command\r\n            token = this.get();\r\n            if (token) {\r\n                if (token.startsWith('\\\\') && token.length === 2) {\r\n                    return (negative ? -1 : 1) * (token.codePointAt(1) ?? 0);\r\n                }\r\n                return (negative ? -1 : 1) * (token.codePointAt(0) ?? 0);\r\n            }\r\n            return NaN;\r\n        }\r\n        let value = '';\r\n        while (this.hasPattern(digits)) {\r\n            value += this.get();\r\n        }\r\n        // Parse the fractional part, if applicable\r\n        if (!isInteger && (this.match('.') || this.match(','))) {\r\n            value += '.';\r\n            while (this.hasPattern(digits)) {\r\n                value += this.get();\r\n            }\r\n        }\r\n        const result = isInteger ? parseInt(value, radix) : parseFloat(value);\r\n        return negative ? -result : result;\r\n    }\r\n    /**\r\n     * Return as a floating point number a dimension in pt (1 em = 10 pt)\r\n     *\r\n     * See TeX:8831\r\n     * @todo: note that some units depend on the font (em, ex). So it might be\r\n     * better to return a dimen struct with the value + unit and resolve\r\n     * later when we have a font context....\r\n     */\r\n    scanDimen(): number {\r\n        const value = this.scanNumber(false);\r\n        this.matchWhitespace();\r\n        let result: number;\r\n        if (this.matchKeyword('pt')) {\r\n            result = convertDimenToEm(value, 'pt');\r\n        } else if (this.matchKeyword('mm')) {\r\n            result = convertDimenToEm(value, 'mm');\r\n        } else if (this.matchKeyword('cm')) {\r\n            result = convertDimenToEm(value, 'cm');\r\n        } else if (this.matchKeyword('ex')) {\r\n            result = convertDimenToEm(value, 'ex');\r\n        } else if (this.matchKeyword('px')) {\r\n            result = convertDimenToEm(value, 'px');\r\n        } else if (this.matchKeyword('em')) {\r\n            result = convertDimenToEm(value, 'em');\r\n        } else if (this.matchKeyword('bp')) {\r\n            result = convertDimenToEm(value, 'bp');\r\n        } else if (this.matchKeyword('dd')) {\r\n            result = convertDimenToEm(value, 'dd');\r\n        } else if (this.matchKeyword('pc')) {\r\n            result = convertDimenToEm(value, 'pc');\r\n        } else if (this.matchKeyword('in')) {\r\n            result = convertDimenToEm(value, 'in');\r\n        } else if (this.matchKeyword('mu')) {\r\n            result = convertDimenToEm(value, 'mu');\r\n        } else {\r\n            // If the units are missing, TeX assumes 'pt'\r\n            this.onError({ code: 'missing-unit' });\r\n            result = convertDimenToEm(value, 'pt');\r\n        }\r\n        return result;\r\n    }\r\n    scanSkip(): number {\r\n        const result = this.scanDimen();\r\n        // We parse, but ignore, the optional 'plus' and 'minus'\r\n        // arguments.\r\n        this.matchWhitespace();\r\n        // 'plus', optionally followed by 'minus'\r\n        // ('minus' cannot come before 'plus')\r\n        // dimen or 'hfill'\r\n        if (this.matchKeyword('plus')) {\r\n            // @todo there could also be a \\hFilLlL command here\r\n            this.scanDimen();\r\n        }\r\n        this.matchWhitespace();\r\n        if (this.matchKeyword('minus')) {\r\n            // @todo there could also be a \\hFilLlL command here\r\n            this.scanDimen();\r\n        }\r\n        return result;\r\n    }\r\n    scanColspec(): Colspec[] {\r\n        this.matchWhitespace();\r\n        const result: Colspec[] = [];\r\n        while (!this.end() && !(this.peek() === '<}>' || this.peek() === ']')) {\r\n            const literal = this.get();\r\n            if (literal === 'c' || literal === 'r' || literal === 'l') {\r\n                result.push({ align: literal });\r\n            } else if (literal === '|') {\r\n                result.push({ rule: true });\r\n            } else if (literal === '@') {\r\n                if (this.match('<{>')) {\r\n                    const savedParsemode = this.swapParseMode('math');\r\n                    result.push({\r\n                        gap: this.parse((token) => token === '<}>'),\r\n                    });\r\n                    this.swapParseMode(savedParsemode);\r\n                }\r\n                if (!this.match('<}>')) {\r\n                    this.onError({ code: 'unbalanced-braces' });\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Parse a `\\(...\\)` or `\\[...\\]` sequence\r\n     * @return group for the sequence or null\r\n     */\r\n    parseModeSet(): Atom | null {\r\n        let final: Token = '';\r\n        if (this.match('\\\\(')) final = '\\\\)';\r\n        if (!final && this.match('\\\\[')) final = '\\\\]';\r\n        if (!final) return null;\r\n        const savedParsemode = this.swapParseMode('math');\r\n        const result = new GroupAtom(\r\n            this.parse((token) => token === final),\r\n            {\r\n                mathStyleName: final === '\\\\)' ? 'textstyle' : 'displaystyle',\r\n                latexOpen: final === '\\\\]' ? '\\\\[' : '\\\\(',\r\n                latexClose: final,\r\n            }\r\n        );\r\n        if (!this.match(final)) {\r\n            this.onError({ code: 'unbalanced-mode-shift' });\r\n        }\r\n        this.swapParseMode(savedParsemode);\r\n        if (result.hasEmptyBranch('body')) return null;\r\n\r\n        return result;\r\n    }\r\n    /**\r\n     * Parse a `$...$` or `$$...$$` sequence\r\n     */\r\n    parseModeShift(): Atom | null {\r\n        let final: Token = '';\r\n        if (this.match('<$>')) final = '<$>';\r\n        if (!final && this.match('<$$>')) final = '<$$>';\r\n        if (!final) return null;\r\n\r\n        const savedParsemode = this.swapParseMode('math');\r\n\r\n        const result = new GroupAtom(\r\n            this.parse((token: Token) => token === final),\r\n            {\r\n                mathStyleName: final === '<$>' ? 'textstyle' : 'displaystyle',\r\n                latexOpen: final === '<$>' ? '$' : '$$',\r\n                latexClose: final === '<$>' ? '$' : '$$',\r\n            }\r\n        );\r\n        if (!this.match(final)) {\r\n            this.onError({ code: 'unbalanced-mode-shift' });\r\n        }\r\n        this.swapParseMode(savedParsemode);\r\n        if (result.hasEmptyBranch('body')) return null;\r\n        return result;\r\n    }\r\n    /**\r\n     * Parse a \\begin{env}...\\end{end} sequence\r\n     */\r\n    parseEnvironment(): Atom | null {\r\n        // An environment starts with a \\begin command\r\n        if (!this.match('\\\\begin')) return null;\r\n\r\n        // The \\begin command is immediately followed by the environment\r\n        // name, as a string argument\r\n        const envName = this.parseArgument('string') as string;\r\n        if (!envName) return null;\r\n        const def = getEnvironmentDefinition(envName);\r\n        if (!def) {\r\n            this.onError({\r\n                code: 'unknown-environment',\r\n                arg: envName,\r\n            });\r\n            return null;\r\n        }\r\n\r\n        // If the environment has some arguments, parse them\r\n        const args: (string | number | BBoxParam | Colspec[] | Atom[])[] = [];\r\n        if (def?.params) {\r\n            for (const param of def.params) {\r\n                // Parse an argument\r\n                if (param.isOptional) {\r\n                    // If it's not present, scanArg returns null,\r\n                    // but push it on the list of arguments anyway.\r\n                    // The null value will be interpreted as unspecified\r\n                    // optional value by the command parse function.\r\n                    args.push(this.parseOptionalArgument(param.type));\r\n                } else {\r\n                    const arg:\r\n                        | string\r\n                        | number\r\n                        | BBoxParam\r\n                        | Colspec[]\r\n                        | Atom[] = this.parseArgument(param.type);\r\n                    if (!arg) {\r\n                        this.onError({\r\n                            code: 'missing-argument',\r\n                            arg: envName,\r\n                        });\r\n                    }\r\n                    args.push(arg);\r\n                }\r\n            }\r\n        }\r\n        // Some environments change the mode\r\n        const savedMode = this.parseMode;\r\n        const savedTabularMode = this.tabularMode;\r\n        const saveAtoms = this.swapAtoms([]);\r\n        // @todo: since calling scanImplicitGroup(), may not need to save/restore the atoms\r\n        this.tabularMode = def.tabular;\r\n        const array: Atom[][][] = [];\r\n        const rowGaps: number[] = [];\r\n        let row: Atom[][] = [];\r\n        let done = false;\r\n        do {\r\n            if (this.end()) {\r\n                this.onError({ code: 'unbalanced-environment', arg: envName });\r\n                done = true;\r\n            }\r\n            if (!done && this.match('\\\\end')) {\r\n                if (this.parseArgument('string') !== envName) {\r\n                    this.onError({\r\n                        code: 'unbalanced-environment',\r\n                        arg: envName,\r\n                    });\r\n                }\r\n                done = true;\r\n            }\r\n            if (!done) {\r\n                if (this.matchColumnSeparator()) {\r\n                    row.push(this.swapAtoms([]));\r\n                } else if (this.matchRowSeparator()) {\r\n                    row.push(this.swapAtoms([]));\r\n                    let gap = 0;\r\n                    this.matchWhitespace();\r\n                    if (this.match('[')) {\r\n                        gap = this.scanDimen();\r\n                        this.matchWhitespace();\r\n                        this.match(']');\r\n                    }\r\n                    rowGaps.push(gap || 0);\r\n                    array.push(row);\r\n                    row = [];\r\n                } else {\r\n                    this.atoms = this.atoms.concat(\r\n                        this.parse(\r\n                            (token: Token) =>\r\n                                token === '<}>' ||\r\n                                token === '&' ||\r\n                                token === '\\\\end' ||\r\n                                token === '\\\\cr' ||\r\n                                token === '\\\\\\\\'\r\n                        )\r\n                    );\r\n                }\r\n            }\r\n        } while (!done);\r\n        row.push(this.swapAtoms([]));\r\n        if (row.length > 0) array.push(row);\r\n        const newAtoms = this.swapAtoms(saveAtoms);\r\n        // If we're in tabular mode, we should end up with an empty atoms list\r\n        console.assert(\r\n            !this.tabularMode || newAtoms.length === 0,\r\n            'Leftover atoms in tabular mode'\r\n        );\r\n        this.parseMode = savedMode;\r\n        this.tabularMode = savedTabularMode;\r\n\r\n        if (!def.tabular && newAtoms.length === 0) return null;\r\n        if (def.tabular && array.length === 0) return null;\r\n\r\n        return def.createAtom(envName, array, rowGaps, args);\r\n    }\r\n    /**\r\n     * Parse a sequence until a group end marker, such as\r\n     * `}`, `\\end`, `&`, etc...\r\n     *\r\n     * Returns an array of atoms or an empty array if the sequence\r\n     * terminates right away.\r\n     *\r\n     * @param done - A predicate indicating if a\r\n     * token signals the end of an implicit group\r\n     */\r\n    parse(done?: (token: Token) => boolean): Atom[] {\r\n        const savedStyle = this.style;\r\n        if (!done) {\r\n            // Default group end marker\r\n            done = (token: Token): boolean => token === '<}>';\r\n        }\r\n        // To handle infix commands, we'll keep track of their prefix\r\n        // (tokens coming before them) and their arguments\r\n        let infix: Token = '';\r\n        let infixInfo: (FunctionDefinition & SymbolDefinition) | null = null;\r\n        let infixArgs: Atom[][] = [];\r\n        let prefix: Atom[] | null = null;\r\n        const saveAtoms = this.swapAtoms([]);\r\n        while (!this.end() && !done(this.peek())) {\r\n            if (this.hasInfixCommand() && !infix) {\r\n                // The next token is an infix and we have not seen one yet\r\n                // (there can be only one infix command per implicit group).\r\n                infix = this.get();\r\n                // The current parseMode, this.parseMode, may no longer have the value\r\n                // it had when we encountered the infix. However, since all infix are\r\n                // only defined in 'math' mode, we can use the 'math' constant\r\n                // for the parseMode\r\n                infixInfo = getInfo(infix, 'math', this.macros);\r\n                if (infixInfo) {\r\n                    infixArgs = this.parseArguments(infixInfo)[1] as Atom[][];\r\n                }\r\n                // Save the math list so far and start a new one\r\n                prefix = this.swapAtoms([]);\r\n            } else {\r\n                this.parseToken();\r\n            }\r\n        }\r\n        let result: Atom[];\r\n        if (infix) {\r\n            console.assert(Boolean(infixInfo));\r\n            infixArgs.unshift(this.swapAtoms(saveAtoms)); // suffix\r\n            if (prefix) infixArgs.unshift(prefix);\r\n            result = [infixInfo.createAtom(infix, infixArgs, this.style)];\r\n        } else {\r\n            result = this.swapAtoms(saveAtoms);\r\n        }\r\n\r\n        this.style = savedStyle;\r\n\r\n        return result;\r\n    }\r\n    /**\r\n     * Parse a group enclosed in a pair of braces: `{...}`.\r\n     *\r\n     * Return either a group Atom or null if not a group.\r\n     *\r\n     * Return a group Atom with an empty body if an empty\r\n     * group (i.e. `{}`).\r\n     */\r\n    parseGroup(): Atom | null {\r\n        if (!this.match('<{>')) return null;\r\n        const result = new GroupAtom(\r\n            this.parse((token: Token) => token === '<}>'),\r\n            {\r\n                mode: this.parseMode,\r\n                latexOpen: '{',\r\n                latexClose: '}',\r\n            }\r\n        );\r\n        if (!this.match('<}>')) {\r\n            this.onError({ code: 'unbalanced-braces' });\r\n        }\r\n        return result;\r\n    }\r\n    scanSmartFence(): Atom | null {\r\n        this.matchWhitespace();\r\n        if (!this.match('(')) return null;\r\n        // We've found an open paren... Convert to a `\\mleft...\\mright`\r\n        const saveAtoms = this.swapAtoms([]);\r\n        let nestLevel = 1;\r\n        while (!this.end() && nestLevel !== 0) {\r\n            if (this.match('(')) nestLevel += 1;\r\n            if (this.match(')')) nestLevel -= 1;\r\n            if (nestLevel !== 0) this.parseToken();\r\n        }\r\n        if (nestLevel === 0) this.match(')');\r\n        return new LeftRightAtom(this.swapAtoms(saveAtoms), {\r\n            inner: false,\r\n            leftDelim: '(',\r\n            rightDelim: nestLevel === 0 ? ')' : '?',\r\n        });\r\n    }\r\n    /**\r\n     * Scan a delimiter, e.g. '(', '|', '\\vert', '\\ulcorner'\r\n     *\r\n     * @return The delimiter (as a character or command) or null\r\n     */\r\n    scanDelim(): string | null {\r\n        this.matchWhitespace();\r\n        const token = this.get();\r\n        if (!token) {\r\n            this.onError({ code: 'unexpected-end-of-string' });\r\n            return null;\r\n        }\r\n        let delim = '.';\r\n        if (token[0] === '\\\\' || isLiteral(token)) {\r\n            delim = token;\r\n        }\r\n        const info = getInfo(delim, 'math', this.macros);\r\n        if (!info) {\r\n            this.onError({ code: 'unknown-command', arg: delim });\r\n            return null;\r\n        }\r\n        if (info.ifMode && !info.ifMode.includes(this.parseMode)) {\r\n            this.onError({ code: 'unexpected-delimiter', arg: delim });\r\n            return null;\r\n        }\r\n        if (info.type === 'mopen' || info.type === 'mclose') {\r\n            return delim;\r\n        }\r\n        // Some symbols are not of type mopen/mclose, but are still\r\n        // valid delimiters...\r\n        // '?' is a special delimiter used as a 'placeholder'\r\n        // (when the closing delimiter is displayed greyed out)\r\n        if (\r\n            /^(\\.|\\?|\\||<|>|\\\\vert|\\\\Vert|\\\\\\||\\\\surd|\\\\uparrow|\\\\downarrow|\\\\Uparrow|\\\\Downarrow|\\\\updownarrow|\\\\Updownarrow|\\\\mid|\\\\mvert|\\\\mVert)$/.test(\r\n                delim\r\n            )\r\n        ) {\r\n            return delim;\r\n        }\r\n        this.onError({ code: 'unexpected-delimiter', arg: delim });\r\n        return null;\r\n    }\r\n    /**\r\n     * Parse a `/left.../right` sequence.\r\n     *\r\n     * Note: the `/middle` command can occur multiple times inside a\r\n     * `/left.../right` sequence, and is handled separately.\r\n     *\r\n     * Return either an atom of type `'leftright'` or null\r\n     */\r\n    parseLeftRight(): Atom | null {\r\n        if (this.match('\\\\right') || this.match('\\\\mright')) {\r\n            // We have an unbalanced left/right (there's a \\right, but no \\left)\r\n            this.onError({ code: 'unbalanced-braces' });\r\n            return null;\r\n        }\r\n\r\n        const savedStyle = this.style;\r\n\r\n        let close = '\\\\right';\r\n        if (!this.match('\\\\left')) {\r\n            if (!this.match('\\\\mleft')) return null;\r\n            close = '\\\\mright';\r\n        }\r\n        const leftDelim = this.scanDelim();\r\n        if (!leftDelim) return null;\r\n\r\n        const saveAtoms = this.swapAtoms([]);\r\n        while (!this.end() && !this.match(close)) {\r\n            this.parseToken();\r\n        }\r\n        this.style = savedStyle;\r\n\r\n        // If we've reached the end and there was no `\\right` or\r\n        // there isn't a valid delimiter after `\\right`, we'll\r\n        // consider the `\\right` missing and set the `rightDelim` to undefined\r\n        const rightDelim = this.scanDelim();\r\n\r\n        return new LeftRightAtom(this.swapAtoms(saveAtoms), {\r\n            leftDelim: leftDelim,\r\n            rightDelim: rightDelim,\r\n            inner: close === '\\\\right',\r\n            style: this.style,\r\n        });\r\n    }\r\n    /**\r\n     * Parse a subscript/superscript: `^` and `_`.\r\n     *\r\n     * Modify the last atom accordingly, or create a new 'msubsup' carrier.\r\n     *\r\n     */\r\n    parseSupSub(): boolean {\r\n        // No sup/sub in text or command mode.\r\n        if (this.parseMode !== 'math') return false;\r\n        // Apply the subscript/superscript to the last rendered atom.\r\n        // If none is present (beginning of the list, i.e. `{^2}`,\r\n        // an empty atom will be created, equivalent to `{{}^2}`\r\n        let result = false;\r\n        let token = this.peek();\r\n        while (token === '^' || token === '_' || token === \"'\") {\r\n            const supsub = token === '_' ? 'subscript' : 'superscript';\r\n            if (this.match('^') || this.match('_')) {\r\n                const arg = this.parseArgument('math') as Atom[];\r\n                if (arg) {\r\n                    this.lastSubsupAtom().addChildren(arg, supsub);\r\n                    result = true;\r\n                }\r\n            } else if (this.match(\"'\")) {\r\n                // A single quote (prime) is actually equivalent to a\r\n                // '^{\\prime}'\r\n                this.lastSubsupAtom().addChild(\r\n                    new Atom('mord', {\r\n                        command: '\\\\prime',\r\n                        mode: 'math',\r\n                        value: '\\u2032',\r\n                    }),\r\n                    'superscript'\r\n                );\r\n                result = true;\r\n            }\r\n            token = this.peek();\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Parse a `\\limits` or `\\nolimits` command.\r\n     *\r\n     * This will change the placement of limits to be either above or below\r\n     * (if `\\limits`) or in the superscript/subscript position (if `\\nolimits`).\r\n     *\r\n     * This overrides the calculation made for the placement, which is usually\r\n     * dependent on the displaystyle (`inlinemath` prefers `\\nolimits`, while\r\n     * `displaymath` prefers `\\limits`).\r\n     */\r\n    parseLimits(): boolean {\r\n        // Note: technically, \\limits and \\nolimits are only applicable\r\n        // after an operator. However, we apply them in all cases. They\r\n        // will simply be ignored when not applicable (i.e. on a literal)\r\n        // which is actually consistent with TeX.\r\n        if (this.match('\\\\limits')) {\r\n            const lastAtom = this.lastSubsupAtom();\r\n            lastAtom.limits = 'limits';\r\n            // Record that the limits was set through an explicit command\r\n            // so we can generate the appropriate LaTeX later\r\n            lastAtom.explicitLimits = true;\r\n            return true;\r\n        }\r\n        if (this.match('\\\\nolimits')) {\r\n            const lastAtom = this.lastSubsupAtom();\r\n            lastAtom.limits = 'nolimits';\r\n            // Record that the limits was set through an explicit command\r\n            // so we can generate the appropriate LaTeX later\r\n            lastAtom.explicitLimits = true;\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    parseArguments(\r\n        info: FunctionDefinition\r\n    ): [ParseMode, (string | number | BBoxParam | Colspec[] | Atom[])[]] {\r\n        if (!info || !info.params) return [undefined, []];\r\n        let explicitGroup: ParseMode;\r\n        const args: (string | number | BBoxParam | Colspec[] | Atom[])[] = [];\r\n        let i = info.infix ? 2 : 0;\r\n        while (i < info.params.length) {\r\n            const param = info.params[i];\r\n            // Parse an argument\r\n            if (param.isOptional) {\r\n                args.push(this.parseOptionalArgument(param.type));\r\n            } else if (param.type.endsWith('*')) {\r\n                // For example 'math*'.\r\n                // In this case, indicate that a 'yet-to-be-parsed'\r\n                // argument (and 'explicit group') is present\r\n                explicitGroup = param.type.slice(0, -1) as ParseMode;\r\n            } else {\r\n                const arg = this.parseArgument(param.type);\r\n                if (typeof arg !== 'undefined') {\r\n                    args.push(arg);\r\n                } else {\r\n                    // Report an error\r\n                    this.onError({ code: 'missing-argument' });\r\n                    args.push(this.placeholder());\r\n                }\r\n            }\r\n            i += 1;\r\n        }\r\n        return [explicitGroup, args];\r\n    }\r\n    /**\r\n     * Parse a math field (in the TeX parlance), an argument to a function.\r\n     *\r\n     * An argument can either be a single atom or  a sequence of atoms enclosed\r\n     * in braces.\r\n     *\r\n     */\r\n    parseArgument(argType: ArgumentType): string | number | Atom[] | Colspec[] {\r\n        this.skipFiller();\r\n        argType = argType === 'auto' ? this.parseMode : argType;\r\n        let result: string | number | Atom[] | Colspec[];\r\n        // An argument (which is called a 'math field' in TeX)\r\n        // could be a single character or symbol, as in `\\frac12`\r\n        // Note that ``\\frac\\sqrt{-1}\\alpha\\beta`` is equivalent to\r\n        // ``\\frac{\\sqrt}{-1}{\\beta}``\r\n        if (!this.match('<{>')) {\r\n            if (argType === 'delim') {\r\n                return this.scanDelim() ?? '.';\r\n            } else if (argType === 'text' || argType === 'math') {\r\n                // Parse a single token.\r\n                const savedParseMode = this.swapParseMode(argType);\r\n                const atom = this.parseSimpleToken();\r\n                this.swapParseMode(savedParseMode);\r\n                return atom;\r\n            }\r\n        }\r\n\r\n        const saveAtoms = this.swapAtoms([]);\r\n        if (argType === 'text' || argType === 'math') {\r\n            const savedParseMode = this.parseMode;\r\n            this.parseMode = argType;\r\n\r\n            // Collect an array of tokens until a balanced \"}\"\r\n            const initialIndex = this.index;\r\n            let depth = 1;\r\n            do {\r\n                const token = this.get();\r\n                if (token === '<}>') depth -= 1;\r\n                if (token === '<{>') depth += 1;\r\n            } while (depth > 0 && !this.end());\r\n            result = parseTokens(\r\n                argType,\r\n                this.tokens.slice(initialIndex, this.index - 1),\r\n                this.onError,\r\n                {\r\n                    args: this.args,\r\n                    macros: this.macros,\r\n                    smartFence: this.smartFence,\r\n                    style: this.style,\r\n                    parse: (\r\n                        mode: ParseMode,\r\n                        tokens: Token[],\r\n                        options\r\n                    ): [Atom[], Token[]] => {\r\n                        const parser = new Parser(\r\n                            tokens,\r\n                            options.args,\r\n                            options.macros,\r\n                            this.onError\r\n                        );\r\n                        parser.parseMode = mode;\r\n                        parser.style = options.style;\r\n                        result = parser.parse();\r\n                        return [result, tokens.slice(parser.index)];\r\n                    },\r\n                }\r\n            );\r\n            if (!result) {\r\n                // No mode-specific result. Try again from the start\r\n                this.index = initialIndex;\r\n                do {\r\n                    this.atoms = this.atoms.concat(this.parse());\r\n                } while (!this.match('<}>') && !this.end());\r\n            }\r\n            this.parseMode = savedParseMode;\r\n        } else {\r\n            if (argType === 'string') {\r\n                result = this.scanString();\r\n            } else if (argType === 'balanced-string') {\r\n                result = this.scanBalancedString();\r\n            } else if (argType === 'number') {\r\n                result = this.scanNumber();\r\n            } else if (argType === 'dimen') {\r\n                result = this.scanDimen();\r\n            } else if (argType === 'skip') {\r\n                result = this.scanSkip();\r\n            } else if (argType === 'colspec') {\r\n                result = this.scanColspec();\r\n            } else if (argType === 'color') {\r\n                result = this.scanColor() || '#ffffff';\r\n            } else if (argType === 'delim') {\r\n                result = this.scanDelim() || '.';\r\n            }\r\n            this.skipUntilToken('<}>');\r\n        }\r\n        const atoms = this.swapAtoms(saveAtoms);\r\n        return result ?? atoms;\r\n    }\r\n    parseOptionalArgument(\r\n        parseMode: ArgumentType\r\n    ): string | number | BBoxParam | Colspec[] | Atom[] {\r\n        parseMode = parseMode === 'auto' ? this.parseMode : parseMode;\r\n        this.matchWhitespace();\r\n        if (!this.match('[')) return null;\r\n        const savedParseMode = this.parseMode;\r\n        const saveAtoms = this.swapAtoms();\r\n        let result: string | number | BBoxParam | Colspec[] | Atom[];\r\n        while (!this.end() && !this.match(']')) {\r\n            if (parseMode === 'string') {\r\n                result = this.scanString();\r\n            } else if (parseMode === 'number') {\r\n                result = this.scanNumber();\r\n            } else if (parseMode === 'dimen') {\r\n                result = this.scanDimen();\r\n            } else if (parseMode === 'skip') {\r\n                result = this.scanSkip();\r\n            } else if (parseMode === 'colspec') {\r\n                result = this.scanColspec();\r\n            } else if (parseMode === 'color') {\r\n                result = this.scanColor() ?? '#ffffff';\r\n            } else if (parseMode === 'bbox') {\r\n                // The \\bbox command takes a very particular argument:\r\n                // a comma delimited list of up to three arguments:\r\n                // a color, a dimension and a string.\r\n                // Split the string by comma delimited sub-strings, ignoring commas\r\n                // that may be inside (). For example\"x, rgb(a, b, c)\" would return\r\n                // ['x', 'rgb(a, b, c)']\r\n                const list = this.scanString()\r\n                    .toLowerCase()\r\n                    .trim()\r\n                    .split(/,(?![^(]*\\)(?:(?:[^(]*\\)){2})*[^\"]*$)/);\r\n                const bboxParam: BBoxParam = {};\r\n                for (const elem of list) {\r\n                    const color = stringToColor(elem);\r\n                    if (color) {\r\n                        bboxParam.backgroundcolor = color;\r\n                    } else {\r\n                        const m = elem.match(/^\\s*([0-9.]+)\\s*([a-z][a-z])/);\r\n                        if (m) {\r\n                            bboxParam.padding = convertDimenToEm(m[1], m[2]);\r\n                        } else {\r\n                            const m = elem.match(/^\\s*border\\s*:\\s*(.*)/);\r\n                            if (m) {\r\n                                bboxParam.border = m[1];\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                result = bboxParam;\r\n            } else if (parseMode === 'math') {\r\n                this.parseMode = parseMode;\r\n                this.atoms = this.atoms.concat(\r\n                    this.parse((token) => token === ']')\r\n                );\r\n                this.parseMode = savedParseMode;\r\n            }\r\n        }\r\n        const atoms = this.swapAtoms(saveAtoms);\r\n        return result ?? atoms;\r\n    }\r\n\r\n    parseCommand(command: string): Atom[] {\r\n        let result: Atom = null;\r\n        if (command === '\\\\placeholder') {\r\n            return [\r\n                new PlaceholderAtom({\r\n                    mode: this.parseMode,\r\n                    value: this.parseArgument('string') as string,\r\n                    style: this.style,\r\n                }),\r\n            ];\r\n        }\r\n        if (command === '\\\\char') {\r\n            // \\char has a special syntax and requires a non-braced integer\r\n            // argument\r\n            const initialIndex = this.index;\r\n            let codepoint = Math.floor(this.scanNumber(true));\r\n            if (!isFinite(codepoint) || codepoint < 0 || codepoint > 0x10ffff) {\r\n                codepoint = 0x2753; // BLACK QUESTION MARK\r\n            }\r\n            result = new Atom(this.parseMode === 'math' ? 'mord' : '', {\r\n                command: '\\\\char',\r\n                mode: this.parseMode,\r\n                value: String.fromCodePoint(codepoint),\r\n            });\r\n            result.latex =\r\n                '\\\\char' +\r\n                tokensToString(this.tokens.slice(initialIndex, this.index));\r\n            return [result];\r\n        }\r\n        if (command === '\\\\hskip' || command === '\\\\kern') {\r\n            // \\hskip and \\kern have a special syntax and requires a non-braced\r\n            // 'skip' argument\r\n            const width = this.scanSkip();\r\n            if (!isFinite(width)) return null;\r\n            return [new SpacingAtom(command, this.style, width)];\r\n        }\r\n\r\n        // Is this a macro?\r\n        result = this.scanMacro(command);\r\n        if (result) return [result];\r\n\r\n        // This wasn't a macro, so let's see if it's a regular command\r\n        const info = getInfo(command, this.parseMode, {});\r\n\r\n        if (!info) {\r\n            // An unknown command\r\n            this.onError({\r\n                code: 'unknown-command',\r\n                arg: command,\r\n            });\r\n            return [new ErrorAtom(command)];\r\n        }\r\n\r\n        if (info.ifMode && !info.ifMode.includes(this.parseMode)) {\r\n            // Command invalid in this mode\r\n            this.onError({\r\n                code: 'invalid-command',\r\n                arg: command,\r\n            });\r\n            return [new ErrorAtom(command)];\r\n        }\r\n\r\n        // Parse the arguments\r\n        // If explicitGroup is not empty, an explicit group is expected\r\n        // to follow the command and will be parsed *after* the\r\n        // command has been processed.\r\n        // This is used for commands such as \\textcolor{color}{content}\r\n        // that need to apply the color to the content *after* the\r\n        // style has been changed.\r\n        // In definitions, this is indicated with a parameter type\r\n        // of 'auto*'\r\n\r\n        const savedMode = this.parseMode;\r\n        if (info.applyMode) {\r\n            this.parseMode = info.applyMode;\r\n        }\r\n        const initialIndex = this.index;\r\n        const [explicitGroup, args] = this.parseArguments(info);\r\n        this.parseMode = savedMode;\r\n\r\n        if (!args) return null; // Some required arguments were missing...\r\n\r\n        if (info.applyMode && !info.applyStyle && !info.createAtom) {\r\n            return args[0] as Atom[];\r\n        }\r\n\r\n        if (info.infix) {\r\n            // Infix commands should be handled in scanImplicitGroup\r\n            // If we find an infix command here, it's a syntax error\r\n            // (second infix command in a group) and should be ignored.\r\n            this.onError({\r\n                code: 'too-many-infix-commands',\r\n                arg: command,\r\n            });\r\n            return null;\r\n        }\r\n\r\n        //  Invoke the createAtom() function if present\r\n        if (typeof info.createAtom === 'function') {\r\n            result = info.createAtom(command, args, this.style);\r\n            if (explicitGroup) {\r\n                result.body = this.parseArgument(explicitGroup) as Atom[];\r\n            }\r\n        } else if (typeof info.applyStyle === 'function') {\r\n            const style = info.applyStyle(command, args);\r\n            // No type provided -> the parse function will modify\r\n            // the current style rather than create a new Atom.\r\n            const savedMode = this.parseMode;\r\n            if (info.applyMode) {\r\n                // Change to 'text' (or 'math') mode if necessary\r\n                this.parseMode = info.applyMode;\r\n            }\r\n\r\n            // If an explicit group is expected, process it now\r\n            if (explicitGroup) {\r\n                // Create a temporary style\r\n                const saveStyle = this.style;\r\n                this.style = { ...this.style, ...style };\r\n                const atoms = this.parseArgument(explicitGroup) as Atom[];\r\n                this.style = saveStyle;\r\n                this.parseMode = savedMode;\r\n                return atoms;\r\n            }\r\n\r\n            // Merge the new style info with the current style\r\n            this.style = { ...this.style, ...style };\r\n            this.parseMode = savedMode;\r\n        } else {\r\n            // The new atom will inherit the current style\r\n            // Only override the variant if it is not '' or undefined\r\n            const style = {\r\n                ...this.style,\r\n                variant: info.variant ?? this.style.variant,\r\n                // variantStyle: info.variantStyle || this.style.variantStyle,\r\n            };\r\n            if (info.type === 'spacing') {\r\n                result = new SpacingAtom(command, this.style);\r\n            } else {\r\n                result = new Atom(info.type ?? 'mop', {\r\n                    command,\r\n                    style,\r\n                    value: info.value ?? command,\r\n                    mode: info.applyMode ?? this.parseMode,\r\n                });\r\n            }\r\n        }\r\n\r\n        if (\r\n            result instanceof Atom &&\r\n            !/^\\\\(llap|rlap|class|cssId)$/.test(command)\r\n        ) {\r\n            const argString = tokensToString(\r\n                this.tokens.slice(initialIndex, this.index)\r\n            );\r\n            if (argString && result.command) {\r\n                result.latex = result.command + argString;\r\n            }\r\n            if (result.isFunction && this.smartFence) {\r\n                // The command was a function that may be followed by\r\n                // an argument, like `\\sin(`\r\n                const smartFence = this.scanSmartFence();\r\n                if (smartFence) return [result, smartFence];\r\n            }\r\n        }\r\n        if (!result) return null;\r\n        return [result];\r\n    }\r\n\r\n    parseLiteral(literal: string): Atom[] {\r\n        let result: Atom;\r\n        const info = getInfo(literal, this.parseMode, this.macros);\r\n\r\n        if (info) {\r\n            result = new Atom(info.type, {\r\n                command: literal,\r\n                mode: this.parseMode,\r\n                value: info.value ?? literal,\r\n                style: { ...this.style },\r\n            });\r\n            if (info.isFunction) {\r\n                result.isFunction = true;\r\n            }\r\n        } else {\r\n            result = new Atom(this.parseMode === 'math' ? 'mord' : '', {\r\n                command: literal,\r\n                mode: this.parseMode,\r\n                value: literal,\r\n                style: { ...this.style },\r\n            });\r\n        }\r\n\r\n        result.latex = unicodeCharToLatex(this.parseMode, literal);\r\n\r\n        if (result.isFunction && this.smartFence) {\r\n            // The atom was a function that may be followed by\r\n            // an argument, like `f(`.\r\n            const smartFence = this.scanSmartFence();\r\n            if (smartFence) return [result, smartFence];\r\n        }\r\n\r\n        return [result];\r\n    }\r\n\r\n    parseSimpleToken(): Atom[] {\r\n        const token = this.get();\r\n        if (!token) return null;\r\n\r\n        if (token === '<space>') {\r\n            if (this.parseMode === 'text') {\r\n                return [\r\n                    new Atom('', {\r\n                        command: ' ',\r\n                        mode: 'text',\r\n                        value: ' ',\r\n                        style: this.style,\r\n                    }),\r\n                ];\r\n            }\r\n            return null;\r\n        }\r\n\r\n        if (token[0] === '\\\\') return this.parseCommand(token);\r\n\r\n        if (isLiteral(token)) return this.parseLiteral(token);\r\n\r\n        if (token === '<}>') {\r\n            this.onError({ latex: '', code: 'unbalanced-braces' });\r\n        } else {\r\n            this.onError({\r\n                latex: '',\r\n                code: 'unexpected-token',\r\n                arg: token,\r\n            });\r\n        }\r\n        return null;\r\n    }\r\n    /**\r\n     * Attempt to scan the macro name and return an atom list if successful.\r\n     * Otherwise, it wasn't a macro.\r\n     */\r\n    scanMacro(macro: string): Atom {\r\n        const macroName = macro.slice(1);\r\n        if (!this.macros || !this.macros[macroName]) return null;\r\n        const initialIndex = this.index;\r\n        const args: (string | Atom[])[] = [];\r\n        let def: string;\r\n        let argCount = 0;\r\n        if (typeof this.macros[macroName] === 'string') {\r\n            def = this.macros[macroName] as string;\r\n            // Let's see if there are arguments in the definition.\r\n            if (/(^|[^\\\\])#1/.test(def)) argCount = 1;\r\n            if (/(^|[^\\\\])#2/.test(def)) argCount = 2;\r\n            if (/(^|[^\\\\])#3/.test(def)) argCount = 3;\r\n            if (/(^|[^\\\\])#4/.test(def)) argCount = 4;\r\n            if (/(^|[^\\\\])#5/.test(def)) argCount = 5;\r\n            if (/(^|[^\\\\])#6/.test(def)) argCount = 6;\r\n            if (/(^|[^\\\\])#7/.test(def)) argCount = 7;\r\n            if (/(^|[^\\\\])#8/.test(def)) argCount = 8;\r\n            if (/(^|[^\\\\])#9/.test(def)) argCount = 9;\r\n        } else {\r\n            def = (this.macros[macroName] as MacroDefinition).def;\r\n            argCount = (this.macros[macroName] as MacroDefinition).args || 0;\r\n        }\r\n        for (let i = 1; i <= argCount; i++) {\r\n            // Parse each argument as a string. We don't know yet\r\n            // what the proper parse mode is, so defer parsing till later\r\n            // when invoking `parseString`\r\n            args[i] = this.matchLiteralArg();\r\n        }\r\n        // Carry forward the placeholder argument, if any.\r\n        args['?'] = this.args?.['?'];\r\n\r\n        // Group the result of the macro expansion\r\n        return new MacroAtom(\r\n            macro,\r\n            tokensToString(this.tokens.slice(initialIndex, this.index)),\r\n            parseString(\r\n                def,\r\n                this.parseMode,\r\n                args,\r\n                this.macros,\r\n                false,\r\n                this.onError\r\n            )\r\n        );\r\n    }\r\n    /**\r\n     * Make an atom for the current token or token group and\r\n     * add it to the parser's current atoms\r\n     */\r\n    parseToken(): boolean {\r\n        let result: Atom | Atom[] =\r\n            this.parseEnvironment() ||\r\n            this.parseModeShift() ||\r\n            this.parseModeSet() ||\r\n            this.parseGroup() ||\r\n            this.parseLeftRight();\r\n        if (!result && (this.parseSupSub() || this.parseLimits())) return true;\r\n        if (!result) result = this.parseSimpleToken();\r\n        // If we have an atom to add, push it at the end of the current math list\r\n        // We could have no atom for tokens that were skipped, a ' ' in math mode\r\n        // for example\r\n        if (isArray(result)) {\r\n            this.atoms = this.atoms.concat(result);\r\n        } else if (result) {\r\n            this.atoms.push(result);\r\n        }\r\n        return result !== null;\r\n    }\r\n}\r\n\r\n/**\r\n * Given a string of LaTeX, return a corresponding array of atoms.\r\n * @param args - If there are any placeholder tokens, e.g.\r\n * `#0`, `#1`, etc... they will be replaced by the value provided by `args`.\r\n * @param smartFence - If true, promote plain fences, e.g. `(`,\r\n * as `\\left...\\right` or `\\mleft...\\mright`\r\n */\r\nexport function parseString(\r\n    s: string,\r\n    parseMode: ParseMode,\r\n    args: null | (string | Atom[])[],\r\n    macros: null | MacroDictionary,\r\n    smartFence = false,\r\n    onError?: ErrorListener<ParserErrorCode>\r\n): Atom[] {\r\n    const parser = new Parser(\r\n        tokenize(s, args as string[]),\r\n        args,\r\n        macros,\r\n        (err) => {\r\n            if (typeof onError === 'function') {\r\n                onError({ ...err, latex: s });\r\n            } else {\r\n                // console.warn(\r\n                //     'MathLive parsing error: ' +\r\n                //         err.code +\r\n                //         (err.arg ? ' ' + err.arg + ' ' : ''),\r\n                //     'in \"' + s + '\"'\r\n                // );\r\n            }\r\n        }\r\n    );\r\n    parser.parseMode = parseMode ?? 'math'; // other possible values: 'text', 'color', etc...\r\n    if (smartFence) parser.smartFence = true;\r\n\r\n    let atoms = [];\r\n    while (!parser.end()) {\r\n        const more = parser.parse();\r\n        if (more) {\r\n            atoms = atoms.concat(more);\r\n        }\r\n    }\r\n    return atoms;\r\n}\r\n","import type { Context } from '../core/context';\r\nimport { Atom } from '../core/atom-class';\r\n\r\nimport {\r\n    makeSVGSpan,\r\n    makeSpan,\r\n    makeVlist,\r\n    makeSymbol,\r\n    height as spanHeight,\r\n    skew as spanSkew,\r\n    Span,\r\n} from '../core/span';\r\nimport { METRICS as FONTMETRICS } from '../core/font-metrics';\r\nimport { Style } from '../public/core';\r\n\r\nexport class AccentAtom extends Atom {\r\n    private accent?: string;\r\n    private svgAccent?: string;\r\n    constructor(\r\n        command: string,\r\n        body: Atom[],\r\n        options: { accentChar?: string; svgAccent?: string; style: Style }\r\n    ) {\r\n        super('accent', { command, style: options.style });\r\n        if (options.accentChar) {\r\n            this.accent = options.accentChar;\r\n        } else {\r\n            this.svgAccent = options?.svgAccent;\r\n        }\r\n        this.body = body;\r\n        this.skipBoundary = true;\r\n        this.limits = 'accent'; // This will suppress the regular\r\n        // supsub attachment and will delegate\r\n        // it to the decomposeAccent\r\n        // (any non-null value would do)\r\n    }\r\n    render(context: Context): Span[] {\r\n        // Accents are handled in the TeXbook pg. 443, rule 12.\r\n        const mathstyle = context.mathstyle;\r\n        // Build the base atom\r\n        const base = Atom.render(context.cramp(), this.body);\r\n        // Calculate the skew of the accent. This is based on the line \"If the\r\n        // nucleus is not a single character, let s = 0; otherwise set s to the\r\n        // kern amount for the nucleus followed by the \\skewchar of its font.\"\r\n        // Note that our skew metrics are just the kern between each character\r\n        // and the skewchar.\r\n        let skew = 0;\r\n        if (\r\n            !this.hasEmptyBranch('body') &&\r\n            this.body.length === 2 &&\r\n            this.body[1].isCharacterBox()\r\n        ) {\r\n            skew = spanSkew(base);\r\n        }\r\n        // calculate the amount of space between the body and the accent\r\n        let clearance = Math.min(spanHeight(base), mathstyle.metrics.xHeight);\r\n        let accentBody: Span;\r\n        if (this.svgAccent) {\r\n            accentBody = makeSVGSpan(this.svgAccent);\r\n            clearance = -clearance + FONTMETRICS.bigOpSpacing1;\r\n        } else {\r\n            // Build the accent\r\n            const accent = makeSymbol('Main-Regular', this.accent, 'math');\r\n            // Remove the italic correction of the accent, because it only serves to\r\n            // shift the accent over to a place we don't want.\r\n            accent.italic = 0;\r\n            // The \\vec character that the fonts use is a combining character, and\r\n            // thus shows up much too far to the left. To account for this, we add a\r\n            // specific class which shifts the accent over to where we want it.\r\n            const vecClass = this.accent === '\\u20d7' ? ' accent-vec' : '';\r\n            accentBody = makeSpan(makeSpan(accent), 'accent-body' + vecClass);\r\n        }\r\n        accentBody = makeVlist(context, [base, -clearance, accentBody]);\r\n        // Shift the accent over by the skew. Note we shift by twice the skew\r\n        // because we are centering the accent, so by adding 2*skew to the left,\r\n        // we shift it to the right by 1*skew.\r\n        accentBody.children[accentBody.children.length - 1].left = 2 * skew;\r\n        const result = makeSpan(accentBody, 'accent', 'mord');\r\n        if (this.caret) result.caret = this.caret;\r\n        return [this.attachSupsub(context, result, result.type)];\r\n    }\r\n}\r\n","import { Atom, ToLatexOptions } from '../core/atom-class';\r\nimport {\r\n    Span,\r\n    SpanType,\r\n    isSpanType,\r\n    makeSVGSpan,\r\n    makeSpan,\r\n    makeVlist,\r\n    depth as spanDepth,\r\n    height as spanHeight,\r\n} from '../core/span';\r\nimport { METRICS as FONTMETRICS } from '../core/font-metrics';\r\nimport { MATHSTYLES } from '../core/mathstyle';\r\nimport { Context } from '../core/context';\r\nimport { Style } from '../public/core';\r\n\r\n// An `overunder` atom has the following attributes:\r\n// - body: atoms[]: atoms displayed on the base line\r\n// - svgBody: string. A SVG graphic displayed on the base line (if present, the body is ignored)\r\n// - above: atoms[]: atoms displayed above the body\r\n// - svgAbove: string. A named SVG graphic above the element\r\n// - below: atoms[]: atoms displayed below the body\r\n// - svgBelow: string. A named SVG graphic below the element\r\nexport class OverunderAtom extends Atom {\r\n    svgAbove?: string;\r\n    svgBelow?: string;\r\n    svgBody?: string;\r\n    constructor(\r\n        command: string,\r\n        options: {\r\n            body?: Atom[];\r\n            above?: Atom[];\r\n            below?: Atom[];\r\n            svgBody?: string;\r\n            svgAbove?: string;\r\n            svgBelow?: string;\r\n            skipBoundary?: boolean;\r\n            style: Style;\r\n            toLatexOverride?: (\r\n                atom: OverunderAtom,\r\n                options: ToLatexOptions\r\n            ) => string;\r\n        }\r\n    ) {\r\n        super('overunder', {\r\n            command,\r\n            toLatexOverride: options.toLatexOverride,\r\n            style: options.style,\r\n        });\r\n        this.skipBoundary = options.skipBoundary ?? true;\r\n        this.limits = 'overunder';\r\n\r\n        this.body = options.body;\r\n        this.svgAbove = options.svgAbove;\r\n        this.svgBelow = options.svgBelow;\r\n        this.svgBody = options.svgBody;\r\n        this.above = options.above;\r\n        this.below = options.below;\r\n    }\r\n    render(context: Context): Span[] {\r\n        const body: Span | Span[] = this.svgBody\r\n            ? makeSVGSpan(this.svgBody)\r\n            : Atom.render(context, this.body);\r\n        const annotationStyle = context.clone({\r\n            mathstyle: MATHSTYLES.scriptstyle,\r\n        });\r\n        let above: Span;\r\n        let below: Span;\r\n        if (this.svgAbove) {\r\n            above = makeSVGSpan(this.svgAbove);\r\n        } else if (this.above) {\r\n            above = makeSpan(\r\n                Atom.render(annotationStyle, this.above),\r\n                context.mathstyle.adjustTo(annotationStyle.mathstyle)\r\n            );\r\n        }\r\n        if (this.svgBelow) {\r\n            below = makeSVGSpan(this.svgBelow);\r\n        } else if (this.below) {\r\n            below = makeSpan(\r\n                Atom.render(annotationStyle, this.below),\r\n                context.mathstyle.adjustTo(annotationStyle.mathstyle)\r\n            );\r\n        }\r\n        if (above && below) {\r\n            // Pad the above and below if over a \"base\"\r\n            below.left = 0.3;\r\n            below.right = 0.3;\r\n            above.left = 0.3;\r\n            above.right = 0.3;\r\n        }\r\n        let result = makeOverunderStack(\r\n            context,\r\n            body,\r\n            above,\r\n            below,\r\n            isSpanType(this.type) ? this.type : 'mrel'\r\n        );\r\n        if (this.superscript || this.subscript) {\r\n            result = this.attachLimits(context, result, 0, 0);\r\n        }\r\n        if (this.caret) result.caret = this.caret;\r\n        // Bind the generated span so its components can be selected\r\n        this.bind(context, result);\r\n        return [result];\r\n    }\r\n}\r\n\r\n/**\r\n * Combine a nucleus with an atom above and an atom below. Used to form\r\n * stacks for the 'overunder' atom type .\r\n *\r\n * @param nucleus The base over and under which the atoms will\r\n * be placed.\r\n * @param type The type ('mop', 'mrel', etc...) of the result\r\n */\r\nfunction makeOverunderStack(\r\n    context: Context,\r\n    nucleus: Span | Span[],\r\n    above: Span,\r\n    below: Span,\r\n    type: SpanType\r\n): Span {\r\n    // If nothing above and nothing below, nothing to do.\r\n    if (!above && !below) {\r\n        return makeSpan(nucleus, 'op-over-under', type);\r\n        // return isArray(nucleus) ? makeSpan(nucleus) : nucleus;\r\n    }\r\n\r\n    let aboveShift = 0;\r\n    let belowShift = 0;\r\n\r\n    if (above) {\r\n        aboveShift = Math.max(\r\n            FONTMETRICS.bigOpSpacing1,\r\n            FONTMETRICS.bigOpSpacing3 - spanDepth(above)\r\n        );\r\n    }\r\n    if (below) {\r\n        belowShift = Math.max(\r\n            FONTMETRICS.bigOpSpacing2,\r\n            FONTMETRICS.bigOpSpacing4 - spanHeight(below)\r\n        );\r\n    }\r\n\r\n    let result = null;\r\n\r\n    if (below && above) {\r\n        const bottom =\r\n            spanHeight(below) + spanDepth(below) + spanDepth(nucleus);\r\n\r\n        result = makeVlist(\r\n            context,\r\n            [\r\n                0,\r\n                below,\r\n                belowShift,\r\n                nucleus,\r\n                aboveShift,\r\n                above,\r\n                FONTMETRICS.bigOpSpacing2,\r\n            ],\r\n            'bottom',\r\n            bottom\r\n        );\r\n    } else if (below && !above) {\r\n        const top = spanHeight(nucleus);\r\n\r\n        result = makeVlist(\r\n            context,\r\n            [0, below, belowShift, nucleus],\r\n            'top',\r\n            top\r\n        );\r\n    } else if (above && !below) {\r\n        result = makeVlist(\r\n            context,\r\n            [\r\n                spanDepth(nucleus),\r\n                nucleus,\r\n                Math.max(FONTMETRICS.bigOpSpacing2, aboveShift), // TeXBook 13a, p.444\r\n                above,\r\n            ],\r\n            'bottom',\r\n            spanDepth(nucleus)\r\n        );\r\n    }\r\n\r\n    return makeSpan(result, 'op-over-under', type);\r\n}\r\n","import {\r\n    Argument,\r\n    defineFunction,\r\n    parseArgAsString,\r\n} from './definitions-utils';\r\nimport { Atom } from '../core/atom-class';\r\nimport { AccentAtom } from '../core-atoms/accent';\r\nimport { OverunderAtom } from '../core-atoms/overunder';\r\nimport { Style } from '../public/core';\r\n\r\nconst ACCENTS = {\r\n    acute: '\\u02ca',\r\n    grave: '\\u02cb',\r\n    dot: '\\u02d9',\r\n    ddot: '\\u00a8',\r\n    mathring: '\\u02da',\r\n    tilde: '\\u007e',\r\n    bar: '\\u02c9',\r\n    breve: '\\u02d8',\r\n    check: '\\u02c7',\r\n    hat: '\\u005e',\r\n    vec: '\\u20d7',\r\n};\r\n\r\ndefineFunction(Object.keys(ACCENTS), '{body:auto}', {\r\n    createAtom: (command: string, args: Argument[], style: Style): Atom =>\r\n        new AccentAtom(command, args[0] as Atom[], {\r\n            accentChar: ACCENTS[command.slice(1)],\r\n            style,\r\n        }),\r\n});\r\n\r\ndefineFunction(['widehat', 'widecheck', 'widetilde'], '{body:auto}', {\r\n    createAtom: (command: string, args: Argument[], style: Style): Atom => {\r\n        // Pick the correct SVG template based on the length of the body\r\n        const baseString = parseArgAsString(args[0] as Atom[]);\r\n        return new AccentAtom(command, args[0] as Atom[], {\r\n            style,\r\n            svgAccent:\r\n                command.slice(1) +\r\n                (baseString.length > 5\r\n                    ? '4'\r\n                    : ['1', '1', '2', '2', '3', '3'][baseString.length]),\r\n        });\r\n    },\r\n});\r\n\r\ndefineFunction('utilde', '{body:auto}', {\r\n    createAtom: (command: string, args: Argument[], style: Style): Atom => {\r\n        const baseString = parseArgAsString(args[0] as Atom[]);\r\n        const accent =\r\n            'widetilde' +\r\n            (baseString.length > 5\r\n                ? '4'\r\n                : ['1', '1', '2', '2', '3', '3'][baseString.length]);\r\n        return new OverunderAtom(command, {\r\n            body: args[0] as Atom[],\r\n            svgBelow: accent,\r\n            style,\r\n        });\r\n    },\r\n});\r\n\r\n/*\r\n * From plain.tex\r\n *\r\n */\r\n\r\ndefineFunction('^', '{:string}', {\r\n    createAtom: (command: string, args: Argument[], style: Style): Atom =>\r\n        new Atom('mord', {\r\n            command,\r\n            isExtensibleSymbol: false,\r\n            isFunction: false,\r\n            limits: 'nolimits',\r\n            style: style,\r\n            value: args[0]\r\n                ? {\r\n                      a: '',\r\n                      e: '',\r\n                      i: '',\r\n                      o: '',\r\n                      u: '',\r\n                      A: '',\r\n                      E: '',\r\n                      I: '',\r\n                      O: '',\r\n                      U: '',\r\n                  }[args[0] as string] ?? '^'\r\n                : '^',\r\n        }),\r\n});\r\n\r\ndefineFunction('`', '{:string}', {\r\n    createAtom: (command: string, args: Argument[], style: Style): Atom =>\r\n        new Atom('mord', {\r\n            command,\r\n            isExtensibleSymbol: false,\r\n            isFunction: false,\r\n            limits: 'nolimits',\r\n            style: style,\r\n            value: args[0]\r\n                ? {\r\n                      a: '',\r\n                      e: '',\r\n                      i: '',\r\n                      o: '',\r\n                      u: '',\r\n                      A: '',\r\n                      E: '',\r\n                      I: '',\r\n                      O: '',\r\n                      U: '',\r\n                  }[args[0] as string] ?? '`'\r\n                : '`',\r\n        }),\r\n});\r\n\r\ndefineFunction(\"'\", '{:string}', {\r\n    createAtom: (command: string, args: Argument[], style: Style): Atom =>\r\n        new Atom('mord', {\r\n            command,\r\n            isExtensibleSymbol: false,\r\n            isFunction: false,\r\n            limits: 'nolimits',\r\n            style: style,\r\n            value: args[0]\r\n                ? {\r\n                      a: '',\r\n                      e: '',\r\n                      i: '',\r\n                      o: '',\r\n                      u: '',\r\n                      A: '',\r\n                      E: '',\r\n                      I: '',\r\n                      O: '',\r\n                      U: '',\r\n                  }[args[0] as string] ?? '\\u005e'\r\n                : '\\u005e',\r\n        }),\r\n});\r\n\r\ndefineFunction('~', '{:string}', {\r\n    createAtom: (command: string, args: Argument[], style: Style): Atom =>\r\n        new Atom('mord', {\r\n            command,\r\n            isExtensibleSymbol: false,\r\n            isFunction: false,\r\n            limits: 'nolimits',\r\n            style: style,\r\n            value: args[0]\r\n                ? { n: '', N: '', a: '', o: '', A: '', O: '' }[\r\n                      args[0] as string\r\n                  ] ?? '\\u00B4'\r\n                : '\\u00B4',\r\n        }),\r\n});\r\n\r\ndefineFunction('c', '{:string}', {\r\n    createAtom: (command: string, args: Argument[], style: Style): Atom =>\r\n        new Atom('mord', {\r\n            command,\r\n            isExtensibleSymbol: false,\r\n            isFunction: false,\r\n            limits: 'nolimits',\r\n            style: style,\r\n            value: args[0] ? { c: '', C: '' }[args[0] as string] ?? '' : '',\r\n        }),\r\n});\r\n","import { Atom, ToLatexOptions } from '../core/atom-class';\r\nimport { METRICS as FONTMETRICS } from '../core/font-metrics';\r\nimport {\r\n    makeSpan,\r\n    addSVGOverlay,\r\n    depth as spanDepth,\r\n    height as spanHeight,\r\n    Span,\r\n} from '../core/span';\r\nimport { Context } from '../core/context';\r\nimport { colorToString } from '../core/color';\r\nimport { Style } from '../public/core';\r\n\r\nexport type EncloseAtomOptions = {\r\n    shadow?: string;\r\n    strokeWidth?: number;\r\n    strokeStyle?: string;\r\n    svgStrokeStyle?: string;\r\n    strokeColor?: string;\r\n    borderStyle?: string;\r\n    padding?: string | number;\r\n    backgroundcolor?: string;\r\n    style: Style;\r\n};\r\nexport type Notations = {\r\n    downdiagonalstrike?: boolean;\r\n    updiagonalstrike?: boolean;\r\n    verticalstrike?: boolean;\r\n    horizontalstrike?: boolean;\r\n    right?: boolean;\r\n    bottom?: boolean;\r\n    left?: boolean;\r\n    top?: boolean;\r\n    circle?: boolean;\r\n    roundedbox?: boolean;\r\n    madruwb?: boolean;\r\n    actuarial?: boolean;\r\n    box?: boolean;\r\n};\r\n\r\nexport class EncloseAtom extends Atom {\r\n    private notation: Notations;\r\n    private shadow?: string;\r\n    private strokeWidth?: number;\r\n    private strokeStyle?: string;\r\n    private svgStrokeStyle?: string;\r\n    private strokeColor?: string;\r\n    private borderStyle?: string;\r\n\r\n    private padding?: string | number;\r\n    backgroundcolor: string;\r\n    border: string;\r\n    constructor(\r\n        command: string,\r\n        body: Atom[],\r\n        notation: Notations,\r\n        options: EncloseAtomOptions\r\n    ) {\r\n        super('enclose', { command, style: options.style });\r\n        this.body = body;\r\n        this.backgroundcolor = options.backgroundcolor;\r\n        if (notation['updiagonalarrow']) {\r\n            notation['updiagonalstrike'] = false;\r\n        }\r\n        if (notation['box']) {\r\n            notation['left'] = false;\r\n            notation['right'] = false;\r\n            notation['bottom'] = false;\r\n            notation['top'] = false;\r\n        }\r\n        this.notation = notation;\r\n        this.shadow = options.shadow;\r\n        this.strokeWidth = options.strokeWidth;\r\n        this.strokeStyle = options.strokeStyle;\r\n        this.svgStrokeStyle = options.svgStrokeStyle;\r\n        this.strokeColor = options.strokeColor;\r\n        this.borderStyle = options.borderStyle;\r\n        this.padding = options.padding;\r\n\r\n        this.captureSelection = true; // Do not let children be selected\r\n    }\r\n    toLatex(options: ToLatexOptions): string {\r\n        let result = this.command;\r\n        if (this.command === '\\\\enclose') {\r\n            result += '{' + Object.keys(this.notation).join(' ') + '}';\r\n\r\n            // \\enclose can have optional parameters...\r\n            let style = '';\r\n            let sep = '';\r\n            if (\r\n                this.backgroundcolor &&\r\n                this.backgroundcolor !== 'transparent'\r\n            ) {\r\n                style +=\r\n                    sep +\r\n                    'mathbackground=\"' +\r\n                    colorToString(this.backgroundcolor) +\r\n                    '\"';\r\n                sep = ',';\r\n            }\r\n            if (this.shadow && this.shadow !== 'auto') {\r\n                style += sep + 'shadow=\"' + this.shadow + '\"';\r\n                sep = ',';\r\n            }\r\n            if (this.strokeWidth !== 1 || this.strokeStyle !== 'solid') {\r\n                style += sep + this.borderStyle;\r\n                sep = ',';\r\n            } else if (\r\n                this.strokeColor &&\r\n                this.strokeColor !== 'currentColor'\r\n            ) {\r\n                style +=\r\n                    sep + 'mathcolor=\"' + colorToString(this.strokeColor) + '\"';\r\n                sep = ',';\r\n            }\r\n\r\n            if (style) {\r\n                result += `[${style}]`;\r\n            }\r\n        }\r\n        result += `{${this.bodyToLatex(options)}}`;\r\n        return result;\r\n    }\r\n    render(context: Context): Span[] {\r\n        const base = makeSpan(Atom.render(context, this.body), '', 'mord');\r\n\r\n        // Account for the padding\r\n        const padding =\r\n            typeof this.padding === 'number'\r\n                ? this.padding\r\n                : FONTMETRICS.fboxsep;\r\n\r\n        // The 'ML__notation' class is required to prevent the span from being omitted\r\n        // during rendering (it looks like an empty, no-op span)\r\n        const notation = makeSpan('', 'ML__notation');\r\n        notation.setStyle('position', 'absolute');\r\n        notation.setStyle(\r\n            'height',\r\n            spanHeight(base) + spanDepth(base) + 2 * padding,\r\n            'em'\r\n        );\r\n        notation.height = spanHeight(base) + padding;\r\n        notation.depth = spanDepth(base) + padding;\r\n        if (padding !== 0) {\r\n            notation.setStyle('width', 'calc(100% + ' + 2 * padding + 'em)');\r\n        } else {\r\n            notation.setStyle('width', '100%');\r\n        }\r\n        notation.setStyle('top', -padding, 'em');\r\n        notation.setStyle('left', -padding, 'em');\r\n        notation.setStyle('z-index', '-1'); // Ensure the box is *behind* the base\r\n        if (this.backgroundcolor) {\r\n            notation.setStyle('background-color', this.backgroundcolor);\r\n        }\r\n\r\n        if (this.notation.box) notation.setStyle('border', this.borderStyle);\r\n        if (this.notation.actuarial) {\r\n            notation.setStyle('border-top', this.borderStyle);\r\n            notation.setStyle('border-right', this.borderStyle);\r\n        }\r\n        if (this.notation.madruwb) {\r\n            notation.setStyle('border-bottom', this.borderStyle);\r\n            notation.setStyle('border-right', this.borderStyle);\r\n        }\r\n        if (this.notation.roundedbox) {\r\n            notation.setStyle(\r\n                'border-radius',\r\n                (spanHeight(base) + spanDepth(base)) / 2,\r\n                'em'\r\n            );\r\n            notation.setStyle('border', this.borderStyle);\r\n        }\r\n        if (this.notation.circle) {\r\n            notation.setStyle('border-radius', '50%');\r\n            notation.setStyle('border', this.borderStyle);\r\n        }\r\n        if (this.notation.top) {\r\n            notation.setStyle('border-top', this.borderStyle);\r\n        }\r\n        if (this.notation.left) {\r\n            notation.setStyle('border-left', this.borderStyle);\r\n        }\r\n        if (this.notation.right) {\r\n            notation.setStyle('border-right', this.borderStyle);\r\n        }\r\n        if (this.notation.bottom) {\r\n            notation.setStyle('border-bottom', this.borderStyle);\r\n        }\r\n\r\n        let svg = '';\r\n\r\n        if (this.notation.horizontalstrike) {\r\n            svg += '<line x1=\"3%\"  y1=\"50%\" x2=\"97%\" y2=\"50%\"';\r\n            svg += ` stroke-width=\"${this.strokeWidth}\" stroke=\"${this.strokeColor}\"`;\r\n            svg += ' stroke-linecap=\"round\"';\r\n            if (this.svgStrokeStyle) {\r\n                svg += ` stroke-dasharray=\"${this.svgStrokeStyle}\"`;\r\n            }\r\n            svg += '/>';\r\n        }\r\n        if (this.notation.verticalstrike) {\r\n            svg += '<line x1=\"50%\"  y1=\"3%\" x2=\"50%\" y2=\"97%\"';\r\n            svg += ` stroke-width=\"${this.strokeWidth}\" stroke=\"${this.strokeColor}\"`;\r\n            svg += ' stroke-linecap=\"round\"';\r\n            if (this.svgStrokeStyle) {\r\n                svg += ` stroke-dasharray=\"${this.svgStrokeStyle}\"`;\r\n            }\r\n            svg += '/>';\r\n        }\r\n        if (this.notation.updiagonalstrike) {\r\n            svg += '<line x1=\"3%\"  y1=\"97%\" x2=\"97%\" y2=\"3%\"';\r\n            svg += ` stroke-width=\"${this.strokeWidth}\" stroke=\"${this.strokeColor}\"`;\r\n            svg += ' stroke-linecap=\"round\"';\r\n            if (this.svgStrokeStyle) {\r\n                svg += ` stroke-dasharray=\"${this.svgStrokeStyle}\"`;\r\n            }\r\n            svg += '/>';\r\n        }\r\n        if (this.notation.downdiagonalstrike) {\r\n            svg += '<line x1=\"3%\"  y1=\"3%\" x2=\"97%\" y2=\"97%\"';\r\n            svg += ` stroke-width=\"${this.strokeWidth}\" stroke=\"${this.strokeColor}\"`;\r\n            svg += ' stroke-linecap=\"round\"';\r\n            if (this.svgStrokeStyle) {\r\n                svg += ` stroke-dasharray=\"${this.svgStrokeStyle}\"`;\r\n            }\r\n            svg += '/>';\r\n        }\r\n        // if (this.notation.updiagonalarrow) {\r\n        //     const t = 1;\r\n        //     const length = Math.sqrt(w * w + h * h);\r\n        //     const f = 1 / length / 0.075 * t;\r\n        //     const wf = w * f;\r\n        //     const hf = h * f;\r\n        //     const x = w - t / 2;\r\n        //     let y = t / 2;\r\n        //     if (y + hf - .4 * wf < 0 ) y = 0.4 * wf - hf;\r\n        //     svg += '<line ';\r\n        //     svg += `x1=\"1\" y1=\"${h - 1}px\" x2=\"${x - .7 * wf}px\" y2=\"${y + .7 * hf}px\"`;\r\n        //     svg += ` stroke-width=\"${this.strokeWidth}\" stroke=\"${this.strokeColor}\"`;\r\n        //     svg += ' stroke-linecap=\"round\"';\r\n        //     if (this.svgStrokeStyle) {\r\n        //         svg += ` stroke-dasharray=\"${this.svgStrokeStyle}\"`;\r\n        //     }\r\n        //     svg += '/>';\r\n        //     svg += '<polygon points=\"';\r\n        //     svg += `${x},${y} ${x - wf - .4 * hf},${y + hf - .4 * wf} `;\r\n        //     svg += `${x - .7 * wf},${y + .7 * hf} ${x - wf + .4 * hf},${y + hf + .4 * wf} `;\r\n        //     svg += `${x},${y}`;\r\n        //     svg += `\" stroke='none' fill=\"${this.strokeColor}\"`;\r\n        //     svg += '/>';\r\n        // }\r\n        // if (this.notation.phasorangle) {\r\n        //     svg += '<path d=\"';\r\n        //     svg += `M ${h / 2},1 L1,${h} L${w},${h} \"`;\r\n        //     svg += ` stroke-width=\"${this.strokeWidth}\" stroke=\"${this.strokeColor}\" fill=\"none\"`;\r\n        //     if (this.svgStrokeStyle) {\r\n        //         svg += ' stroke-linecap=\"round\"';\r\n        //         svg += ` stroke-dasharray=\"${this.svgStrokeStyle}\"`;\r\n        //     }\r\n        //     svg += '/>';\r\n        // }\r\n        // if (this.notation.radical) {\r\n        //     svg += '<path d=\"';\r\n        //     svg += `M 0,${.6 * h} L1,${h} L${emToPx(padding) * 2},1 \"`;\r\n        //     svg += ` stroke-width=\"${this.strokeWidth}\" stroke=\"${this.strokeColor}\" fill=\"none\"`;\r\n        //     if (this.svgStrokeStyle) {\r\n        //         svg += ' stroke-linecap=\"round\"';\r\n        //         svg += ` stroke-dasharray=\"${this.svgStrokeStyle}\"`;\r\n        //     }\r\n        //     svg += '/>';\r\n        // }\r\n        // if (this.notation.longdiv) {\r\n        //     svg += '<path d=\"';\r\n        //     svg += `M ${w} 1 L1 1 a${emToPx(padding)} ${h / 2}, 0, 0, 1, 1 ${h} \"`;\r\n        //     svg += ` stroke-width=\"${this.strokeWidth}\" stroke=\"${this.strokeColor}\" fill=\"none\"`;\r\n        //     if (this.svgStrokeStyle) {\r\n        //         svg += ' stroke-linecap=\"round\"';\r\n        //         svg += ` stroke-dasharray=\"${this.svgStrokeStyle}\"`;\r\n        //     }\r\n        //     svg += '/>';\r\n        // }\r\n        if (svg) {\r\n            let svgStyle;\r\n            if (this.shadow !== 'none') {\r\n                if (this.shadow === 'auto') {\r\n                    svgStyle =\r\n                        'filter: drop-shadow(0 0 .5px rgba(255, 255, 255, .7)) drop-shadow(1px 1px 2px #333)';\r\n                } else {\r\n                    svgStyle = 'filter: drop-shadow(' + this.shadow + ')';\r\n                }\r\n            }\r\n            addSVGOverlay(notation, svg, svgStyle);\r\n        }\r\n        const result = makeSpan([notation, base]);\r\n        // Set its position as relative so that the box can be absolute positioned\r\n        // over the base\r\n        result.setStyle('position', 'relative');\r\n        result.setStyle('display', 'inline');\r\n\r\n        // The padding adds to the width and height of the pod\r\n        result.height = spanHeight(base) + padding;\r\n        result.depth = spanDepth(base) + padding;\r\n        result.left = padding;\r\n        result.right = padding;\r\n\r\n        if (this.caret) result.caret = this.caret;\r\n\r\n        return [result];\r\n    }\r\n}\r\n","import { Argument, defineFunction } from './definitions-utils';\r\nimport { convertDimenToPx } from '../core/font-metrics';\r\nimport type { Atom } from '../core/atom-class';\r\nimport { EncloseAtom, EncloseAtomOptions } from '../core-atoms/enclose';\r\nimport { Style } from '../public/core';\r\n\r\n// \\enclose, a MathJax extension mapping to the MathML `menclose` tag.\r\n// The first argument is a comma delimited list of notations, as defined\r\n// here: https://developer.mozilla.org/en-US/docs/Web/MathML/Element/menclose\r\n// The second, optional, specifies the style to use for the notations.\r\ndefineFunction('enclose', '{notation:string}[style:string]{body:auto}', {\r\n    createAtom: (command: string, args: Argument[], style: Style): Atom => {\r\n        const options: EncloseAtomOptions = {\r\n            strokeColor: 'currentColor',\r\n            strokeWidth: 1,\r\n            strokeStyle: 'solid',\r\n            backgroundcolor: 'transparent',\r\n            padding: 'auto',\r\n            shadow: 'auto',\r\n            svgStrokeStyle: undefined,\r\n            borderStyle: undefined,\r\n            style,\r\n        };\r\n\r\n        // Extract info from style string\r\n        if (args[1]) {\r\n            // Split the string by comma delimited sub-strings, ignoring commas\r\n            // that may be inside (). For example\"x, rgb(a, b, c)\" would return\r\n            // ['x', 'rgb(a, b, c)']\r\n            const styles = (args[1] as string).split(\r\n                /,(?![^(]*\\)(?:(?:[^(]*\\)){2})*[^\"]*$)/\r\n            );\r\n            for (const s of styles) {\r\n                const shorthand = s.match(/\\s*(\\S+)\\s+(\\S+)\\s+(.*)/);\r\n                if (shorthand) {\r\n                    options.strokeWidth = convertDimenToPx(shorthand[1], 'px');\r\n                    if (!isFinite(options.strokeWidth)) {\r\n                        options.strokeWidth = 1;\r\n                    }\r\n                    options.strokeStyle = shorthand[2];\r\n                    options.strokeColor = shorthand[3];\r\n                } else {\r\n                    const attribute = s.match(/\\s*([a-z]*)\\s*=\\s*\"(.*)\"/);\r\n                    if (attribute) {\r\n                        if (attribute[1] === 'mathbackground') {\r\n                            options.backgroundcolor = attribute[2];\r\n                        } else if (attribute[1] === 'mathcolor') {\r\n                            options.strokeColor = attribute[2];\r\n                        } else if (attribute[1] === 'padding') {\r\n                            options.padding = convertDimenToPx(\r\n                                attribute[2],\r\n                                'px'\r\n                            );\r\n                        } else if (attribute[1] === 'shadow') {\r\n                            options.shadow = attribute[2];\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            if (options.strokeStyle === 'dashed') {\r\n                options.svgStrokeStyle = '5,5';\r\n            } else if (options.strokeStyle === 'dotted') {\r\n                options.svgStrokeStyle = '1,5';\r\n            }\r\n        }\r\n        options.borderStyle =\r\n            options.strokeWidth +\r\n            'px ' +\r\n            options.strokeStyle +\r\n            ' ' +\r\n            options.strokeColor;\r\n\r\n        // Normalize the list of notations.\r\n        const notation = {};\r\n        ((args[0] as string) ?? '')\r\n            .split(/[, ]/)\r\n            .filter((v) => v.length > 0)\r\n            .forEach((x) => {\r\n                notation[x.toLowerCase()] = true;\r\n            });\r\n\r\n        return new EncloseAtom(command, args[2] as Atom[], notation, options);\r\n    },\r\n});\r\n\r\ndefineFunction('cancel', '{body:auto}', {\r\n    createAtom: (name: string, args: Argument[], style: Style): Atom =>\r\n        new EncloseAtom(\r\n            name,\r\n            args[0] as Atom[],\r\n            { updiagonalstrike: true },\r\n            {\r\n                strokeColor: 'currentColor',\r\n                strokeWidth: 1,\r\n                strokeStyle: 'solid',\r\n                borderStyle: '1px solid currentColor',\r\n                backgroundcolor: 'transparent',\r\n                padding: 'auto',\r\n                shadow: 'auto',\r\n                style,\r\n            }\r\n        ),\r\n});\r\n\r\ndefineFunction('bcancel', '{body:auto}', {\r\n    createAtom: (name: string, args: Argument[], style: Style): Atom =>\r\n        new EncloseAtom(\r\n            name,\r\n            args[0] as Atom[],\r\n            { downdiagonalstrike: true },\r\n            {\r\n                strokeColor: 'currentColor',\r\n                strokeWidth: 1,\r\n                strokeStyle: 'solid',\r\n                borderStyle: '1px solid currentColor',\r\n                backgroundcolor: 'transparent',\r\n                padding: 'auto',\r\n                shadow: 'auto',\r\n                style,\r\n            }\r\n        ),\r\n});\r\n\r\ndefineFunction('xcancel', '{body:auto}', {\r\n    createAtom: (name: string, args: Argument[], style: Style): Atom =>\r\n        new EncloseAtom(\r\n            name,\r\n            args[0] as Atom[],\r\n            { updiagonalstrike: true, downdiagonalstrike: true },\r\n            {\r\n                strokeColor: 'currentColor',\r\n                strokeWidth: 1,\r\n                strokeStyle: 'solid',\r\n                borderStyle: '1px solid currentColor',\r\n                backgroundcolor: 'transparent',\r\n                padding: 'auto',\r\n                shadow: 'auto',\r\n                style,\r\n            }\r\n        ),\r\n});\r\n","import {\r\n    Atom,\r\n    Branch,\r\n    isNamedBranch,\r\n    ToLatexOptions,\r\n} from '../core/atom-class';\r\nimport {\r\n    makeSpan,\r\n    makeVlist,\r\n    depth as spanDepth,\r\n    height as spanHeight,\r\n    Span,\r\n} from '../core/span';\r\nimport { METRICS as FONTMETRICS } from '../core/font-metrics';\r\nimport { makeLeftRightDelim } from '../core/delimiters';\r\nimport { MathStyleName, MATHSTYLES } from '../core/mathstyle';\r\nimport { Context } from '../core/context';\r\nimport { joinLatex } from '../core/tokenizer';\r\n\r\nexport type Colspec = {\r\n    gap?: number | Atom[];\r\n    // 'm' is a special alignement for multline: left on first row, right on last\r\n    // row, centered otherwise\r\n    align?: 'l' | 'c' | 'r' | 'm';\r\n    rule?: boolean;\r\n};\r\n\r\nexport type ArrayAtomConstructorOptions = {\r\n    // params: FunctionArgumentDefiniton[];\r\n    // parser: ParseFunction;\r\n    mathStyleName?: MathStyleName;\r\n    colFormat?: Colspec[];\r\n    leftDelim?: string;\r\n    rightDelim?: string;\r\n    jot?: number; // Jot is an extra gap between lines of numbered equation.\r\n    // It's 3pt by default in LaTeX (ltmath.dtx:181)\r\n    arraystretch?: number;\r\n    arraycolsep?: number;\r\n};\r\n\r\ntype ArrayRow = {\r\n    cells: Span[][];\r\n    height: number;\r\n    depth: number;\r\n    pos: number;\r\n};\r\n\r\nexport class ArrayAtom extends Atom {\r\n    array: Atom[][][];\r\n    environmentName: string;\r\n    arraystretch?: number;\r\n    arraycolsep?: number;\r\n    jot?: number;\r\n    rowGaps?: number[];\r\n    colFormat?: Colspec[];\r\n    leftDelim?: string;\r\n    rightDelim?: string;\r\n    mathStyleName?: MathStyleName;\r\n    constructor(\r\n        envName: string,\r\n        array: Atom[][][],\r\n        rowGaps: number[],\r\n        options: ArrayAtomConstructorOptions = {}\r\n    ) {\r\n        super('array');\r\n        this.environmentName = envName;\r\n        this.array = array;\r\n        this.rowGaps = rowGaps;\r\n        if (options.mathStyleName) this.mathStyleName = options.mathStyleName;\r\n        if (options.colFormat) this.colFormat = options.colFormat;\r\n        if (options.leftDelim) this.leftDelim = options.leftDelim;\r\n        if (options.rightDelim) this.rightDelim = options.rightDelim;\r\n        if (options.jot) this.jot = options.jot;\r\n        if (options.arraycolsep) this.arraycolsep = options.arraycolsep;\r\n    }\r\n    removeBranch(name: Branch): Atom[] {\r\n        if (isNamedBranch(name)) {\r\n            return super.removeBranch(name);\r\n        }\r\n        const children = this.branch(name);\r\n        this.array[name[0]][name[1]] = null;\r\n        children.forEach((x) => {\r\n            x.parent = null;\r\n            x.treeBranch = undefined;\r\n        });\r\n        // Drop the 'first' element\r\n        console.assert(children[0].type === 'first');\r\n        children.shift();\r\n        this.isDirty = true;\r\n        return children;\r\n    }\r\n    render(context: Context): Span[] | null {\r\n        // See http://tug.ctan.org/macros/latex/base/ltfsstrc.dtx\r\n        // and http://tug.ctan.org/macros/latex/base/lttab.dtx\r\n        let colFormat = this.colFormat;\r\n        if (colFormat && colFormat.length === 0) {\r\n            colFormat = [{ align: 'l' }];\r\n        }\r\n        if (!colFormat) {\r\n            colFormat = [\r\n                { align: 'l' },\r\n                { align: 'l' },\r\n                { align: 'l' },\r\n                { align: 'l' },\r\n                { align: 'l' },\r\n                { align: 'l' },\r\n                { align: 'l' },\r\n                { align: 'l' },\r\n                { align: 'l' },\r\n                { align: 'l' },\r\n            ];\r\n        }\r\n        // Fold the array so that there are no more columns of content than\r\n        // there are columns prescribed by the column format.\r\n        const array = [];\r\n        let colMax = 0; // Maximum number of columns of content\r\n        for (const colSpec of colFormat) {\r\n            if (colSpec.align) colMax++;\r\n        }\r\n        for (const row of this.array) {\r\n            let colIndex = 0;\r\n            while (colIndex < row.length) {\r\n                const newRow = [];\r\n                const lastCol = Math.min(row.length, colIndex + colMax);\r\n                while (colIndex < lastCol) {\r\n                    newRow.push(row[colIndex++]);\r\n                }\r\n                array.push(newRow);\r\n            }\r\n        }\r\n        // If the last row is empty, ignore it.\r\n        if (\r\n            array[array.length - 1].length === 1 &&\r\n            array[array.length - 1][0].length === 0\r\n        ) {\r\n            array.pop();\r\n        }\r\n        const mathstyle = this.mathStyleName\r\n            ? MATHSTYLES[this.mathStyleName]\r\n            : context.mathstyle;\r\n        // Row spacing\r\n        // Default \\arraystretch from lttab.dtx\r\n        const arraystretch = this.arraystretch || 1;\r\n        const arraycolsep =\r\n            typeof this.arraycolsep === 'number'\r\n                ? this.arraycolsep\r\n                : FONTMETRICS.arraycolsep;\r\n        const arrayskip = arraystretch * FONTMETRICS.baselineskip;\r\n        const arstrutHeight = 0.7 * arrayskip;\r\n        const arstrutDepth = 0.3 * arrayskip; // \\@arstrutbox in lttab.dtx\r\n        let totalHeight = 0;\r\n        let nc = 0;\r\n        const body = [];\r\n        const nr = array.length;\r\n        for (let r = 0; r < nr; ++r) {\r\n            const inrow = array[r];\r\n            nc = Math.max(nc, inrow.length);\r\n            let height = arstrutHeight; // \\@array adds an \\@arstrut\r\n            let depth = arstrutDepth; // to each row (via the template)\r\n            const outrow: ArrayRow = { cells: [], height: 0, depth: 0, pos: 0 };\r\n            for (let c = 0; c < inrow.length; ++c) {\r\n                const localContext = context.clone({\r\n                    mathstyle: MATHSTYLES[this.mathStyleName],\r\n                });\r\n                const cell = Atom.render(localContext, inrow[c]) || [];\r\n                const elt = [makeSpan(null, '', 'mord')].concat(cell);\r\n                depth = Math.max(depth, spanDepth(elt));\r\n                height = Math.max(height, spanHeight(elt));\r\n                outrow.cells.push(elt);\r\n            }\r\n            let jot = r === nr - 1 ? 0 : this.jot || 0;\r\n            if (this.rowGaps?.[r]) {\r\n                jot = this.rowGaps[r];\r\n                if (jot > 0) {\r\n                    // \\@argarraycr\r\n                    jot += arstrutDepth;\r\n                    if (depth < jot) {\r\n                        depth = jot; // \\@xargarraycr\r\n                    }\r\n                    jot = 0;\r\n                }\r\n            }\r\n            outrow.height = height;\r\n            outrow.depth = depth;\r\n            totalHeight += height;\r\n            outrow.pos = totalHeight;\r\n            totalHeight += depth + jot; // \\@yargarraycr\r\n            body.push(outrow);\r\n        }\r\n        const offset = totalHeight / 2 + mathstyle.metrics.axisHeight;\r\n        const contentCols = [];\r\n        for (let colIndex = 0; colIndex < nc; colIndex++) {\r\n            const col = [];\r\n            for (const row of body) {\r\n                const elem = row.cells[colIndex];\r\n                if (!elem) {\r\n                    continue;\r\n                }\r\n                elem.depth = row.depth;\r\n                elem.height = row.height;\r\n\r\n                col.push(elem);\r\n                col.push(row.pos - offset);\r\n            }\r\n            if (col.length > 0) {\r\n                contentCols.push(makeVlist(context, col, 'individualShift'));\r\n            }\r\n        }\r\n        // Iterate over each column description.\r\n        // Each `colDesc` will indicate whether to insert a gap, a rule or\r\n        // a column from 'contentCols'\r\n        const cols = [];\r\n        let prevColContent = false;\r\n        let prevColRule = false;\r\n        let currentContentCol = 0;\r\n        let firstColumn = !this.leftDelim;\r\n        for (const colDesc of colFormat) {\r\n            if (colDesc.align && currentContentCol >= contentCols.length) {\r\n                break;\r\n            } else if (\r\n                colDesc.align &&\r\n                currentContentCol < contentCols.length\r\n            ) {\r\n                // If an alignment is specified, insert a column of content\r\n                if (prevColContent) {\r\n                    // If no gap was provided, insert a default gap between\r\n                    // consecutive columns of content\r\n                    cols.push(makeColGap(2 * arraycolsep));\r\n                } else if (prevColRule || firstColumn) {\r\n                    // If the previous column was a rule or this is the first column\r\n                    // add a smaller gap\r\n                    cols.push(makeColGap(arraycolsep));\r\n                }\r\n                cols.push(\r\n                    makeSpan(\r\n                        contentCols[currentContentCol],\r\n                        'col-align-' + colDesc.align\r\n                    )\r\n                );\r\n                currentContentCol++;\r\n                prevColContent = true;\r\n                prevColRule = false;\r\n                firstColumn = false;\r\n            } else if (typeof colDesc.gap !== 'undefined') {\r\n                // Something to insert in between columns of content\r\n                if (typeof colDesc.gap === 'number') {\r\n                    // It's a number, indicating how much space, in em,\r\n                    // to leave in between columns\r\n                    cols.push(makeColGap(colDesc.gap));\r\n                } else {\r\n                    // It's a mathlist\r\n                    // Create a column made up of the mathlist\r\n                    // as many times as there are rows.\r\n                    cols.push(\r\n                        makeColOfRepeatingElements(\r\n                            context,\r\n                            body,\r\n                            offset,\r\n                            colDesc.gap\r\n                        )\r\n                    );\r\n                }\r\n                prevColContent = false;\r\n                prevColRule = false;\r\n                firstColumn = false;\r\n            } else if (colDesc.rule) {\r\n                // It's a rule.\r\n                const separator = makeSpan(null, 'vertical-separator');\r\n                separator.setStyle('height', totalHeight, 'em');\r\n                // result.setTop((1 - context.mathstyle.sizeMultiplier) *\r\n                //     context.mathstyle.metrics.axisHeight);\r\n                separator.setStyle(\r\n                    'margin-top',\r\n                    3 * context.mathstyle.metrics.axisHeight - offset,\r\n                    'em'\r\n                );\r\n                separator.setStyle('vertical-align', 'top');\r\n                // separator.setStyle('display', 'inline-block');\r\n                let gap = 0;\r\n                if (prevColRule) {\r\n                    gap =\r\n                        FONTMETRICS.doubleRuleSep - FONTMETRICS.arrayrulewidth;\r\n                } else if (prevColContent) {\r\n                    gap = arraycolsep - FONTMETRICS.arrayrulewidth;\r\n                }\r\n                separator.left = gap;\r\n                cols.push(separator);\r\n                prevColContent = false;\r\n                prevColRule = true;\r\n                firstColumn = false;\r\n            }\r\n        }\r\n        if (prevColContent && !this.rightDelim) {\r\n            // If the last column was content, add a small gap\r\n            cols.push(makeColGap(arraycolsep));\r\n        }\r\n        if (\r\n            (!this.leftDelim || this.leftDelim === '.') &&\r\n            (!this.rightDelim || this.rightDelim === '.')\r\n        ) {\r\n            // There are no delimiters around the array, just return what\r\n            // we've built so far.\r\n            return [makeSpan(cols, 'mtable', 'mord')];\r\n        }\r\n        // There is at least one delimiter. Wrap the core of the array with\r\n        // appropriate left and right delimiters\r\n        // const inner = makeSpan(makeSpan(cols, 'mtable'), 'mord');\r\n        const inner = makeSpan(cols, 'mtable');\r\n        const innerHeight = spanHeight(inner);\r\n        const innerDepth = spanDepth(inner);\r\n        const result = this.bind(\r\n            context,\r\n            makeSpan(\r\n                [\r\n                    this.bind(\r\n                        context,\r\n                        makeLeftRightDelim(\r\n                            'mopen',\r\n                            this.leftDelim,\r\n                            innerHeight,\r\n                            innerDepth,\r\n                            context\r\n                        )\r\n                    ),\r\n                    inner,\r\n                    this.bind(\r\n                        context,\r\n                        makeLeftRightDelim(\r\n                            'mclose',\r\n                            this.rightDelim,\r\n                            innerHeight,\r\n                            innerDepth,\r\n                            context\r\n                        )\r\n                    ),\r\n                ],\r\n                '',\r\n                'mord'\r\n            )\r\n        );\r\n        if (this.caret) result.caret = this.caret;\r\n\r\n        return [this.attachSupsub(context, result, result.type)];\r\n    }\r\n    toLatex(options: ToLatexOptions): string {\r\n        let result = '\\\\begin{' + this.environmentName + '}';\r\n        if (this.environmentName === 'array') {\r\n            result += '{';\r\n            if (typeof this.colFormat !== 'undefined') {\r\n                for (let i = 0; i < this.colFormat.length; i++) {\r\n                    if (this.colFormat[i].align) {\r\n                        result += this.colFormat[i].align;\r\n                    } else if (this.colFormat[i].rule) {\r\n                        result += '|';\r\n                    }\r\n                }\r\n            }\r\n            result += '}';\r\n        }\r\n        for (let row = 0; row < this.array.length; row++) {\r\n            for (let col = 0; col < this.array[row].length; col++) {\r\n                if (col > 0) result += ' & ';\r\n                result = joinLatex([\r\n                    result,\r\n                    Atom.toLatex(this.array[row][col], options),\r\n                ]);\r\n            }\r\n            // Adds a separator between rows (but not after the last row)\r\n            if (row < this.array.length - 1) {\r\n                result += ' \\\\\\\\ ';\r\n            }\r\n        }\r\n        result += '\\\\end{' + this.environmentName + '}';\r\n\r\n        return result;\r\n    }\r\n    addChild(_child: Atom, _branch: Branch): void {\r\n        return;\r\n    }\r\n    addChildBefore(_child: Atom, _before: Atom): void {\r\n        return;\r\n    }\r\n    addChildAfter(_child: Atom, _after: Atom): void {\r\n        return;\r\n    }\r\n    addChildrenAfter(_children: Atom[], _after: Atom): void {\r\n        return;\r\n    }\r\n    removeChild(_child: Atom): void {\r\n        return;\r\n    }\r\n    getCell(row: number, col: number): Atom[] {\r\n        return this.array[row][col];\r\n    }\r\n    setCell(_row: number, _column: number, _value: Atom[]): void {\r\n        // @todo array\r\n        console.assert(this.type === 'array' && Array.isArray(this.array));\r\n        this.isDirty = true;\r\n    }\r\n    addRowBefore(_row: number): void {\r\n        console.assert(this.type === 'array' && Array.isArray(this.array));\r\n        // @todo array\r\n        this.isDirty = true;\r\n    }\r\n    addRowAfter(_row: number): void {\r\n        console.assert(this.type === 'array' && Array.isArray(this.array));\r\n        // @todo array\r\n        this.isDirty = true;\r\n    }\r\n    addColumnBefore(_col: number): void {\r\n        console.assert(this.type === 'array' && Array.isArray(this.array));\r\n        this.isDirty = true;\r\n    }\r\n    addColumnAfter(_col: number): void {\r\n        console.assert(this.type === 'array' && Array.isArray(this.array));\r\n        // @todo array\r\n        this.isDirty = true;\r\n    }\r\n    get cells(): Atom[][] {\r\n        const result = [];\r\n        this.array.forEach((row) => {\r\n            row.forEach((cell) => {\r\n                cell.forEach((x) => {\r\n                    result.push(x);\r\n                });\r\n            });\r\n        });\r\n        return result;\r\n    }\r\n\r\n    get children(): Atom[] {\r\n        let result = [];\r\n        this.array.forEach((row) => {\r\n            row.forEach((col) => {\r\n                col.forEach((x) => {\r\n                    result = [...result, ...x.children];\r\n                });\r\n            });\r\n        });\r\n        return [...result, ...super.children];\r\n    }\r\n}\r\n/**\r\n * Create a column separator span.\r\n *\r\n */\r\nfunction makeColGap(width: number): Span {\r\n    const separator = makeSpan('\\u200b', 'arraycolsep');\r\n    separator.width = width;\r\n    return separator;\r\n}\r\n\r\n/**\r\n * Create a column of repeating elements.\r\n */\r\nfunction makeColOfRepeatingElements(\r\n    context: Context,\r\n    rows: ArrayRow[],\r\n    offset: number,\r\n    elem: Atom[]\r\n): Span {\r\n    const col = [];\r\n    for (const row of rows) {\r\n        const cell = makeSpan(Atom.render(context, elem));\r\n        cell.depth = row.depth;\r\n        cell.height = row.height;\r\n        col.push(cell);\r\n        col.push(row.pos - offset);\r\n    }\r\n    return makeVlist(context, col, 'individualShift');\r\n}\r\n","import {\r\n    defineEnvironment,\r\n    defineTabularEnvironment,\r\n} from './definitions-utils';\r\nimport type { Atom } from '../core/atom-class';\r\nimport { ArrayAtom, Colspec } from '../core-atoms/array';\r\n\r\n/*\r\n\r\nSee http://texdoc.net/texmf-dist/doc/latex/amsmath/amsldoc.pdf\r\n\r\n<columns> ::= <column>*<line>\r\n<column> ::= <line>('l'|'c'|'r')\r\n<line> ::= '|' | '||' | ''\r\n\r\n'math',\r\n                frequency 0\r\n'displaymath',\r\n                frequency 8\r\n\r\n'equation'      centered, numbered\r\n                frequency 8\r\n\r\n'subequations'   with an 'equation' environment, appends a letter to eq no\r\n                frequency 1\r\n\r\n'array',        {columns:text}\r\n                cells are textstyle math\r\n                no fence\r\n\r\n'eqnarray'      DEPRECATED see http://www.tug.org/pracjourn/2006-4/madsen/madsen.pdf\r\n                {rcl}\r\n                first and last cell in each row is displaystyle math\r\n                each cell has a margin of \\arraycolsep\r\n                Each line has a eqno\r\n                frequency 7\r\n\r\n\r\n'theorem'       text mode. Prepends in bold 'Theorem <counter>', then body in italics.\r\n\r\n'multline'      single column\r\n                first row left aligned, last right aligned, others centered\r\n                last line has an eqn. counter. multline* will omit the counter\r\n                no output if inside an equation\r\n                \r\n\r\n'gather'        at most two columns\r\n                first column centered, second column right aligned\r\n                frequency 1\r\n\r\n'gathered'      must be in equation environment\r\n                single column,\r\n                centered\r\n                frequency: COMMON\r\n                optional argument: [b], [t] to vertical align\r\n\r\n'align'        multiple columns,\r\n                alternating rl\r\n                there is some 'space' (additional column?) between each pair\r\n                each line is numbered (except when inside an equation environment)\r\n                there is an implicit {} at the beginning of left columns\r\n\r\n'aligned'      must be in equation environment\r\n                frequency: COMMON\r\n                @{}r@{}l@{\\quad}@{}r@{}l@{}\r\n\r\n'split'         must be in an equation environment,\r\n                two columns, additional columns are interpreted as line breaks\r\n                first column is right aligned, second column is left aligned\r\n                entire construct is numbered (as opposed to 'align' where each line is numbered)\r\n                frequency: 0\r\n\r\n\r\n'alignedat'\r\nFrom AMSMath:\r\n---The alignedat environment was changed to take two arguments rather\r\nthan one: a mandatory argument (as formerly) specifying the number of\r\nalign structures, and a new optional one specifying the placement of the\r\nenvironment (parallel to the optional argument of aligned). However,\r\naligned is simpler to use, allowing any number of aligned structures\r\nautomatically, and therefore the use of alignedat is deprecated.\r\n\r\n\r\n 'alignat'      {pairs:number}\r\n                {rl} alternating as many times as indicated by <pairs> arg\r\n                no space between column pairs (unlike align)\r\n                there is an implicit {} at the beginning of left columns\r\n                frequency: 0\r\n\r\n 'flalign'      multiple columns\r\n                alternate rl\r\n                third column further away than align...?\r\n                frequency: 0\r\n\r\n\r\n'matrix'        at most 10 columns\r\n                cells centered\r\n                no fence\r\n                no colsep at beginning or end\r\n                (mathtools package add an optional arg for the cell alignment)\r\n                frequency: COMMON\r\n\r\n'pmatrix'       fence: ()\r\n                frequency: COMMON\r\n\r\n'bmatrix'       fence: []\r\n                frequency: COMMON\r\n\r\n'Bmatrix'       fence: {}\r\n                frequency: 237\r\n\r\n'vmatrix'       fence: \\vert\r\n                frequency: 368\r\n\r\n'Vmatrix'       fence: \\Vert\r\n                frequency: 41\r\n\r\n'smallmatrix'   displaystyle: scriptstyle (?)\r\n                frequency: 279\r\n\r\n'cases'\r\n                frequency: COMMON\r\n                l@{2}l\r\n\r\n'center'        text mode only?\r\n                frequency: ?\r\n*/\r\n// See https://en.wikibooks.org/wiki/LaTeX/Mathematics\r\n// and http://www.ele.uri.edu/faculty/vetter/Other-stuff/latex/Mathmode.pdf\r\n\r\n/*\r\nThe star at the end of the name of a displayed math environment causes that\r\nthe formula lines won't be numbered. Otherwise they would automatically get a number.\r\n\r\n\\notag will also turn off the numbering.\r\n\\shoveright and \\shoveleft will force alignment of a line\r\n\r\nThe only difference between align and equation is the spacing of the formulas.\r\nYou should attempt to use equation when possible, and align when you have multi-line formulas.\r\nEquation will have space before/after < 1em if line before/after is short enough.\r\n\r\nAlso: equation throws an error when you have an & inside the environment,\r\nso look out for that when converting between the two.\r\n\r\n\r\n\r\nWhereas align produces a structure whose width is the full line width, aligned\r\ngives a width that is the actual width of the contents, thus it can be used as\r\na component in a containing expression, e.g. for putting the entire alignment\r\nin a parenthesis\r\n*/\r\ndefineEnvironment(\r\n    'math',\r\n    '',\r\n    (name: string, array: Atom[][][], rowGaps: number[]): Atom =>\r\n        new ArrayAtom(name, array, rowGaps, { mathStyleName: 'textstyle' })\r\n);\r\n\r\ndefineEnvironment(\r\n    'displaymath',\r\n    '',\r\n    (name: string, array: Atom[][][], rowGaps: number[]): Atom =>\r\n        new ArrayAtom(name, array, rowGaps, { mathStyleName: 'textstyle' })\r\n);\r\n\r\ndefineTabularEnvironment(\r\n    'array',\r\n    '{columns:colspec}',\r\n    (name: string, array: Atom[][][], rowGaps: number[], args): Atom =>\r\n        new ArrayAtom(name, array, rowGaps, {\r\n            colFormat: args[0] as Colspec[],\r\n            mathStyleName: 'textstyle',\r\n        })\r\n);\r\n\r\ndefineTabularEnvironment(\r\n    ['equation', 'equation', 'subequations'],\r\n    '',\r\n    (name: string, array: Atom[][][], rowGaps: number[]): Atom =>\r\n        new ArrayAtom(name, array, rowGaps, {\r\n            colFormat: [{ align: 'c' }],\r\n        })\r\n);\r\n\r\n// Note spelling: MULTLINE, not multiline.\r\ndefineTabularEnvironment(\r\n    'multline',\r\n    '',\r\n    (name: string, array: Atom[][][], rowGaps: number[]): Atom =>\r\n        new ArrayAtom(name, array, rowGaps, {\r\n            colFormat: [{ align: 'm' }],\r\n        })\r\n);\r\n\r\n// An AMS-Math environment\r\n// See amsmath.dtx:3565\r\n// Note that some versions of AMS-Math have a gap on the left.\r\n// More recent version suppresses that gap, but have an option to turn it back on\r\n// for backward compatibility.\r\n// Note that technically, 'eqnarray' behaves (slightly) differently. However,\r\n// is is generally recommended to avoid using eqnarray and use align isntead.\r\n// https://texblog.net/latex-archive/maths/eqnarray-align-environment/\r\ndefineTabularEnvironment(\r\n    ['align', 'align*', 'aligned', 'eqnarray'],\r\n    '',\r\n    (name: string, array: Atom[][][], rowGaps: number[]): Atom => {\r\n        let colCount = 0;\r\n        for (const row of array) {\r\n            colCount = Math.max(colCount, row.length);\r\n        }\r\n        const colFormat: Colspec[] = [\r\n            { gap: 0 },\r\n            { align: 'r' },\r\n            { gap: 0 },\r\n            { align: 'l' },\r\n        ];\r\n        let i = 2;\r\n        while (i < colCount) {\r\n            colFormat.push({ gap: 1 });\r\n            colFormat.push({ align: 'r' });\r\n            colFormat.push({ gap: 0 });\r\n            colFormat.push({ align: 'l' });\r\n            i += 2;\r\n        }\r\n        colFormat.push({ gap: 0 });\r\n\r\n        return new ArrayAtom(name, array, rowGaps, {\r\n            arraycolsep: 0,\r\n            colFormat: colFormat,\r\n            jot: 0.3,\r\n        });\r\n    }\r\n);\r\n\r\n// defineEnvironment('alignat', '', function(name, args) {\r\n//     return {\r\n\r\n//     };\r\n// });\r\n\r\n// defineEnvironment('flalign', '', function(name, args) {\r\n//     return {\r\n\r\n//     };\r\n// });\r\n\r\ndefineTabularEnvironment(\r\n    'split',\r\n    '',\r\n    (name: string, array: Atom[][][], rowGaps: number[]): Atom =>\r\n        new ArrayAtom(name, array, rowGaps, {\r\n            colFormat: [{ align: 'r' }, { align: 'l' }],\r\n        })\r\n);\r\n\r\ndefineTabularEnvironment(\r\n    ['gather', 'gathered'],\r\n    '',\r\n    (name: string, array: Atom[][][], rowGaps: number[]): Atom =>\r\n        // An AMS-Math environment\r\n        // %    The \\env{gathered} environment is for several lines that are\r\n        // %    centered independently.\r\n        // From amstex.sty\r\n        // \\newenvironment{gathered}[1][c]{%\r\n        //   \\relax\\ifmmode\\else\\nonmatherr@{\\begin{gathered}}\\fi\r\n        //   \\null\\,%\r\n        //   \\if #1t\\vtop \\else \\if#1b\\vbox \\else \\vcenter \\fi\\fi\r\n        //   \\bgroup\\Let@\\restore@math@cr\r\n        //   \\ifinany@\\else\\openup\\jot\\fi\\ialign\r\n        //   \\bgroup\\hfil\\strut@$\\m@th\\displaystyle##$\\hfil\\crcr\r\n        new ArrayAtom(name, array, rowGaps, {\r\n            colFormat: [{ gap: 0.25 }, { align: 'c' }, { gap: 0 }],\r\n        })\r\n);\r\n\r\n// defineEnvironment('cardinality', '',  function() {\r\n//     const result = {};\r\n\r\n//     result.mathstyle = 'textstyle';\r\n//     result.lFence = '|';\r\n//     result.rFence = '|';\r\n\r\n//     return result;\r\n// });\r\n\r\ndefineTabularEnvironment(\r\n    [\r\n        'matrix',\r\n        'pmatrix',\r\n        'bmatrix',\r\n        'Bmatrix',\r\n        'vmatrix',\r\n        'Vmatrix',\r\n        'smallmatrix',\r\n        'matrix*',\r\n        'pmatrix*',\r\n        'bmatrix*',\r\n        'Bmatrix*',\r\n        'vmatrix*',\r\n        'Vmatrix*',\r\n        'smallmatrix*',\r\n    ],\r\n    '[columns:colspec]',\r\n    (name: string, array: Atom[][][], rowGaps: number[], args): Atom => {\r\n        // From amstex.sty:\r\n        // \\def\\matrix{\\hskip -\\arraycolsep\\array{*\\c@MaxMatrixCols c}}\r\n        // \\def\\endmatrix{\\endarray \\hskip -\\arraycolsep}\r\n        let leftDelim: string;\r\n        let rightDelim: string;\r\n        switch (name) {\r\n            case 'pmatrix':\r\n            case 'pmatrix*':\r\n                leftDelim = '(';\r\n                rightDelim = ')';\r\n                break;\r\n\r\n            case 'bmatrix':\r\n            case 'bmatrix*':\r\n                leftDelim = '[';\r\n                rightDelim = ']';\r\n                break;\r\n\r\n            case 'Bmatrix':\r\n            case 'Bmatrix*':\r\n                leftDelim = '\\\\lbrace';\r\n                rightDelim = '\\\\rbrace';\r\n                break;\r\n\r\n            case 'vmatrix':\r\n            case 'vmatrix*':\r\n                leftDelim = '\\\\vert';\r\n                rightDelim = '\\\\vert';\r\n                break;\r\n\r\n            case 'Vmatrix':\r\n            case 'Vmatrix*':\r\n                leftDelim = '\\\\Vert';\r\n                rightDelim = '\\\\Vert';\r\n                break;\r\n\r\n            case 'matrix':\r\n            case 'matrix*':\r\n                // Specifying a fence, even a null fence,\r\n                // will prevent the insertion of an initial and final gap\r\n                leftDelim = '.';\r\n                rightDelim = '.';\r\n                break;\r\n            default:\r\n        }\r\n        return new ArrayAtom(name, array, rowGaps, {\r\n            mathStyleName: name.startsWith('smallmatrix')\r\n                ? 'scriptstyle'\r\n                : 'textstyle',\r\n            leftDelim,\r\n            rightDelim,\r\n            colFormat: (args[0] as Colspec[]) ?? [\r\n                { align: 'c' },\r\n                { align: 'c' },\r\n                { align: 'c' },\r\n                { align: 'c' },\r\n                { align: 'c' },\r\n                { align: 'c' },\r\n                { align: 'c' },\r\n                { align: 'c' },\r\n                { align: 'c' },\r\n                { align: 'c' },\r\n            ],\r\n        });\r\n    }\r\n);\r\n\r\ndefineTabularEnvironment(\r\n    'cases',\r\n    '',\r\n    (name: string, array: Atom[][][], rowGaps: number[]): Atom => {\r\n        // From amstex.sty:\r\n        // \\def\\cases{\\left\\{\\def\\arraystretch{1.2}\\hskip-\\arraycolsep\r\n        //   \\array{l@{\\quad}l}}\r\n        // \\def\\endcases{\\endarray\\hskip-\\arraycolsep\\right.}\r\n        // From amsmath.dtx\r\n        // \\def\\env@cases{%\r\n        //   \\let\\@ifnextchar\\new@ifnextchar\r\n        //   \\left\\lbrace\r\n        //   \\def\\arraystretch{1.2}%\r\n        //   \\array{@{}l@{\\quad}l@{}}%\r\n        return new ArrayAtom(name, array, rowGaps, {\r\n            arraystretch: 1.2,\r\n            leftDelim: '\\\\lbrace',\r\n            rightDelim: '.',\r\n            colFormat: [{ align: 'l' }, { gap: 1 }, { align: 'l' }],\r\n        });\r\n    }\r\n);\r\n\r\n// This is a text mode environment\r\n/*\r\n\\begin{theorem}\r\nLet $f$ be a function whose derivative exists in every point, then $f$\r\nis a continuous function.\r\n\\end{theorem}\r\n*/\r\n// defineEnvironment('theorem', '', function () {\r\n//     return {};\r\n// });\r\n\r\ndefineEnvironment(\r\n    'center',\r\n    '',\r\n    (name: string, array: Atom[][][], rowGaps: number[]): Atom =>\r\n        new ArrayAtom(name, array, rowGaps, { colFormat: [{ align: 'c' }] })\r\n);\r\n","import { Argument, defineFunction } from './definitions-utils';\nimport type { Atom, ToLatexOptions } from '../core/atom-class';\nimport { OverunderAtom } from '../core-atoms/overunder';\nimport { Style } from '../public/core';\n\n// Extensible (horitontally stretchy) symbols\n\ndefineFunction(\n    [\n        'overrightarrow',\n        'overleftarrow',\n        'Overrightarrow',\n        'overleftharpoon',\n        'overrightharpoon',\n        'overleftrightarrow',\n        'overbrace',\n        'overlinesegment',\n        'overgroup',\n    ],\n    '{:auto}',\n    {\n        createAtom: (command: string, args: Argument[], style: Style): Atom =>\n            new OverunderAtom(command, {\n                body: args[0] as Atom[],\n                style,\n                // Set the \"svgAbove\" to the name of a SVG object (which is the same\n                // as the command name)\n                svgAbove: command.slice(1),\n            }),\n    }\n);\n\ndefineFunction(\n    [\n        'underrightarrow',\n        'underleftarrow',\n        'underleftrightarrow',\n        'underbrace',\n        'underlinesegment',\n        'undergroup',\n    ],\n    '{:auto}',\n    {\n        createAtom: (command: string, args: Argument[], style: Style): Atom =>\n            new OverunderAtom(command, {\n                body: args[0] as Atom[],\n                style,\n                // Set the \"svgBelow\" to the name of a SVG object (which is the same\n                // as the command name)\n                svgBelow: command.slice(1),\n            }),\n    }\n);\ndefineFunction(\n    [\n        'xrightarrow',\n        'xleftarrow',\n        'xRightarrow',\n        'xLeftarrow',\n        'xleftharpoonup',\n        'xleftharpoondown',\n        'xrightharpoonup',\n        'xrightharpoondown',\n        'xlongequal',\n        'xtwoheadleftarrow',\n        'xtwoheadrightarrow',\n        'xleftrightarrow',\n        'xLeftrightarrow',\n        'xrightleftharpoons',\n        'xleftrightharpoons',\n        'xhookleftarrow',\n        'xhookrightarrow',\n        'xmapsto',\n        'xtofrom',\n        'xrightleftarrows', // From mhchem.sty package\n        'xrightequilibrium', // From mhchem.sty package\n        'xleftequilibrium', // From mhchem.sty package\n    ],\n    '[:auto]{:auto}',\n    {\n        createAtom: (command: string, args: Argument[], style: Style): Atom =>\n            new OverunderAtom(command, {\n                style,\n                // Set the \"svgBody\" to the name of a SVG object (which is the same\n                // as the command name)\n                svgBody: command.slice(1),\n                // The overscript is optional, i.e. `\\xtofrom` is valid\n                above:\n                    (args[1] as Atom[])?.length === 0\n                        ? null\n                        : (args[1] as Atom[]),\n                below: args[0] as Atom[],\n                skipBoundary: false,\n                toLatexOverride: (\n                    atom: OverunderAtom,\n                    options: ToLatexOptions\n                ) =>\n                    command +\n                    (!atom.hasEmptyBranch('below')\n                        ? `[${atom.belowToLatex(options)}]`\n                        : '') +\n                    `{${atom.aboveToLatex(options)}}`,\n            }),\n    }\n);\n","import { Atom, AtomType, ToLatexOptions } from '../core/atom-class';\r\nimport { MATHSTYLES } from '../core/mathstyle';\r\nimport { makeSymbol, makeSpan, Span } from '../core/span';\r\nimport { Context } from '../core/context';\r\nimport { Style, Variant, VariantStyle } from '../public/core';\r\nimport { joinLatex } from '../core/tokenizer';\r\n\r\n/**\r\n * Operators are handled in the TeXbook pg. 443-444, rule 13(a).\r\n */\r\nexport class OperatorAtom extends Atom {\r\n    private variant: Variant;\r\n    private variantStyle: VariantStyle;\r\n    constructor(\r\n        command: string,\r\n        symbol: string | Atom[],\r\n        options: {\r\n            type?: AtomType;\r\n            isExtensibleSymbol?: boolean;\r\n            isFunction?: boolean;\r\n            captureSelection?: boolean;\r\n            // Unlike `style`, `variant` and `variantStyle` are applied to the\r\n            // content of this atom, but not propagated to the next atom\r\n            variant?: Variant;\r\n            variantStyle?: VariantStyle;\r\n            limits?: 'limits' | 'nolimits' | 'accent' | 'overunder' | 'auto';\r\n            style?: Style;\r\n        }\r\n    ) {\r\n        super(options.type ?? 'mop', {\r\n            command,\r\n            style: options.style,\r\n            isExtensibleSymbol: options?.isExtensibleSymbol,\r\n            isFunction: options?.isFunction,\r\n        });\r\n        if (typeof symbol === 'string') {\r\n            this.value = symbol as string;\r\n        } else {\r\n            this.body = symbol as Atom[];\r\n        }\r\n        this.captureSelection = options.captureSelection;\r\n        this.variant = options?.variant;\r\n        this.variantStyle = options?.variantStyle;\r\n        this.limits = options?.limits;\r\n    }\r\n    render(context: Context): Span[] {\r\n        const mathstyle = context.mathstyle;\r\n        let base: Span;\r\n        let baseShift = 0;\r\n        let slant = 0;\r\n        if (this.isExtensibleSymbol) {\r\n            // Most symbol operators get larger in displaystyle (rule 13)\r\n            // except `\\smallint`\r\n            const large =\r\n                mathstyle.size === MATHSTYLES.displaystyle.size &&\r\n                this.value !== '\\\\smallint';\r\n\r\n            base = makeSymbol(\r\n                large ? 'Size2-Regular' : 'Size1-Regular',\r\n                this.value,\r\n                'op-symbol ' + (large ? 'large-op' : 'small-op'),\r\n                'mop'\r\n            );\r\n\r\n            // Shift the symbol so its center lies on the axis (rule 13). It\r\n            // appears that our fonts have the centers of the symbols already\r\n            // almost on the axis, so these numbers are very small. Note we\r\n            // don't actually apply this here, but instead it is used either in\r\n            // the vlist creation or separately when there are no limits.\r\n            baseShift =\r\n                (base.height - base.depth) / 2 -\r\n                mathstyle.metrics.axisHeight * mathstyle.sizeMultiplier;\r\n\r\n            // The slant of the symbol is just its italic correction.\r\n            slant = base.italic;\r\n            base.applyStyle(this.mode, {\r\n                color: this.style.color,\r\n                backgroundColor: this.style.backgroundColor,\r\n            });\r\n        } else if (this.body) {\r\n            // If this is a list, decompose that list.\r\n            base = makeSpan(Atom.render(context, this.body), '', 'mop');\r\n            base.applyStyle(this.mode, {\r\n                color: this.style.color,\r\n                backgroundColor: this.style.backgroundColor,\r\n            });\r\n        } else {\r\n            // Otherwise, this is a text operator. Build the text from the\r\n            // operator's name.\r\n            console.assert(this.type === 'mop');\r\n            base = this.makeSpan(context, this.value);\r\n            // Not all styles are applied, since the operators have a distinct\r\n            // appearance (for example, can't override their font family)\r\n            base.applyStyle(this.mode, {\r\n                color: this.style.color,\r\n                backgroundColor: this.style.backgroundColor,\r\n                letterShapeStyle: context.letterShapeStyle,\r\n                variant: this.variant,\r\n                variantStyle: this.variantStyle,\r\n            });\r\n        }\r\n\r\n        if (this.isExtensibleSymbol) base.setTop(baseShift);\r\n        let result = base;\r\n        if (this.superscript || this.subscript) {\r\n            const limits = this.limits ?? 'auto';\r\n            if (\r\n                limits === 'limits' ||\r\n                (limits === 'auto' &&\r\n                    mathstyle.size === MATHSTYLES.displaystyle.size)\r\n            ) {\r\n                result = this.attachLimits(context, base, baseShift, slant);\r\n            } else {\r\n                result = this.attachSupsub(context, base, 'mop');\r\n            }\r\n        }\r\n\r\n        if (this.caret) result.caret = this.caret;\r\n\r\n        // Bind the generated span with its limits so they\r\n        // can all be selected as one\r\n        this.bind(context, result);\r\n        return [result];\r\n    }\r\n    toLatex(options: ToLatexOptions): string {\r\n        let result = '';\r\n        if (this.value !== '\\u200b') {\r\n            // Not ZERO-WIDTH\r\n            if (\r\n                this.command === '\\\\mathop' ||\r\n                this.command === '\\\\operatorname'\r\n            ) {\r\n                result += this.command + `{${this.bodyToLatex(options)}}`;\r\n            } else {\r\n                result += this.command;\r\n            }\r\n        }\r\n        result = joinLatex([result, this.supsubToLatex(options)]);\r\n        if (this.explicitLimits) {\r\n            if (this.limits === 'limits') result += '\\\\limits';\r\n            if (this.limits === 'nolimits') result += '\\\\nolimits';\r\n        }\r\n        return result;\r\n    }\r\n}\r\n","import { Atom, ToLatexOptions } from '../core/atom-class';\r\nimport { MATHSTYLES } from '../core/mathstyle';\r\nimport { METRICS as FONTMETRICS } from '../core/font-metrics';\r\nimport {\r\n    makeSpan,\r\n    makeVlist,\r\n    depth as spanDepth,\r\n    height as spanHeight,\r\n    Span,\r\n} from '../core/span';\r\nimport { Context } from '../core/context';\r\n\r\nimport { makeCustomSizedDelim } from '../core/delimiters';\r\nimport { ParseMode, Style } from '../public/core';\r\n\r\nexport class SurdAtom extends Atom {\r\n    constructor(\r\n        command: string,\r\n        options: { mode?: ParseMode; body: Atom[]; index: Atom[]; style: Style }\r\n    ) {\r\n        super('surd', {\r\n            command,\r\n            mode: options.mode ?? 'math',\r\n            style: options.style,\r\n        });\r\n        this.body = options.body;\r\n        this.above = options.index;\r\n    }\r\n    toLatex(options: ToLatexOptions): string {\r\n        let args = '';\r\n        if (this.above) {\r\n            args += `[${this.aboveToLatex(options)}]`;\r\n        }\r\n        args += `{${this.bodyToLatex(options)}}`;\r\n        return this.command + args;\r\n    }\r\n    render(context: Context): Span[] {\r\n        // See the TeXbook pg. 443, Rule 11.\r\n        // http://www.ctex.org/documents/shredder/src/texbook.pdf\r\n        const mathstyle = context.mathstyle;\r\n        // First, we do the same steps as in overline to build the inner group\r\n        // and line\r\n        const inner = Atom.render(context.cramp(), this.body) ?? makeSpan('');\r\n        const ruleWidth =\r\n            FONTMETRICS.defaultRuleThickness / mathstyle.sizeMultiplier;\r\n        let phi = ruleWidth;\r\n        if (mathstyle.id < MATHSTYLES.textstyle.id) {\r\n            phi = mathstyle.metrics.xHeight;\r\n        }\r\n        // Calculate the clearance between the body and line\r\n        let lineClearance = ruleWidth + phi / 4;\r\n        const innerTotalHeight = Math.max(\r\n            2 * phi,\r\n            (spanHeight(inner) + spanDepth(inner)) * mathstyle.sizeMultiplier\r\n        );\r\n        const minDelimiterHeight =\r\n            innerTotalHeight + (lineClearance + ruleWidth);\r\n\r\n        // Create a \\surd delimiter of the required minimum size\r\n        const delim = this.bind(\r\n            context,\r\n            makeSpan(\r\n                makeCustomSizedDelim(\r\n                    '',\r\n                    '\\\\surd',\r\n                    minDelimiterHeight,\r\n                    false,\r\n                    context\r\n                ),\r\n                'sqrt-sign'\r\n            )\r\n        );\r\n        delim.applyStyle(this.mode, this.style);\r\n\r\n        const delimDepth = delim.height + delim.depth - ruleWidth;\r\n\r\n        // Adjust the clearance based on the delimiter size\r\n        if (delimDepth > spanHeight(inner) + spanDepth(inner) + lineClearance) {\r\n            lineClearance =\r\n                (lineClearance +\r\n                    delimDepth -\r\n                    (spanHeight(inner) + spanDepth(inner))) /\r\n                2;\r\n        }\r\n\r\n        // Shift the delimiter so that its top lines up with the top of the line\r\n        delim.setTop(\r\n            delim.height - spanHeight(inner) - (lineClearance + ruleWidth)\r\n        );\r\n        const line = makeSpan(\r\n            null,\r\n            context.mathstyle.adjustTo(MATHSTYLES.textstyle) + ' sqrt-line'\r\n        );\r\n        line.applyStyle(this.mode, this.style);\r\n        line.height = ruleWidth;\r\n\r\n        const body = makeVlist(context, [\r\n            inner,\r\n            lineClearance,\r\n            line,\r\n            ruleWidth,\r\n        ]);\r\n\r\n        let className = 'sqrt';\r\n        if (this.containsCaret) className += ' ML__contains-caret';\r\n\r\n        if (!this.above) {\r\n            const result = makeSpan([delim, body], className, 'mord');\r\n            if (this.caret) result.caret = this.caret;\r\n            return [this.bind(context, result)];\r\n        }\r\n\r\n        // Handle the optional root index\r\n        // The index is always in scriptscript style\r\n        const newcontext = context.clone({\r\n            mathstyle: MATHSTYLES.scriptscriptstyle,\r\n        });\r\n        const root = makeSpan(\r\n            Atom.render(newcontext, this.above),\r\n            mathstyle.adjustTo(MATHSTYLES.scriptscriptstyle)\r\n        );\r\n        // Figure out the height and depth of the inner part\r\n        const innerRootHeight = Math.max(delim.height, body.height);\r\n        const innerRootDepth = Math.max(delim.depth, body.depth);\r\n        // The amount the index is shifted by. This is taken from the TeX\r\n        // source, in the definition of `\\r@@t`.\r\n        const toShift = 0.6 * (innerRootHeight - innerRootDepth);\r\n        // Build a VList with the superscript shifted up correctly\r\n        const rootVlist = makeVlist(context, [root], 'shift', -toShift);\r\n\r\n        // Add a class surrounding it so we can add on the appropriate\r\n        // kerning\r\n\r\n        const result = makeSpan(\r\n            [makeSpan(rootVlist, 'root'), delim, body],\r\n            className,\r\n            'mord'\r\n        );\r\n        result.height = delim.height;\r\n        result.depth = delim.depth;\r\n        if (this.caret) result.caret = this.caret;\r\n        return [this.bind(context, result)];\r\n    }\r\n}\r\n","import { Atom, ToLatexOptions } from '../core/atom-class';\r\nimport { MATHSTYLES, MathStyleName } from '../core/mathstyle';\r\nimport { METRICS as FONTMETRICS } from '../core/font-metrics';\r\nimport {\r\n    Span,\r\n    makeSpan,\r\n    makeHlist,\r\n    makeVlist,\r\n    depth as spanDepth,\r\n    height as spanHeight,\r\n} from '../core/span';\r\nimport { makeCustomSizedDelim } from '../core/delimiters';\r\nimport { Context } from '../core/context';\r\nimport { Style } from '../public/core';\r\n\r\nexport type GenfracOptions = {\r\n    continuousFraction?: boolean;\r\n    numerPrefix?: string;\r\n    denomPrefix?: string;\r\n    leftDelim?: string;\r\n    rightDelim?: string;\r\n    hasBarLine?: boolean;\r\n    mathStyleName?: MathStyleName | 'auto';\r\n    style?: Style;\r\n    toLatexOverride?: (atom: GenfracAtom, options: ToLatexOptions) => string;\r\n};\r\n\r\n/**\r\n * Gengrac -- Generalized fraction\r\n *\r\n * Decompose fractions, binomials, and in general anything made\r\n * of two expressions on top of each other, optionally separated by a bar,\r\n * and optionally surrounded by fences (parentheses, brackets, etc...)\r\n *\r\n * Depending on the type of fraction the mathstyle is either\r\n * display math or inline math (which is indicated by 'textstyle'). This value can\r\n * also be set to 'auto', which indicates it should use the current mathstyle\r\n */\r\nexport class GenfracAtom extends Atom {\r\n    private continuousFraction: boolean;\r\n    private numerPrefix?: string;\r\n    private denomPrefix?: string;\r\n    leftDelim?: string;\r\n    rightDelim?: string;\r\n    hasBarLine: boolean;\r\n    private mathStyleName: MathStyleName | 'auto';\r\n    constructor(\r\n        command: string,\r\n        above: Atom[],\r\n        below: Atom[],\r\n        options?: GenfracOptions\r\n    ) {\r\n        super('genfrac', {\r\n            style: options.style,\r\n            command,\r\n            toLatexOverride: options.toLatexOverride,\r\n        });\r\n        this.above = above;\r\n        this.below = below;\r\n        this.hasBarLine = options?.hasBarLine ?? true;\r\n        this.continuousFraction = options?.continuousFraction ?? false;\r\n        this.numerPrefix = options?.numerPrefix;\r\n        this.denomPrefix = options?.denomPrefix;\r\n        this.mathStyleName = options?.mathStyleName ?? 'auto';\r\n        this.leftDelim = options?.leftDelim;\r\n        this.rightDelim = options?.rightDelim;\r\n    }\r\n    toLatex(options: ToLatexOptions): string {\r\n        return (\r\n            this.command +\r\n            `{${this.aboveToLatex(options)}}` +\r\n            `{${this.belowToLatex(options)}}`\r\n        );\r\n    }\r\n    render(context: Context): Span[] {\r\n        const mathstyle =\r\n            this.mathStyleName === 'auto'\r\n                ? context.mathstyle\r\n                : MATHSTYLES[this.mathStyleName];\r\n        const newContext = context.clone({ mathstyle: mathstyle });\r\n        const style = this.computedStyle;\r\n        let numer = [];\r\n        if (this.numerPrefix) {\r\n            numer.push(makeSpan(this.numerPrefix, 'mord'));\r\n        }\r\n        const numeratorStyle = this.continuousFraction\r\n            ? mathstyle\r\n            : mathstyle.fracNum();\r\n        numer = numer.concat(\r\n            Atom.render(\r\n                newContext.clone({ mathstyle: numeratorStyle }),\r\n                this.above\r\n            )\r\n        );\r\n        const numerReset = makeHlist(\r\n            numer,\r\n            context.mathstyle.adjustTo(numeratorStyle)\r\n        );\r\n        let denom = [];\r\n        if (this.denomPrefix) {\r\n            denom.push(makeSpan(this.denomPrefix, 'mord'));\r\n        }\r\n        const denominatorStyle = this.continuousFraction\r\n            ? mathstyle\r\n            : mathstyle.fracDen();\r\n        denom = denom.concat(\r\n            Atom.render(\r\n                newContext.clone({ mathstyle: denominatorStyle }),\r\n                this.below\r\n            )\r\n        );\r\n        const denomReset = makeHlist(\r\n            denom,\r\n            context.mathstyle.adjustTo(denominatorStyle)\r\n        );\r\n        const ruleWidth = !this.hasBarLine\r\n            ? 0\r\n            : FONTMETRICS.defaultRuleThickness / mathstyle.sizeMultiplier;\r\n        // Rule 15b from TeXBook Appendix G, p.444\r\n        //\r\n        // 15b. If C > T, set u  8 and v  11. Otherwise set u  9 or 10,according\r\n        // as  = 0 or  = 0, and set v  12. (The fraction will be typeset with\r\n        // its numerator shifted up by an amount u with respect to the current\r\n        // baseline, and with the denominator shifted down by v, unless the boxes\r\n        // are unusually large.)\r\n        let numShift: number;\r\n        let clearance = 0;\r\n        let denomShift: number;\r\n        if (mathstyle.size === MATHSTYLES.displaystyle.size) {\r\n            numShift = mathstyle.metrics.num1; // set u  8\r\n            if (ruleWidth > 0) {\r\n                clearance = 3 * ruleWidth; //    3\r\n            } else {\r\n                clearance = 7 * FONTMETRICS.defaultRuleThickness; //   7 8\r\n            }\r\n            denomShift = mathstyle.metrics.denom1; // v  11\r\n        } else {\r\n            if (ruleWidth > 0) {\r\n                numShift = mathstyle.metrics.num2; // u  9\r\n                clearance = ruleWidth; //    \r\n            } else {\r\n                numShift = mathstyle.metrics.num3; // u  10\r\n                clearance = 3 * FONTMETRICS.defaultRuleThickness; //   3 8\r\n            }\r\n            denomShift = mathstyle.metrics.denom2; // v  12\r\n        }\r\n        const numerDepth = spanDepth(numerReset);\r\n        const denomHeight = spanHeight(denomReset);\r\n        let frac: Span;\r\n        if (ruleWidth === 0) {\r\n            // Rule 15c from Appendix G\r\n            // No bar line between numerator and denominator\r\n            const candidateClearance =\r\n                numShift - numerDepth - (denomHeight - denomShift);\r\n            if (candidateClearance < clearance) {\r\n                numShift += 0.5 * (clearance - candidateClearance);\r\n                denomShift += 0.5 * (clearance - candidateClearance);\r\n            }\r\n            frac = makeVlist(\r\n                newContext,\r\n                [numerReset, -numShift, denomReset, denomShift],\r\n                'individualShift'\r\n            );\r\n        } else {\r\n            // Rule 15d from Appendix G\r\n            // There is a bar line between the numerator and the denominator\r\n            const axisHeight = mathstyle.metrics.axisHeight;\r\n            const numerLine = axisHeight + 0.5 * ruleWidth;\r\n            const denomLine = axisHeight - 0.5 * ruleWidth;\r\n            if (numShift - numerDepth - numerLine < clearance) {\r\n                numShift += clearance - (numShift - numerDepth - numerLine);\r\n            }\r\n            if (denomLine - (denomHeight - denomShift) < clearance) {\r\n                denomShift +=\r\n                    clearance - (denomLine - (denomHeight - denomShift));\r\n            }\r\n            const mid = makeSpan(null, ' frac-line');\r\n            mid.applyStyle(this.mode, style);\r\n            // Manually set the height of the line because its height is\r\n            // created in CSS\r\n            mid.height = ruleWidth / 2;\r\n            mid.depth = ruleWidth / 2;\r\n            const elements = [];\r\n            elements.push(numerReset);\r\n            elements.push(-numShift);\r\n            elements.push(mid);\r\n            elements.push(ruleWidth / 2 - axisHeight);\r\n            elements.push(denomReset);\r\n            elements.push(denomShift);\r\n            frac = makeVlist(newContext, elements, 'individualShift');\r\n        }\r\n        // Add a 'mfrac' class to provide proper context for\r\n        // other css selectors (such as 'frac-line')\r\n        frac.classes += ' mfrac';\r\n        // Since we manually change the style sometimes (with \\dfrac or \\tfrac),\r\n        // account for the possible size change here.\r\n        frac.height *=\r\n            mathstyle.sizeMultiplier / context.mathstyle.sizeMultiplier;\r\n        frac.depth *=\r\n            mathstyle.sizeMultiplier / context.mathstyle.sizeMultiplier;\r\n\r\n        // Rule 15e of Appendix G\r\n        const delimSize =\r\n            mathstyle.size === MATHSTYLES.displaystyle.size\r\n                ? mathstyle.metrics.delim1\r\n                : mathstyle.metrics.delim2;\r\n\r\n        // Optional delimiters\r\n        const leftDelim = this.bind(\r\n            context,\r\n            makeCustomSizedDelim(\r\n                'mopen',\r\n                this.leftDelim,\r\n                delimSize,\r\n                true,\r\n                context.clone({ mathstyle: mathstyle })\r\n            )\r\n        );\r\n        leftDelim.applyStyle(this.mode, style);\r\n\r\n        const rightDelim = this.bind(\r\n            context,\r\n            makeCustomSizedDelim(\r\n                'mclose',\r\n                this.rightDelim,\r\n                delimSize,\r\n                true,\r\n                context.clone({ mathstyle: mathstyle })\r\n            )\r\n        );\r\n        rightDelim.applyStyle(this.mode, style);\r\n\r\n        const result = this.bind(\r\n            context,\r\n            // makeStruts(\r\n            makeSpan(\r\n                [leftDelim, frac, rightDelim],\r\n                context.parentSize !== context.size\r\n                    ? 'sizing reset-' + context.parentSize + ' ' + context.size\r\n                    : '',\r\n                'mord'\r\n                // )\r\n            )\r\n        );\r\n\r\n        if (this.caret) result.caret = this.caret;\r\n\r\n        return [this.attachSupsub(context, result, result.type)];\r\n    }\r\n}\r\n","import { Atom, ToLatexOptions } from '../core/atom-class';\nimport { makeSpan, Span, SpanType } from '../core/span';\nimport { Context } from '../core/context';\nimport { makeSizedDelim } from '../core/delimiters';\nimport { Style } from '../public/core';\n\nexport class DelimAtom extends Atom {\n    size: 1 | 2 | 3 | 4;\n    constructor(\n        command: string,\n        delim: string,\n        options?: {\n            size?: 1 | 2 | 3 | 4;\n            style: Style;\n        }\n    ) {\n        super('delim', { command, style: options?.style });\n        this.value = delim;\n        this.size = options?.size;\n    }\n    render(_context: Context): Span[] {\n        const span = makeSpan(null, '');\n        span.delim = this.value;\n        return [span];\n    }\n    toLatex(_options: ToLatexOptions): string {\n        if (this.value.length === 1) {\n            return this.command + this.value;\n        }\n        return this.command + '{' + this.value + '}';\n    }\n}\n\nexport class SizedDelimAtom extends Atom {\n    private size: 1 | 2 | 3 | 4;\n    protected delimClass?: SpanType;\n    constructor(\n        command: string,\n        delim: string,\n        options: {\n            delimClass: SpanType;\n            size: 1 | 2 | 3 | 4;\n            style: Style;\n        }\n    ) {\n        super('sizeddelim', { command, style: options.style });\n        this.value = delim;\n        this.delimClass = options.delimClass;\n        this.size = options.size;\n    }\n    render(context: Context): Span[] {\n        const result = this.bind(\n            context,\n            makeSizedDelim(this.delimClass, this.value, this.size, context)\n        );\n        if (this.caret) result.caret = this.caret;\n        return [result];\n    }\n    toLatex(_options: ToLatexOptions): string {\n        if (this.value.length === 1) {\n            return this.command + this.value;\n        }\n        return this.command + '{' + this.value + '}';\n    }\n}\n","import { Argument, defineFunction } from './definitions-utils';\r\nimport type { Atom, ToLatexOptions } from '../core/atom-class';\r\nimport { OperatorAtom } from '../core-atoms/operator';\r\nimport { SurdAtom } from '../core-atoms/surd';\r\nimport { GenfracAtom, GenfracOptions } from '../core-atoms/genfrac';\r\nimport { DelimAtom } from '../core-atoms/delim';\r\nimport { Style } from '../public/core';\r\n\r\ndefineFunction(\r\n    [\r\n        'arccos',\r\n        'arcsin',\r\n        'arctan',\r\n        'arctg', // Not Latex standard. Used in France\r\n        'arcctg', // Not Latex standard. Used in France\r\n        'arg',\r\n        'ch', // Not Latex standard. \\cosh\r\n        'cos',\r\n        'cosh',\r\n        'cot',\r\n        'coth',\r\n        'ctg', // Not Latex standard. Used in France\r\n        'cth',\r\n        'cotg', // Not Latex standard. Used in France\r\n        'csc', // Not Latex standard. \\cth\r\n        'cosec', // Not Latex standard.\r\n        'deg',\r\n        'dim',\r\n        'exp',\r\n        'hom',\r\n        'inf',\r\n        'ker',\r\n        'lg',\r\n        'lb', // Not Latex standard. US Dept of Commerce recommendation for log2\r\n        'lg', // Not Latex standard. In German and Russian literature,  log10.\r\n        // Sometimes used as the log2\r\n        'ln',\r\n        'log',\r\n        'Pr',\r\n        'sec',\r\n        'sh', // Not Latex standard. \\sinh\r\n        'sin',\r\n        'sinh',\r\n        'sup',\r\n        'tan',\r\n        'tanh',\r\n        'tg', // Not Latex standard. Used in France\r\n        'th', // Not Latex standard. \\tanh\r\n    ],\r\n    '',\r\n    {\r\n        isFunction: true,\r\n        createAtom: (command: string, _args: Argument[], style: Style): Atom =>\r\n            new OperatorAtom(command, command.slice(1), {\r\n                limits: 'nolimits',\r\n                isExtensibleSymbol: false,\r\n                isFunction: true,\r\n                variant: 'main',\r\n                variantStyle: 'up',\r\n                style,\r\n            }),\r\n    }\r\n);\r\n\r\ndefineFunction(['liminf', 'limsup'], '', {\r\n    createAtom: (command: string, _args: Argument[], style: Style): Atom =>\r\n        new OperatorAtom(\r\n            command,\r\n            { '\\\\liminf': 'lim inf', '\\\\limsup': 'lim sup' }[command],\r\n            {\r\n                limits: 'limits',\r\n                isExtensibleSymbol: false,\r\n                variant: 'main',\r\n                style,\r\n            }\r\n        ),\r\n});\r\n\r\ndefineFunction(['lim', 'mod'], '', {\r\n    createAtom: (command: string, _args: Argument[], style: Style): Atom =>\r\n        new OperatorAtom(command, command.slice(1), {\r\n            limits: 'limits',\r\n            isExtensibleSymbol: false,\r\n            variant: 'main',\r\n            style,\r\n        }),\r\n});\r\n\r\n// With Limits\r\ndefineFunction(['det', 'max', 'min'], '', {\r\n    isFunction: true,\r\n    createAtom: (command: string, _args: Argument[], style: Style): Atom =>\r\n        new OperatorAtom(command, command.slice(1), {\r\n            limits: 'limits',\r\n            isExtensibleSymbol: false,\r\n            isFunction: true,\r\n            variant: 'main',\r\n            style,\r\n        }),\r\n});\r\n\r\n// Root\r\ndefineFunction('sqrt', '[index:auto]{radicand:auto}', {\r\n    createAtom: (command: string, args: Argument[], style: Style): Atom =>\r\n        new SurdAtom(command, {\r\n            body: args[1] as Atom[],\r\n            index: args[0] as Atom[],\r\n            style,\r\n        }),\r\n});\r\n\r\n// Fractions\r\ndefineFunction(\r\n    ['frac', 'dfrac', 'tfrac', 'cfrac', 'binom', 'dbinom', 'tbinom'],\r\n    '{numerator}{denominator}',\r\n    {\r\n        createAtom: (command: string, args: Argument[], style: Style): Atom => {\r\n            const options: GenfracOptions = {\r\n                mathStyleName: 'auto',\r\n                style,\r\n            };\r\n            switch (command) {\r\n                case '\\\\dfrac':\r\n                case '\\\\frac':\r\n                case '\\\\tfrac':\r\n                    options.hasBarLine = true;\r\n                    break;\r\n                case '\\\\atopfrac':\r\n                    options.hasBarLine = false;\r\n                    break;\r\n                case '\\\\dbinom':\r\n                case '\\\\binom':\r\n                case '\\\\tbinom':\r\n                    options.hasBarLine = false;\r\n                    options.leftDelim = '(';\r\n                    options.rightDelim = ')';\r\n                    break;\r\n            }\r\n\r\n            switch (command) {\r\n                case '\\\\dfrac':\r\n                case '\\\\dbinom':\r\n                    options.mathStyleName = 'displaystyle';\r\n                    break;\r\n                case '\\\\tfrac':\r\n                case '\\\\tbinom':\r\n                    options.mathStyleName = 'textstyle';\r\n                    break;\r\n                case '\\\\cfrac':\r\n                    options.hasBarLine = true;\r\n                    options.continuousFraction = true;\r\n                    break;\r\n            }\r\n            return new GenfracAtom(\r\n                command,\r\n                args[0] as Atom[],\r\n                args[1] as Atom[],\r\n                options\r\n            );\r\n        },\r\n    }\r\n);\r\n\r\ndefineFunction(['over', 'atop', 'choose'], '', {\r\n    infix: true,\r\n    createAtom: (command: string, args: Argument[], style: Style): Atom => {\r\n        let leftDelim: string;\r\n        let rightDelim: string;\r\n\r\n        if (command === '\\\\choose') {\r\n            leftDelim = '(';\r\n            rightDelim = ')';\r\n        }\r\n        return new GenfracAtom(command, args[0] as Atom[], args[1] as Atom[], {\r\n            hasBarLine: command === '\\\\over',\r\n            leftDelim: leftDelim,\r\n            rightDelim: rightDelim,\r\n            style,\r\n            toLatexOverride: (atom: GenfracAtom, options: ToLatexOptions) =>\r\n                `{${atom.aboveToLatex(options)}${\r\n                    atom.command\r\n                } ${atom.belowToLatex(options)}}`,\r\n        });\r\n    },\r\n});\r\n\r\n// Slashed package\r\n/*\r\ndefineFunction('\\\\slashed'\r\n*/\r\n\r\ndefineFunction('pdiff', '{numerator}{denominator}', {\r\n    createAtom: (command: string, args: Argument[], style: Style): Atom =>\r\n        new GenfracAtom(command, args[0] as Atom[], args[1] as Atom[], {\r\n            hasBarLine: true,\r\n            numerPrefix: '\\u2202',\r\n            denomPrefix: '\\u2202',\r\n            style,\r\n        }),\r\n});\r\n\r\n// Limits, symbols\r\ndefineFunction(\r\n    [\r\n        'sum',\r\n        'prod',\r\n        'bigcup',\r\n        'bigcap',\r\n        'coprod',\r\n        'bigvee',\r\n        'bigwedge',\r\n        'biguplus',\r\n        'bigotimes',\r\n        'bigoplus',\r\n        'bigodot',\r\n        'bigsqcup',\r\n        'smallint',\r\n        'intop',\r\n    ],\r\n    '',\r\n    {\r\n        createAtom: (command: string, args: Argument[], style: Style): Atom =>\r\n            new OperatorAtom(\r\n                command,\r\n                {\r\n                    coprod: '\\u2210',\r\n                    bigvee: '\\u22c1',\r\n                    bigwedge: '\\u22c0',\r\n                    biguplus: '\\u2a04',\r\n                    bigcap: '\\u22c2',\r\n                    bigcup: '\\u22c3',\r\n                    intop: '\\u222b',\r\n                    prod: '\\u220f',\r\n                    sum: '\\u2211',\r\n                    bigotimes: '\\u2a02',\r\n                    bigoplus: '\\u2a01',\r\n                    bigodot: '\\u2a00',\r\n                    bigsqcup: '\\u2a06',\r\n                    smallint: '\\u222b',\r\n                }[command.slice(1)],\r\n                {\r\n                    isExtensibleSymbol: true,\r\n                    limits: 'auto',\r\n                    variant: 'main',\r\n                    style,\r\n                }\r\n            ),\r\n    }\r\n);\r\n\r\n// No limits, symbols (i.e. display larger in 'display' mode, and\r\n// centered on the baseline)\r\nconst EXTENSIBLE_SYMBOLS = {\r\n    int: '\\u222b',\r\n    iint: '\\u222c',\r\n    iiint: '\\u222d',\r\n    oint: '\\u222e',\r\n    oiint: '\\u222f',\r\n    oiiint: '\\u2230',\r\n    intclockwise: '\\u2231',\r\n    varointclockwise: '\\u2232',\r\n    ointctrclockwise: '\\u2233',\r\n    intctrclockwise: '\\u2a11',\r\n    sqcup: '\\u2294',\r\n    sqcap: '\\u2293',\r\n    uplus: '\\u228e',\r\n    wr: '\\u2240',\r\n    amalg: '\\u2a3f',\r\n    Cap: '\\u22d2',\r\n    Cup: '\\u22d3',\r\n    doublecap: '\\u22d2',\r\n    doublecup: '\\u22d3',\r\n};\r\ndefineFunction(Object.keys(EXTENSIBLE_SYMBOLS), '', {\r\n    createAtom: (command: string, _args: Argument[], style: Style): Atom =>\r\n        new OperatorAtom(command, EXTENSIBLE_SYMBOLS[command.slice(1)], {\r\n            limits: 'nolimits',\r\n            isExtensibleSymbol: true,\r\n            style,\r\n            variant: { '\\u22d2': 'ams', '\\u22d3': 'ams' }[\r\n                EXTENSIBLE_SYMBOLS[command.slice(1)]\r\n            ],\r\n        }),\r\n});\r\n\r\ndefineFunction(['Re', 'Im'], '', {\r\n    createAtom: (command: string, _args: Argument[], style: Style): Atom =>\r\n        new OperatorAtom(\r\n            command,\r\n            { '\\\\Re': '\\u211c', '\\\\Im': '\\u2111' }[command],\r\n            {\r\n                limits: 'nolimits',\r\n                style,\r\n                isExtensibleSymbol: false,\r\n                isFunction: true,\r\n                variant: 'fraktur',\r\n            }\r\n        ),\r\n});\r\n\r\ndefineFunction('middle', '{:delim}', {\r\n    createAtom: (command: string, args: Argument[], style: Style): Atom =>\r\n        new DelimAtom(command, args[0] as string, { style }),\r\n});\r\n\r\n// TODO\r\n// Some missing greek letters, but see https://reference.wolfram.com/language/tutorial/LettersAndLetterLikeForms.html\r\n// koppa, stigma, Sampi\r\n// See https://tex.stackexchange.com/questions/231878/accessing-archaic-greek-koppa-in-the-birkmult-document-class\r\n// Capital Alpha, etc...\r\n// Colon (ratio) (2236)\r\n\r\n// Review:\r\n// https://en.wikipedia.org/wiki/Help:Displaying_a_formula\r\n\r\n// https://reference.wolfram.com/language/tutorial/LettersAndLetterLikeForms.html\r\n// ftp://ftp.dante.de/tex-archive/info/symbols/comprehensive/symbols-a4.pdf\r\n\r\n// Media Wiki Reference\r\n// https://en.wikipedia.org/wiki/Help:Displaying_a_formula\r\n\r\n// MathJax Reference\r\n// http://docs.mathjax.org/en/latest/tex.html#supported-latex-commands\r\n// http://www.onemathematicalcat.org/MathJaxDocumentation/TeXSyntax.htm\r\n\r\n// LaTeX Reference\r\n// http://ctan.sharelatex.com/tex-archive/info/latex2e-help-texinfo/latex2e.html\r\n\r\n// iBooks Author/Pages\r\n// https://support.apple.com/en-au/HT202501\r\n\r\n// Mathematica Reference\r\n// https://reference.wolfram.com/language/tutorial/NamesOfSymbolsAndMathematicalObjects.html\r\n// https://reference.wolfram.com/language/guide/MathematicalTypesetting.html\r\n/*\r\n    * @todo \\sb (equivalent to _) $\\mathfrak{sl}\\sb 2$ frequency 184\r\n    * @todo \\sp (equivalent to ^) $\\mathfrak{sl}\\sp 2$ frequency 274\r\n    * \\intertext    frequency 0\r\n\r\n\r\n    See http://mirrors.ibiblio.org/CTAN/macros/latex/contrib/mathtools/mathtools.pdf\r\n\r\n*/\r\n","/* eslint-disable */\r\n/* -*- Mode: Javascript; indent-tabs-mode:nil; js-indent-level: 2 -*- */\r\n/* vim: set ts=2 et sw=2 tw=80: */\r\n\r\n// @ts-nocheck\r\n\r\n/**\r\n * Mathlive mhchem.ts\r\n *\r\n * This file is an adptation of KaTeX's adaption of MathJax's mhchem\r\n * implementation of the mhchem Latex extension of the same name.\r\n *\r\n *\r\n * See https://mhchem.github.io/MathJax-mhchem/\r\n */\r\n\r\nimport { defineFunction } from './definitions-utils';\r\nimport { parseString } from '../core/parser';\r\nimport { Atom, ToLatexOptions } from '../core/atom-class';\r\nimport { Context } from '../core/context';\r\nimport { Span, makeSpan } from '../core/span';\r\n\r\nclass ChemAtom extends Atom {\r\n    constructor(command: string, arg: string) {\r\n        super('chem', { command, mode: 'math' });\r\n        const tex = texify.go(\r\n            mhchemParser.go(arg, command === '\\\\pu' ? 'pu' : 'ce'),\r\n            false\r\n        );\r\n\r\n        this.body = parseString(tex);\r\n        this.latex = command + '{' + arg + '}';\r\n        this.captureSelection = true;\r\n    }\r\n    render(context: Context): Span[] {\r\n        const span = makeSpan(Atom.render(context, this.body), '', 'mord'); // @revisit\r\n\r\n        if (this.caret) span.caret = this.caret;\r\n        // Need to bind the group so that the DOM element can be matched\r\n        // and the atom iterated recursively. Otherwise, it behaves\r\n        // as if `captureSelection === true`\r\n        this.bind(context, span);\r\n        return [span];\r\n    }\r\n    toLatex(_options: ToLatexOptions): string {\r\n        return this.latex;\r\n    }\r\n}\r\n\r\ndefineFunction(['ce', 'pu'], '{chemformula:balanced-string}', {\r\n    createAtom: (command: string, args: Argument[], style: Style): Atom =>\r\n        new ChemAtom(name, args[0] as string),\r\n});\r\n\r\n/*************************************************************\r\n *\r\n *  MathJax/extensions/TeX/mhchem.js\r\n *\r\n *  Implements the \\ce command for handling chemical formulas\r\n *  from the mhchem LaTeX package.\r\n *\r\n *  ---------------------------------------------------------------------\r\n *\r\n *  Copyright (c) 2011-2015 The MathJax Consortium\r\n *  Copyright (c) 2015-2018 Martin Hensel\r\n *\r\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\r\n *  you may not use this file except in compliance with the License.\r\n *  You may obtain a copy of the License at\r\n *\r\n *      http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n *  Unless required by applicable law or agreed to in writing, software\r\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\r\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n *  See the License for the specific language governing permissions and\r\n *  limitations under the License.\r\n */\r\n\r\n//\r\n// Core parser for mhchem syntax  (recursive)\r\n//\r\n/** @type {MhchemParser} */\r\nvar mhchemParser = {\r\n    //\r\n    // Parses mchem \\ce syntax\r\n    //\r\n    // Call like\r\n    //   go(\"H2O\");\r\n    //\r\n    go: function (input?, stateMachine?) {\r\n        if (!input) {\r\n            return [];\r\n        }\r\n        if (stateMachine === undefined) {\r\n            stateMachine = 'ce';\r\n        }\r\n        var state = '0';\r\n\r\n        //\r\n        // String buffers for parsing:\r\n        //\r\n        // buffer.a == amount\r\n        // buffer.o == element\r\n        // buffer.b == left-side superscript\r\n        // buffer.p == left-side subscript\r\n        // buffer.q == right-side subscript\r\n        // buffer.d == right-side superscript\r\n        //\r\n        // buffer.r == arrow\r\n        // buffer.rdt == arrow, script above, type\r\n        // buffer.rd == arrow, script above, content\r\n        // buffer.rqt == arrow, script below, type\r\n        // buffer.rq == arrow, script below, content\r\n        //\r\n        // buffer.text_\r\n        // buffer.rm\r\n        // etc.\r\n        //\r\n        // buffer.parenthesisLevel == int, starting at 0\r\n        // buffer.sb == bool, space before\r\n        // buffer.beginsWithBond == bool\r\n        //\r\n        // These letters are also used as state names.\r\n        //\r\n        // Other states:\r\n        // 0 == begin of main part (arrow/operator unlikely)\r\n        // 1 == next entity\r\n        // 2 == next entity (arrow/operator unlikely)\r\n        // 3 == next atom\r\n        // c == macro\r\n        //\r\n        /** @type {Buffer} */\r\n        var buffer = {};\r\n        buffer['parenthesisLevel'] = 0;\r\n\r\n        input = input.replace(/\\n/g, ' ');\r\n        input = input.replace(/[\\u2212\\u2013\\u2014\\u2010]/g, '-');\r\n        input = input.replace(/[\\u2026]/g, '...');\r\n\r\n        //\r\n        // Looks through mhchemParser.transitions, to execute a matching action\r\n        // (recursive)\r\n        //\r\n        var lastInput;\r\n        var watchdog = 10;\r\n        /** @type {ParserOutput[]} */\r\n        var output = [];\r\n        while (true) {\r\n            if (lastInput !== input) {\r\n                watchdog = 10;\r\n                lastInput = input;\r\n            } else {\r\n                watchdog--;\r\n            }\r\n            //\r\n            // Find actions in transition table\r\n            //\r\n            var machine = mhchemParser.stateMachines[stateMachine];\r\n            var t = machine.transitions[state] || machine.transitions['*'];\r\n            iterateTransitions: for (var i = 0; i < t.length; i++) {\r\n                var matches = mhchemParser.patterns.match_(t[i].pattern, input);\r\n                if (matches) {\r\n                    //\r\n                    // Execute actions\r\n                    //\r\n                    var task = t[i].task;\r\n                    for (var iA = 0; iA < task.action_.length; iA++) {\r\n                        var o;\r\n                        //\r\n                        // Find and execute action\r\n                        //\r\n                        if (machine.actions[task.action_[iA].type_]) {\r\n                            o = machine.actions[task.action_[iA].type_](\r\n                                buffer,\r\n                                matches.match_,\r\n                                task.action_[iA].option\r\n                            );\r\n                        } else if (\r\n                            mhchemParser.actions[task.action_[iA].type_]\r\n                        ) {\r\n                            o = mhchemParser.actions[task.action_[iA].type_](\r\n                                buffer,\r\n                                matches.match_,\r\n                                task.action_[iA].option\r\n                            );\r\n                        } else {\r\n                            throw [\r\n                                'MhchemBugA',\r\n                                'mhchem bug A. Please report. (' +\r\n                                    task.action_[iA].type_ +\r\n                                    ')',\r\n                            ]; // Trying to use non-existing action\r\n                        }\r\n                        //\r\n                        // Add output\r\n                        //\r\n                        mhchemParser.concatArray(output, o);\r\n                    }\r\n                    //\r\n                    // Set next state,\r\n                    // Shorten input,\r\n                    // Continue with next character\r\n                    //   (= apply only one transition per position)\r\n                    //\r\n                    state = task.nextState || state;\r\n                    if (input.length > 0) {\r\n                        if (!task.revisit) {\r\n                            input = matches.remainder;\r\n                        }\r\n                        if (!task.toContinue) {\r\n                            break iterateTransitions;\r\n                        }\r\n                    } else {\r\n                        return output;\r\n                    }\r\n                }\r\n            }\r\n            //\r\n            // Prevent infinite loop\r\n            //\r\n            if (watchdog <= 0) {\r\n                throw ['MhchemBugU', 'mhchem bug U. Please report.']; // Unexpected character\r\n            }\r\n        }\r\n    },\r\n    concatArray: function (a, b) {\r\n        if (b) {\r\n            if (Array.isArray(b)) {\r\n                for (var iB = 0; iB < b.length; iB++) {\r\n                    a.push(b[iB]);\r\n                }\r\n            } else {\r\n                a.push(b);\r\n            }\r\n        }\r\n    },\r\n\r\n    patterns: {\r\n        //\r\n        // Matching patterns\r\n        // either regexps or function that return null or {match_:\"a\", remainder:\"bc\"}\r\n        //\r\n        patterns: {\r\n            // property names must not look like integers (\"2\") for correct property traversal order, later on\r\n            empty: /^$/,\r\n            else: /^./,\r\n            else2: /^./,\r\n            space: /^\\s/,\r\n            'space A': /^\\s(?=[A-Z\\\\$])/,\r\n            space$: /^\\s$/,\r\n            'a-z': /^[a-z]/,\r\n            x: /^x/,\r\n            x$: /^x$/,\r\n            i$: /^i$/,\r\n            letters: /^(?:[a-zA-Z\\u03B1-\\u03C9\\u0391-\\u03A9?@]|(?:\\\\(?:alpha|beta|gamma|delta|epsilon|zeta|eta|theta|iota|kappa|lambda|mu|nu|xi|omicron|pi|rho|sigma|tau|upsilon|phi|chi|psi|omega|Gamma|Delta|Theta|Lambda|Xi|Pi|Sigma|Upsilon|Phi|Psi|Omega)(?:\\s+|\\{\\}|(?![a-zA-Z]))))+/,\r\n            '\\\\greek': /^\\\\(?:alpha|beta|gamma|delta|epsilon|zeta|eta|theta|iota|kappa|lambda|mu|nu|xi|omicron|pi|rho|sigma|tau|upsilon|phi|chi|psi|omega|Gamma|Delta|Theta|Lambda|Xi|Pi|Sigma|Upsilon|Phi|Psi|Omega)(?:\\s+|\\{\\}|(?![a-zA-Z]))/,\r\n            'one lowercase latin letter $': /^(?:([a-z])(?:$|[^a-zA-Z]))$/,\r\n            '$one lowercase latin letter$ $': /^\\$(?:([a-z])(?:$|[^a-zA-Z]))\\$$/,\r\n            'one lowercase greek letter $': /^(?:\\$?[\\u03B1-\\u03C9]\\$?|\\$?\\\\(?:alpha|beta|gamma|delta|epsilon|zeta|eta|theta|iota|kappa|lambda|mu|nu|xi|omicron|pi|rho|sigma|tau|upsilon|phi|chi|psi|omega)\\s*\\$?)(?:\\s+|\\{\\}|(?![a-zA-Z]))$/,\r\n            digits: /^[0-9]+/,\r\n            '-9.,9': /^[+\\-]?(?:[0-9]+(?:[,.][0-9]+)?|[0-9]*(?:\\.[0-9]+))/,\r\n            '-9.,9 no missing 0': /^[+\\-]?[0-9]+(?:[.,][0-9]+)?/,\r\n            '(-)(9.,9)(e)(99)': function (input) {\r\n                var m = input.match(\r\n                    /^(\\+\\-|\\+\\/\\-|\\+|\\-|\\\\pm\\s?)?([0-9]+(?:[,.][0-9]+)?|[0-9]*(?:\\.[0-9]+))?(\\((?:[0-9]+(?:[,.][0-9]+)?|[0-9]*(?:\\.[0-9]+))\\))?(?:([eE]|\\s*(\\*|x|\\\\times|\\u00D7)\\s*10\\^)([+\\-]?[0-9]+|\\{[+\\-]?[0-9]+\\}))?/\r\n                );\r\n                if (m && m[0]) {\r\n                    return {\r\n                        match_: m.splice(1),\r\n                        remainder: input.substr(m[0].length),\r\n                    };\r\n                }\r\n                return null;\r\n            },\r\n            '(-)(9)^(-9)': function (input) {\r\n                var m = input.match(\r\n                    /^(\\+\\-|\\+\\/\\-|\\+|\\-|\\\\pm\\s?)?([0-9]+(?:[,.][0-9]+)?|[0-9]*(?:\\.[0-9]+)?)\\^([+\\-]?[0-9]+|\\{[+\\-]?[0-9]+\\})/\r\n                );\r\n                if (m && m[0]) {\r\n                    return {\r\n                        match_: m.splice(1),\r\n                        remainder: input.substr(m[0].length),\r\n                    };\r\n                }\r\n                return null;\r\n            },\r\n            'state of aggregation $': function (input) {\r\n                // ... or crystal system\r\n                var a = mhchemParser.patterns.findObserveGroups(\r\n                    input,\r\n                    '',\r\n                    /^\\([a-z]{1,3}(?=[\\),])/,\r\n                    ')',\r\n                    ''\r\n                ); // (aq), (aq,$\\infty$), (aq, sat)\r\n                if (a && a.remainder.match(/^($|[\\s,;\\)\\]\\}])/)) {\r\n                    return a;\r\n                } //  AND end of 'phrase'\r\n                var m = input.match(/^(?:\\((?:\\\\ca\\s?)?\\$[amothc]\\$\\))/); // OR crystal system ($o$) (\\ca$c$)\r\n                if (m) {\r\n                    return {\r\n                        match_: m[0],\r\n                        remainder: input.substr(m[0].length),\r\n                    };\r\n                }\r\n                return null;\r\n            },\r\n            '_{(state of aggregation)}$': /^_\\{(\\([a-z]{1,3}\\))\\}/,\r\n            '{[(': /^(?:\\\\\\{|\\[|\\()/,\r\n            ')]}': /^(?:\\)|\\]|\\\\\\})/,\r\n            ', ': /^[,;]\\s*/,\r\n            ',': /^[,;]/,\r\n            '.': /^[.]/,\r\n            '. ': /^([.\\u22C5\\u00B7\\u2022])\\s*/,\r\n            '...': /^\\.\\.\\.(?=$|[^.])/,\r\n            '* ': /^([*])\\s*/,\r\n            '^{(...)}': function (input) {\r\n                return mhchemParser.patterns.findObserveGroups(\r\n                    input,\r\n                    '^{',\r\n                    '',\r\n                    '',\r\n                    '}'\r\n                );\r\n            },\r\n            '^($...$)': function (input) {\r\n                return mhchemParser.patterns.findObserveGroups(\r\n                    input,\r\n                    '^',\r\n                    '$',\r\n                    '$',\r\n                    ''\r\n                );\r\n            },\r\n            '^a': /^\\^([0-9]+|[^\\\\_])/,\r\n            '^\\\\x{}{}': function (input) {\r\n                return mhchemParser.patterns.findObserveGroups(\r\n                    input,\r\n                    '^',\r\n                    /^\\\\[a-zA-Z]+\\{/,\r\n                    '}',\r\n                    '',\r\n                    '',\r\n                    '{',\r\n                    '}',\r\n                    '',\r\n                    true\r\n                );\r\n            },\r\n            '^\\\\x{}': function (input) {\r\n                return mhchemParser.patterns.findObserveGroups(\r\n                    input,\r\n                    '^',\r\n                    /^\\\\[a-zA-Z]+\\{/,\r\n                    '}',\r\n                    ''\r\n                );\r\n            },\r\n            '^\\\\x': /^\\^(\\\\[a-zA-Z]+)\\s*/,\r\n            '^(-1)': /^\\^(-?\\d+)/,\r\n            \"'\": /^'/,\r\n            '_{(...)}': function (input) {\r\n                return mhchemParser.patterns.findObserveGroups(\r\n                    input,\r\n                    '_{',\r\n                    '',\r\n                    '',\r\n                    '}'\r\n                );\r\n            },\r\n            '_($...$)': function (input) {\r\n                return mhchemParser.patterns.findObserveGroups(\r\n                    input,\r\n                    '_',\r\n                    '$',\r\n                    '$',\r\n                    ''\r\n                );\r\n            },\r\n            _9: /^_([+\\-]?[0-9]+|[^\\\\])/,\r\n            '_\\\\x{}{}': function (input) {\r\n                return mhchemParser.patterns.findObserveGroups(\r\n                    input,\r\n                    '_',\r\n                    /^\\\\[a-zA-Z]+\\{/,\r\n                    '}',\r\n                    '',\r\n                    '',\r\n                    '{',\r\n                    '}',\r\n                    '',\r\n                    true\r\n                );\r\n            },\r\n            '_\\\\x{}': function (input) {\r\n                return mhchemParser.patterns.findObserveGroups(\r\n                    input,\r\n                    '_',\r\n                    /^\\\\[a-zA-Z]+\\{/,\r\n                    '}',\r\n                    ''\r\n                );\r\n            },\r\n            '_\\\\x': /^_(\\\\[a-zA-Z]+)\\s*/,\r\n            '^_': /^(?:\\^(?=_)|\\_(?=\\^)|[\\^_]$)/,\r\n            '{}': /^\\{\\}/,\r\n            '{...}': function (input) {\r\n                return mhchemParser.patterns.findObserveGroups(\r\n                    input,\r\n                    '',\r\n                    '{',\r\n                    '}',\r\n                    ''\r\n                );\r\n            },\r\n            '{(...)}': function (input) {\r\n                return mhchemParser.patterns.findObserveGroups(\r\n                    input,\r\n                    '{',\r\n                    '',\r\n                    '',\r\n                    '}'\r\n                );\r\n            },\r\n            '$...$': function (input) {\r\n                return mhchemParser.patterns.findObserveGroups(\r\n                    input,\r\n                    '',\r\n                    '$',\r\n                    '$',\r\n                    ''\r\n                );\r\n            },\r\n            '${(...)}$': function (input) {\r\n                return mhchemParser.patterns.findObserveGroups(\r\n                    input,\r\n                    '${',\r\n                    '',\r\n                    '',\r\n                    '}$'\r\n                );\r\n            },\r\n            '$(...)$': function (input) {\r\n                return mhchemParser.patterns.findObserveGroups(\r\n                    input,\r\n                    '$',\r\n                    '',\r\n                    '',\r\n                    '$'\r\n                );\r\n            },\r\n            '=<>': /^[=<>]/,\r\n            '#': /^[#\\u2261]/,\r\n            '+': /^\\+/,\r\n            '-$': /^-(?=[\\s_},;\\]/]|$|\\([a-z]+\\))/, // -space -, -; -] -/ -$ -state-of-aggregation\r\n            '-9': /^-(?=[0-9])/,\r\n            '- orbital overlap': /^-(?=(?:[spd]|sp)(?:$|[\\s,;\\)\\]\\}]))/,\r\n            '-': /^-/,\r\n            'pm-operator': /^(?:\\\\pm|\\$\\\\pm\\$|\\+-|\\+\\/-)/,\r\n            operator: /^(?:\\+|(?:[\\-=<>]|<<|>>|\\\\approx|\\$\\\\approx\\$)(?=\\s|$|-?[0-9]))/,\r\n            arrowUpDown: /^(?:v|\\(v\\)|\\^|\\(\\^\\))(?=$|[\\s,;\\)\\]\\}])/,\r\n            '\\\\bond{(...)}': function (input) {\r\n                return mhchemParser.patterns.findObserveGroups(\r\n                    input,\r\n                    '\\\\bond{',\r\n                    '',\r\n                    '',\r\n                    '}'\r\n                );\r\n            },\r\n            '->': /^(?:<->|<-->|->|<-|<=>>|<<=>|<=>|[\\u2192\\u27F6\\u21CC])/,\r\n            CMT: /^[CMT](?=\\[)/,\r\n            '[(...)]': function (input) {\r\n                return mhchemParser.patterns.findObserveGroups(\r\n                    input,\r\n                    '[',\r\n                    '',\r\n                    '',\r\n                    ']'\r\n                );\r\n            },\r\n            '1st-level escape': /^(&|\\\\\\\\|\\\\hline)\\s*/,\r\n            '\\\\,': /^(?:\\\\[,\\ ;:])/, // \\\\x - but output no space before\r\n            '\\\\x{}{}': function (input) {\r\n                return mhchemParser.patterns.findObserveGroups(\r\n                    input,\r\n                    '',\r\n                    /^\\\\[a-zA-Z]+\\{/,\r\n                    '}',\r\n                    '',\r\n                    '',\r\n                    '{',\r\n                    '}',\r\n                    '',\r\n                    true\r\n                );\r\n            },\r\n            '\\\\x{}': function (input) {\r\n                return mhchemParser.patterns.findObserveGroups(\r\n                    input,\r\n                    '',\r\n                    /^\\\\[a-zA-Z]+\\{/,\r\n                    '}',\r\n                    ''\r\n                );\r\n            },\r\n            '\\\\ca': /^\\\\ca(?:\\s+|(?![a-zA-Z]))/,\r\n            '\\\\x': /^(?:\\\\[a-zA-Z]+\\s*|\\\\[_&{}%])/,\r\n            orbital: /^(?:[0-9]{1,2}[spdfgh]|[0-9]{0,2}sp)(?=$|[^a-zA-Z])/, // only those with numbers in front, because the others will be formatted correctly anyway\r\n            others: /^[\\/~|]/,\r\n            '\\\\frac{(...)}': function (input) {\r\n                return mhchemParser.patterns.findObserveGroups(\r\n                    input,\r\n                    '\\\\frac{',\r\n                    '',\r\n                    '',\r\n                    '}',\r\n                    '{',\r\n                    '',\r\n                    '',\r\n                    '}'\r\n                );\r\n            },\r\n            '\\\\overset{(...)}': function (input) {\r\n                return mhchemParser.patterns.findObserveGroups(\r\n                    input,\r\n                    '\\\\overset{',\r\n                    '',\r\n                    '',\r\n                    '}',\r\n                    '{',\r\n                    '',\r\n                    '',\r\n                    '}'\r\n                );\r\n            },\r\n            '\\\\underset{(...)}': function (input) {\r\n                return mhchemParser.patterns.findObserveGroups(\r\n                    input,\r\n                    '\\\\underset{',\r\n                    '',\r\n                    '',\r\n                    '}',\r\n                    '{',\r\n                    '',\r\n                    '',\r\n                    '}'\r\n                );\r\n            },\r\n            '\\\\underbrace{(...)}': function (input) {\r\n                return mhchemParser.patterns.findObserveGroups(\r\n                    input,\r\n                    '\\\\underbrace{',\r\n                    '',\r\n                    '',\r\n                    '}_',\r\n                    '{',\r\n                    '',\r\n                    '',\r\n                    '}'\r\n                );\r\n            },\r\n            '\\\\color{(...)}0': function (input) {\r\n                return mhchemParser.patterns.findObserveGroups(\r\n                    input,\r\n                    '\\\\color{',\r\n                    '',\r\n                    '',\r\n                    '}'\r\n                );\r\n            },\r\n            '\\\\color{(...)}{(...)}1': function (input) {\r\n                return mhchemParser.patterns.findObserveGroups(\r\n                    input,\r\n                    '\\\\color{',\r\n                    '',\r\n                    '',\r\n                    '}',\r\n                    '{',\r\n                    '',\r\n                    '',\r\n                    '}'\r\n                );\r\n            },\r\n            '\\\\color(...){(...)}2': function (input) {\r\n                return mhchemParser.patterns.findObserveGroups(\r\n                    input,\r\n                    '\\\\color',\r\n                    '\\\\',\r\n                    '',\r\n                    /^(?=\\{)/,\r\n                    '{',\r\n                    '',\r\n                    '',\r\n                    '}'\r\n                );\r\n            },\r\n            '\\\\ce{(...)}': function (input) {\r\n                return mhchemParser.patterns.findObserveGroups(\r\n                    input,\r\n                    '\\\\ce{',\r\n                    '',\r\n                    '',\r\n                    '}'\r\n                );\r\n            },\r\n            oxidation$: /^(?:[+-][IVX]+|\\\\pm\\s*0|\\$\\\\pm\\$\\s*0)$/,\r\n            'd-oxidation$': /^(?:[+-]?\\s?[IVX]+|\\\\pm\\s*0|\\$\\\\pm\\$\\s*0)$/, // 0 could be oxidation or charge\r\n            'roman numeral': /^[IVX]+/,\r\n            '1/2$': /^[+\\-]?(?:[0-9]+|\\$[a-z]\\$|[a-z])\\/[0-9]+(?:\\$[a-z]\\$|[a-z])?$/,\r\n            amount: function (input) {\r\n                var match;\r\n                // e.g. 2, 0.5, 1/2, -2, n/2, +;  $a$ could be added later in parsing\r\n                match = input.match(\r\n                    /^(?:(?:(?:\\([+\\-]?[0-9]+\\/[0-9]+\\)|[+\\-]?(?:[0-9]+|\\$[a-z]\\$|[a-z])\\/[0-9]+|[+\\-]?[0-9]+[.,][0-9]+|[+\\-]?\\.[0-9]+|[+\\-]?[0-9]+)(?:[a-z](?=\\s*[A-Z]))?)|[+\\-]?[a-z](?=\\s*[A-Z])|\\+(?!\\s))/\r\n                );\r\n                if (match) {\r\n                    return {\r\n                        match_: match[0],\r\n                        remainder: input.substr(match[0].length),\r\n                    };\r\n                }\r\n                var a = mhchemParser.patterns.findObserveGroups(\r\n                    input,\r\n                    '',\r\n                    '$',\r\n                    '$',\r\n                    ''\r\n                );\r\n                if (a) {\r\n                    // e.g. $2n-1$, $-$\r\n                    match = a.match_.match(\r\n                        /^\\$(?:\\(?[+\\-]?(?:[0-9]*[a-z]?[+\\-])?[0-9]*[a-z](?:[+\\-][0-9]*[a-z]?)?\\)?|\\+|-)\\$$/\r\n                    );\r\n                    if (match) {\r\n                        return {\r\n                            match_: match[0],\r\n                            remainder: input.substr(match[0].length),\r\n                        };\r\n                    }\r\n                }\r\n                return null;\r\n            },\r\n            amount2: function (input) {\r\n                return this['amount'](input);\r\n            },\r\n            '(KV letters),': /^(?:[A-Z][a-z]{0,2}|i)(?=,)/,\r\n            formula$: function (input) {\r\n                if (input.match(/^\\([a-z]+\\)$/)) {\r\n                    return null;\r\n                } // state of aggregation = no formula\r\n                var match = input.match(\r\n                    /^(?:[a-z]|(?:[0-9\\ \\+\\-\\,\\.\\(\\)]+[a-z])+[0-9\\ \\+\\-\\,\\.\\(\\)]*|(?:[a-z][0-9\\ \\+\\-\\,\\.\\(\\)]+)+[a-z]?)$/\r\n                );\r\n                if (match) {\r\n                    return {\r\n                        match_: match[0],\r\n                        remainder: input.substr(match[0].length),\r\n                    };\r\n                }\r\n                return null;\r\n            },\r\n            uprightEntities: /^(?:pH|pOH|pC|pK|iPr|iBu)(?=$|[^a-zA-Z])/,\r\n            '/': /^\\s*(\\/)\\s*/,\r\n            '//': /^\\s*(\\/\\/)\\s*/,\r\n            '*': /^\\s*[*.]\\s*/,\r\n        },\r\n        findObserveGroups: function (\r\n            input,\r\n            begExcl,\r\n            begIncl,\r\n            endIncl,\r\n            endExcl,\r\n            beg2Excl?,\r\n            beg2Incl?,\r\n            end2Incl?,\r\n            end2Excl?,\r\n            combine?\r\n        ) {\r\n            /** @type {{(input: string, pattern: string | RegExp): string | string[] | null;}} */\r\n            var _match = function (input, pattern) {\r\n                if (typeof pattern === 'string') {\r\n                    if (input.indexOf(pattern) !== 0) {\r\n                        return null;\r\n                    }\r\n                    return pattern;\r\n                } else {\r\n                    var match = input.match(pattern);\r\n                    if (!match) {\r\n                        return null;\r\n                    }\r\n                    return match[0];\r\n                }\r\n            };\r\n            /** @type {{(input: string, i: number, endChars: string | RegExp): {endMatchBegin: number, endMatchEnd: number} | null;}} */\r\n            var _findObserveGroups = function (input, i, endChars) {\r\n                var braces = 0;\r\n                while (i < input.length) {\r\n                    var a = input.charAt(i);\r\n                    var match = _match(input.substr(i), endChars);\r\n                    if (match !== null && braces === 0) {\r\n                        return {\r\n                            endMatchBegin: i,\r\n                            endMatchEnd: i + match.length,\r\n                        };\r\n                    } else if (a === '{') {\r\n                        braces++;\r\n                    } else if (a === '}') {\r\n                        if (braces === 0) {\r\n                            throw [\r\n                                'ExtraCloseMissingOpen',\r\n                                'Extra close brace or missing open brace',\r\n                            ];\r\n                        } else {\r\n                            braces--;\r\n                        }\r\n                    }\r\n                    i++;\r\n                }\r\n                if (braces > 0) {\r\n                    return null;\r\n                }\r\n                return null;\r\n            };\r\n            var match = _match(input, begExcl);\r\n            if (match === null) {\r\n                return null;\r\n            }\r\n            input = input.substr(match.length);\r\n            match = _match(input, begIncl);\r\n            if (match === null) {\r\n                return null;\r\n            }\r\n            var e = _findObserveGroups(input, match.length, endIncl || endExcl);\r\n            if (e === null) {\r\n                return null;\r\n            }\r\n            var match1 = input.substring(\r\n                0,\r\n                endIncl ? e.endMatchEnd : e.endMatchBegin\r\n            );\r\n            if (!(beg2Excl || beg2Incl)) {\r\n                return {\r\n                    match_: match1,\r\n                    remainder: input.substr(e.endMatchEnd),\r\n                };\r\n            } else {\r\n                var group2 = this.findObserveGroups(\r\n                    input.substr(e.endMatchEnd),\r\n                    beg2Excl,\r\n                    beg2Incl,\r\n                    end2Incl,\r\n                    end2Excl\r\n                );\r\n                if (group2 === null) {\r\n                    return null;\r\n                }\r\n                /** @type {string[]} */\r\n                var matchRet = [match1, group2.match_];\r\n                return {\r\n                    match_: combine ? matchRet.join('') : matchRet,\r\n                    remainder: group2.remainder,\r\n                };\r\n            }\r\n        },\r\n\r\n        //\r\n        // Matching function\r\n        // e.g. match(\"a\", input) will look for the regexp called \"a\" and see if it matches\r\n        // returns null or {match_:\"a\", remainder:\"bc\"}\r\n        //\r\n        match_: function (m, input) {\r\n            var pattern = mhchemParser.patterns.patterns[m];\r\n            if (pattern === undefined) {\r\n                throw [\r\n                    'MhchemBugP',\r\n                    'mhchem bug P. Please report. (' + m + ')',\r\n                ]; // Trying to use non-existing pattern\r\n            } else if (typeof pattern === 'function') {\r\n                return mhchemParser.patterns.patterns[m](input); // cannot use cached var pattern here, because some pattern functions need this===mhchemParser\r\n            } else {\r\n                // RegExp\r\n                var match = input.match(pattern);\r\n                if (match) {\r\n                    var mm;\r\n                    if (match[2]) {\r\n                        mm = [match[1], match[2]];\r\n                    } else if (match[1]) {\r\n                        mm = match[1];\r\n                    } else {\r\n                        mm = match[0];\r\n                    }\r\n                    return {\r\n                        match_: mm,\r\n                        remainder: input.substr(match[0].length),\r\n                    };\r\n                }\r\n                return null;\r\n            }\r\n        },\r\n    },\r\n\r\n    //\r\n    // Generic state machine actions\r\n    //\r\n    actions: {\r\n        'a=': function (buffer, m) {\r\n            buffer.a = (buffer.a || '') + m;\r\n        },\r\n        'b=': function (buffer, m) {\r\n            buffer.b = (buffer.b || '') + m;\r\n        },\r\n        'p=': function (buffer, m) {\r\n            buffer.p = (buffer.p || '') + m;\r\n        },\r\n        'o=': function (buffer, m) {\r\n            buffer.o = (buffer.o || '') + m;\r\n        },\r\n        'q=': function (buffer, m) {\r\n            buffer.q = (buffer.q || '') + m;\r\n        },\r\n        'd=': function (buffer, m) {\r\n            buffer.d = (buffer.d || '') + m;\r\n        },\r\n        'rm=': function (buffer, m) {\r\n            buffer.rm = (buffer.rm || '') + m;\r\n        },\r\n        'text=': function (buffer, m) {\r\n            buffer.text_ = (buffer.text_ || '') + m;\r\n        },\r\n        insert: function (buffer, m, a) {\r\n            return { type_: a };\r\n        },\r\n        'insert+p1': function (buffer, m, a) {\r\n            return { type_: a, p1: m };\r\n        },\r\n        'insert+p1+p2': function (buffer, m, a) {\r\n            return { type_: a, p1: m[0], p2: m[1] };\r\n        },\r\n        copy: function (buffer, m) {\r\n            return m;\r\n        },\r\n        rm: function (buffer, m) {\r\n            return { type_: 'rm', p1: m || '' };\r\n        },\r\n        text: function (buffer, m) {\r\n            return mhchemParser.go(m, 'text');\r\n        },\r\n        '{text}': function (buffer, m) {\r\n            var ret = ['{'];\r\n            mhchemParser.concatArray(ret, mhchemParser.go(m, 'text'));\r\n            ret.push('}');\r\n            return ret;\r\n        },\r\n        'tex-math': function (buffer, m) {\r\n            return mhchemParser.go(m, 'tex-math');\r\n        },\r\n        'tex-math tight': function (buffer, m) {\r\n            return mhchemParser.go(m, 'tex-math tight');\r\n        },\r\n        bond: function (buffer, m, k) {\r\n            return { type_: 'bond', kind_: k || m };\r\n        },\r\n        'color0-output': function (buffer, m) {\r\n            return { type_: 'color0', color: m[0] };\r\n        },\r\n        ce: function (buffer, m) {\r\n            return mhchemParser.go(m);\r\n        },\r\n        '1/2': function (buffer, m) {\r\n            /** @type {ParserOutput[]} */\r\n            var ret = [];\r\n            if (m.match(/^[+\\-]/)) {\r\n                ret.push(m.substr(0, 1));\r\n                m = m.substr(1);\r\n            }\r\n            var n = m.match(\r\n                /^([0-9]+|\\$[a-z]\\$|[a-z])\\/([0-9]+)(\\$[a-z]\\$|[a-z])?$/\r\n            );\r\n            n[1] = n[1].replace(/\\$/g, '');\r\n            ret.push({ type_: 'frac', p1: n[1], p2: n[2] });\r\n            if (n[3]) {\r\n                n[3] = n[3].replace(/\\$/g, '');\r\n                ret.push({ type_: 'tex-math', p1: n[3] });\r\n            }\r\n            return ret;\r\n        },\r\n        '9,9': function (buffer, m) {\r\n            return mhchemParser.go(m, '9,9');\r\n        },\r\n    },\r\n    //\r\n    // createTransitions\r\n    // convert  { 'letter': { 'state': { action_: 'output' } } }  to  { 'state' => [ { pattern: 'letter', task: { action_: [{type_: 'output'}] } } ] }\r\n    // with expansion of 'a|b' to 'a' and 'b' (at 2 places)\r\n    //\r\n    createTransitions: function (o) {\r\n        var pattern, state;\r\n        /** @type {string[]} */\r\n        var stateArray;\r\n        var i;\r\n        //\r\n        // 1. Collect all states\r\n        //\r\n        /** @type {Transitions} */\r\n        var transitions = {};\r\n        for (pattern in o) {\r\n            for (state in o[pattern]) {\r\n                stateArray = state.split('|');\r\n                o[pattern][state].stateArray = stateArray;\r\n                for (i = 0; i < stateArray.length; i++) {\r\n                    transitions[stateArray[i]] = [];\r\n                }\r\n            }\r\n        }\r\n        //\r\n        // 2. Fill states\r\n        //\r\n        for (pattern in o) {\r\n            for (state in o[pattern]) {\r\n                stateArray = o[pattern][state].stateArray || [];\r\n                for (i = 0; i < stateArray.length; i++) {\r\n                    //\r\n                    // 2a. Normalize actions into array:  'text=' ==> [{type_:'text='}]\r\n                    // (Note to myself: Resolving the function here would be problematic. It would need .bind (for *this*) and currying (for *option*).)\r\n                    //\r\n                    /** @type {any} */\r\n                    var p = o[pattern][state];\r\n                    if (p.action_) {\r\n                        p.action_ = [].concat(p.action_);\r\n                        for (var k = 0; k < p.action_.length; k++) {\r\n                            if (typeof p.action_[k] === 'string') {\r\n                                p.action_[k] = { type_: p.action_[k] };\r\n                            }\r\n                        }\r\n                    } else {\r\n                        p.action_ = [];\r\n                    }\r\n                    //\r\n                    // 2.b Multi-insert\r\n                    //\r\n                    var patternArray = pattern.split('|');\r\n                    for (var j = 0; j < patternArray.length; j++) {\r\n                        if (stateArray[i] === '*') {\r\n                            // insert into all\r\n                            for (var t in transitions) {\r\n                                transitions[t].push({\r\n                                    pattern: patternArray[j],\r\n                                    task: p,\r\n                                });\r\n                            }\r\n                        } else {\r\n                            transitions[stateArray[i]].push({\r\n                                pattern: patternArray[j],\r\n                                task: p,\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return transitions;\r\n    },\r\n    stateMachines: {},\r\n};\r\n\r\n//\r\n// Definition of state machines\r\n//\r\nmhchemParser.stateMachines = {\r\n    //\r\n    // \\ce state machines\r\n    //\r\n    //#region ce\r\n    ce: {\r\n        // main parser\r\n        transitions: mhchemParser.createTransitions({\r\n            empty: {\r\n                '*': { action_: 'output' },\r\n            },\r\n            else: {\r\n                '0|1|2': {\r\n                    action_: 'beginsWithBond=false',\r\n                    revisit: true,\r\n                    toContinue: true,\r\n                },\r\n            },\r\n            oxidation$: {\r\n                '0': { action_: 'oxidation-output' },\r\n            },\r\n            CMT: {\r\n                r: { action_: 'rdt=', nextState: 'rt' },\r\n                rd: { action_: 'rqt=', nextState: 'rdt' },\r\n            },\r\n            arrowUpDown: {\r\n                '0|1|2|as': {\r\n                    action_: ['sb=false', 'output', 'operator'],\r\n                    nextState: '1',\r\n                },\r\n            },\r\n            uprightEntities: {\r\n                '0|1|2': { action_: ['o=', 'output'], nextState: '1' },\r\n            },\r\n            orbital: {\r\n                '0|1|2|3': { action_: 'o=', nextState: 'o' },\r\n            },\r\n            '->': {\r\n                '0|1|2|3': { action_: 'r=', nextState: 'r' },\r\n                'a|as': { action_: ['output', 'r='], nextState: 'r' },\r\n                '*': { action_: ['output', 'r='], nextState: 'r' },\r\n            },\r\n            '+': {\r\n                o: { action_: 'd= kv', nextState: 'd' },\r\n                'd|D': { action_: 'd=', nextState: 'd' },\r\n                q: { action_: 'd=', nextState: 'qd' },\r\n                'qd|qD': { action_: 'd=', nextState: 'qd' },\r\n                dq: { action_: ['output', 'd='], nextState: 'd' },\r\n                '3': {\r\n                    action_: ['sb=false', 'output', 'operator'],\r\n                    nextState: '0',\r\n                },\r\n            },\r\n            amount: {\r\n                '0|2': { action_: 'a=', nextState: 'a' },\r\n            },\r\n            'pm-operator': {\r\n                '0|1|2|a|as': {\r\n                    action_: [\r\n                        'sb=false',\r\n                        'output',\r\n                        { type_: 'operator', option: '\\\\pm' },\r\n                    ],\r\n                    nextState: '0',\r\n                },\r\n            },\r\n            operator: {\r\n                '0|1|2|a|as': {\r\n                    action_: ['sb=false', 'output', 'operator'],\r\n                    nextState: '0',\r\n                },\r\n            },\r\n            '-$': {\r\n                'o|q': {\r\n                    action_: ['charge or bond', 'output'],\r\n                    nextState: 'qd',\r\n                },\r\n                d: { action_: 'd=', nextState: 'd' },\r\n                D: {\r\n                    action_: ['output', { type_: 'bond', option: '-' }],\r\n                    nextState: '3',\r\n                },\r\n                q: { action_: 'd=', nextState: 'qd' },\r\n                qd: { action_: 'd=', nextState: 'qd' },\r\n                'qD|dq': {\r\n                    action_: ['output', { type_: 'bond', option: '-' }],\r\n                    nextState: '3',\r\n                },\r\n            },\r\n            '-9': {\r\n                '3|o': {\r\n                    action_: ['output', { type_: 'insert', option: 'hyphen' }],\r\n                    nextState: '3',\r\n                },\r\n            },\r\n            '- orbital overlap': {\r\n                o: {\r\n                    action_: ['output', { type_: 'insert', option: 'hyphen' }],\r\n                    nextState: '2',\r\n                },\r\n                d: {\r\n                    action_: ['output', { type_: 'insert', option: 'hyphen' }],\r\n                    nextState: '2',\r\n                },\r\n            },\r\n            '-': {\r\n                '0|1|2': {\r\n                    action_: [\r\n                        { type_: 'output', option: 1 },\r\n                        'beginsWithBond=true',\r\n                        { type_: 'bond', option: '-' },\r\n                    ],\r\n                    nextState: '3',\r\n                },\r\n                '3': { action_: { type_: 'bond', option: '-' } },\r\n                a: {\r\n                    action_: ['output', { type_: 'insert', option: 'hyphen' }],\r\n                    nextState: '2',\r\n                },\r\n                as: {\r\n                    action_: [\r\n                        { type_: 'output', option: 2 },\r\n                        { type_: 'bond', option: '-' },\r\n                    ],\r\n                    nextState: '3',\r\n                },\r\n                b: { action_: 'b=' },\r\n                o: {\r\n                    action_: { type_: '- after o/d', option: false },\r\n                    nextState: '2',\r\n                },\r\n                q: {\r\n                    action_: { type_: '- after o/d', option: false },\r\n                    nextState: '2',\r\n                },\r\n                'd|qd|dq': {\r\n                    action_: { type_: '- after o/d', option: true },\r\n                    nextState: '2',\r\n                },\r\n                'D|qD|p': {\r\n                    action_: ['output', { type_: 'bond', option: '-' }],\r\n                    nextState: '3',\r\n                },\r\n            },\r\n            amount2: {\r\n                '1|3': { action_: 'a=', nextState: 'a' },\r\n            },\r\n            letters: {\r\n                '0|1|2|3|a|as|b|p|bp|o': { action_: 'o=', nextState: 'o' },\r\n                'q|dq': { action_: ['output', 'o='], nextState: 'o' },\r\n                'd|D|qd|qD': { action_: 'o after d', nextState: 'o' },\r\n            },\r\n            digits: {\r\n                o: { action_: 'q=', nextState: 'q' },\r\n                'd|D': { action_: 'q=', nextState: 'dq' },\r\n                q: { action_: ['output', 'o='], nextState: 'o' },\r\n                a: { action_: 'o=', nextState: 'o' },\r\n            },\r\n            'space A': {\r\n                'b|p|bp': {},\r\n            },\r\n            space: {\r\n                a: { nextState: 'as' },\r\n                '0': { action_: 'sb=false' },\r\n                '1|2': { action_: 'sb=true' },\r\n                'r|rt|rd|rdt|rdq': { action_: 'output', nextState: '0' },\r\n                '*': { action_: ['output', 'sb=true'], nextState: '1' },\r\n            },\r\n            '1st-level escape': {\r\n                '1|2': {\r\n                    action_: [\r\n                        'output',\r\n                        { type_: 'insert+p1', option: '1st-level escape' },\r\n                    ],\r\n                },\r\n                '*': {\r\n                    action_: [\r\n                        'output',\r\n                        { type_: 'insert+p1', option: '1st-level escape' },\r\n                    ],\r\n                    nextState: '0',\r\n                },\r\n            },\r\n            '[(...)]': {\r\n                'r|rt': { action_: 'rd=', nextState: 'rd' },\r\n                'rd|rdt': { action_: 'rq=', nextState: 'rdq' },\r\n            },\r\n            '...': {\r\n                'o|d|D|dq|qd|qD': {\r\n                    action_: ['output', { type_: 'bond', option: '...' }],\r\n                    nextState: '3',\r\n                },\r\n                '*': {\r\n                    action_: [\r\n                        { type_: 'output', option: 1 },\r\n                        { type_: 'insert', option: 'ellipsis' },\r\n                    ],\r\n                    nextState: '1',\r\n                },\r\n            },\r\n            '. |* ': {\r\n                '*': {\r\n                    action_: [\r\n                        'output',\r\n                        { type_: 'insert', option: 'addition compound' },\r\n                    ],\r\n                    nextState: '1',\r\n                },\r\n            },\r\n            'state of aggregation $': {\r\n                '*': {\r\n                    action_: ['output', 'state of aggregation'],\r\n                    nextState: '1',\r\n                },\r\n            },\r\n            '{[(': {\r\n                'a|as|o': {\r\n                    action_: ['o=', 'output', 'parenthesisLevel++'],\r\n                    nextState: '2',\r\n                },\r\n                '0|1|2|3': {\r\n                    action_: ['o=', 'output', 'parenthesisLevel++'],\r\n                    nextState: '2',\r\n                },\r\n                '*': {\r\n                    action_: ['output', 'o=', 'output', 'parenthesisLevel++'],\r\n                    nextState: '2',\r\n                },\r\n            },\r\n            ')]}': {\r\n                '0|1|2|3|b|p|bp|o': {\r\n                    action_: ['o=', 'parenthesisLevel--'],\r\n                    nextState: 'o',\r\n                },\r\n                'a|as|d|D|q|qd|qD|dq': {\r\n                    action_: ['output', 'o=', 'parenthesisLevel--'],\r\n                    nextState: 'o',\r\n                },\r\n            },\r\n            ', ': {\r\n                '*': { action_: ['output', 'comma'], nextState: '0' },\r\n            },\r\n            '^_': {\r\n                // ^ and _ without a sensible argument\r\n                '*': {},\r\n            },\r\n            '^{(...)}|^($...$)': {\r\n                '0|1|2|as': { action_: 'b=', nextState: 'b' },\r\n                p: { action_: 'b=', nextState: 'bp' },\r\n                '3|o': { action_: 'd= kv', nextState: 'D' },\r\n                q: { action_: 'd=', nextState: 'qD' },\r\n                'd|D|qd|qD|dq': { action_: ['output', 'd='], nextState: 'D' },\r\n            },\r\n            \"^a|^\\\\x{}{}|^\\\\x{}|^\\\\x|'\": {\r\n                '0|1|2|as': { action_: 'b=', nextState: 'b' },\r\n                p: { action_: 'b=', nextState: 'bp' },\r\n                '3|o': { action_: 'd= kv', nextState: 'd' },\r\n                q: { action_: 'd=', nextState: 'qd' },\r\n                'd|qd|D|qD': { action_: 'd=' },\r\n                dq: { action_: ['output', 'd='], nextState: 'd' },\r\n            },\r\n            '_{(state of aggregation)}$': {\r\n                'd|D|q|qd|qD|dq': { action_: ['output', 'q='], nextState: 'q' },\r\n            },\r\n            '_{(...)}|_($...$)|_9|_\\\\x{}{}|_\\\\x{}|_\\\\x': {\r\n                '0|1|2|as': { action_: 'p=', nextState: 'p' },\r\n                b: { action_: 'p=', nextState: 'bp' },\r\n                '3|o': { action_: 'q=', nextState: 'q' },\r\n                'd|D': { action_: 'q=', nextState: 'dq' },\r\n                'q|qd|qD|dq': { action_: ['output', 'q='], nextState: 'q' },\r\n            },\r\n            '=<>': {\r\n                '0|1|2|3|a|as|o|q|d|D|qd|qD|dq': {\r\n                    action_: [{ type_: 'output', option: 2 }, 'bond'],\r\n                    nextState: '3',\r\n                },\r\n            },\r\n            '#': {\r\n                '0|1|2|3|a|as|o': {\r\n                    action_: [\r\n                        { type_: 'output', option: 2 },\r\n                        { type_: 'bond', option: '#' },\r\n                    ],\r\n                    nextState: '3',\r\n                },\r\n            },\r\n            '{}': {\r\n                '*': {\r\n                    action_: { type_: 'output', option: 1 },\r\n                    nextState: '1',\r\n                },\r\n            },\r\n            '{...}': {\r\n                '0|1|2|3|a|as|b|p|bp': { action_: 'o=', nextState: 'o' },\r\n                'o|d|D|q|qd|qD|dq': {\r\n                    action_: ['output', 'o='],\r\n                    nextState: 'o',\r\n                },\r\n            },\r\n            '$...$': {\r\n                a: { action_: 'a=' }, // 2$n$\r\n                '0|1|2|3|as|b|p|bp|o': { action_: 'o=', nextState: 'o' }, // not 'amount'\r\n                'as|o': { action_: 'o=' },\r\n                'q|d|D|qd|qD|dq': { action_: ['output', 'o='], nextState: 'o' },\r\n            },\r\n            '\\\\bond{(...)}': {\r\n                '*': {\r\n                    action_: [{ type_: 'output', option: 2 }, 'bond'],\r\n                    nextState: '3',\r\n                },\r\n            },\r\n            '\\\\frac{(...)}': {\r\n                '*': {\r\n                    action_: [{ type_: 'output', option: 1 }, 'frac-output'],\r\n                    nextState: '3',\r\n                },\r\n            },\r\n            '\\\\overset{(...)}': {\r\n                '*': {\r\n                    action_: [{ type_: 'output', option: 2 }, 'overset-output'],\r\n                    nextState: '3',\r\n                },\r\n            },\r\n            '\\\\underset{(...)}': {\r\n                '*': {\r\n                    action_: [\r\n                        { type_: 'output', option: 2 },\r\n                        'underset-output',\r\n                    ],\r\n                    nextState: '3',\r\n                },\r\n            },\r\n            '\\\\underbrace{(...)}': {\r\n                '*': {\r\n                    action_: [\r\n                        { type_: 'output', option: 2 },\r\n                        'underbrace-output',\r\n                    ],\r\n                    nextState: '3',\r\n                },\r\n            },\r\n            '\\\\color{(...)}{(...)}1|\\\\color(...){(...)}2': {\r\n                '*': {\r\n                    action_: [{ type_: 'output', option: 2 }, 'color-output'],\r\n                    nextState: '3',\r\n                },\r\n            },\r\n            '\\\\color{(...)}0': {\r\n                '*': {\r\n                    action_: [{ type_: 'output', option: 2 }, 'color0-output'],\r\n                },\r\n            },\r\n            '\\\\ce{(...)}': {\r\n                '*': {\r\n                    action_: [{ type_: 'output', option: 2 }, 'ce'],\r\n                    nextState: '3',\r\n                },\r\n            },\r\n            '\\\\,': {\r\n                '*': {\r\n                    action_: [{ type_: 'output', option: 1 }, 'copy'],\r\n                    nextState: '1',\r\n                },\r\n            },\r\n            '\\\\x{}{}|\\\\x{}|\\\\x': {\r\n                '0|1|2|3|a|as|b|p|bp|o|c0': {\r\n                    action_: ['o=', 'output'],\r\n                    nextState: '3',\r\n                },\r\n                '*': { action_: ['output', 'o=', 'output'], nextState: '3' },\r\n            },\r\n            others: {\r\n                '*': {\r\n                    action_: [{ type_: 'output', option: 1 }, 'copy'],\r\n                    nextState: '3',\r\n                },\r\n            },\r\n            else2: {\r\n                a: { action_: 'a to o', nextState: 'o', revisit: true },\r\n                as: {\r\n                    action_: ['output', 'sb=true'],\r\n                    nextState: '1',\r\n                    revisit: true,\r\n                },\r\n                'r|rt|rd|rdt|rdq': {\r\n                    action_: ['output'],\r\n                    nextState: '0',\r\n                    revisit: true,\r\n                },\r\n                '*': { action_: ['output', 'copy'], nextState: '3' },\r\n            },\r\n        }),\r\n        actions: {\r\n            'o after d': function (buffer, m) {\r\n                var ret;\r\n                if ((buffer.d || '').match(/^[0-9]+$/)) {\r\n                    var tmp = buffer.d;\r\n                    buffer.d = undefined;\r\n                    ret = this['output'](buffer);\r\n                    buffer.b = tmp;\r\n                } else {\r\n                    ret = this['output'](buffer);\r\n                }\r\n                mhchemParser.actions['o='](buffer, m);\r\n                return ret;\r\n            },\r\n            'd= kv': function (buffer, m) {\r\n                buffer.d = m;\r\n                buffer.dType = 'kv';\r\n            },\r\n            'charge or bond': function (buffer, m) {\r\n                if (buffer['beginsWithBond']) {\r\n                    /** @type {ParserOutput[]} */\r\n                    var ret = [];\r\n                    mhchemParser.concatArray(ret, this['output'](buffer));\r\n                    mhchemParser.concatArray(\r\n                        ret,\r\n                        mhchemParser.actions['bond'](buffer, m, '-')\r\n                    );\r\n                    return ret;\r\n                } else {\r\n                    buffer.d = m;\r\n                }\r\n            },\r\n            '- after o/d': function (buffer, m, isAfterD) {\r\n                var c1 = mhchemParser.patterns.match_(\r\n                    'orbital',\r\n                    buffer.o || ''\r\n                );\r\n                var c2 = mhchemParser.patterns.match_(\r\n                    'one lowercase greek letter $',\r\n                    buffer.o || ''\r\n                );\r\n                var c3 = mhchemParser.patterns.match_(\r\n                    'one lowercase latin letter $',\r\n                    buffer.o || ''\r\n                );\r\n                var c4 = mhchemParser.patterns.match_(\r\n                    '$one lowercase latin letter$ $',\r\n                    buffer.o || ''\r\n                );\r\n                var hyphenFollows =\r\n                    m === '-' &&\r\n                    ((c1 && c1.remainder === '') || c2 || c3 || c4);\r\n                if (\r\n                    hyphenFollows &&\r\n                    !buffer.a &&\r\n                    !buffer.b &&\r\n                    !buffer.p &&\r\n                    !buffer.d &&\r\n                    !buffer.q &&\r\n                    !c1 &&\r\n                    c3\r\n                ) {\r\n                    buffer.o = '$' + buffer.o + '$';\r\n                }\r\n                /** @type {ParserOutput[]} */\r\n                var ret = [];\r\n                if (hyphenFollows) {\r\n                    mhchemParser.concatArray(ret, this['output'](buffer));\r\n                    ret.push({ type_: 'hyphen' });\r\n                } else {\r\n                    c1 = mhchemParser.patterns.match_('digits', buffer.d || '');\r\n                    if (isAfterD && c1 && c1.remainder === '') {\r\n                        mhchemParser.concatArray(\r\n                            ret,\r\n                            mhchemParser.actions['d='](buffer, m)\r\n                        );\r\n                        mhchemParser.concatArray(ret, this['output'](buffer));\r\n                    } else {\r\n                        mhchemParser.concatArray(ret, this['output'](buffer));\r\n                        mhchemParser.concatArray(\r\n                            ret,\r\n                            mhchemParser.actions['bond'](buffer, m, '-')\r\n                        );\r\n                    }\r\n                }\r\n                return ret;\r\n            },\r\n            'a to o': function (buffer) {\r\n                buffer.o = buffer.a;\r\n                buffer.a = undefined;\r\n            },\r\n            'sb=true': function (buffer) {\r\n                buffer.sb = true;\r\n            },\r\n            'sb=false': function (buffer) {\r\n                buffer.sb = false;\r\n            },\r\n            'beginsWithBond=true': function (buffer) {\r\n                buffer['beginsWithBond'] = true;\r\n            },\r\n            'beginsWithBond=false': function (buffer) {\r\n                buffer['beginsWithBond'] = false;\r\n            },\r\n            'parenthesisLevel++': function (buffer) {\r\n                buffer['parenthesisLevel']++;\r\n            },\r\n            'parenthesisLevel--': function (buffer) {\r\n                buffer['parenthesisLevel']--;\r\n            },\r\n            'state of aggregation': function (buffer, m) {\r\n                return {\r\n                    type_: 'state of aggregation',\r\n                    p1: mhchemParser.go(m, 'o'),\r\n                };\r\n            },\r\n            comma: function (buffer, m) {\r\n                var a = m.replace(/\\s*$/, '');\r\n                var withSpace = a !== m;\r\n                if (withSpace && buffer['parenthesisLevel'] === 0) {\r\n                    return { type_: 'comma enumeration L', p1: a };\r\n                } else {\r\n                    return { type_: 'comma enumeration M', p1: a };\r\n                }\r\n            },\r\n            output: function (buffer, m, entityFollows) {\r\n                // entityFollows:\r\n                //   undefined = if we have nothing else to output, also ignore the just read space (buffer.sb)\r\n                //   1 = an entity follows, never omit the space if there was one just read before (can only apply to state 1)\r\n                //   2 = 1 + the entity can have an amount, so output a\\, instead of converting it to o (can only apply to states a|as)\r\n                /** @type {ParserOutput | ParserOutput[]} */\r\n                var ret;\r\n                if (!buffer.r) {\r\n                    ret = [];\r\n                    if (\r\n                        !buffer.a &&\r\n                        !buffer.b &&\r\n                        !buffer.p &&\r\n                        !buffer.o &&\r\n                        !buffer.q &&\r\n                        !buffer.d &&\r\n                        !entityFollows\r\n                    ) {\r\n                        //ret = [];\r\n                    } else {\r\n                        if (buffer.sb) {\r\n                            ret.push({ type_: 'entitySkip' });\r\n                        }\r\n                        if (\r\n                            !buffer.o &&\r\n                            !buffer.q &&\r\n                            !buffer.d &&\r\n                            !buffer.b &&\r\n                            !buffer.p &&\r\n                            entityFollows !== 2\r\n                        ) {\r\n                            buffer.o = buffer.a;\r\n                            buffer.a = undefined;\r\n                        } else if (\r\n                            !buffer.o &&\r\n                            !buffer.q &&\r\n                            !buffer.d &&\r\n                            (buffer.b || buffer.p)\r\n                        ) {\r\n                            buffer.o = buffer.a;\r\n                            buffer.d = buffer.b;\r\n                            buffer.q = buffer.p;\r\n                            buffer.a = buffer.b = buffer.p = undefined;\r\n                        } else {\r\n                            if (\r\n                                buffer.o &&\r\n                                buffer.dType === 'kv' &&\r\n                                mhchemParser.patterns.match_(\r\n                                    'd-oxidation$',\r\n                                    buffer.d || ''\r\n                                )\r\n                            ) {\r\n                                buffer.dType = 'oxidation';\r\n                            } else if (\r\n                                buffer.o &&\r\n                                buffer.dType === 'kv' &&\r\n                                !buffer.q\r\n                            ) {\r\n                                buffer.dType = undefined;\r\n                            }\r\n                        }\r\n                        ret.push({\r\n                            type_: 'chemfive',\r\n                            a: mhchemParser.go(buffer.a, 'a'),\r\n                            b: mhchemParser.go(buffer.b, 'bd'),\r\n                            p: mhchemParser.go(buffer.p, 'pq'),\r\n                            o: mhchemParser.go(buffer.o, 'o'),\r\n                            q: mhchemParser.go(buffer.q, 'pq'),\r\n                            d: mhchemParser.go(\r\n                                buffer.d,\r\n                                buffer.dType === 'oxidation'\r\n                                    ? 'oxidation'\r\n                                    : 'bd'\r\n                            ),\r\n                            dType: buffer.dType,\r\n                        });\r\n                    }\r\n                } else {\r\n                    // r\r\n                    /** @type {ParserOutput[]} */\r\n                    var rd;\r\n                    if (buffer.rdt === 'M') {\r\n                        rd = mhchemParser.go(buffer.rd, 'tex-math');\r\n                    } else if (buffer.rdt === 'T') {\r\n                        rd = [{ type_: 'text', p1: buffer.rd || '' }];\r\n                    } else {\r\n                        rd = mhchemParser.go(buffer.rd);\r\n                    }\r\n                    /** @type {ParserOutput[]} */\r\n                    var rq;\r\n                    if (buffer.rqt === 'M') {\r\n                        rq = mhchemParser.go(buffer.rq, 'tex-math');\r\n                    } else if (buffer.rqt === 'T') {\r\n                        rq = [{ type_: 'text', p1: buffer.rq || '' }];\r\n                    } else {\r\n                        rq = mhchemParser.go(buffer.rq);\r\n                    }\r\n                    ret = {\r\n                        type_: 'arrow',\r\n                        r: buffer.r,\r\n                        rd: rd,\r\n                        rq: rq,\r\n                    };\r\n                }\r\n                for (var p in buffer) {\r\n                    if (p !== 'parenthesisLevel' && p !== 'beginsWithBond') {\r\n                        delete buffer[p];\r\n                    }\r\n                }\r\n                return ret;\r\n            },\r\n            'oxidation-output': function (buffer, m) {\r\n                var ret = ['{'];\r\n                mhchemParser.concatArray(ret, mhchemParser.go(m, 'oxidation'));\r\n                ret.push('}');\r\n                return ret;\r\n            },\r\n            'frac-output': function (buffer, m) {\r\n                return {\r\n                    type_: 'frac-ce',\r\n                    p1: mhchemParser.go(m[0]),\r\n                    p2: mhchemParser.go(m[1]),\r\n                };\r\n            },\r\n            'overset-output': function (buffer, m) {\r\n                return {\r\n                    type_: 'overset',\r\n                    p1: mhchemParser.go(m[0]),\r\n                    p2: mhchemParser.go(m[1]),\r\n                };\r\n            },\r\n            'underset-output': function (buffer, m) {\r\n                return {\r\n                    type_: 'underset',\r\n                    p1: mhchemParser.go(m[0]),\r\n                    p2: mhchemParser.go(m[1]),\r\n                };\r\n            },\r\n            'underbrace-output': function (buffer, m) {\r\n                return {\r\n                    type_: 'underbrace',\r\n                    p1: mhchemParser.go(m[0]),\r\n                    p2: mhchemParser.go(m[1]),\r\n                };\r\n            },\r\n            'color-output': function (buffer, m) {\r\n                return {\r\n                    type_: 'color',\r\n                    color1: m[0],\r\n                    color2: mhchemParser.go(m[1]),\r\n                };\r\n            },\r\n            'r=': function (buffer, m) {\r\n                buffer.r = m;\r\n            },\r\n            'rdt=': function (buffer, m) {\r\n                buffer.rdt = m;\r\n            },\r\n            'rd=': function (buffer, m) {\r\n                buffer.rd = m;\r\n            },\r\n            'rqt=': function (buffer, m) {\r\n                buffer.rqt = m;\r\n            },\r\n            'rq=': function (buffer, m) {\r\n                buffer.rq = m;\r\n            },\r\n            operator: function (buffer, m, p1) {\r\n                return { type_: 'operator', kind_: p1 || m };\r\n            },\r\n        },\r\n    },\r\n    a: {\r\n        transitions: mhchemParser.createTransitions({\r\n            empty: {\r\n                '*': {},\r\n            },\r\n            '1/2$': {\r\n                '0': { action_: '1/2' },\r\n            },\r\n            else: {\r\n                '0': { nextState: '1', revisit: true },\r\n            },\r\n            '$(...)$': {\r\n                '*': { action_: 'tex-math tight', nextState: '1' },\r\n            },\r\n            ',': {\r\n                '*': { action_: { type_: 'insert', option: 'commaDecimal' } },\r\n            },\r\n            else2: {\r\n                '*': { action_: 'copy' },\r\n            },\r\n        }),\r\n        actions: {},\r\n    },\r\n    o: {\r\n        transitions: mhchemParser.createTransitions({\r\n            empty: {\r\n                '*': {},\r\n            },\r\n            '1/2$': {\r\n                '0': { action_: '1/2' },\r\n            },\r\n            else: {\r\n                '0': { nextState: '1', revisit: true },\r\n            },\r\n            letters: {\r\n                '*': { action_: 'rm' },\r\n            },\r\n            '\\\\ca': {\r\n                '*': { action_: { type_: 'insert', option: 'circa' } },\r\n            },\r\n            '\\\\x{}{}|\\\\x{}|\\\\x': {\r\n                '*': { action_: 'copy' },\r\n            },\r\n            '${(...)}$|$(...)$': {\r\n                '*': { action_: 'tex-math' },\r\n            },\r\n            '{(...)}': {\r\n                '*': { action_: '{text}' },\r\n            },\r\n            else2: {\r\n                '*': { action_: 'copy' },\r\n            },\r\n        }),\r\n        actions: {},\r\n    },\r\n    text: {\r\n        transitions: mhchemParser.createTransitions({\r\n            empty: {\r\n                '*': { action_: 'output' },\r\n            },\r\n            '{...}': {\r\n                '*': { action_: 'text=' },\r\n            },\r\n            '${(...)}$|$(...)$': {\r\n                '*': { action_: 'tex-math' },\r\n            },\r\n            '\\\\greek': {\r\n                '*': { action_: ['output', 'rm'] },\r\n            },\r\n            '\\\\,|\\\\x{}{}|\\\\x{}|\\\\x': {\r\n                '*': { action_: ['output', 'copy'] },\r\n            },\r\n            else: {\r\n                '*': { action_: 'text=' },\r\n            },\r\n        }),\r\n        actions: {\r\n            output: function (buffer) {\r\n                if (buffer.text_) {\r\n                    /** @type {ParserOutput} */\r\n                    var ret = { type_: 'text', p1: buffer.text_ };\r\n                    for (var p in buffer) {\r\n                        delete buffer[p];\r\n                    }\r\n                    return ret;\r\n                }\r\n            },\r\n        },\r\n    },\r\n    pq: {\r\n        transitions: mhchemParser.createTransitions({\r\n            empty: {\r\n                '*': {},\r\n            },\r\n            'state of aggregation $': {\r\n                '*': { action_: 'state of aggregation' },\r\n            },\r\n            i$: {\r\n                '0': { nextState: '!f', revisit: true },\r\n            },\r\n            '(KV letters),': {\r\n                '0': { action_: 'rm', nextState: '0' },\r\n            },\r\n            formula$: {\r\n                '0': { nextState: 'f', revisit: true },\r\n            },\r\n            '1/2$': {\r\n                '0': { action_: '1/2' },\r\n            },\r\n            else: {\r\n                '0': { nextState: '!f', revisit: true },\r\n            },\r\n            '${(...)}$|$(...)$': {\r\n                '*': { action_: 'tex-math' },\r\n            },\r\n            '{(...)}': {\r\n                '*': { action_: 'text' },\r\n            },\r\n            'a-z': {\r\n                f: { action_: 'tex-math' },\r\n            },\r\n            letters: {\r\n                '*': { action_: 'rm' },\r\n            },\r\n            '-9.,9': {\r\n                '*': { action_: '9,9' },\r\n            },\r\n            ',': {\r\n                '*': {\r\n                    action_: {\r\n                        type_: 'insert+p1',\r\n                        option: 'comma enumeration S',\r\n                    },\r\n                },\r\n            },\r\n            '\\\\color{(...)}{(...)}1|\\\\color(...){(...)}2': {\r\n                '*': { action_: 'color-output' },\r\n            },\r\n            '\\\\color{(...)}0': {\r\n                '*': { action_: 'color0-output' },\r\n            },\r\n            '\\\\ce{(...)}': {\r\n                '*': { action_: 'ce' },\r\n            },\r\n            '\\\\,|\\\\x{}{}|\\\\x{}|\\\\x': {\r\n                '*': { action_: 'copy' },\r\n            },\r\n            else2: {\r\n                '*': { action_: 'copy' },\r\n            },\r\n        }),\r\n        actions: {\r\n            'state of aggregation': function (buffer, m) {\r\n                return {\r\n                    type_: 'state of aggregation subscript',\r\n                    p1: mhchemParser.go(m, 'o'),\r\n                };\r\n            },\r\n            'color-output': function (buffer, m) {\r\n                return {\r\n                    type_: 'color',\r\n                    color1: m[0],\r\n                    color2: mhchemParser.go(m[1], 'pq'),\r\n                };\r\n            },\r\n        },\r\n    },\r\n    bd: {\r\n        transitions: mhchemParser.createTransitions({\r\n            empty: {\r\n                '*': {},\r\n            },\r\n            x$: {\r\n                '0': { nextState: '!f', revisit: true },\r\n            },\r\n            formula$: {\r\n                '0': { nextState: 'f', revisit: true },\r\n            },\r\n            else: {\r\n                '0': { nextState: '!f', revisit: true },\r\n            },\r\n            '-9.,9 no missing 0': {\r\n                '*': { action_: '9,9' },\r\n            },\r\n            '.': {\r\n                '*': { action_: { type_: 'insert', option: 'electron dot' } },\r\n            },\r\n            'a-z': {\r\n                f: { action_: 'tex-math' },\r\n            },\r\n            x: {\r\n                '*': { action_: { type_: 'insert', option: 'KV x' } },\r\n            },\r\n            letters: {\r\n                '*': { action_: 'rm' },\r\n            },\r\n            \"'\": {\r\n                '*': { action_: { type_: 'insert', option: 'prime' } },\r\n            },\r\n            '${(...)}$|$(...)$': {\r\n                '*': { action_: 'tex-math' },\r\n            },\r\n            '{(...)}': {\r\n                '*': { action_: 'text' },\r\n            },\r\n            '\\\\color{(...)}{(...)}1|\\\\color(...){(...)}2': {\r\n                '*': { action_: 'color-output' },\r\n            },\r\n            '\\\\color{(...)}0': {\r\n                '*': { action_: 'color0-output' },\r\n            },\r\n            '\\\\ce{(...)}': {\r\n                '*': { action_: 'ce' },\r\n            },\r\n            '\\\\,|\\\\x{}{}|\\\\x{}|\\\\x': {\r\n                '*': { action_: 'copy' },\r\n            },\r\n            else2: {\r\n                '*': { action_: 'copy' },\r\n            },\r\n        }),\r\n        actions: {\r\n            'color-output': function (buffer, m) {\r\n                return {\r\n                    type_: 'color',\r\n                    color1: m[0],\r\n                    color2: mhchemParser.go(m[1], 'bd'),\r\n                };\r\n            },\r\n        },\r\n    },\r\n    oxidation: {\r\n        transitions: mhchemParser.createTransitions({\r\n            empty: {\r\n                '*': {},\r\n            },\r\n            'roman numeral': {\r\n                '*': { action_: 'roman-numeral' },\r\n            },\r\n            '${(...)}$|$(...)$': {\r\n                '*': { action_: 'tex-math' },\r\n            },\r\n            else: {\r\n                '*': { action_: 'copy' },\r\n            },\r\n        }),\r\n        actions: {\r\n            'roman-numeral': function (buffer, m) {\r\n                return { type_: 'roman numeral', p1: m || '' };\r\n            },\r\n        },\r\n    },\r\n    'tex-math': {\r\n        transitions: mhchemParser.createTransitions({\r\n            empty: {\r\n                '*': { action_: 'output' },\r\n            },\r\n            '\\\\ce{(...)}': {\r\n                '*': { action_: ['output', 'ce'] },\r\n            },\r\n            '{...}|\\\\,|\\\\x{}{}|\\\\x{}|\\\\x': {\r\n                '*': { action_: 'o=' },\r\n            },\r\n            else: {\r\n                '*': { action_: 'o=' },\r\n            },\r\n        }),\r\n        actions: {\r\n            output: function (buffer) {\r\n                if (buffer.o) {\r\n                    /** @type {ParserOutput} */\r\n                    var ret = { type_: 'tex-math', p1: buffer.o };\r\n                    for (var p in buffer) {\r\n                        delete buffer[p];\r\n                    }\r\n                    return ret;\r\n                }\r\n            },\r\n        },\r\n    },\r\n    'tex-math tight': {\r\n        transitions: mhchemParser.createTransitions({\r\n            empty: {\r\n                '*': { action_: 'output' },\r\n            },\r\n            '\\\\ce{(...)}': {\r\n                '*': { action_: ['output', 'ce'] },\r\n            },\r\n            '{...}|\\\\,|\\\\x{}{}|\\\\x{}|\\\\x': {\r\n                '*': { action_: 'o=' },\r\n            },\r\n            '-|+': {\r\n                '*': { action_: 'tight operator' },\r\n            },\r\n            else: {\r\n                '*': { action_: 'o=' },\r\n            },\r\n        }),\r\n        actions: {\r\n            'tight operator': function (buffer, m) {\r\n                buffer.o = (buffer.o || '') + '{' + m + '}';\r\n            },\r\n            output: function (buffer) {\r\n                if (buffer.o) {\r\n                    /** @type {ParserOutput} */\r\n                    var ret = { type_: 'tex-math', p1: buffer.o };\r\n                    for (var p in buffer) {\r\n                        delete buffer[p];\r\n                    }\r\n                    return ret;\r\n                }\r\n            },\r\n        },\r\n    },\r\n    '9,9': {\r\n        transitions: mhchemParser.createTransitions({\r\n            empty: {\r\n                '*': {},\r\n            },\r\n            ',': {\r\n                '*': { action_: 'comma' },\r\n            },\r\n            else: {\r\n                '*': { action_: 'copy' },\r\n            },\r\n        }),\r\n        actions: {\r\n            comma: function () {\r\n                return { type_: 'commaDecimal' };\r\n            },\r\n        },\r\n    },\r\n    //#endregion\r\n    //\r\n    // \\pu state machines\r\n    //\r\n    //#region pu\r\n    pu: {\r\n        transitions: mhchemParser.createTransitions({\r\n            empty: {\r\n                '*': { action_: 'output' },\r\n            },\r\n            space$: {\r\n                '*': { action_: ['output', 'space'] },\r\n            },\r\n            '{[(|)]}': {\r\n                '0|a': { action_: 'copy' },\r\n            },\r\n            '(-)(9)^(-9)': {\r\n                '0': { action_: 'number^', nextState: 'a' },\r\n            },\r\n            '(-)(9.,9)(e)(99)': {\r\n                '0': { action_: 'enumber', nextState: 'a' },\r\n            },\r\n            space: {\r\n                '0|a': {},\r\n            },\r\n            'pm-operator': {\r\n                '0|a': {\r\n                    action_: { type_: 'operator', option: '\\\\pm' },\r\n                    nextState: '0',\r\n                },\r\n            },\r\n            operator: {\r\n                '0|a': { action_: 'copy', nextState: '0' },\r\n            },\r\n            '//': {\r\n                d: { action_: 'o=', nextState: '/' },\r\n            },\r\n            '/': {\r\n                d: { action_: 'o=', nextState: '/' },\r\n            },\r\n            '{...}|else': {\r\n                '0|d': { action_: 'd=', nextState: 'd' },\r\n                a: { action_: ['space', 'd='], nextState: 'd' },\r\n                '/|q': { action_: 'q=', nextState: 'q' },\r\n            },\r\n        }),\r\n        actions: {\r\n            enumber: function (buffer, m) {\r\n                /** @type {ParserOutput[]} */\r\n                var ret = [];\r\n                if (m[0] === '+-' || m[0] === '+/-') {\r\n                    ret.push('\\\\pm ');\r\n                } else if (m[0]) {\r\n                    ret.push(m[0]);\r\n                }\r\n                if (m[1]) {\r\n                    mhchemParser.concatArray(\r\n                        ret,\r\n                        mhchemParser.go(m[1], 'pu-9,9')\r\n                    );\r\n                    if (m[2]) {\r\n                        if (m[2].match(/[,.]/)) {\r\n                            mhchemParser.concatArray(\r\n                                ret,\r\n                                mhchemParser.go(m[2], 'pu-9,9')\r\n                            );\r\n                        } else {\r\n                            ret.push(m[2]);\r\n                        }\r\n                    }\r\n                    m[3] = m[4] || m[3];\r\n                    if (m[3]) {\r\n                        m[3] = m[3].trim();\r\n                        if (m[3] === 'e' || m[3].substr(0, 1) === '*') {\r\n                            ret.push({ type_: 'cdot' });\r\n                        } else {\r\n                            ret.push({ type_: 'times' });\r\n                        }\r\n                    }\r\n                }\r\n                if (m[3]) {\r\n                    ret.push('10^{' + m[5] + '}');\r\n                }\r\n                return ret;\r\n            },\r\n            'number^': function (buffer, m) {\r\n                /** @type {ParserOutput[]} */\r\n                var ret = [];\r\n                if (m[0] === '+-' || m[0] === '+/-') {\r\n                    ret.push('\\\\pm ');\r\n                } else if (m[0]) {\r\n                    ret.push(m[0]);\r\n                }\r\n                mhchemParser.concatArray(ret, mhchemParser.go(m[1], 'pu-9,9'));\r\n                ret.push('^{' + m[2] + '}');\r\n                return ret;\r\n            },\r\n            operator: function (buffer, m, p1) {\r\n                return { type_: 'operator', kind_: p1 || m };\r\n            },\r\n            space: function () {\r\n                return { type_: 'pu-space-1' };\r\n            },\r\n            output: function (buffer) {\r\n                /** @type {ParserOutput | ParserOutput[]} */\r\n                var ret;\r\n                var md = mhchemParser.patterns.match_(\r\n                    '{(...)}',\r\n                    buffer.d || ''\r\n                );\r\n                if (md && md.remainder === '') {\r\n                    buffer.d = md.match_;\r\n                }\r\n                var mq = mhchemParser.patterns.match_(\r\n                    '{(...)}',\r\n                    buffer.q || ''\r\n                );\r\n                if (mq && mq.remainder === '') {\r\n                    buffer.q = mq.match_;\r\n                }\r\n                if (buffer.d) {\r\n                    buffer.d = buffer.d.replace(\r\n                        /\\u00B0C|\\^oC|\\^{o}C/g,\r\n                        '{}^{\\\\circ}C'\r\n                    );\r\n                    buffer.d = buffer.d.replace(\r\n                        /\\u00B0F|\\^oF|\\^{o}F/g,\r\n                        '{}^{\\\\circ}F'\r\n                    );\r\n                }\r\n                if (buffer.q) {\r\n                    // fraction\r\n                    buffer.q = buffer.q.replace(\r\n                        /\\u00B0C|\\^oC|\\^{o}C/g,\r\n                        '{}^{\\\\circ}C'\r\n                    );\r\n                    buffer.q = buffer.q.replace(\r\n                        /\\u00B0F|\\^oF|\\^{o}F/g,\r\n                        '{}^{\\\\circ}F'\r\n                    );\r\n                    var b5 = {\r\n                        d: mhchemParser.go(buffer.d, 'pu'),\r\n                        q: mhchemParser.go(buffer.q, 'pu'),\r\n                    };\r\n                    if (buffer.o === '//') {\r\n                        ret = { type_: 'pu-frac', p1: b5.d, p2: b5.q };\r\n                    } else {\r\n                        ret = b5.d;\r\n                        if (b5.d.length > 1 || b5.q.length > 1) {\r\n                            ret.push({ type_: ' / ' });\r\n                        } else {\r\n                            ret.push({ type_: '/' });\r\n                        }\r\n                        mhchemParser.concatArray(ret, b5.q);\r\n                    }\r\n                } else {\r\n                    // no fraction\r\n                    ret = mhchemParser.go(buffer.d, 'pu-2');\r\n                }\r\n                for (var p in buffer) {\r\n                    delete buffer[p];\r\n                }\r\n                return ret;\r\n            },\r\n        },\r\n    },\r\n    'pu-2': {\r\n        transitions: mhchemParser.createTransitions({\r\n            empty: {\r\n                '*': { action_: 'output' },\r\n            },\r\n            '*': {\r\n                '*': { action_: ['output', 'cdot'], nextState: '0' },\r\n            },\r\n            '\\\\x': {\r\n                '*': { action_: 'rm=' },\r\n            },\r\n            space: {\r\n                '*': { action_: ['output', 'space'], nextState: '0' },\r\n            },\r\n            '^{(...)}|^(-1)': {\r\n                '1': { action_: '^(-1)' },\r\n            },\r\n            '-9.,9': {\r\n                '0': { action_: 'rm=', nextState: '0' },\r\n                '1': { action_: '^(-1)', nextState: '0' },\r\n            },\r\n            '{...}|else': {\r\n                '*': { action_: 'rm=', nextState: '1' },\r\n            },\r\n        }),\r\n        actions: {\r\n            cdot: function () {\r\n                return { type_: 'tight cdot' };\r\n            },\r\n            '^(-1)': function (buffer, m) {\r\n                buffer.rm += '^{' + m + '}';\r\n            },\r\n            space: function () {\r\n                return { type_: 'pu-space-2' };\r\n            },\r\n            output: function (buffer) {\r\n                /** @type {ParserOutput | ParserOutput[]} */\r\n                var ret = [];\r\n                if (buffer.rm) {\r\n                    var mrm = mhchemParser.patterns.match_(\r\n                        '{(...)}',\r\n                        buffer.rm || ''\r\n                    );\r\n                    if (mrm && mrm.remainder === '') {\r\n                        ret = mhchemParser.go(mrm.match_, 'pu');\r\n                    } else {\r\n                        ret = { type_: 'rm', p1: buffer.rm };\r\n                    }\r\n                }\r\n                for (var p in buffer) {\r\n                    delete buffer[p];\r\n                }\r\n                return ret;\r\n            },\r\n        },\r\n    },\r\n    'pu-9,9': {\r\n        transitions: mhchemParser.createTransitions({\r\n            empty: {\r\n                '0': { action_: 'output-0' },\r\n                o: { action_: 'output-o' },\r\n            },\r\n            ',': {\r\n                '0': { action_: ['output-0', 'comma'], nextState: 'o' },\r\n            },\r\n            '.': {\r\n                '0': { action_: ['output-0', 'copy'], nextState: 'o' },\r\n            },\r\n            else: {\r\n                '*': { action_: 'text=' },\r\n            },\r\n        }),\r\n        actions: {\r\n            comma: function () {\r\n                return { type_: 'commaDecimal' };\r\n            },\r\n            'output-0': function (buffer) {\r\n                /** @type {ParserOutput[]} */\r\n                var ret = [];\r\n                buffer.text_ = buffer.text_ || '';\r\n                if (buffer.text_.length > 4) {\r\n                    var a = buffer.text_.length % 3;\r\n                    if (a === 0) {\r\n                        a = 3;\r\n                    }\r\n                    for (var i = buffer.text_.length - 3; i > 0; i -= 3) {\r\n                        ret.push(buffer.text_.substr(i, 3));\r\n                        ret.push({ type_: '1000 separator' });\r\n                    }\r\n                    ret.push(buffer.text_.substr(0, a));\r\n                    ret.reverse();\r\n                } else {\r\n                    ret.push(buffer.text_);\r\n                }\r\n                for (var p in buffer) {\r\n                    delete buffer[p];\r\n                }\r\n                return ret;\r\n            },\r\n            'output-o': function (buffer) {\r\n                /** @type {ParserOutput[]} */\r\n                var ret = [];\r\n                buffer.text_ = buffer.text_ || '';\r\n                if (buffer.text_.length > 4) {\r\n                    var a = buffer.text_.length - 3;\r\n                    for (var i = 0; i < a; i += 3) {\r\n                        ret.push(buffer.text_.substr(i, 3));\r\n                        ret.push({ type_: '1000 separator' });\r\n                    }\r\n                    ret.push(buffer.text_.substr(i));\r\n                } else {\r\n                    ret.push(buffer.text_);\r\n                }\r\n                for (var p in buffer) {\r\n                    delete buffer[p];\r\n                }\r\n                return ret;\r\n            },\r\n        },\r\n    },\r\n    //#endregion\r\n};\r\n\r\n//\r\n// texify: Take MhchemParser output and convert it to TeX\r\n//\r\n/** @type {Texify} */\r\nvar texify = {\r\n    go: function (input, isInner) {\r\n        // (recursive, max 4 levels)\r\n        if (!input) {\r\n            return '';\r\n        }\r\n        var res = '';\r\n        var cee = false;\r\n        for (var i = 0; i < input.length; i++) {\r\n            var inputi = input[i];\r\n            if (typeof inputi === 'string') {\r\n                res += inputi;\r\n            } else {\r\n                res += texify._go2(inputi);\r\n                if (inputi.type_ === '1st-level escape') {\r\n                    cee = true;\r\n                }\r\n            }\r\n        }\r\n        if (!isInner && !cee && res) {\r\n            res = '{' + res + '}';\r\n        }\r\n        return res;\r\n    },\r\n    _goInner: function (input) {\r\n        if (!input) {\r\n            return input;\r\n        }\r\n        return texify.go(input, true);\r\n    },\r\n    _go2: function (buf) {\r\n        /** @type {undefined | string} */\r\n        var res;\r\n        switch (buf.type_) {\r\n            case 'chemfive':\r\n                res = '';\r\n                var b5 = {\r\n                    a: texify._goInner(buf.a),\r\n                    b: texify._goInner(buf.b),\r\n                    p: texify._goInner(buf.p),\r\n                    o: texify._goInner(buf.o),\r\n                    q: texify._goInner(buf.q),\r\n                    d: texify._goInner(buf.d),\r\n                };\r\n                //\r\n                // a\r\n                //\r\n                if (b5.a) {\r\n                    if (b5.a.match(/^[+\\-]/)) {\r\n                        b5.a = '{' + b5.a + '}';\r\n                    }\r\n                    res += b5.a + '\\\\,';\r\n                }\r\n                //\r\n                // b and p\r\n                //\r\n                if (b5.b || b5.p) {\r\n                    res += '{\\\\vphantom{X}}';\r\n                    res +=\r\n                        '^{\\\\hphantom{' +\r\n                        (b5.b || '') +\r\n                        '}}_{\\\\hphantom{' +\r\n                        (b5.p || '') +\r\n                        '}}';\r\n                    res += '{\\\\vphantom{X}}';\r\n                    res +=\r\n                        '^{\\\\smash[t]{\\\\vphantom{2}}\\\\mathllap{' +\r\n                        (b5.b || '') +\r\n                        '}}';\r\n                    res +=\r\n                        '_{\\\\vphantom{2}\\\\mathllap{\\\\smash[t]{' +\r\n                        (b5.p || '') +\r\n                        '}}}';\r\n                }\r\n                //\r\n                // o\r\n                //\r\n                if (b5.o) {\r\n                    if (b5.o.match(/^[+\\-]/)) {\r\n                        b5.o = '{' + b5.o + '}';\r\n                    }\r\n                    res += b5.o;\r\n                }\r\n                //\r\n                // q and d\r\n                //\r\n                if (buf.dType === 'kv') {\r\n                    if (b5.d || b5.q) {\r\n                        res += '{\\\\vphantom{X}}';\r\n                    }\r\n                    if (b5.d) {\r\n                        res += '^{' + b5.d + '}';\r\n                    }\r\n                    if (b5.q) {\r\n                        res += '_{\\\\smash[t]{' + b5.q + '}}';\r\n                    }\r\n                } else if (buf.dType === 'oxidation') {\r\n                    if (b5.d) {\r\n                        res += '{\\\\vphantom{X}}';\r\n                        res += '^{' + b5.d + '}';\r\n                    }\r\n                    if (b5.q) {\r\n                        res += '{\\\\vphantom{X}}';\r\n                        res += '_{\\\\smash[t]{' + b5.q + '}}';\r\n                    }\r\n                } else {\r\n                    if (b5.q) {\r\n                        res += '{\\\\vphantom{X}}';\r\n                        res += '_{\\\\smash[t]{' + b5.q + '}}';\r\n                    }\r\n                    if (b5.d) {\r\n                        res += '{\\\\vphantom{X}}';\r\n                        res += '^{' + b5.d + '}';\r\n                    }\r\n                }\r\n                break;\r\n            case 'rm':\r\n                res = '\\\\mathrm{' + buf.p1 + '}';\r\n                break;\r\n            case 'text':\r\n                if (buf.p1.match(/[\\^_]/)) {\r\n                    buf.p1 = buf.p1.replace(' ', '~').replace('-', '\\\\text{-}');\r\n                    res = '\\\\mathrm{' + buf.p1 + '}';\r\n                } else {\r\n                    res = '\\\\text{' + buf.p1 + '}';\r\n                }\r\n                break;\r\n            case 'roman numeral':\r\n                res = '\\\\mathrm{' + buf.p1 + '}';\r\n                break;\r\n            case 'state of aggregation':\r\n                res = '\\\\mskip2mu ' + texify._goInner(buf.p1);\r\n                break;\r\n            case 'state of aggregation subscript':\r\n                res = '\\\\mskip1mu ' + texify._goInner(buf.p1);\r\n                break;\r\n            case 'bond':\r\n                res = texify._getBond(buf.kind_);\r\n                if (!res) {\r\n                    throw [\r\n                        'MhchemErrorBond',\r\n                        'mhchem Error. Unknown bond type (' + buf.kind_ + ')',\r\n                    ];\r\n                }\r\n                break;\r\n            case 'frac':\r\n                var c = '\\\\frac{' + buf.p1 + '}{' + buf.p2 + '}';\r\n                res =\r\n                    '\\\\mathchoice{\\\\textstyle' +\r\n                    c +\r\n                    '}{' +\r\n                    c +\r\n                    '}{' +\r\n                    c +\r\n                    '}{' +\r\n                    c +\r\n                    '}';\r\n                break;\r\n            case 'pu-frac':\r\n                var d =\r\n                    '\\\\frac{' +\r\n                    texify._goInner(buf.p1) +\r\n                    '}{' +\r\n                    texify._goInner(buf.p2) +\r\n                    '}';\r\n                res =\r\n                    '\\\\mathchoice{\\\\textstyle' +\r\n                    d +\r\n                    '}{' +\r\n                    d +\r\n                    '}{' +\r\n                    d +\r\n                    '}{' +\r\n                    d +\r\n                    '}';\r\n                break;\r\n            case 'tex-math':\r\n                res = buf.p1 + ' ';\r\n                break;\r\n            case 'frac-ce':\r\n                res =\r\n                    '\\\\frac{' +\r\n                    texify._goInner(buf.p1) +\r\n                    '}{' +\r\n                    texify._goInner(buf.p2) +\r\n                    '}';\r\n                break;\r\n            case 'overset':\r\n                res =\r\n                    '\\\\overset{' +\r\n                    texify._goInner(buf.p1) +\r\n                    '}{' +\r\n                    texify._goInner(buf.p2) +\r\n                    '}';\r\n                break;\r\n            case 'underset':\r\n                res =\r\n                    '\\\\underset{' +\r\n                    texify._goInner(buf.p1) +\r\n                    '}{' +\r\n                    texify._goInner(buf.p2) +\r\n                    '}';\r\n                break;\r\n            case 'underbrace':\r\n                res =\r\n                    '\\\\underbrace{' +\r\n                    texify._goInner(buf.p1) +\r\n                    '}_{' +\r\n                    texify._goInner(buf.p2) +\r\n                    '}';\r\n                break;\r\n            case 'color':\r\n                res =\r\n                    '{\\\\color{' +\r\n                    buf.color1 +\r\n                    '}{' +\r\n                    texify._goInner(buf.color2) +\r\n                    '}}';\r\n                break;\r\n            case 'color0':\r\n                res = '\\\\color{' + buf.color + '}';\r\n                break;\r\n            case 'arrow':\r\n                var b6 = {\r\n                    rd: texify._goInner(buf.rd),\r\n                    rq: texify._goInner(buf.rq),\r\n                };\r\n                var arrow = '\\\\x' + texify._getArrow(buf.r);\r\n                if (b6.rq) {\r\n                    arrow += '[{' + b6.rq + '}]';\r\n                }\r\n                if (b6.rd) {\r\n                    arrow += '{' + b6.rd + '}';\r\n                } else {\r\n                    arrow += '{}';\r\n                }\r\n                res = arrow;\r\n                break;\r\n            case 'operator':\r\n                res = texify._getOperator(buf.kind_);\r\n                break;\r\n            case '1st-level escape':\r\n                res = buf.p1 + ' '; // &, \\\\\\\\, \\\\hlin\r\n                break;\r\n            case 'space':\r\n                res = ' ';\r\n                break;\r\n            case 'entitySkip':\r\n                res = '~';\r\n                break;\r\n            case 'pu-space-1':\r\n                res = '~';\r\n                break;\r\n            case 'pu-space-2':\r\n                res = '\\\\mkern3mu ';\r\n                break;\r\n            case '1000 separator':\r\n                res = '\\\\mkern2mu ';\r\n                break;\r\n            case 'commaDecimal':\r\n                res = '{,}';\r\n                break;\r\n            case 'comma enumeration L':\r\n                res = '{' + buf.p1 + '}\\\\mkern6mu ';\r\n                break;\r\n            case 'comma enumeration M':\r\n                res = '{' + buf.p1 + '}\\\\mkern3mu ';\r\n                break;\r\n            case 'comma enumeration S':\r\n                res = '{' + buf.p1 + '}\\\\mkern1mu ';\r\n                break;\r\n            case 'hyphen':\r\n                res = '\\\\text{-}';\r\n                break;\r\n            case 'addition compound':\r\n                res = '\\\\,{\\\\cdot}\\\\,';\r\n                break;\r\n            case 'electron dot':\r\n                res = '\\\\mkern1mu \\\\bullet\\\\mkern1mu ';\r\n                break;\r\n            case 'KV x':\r\n                res = '{\\\\times}';\r\n                break;\r\n            case 'prime':\r\n                res = '\\\\prime ';\r\n                break;\r\n            case 'cdot':\r\n                res = '\\\\cdot ';\r\n                break;\r\n            case 'tight cdot':\r\n                res = '\\\\mkern1mu{\\\\cdot}\\\\mkern1mu ';\r\n                break;\r\n            case 'times':\r\n                res = '\\\\times ';\r\n                break;\r\n            case 'circa':\r\n                res = '{\\\\sim}';\r\n                break;\r\n            case '^':\r\n                res = 'uparrow';\r\n                break;\r\n            case 'v':\r\n                res = 'downarrow';\r\n                break;\r\n            case 'ellipsis':\r\n                res = '\\\\ldots ';\r\n                break;\r\n            case '/':\r\n                res = '/';\r\n                break;\r\n            case ' / ':\r\n                res = '\\\\,/\\\\,';\r\n                break;\r\n            default:\r\n                assertNever(buf);\r\n                throw ['MhchemBugT', 'mhchem bug T. Please report.']; // Missing texify rule or unknown MhchemParser output\r\n        }\r\n        assertString(res);\r\n        return res;\r\n    },\r\n    _getArrow: function (a) {\r\n        switch (a) {\r\n            case '->':\r\n                return 'rightarrow';\r\n            case '\\u2192':\r\n                return 'rightarrow';\r\n            case '\\u27F6':\r\n                return 'rightarrow';\r\n            case '<-':\r\n                return 'leftarrow';\r\n            case '<->':\r\n                return 'leftrightarrow';\r\n            case '<-->':\r\n                return 'rightleftarrows';\r\n            case '<=>':\r\n                return 'rightleftharpoons';\r\n            case '\\u21CC':\r\n                return 'rightleftharpoons';\r\n            case '<=>>':\r\n                return 'rightequilibrium';\r\n            case '<<=>':\r\n                return 'leftequilibrium';\r\n            default:\r\n                assertNever(a);\r\n                throw ['MhchemBugT', 'mhchem bug T. Please report.'];\r\n        }\r\n    },\r\n    _getBond: function (a) {\r\n        switch (a) {\r\n            case '-':\r\n                return '{-}';\r\n            case '1':\r\n                return '{-}';\r\n            case '=':\r\n                return '{=}';\r\n            case '2':\r\n                return '{=}';\r\n            case '#':\r\n                return '{\\\\equiv}';\r\n            case '3':\r\n                return '{\\\\equiv}';\r\n            case '~':\r\n                return '{\\\\tripledash}';\r\n            case '~-':\r\n                return '{\\\\mathrlap{\\\\raisebox{-.1em}{$-$}}\\\\raisebox{.1em}{$\\\\tripledash$}}';\r\n            case '~=':\r\n                return '{\\\\mathrlap{\\\\raisebox{-.2em}{$-$}}\\\\mathrlap{\\\\raisebox{.2em}{$\\\\tripledash$}}-}';\r\n            case '~--':\r\n                return '{\\\\mathrlap{\\\\raisebox{-.2em}{$-$}}\\\\mathrlap{\\\\raisebox{.2em}{$\\\\tripledash$}}-}';\r\n            case '-~-':\r\n                return '{\\\\mathrlap{\\\\raisebox{-.2em}{$-$}}\\\\mathrlap{\\\\raisebox{.2em}{$-$}}\\\\tripledash}';\r\n            case '...':\r\n                return '{{\\\\cdot}{\\\\cdot}{\\\\cdot}}';\r\n            case '....':\r\n                return '{{\\\\cdot}{\\\\cdot}{\\\\cdot}{\\\\cdot}}';\r\n            case '->':\r\n                return '{\\\\rightarrow}';\r\n            case '<-':\r\n                return '{\\\\leftarrow}';\r\n            case '<':\r\n                return '{<}';\r\n            case '>':\r\n                return '{>}';\r\n            default:\r\n                assertNever(a);\r\n                throw ['MhchemBugT', 'mhchem bug T. Please report.'];\r\n        }\r\n    },\r\n    _getOperator: function (a) {\r\n        switch (a) {\r\n            case '+':\r\n                return ' {}+{} ';\r\n            case '-':\r\n                return ' {}-{} ';\r\n            case '=':\r\n                return ' {}={} ';\r\n            case '<':\r\n                return ' {}<{} ';\r\n            case '>':\r\n                return ' {}>{} ';\r\n            case '<<':\r\n                return ' {}\\\\ll{} ';\r\n            case '>>':\r\n                return ' {}\\\\gg{} ';\r\n            case '\\\\pm':\r\n                return ' {}\\\\pm{} ';\r\n            case '\\\\approx':\r\n                return ' {}\\\\approx{} ';\r\n            case '$\\\\approx$':\r\n                return ' {}\\\\approx{} ';\r\n            case 'v':\r\n                return ' \\\\downarrow{} ';\r\n            case '(v)':\r\n                return ' \\\\downarrow{} ';\r\n            case '^':\r\n                return ' \\\\uparrow{} ';\r\n            case '(^)':\r\n                return ' \\\\uparrow{} ';\r\n            default:\r\n                assertNever(a);\r\n                throw ['MhchemBugT', 'mhchem bug T. Please report.'];\r\n        }\r\n    },\r\n};\r\n\r\n//\r\n// Helpers for code anaylsis\r\n// Will show type error at calling position\r\n//\r\n/** @param {number} a */\r\nfunction assertNever(a) {}\r\n/** @param {string} a */\r\nfunction assertString(a) {}\r\n","import { Atom, ToLatexOptions } from '../core/atom-class';\r\nimport { METRICS as FONTMETRICS } from '../core/font-metrics';\r\nimport {\r\n    makeSpan,\r\n    depth as spanDepth,\r\n    height as spanHeight,\r\n    Span,\r\n} from '../core/span';\r\nimport { Context } from '../core/context';\r\nimport { Style } from '../public/core';\r\n\r\nexport class BoxAtom extends Atom {\r\n    readonly framecolor?: string;\r\n    readonly verbatimFramecolor?: string;\r\n    readonly backgroundcolor?: string;\r\n    readonly verbatimBackgroundcolor?: string;\r\n    readonly padding?: number;\r\n    readonly border?: string;\r\n\r\n    constructor(\r\n        command: string,\r\n        body: Atom[],\r\n        options: {\r\n            framecolor?: string;\r\n            verbatimFramecolor?: string;\r\n            backgroundcolor?: string;\r\n            verbatimBackgroundcolor?: string;\r\n            padding?: number;\r\n            border?: string;\r\n            style: Style;\r\n            toLatexOverride?: (\r\n                atom: BoxAtom,\r\n                options: ToLatexOptions\r\n            ) => string;\r\n        }\r\n    ) {\r\n        super('box', {\r\n            command,\r\n            toLatexOverride: options.toLatexOverride,\r\n            style: options.style,\r\n        });\r\n        this.body = body;\r\n\r\n        this.framecolor = options.framecolor;\r\n        this.verbatimFramecolor = options.verbatimBackgroundcolor;\r\n        this.backgroundcolor = options.backgroundcolor;\r\n        this.verbatimBackgroundcolor = options.verbatimBackgroundcolor;\r\n        this.padding = options.padding;\r\n        this.border = options.border;\r\n    }\r\n    render(context: Context): Span[] {\r\n        // The padding extends outside of the base\r\n        const padding =\r\n            typeof this.padding === 'number'\r\n                ? this.padding\r\n                : FONTMETRICS.fboxsep;\r\n\r\n        // Base is the main content \"inside\" the box\r\n        const content = makeSpan(Atom.render(context, this.body), '', 'mord');\r\n        content.setStyle('vertical-align', -spanDepth(content), 'em');\r\n        content.setStyle('height', 0);\r\n        const base = makeSpan(content, '', 'mord');\r\n\r\n        // This span will represent the box (background and border)\r\n        // It's positioned to overlap the base\r\n        // The 'ML__box' class is required to prevent the span from being omitted\r\n        // during rendering (it looks like an empty, no-op span)\r\n        const box = makeSpan('', 'ML__box');\r\n        box.setStyle('position', 'absolute');\r\n\r\n        box.setStyle(\r\n            'height',\r\n            spanHeight(base) + spanDepth(base) + 2 * padding,\r\n            'em'\r\n        );\r\n        if (padding !== 0) {\r\n            box.setStyle('width', 'calc(100% + ' + 2 * padding + 'em)');\r\n        } else {\r\n            box.setStyle('width', '100%');\r\n        }\r\n\r\n        box.setStyle('top', -2 * padding, 'em');\r\n        box.setStyle('left', -padding, 'em');\r\n        box.setStyle('z-index', '-1'); // Ensure the box is *behind* the base\r\n        box.setStyle('box-sizing', 'border-box');\r\n\r\n        if (this.backgroundcolor) {\r\n            box.setStyle('background-color', this.backgroundcolor);\r\n        }\r\n        if (this.framecolor) {\r\n            box.setStyle(\r\n                'border',\r\n                FONTMETRICS.fboxrule + 'em solid ' + this.framecolor\r\n            );\r\n        }\r\n        if (this.border) box.setStyle('border', this.border);\r\n\r\n        base.setStyle('display', 'inline-block');\r\n        base.setStyle('height', spanHeight(base) + spanDepth(base), 'em');\r\n\r\n        // The result is a span that encloses the box and the base\r\n        const result = makeSpan([box, base]);\r\n        // Set its position as relative so that the box can be absolute positioned\r\n        // over the base\r\n        result.setStyle('position', 'relative');\r\n        result.setStyle('vertical-align', -padding + spanDepth(base), 'em');\r\n\r\n        // The padding adds to the width and height of the pod\r\n        result.height = spanHeight(base) + padding;\r\n        result.depth = spanDepth(base) + padding;\r\n        result.left = padding;\r\n        result.right = padding;\r\n        result.setStyle(\r\n            'height',\r\n            result.height + result.depth - 2 * padding,\r\n            'em'\r\n        );\r\n        result.setStyle('top', -padding, 'em');\r\n        result.setStyle('display', 'inline-block');\r\n\r\n        if (this.caret) result.caret = this.caret;\r\n\r\n        return [this.attachSupsub(context, result, result.type)];\r\n    }\r\n}\r\n","import { Atom } from '../core/atom-class';\r\nimport { Span, makeSpan, makeVlist } from '../core/span';\r\nimport { Context } from '../core/context';\r\nimport type { Style } from '../public/core';\r\n\r\nexport type PhantomType =\r\n    | 'phantom'\r\n    | 'vphantom'\r\n    | 'hphantom'\r\n    | 'smash'\r\n    | 'bsmash'\r\n    | 'tsmash';\r\nexport class PhantomAtom extends Atom {\r\n    readonly phantomType: PhantomType;\r\n    private isInvisible: boolean;\r\n    constructor(\r\n        command: string,\r\n        body: Atom[],\r\n        options: {\r\n            phantomType?: PhantomType;\r\n            isInvisible?: boolean;\r\n            style: Style;\r\n        }\r\n    ) {\r\n        super('phantom', { command, style: options.style });\r\n        this.captureSelection = true;\r\n        this.body = body;\r\n        this.phantomType = options.phantomType;\r\n        this.isInvisible = options.isInvisible ?? false;\r\n    }\r\n    render(context: Context): Span[] {\r\n        if (this.phantomType === 'vphantom') {\r\n            const content = makeSpan(Atom.render(context, this.body), 'inner');\r\n            content.applyStyle('math', {\r\n                backgroundColor: 'transparent',\r\n                color: 'transparent',\r\n            });\r\n            return [makeSpan([content, makeSpan(null, 'fix')], 'rlap', 'mord')];\r\n        } else if (\r\n            this.phantomType === 'hphantom' ||\r\n            this.phantomType === 'smash' ||\r\n            this.phantomType === 'bsmash' ||\r\n            this.phantomType === 'tsmash'\r\n        ) {\r\n            const content = makeSpan(\r\n                Atom.render(context, this.body),\r\n                '',\r\n                'mord'\r\n            );\r\n            if (this.isInvisible) {\r\n                content.applyStyle('math', {\r\n                    backgroundColor: 'transparent',\r\n                    color: 'transparent',\r\n                });\r\n            }\r\n            if (this.phantomType !== 'bsmash') {\r\n                content.height = 0;\r\n            }\r\n            if (this.phantomType !== 'tsmash') {\r\n                content.depth = 0;\r\n            }\r\n            return [makeSpan(makeVlist(context, [content]), '', 'mord')];\r\n        }\r\n\r\n        return [makeSpan(Atom.render(context, this.body), '', 'mord')];\r\n    }\r\n}\r\n","import { Atom } from '../core/atom-class';\r\nimport { MATHSTYLES } from '../core/mathstyle';\r\nimport { METRICS as FONTMETRICS } from '../core/font-metrics';\r\nimport { Span, makeSpan, makeVlist, height as spanHeight } from '../core/span';\r\nimport { Context } from '../core/context';\r\nimport { Style } from '../public/core';\r\n\r\nexport class LineAtom extends Atom {\r\n    private position: 'overline' | 'underline';\r\n    constructor(\r\n        command: string,\r\n        body: Atom[],\r\n        options: { position: 'overline' | 'underline'; style: Style }\r\n    ) {\r\n        super('line', { command, style: options.style });\r\n        this.skipBoundary = true;\r\n        this.body = body;\r\n        this.position = options.position;\r\n    }\r\n    render(context: Context): Span[] {\r\n        const mathstyle = context.mathstyle;\r\n        // TeXBook:443. Rule 9 and 10\r\n        const inner = Atom.render(context.cramp(), this.body);\r\n        const ruleWidth =\r\n            FONTMETRICS.defaultRuleThickness / mathstyle.sizeMultiplier;\r\n        const line = makeSpan(\r\n            null,\r\n            context.mathstyle.adjustTo(MATHSTYLES.textstyle) +\r\n                ' ' +\r\n                this.position +\r\n                '-line'\r\n        );\r\n        line.height = ruleWidth;\r\n        line.maxFontSize = 1.0;\r\n        let vlist;\r\n        if (this.position === 'overline') {\r\n            vlist = makeVlist(context, [inner, 3 * ruleWidth, line, ruleWidth]);\r\n        } else {\r\n            const innerSpan = makeSpan(inner);\r\n            vlist = makeVlist(\r\n                context,\r\n                [ruleWidth, line, 3 * ruleWidth, innerSpan],\r\n                'top',\r\n                spanHeight(innerSpan)\r\n            );\r\n        }\r\n        if (this.caret) vlist.caret = this.caret;\r\n        return [makeSpan(vlist, this.position, 'mord')];\r\n    }\r\n}\r\n","import { Atom } from '../core/atom-class';\nimport { makeSpan, Span } from '../core/span';\nimport { Context } from '../core/context';\nimport type { Style } from '../public/core';\n\nexport class OverlapAtom extends Atom {\n    private align?: 'left' | 'right';\n    constructor(\n        command: string,\n        body: Atom[],\n        options?: { align?: 'left' | 'right'; style: Style }\n    ) {\n        super('overlap', { command, style: options.style });\n        this.skipBoundary = true;\n        this.body = body;\n        this.align = options?.align ?? 'left';\n    }\n    render(context: Context): Span[] {\n        // For llap (18), rlap (270), clap (0)\n        // smash (common), mathllap (0), mathrlap (0), mathclap (0)\n        // See https://www.tug.org/TUGboat/tb22-4/tb72perlS.pdf\n        // and https://tex.stackexchange.com/questions/98785/what-are-the-different-kinds-of-vertical-spacing-and-horizontal-spacing-commands\n        const inner = makeSpan(Atom.render(context, this.body), 'inner'); // @revisit\n        if (this.caret) inner.caret = this.caret;\n        return [\n            makeSpan(\n                [inner, makeSpan(null, 'fix')],\n                this.align === 'left' ? 'llap' : 'rlap',\n                'mord'\n            ),\n        ];\n    }\n}\n","import { Atom, ToLatexOptions } from '../core/atom-class';\nimport { Context } from '../core/context';\nimport { Span, makeSpan } from '../core/span';\nimport { Style } from '../public/core';\n\nexport class RuleAtom extends Atom {\n    private shift?: number;\n    private depth?: number;\n    private height?: number;\n    private width?: number;\n    constructor(\n        command: string,\n        options: {\n            shift?: number;\n            depth?: number;\n            height: number;\n            width: number;\n            style: Style;\n        }\n    ) {\n        super('rule', { command, style: options.style });\n        this.height = options.height;\n        this.width = options.width;\n        this.depth = options.depth ?? 0;\n        this.shift = options.shift ?? 0;\n    }\n    render(context: Context): Span[] {\n        const mathstyle = context.mathstyle;\n        let shift = isFinite(this.shift) ? this.shift : 0;\n        shift = shift / mathstyle.sizeMultiplier;\n        const width = this.width / mathstyle.sizeMultiplier;\n        const height = this.height / mathstyle.sizeMultiplier;\n        const result = makeSpan('', 'rule', 'mord');\n        result.setStyle('border-right-width', width, 'em');\n        result.setStyle('border-top-width', height, 'em');\n        result.setStyle('margin-top', -(height - shift), 'em');\n        result.setStyle('border-color', context['color']); // @revisit\n        result.width = width;\n        result.height = height + shift;\n        result.depth = -shift;\n        if (this.caret) result.caret = this.caret;\n        return [result];\n    }\n    toLatex(options: ToLatexOptions): string {\n        let result = this.command;\n        if (this.shift) {\n            result += `[${Atom.toLatex(this.shift, options)}em]`;\n        }\n        result +=\n            `{${Atom.toLatex(this.width, options)}em}` +\n            `{${Atom.toLatex(this.height, options)}em}`;\n        return result;\n    }\n}\n","import { Argument, defineFunction } from './definitions-utils';\r\nimport { colorToString, stringToColor } from '../core/color';\r\nimport { Atom, BBoxParam, ToLatexOptions } from '../core/atom-class';\r\nimport { FontShape, FontSeries, Style } from '../public/core';\r\nimport { GroupAtom } from '../core-atoms/group';\r\nimport { BoxAtom } from '../core-atoms/box';\r\nimport { PhantomAtom, PhantomType } from '../core-atoms/phantom';\r\nimport { SizedDelimAtom } from '../core-atoms/delim';\r\nimport { SpacingAtom } from '../core-atoms/spacing';\r\nimport { LineAtom } from '../core-atoms/line';\r\nimport { OverunderAtom } from '../core-atoms/overunder';\r\nimport { OverlapAtom } from '../core-atoms/overlap';\r\nimport { GenfracAtom } from '../core-atoms/genfrac';\r\nimport { RuleAtom } from '../core-atoms/rule';\r\nimport { OperatorAtom } from '../core-atoms/operator';\r\nimport { MathStyleName } from '../core/mathstyle';\r\n\r\ndefineFunction('ensuremath', '{:math}', {\r\n    createAtom: (_name: string, args: Argument[], style: Style): Atom =>\r\n        new GroupAtom(args[0] as Atom[], {\r\n            mode: 'math',\r\n            latexOpen: '\\\\ensuremath{',\r\n            latexClose: '}',\r\n            style,\r\n        }),\r\n});\r\n\r\ndefineFunction('color', '{:color}', {\r\n    applyStyle: (_name, args): Style => {\r\n        return { color: args[0] as string };\r\n    },\r\n});\r\n\r\n// From the xcolor package.\r\n// Unlike what its name might suggest, this command does not set the mode to text\r\n// That is, it can equally be applied to math and text mode.\r\ndefineFunction('textcolor', '{:color}{content:auto*}', {\r\n    applyStyle: (_name, args): Style => {\r\n        return { color: args[0] as string };\r\n    },\r\n});\r\n\r\n// Can be preceded by e.g. '\\fboxsep=4pt' (also \\fboxrule)\r\n// Note:\r\n// - \\boxed: sets content in displaystyle mode (@todo: should change type of argument)\r\n//      equivalent to \\fbox{$$<content>$$}\r\n// - \\fbox: sets content in 'auto' mode (frequency 777)\r\n// - \\framebox[<width>][<alignment>]{<content>} (<alignment> := 'c'|'t'|'b' (center, top, bottom) (frequency 28)\r\n// @todo\r\ndefineFunction('boxed', '{content:math}', {\r\n    createAtom: (name: string, args: Argument[], style: Style): Atom =>\r\n        new BoxAtom(name, args[0] as Atom[], {\r\n            framecolor: 'black',\r\n            style,\r\n        }),\r\n});\r\n\r\n// In LaTeX, \\colorbox sets the mode to text\r\ndefineFunction('colorbox', '{background-color:string}{content:auto}', {\r\n    createAtom: (name: string, args: Argument[], style: Style): Atom =>\r\n        new BoxAtom(name, args[1] as Atom[], {\r\n            backgroundcolor: stringToColor(args[0] as string),\r\n            verbatimBackgroundcolor: args[0] as string, // Save this value to restore it verbatim later\r\n            style,\r\n            toLatexOverride: (atom: BoxAtom, options: ToLatexOptions) =>\r\n                `${atom.command}{${\r\n                    atom.verbatimBackgroundcolor ??\r\n                    colorToString(atom.backgroundcolor)\r\n                }}{${atom.bodyToLatex(options)}}`,\r\n        }),\r\n});\r\n\r\ndefineFunction(\r\n    'fcolorbox',\r\n    '{frame-color:string}{background-color:string}{content:auto}',\r\n    {\r\n        createAtom: (name: string, args: Argument[], style: Style): Atom =>\r\n            new BoxAtom(name, args[2] as Atom[], {\r\n                framecolor: stringToColor(args[0] as string),\r\n                backgroundcolor: stringToColor(args[1] as string),\r\n                verbatimBackgroundcolor: args[1] as string, // Save this value to restore it verbatim later\r\n                verbatimFramecolor: args[0] as string, // Save this value to restore it verbatim later\r\n                style,\r\n                toLatexOverride: (atom: BoxAtom, options: ToLatexOptions) =>\r\n                    `${atom.command}{${\r\n                        atom.verbatimFramecolor ??\r\n                        colorToString(atom.framecolor)\r\n                    }{${\r\n                        atom.verbatimBackgroundcolor ??\r\n                        colorToString(atom.backgroundcolor)\r\n                    }}{${atom.bodyToLatex(options)}}`,\r\n            }),\r\n    }\r\n);\r\n\r\n// \\bbox, MathJax extension\r\n// The first argument is a CSS border property shorthand, e.g.\r\n// \\bbox[red], \\bbox[5px,border:2px solid red]\r\n// The MathJax syntax is\r\n// arglist ::= <arg>[,<arg>[,<arg>]]\r\n// arg ::= [<background:color>|<padding:dimen>|<style>]\r\n// style ::= 'border:' <string>\r\n\r\ndefineFunction('bbox', '[:bbox]{body:auto}', {\r\n    createAtom: (name: string, args: Argument[], style: Style): Atom => {\r\n        if (args[0]) {\r\n            const arg = args[0] as BBoxParam;\r\n            return new BoxAtom(name, args[1] as Atom[], {\r\n                padding: arg.padding,\r\n                border: arg.border,\r\n                backgroundcolor: arg.backgroundcolor,\r\n                style,\r\n                toLatexOverride: (atom: BoxAtom, options: ToLatexOptions) => {\r\n                    let result = name;\r\n                    if (\r\n                        isFinite(atom.padding) ||\r\n                        typeof atom.border !== 'undefined' ||\r\n                        typeof atom.backgroundcolor !== 'undefined'\r\n                    ) {\r\n                        const bboxParams = [];\r\n                        if (isFinite(atom.padding)) {\r\n                            bboxParams.push(\r\n                                Math.floor(1e2 * atom.padding) / 1e2 + 'em'\r\n                            );\r\n                        }\r\n                        if (atom.border) {\r\n                            bboxParams.push('border:' + atom.border);\r\n                        }\r\n                        if (atom.backgroundcolor) {\r\n                            bboxParams.push(\r\n                                colorToString(atom.backgroundcolor)\r\n                            );\r\n                        }\r\n                        result += `[${bboxParams.join(',')}]`;\r\n                    }\r\n\r\n                    return result + `{${atom.bodyToLatex(options)}}`;\r\n                },\r\n            });\r\n        }\r\n        return new BoxAtom(name, args[1] as Atom[], { style });\r\n    },\r\n});\r\n\r\ndefineFunction(\r\n    ['displaystyle', 'textstyle', 'scriptstyle', 'scriptscriptstyle'],\r\n    '{:math*}',\r\n    {\r\n        createAtom: (name: string, args: Argument[], style: Style): Atom =>\r\n            new GroupAtom(args[0] as Atom[], {\r\n                latexOpen: `{${name} `,\r\n                latexClose: '}',\r\n                style,\r\n                mathStyleName: name.slice(1) as MathStyleName,\r\n            }),\r\n    }\r\n);\r\n\r\n// Size\r\ndefineFunction(\r\n    [\r\n        'tiny',\r\n        'scriptsize',\r\n        'footnotesize',\r\n        'small',\r\n        'normalsize',\r\n        'large',\r\n        'Large',\r\n        'LARGE',\r\n        'huge',\r\n        'Huge',\r\n    ],\r\n    '',\r\n    {\r\n        applyMode: 'text',\r\n        applyStyle: (name, _args): Style => {\r\n            return {\r\n                fontSize: {\r\n                    tiny: 'size1',\r\n                    scriptsize: 'size2',\r\n                    footnotesize: 'size3',\r\n                    small: 'size4',\r\n                    normalsize: 'size5',\r\n                    large: 'size6',\r\n                    Large: 'size7',\r\n                    LARGE: 'size8',\r\n                    huge: 'size9',\r\n                    Huge: 'size10',\r\n                }[name.slice(1)],\r\n            };\r\n        },\r\n    }\r\n);\r\n\r\n// \\fontseries only works in text mode\r\ndefineFunction('fontseries', '{:string}', {\r\n    ifMode: 'text',\r\n    applyStyle: (_name, args): Style => {\r\n        return { fontSeries: (args[0] as string) as FontSeries };\r\n    },\r\n});\r\n// SHAPE: italic, small caps\r\ndefineFunction('fontshape', '{:string}', {\r\n    ifMode: 'text',\r\n    applyStyle: (_name, args): Style => {\r\n        return { fontShape: args[0] as FontShape };\r\n    },\r\n});\r\n\r\n// FONT FAMILY: Fraktur, Calligraphic, ...\r\ndefineFunction('fontfamily', '{:string}', {\r\n    ifMode: 'text',\r\n    applyStyle: (_name, args): Style => {\r\n        return { fontFamily: args[0] as string };\r\n    },\r\n});\r\n\r\n// In LaTeX, the \\fontseries, \\fontshape, \\fontfamily, \\fontsize commands\r\n// do not take effect until \\selectfont is encoded. In our implementation,\r\n// they take effect immediately, and \\selectfont is a no-op\r\ndefineFunction('selectfont', '', {\r\n    ifMode: 'text',\r\n    applyStyle: (_name, _args): Style => {\r\n        return {};\r\n    },\r\n});\r\n\r\n// \\bf works in any mode\r\n// As per the LaTeX 2.09 semantics, it overrides shape, family\r\ndefineFunction('bf', '', {\r\n    applyStyle: (_name, _args): Style => {\r\n        return { fontSeries: 'b', fontShape: 'n', fontFamily: 'cmr' };\r\n    },\r\n});\r\n\r\n// Note: These function work a little bit differently than LaTex\r\n// In LaTeX, \\bm{x\\mathrm{y}} yield a bold x and an upright y.\r\n// This is not necesarily intentional, but a side effect of the (current)\r\n// implementation of \\bm\r\ndefineFunction(['boldsymbol', 'bm'], '{:math*}', {\r\n    applyMode: 'math',\r\n    createAtom: (name: string, args: Argument[], style: Style): Atom =>\r\n        new GroupAtom(args[0] as Atom[], {\r\n            latexOpen: `${name}{`,\r\n            latexClose: '}',\r\n            style,\r\n            customClass: 'ML__boldsymbol',\r\n        }),\r\n});\r\n\r\n// Note: switches to math mode\r\ndefineFunction('bold', '{:math*}', {\r\n    applyMode: 'math',\r\n    applyStyle: (_name, _args): Style => {\r\n        return { variantStyle: 'bold' };\r\n    },\r\n});\r\n\r\ndefineFunction('bfseries', '', {\r\n    applyMode: 'text',\r\n    applyStyle: (_name, _args): Style => {\r\n        return { fontSeries: 'b' };\r\n    },\r\n});\r\ndefineFunction('mdseries', '', {\r\n    applyMode: 'text',\r\n    applyStyle: (_name, _args): Style => {\r\n        return { fontSeries: 'm' };\r\n    },\r\n});\r\ndefineFunction('upshape', '', {\r\n    applyMode: 'text',\r\n    applyStyle: (_name, _args): Style => {\r\n        return { fontShape: 'n' };\r\n    },\r\n});\r\ndefineFunction('slshape', '', {\r\n    applyMode: 'text',\r\n    applyStyle: (_name, _args): Style => {\r\n        return { fontShape: 'sl' };\r\n    },\r\n});\r\n// Small caps\r\ndefineFunction('scshape', '', {\r\n    applyMode: 'text',\r\n    applyStyle: (_name, _args): Style => {\r\n        return { fontShape: 'sc' };\r\n    },\r\n});\r\n\r\ndefineFunction('textbf', '{:text*}', {\r\n    applyMode: 'text',\r\n    applyStyle: (_name, _args): Style => {\r\n        return { fontSeries: 'b' };\r\n    },\r\n});\r\ndefineFunction('textmd', '{:text*}', {\r\n    applyMode: 'text',\r\n    applyStyle: (_name, _args): Style => {\r\n        return { fontSeries: 'm' };\r\n    },\r\n});\r\n\r\ndefineFunction('textup', '{:text*}', {\r\n    applyMode: 'text',\r\n    applyStyle: (_name, _args): Style => {\r\n        return { fontShape: 'n' };\r\n    },\r\n});\r\n\r\n// @todo: family could be 'none' or 'default'\r\n// \"normal\" font of the body text, not necessarily roman\r\ndefineFunction('textnormal', '{:text*}', {\r\n    applyMode: 'text',\r\n    applyStyle: (_name, _args): Style => {\r\n        return { fontShape: 'n', fontSeries: 'm' };\r\n    },\r\n});\r\n\r\ndefineFunction('textsl', '{:text*}', {\r\n    applyMode: 'text',\r\n    applyStyle: (_name, _args): Style => {\r\n        return { fontShape: 'sl' };\r\n    },\r\n});\r\n\r\ndefineFunction('textit', '{:text*}', {\r\n    applyMode: 'text',\r\n    applyStyle: (_name, _args): Style => {\r\n        return { fontShape: 'it' };\r\n    },\r\n});\r\n\r\ndefineFunction('textsc', '{:text*}', {\r\n    applyMode: 'text',\r\n    applyStyle: (_name, _args): Style => {\r\n        return { fontShape: 'sc' };\r\n    },\r\n});\r\ndefineFunction('textrm', '{:text*}', {\r\n    applyMode: 'text',\r\n    applyStyle: (_name, _args): Style => {\r\n        return { fontFamily: 'roman' };\r\n    },\r\n});\r\n\r\ndefineFunction('textsf', '{:text*}', {\r\n    applyMode: 'text',\r\n    applyStyle: (_name, _args): Style => {\r\n        return { fontFamily: 'sans-serif' };\r\n    },\r\n});\r\n\r\ndefineFunction('texttt', '{:text*}', {\r\n    applyMode: 'text',\r\n    applyStyle: (_name, _args): Style => {\r\n        return { fontFamily: 'monospace' };\r\n    },\r\n});\r\n\r\n// Note: \\mathbf is a no-op in text mode\r\ndefineFunction('mathbf', '{:math*}', {\r\n    applyMode: 'math',\r\n    applyStyle: (_name, _args): Style => {\r\n        return { variant: 'normal', variantStyle: 'bold' };\r\n    },\r\n});\r\n\r\ndefineFunction('mathit', '{:math*}', {\r\n    applyMode: 'math',\r\n    applyStyle: (_name, _args): Style => {\r\n        return { variant: 'normal', variantStyle: 'italic' };\r\n    },\r\n});\r\n\r\n// From the ISOMath package\r\ndefineFunction('mathbfit', '{:math*}', {\r\n    applyMode: 'math',\r\n    applyStyle: (_name, _args): Style => {\r\n        return { variant: 'normal', variantStyle: 'bolditalic' };\r\n    },\r\n});\r\n\r\ndefineFunction('mathrm', '{:math*}', {\r\n    applyMode: 'math',\r\n    applyStyle: (_name, _args): Style => {\r\n        return { variant: 'normal', variantStyle: 'up' };\r\n    },\r\n});\r\n\r\ndefineFunction('mathsf', '{:math*}', {\r\n    applyMode: 'math',\r\n    applyStyle: (_name, _args): Style => {\r\n        return { variant: 'sans-serif', variantStyle: 'up' };\r\n    },\r\n});\r\ndefineFunction('mathtt', '{:math*}', {\r\n    applyMode: 'math',\r\n    applyStyle: (_name, _args): Style => {\r\n        return { variant: 'monospace', variantStyle: 'up' };\r\n    },\r\n});\r\n\r\ndefineFunction('it', '', {\r\n    applyStyle: (_name, _args): Style => {\r\n        return {\r\n            fontSeries: 'm',\r\n            fontShape: 'it',\r\n            fontFamily: 'cmr',\r\n            variantStyle: 'italic', // For math mode\r\n        };\r\n    },\r\n});\r\n\r\n// In LaTeX, \\rmfamily, \\sffamily and \\ttfamily are no-op in math mode.\r\ndefineFunction('rmfamily', '', {\r\n    applyStyle: (_name, _args): Style => {\r\n        return { fontFamily: 'roman' };\r\n    },\r\n});\r\n\r\ndefineFunction('sffamily', '', {\r\n    applyStyle: (_name, _args): Style => {\r\n        return { fontFamily: 'sans-serif' };\r\n    },\r\n});\r\n\r\ndefineFunction('ttfamily', '', {\r\n    applyStyle: (_name, _args): Style => {\r\n        return { fontFamily: 'monospace' };\r\n    },\r\n});\r\n\r\n// In LaTeX, \\Bbb and \\mathbb are no-op in text mode.\r\n// They also map lowercase characters to different glyphs.\r\n// Note that \\Bbb has been deprecated for over 20 years (as well as \\rm, \\it, \\bf)\r\ndefineFunction(['Bbb', 'mathbb'], '{:math*}', {\r\n    applyStyle: (_name, _args): Style => {\r\n        return { variant: 'double-struck', variantStyle: 'up' };\r\n    },\r\n});\r\n\r\ndefineFunction(['frak', 'mathfrak'], '{:math*}', {\r\n    applyStyle: (_name, _args) => {\r\n        return { variant: 'fraktur', variantStyle: 'up' };\r\n    },\r\n});\r\n\r\ndefineFunction('mathcal', '{:math*}', {\r\n    applyStyle: (_name, _args) => {\r\n        return { variant: 'calligraphic', variantStyle: 'up' };\r\n    },\r\n});\r\n\r\ndefineFunction('mathscr', '{:math*}', {\r\n    applyStyle: (_name, _args): Style => {\r\n        return { variant: 'script', variantStyle: 'up' };\r\n    },\r\n});\r\n\r\n/*\r\n * Rough synomym for \\text{}\r\n * An \\mbox within math mode does not use the current math font; rather it uses\r\n * the typeface of the surrounding running text.\r\n */\r\ndefineFunction('mbox', '{:text}', {\r\n    ifMode: 'math',\r\n    createAtom: (name: string, args: Argument[], style: Style): Atom =>\r\n        new GroupAtom(args[0] as Atom[], {\r\n            latexOpen: name + '{',\r\n            latexClose: '}',\r\n            style,\r\n            mode: 'text',\r\n        }),\r\n});\r\n\r\ndefineFunction('text', '{:text}', {\r\n    ifMode: 'math',\r\n    applyMode: 'text',\r\n});\r\n\r\n/* A MathJax extension: assign a class to the element */\r\ndefineFunction('class', '{name:string}{content:auto*}', {\r\n    createAtom: (_command: string, args: Argument[], style: Style): Atom =>\r\n        new GroupAtom(args[1] as Atom[], {\r\n            customClass: args[0] as string,\r\n            style,\r\n        }),\r\n});\r\n\r\n/* A MathJax extension: assign an ID to the element */\r\ndefineFunction('cssId', '{id:string}{content:auto}', {\r\n    createAtom: (command: string, args: Argument[], style: Style): Atom =>\r\n        new GroupAtom(args[1] as Atom[], {\r\n            cssId: args[0] as string,\r\n            style,\r\n        }),\r\n});\r\n\r\n/* Note: in TeX, \\em is restricted to text mode. We extend it to math\r\n * This is the 'switch' variant of \\emph, i.e:\r\n * `\\emph{important text}`\r\n * `{\\em important text}`\r\n */\r\ndefineFunction('em', '{:auto*}', {\r\n    createAtom: (command: string, args: Argument[], style: Style): Atom =>\r\n        new GroupAtom(args[0] as Atom[], {\r\n            latexOpen: '\\\\em',\r\n            latexClose: '',\r\n            customClass: 'ML__emph',\r\n            style,\r\n        }),\r\n});\r\n\r\n/* Note: in TeX, \\emph is restricted to text mode. We extend it to math */\r\ndefineFunction('emph', '{:auto}', {\r\n    createAtom: (command: string, args: Argument[], style: Style): Atom =>\r\n        new GroupAtom(args[0] as Atom[], {\r\n            latexOpen: '\\\\emph{',\r\n            latexClose: '}',\r\n            customClass: 'ML__emph',\r\n            style,\r\n        }),\r\n});\r\n\r\n// Extra data needed for the delimiter parse function down below\r\nconst DELIMITER_SIZES = {\r\n    '\\\\bigl': { mclass: 'mopen', size: 1 },\r\n    '\\\\Bigl': { mclass: 'mopen', size: 2 },\r\n    '\\\\biggl': { mclass: 'mopen', size: 3 },\r\n    '\\\\Biggl': { mclass: 'mopen', size: 4 },\r\n    '\\\\bigr': { mclass: 'mclose', size: 1 },\r\n    '\\\\Bigr': { mclass: 'mclose', size: 2 },\r\n    '\\\\biggr': { mclass: 'mclose', size: 3 },\r\n    '\\\\Biggr': { mclass: 'mclose', size: 4 },\r\n    '\\\\bigm': { mclass: 'mrel', size: 1 },\r\n    '\\\\Bigm': { mclass: 'mrel', size: 2 },\r\n    '\\\\biggm': { mclass: 'mrel', size: 3 },\r\n    '\\\\Biggm': { mclass: 'mrel', size: 4 },\r\n    '\\\\big': { mclass: 'mord', size: 1 },\r\n    '\\\\Big': { mclass: 'mord', size: 2 },\r\n    '\\\\bigg': { mclass: 'mord', size: 3 },\r\n    '\\\\Bigg': { mclass: 'mord', size: 4 },\r\n};\r\n\r\ndefineFunction(\r\n    [\r\n        'bigl',\r\n        'Bigl',\r\n        'biggl',\r\n        'Biggl',\r\n        'bigr',\r\n        'Bigr',\r\n        'biggr',\r\n        'Biggr',\r\n        'bigm',\r\n        'Bigm',\r\n        'biggm',\r\n        'Biggm',\r\n        'big',\r\n        'Big',\r\n        'bigg',\r\n        'Bigg',\r\n    ],\r\n    '{:delim}',\r\n    {\r\n        createAtom: (name: string, args: Argument[], style: Style): Atom =>\r\n            new SizedDelimAtom(name, args[0] as string, {\r\n                size: DELIMITER_SIZES[name].size,\r\n                delimClass: DELIMITER_SIZES[name].mclass,\r\n                style,\r\n            }),\r\n    }\r\n);\r\n\r\ndefineFunction(\r\n    [\r\n        'hspace',\r\n        'hspace*',\r\n        // \\hspace* inserts a non-breakable space, but since we don't line break...\r\n        // it's the same as \\hspace.\r\n    ],\r\n    '{width:skip}',\r\n    {\r\n        createAtom: (name: string, args: Argument[], style: Style): Atom =>\r\n            new SpacingAtom(name, style, (args[0] as number) ?? 0),\r\n    }\r\n);\r\n\r\ndefineFunction('mathop', '{:auto}', {\r\n    createAtom: (command: string, args: Argument[], style: Style): Atom =>\r\n        new OperatorAtom(command, args[0] as Atom[], {\r\n            type: 'mop',\r\n            captureSelection: true,\r\n            limits: 'limits',\r\n            isFunction: true,\r\n            style,\r\n        }),\r\n});\r\n\r\ndefineFunction(\r\n    [\r\n        'mathbin',\r\n        'mathrel',\r\n        'mathopen',\r\n        'mathclose',\r\n        'mathpunct',\r\n        'mathord',\r\n        'mathinner',\r\n    ],\r\n    '{:auto}',\r\n    {\r\n        createAtom: (command: string, args: Argument[], style: Style): Atom =>\r\n            new OperatorAtom(command, args[0] as Atom[], {\r\n                type: {\r\n                    '\\\\mathbin': 'mbin',\r\n                    '\\\\mathrel': 'mrel',\r\n                    '\\\\mathopen': 'mopen',\r\n                    '\\\\mathclose': 'mclose',\r\n                    '\\\\mathpunct': 'mpunct',\r\n                    '\\\\mathord': 'mord',\r\n                    '\\\\mathinner': 'minner',\r\n                }[command],\r\n                captureSelection: true,\r\n                style,\r\n            }),\r\n    }\r\n);\r\n\r\n// @todo see http://mirrors.ibiblio.org/CTAN/macros/latex/required/amsmath/amsopn.pdf\r\n// for list of additional operators\r\n\r\ndefineFunction(['operatorname', 'operatorname*'], '{operator:math}', {\r\n    createAtom: (name: string, args: Argument[], style: Style): Atom => {\r\n        const result = new OperatorAtom(name, args[0] as Atom[], {\r\n            isFunction: true,\r\n            limits: name === '\\\\operatorname' ? 'nolimits' : 'limits',\r\n            style,\r\n        });\r\n        result.captureSelection = true; // Do not let children be selected\r\n\r\n        /*\r\n        The \\operatorname commands is defined with:\r\n\r\n        \\gdef\\newmcodes@{\\mathcode`\\'39\\mathcode`\\*42\\mathcode`\\.\"613A%\r\n        \\ifnum\\mathcode`\\-=45 \\else\r\n            \\mathchardef\\std@minus\\mathcode`\\-\\relax\r\n        \\fi\r\n        \\mathcode`\\-45\\mathcode`\\/47\\mathcode`\\:\"603A\\relax}\r\n\r\n\r\n        \\mathcode assigns to a character its category (2=mbin), its font family (0=cmr),\r\n        and its character code.\r\n\r\n        It basically temporarily reassigns to \":.'-/*\" the values/properties\r\n        these characters have in text mode (but importantly, not to \" \" (space))\r\n\r\n        */\r\n\r\n        result.body.forEach((x) => {\r\n            if (x.type !== 'first') {\r\n                x.type = 'mord';\r\n                x.value = { '\\u2217': '*', '\\u2212': '-' }[x.value] ?? x.value;\r\n                x.isFunction = false;\r\n                if (!x.style.variant && !x.style.variantStyle) {\r\n                    // No variant as been specified (as it could have been with\r\n                    // \\operatorname{\\mathit{lim}} for example)\r\n                    // Bypass the default auto styling by specifing an upright style\r\n                    x.style.variant = 'main';\r\n                    x.style.variantStyle = 'up';\r\n                }\r\n            }\r\n        });\r\n\r\n        return result;\r\n    },\r\n});\r\n\r\nclass UnicodeAtom extends Atom {\r\n    codepoint: number;\r\n    constructor(arg: string, style: Style) {\r\n        let codepoint = parseInt(arg);\r\n        if (!isFinite(codepoint)) codepoint = 0x2753; // BLACK QUESTION MARK\r\n        super('mord', {\r\n            value: String.fromCodePoint(codepoint),\r\n            style,\r\n        });\r\n        this.codepoint = codepoint;\r\n    }\r\n    toLatex(_options: ToLatexOptions): string {\r\n        return (\r\n            '\\\\unicode\"' +\r\n            ('000000' + this.codepoint.toString(16)).toUpperCase().substr(-6)\r\n        );\r\n    }\r\n}\r\n\r\ndefineFunction('unicode', '{charcode:number}', {\r\n    createAtom: (name: string, args: Argument[], style: Style): Atom =>\r\n        new UnicodeAtom(args[0] as string, style),\r\n});\r\n\r\n// A box of the width and height\r\ndefineFunction('rule', '[raise:dimen]{width:dimen}{thickness:dimen}', {\r\n    createAtom: (name: string, args: Argument[], style: Style): Atom =>\r\n        new RuleAtom(name, {\r\n            shift: args[0] as number,\r\n            width: args[1] as number,\r\n            height: args[2] as number,\r\n            style,\r\n        }),\r\n});\r\n\r\n// An overline\r\ndefineFunction('overline', '{:auto}', {\r\n    createAtom: (name: string, args: Argument[], style: Style): Atom =>\r\n        new LineAtom(name, args[0] as Atom[], {\r\n            position: 'overline',\r\n            style,\r\n        }),\r\n});\r\n\r\ndefineFunction('underline', '{:auto}', {\r\n    createAtom: (name: string, args: Argument[], style: Style): Atom =>\r\n        new LineAtom(name, args[0] as Atom[], {\r\n            position: 'underline',\r\n            style,\r\n        }),\r\n});\r\n\r\ndefineFunction('overset', '{annotation:auto}{symbol:auto}', {\r\n    createAtom: (name: string, args: Argument[], style: Style): Atom =>\r\n        new OverunderAtom(name, {\r\n            body: args[1] as Atom[],\r\n            above: args[0] as Atom[],\r\n            style,\r\n            toLatexOverride: (atom: OverunderAtom, options: ToLatexOptions) =>\r\n                `${atom.command}{${atom.aboveToLatex(options)}}` +\r\n                `{${atom.bodyToLatex(options)}}`,\r\n        }),\r\n});\r\n\r\ndefineFunction('underset', '{annotation:auto}{symbol:auto}', {\r\n    createAtom: (name: string, args: Argument[], style: Style): Atom =>\r\n        new OverunderAtom(name, {\r\n            body: args[1] as Atom[],\r\n            below: args[0] as Atom[],\r\n            style,\r\n            toLatexOverride: (atom: OverunderAtom, options: ToLatexOptions) =>\r\n                `${name}{${atom.belowToLatex(options)}}` +\r\n                `{${atom.bodyToLatex(options)}}`,\r\n        }),\r\n});\r\n\r\ndefineFunction(['stackrel', 'stackbin'], '{annotation:auto}{symbol:auto}', {\r\n    createAtom: (name: string, args: Argument[], style: Style): Atom =>\r\n        // Set the correct spacing rule for \\stackrel\r\n        // @revisit: this is not actually used...?\r\n        // mathtype: name === '\\\\stackrel' ? 'mrel' : 'mbin',\r\n        new OverunderAtom(name, {\r\n            body: args[1] as Atom[],\r\n            above: args[0] as Atom[],\r\n            style,\r\n            toLatexOverride: (atom: OverunderAtom, options: ToLatexOptions) =>\r\n                `${atom.command}{${atom.aboveToLatex(options)}}` +\r\n                `{${atom.bodyToLatex(options)}}`,\r\n        }),\r\n});\r\n\r\ndefineFunction(\r\n    ['overwithdelims', 'atopwithdelims'],\r\n    '{numer:auto}{denom:auto}{left-delim:delim}{right-delim:delim}',\r\n    {\r\n        infix: true,\r\n        createAtom: (name: string, args: Argument[], style: Style): Atom =>\r\n            new GenfracAtom(name, args[0] as Atom[], args[1] as Atom[], {\r\n                leftDelim: args[2] as string,\r\n                rightDelim: args[3] as string,\r\n                style,\r\n                toLatexOverride: (atom: GenfracAtom, options: ToLatexOptions) =>\r\n                    `${atom.aboveToLatex(options)} ${atom.command}${\r\n                        atom.leftDelim\r\n                    }${atom.rightDelim}${atom.belowToLatex(options)}`,\r\n            }),\r\n    }\r\n);\r\n\r\ndefineFunction('smash', '[:string]{:auto}', {\r\n    createAtom: (name: string, args: Argument[], style: Style): Atom => {\r\n        let phantomType: PhantomType = 'smash';\r\n        if (args[0] === 'b') {\r\n            phantomType = 'bsmash';\r\n        } else if (args[0] === 't') {\r\n            phantomType = 'tsmash';\r\n        }\r\n        return new PhantomAtom(name, args[1] as Atom[], { phantomType, style });\r\n    },\r\n});\r\n\r\ndefineFunction(['phantom', 'vphantom', 'hphantom'], '{:auto*}', {\r\n    createAtom: (name: string, args: Argument[], style: Style): Atom =>\r\n        new PhantomAtom(name, args[1] as Atom[], {\r\n            isInvisible: true,\r\n            phantomType: name.slice(1) as PhantomType,\r\n            style,\r\n        }),\r\n});\r\n\r\ndefineFunction('rlap', '{:auto}', {\r\n    createAtom: (name: string, args: Argument[], style: Style): Atom =>\r\n        new OverlapAtom(name, args[0] as Atom[], { align: 'right', style }),\r\n});\r\n\r\ndefineFunction('llap', '{:auto}', {\r\n    createAtom: (name: string, args: Argument[], style: Style): Atom =>\r\n        new OverlapAtom(name, args[0] as Atom[], { style }),\r\n});\r\n\r\ndefineFunction('mathllap', '{:auto}', {\r\n    createAtom: (name: string, args: Argument[], style: Style): Atom =>\r\n        new OverlapAtom(name, args[0] as Atom[], { style }),\r\n});\r\n\r\ndefineFunction('mathrlap', '{:auto}', {\r\n    createAtom: (name: string, args: Argument[], style: Style): Atom =>\r\n        new OverlapAtom(name, args[0] as Atom[], { align: 'right', style }),\r\n});\r\n","import {\r\n    defineSymbol,\r\n    defineSymbols,\r\n    defineSymbolRange,\r\n} from './definitions-utils';\r\n\r\n// Simple characters allowed in math mode\r\ndefineSymbols('0123456789/@.?!');\r\ndefineSymbolRange(0x0041, 0x005a); // a-z\r\ndefineSymbolRange(0x0061, 0x007a); // A-Z\r\n\r\n// Quantifiers\r\n\r\ndefineSymbol('\\\\forall', '\\u2200');\r\ndefineSymbol('\\\\exists', '\\u2203');\r\ndefineSymbol('\\\\nexists', '\\u2204', 'mord', 'ams');\r\ndefineSymbol('\\\\mid', '\\u2223', 'mrel');\r\ndefineSymbol('\\\\top', '\\u22a4');\r\ndefineSymbol('\\\\bot', '\\u22a5');\r\n\r\n// Misc Symbols\r\n\r\ndefineSymbol('\\\\sharp', '\\u266f');\r\ndefineSymbol('\\\\flat', '\\u266d');\r\ndefineSymbol('\\\\natural', '\\u266e');\r\ndefineSymbol('\\\\#', '\\u0023');\r\ndefineSymbol('\\\\&', '\\u0026');\r\ndefineSymbol('\\\\clubsuit', '\\u2663');\r\ndefineSymbol('\\\\heartsuit', '\\u2661');\r\ndefineSymbol('\\\\spadesuit', '\\u2660');\r\ndefineSymbol('\\\\diamondsuit', '\\u2662');\r\n\r\n// defineSymbol( '\\\\cross', '\\uF4A0',  'mord',  MAIN); // NOTE: not a real TeX symbol, but Mathematica\r\n// defineSymbol( '\\\\transpose', '\\uF3C7',  'mord',  MAIN); // NOTE: not a real TeX symbol, but Mathematica\r\n// defineSymbol( '\\\\conjugate', 'conj'],  MAIN,  'mord', '\\uF3C8'); // NOTE: not a real TeX symbol, but Mathematica\r\n// defineSymbol( '\\\\conjugatetranspose', '\\uF3C9',  'mord',  MAIN); // NOTE: not a real TeX symbol, but Mathematica\r\n// defineSymbol( '\\\\hermitianconjugate', '\\uF3CE',  'mord',  MAIN); // NOTE: not a real TeX symbol, but Mathematica\r\ndefineSymbol('\\\\differencedelta', '\\u2206', 'mrel');\r\n\r\ndefineSymbol('\\\\backslash', '\\\\');\r\n\r\ndefineSymbol('\\\\nabla', '\\u2207');\r\ndefineSymbol('\\\\partial', '\\u2202');\r\n\r\ndefineSymbol('\\\\ell', '\\u2113');\r\n\r\ndefineSymbol('\\\\hbar', '\\u210f');\r\ndefineSymbol('\\\\hslash', '\\u210f', 'mord', 'ams');\r\n\r\ndefineSymbol('\\\\Finv', '\\u2132', 'mord', 'ams');\r\ndefineSymbol('\\\\Game', '\\u2141', 'mord', 'ams');\r\n\r\ndefineSymbol('\\\\wp', '\\u2118');\r\ndefineSymbol('\\\\eth', '\\u00f0', 'mord', 'ams');\r\n\r\ndefineSymbol('\\\\mho', '\\u2127', 'mord', 'ams');\r\n\r\ndefineSymbol('\\\\Bbbk', '\\u006b', 'mord', 'ams');\r\ndefineSymbol('\\\\N', 'N', 'mord', 'double-struck'); // NOTE: Check if standard Latex\r\ndefineSymbol('\\\\R', 'R', 'mord', 'double-struck'); // NOTE: Check if standard Latex\r\ndefineSymbol('\\\\Q', 'Q', 'mord', 'double-struck'); // NOTE: Check if standard Latex\r\ndefineSymbol('\\\\C', 'C', 'mord', 'double-struck'); // NOTE: Check if standard Latex\r\ndefineSymbol('\\\\Z', 'Z', 'mord', 'double-struck'); // NOTE: Check if standard Latex\r\ndefineSymbol('\\\\P', 'P', 'mord', 'double-struck'); // NOTE: Check if standard Latex\r\n\r\ndefineSymbol('\\\\pounds', '\\u00a3');\r\ndefineSymbol('\\\\yen', '\\u00a5', 'mord', 'ams');\r\ndefineSymbol('\\\\euro', '\\u20AC'); // NOTE: not TeX built-in, but textcomp package\r\n\r\n// TODO Koppa, Stigma, Sampi\r\n\r\n// Math and Text\r\n\r\ndefineSymbol('\\\\dagger', '\\u2020', 'mbin');\r\ndefineSymbol('\\\\dag', '\\u2020', 'mbin');\r\ndefineSymbol('\\\\ddag', '\\u2021', 'mbin');\r\ndefineSymbol('\\\\ddagger', '\\u2021', 'mbin');\r\ndefineSymbol('\\\\maltese', '\\u2720', 'mord', 'ams');\r\n\r\n// Arrow Symbols\r\n\r\ndefineSymbol('\\\\rightarrow', '\\u2192', 'mrel');\r\ndefineSymbol('\\\\to', '\\u2192', 'mrel');\r\ndefineSymbol('\\\\leftarrow', '\\u2190', 'mrel');\r\ndefineSymbol('\\\\gets', '\\u2190', 'mrel');\r\ndefineSymbol('\\\\Rightarrow', '\\u21d2', 'mrel');\r\ndefineSymbol('\\\\Leftarrow', '\\u21d0', 'mrel');\r\ndefineSymbol('\\\\longrightarrow', '\\u27f6', 'mrel');\r\ndefineSymbol('\\\\longleftarrow', '\\u27f5', 'mrel');\r\ndefineSymbol('\\\\Longrightarrow', '\\u27f9', 'mrel');\r\ndefineSymbol('\\\\implies', '\\u27f9', 'mrel');\r\ndefineSymbol('\\\\Longleftarrow', '\\u27f8', 'mrel');\r\ndefineSymbol('\\\\impliedby', '\\u27f8', 'mrel');\r\ndefineSymbol('\\\\dashrightarrow', '\\u21e2', 'mrel', 'ams');\r\ndefineSymbol('\\\\dashleftarrow', '\\u21e0', 'mrel', 'ams');\r\ndefineSymbol('\\\\Rrightarrow', '\\u21db', 'mrel', 'ams');\r\ndefineSymbol('\\\\Lleftarrow', '\\u21da', 'mrel', 'ams');\r\n\r\ndefineSymbol('\\\\longleftrightarrow', '\\u27f7', 'mrel');\r\ndefineSymbol('\\\\biconditional', '\\u27f7', 'mrel');\r\ndefineSymbol('\\\\Longleftrightarrow', '\\u27fa', 'mrel');\r\n\r\ndefineSymbol('\\\\leftrightarrows', '\\u21c6', 'mrel', 'ams');\r\ndefineSymbol('\\\\rightleftarrows', '\\u21c4', 'mrel', 'ams');\r\n\r\ndefineSymbol('\\\\mapsto', '\\u21a6', 'mrel');\r\ndefineSymbol('\\\\longmapsto', '\\u27fc', 'mrel');\r\n\r\ndefineSymbol('\\\\uparrow', '\\u2191', 'mrel');\r\ndefineSymbol('\\\\downarrow', '\\u2193', 'mrel');\r\ndefineSymbol('\\\\Uparrow', '\\u21d1', 'mrel');\r\ndefineSymbol('\\\\Downarrow', '\\u21d3', 'mrel');\r\ndefineSymbol('\\\\updownarrow', '\\u2195', 'mrel');\r\ndefineSymbol('\\\\Updownarrow', '\\u21d5', 'mrel');\r\n\r\ndefineSymbol('\\\\curvearrowright', '\\u21b7', 'mrel', 'ams');\r\ndefineSymbol('\\\\curvearrowleft', '\\u21b6', 'mrel', 'ams');\r\n\r\ndefineSymbol('\\\\hookrightarrow', '\\u21aa', 'mrel');\r\ndefineSymbol('\\\\hookleftarrow', '\\u21a9', 'mrel');\r\n\r\ndefineSymbol('\\\\rightharpoonup', '\\u21c0', 'mrel');\r\ndefineSymbol('\\\\leftharpoonup', '\\u21bc', 'mrel');\r\ndefineSymbol('\\\\rightharpoondown', '\\u21c1', 'mrel');\r\ndefineSymbol('\\\\leftharpoondown', '\\u21bd', 'mrel');\r\n\r\ndefineSymbol('\\\\rightrightarrows', '\\u21c9', 'mrel', 'ams');\r\ndefineSymbol('\\\\leftleftarrows', '\\u21c7', 'mrel', 'ams');\r\ndefineSymbol('\\\\upuparrows', '\\u21c8', 'mrel', 'ams');\r\ndefineSymbol('\\\\downdownarrows', '\\u21ca', 'mrel', 'ams');\r\n\r\ndefineSymbol('\\\\leftarrowtail', '\\u21a2', 'mrel', 'ams');\r\ndefineSymbol('\\\\rightarrowtail', '\\u21a3', 'mrel', 'ams');\r\n\r\ndefineSymbol('\\\\looparrowright', '\\u21ac', 'mrel', 'ams');\r\ndefineSymbol('\\\\looparrowleft', '\\u21ab', 'mrel', 'ams');\r\n\r\ndefineSymbol('\\\\twoheadleftarrow', '\\u219e', 'mrel', 'ams');\r\ndefineSymbol('\\\\twoheadrightarrow', '\\u21a0', 'mrel', 'ams');\r\n\r\ndefineSymbol('\\\\rightleftharpoons', '\\u21cc', 'mrel');\r\ndefineSymbol('\\\\leftrightharpoons', '\\u21cb', 'mrel', 'ams');\r\n\r\ndefineSymbol('\\\\Rsh', '\\u21b1', 'mrel', 'ams');\r\ndefineSymbol('\\\\Lsh', '\\u21b0', 'mrel', 'ams');\r\n\r\ndefineSymbol('\\\\searrow', '\\u2198', 'mrel');\r\ndefineSymbol('\\\\nearrow', '\\u2197', 'mrel');\r\ndefineSymbol('\\\\swarrow', '\\u2199', 'mrel');\r\ndefineSymbol('\\\\nwarrow', '\\u2196', 'mrel');\r\n\r\ndefineSymbol('\\\\circlearrowright', '\\u21bb', 'mrel', 'ams');\r\ndefineSymbol('\\\\circlearrowleft', '\\u21ba', 'mrel', 'ams');\r\n\r\ndefineSymbol('\\\\restriction', '\\u21be', 'mrel', 'ams');\r\ndefineSymbol('\\\\upharpoonright', '\\u21be', 'mrel', 'ams');\r\ndefineSymbol('\\\\upharpoonleft', '\\u21bf', 'mrel', 'ams');\r\ndefineSymbol('\\\\downharpoonright', '\\u21c2', 'mrel', 'ams');\r\ndefineSymbol('\\\\downharpoonleft', '\\u21c3', 'mrel', 'ams');\r\n\r\ndefineSymbol('\\\\rightsquigarrow', '\\u21dd', 'mrel', 'ams');\r\ndefineSymbol('\\\\leadsto', '\\u21dd', 'mrel', 'ams');\r\ndefineSymbol('\\\\leftrightsquigarrow', '\\u21ad', 'mrel', 'ams');\r\n\r\ndefineSymbol('\\\\originalof', '\\u22B6', 'mrel');\r\ndefineSymbol('\\\\laplace', '\\u22B6', 'mrel');\r\ndefineSymbol('\\\\imageof', '\\u22B7', 'mrel');\r\ndefineSymbol('\\\\Laplace', '\\u22B7', 'mrel');\r\ndefineSymbol('\\\\multimap', '\\u22b8', 'mrel', 'ams');\r\n\r\n// 'ams' Negated Arrows\r\n\r\ndefineSymbol('\\\\nrightarrow', '\\u219b', 'mrel', 'ams');\r\ndefineSymbol('\\\\nleftarrow', '\\u219a', 'mrel', 'ams');\r\ndefineSymbol('\\\\nRightarrow', '\\u21cf', 'mrel', 'ams');\r\ndefineSymbol('\\\\nLeftarrow', '\\u21cd', 'mrel', 'ams');\r\ndefineSymbol('\\\\nleftrightarrow', '\\u21ae', 'mrel', 'ams');\r\ndefineSymbol('\\\\nLeftrightarrow', '\\u21ce', 'mrel', 'ams');\r\n\r\n// 'ams' Negated Binary Relations\r\n\r\ndefineSymbol('\\\\nless', '\\u226e', 'mrel', 'ams');\r\ndefineSymbol('\\\\nleqslant', '\\ue010', 'mrel', 'ams');\r\ndefineSymbol('\\\\lneq', '\\u2a87', 'mrel', 'ams');\r\ndefineSymbol('\\\\lneqq', '\\u2268', 'mrel', 'ams');\r\ndefineSymbol('\\\\nleqq', '\\ue011', 'mrel', 'ams');\r\n\r\ndefineSymbol('\\\\unlhd', '\\u22b4', 'mbin', 'ams');\r\ndefineSymbol('\\\\unrhd', '\\u22b5', 'mbin', 'ams');\r\n\r\ndefineSymbol('\\\\lvertneqq', '\\ue00c', 'mrel', 'ams');\r\ndefineSymbol('\\\\lnsim', '\\u22e6', 'mrel', 'ams');\r\ndefineSymbol('\\\\lnapprox', '\\u2a89', 'mrel', 'ams');\r\ndefineSymbol('\\\\nprec', '\\u2280', 'mrel', 'ams');\r\ndefineSymbol('\\\\npreceq', '\\u22e0', 'mrel', 'ams');\r\ndefineSymbol('\\\\precnsim', '\\u22e8', 'mrel', 'ams');\r\ndefineSymbol('\\\\precnapprox', '\\u2ab9', 'mrel', 'ams');\r\ndefineSymbol('\\\\nsim', '\\u2241', 'mrel', 'ams');\r\ndefineSymbol('\\\\nshortmid', '\\ue006', 'mrel', 'ams');\r\ndefineSymbol('\\\\nmid', '\\u2224', 'mrel', 'ams');\r\ndefineSymbol('\\\\nvdash', '\\u22ac', 'mrel', 'ams');\r\ndefineSymbol('\\\\nvDash', '\\u22ad', 'mrel', 'ams');\r\ndefineSymbol('\\\\ngtr', '\\u226f', 'mrel', 'ams');\r\ndefineSymbol('\\\\ngeqslant', '\\ue00f', 'mrel', 'ams');\r\ndefineSymbol('\\\\ngeqq', '\\ue00e', 'mrel', 'ams');\r\ndefineSymbol('\\\\gneq', '\\u2a88', 'mrel', 'ams');\r\ndefineSymbol('\\\\gneqq', '\\u2269', 'mrel', 'ams');\r\ndefineSymbol('\\\\gvertneqq', '\\ue00d', 'mrel', 'ams');\r\ndefineSymbol('\\\\gnsim', '\\u22e7', 'mrel', 'ams');\r\ndefineSymbol('\\\\gnapprox', '\\u2a8a', 'mrel', 'ams');\r\ndefineSymbol('\\\\nsucc', '\\u2281', 'mrel', 'ams');\r\ndefineSymbol('\\\\nsucceq', '\\u22e1', 'mrel', 'ams');\r\ndefineSymbol('\\\\succnsim', '\\u22e9', 'mrel', 'ams');\r\ndefineSymbol('\\\\succnapprox', '\\u2aba', 'mrel', 'ams');\r\ndefineSymbol('\\\\ncong', '\\u2246', 'mrel', 'ams');\r\ndefineSymbol('\\\\nshortparallel', '\\ue007', 'mrel', 'ams');\r\ndefineSymbol('\\\\nparallel', '\\u2226', 'mrel', 'ams');\r\ndefineSymbol('\\\\nVDash', '\\u22af', 'mrel', 'ams');\r\ndefineSymbol('\\\\nsupseteqq', '\\ue018', 'mrel', 'ams');\r\ndefineSymbol('\\\\supsetneq', '\\u228b', 'mrel', 'ams');\r\ndefineSymbol('\\\\varsupsetneq', '\\ue01b', 'mrel', 'ams');\r\ndefineSymbol('\\\\supsetneqq', '\\u2acc', 'mrel', 'ams');\r\ndefineSymbol('\\\\varsupsetneqq', '\\ue019', 'mrel', 'ams');\r\ndefineSymbol('\\\\nVdash', '\\u22ae', 'mrel', 'ams');\r\ndefineSymbol('\\\\precneqq', '\\u2ab5', 'mrel', 'ams');\r\ndefineSymbol('\\\\succneqq', '\\u2ab6', 'mrel', 'ams');\r\ndefineSymbol('\\\\nsubseteqq', '\\ue016', 'mrel', 'ams');\r\n\r\n// 'ams' Misc\r\n\r\ndefineSymbol('\\\\checkmark', '\\u2713', 'mord', 'ams');\r\n\r\ndefineSymbol('\\\\diagup', '\\u2571', 'mord', 'ams');\r\ndefineSymbol('\\\\diagdown', '\\u2572', 'mord', 'ams');\r\n\r\ndefineSymbol('\\\\measuredangle', '\\u2221', 'mord', 'ams');\r\ndefineSymbol('\\\\sphericalangle', '\\u2222', 'mord', 'ams');\r\n\r\ndefineSymbol('\\\\backprime', '\\u2035', 'mord', 'ams');\r\ndefineSymbol('\\\\backdoubleprime', '\\u2036', 'mord', 'ams');\r\n\r\ndefineSymbol('\\\\ast', '\\u2217', 'mbin');\r\ndefineSymbol('\\\\star', '\\u22c6', 'mbin');\r\ndefineSymbol('\\\\diamond', '\\u22c4', 'mbin');\r\ndefineSymbol('\\\\Diamond', '\\u25ca', 'mord', 'ams');\r\ndefineSymbol('\\\\lozenge', '\\u25ca', 'mord', 'ams');\r\ndefineSymbol('\\\\blacklozenge', '\\u29eb', 'mord', 'ams');\r\ndefineSymbol('\\\\bigstar', '\\u2605', 'mord', 'ams');\r\n\r\n// 'ams' Hebrew\r\n\r\ndefineSymbol('\\\\aleph', '\\u2135');\r\ndefineSymbol('\\\\beth', '\\u2136', 'mord', 'ams');\r\ndefineSymbol('\\\\daleth', '\\u2138', 'mord', 'ams');\r\ndefineSymbol('\\\\gimel', '\\u2137', 'mord', 'ams');\r\n\r\n// 'ams' Delimiters\r\n\r\ndefineSymbol('\\\\lbrace', '{', 'mopen');\r\ndefineSymbol('\\\\rbrace', '}', 'mclose');\r\ndefineSymbol('\\\\langle', '\\u27e8', 'mopen');\r\ndefineSymbol('\\\\rangle', '\\u27e9', 'mclose');\r\ndefineSymbol('\\\\lfloor', '\\u230a', 'mopen');\r\ndefineSymbol('\\\\rfloor', '\\u230b', 'mclose');\r\ndefineSymbol('\\\\lceil', '\\u2308', 'mopen');\r\ndefineSymbol('\\\\rceil', '\\u2309', 'mclose');\r\n\r\ndefineSymbol('\\\\vert', '\\u2223');\r\ndefineSymbol('\\\\mvert', '\\u2223', 'mrel');\r\ndefineSymbol('\\\\lvert', '\\u2223', 'mopen');\r\ndefineSymbol('\\\\rvert', '\\u2223', 'mclose');\r\ndefineSymbol('\\\\|', '\\u2225');\r\ndefineSymbol('\\\\Vert', '\\u2225');\r\ndefineSymbol('\\\\mVert', '\\u2225');\r\ndefineSymbol('\\\\lVert', '\\u2225', 'mopen');\r\ndefineSymbol('\\\\rVert', '\\u2225', 'mclose');\r\ndefineSymbol('\\\\parallel', '\\u2225', 'mrel');\r\ndefineSymbol('\\\\shortparallel', '\\u2225', 'mrel', 'ams');\r\n\r\ndefineSymbol('\\\\lbrack', '[', 'mopen');\r\ndefineSymbol('\\\\rbrack', ']', 'mclose');\r\ndefineSymbol('\\\\{', '{', 'mopen');\r\ndefineSymbol('\\\\}', '}', 'mclose');\r\n\r\ndefineSymbol('(', '(', 'mopen');\r\ndefineSymbol(')', ')', 'mclose');\r\ndefineSymbol('[', '[', 'mopen');\r\ndefineSymbol(']', ']', 'mclose');\r\n\r\ndefineSymbol('\\\\ulcorner', '\\u250c', 'mopen', 'ams');\r\ndefineSymbol('\\\\urcorner', '\\u2510', 'mclose', 'ams');\r\ndefineSymbol('\\\\llcorner', '\\u2514', 'mopen', 'ams');\r\ndefineSymbol('\\\\lrcorner', '\\u2518', 'mclose', 'ams');\r\n\r\n// Large Delimiters\r\n\r\ndefineSymbol('\\\\lgroup', '\\u27ee', 'mopen');\r\ndefineSymbol('\\\\rgroup', '\\u27ef', 'mclose');\r\ndefineSymbol('\\\\lmoustache', '\\u23b0', 'mopen');\r\ndefineSymbol('\\\\rmoustache', '\\u23b1', 'mclose');\r\n\r\n// Relations\r\n\r\ndefineSymbol('=', '=', 'mrel');\r\ndefineSymbol('\\\\ne', '\\u2260', 'mrel');\r\ndefineSymbol('\\\\neq', '\\u2260', 'mrel');\r\n// defineSymbol( '\\\\longequal', '\\uF7D9',  'mrel',  MAIN);   // NOTE: Not TeX\r\n\r\ndefineSymbol('<', '<', 'mrel');\r\ndefineSymbol('\\\\lt', '<', 'mrel');\r\ndefineSymbol('>', '>', 'mrel');\r\ndefineSymbol('\\\\gt', '>', 'mrel');\r\n\r\ndefineSymbol('\\\\le', '\\u2264', 'mrel');\r\ndefineSymbol('\\\\leq', '\\u2264', 'mrel');\r\ndefineSymbol('\\\\ge', '\\u2265', 'mrel');\r\ndefineSymbol('\\\\geq', '\\u2265', 'mrel');\r\n\r\ndefineSymbol('\\\\leqslant', '\\u2a7d', 'mrel', 'ams');\r\ndefineSymbol('\\\\geqslant', '\\u2a7e', 'mrel', 'ams');\r\n\r\ndefineSymbol('\\\\ll', '\\u226a', 'mrel');\r\ndefineSymbol('\\\\gg', '\\u226b', 'mrel');\r\ndefineSymbol('\\\\coloneq', '\\u2254', 'mrel');\r\ndefineSymbol('\\\\measeq', '\\u225d', 'mrel'); // MEASSURED BY\r\ndefineSymbol('\\\\eqdef', '\\u225e', 'mrel');\r\ndefineSymbol('\\\\questeq', '\\u225f', 'mrel'); // QUESTIONED EQUAL TO\r\n\r\ndefineSymbol(':', ':', 'mrel');\r\ndefineSymbol('\\\\cong', '\\u2245', 'mrel');\r\n\r\ndefineSymbol('\\\\equiv', '\\u2261', 'mrel');\r\n\r\ndefineSymbol('\\\\prec', '\\u227a', 'mrel');\r\ndefineSymbol('\\\\preceq', '\\u2aaf', 'mrel');\r\ndefineSymbol('\\\\succ', '\\u227b', 'mrel');\r\ndefineSymbol('\\\\succeq', '\\u2ab0', 'mrel');\r\n\r\ndefineSymbol('\\\\perp', '\\u22a5', 'mrel');\r\n\r\ndefineSymbol('\\\\propto', '\\u221d', 'mrel');\r\ndefineSymbol('\\\\Colon', '\\u2237', 'mrel');\r\n\r\ndefineSymbol('\\\\smile', '\\u2323', 'mrel');\r\ndefineSymbol('\\\\frown', '\\u2322', 'mrel');\r\n\r\ndefineSymbol('\\\\sim', '\\u223c', 'mrel');\r\ndefineSymbol('\\\\gtrsim', '\\u2273', 'mrel', 'ams');\r\n\r\ndefineSymbol('\\\\approx', '\\u2248', 'mrel');\r\n\r\ndefineSymbol('\\\\approxeq', '\\u224a', 'mrel', 'ams');\r\ndefineSymbol('\\\\thickapprox', '\\u2248', 'mrel', 'ams');\r\ndefineSymbol('\\\\lessapprox', '\\u2a85', 'mrel', 'ams');\r\ndefineSymbol('\\\\gtrapprox', '\\u2a86', 'mrel', 'ams');\r\ndefineSymbol('\\\\precapprox', '\\u2ab7', 'mrel', 'ams');\r\ndefineSymbol('\\\\succapprox', '\\u2ab8', 'mrel', 'ams');\r\n\r\ndefineSymbol('\\\\thicksim', '\\u223c', 'mrel', 'ams');\r\ndefineSymbol('\\\\succsim', '\\u227f', 'mrel', 'ams');\r\ndefineSymbol('\\\\precsim', '\\u227e', 'mrel', 'ams');\r\ndefineSymbol('\\\\backsim', '\\u223d', 'mrel', 'ams');\r\ndefineSymbol('\\\\eqsim', '\\u2242', 'mrel', 'ams');\r\ndefineSymbol('\\\\backsimeq', '\\u22cd', 'mrel', 'ams');\r\ndefineSymbol('\\\\simeq', '\\u2243', 'mrel');\r\ndefineSymbol('\\\\lesssim', '\\u2272', 'mrel', 'ams');\r\n\r\ndefineSymbol('\\\\nleq', '\\u2270', 'mrel', 'ams');\r\ndefineSymbol('\\\\ngeq', '\\u2271', 'mrel', 'ams');\r\n\r\ndefineSymbol('\\\\smallsmile', '\\u2323', 'mrel', 'ams');\r\ndefineSymbol('\\\\smallfrown', '\\u2322', 'mrel', 'ams');\r\ndefineSymbol('\\\\bowtie', '\\u22c8', 'mrel');\r\ndefineSymbol('\\\\Join', '\\u22c8', 'mrel');\r\n\r\ndefineSymbol('\\\\asymp', '\\u224d', 'mrel');\r\n\r\ndefineSymbol('\\\\sqsubseteq', '\\u2291', 'mrel');\r\ndefineSymbol('\\\\sqsupseteq', '\\u2292', 'mrel');\r\n\r\ndefineSymbol('\\\\leqq', '\\u2266', 'mrel', 'ams');\r\ndefineSymbol('\\\\eqslantless', '\\u2a95', 'mrel', 'ams');\r\n\r\ndefineSymbol('\\\\lll', '\\u22d8', 'mrel', 'ams');\r\ndefineSymbol('\\\\lessgtr', '\\u2276', 'mrel', 'ams');\r\ndefineSymbol('\\\\lesseqgtr', '\\u22da', 'mrel', 'ams');\r\ndefineSymbol('\\\\lesseqqgtr', '\\u2a8b', 'mrel', 'ams');\r\ndefineSymbol('\\\\risingdotseq', '\\u2253', 'mrel', 'ams');\r\ndefineSymbol('\\\\fallingdotseq', '\\u2252', 'mrel', 'ams');\r\ndefineSymbol('\\\\subseteqq', '\\u2ac5', 'mrel', 'ams');\r\ndefineSymbol('\\\\Subset', '\\u22d0', 'mrel', 'ams');\r\ndefineSymbol('\\\\sqsubset', '\\u228f', 'mrel', 'ams');\r\ndefineSymbol('\\\\preccurlyeq', '\\u227c', 'mrel', 'ams');\r\ndefineSymbol('\\\\curlyeqprec', '\\u22de', 'mrel', 'ams');\r\ndefineSymbol('\\\\vDash', '\\u22a8', 'mrel', 'ams');\r\ndefineSymbol('\\\\Vvdash', '\\u22aa', 'mrel', 'ams');\r\ndefineSymbol('\\\\bumpeq', '\\u224f', 'mrel', 'ams');\r\ndefineSymbol('\\\\Bumpeq', '\\u224e', 'mrel', 'ams');\r\ndefineSymbol('\\\\geqq', '\\u2267', 'mrel', 'ams');\r\ndefineSymbol('\\\\eqslantgtr', '\\u2a96', 'mrel', 'ams');\r\ndefineSymbol('\\\\ggg', '\\u22d9', 'mrel', 'ams');\r\ndefineSymbol('\\\\gtrless', '\\u2277', 'mrel', 'ams');\r\ndefineSymbol('\\\\gtreqless', '\\u22db', 'mrel', 'ams');\r\ndefineSymbol('\\\\gtreqqless', '\\u2a8c', 'mrel', 'ams');\r\n\r\ndefineSymbol('\\\\supseteqq', '\\u2ac6', 'mrel', 'ams');\r\ndefineSymbol('\\\\Supset', '\\u22d1', 'mrel', 'ams');\r\ndefineSymbol('\\\\sqsupset', '\\u2290', 'mrel', 'ams');\r\ndefineSymbol('\\\\succcurlyeq', '\\u227d', 'mrel', 'ams');\r\ndefineSymbol('\\\\curlyeqsucc', '\\u22df', 'mrel', 'ams');\r\ndefineSymbol('\\\\Vdash', '\\u22a9', 'mrel', 'ams');\r\ndefineSymbol('\\\\shortmid', '\\u2223', 'mrel', 'ams');\r\ndefineSymbol('\\\\between', '\\u226c', 'mrel', 'ams');\r\ndefineSymbol('\\\\pitchfork', '\\u22d4', 'mrel', 'ams');\r\ndefineSymbol('\\\\varpropto', '\\u221d', 'mrel', 'ams');\r\ndefineSymbol('\\\\backepsilon', '\\u220d', 'mrel', 'ams');\r\ndefineSymbol('\\\\llless', '\\u22d8', 'mrel', 'ams');\r\ndefineSymbol('\\\\gggtr', '\\u22d9', 'mrel', 'ams');\r\ndefineSymbol('\\\\lhd', '\\u22b2', 'mbin', 'ams');\r\ndefineSymbol('\\\\rhd', '\\u22b3', 'mbin', 'ams');\r\n\r\ndefineSymbol('\\\\doteq', '\\u2250', 'mrel');\r\ndefineSymbol('\\\\doteqdot', '\\u2251', 'mrel', 'ams');\r\ndefineSymbol('\\\\Doteq', '\\u2251', 'mrel', 'ams');\r\ndefineSymbol('\\\\eqcirc', '\\u2256', 'mrel', 'ams');\r\ndefineSymbol('\\\\circeq', '\\u2257', 'mrel', 'ams');\r\ndefineSymbol('\\\\lessdot', '\\u22d6', 'mbin', 'ams');\r\ndefineSymbol('\\\\gtrdot', '\\u22d7', 'mbin', 'ams');\r\n\r\n// In TeX, '~' is a spacing command (non-breaking space).\r\n// However, '~' is used as an ASCII Math shortctut character, so define a \\\\~\r\n// command which maps to the '~' character\r\ndefineSymbol('\\\\~', '~', 'mrel');\r\n\r\ndefineSymbol('\\\\leftrightarrow', '\\u2194', 'mrel');\r\ndefineSymbol('\\\\Leftrightarrow', '\\u21d4', 'mrel');\r\ndefineSymbol('\\\\models', '\\u22a8', 'mrel');\r\ndefineSymbol('\\\\vdash', '\\u22a2', 'mrel');\r\n\r\ndefineSymbol('\\\\therefore', '\\u2234', 'mrel', 'ams');\r\ndefineSymbol('\\\\because', '\\u2235', 'mrel', 'ams');\r\ndefineSymbol('\\\\dashv', '\\u22a3', 'mrel');\r\ndefineSymbol('\\\\roundimplies', '\\u2970', 'mrel');\r\n\r\n// 'ams' Binary Operators\r\n\r\ndefineSymbol('+', '+', 'mbin');\r\ndefineSymbol('-', '\\u2212', 'mbin');\r\ndefineSymbol('\\u2212', '\\u2212', 'mbin');\r\ndefineSymbol('\\\\pm', '\\u00b1', 'mbin');\r\ndefineSymbol('\\\\mp', '\\u2213', 'mbin');\r\ndefineSymbol('*', '\\u2217', 'mbin');\r\ndefineSymbol('\\\\times', '\\u00d7', 'mbin');\r\ndefineSymbol('\\\\div', '\\u00f7', 'mbin');\r\ndefineSymbol('\\\\surd', '\\u221a');\r\n\r\ndefineSymbol('\\\\divides', '\\u2223', 'mbin');\r\n// From MnSymbol package\r\n\r\ndefineSymbol('\\\\ltimes', '\\u22c9', 'mbin', 'ams');\r\ndefineSymbol('\\\\rtimes', '\\u22ca', 'mbin', 'ams');\r\ndefineSymbol('\\\\leftthreetimes', '\\u22cb', 'mbin', 'ams');\r\ndefineSymbol('\\\\rightthreetimes', '\\u22cc', 'mbin', 'ams');\r\ndefineSymbol('\\\\intercal', '\\u22ba', 'mbin', 'ams');\r\ndefineSymbol('\\\\dotplus', '\\u2214', 'mbin', 'ams');\r\ndefineSymbol('\\\\doublebarwedge', '\\u2a5e', 'mbin', 'ams');\r\ndefineSymbol('\\\\divideontimes', '\\u22c7', 'mbin', 'ams');\r\ndefineSymbol('\\\\centerdot', '\\u22c5', 'mbin', 'ams');\r\ndefineSymbol('\\\\cdot', '\\u22c5', 'mbin');\r\n\r\ndefineSymbol('\\\\infty', '\\u221e');\r\ndefineSymbol('\\\\prime', '\\u2032');\r\ndefineSymbol('\\\\doubleprime', '\\u2033'); // NOTE: Not in TeX, but Mathematica\r\ndefineSymbol('\\\\angle', '\\u2220');\r\ndefineSymbol('`', '\\u2018');\r\ndefineSymbol('\\\\$', '$');\r\ndefineSymbol('\\\\%', '%');\r\ndefineSymbol('\\\\_', '_');\r\n\r\n// Note: In TeX, greek symbols are only available in Math mode\r\ndefineSymbol('\\\\alpha', '\\u03b1');\r\ndefineSymbol('\\\\beta', '\\u03b2');\r\ndefineSymbol('\\\\gamma', '\\u03b3');\r\ndefineSymbol('\\\\delta', '\\u03b4');\r\ndefineSymbol('\\\\epsilon', '\\u03f5');\r\ndefineSymbol('\\\\varepsilon', '\\u03b5');\r\ndefineSymbol('\\\\zeta', '\\u03b6');\r\ndefineSymbol('\\\\eta', '\\u03b7');\r\ndefineSymbol('\\\\theta', '\\u03b8');\r\ndefineSymbol('\\\\vartheta', '\\u03d1');\r\ndefineSymbol('\\\\iota', '\\u03b9');\r\ndefineSymbol('\\\\kappa', '\\u03ba');\r\ndefineSymbol('\\\\varkappa', '\\u03f0', 'mord', 'ams');\r\ndefineSymbol('\\\\lambda', '\\u03bb');\r\ndefineSymbol('\\\\mu', '\\u03bc');\r\ndefineSymbol('\\\\nu', '\\u03bd');\r\ndefineSymbol('\\\\xi', '\\u03be');\r\ndefineSymbol('\\\\omicron', 'o');\r\ndefineSymbol('\\\\pi', '\\u03c0');\r\ndefineSymbol('\\\\varpi', '\\u03d6');\r\ndefineSymbol('\\\\rho', '\\u03c1');\r\ndefineSymbol('\\\\varrho', '\\u03f1');\r\ndefineSymbol('\\\\sigma', '\\u03c3');\r\ndefineSymbol('\\\\varsigma', '\\u03c2');\r\ndefineSymbol('\\\\tau', '\\u03c4');\r\ndefineSymbol('\\\\phi', '\\u03d5');\r\ndefineSymbol('\\\\varphi', '\\u03c6');\r\ndefineSymbol('\\\\upsilon', '\\u03c5');\r\ndefineSymbol('\\\\chi', '\\u03c7');\r\ndefineSymbol('\\\\psi', '\\u03c8');\r\ndefineSymbol('\\\\omega', '\\u03c9');\r\n\r\ndefineSymbol('\\\\Gamma', '\\u0393');\r\ndefineSymbol('\\\\Delta', '\\u0394');\r\ndefineSymbol('\\\\Theta', '\\u0398');\r\ndefineSymbol('\\\\Lambda', '\\u039b');\r\ndefineSymbol('\\\\Xi', '\\u039e');\r\ndefineSymbol('\\\\Pi', '\\u03a0');\r\ndefineSymbol('\\\\Sigma', '\\u03a3');\r\ndefineSymbol('\\\\Upsilon', '\\u03a5');\r\ndefineSymbol('\\\\Phi', '\\u03a6');\r\ndefineSymbol('\\\\Psi', '\\u03a8');\r\ndefineSymbol('\\\\Omega', '\\u03a9');\r\n\r\n// 'ams' Greek\r\ndefineSymbol('\\\\digamma', '\\u03dd', 'mord', 'ams');\r\n\r\ndefineSymbol('\\\\emptyset', '\\u2205');\r\ndefineSymbol('\\\\varnothing', '\\u2205', 'mord', 'ams');\r\n\r\ndefineSymbol('\\\\cap', '\\u2229', 'mbin');\r\ndefineSymbol('\\\\cup', '\\u222a', 'mbin');\r\ndefineSymbol('\\\\setminus', '\\u2216', 'mbin');\r\ndefineSymbol('\\\\smallsetminus', '\\u2216', 'mbin', 'ams');\r\ndefineSymbol('\\\\complement', '\\u2201', 'mord', 'ams');\r\n\r\ndefineSymbol('\\\\in', '\\u2208', 'mrel');\r\ndefineSymbol('\\\\notin', '\\u2209', 'mrel');\r\ndefineSymbol('\\\\not', '\\u0338', 'mrel');\r\ndefineSymbol('\\\\ni', '\\u220b', 'mrel');\r\ndefineSymbol('\\\\owns', '\\u220b', 'mrel');\r\ndefineSymbol('\\\\subset', '\\u2282', 'mrel');\r\ndefineSymbol('\\\\supset', '\\u2283', 'mrel');\r\ndefineSymbol('\\\\subseteq', '\\u2286', 'mrel');\r\ndefineSymbol('\\\\supseteq', '\\u2287', 'mrel');\r\ndefineSymbol('\\\\subsetneq', '\\u228a', 'mrel', 'ams');\r\ndefineSymbol('\\\\varsubsetneq', '\\ue01a', 'mrel', 'ams');\r\ndefineSymbol('\\\\subsetneqq', '\\u2acb', 'mrel', 'ams');\r\ndefineSymbol('\\\\varsubsetneqq', '\\ue017', 'mrel', 'ams');\r\ndefineSymbol('\\\\nsubset', '\\u2284', 'mrel', 'ams'); // NOTE: Not TeX?\r\ndefineSymbol('\\\\nsupset', '\\u2285', 'mrel', 'ams'); // NOTE: Not TeX?\r\ndefineSymbol('\\\\nsubseteq', '\\u2288', 'mrel', 'ams');\r\ndefineSymbol('\\\\nsupseteq', '\\u2289', 'mrel', 'ams');\r\n\r\n// See http://tex.stackexchange.com/questions/41476/lengths-and-when-to-use-them\r\ndefineSymbol('\\\\ ', '\\u00a0', 'space');\r\ndefineSymbol('~', '\\u00a0', 'space');\r\ndefineSymbol('\\\\space', '\\u00a0', 'space');\r\n\r\ndefineSymbol('\\\\!', null, 'spacing');\r\ndefineSymbol('\\\\,', null, 'spacing');\r\ndefineSymbol('\\\\:', null, 'spacing');\r\ndefineSymbol('\\\\;', null, 'spacing');\r\ndefineSymbol('\\\\enskip', null, 'spacing');\r\n// \\enspace is a TeX command (not LaTeX) equivalent to a \\skip\r\ndefineSymbol('\\\\enspace', null, 'spacing');\r\ndefineSymbol('\\\\quad', null, 'spacing');\r\ndefineSymbol('\\\\qquad', null, 'spacing');\r\n\r\n// Punctuation\r\n\r\ndefineSymbol('\\\\colon', ':', 'mpunct');\r\ndefineSymbol('\\\\cdotp', '\\u22c5', 'mpunct');\r\ndefineSymbol('\\\\cdots', '\\u22ef', 'minner');\r\ndefineSymbol('\\\\ddots', '\\u22f1', 'minner');\r\ndefineSymbol('\\\\ldots', '\\u2026', 'minner');\r\ndefineSymbol('\\\\mathellipsis', '\\u2026', 'minner');\r\ndefineSymbol('\\\\vdots', '\\u22ee');\r\ndefineSymbol('\\\\ldotp', '\\u002e', 'mpunct');\r\ndefineSymbol(',', ',', 'mpunct');\r\ndefineSymbol(';', ';', 'mpunct');\r\n\r\ndefineSymbol('\\\\land', '\\u2227', 'mbin');\r\ndefineSymbol('\\\\wedge', '\\u2227', 'mbin');\r\ndefineSymbol('\\\\lor', '\\u2228', 'mbin');\r\ndefineSymbol('\\\\vee', '\\u2228', 'mbin');\r\ndefineSymbol('\\\\lnot', '\\u00ac');\r\ndefineSymbol('\\\\neg', '\\u00ac');\r\n\r\ndefineSymbol('\\\\barwedge', '\\u22bc', 'mbin', 'ams');\r\ndefineSymbol('\\\\veebar', '\\u22bb', 'mbin', 'ams');\r\ndefineSymbol('\\\\nor', '\\u22bb', 'mbin', 'ams'); // NOTE: Not TeX, Mathematica\r\ndefineSymbol('\\\\curlywedge', '\\u22cf', 'mbin', 'ams');\r\ndefineSymbol('\\\\curlyvee', '\\u22ce', 'mbin', 'ams');\r\n\r\ndefineSymbol('\\\\square', '\\u25a1', 'mord', 'ams');\r\ndefineSymbol('\\\\Box', '\\u25a1', 'mord', 'ams');\r\ndefineSymbol('\\\\blacksquare', '\\u25a0', 'mord', 'ams');\r\ndefineSymbol('\\\\boxminus', '\\u229f', 'mbin', 'ams');\r\ndefineSymbol('\\\\boxplus', '\\u229e', 'mbin', 'ams');\r\ndefineSymbol('\\\\boxtimes', '\\u22a0', 'mbin', 'ams');\r\ndefineSymbol('\\\\boxdot', '\\u22a1', 'mbin', 'ams');\r\n\r\ndefineSymbol('\\\\circ', '\\u2218', 'mbin');\r\ndefineSymbol('\\\\bigcirc', '\\u25ef', 'mbin');\r\ndefineSymbol('\\\\bullet', '\\u2219', 'mbin');\r\ndefineSymbol('\\\\circleddash', '\\u229d', 'mbin', 'ams');\r\ndefineSymbol('\\\\circledast', '\\u229b', 'mbin', 'ams');\r\ndefineSymbol('\\\\oplus', '\\u2295', 'mbin');\r\ndefineSymbol('\\\\ominus', '\\u2296', 'mbin');\r\ndefineSymbol('\\\\otimes', '\\u2297', 'mbin');\r\ndefineSymbol('\\\\odot', '\\u2299', 'mbin');\r\ndefineSymbol('\\\\circledcirc', '\\u229a', 'mbin', 'ams');\r\ndefineSymbol('\\\\oslash', '\\u2298', 'mbin');\r\ndefineSymbol('\\\\circledS', '\\u24c8', 'mord', 'ams');\r\ndefineSymbol('\\\\circledR', '\\u00ae', 'mord', 'ams');\r\n\r\ndefineSymbol('\\\\triangle', '\\u25b3');\r\ndefineSymbol('\\\\bigtriangleup', '\\u25b3', 'mbin');\r\ndefineSymbol('\\\\vartriangle', '\\u25b3', 'mrel', 'ams');\r\ndefineSymbol('\\\\triangleq', '\\u225c', 'mrel', 'ams');\r\n\r\ndefineSymbol('\\\\triangledown', '\\u25bd', 'mord', 'ams');\r\ndefineSymbol('\\\\bigtriangledown', '\\u25bd', 'mbin');\r\n\r\ndefineSymbol('\\\\triangleleft', '\\u25c3', 'mbin');\r\ndefineSymbol('\\\\vartriangleleft', '\\u22b2', 'mrel', 'ams');\r\ndefineSymbol('\\\\trianglelefteq', '\\u22b4', 'mrel', 'ams');\r\ndefineSymbol('\\\\ntriangleleft', '\\u22ea', 'mrel', 'ams');\r\ndefineSymbol('\\\\ntrianglelefteq', '\\u22ec', 'mrel', 'ams');\r\n\r\ndefineSymbol('\\\\triangleright', '\\u25b9', 'mbin');\r\ndefineSymbol('\\\\vartriangleright', '\\u22b3', 'mrel', 'ams');\r\ndefineSymbol('\\\\trianglerighteq', '\\u22b5', 'mrel', 'ams');\r\ndefineSymbol('\\\\ntriangleright', '\\u22eb', 'mrel', 'ams');\r\ndefineSymbol('\\\\ntrianglerighteq', '\\u22ed', 'mrel', 'ams');\r\n\r\ndefineSymbol('\\\\blacktriangle', '\\u25b2', 'mord', 'ams');\r\ndefineSymbol('\\\\blacktriangledown', '\\u25bc', 'mord', 'ams');\r\ndefineSymbol('\\\\blacktriangleleft', '\\u25c0', 'mrel', 'ams');\r\ndefineSymbol('\\\\blacktriangleright', '\\u25b6', 'mrel', 'ams');\r\n\r\ndefineSymbol('\\\\/', '/');\r\ndefineSymbol('|', '\\u2223', 'textord');\r\n\r\ndefineSymbol('\\\\And', '\\u0026', 'mbin');\r\ndefineSymbol('\\\\imath', '\\u0131');\r\ndefineSymbol('\\\\jmath', '\\u0237');\r\n\r\ndefineSymbol('\\\\degree', '\\u00b0');\r\n\r\ndefineSymbol(\"'\", '\\u2032'); // Prime\r\ndefineSymbol('\"', '\\u201D'); // Double Prime\r\n// defineSymbol( \"\\'', '\\u2033',  'mord',  MAIN);       // Double Prime\r\n","// Adapted from https://jakedeichert.com/blog/2020/02/a-super-hacky-alternative-to-import-meta-url/\nfunction getFileUrl() {\n    const stackTraceFrames = String(new Error().stack)\n        .replace(/^Error.*\\n/, '')\n        .split('\\n');\n\n    if (stackTraceFrames.length === 0) return '';\n\n    // 0 = this getFileUrl frame (because the Error is created here)\n    // 1 = the caller of getFileUrl (the file path we want to grab)\n    const callerFrame = stackTraceFrames[0];\n\n    // Extract the script's complete url\n    const m = callerFrame.match(/http.*js/);\n    if (!m) return '';\n    return m[0];\n}\n\nexport const gScriptUrl =\n    (document.currentScript as HTMLScriptElement)?.src ?? getFileUrl();\n","import { gScriptUrl } from '../common/script-url';\r\nimport { ErrorListener, MathfieldErrorCode } from '../public/core';\r\n\r\n// The URL of the bundled MathLive library. Used later to locate the `fonts`\r\n// directory, relative to the library\r\n\r\n// If loaded via a <script> tag, `document.currentScript.src` is this location\r\n// If loaded via a module (e.g. `import ...`),`import.meta.url` is this location.\r\n// However, `import.meta` is not supported by WebPack. So, use a super-hacky-alternative\r\n// to get the URL.\r\n// See https://github.com/webpack/webpack/issues/6719\r\n\r\nexport async function loadFonts(\r\n    fontsDirectory?: string,\r\n    onError?: ErrorListener<MathfieldErrorCode>\r\n): Promise<void> {\r\n    function makeFontFace(\r\n        name: string,\r\n        source: string,\r\n        descriptors: { [key: string]: string } = {}\r\n    ): FontFace {\r\n        return new FontFace(\r\n            name,\r\n            `url(${source}.woff2) format('woff2'), url(${source}.woff) format('woff')`,\r\n            descriptors\r\n        );\r\n    }\r\n\r\n    // If the \"mathlive-fonts.css\" stylesheet is included in the <head> of the\r\n    // page, it will include a `--ML__static-fonts` variable.\r\n    // In that case, don't load the fonts dynamically\r\n    const useStaticFonts =\r\n        getComputedStyle(document.documentElement).getPropertyValue(\r\n            '--ML__static-fonts'\r\n        ) ?? false;\r\n\r\n    if (useStaticFonts) return;\r\n\r\n    if ('fonts' in document) {\r\n        const fontFamilies = [\r\n            'KaTeX_Main',\r\n            'KaTeX_Math',\r\n            'KaTeX_AMS',\r\n            'KaTeX_Caligraphic',\r\n            'KaTeX_Fraktur',\r\n            'KaTeX_SansSerif',\r\n            'KaTeX_Script',\r\n            'KaTeX_Size1',\r\n            'KaTeX_Size2',\r\n            'KaTeX_Size3',\r\n            'KaTeX_Size4',\r\n        ];\r\n        // for (const fontFace of document.fonts.values()) { console.log(fontFace.family)}\r\n        let fontsLoaded = false;\r\n\r\n        // Firefox returns true for fonts that are not loaded...\r\n        // https://bugzilla.mozilla.org/show_bug.cgi?id=1252821 \r\n        // So, if on Firefox, always assume that the fonts are not loaded.\r\n        if (!/firefox/i.test(navigator.userAgent)) {\r\n            try {\r\n                fontsLoaded = fontFamilies.every((x) =>\r\n                    document['fonts'].check('16px ' + x)\r\n                );\r\n            } catch (e) {\r\n                fontsLoaded = false;\r\n            }\r\n        }\r\n\r\n        if (!fontsLoaded) {\r\n            if (document.body.classList.contains('ML__fonts-loading')) {\r\n                return;\r\n            }\r\n            document.body.classList.add('ML__fonts-loading');\r\n\r\n            // Locate the `fonts` folder relative to the script URL\r\n            const fontsFolder = new URL(\r\n                fontsDirectory ?? './fonts',\r\n                gScriptUrl\r\n            ).toString();\r\n            const fonts: FontFace[] = ([\r\n                ['KaTeX_Main-Regular'],\r\n                ['KaTeX_Main-BoldItalic', { style: 'italic', weight: 'bold' }],\r\n                ['KaTeX_Main-Bold', { weight: 'bold' }],\r\n                ['KaTeX_Main-Italic', { style: 'italic' }],\r\n                ['KaTeX_Math-Italic', { style: 'italic' }],\r\n                ['KaTeX_Math-BoldItalic', { style: 'italic', weight: 'bold' }],\r\n                ['KaTeX_AMS-Regular'],\r\n                ['KaTeX_Caligraphic-Regular'],\r\n                ['KaTeX_Caligraphic-Bold', { weight: 'bold' }],\r\n                ['KaTeX_Fraktur-Regular'],\r\n                ['KaTeX_Fraktur-Bold', { weight: 'bold' }],\r\n                ['KaTeX_SansSerif-Regular', { style: 'italic' }],\r\n                ['KaTeX_SansSerif-Bold', { weight: 'bold' }],\r\n                ['KaTeX_SansSerif-Italic', { style: 'italic' }],\r\n                ['KaTeX_Script-Regular'],\r\n                ['KaTeX_Typewriter-Regular'],\r\n                ['KaTeX_Size1-Regular'],\r\n                ['KaTeX_Size2-Regular'],\r\n                ['KaTeX_Size3-Regular'],\r\n                ['KaTeX_Size4-Regular'],\r\n            ] as [string, { [key: string]: string }][]).map((x) =>\r\n                makeFontFace(\r\n                    x[0].replace(/-[a-zA-Z]+$/, ''),\r\n                    fontsFolder + '/' + x[0],\r\n                    x[1]\r\n                )\r\n            );\r\n            try {\r\n                const loadedFonts = ((await Promise.all(\r\n                    fonts.map((x) => {\r\n                        try {\r\n                            return x.load();\r\n                        } catch (e) {\r\n                            if (typeof onError === 'function') {\r\n                                onError({\r\n                                    code: 'font-not-found',\r\n                                    arg: e,\r\n                                });\r\n                            }\r\n                        }\r\n                        return undefined;\r\n                    })\r\n                )) as unknown) as FontFace[];\r\n                // Render them at the same time\r\n                loadedFonts.forEach((font) => document['fonts'].add(font));\r\n                document.body.classList.remove('ML__fonts-loading');\r\n            } catch (err) {\r\n                console.error(err);\r\n            }\r\n        }\r\n    }\r\n}\r\n","export function hashCode(s: string): number {\r\n    let hash = 0;\r\n    if (s.length === 0) {\r\n        return hash;\r\n    }\r\n    for (let i = 0; i < s.length; i++) {\r\n        const char = s.charCodeAt(i);\r\n        hash = (hash << 5) - hash + char;\r\n        hash = hash & hash; // Convert to 32bit integer\r\n    }\r\n    return hash;\r\n}\r\n","import type { Releasable } from './releasable';\r\nimport { hashCode } from './hash-code';\r\n\r\nexport type Stylesheet = Releasable;\r\n\r\nexport function inject(element: HTMLElement, css: string): Releasable {\r\n    if (!css) return null;\r\n\r\n    let root = element?.getRootNode() ?? document?.head;\r\n\r\n    if (!root) return null;\r\n    if (root === document) root = document.head;\r\n\r\n    const id = hashCode(css).toString(36);\r\n    const el = (root as HTMLElement).querySelector(`style[data-id=\"${id}\"]`);\r\n    if (el) {\r\n        const refCount = parseFloat(el.getAttribute('data-refcount') ?? '0');\r\n        el.setAttribute('data-refcount', Number(refCount + 1).toString());\r\n    } else {\r\n        // Make a new node holding the stylesheet\r\n        const styleNode = document.createElement('style');\r\n        // styleNode.setAttribute('media', 'screen')\r\n        // styleNode.setAttribute('media', 'only screen and (max-width : 1024px)')\r\n        styleNode.type = 'text/css';\r\n        styleNode.dataset.id = id;\r\n        styleNode.dataset.refcount = '1';\r\n        styleNode.appendChild(document.createTextNode(css));\r\n        root.appendChild(styleNode);\r\n    }\r\n\r\n    return {\r\n        release: (): void => {\r\n            const el = document.head.querySelector(`style[data-id=\"${id}\"]`);\r\n            if (el) {\r\n                const refCount = parseFloat(\r\n                    el.getAttribute('data-refcount') ?? '0'\r\n                );\r\n                if (refCount === 1) {\r\n                    el.remove();\r\n                } else {\r\n                    el.setAttribute(\r\n                        'data-refcount',\r\n                        Number(refCount - 1).toString()\r\n                    );\r\n                }\r\n            }\r\n        },\r\n    };\r\n}\r\n","import type { ParseMode } from '../public/core';\r\nimport type { Mathfield, Offset, Range, Selection } from '../public/mathfield';\r\nimport { ModelPrivate } from './model-private';\r\n\r\nimport type { MacroDictionary } from '../core-definitions/definitions';\r\nimport type { Atom } from '../core/atom';\r\n\r\nexport type ModelOptions = {\r\n    mode: ParseMode;\r\n    macros: MacroDictionary;\r\n    removeExtraneousParentheses: boolean;\r\n};\r\n\r\nexport type ModelHooks = {\r\n    announce?: (\r\n        target: Mathfield, // @revisit: could drop this argument\r\n        command: string, // verb\r\n        // | 'plonk'\r\n        // | 'replacement'\r\n        //     | 'line'\r\n        //     | 'move'\r\n        //     | 'moveUp'\r\n        //     | 'moveDown'\r\n        //     | 'deleted'\r\n        //     | 'deleted: numerator'\r\n        //     | 'deleted: denominator'\r\n        //     | 'deleted: root'\r\n        //     | 'deleted: superscript',\r\n        previousPosition: number,\r\n        atoms: Atom[] // object of the command\r\n    ) => void;\r\n    /*\r\n     * Return false if handled.\r\n     */\r\n    moveOut?: (\r\n        sender: ModelPrivate,\r\n        direction: 'forward' | 'backward' | 'upward' | 'downward'\r\n    ) => boolean;\r\n    /*\r\n     * Return false if handled.\r\n     */\r\n    tabOut?: (\r\n        sender: ModelPrivate,\r\n        direction: 'forward' | 'backward'\r\n    ) => boolean;\r\n};\r\n\r\nexport function isOffset(value: unknown): value is Offset {\r\n    return typeof value === 'number' && !isNaN(value);\r\n}\r\n\r\nexport function isRange(value: unknown): value is Range {\r\n    return Array.isArray(value) && value.length === 2;\r\n}\r\n\r\nexport function isSelection(value: unknown): value is Selection {\r\n    return (\r\n        typeof value === 'object' &&\r\n        'ranges' in value &&\r\n        Array.isArray(value['ranges'])\r\n    );\r\n}\r\n","/**\r\n * This module parses and outputs an Abstract Syntax Tree representing the\r\n * formula using the {@tutorial math-json | MathJSON } format.\r\n *\r\n * To use it, use the {@linkcode atomtoAST | atomtoAST()}  method.\r\n */\r\nimport { isArray } from '../common/types';\r\n\r\nimport { Atom, AtomType } from '../core/atom';\r\nimport { ArrayAtom } from '../core-atoms/array';\r\nimport { parseString } from '../core/parser';\r\nimport { joinLatex } from '../core/tokenizer';\r\nimport {\r\n    unicodeStringToLatex,\r\n    getInfo,\r\n    mathVariantToUnicode,\r\n} from '../core-definitions/definitions';\r\nimport { LeftRightAtom } from '../core-atoms/leftright';\r\nimport { SizedDelimAtom } from '../core-atoms/delim';\r\nimport { RIGHT_DELIM } from '../core/delimiters';\r\n\r\nexport type MathJsonLatexOptions = {\r\n    precision?: number;\r\n    decimalMarker?: string;\r\n    groupSeparator?: string;\r\n    product?: string;\r\n    exponentProduct?: string;\r\n    exponentMarker?: string;\r\n    arcSeparator?: string;\r\n    scientificNotation?: 'engineering' | 'auto' | 'on';\r\n    beginRepeatingDigits?: string;\r\n    endRepeatingDigits?: string;\r\n};\r\n\r\nexport type MathJson = any;\r\ntype ComplexNumber = { re?: string; im?: string };\r\ntype WrappedNumber = { num: string | ComplexNumber };\r\ntype MathJsonNumber = WrappedNumber & MathJsonOptionalAttributes;\r\ntype MathJsonExpression = {\r\n    fn?: string;\r\n    variant?: string;\r\n    [property: string]: MathJson;\r\n};\r\ntype MathJsonFunction = { fn: string; arg?: MathJson[] };\r\ntype MathJsonOptionalAttributes = {\r\n    latex?: string;\r\n};\r\n\r\ntype ParseState = {\r\n    atoms: Atom[];\r\n    index?: number;\r\n    ast?: MathJson;\r\n    minPrec?: number;\r\n};\r\n\r\n// type MathJson =\r\n//     | string\r\n//     | number\r\n//     | boolean\r\n//     | null\r\n//     | { [property: string]: MathJson }\r\n//     | MathJson[];\r\n\r\nconst CANONICAL_NAMES = {\r\n    // CONSTANTS\r\n    '\\\\imaginaryI': '\\u2148',\r\n    '\\\\imaginaryJ': '\\u2149',\r\n    '\\\\pi': '',\r\n    '\\\\exponentialE': '\\u212f',\r\n\r\n    // ARITHMETIC\r\n    '': '+', // SMALL PLUS SIGN\r\n    '': '+', // FULL WIDTH PLUS SIGN\r\n    '': '-', // MINUS SIGN\r\n    '-': '-', // HYPHEN-MINUS\r\n    '': '-', // SMALL HYPHEN-MINUS\r\n    '': '-', // FULLWIDTH HYPHEN-MINUS\r\n    '\\\\times': '*',\r\n    '\\\\cdot': '*',\r\n    '': '*', // N-ARY TIMES OPERATOR U+\r\n    '': '*', // MULTIPLICATION SYMBOL\r\n    '': '*', // MULTIPLICATION SIGN\r\n    '.': '*',\r\n    '': '/', // DIVISION SIGN\r\n    // '/':             '/',        // SOLIDUS\r\n    '': '/', // FRACTION SLASH\r\n    '': '/', // FULLWIDTH SOLIDUS\r\n    '!': 'factorial',\r\n    '\\\\mp': 'minusplus', // MINUS-PLUS SIGN\r\n    '\\\\ne': '!=',\r\n    '\\\\coloneq': ':=',\r\n    '\\\\questeq': '?=',\r\n    '\\\\approx': 'approx',\r\n    '\\\\cong': 'congruent',\r\n    '\\\\sim': 'similar',\r\n    '\\\\equiv': 'equiv',\r\n    '\\\\pm': 'plusminus', // PLUS-MINUS SIGN\r\n\r\n    '\\\\land': 'and',\r\n    '\\\\wedge': 'and',\r\n    '\\\\lor': 'or',\r\n    '\\\\vee': 'or',\r\n    '\\\\oplus': 'xor',\r\n    '\\\\veebar': 'xor',\r\n    '\\\\lnot': 'not',\r\n    '\\\\neg': 'not',\r\n\r\n    '\\\\exists': 'exists',\r\n    '\\\\nexists': '!exists',\r\n    '\\\\forall': 'forAll',\r\n    '\\\\backepsilon': 'suchThat',\r\n    '\\\\therefore': 'therefore',\r\n    '\\\\because': 'because',\r\n\r\n    '\\\\nabla': 'nabla',\r\n    '\\\\circ': 'circle',\r\n    // '\\\\oplus':       'oplus',\r\n    '\\\\ominus': 'ominus',\r\n    '\\\\odot': 'odot',\r\n    '\\\\otimes': 'otimes',\r\n\r\n    '\\\\zeta': 'Zeta',\r\n    '\\\\Gamma': 'Gamma',\r\n    '\\\\min': 'min',\r\n    '\\\\max': 'max',\r\n    '\\\\mod': 'mod',\r\n    '\\\\lim': 'lim', // BIG OP\r\n    '\\\\sum': 'sum',\r\n    '\\\\prod': 'prod',\r\n    '\\\\int': 'integral',\r\n    '\\\\iint': 'integral2',\r\n    '\\\\iiint': 'integral3',\r\n\r\n    '\\\\Re': 'Re',\r\n    '\\\\gothicCapitalR': 'Re',\r\n    '\\\\Im': 'Im',\r\n    '\\\\gothicCapitalI': 'Im',\r\n\r\n    '\\\\binom': 'nCr',\r\n\r\n    '\\\\partial': 'partial',\r\n    '\\\\differentialD': 'differentialD',\r\n    '\\\\capitalDifferentialD': 'capitalDifferentialD',\r\n    '\\\\Finv': 'Finv',\r\n    '\\\\Game': 'Game',\r\n    '\\\\wp': 'wp',\r\n    '\\\\ast': 'ast',\r\n    '\\\\star': 'star',\r\n    '\\\\asymp': 'asymp',\r\n\r\n    // Function domain, limits\r\n    '\\\\to': 'to', // Looks like \\rightarrow\r\n    '\\\\gets': 'gets', // Looks like \\leftarrow\r\n\r\n    // Sets\r\n    '\\\\in': 'elementof',\r\n    '\\\\notin': '!elementof',\r\n    '\\\\ni': 'ownedby',\r\n    '\\\\owns': 'ownedby',\r\n    '\\\\subset': 'subset',\r\n    '\\\\supset': 'superset',\r\n    '\\\\complement': 'complement',\r\n\r\n    // Logic\r\n    '\\\\rightarrow': 'shortLogicalImplies',\r\n    '\\\\leftarrow': 'shortLogicalImpliedBy',\r\n    '\\\\leftrightarrow': 'shortLogicalEquivalent',\r\n    '\\\\longrightarrow': 'logicalImplies',\r\n    '\\\\longleftarrow': 'logicalImpliedBy',\r\n    '\\\\longleftrightarrow': 'logicalEquivalent',\r\n\r\n    // Metalogic\r\n    '\\\\Rightarrow': 'shortImplies',\r\n    '\\\\Leftarrow': 'shortImpliedBy',\r\n    '\\\\Leftrightarrow': 'shortEquivalent',\r\n\r\n    '\\\\implies': 'implies',\r\n    '\\\\Longrightarrow': 'implies',\r\n    '\\\\impliedby': 'impliedBy',\r\n    '\\\\Longleftarrow': 'impliedBy',\r\n    '\\\\iff': 'equivalent',\r\n    '\\\\Longleftrightarrow': 'equivalent',\r\n};\r\n\r\n// The OP_NAME table maps a canonical name to a function name\r\nconst OP_NAME = {\r\n    '+': 'add',\r\n    '*': 'multiply',\r\n    '-': 'subtract',\r\n    '/': 'divide',\r\n    '=': 'equal',\r\n    ':=': 'assign',\r\n    '!=': 'ne',\r\n    '?=': 'questeq',\r\n    approx: 'approx',\r\n    congruent: 'congruent',\r\n    similar: 'similar',\r\n    equiv: 'equiv',\r\n    '<': 'lt',\r\n    '>': 'gt',\r\n    '<=': 'le',\r\n    '>=': 'ge',\r\n    '': 'le',\r\n    '': 'ge',\r\n    '>>': 'gg',\r\n    '<<': 'll',\r\n    '**': 'pow',\r\n    '++': 'increment',\r\n    '--': 'decrement',\r\n};\r\n\r\n// The FUNCTION_TEMPLATE table maps a canonical name to a LaTeX template\r\nconst FUNCTION_TEMPLATE = {\r\n    equal: '%0 = %1',\r\n    ne: '%0 \\\\ne %1',\r\n    questeq: '%0 \\\\questeq %1',\r\n    approx: '%0 \\\\approx %1',\r\n    congruent: '%0 \\\\cong %1',\r\n    similar: '%0 \\\\sim %1',\r\n    equiv: '%0 \\\\equiv %1',\r\n    assign: '%0 := %1',\r\n    lt: '%0 < %1',\r\n    gt: '%0 > %1',\r\n    le: '%0 \\\\le %1',\r\n    ge: '%0 \\\\ge %1',\r\n\r\n    // TRIGONOMETRY\r\n    sin: '\\\\sin%_%^ %0',\r\n    cos: '\\\\cos%_%^ %0',\r\n    tan: '\\\\tan%_%^ %0',\r\n    cot: '\\\\cot%_%^ %0',\r\n    sec: '\\\\sec%_%^ %0',\r\n    csc: '\\\\csc%_%^ %0',\r\n\r\n    sinh: '\\\\sinh %0',\r\n    cosh: '\\\\cosh %0',\r\n    tanh: '\\\\tanh %0',\r\n    csch: '\\\\csch %0',\r\n    sech: '\\\\sech %0',\r\n    coth: '\\\\coth %0',\r\n\r\n    arcsin: '\\\\arcsin %0',\r\n    arccos: '\\\\arccos %0',\r\n    arctan: '\\\\arctan %0',\r\n    arccot: '\\\\arcctg %0', // Check\r\n    arcsec: '\\\\arcsec %0',\r\n    arccsc: '\\\\arccsc %0',\r\n\r\n    arsinh: '\\\\arsinh %0',\r\n    arcosh: '\\\\arcosh %0',\r\n    artanh: '\\\\artanh %0',\r\n    arcsch: '\\\\arcsch %0',\r\n    arsech: '\\\\arsech %0',\r\n    arcoth: '\\\\arcoth %0',\r\n\r\n    // LOGARITHMS\r\n    ln: '\\\\ln%_%^ %', // Natural logarithm\r\n    log: '\\\\log%_%^ %', // General logarithm, e.g. log_10\r\n    lg: '\\\\lg %', // Common, base-10, logarithm\r\n    lb: '\\\\lb %', // Binary, base-2, logarithm\r\n\r\n    // Big operator\r\n    sum: '\\\\sum%_%^ %0',\r\n    prod: '\\\\prod%_%^ %0',\r\n\r\n    // OTHER\r\n    Zeta: '\\\\zeta%_%^ %', // Riemann Zeta function\r\n    Gamma: '\\\\Gamma %', // Gamma function, such that Gamma(n) = (n - 1)!\r\n    min: '\\\\min%_%^ %',\r\n    max: '\\\\max%_%^ %',\r\n    mod: '\\\\mod%_%^ %',\r\n    lim: '\\\\lim%_%^ %', // BIG OP\r\n    binom: '\\\\binom %',\r\n    nabla: '\\\\nabla %',\r\n    curl: '\\\\nabla\\\\times %0',\r\n    div: '\\\\nabla\\\\cdot %0',\r\n    floor: '\\\\lfloor %0 \\\\rfloor%_%^',\r\n    ceil: '\\\\lceil %0 \\\\rceil%_%^',\r\n    abs: '\\\\left| %0 \\\\right|%_%^',\r\n    norm: '\\\\lVert %0 \\\\rVert%_%^',\r\n    ucorner: '\\\\ulcorner %0 \\\\urcorner%_%^',\r\n    lcorner: '\\\\llcorner %0 \\\\lrcorner%_%^',\r\n    angle: '\\\\langle %0 \\\\rangle%_%^',\r\n    group: '\\\\lgroup %0 \\\\rgroup%_%^',\r\n    moustache: '\\\\lmoustache %0 \\\\rmoustache%_%^',\r\n    brace: '\\\\lbrace %0 \\\\rbrace%_%^',\r\n    'sqrt[]': '\\\\sqrt[%^]{%0}', // Template used when there's an index\r\n    sqrt: '\\\\sqrt{%0}',\r\n    lcm: '\\\\operatorname{lcm}%',\r\n    gcd: '\\\\operatorname{gcd}%',\r\n    erf: '\\\\operatorname{erf}%',\r\n    erfc: '\\\\operatorname{erfc}%',\r\n    randomReal: '\\\\operatorname{randomReal}%',\r\n    randomInteger: '\\\\operatorname{randomInteger}%',\r\n\r\n    // Logic operators\r\n    and: '%0 \\\\land %1',\r\n    or: '%0 \\\\lor %1',\r\n    xor: '%0 \\\\oplus %1',\r\n    not: '%0 \\\\lnot %1',\r\n\r\n    // Other operators\r\n    circle: '%0 \\\\circ %1',\r\n    ast: '%0 \\\\ast %1',\r\n    star: '%0 \\\\star %1',\r\n    asymp: '%0 \\\\asymp %1',\r\n    '/': '\\\\frac{%0}{%1}',\r\n    Re: '\\\\Re{%0}',\r\n    Im: '\\\\Im{%0}',\r\n    factorial: '%0!',\r\n    factorial2: '%0!!',\r\n};\r\n\r\n// From www.w3.org/TR/MathML3/appendixc.html\r\n// The keys of OP_PRECEDENCE are \"canonical names\"\r\n// (the values of the CANONICAL_NAMES table above, e.g. \"?=\")\r\n// Those are different from the latex names (e.g. \\\\questeq)\r\n// and from the function names (e.g. \"questeq\")\r\nconst OP_PRECEDENCE = {\r\n    degree: 880,\r\n    nabla: 740,\r\n    curl: 740, // not in MathML\r\n    partial: 740,\r\n    differentialD: 740, // not in MathML\r\n    capitalDifferentialD: 740, // not in MathML\r\n\r\n    '**': 720, // not in MathML\r\n\r\n    odot: 710,\r\n\r\n    // Logical not\r\n    not: 680,\r\n\r\n    // Division\r\n    div: 660, // division sign\r\n    solidus: 660,\r\n    '/': 660,\r\n\r\n    setminus: 650, // \\setminus, \\smallsetminus\r\n\r\n    '%': 640,\r\n\r\n    otimes: 410,\r\n\r\n    // Set operators\r\n    union: 350, // \\cup\r\n    intersection: 350, // \\cap\r\n\r\n    // Multiplication, division and modulo\r\n    '*': 390,\r\n    ast: 390,\r\n    '.': 390,\r\n\r\n    oplus: 300, // also logical XOR... @todo\r\n    ominus: 300,\r\n\r\n    // Addition\r\n    '+': 275,\r\n    '-': 275,\r\n    '+-': 275, // \\pm\r\n    '-+': 275, // \\mp\r\n\r\n    // Most circled-ops are 265\r\n    circle: 265,\r\n    circledast: 265,\r\n    circledcirc: 265,\r\n    star: 265, // Different from ast\r\n\r\n    // Range\r\n    '..': 263, // Not in MathML\r\n\r\n    // Unit conversion\r\n    to: 262, // Not in MathML\r\n    in: 262, // Not in MathML\r\n\r\n    '|': 261, // Not in MathML    (bind is the |_ operator)\r\n\r\n    // Relational\r\n    congruent: 265,\r\n    equiv: 260, // MathML: \"identical to\"\r\n    '=': 260,\r\n    '!=': 255,\r\n    '?=': 255,\r\n    similar: 250, // tilde operator in MathML\r\n\r\n    approx: 247,\r\n    '<': 245,\r\n    '>': 243,\r\n    '>=': 242,\r\n    '': 242,\r\n    '<=': 241,\r\n\r\n    // Set operator\r\n    complement: 240,\r\n    subset: 240, // \\subset\r\n    superset: 240, // \\supset\r\n    // @todo and equality and neg operators\r\n    elementof: 240, // \\in\r\n    '!elementof': 240, // \\notin\r\n    //\r\n    exists: 230,\r\n    '!exists': 230,\r\n    forall: 230,\r\n\r\n    // Logical operators\r\n    and: 200,\r\n    xor: 195, // MathML had 190\r\n    or: 190,\r\n    // Note: 'not' is 680\r\n\r\n    // center, low, diag, vert ellipsis         150\r\n\r\n    // Composition/sequence\r\n    suchThat: 110, // \\backepsilon\r\n    ':': 100,\r\n    // '..':               100,\r\n    // '...':               100,\r\n\r\n    // Conditional (?:)\r\n\r\n    // Assignment\r\n    assign: 80,\r\n    ':=': 80, // MathML had 260 (same with U+2254 COLON EQUALS)\r\n\r\n    therefore: 70,\r\n    because: 70,\r\n\r\n    // Arrows\r\n    // Note: MathML had 270 for the arrows, but this\r\n    // would not work for (a = b => b = a)\r\n    // See also https://en.wikipedia.org/wiki/Logical_connective#Order_of_precedence\r\n    // for a suggested precedence (note that in this page lower precedence\r\n    // has the opposite meaning as what we use)\r\n    shortLogicalImplies: 52, // ->\r\n    shortImplies: 51, // =>\r\n    logicalImplies: 50, // -->\r\n    implies: 49, // ==>\r\n\r\n    shortLogicalImpliedBy: 48, // <-\r\n    shortImpliedBy: 47, // <=\r\n    logicalImpliedBy: 46, // <--\r\n    impliedBy: 45, // <==\r\n\r\n    shortLogicalEquivalent: 44, // <->\r\n    shortEquivalent: 43, // <=>\r\n    logicalEquivalent: 42, // <-->\r\n    equivalent: 41, // <==>\r\n\r\n    ',': 40,\r\n    ';': 30,\r\n};\r\n\r\nfunction getArg(ast, index) {\r\n    return isArray(ast.arg) ? ast.arg[index] : undefined;\r\n}\r\n\r\n/**\r\n * Given a canonical name, return its precedence\r\n * @param canonicalName, for example \"and\"\r\n */\r\nfunction getPrecedence(canonicalName: string): number {\r\n    return canonicalName ? OP_PRECEDENCE[canonicalName] || -1 : -1;\r\n}\r\n\r\nfunction getAssociativity(canonicalName: string): 'left' | 'right' {\r\n    if (/=|=>/.test(canonicalName)) {\r\n        return 'right';\r\n    }\r\n    return 'left';\r\n}\r\n\r\n/**\r\n *\r\n * @param name - function canonical name\r\n */\r\nfunction getLatexTemplateForFunction(name: string): string {\r\n    let result = FUNCTION_TEMPLATE[name];\r\n    if (!result) {\r\n        result =\r\n            name.length > 1\r\n                ? '\\\\operatorname{' + name + '}%^%_ %'\r\n                : name + '%^%_ %';\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n/**\r\n *\r\n * @param name symbol name, e.g. \"alpha\"\r\n */\r\nfunction getLatexForSymbol(name: string): string {\r\n    let result = FUNCTION_TEMPLATE[name];\r\n    if (result) {\r\n        return result.replace('%1', '').replace('%0', '').replace('%', '');\r\n    }\r\n    if (name.length > 1) {\r\n        result = '\\\\' + name;\r\n    }\r\n    if (!result) {\r\n        result = unicodeStringToLatex('math', name);\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nfunction isFunction(canonicalName: string): boolean {\r\n    if (canonicalName === 'f' || canonicalName === 'g') return true;\r\n\r\n    const t = FUNCTION_TEMPLATE[canonicalName];\r\n    if (!t) return false;\r\n\r\n    // A plain \"%\" is a placeholder for an argument list, indicating a function\r\n    if (/%[^01_^]?/.test(t)) return true;\r\n\r\n    return false;\r\n}\r\n\r\n/**\r\n *\r\n * @param latex, for example '\\\\times'\r\n * @retur the canonical name for the input, for example '*'\r\n */\r\nfunction getCanonicalName(latex: string): string {\r\n    latex = (latex || '').trim();\r\n    let result = CANONICAL_NAMES[latex];\r\n    if (!result) {\r\n        if (/^\\\\[^{}]+$/.test(latex)) {\r\n            const info = getInfo(latex, 'math', {});\r\n            if (info) {\r\n                result = info.value || latex.slice(1);\r\n            } else {\r\n                result = latex.slice(1);\r\n            }\r\n        } else {\r\n            result = latex;\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\n/**\r\n * Return the operator precedence of the atom\r\n * or null if not an operator\r\n */\r\nfunction opPrec(atom: Atom): [number, 'left' | 'right'] {\r\n    if (!atom) return null;\r\n    const name = getCanonicalName(getString(atom));\r\n    const result: [number, 'left' | 'right'] = [\r\n        getPrecedence(name),\r\n        getAssociativity(name),\r\n    ];\r\n    if (result[0] <= 0) return null;\r\n    return result;\r\n}\r\n\r\nfunction isOperator(atom) {\r\n    return opPrec(atom) !== null;\r\n}\r\n\r\nconst DELIM_FUNCTION = {\r\n    '\\\\lfloor\\\\rfloor': 'floor',\r\n    '\\\\lceil\\\\rceil': 'ceil',\r\n    '\\\\vert\\\\vert': 'abs',\r\n    '\\\\lvert\\\\rvert': 'abs',\r\n    '||': 'abs',\r\n    '\\\\Vert\\\\Vert': 'norm',\r\n    '\\\\lVert\\\\rVert': 'norm',\r\n    '\\\\ulcorner\\\\urcorner': 'ucorner',\r\n    '\\\\llcorner\\\\lrcorner': 'lcorner',\r\n    '\\\\langle\\\\rangle': 'angle',\r\n    '\\\\lgroup\\\\rgroup': 'group',\r\n    '\\\\lmoustache\\\\rmoustache': 'moustache',\r\n    '\\\\lbrace\\\\rbrace': 'brace',\r\n};\r\n\r\nconst POSTFIX_FUNCTION = {\r\n    '!': 'factorial',\r\n    '\\\\dag': 'dagger',\r\n    '\\\\dagger': 'dagger',\r\n    '\\\\ddagger': 'dagger2',\r\n    '\\\\maltese': 'maltese',\r\n    '\\\\backprime': 'backprime',\r\n    '\\\\backdoubleprime': 'backprime2',\r\n    '\\\\prime': 'prime',\r\n    '\\\\doubleprime': 'prime2',\r\n    '\\\\$': '$',\r\n    '\\\\%': '%',\r\n    '\\\\_': '_',\r\n    '\\\\degree': 'degree',\r\n};\r\n\r\nconst ASSOCIATIVE_FUNCTION = {\r\n    '+': 'add',\r\n    '-': 'add', // Subtraction is add(), but it's\r\n    // handled specifically so that the\r\n    // argument is negated\r\n    '*': 'multiply',\r\n\r\n    '=': 'equal',\r\n\r\n    ',': 'list',\r\n    ';': 'list2',\r\n\r\n    and: 'and',\r\n    or: 'or',\r\n    xor: 'xor',\r\n    union: 'union',\r\n    // shortLogicalEquivalent and logicalEquivalent map to the same function\r\n    // they mean the same thing, but have a difference precedence.\r\n    shortLogicalEquivalent: 'logicalEquivalent', // logical equivalent, iff, biconditional logical connective\r\n    logicalEquivalent: 'logicalEquivalent', // same\r\n    // shortEquivalent and equivalent map to the same function\r\n    // they mean the same thing, but have a difference precedence.\r\n    shortEquivalent: 'equivalent', // metalogic equivalent\r\n    equivalent: 'equivalent', // same\r\n};\r\n\r\nconst SUPER_ASSOCIATIVE_FUNCTION = {\r\n    ',': 'list',\r\n    ';': 'list2',\r\n};\r\n\r\nfunction getString(atom) {\r\n    if (typeof atom === 'string') return atom;\r\n    if (isArray(atom)) {\r\n        let result = '';\r\n        for (const subAtom of atom) {\r\n            result += getString(subAtom);\r\n        }\r\n        return result;\r\n    }\r\n    if (\r\n        atom.symbol &&\r\n        !/^\\\\math(op|bin|rel|open|punct|ord|inner)/.test(atom.symbol)\r\n    ) {\r\n        return atom.symbol;\r\n    }\r\n    if (atom.type === 'leftright') {\r\n        return '';\r\n    }\r\n    if (typeof atom.value === 'string') {\r\n        return atom.value;\r\n    }\r\n    if (isArray(atom.branch('body'))) {\r\n        let result = '';\r\n        for (const subAtom of atom.branch('body')) {\r\n            result += getString(subAtom);\r\n        }\r\n        return result;\r\n    }\r\n    return '';\r\n}\r\n\r\n/**\r\n *\r\n * @param {object} expr - Abstract Syntax Tree object\r\n * @return A string, the symbol, or undefined\r\n */\r\nfunction asSymbol(node): string {\r\n    return typeof node.sym === 'string'\r\n        ? getLatexForSymbol(node.sym) || node.sym\r\n        : '';\r\n}\r\n\r\n/**\r\n *\r\n * @param {object} node - Abstract Syntax Tree node\r\n * @return A JavaScript number, the value of the AST or NaN\r\n */\r\nfunction asMachineNumber(node): number {\r\n    return parseFloat(node.num);\r\n}\r\n\r\nfunction isNumber(node): boolean {\r\n    return typeof node === 'object' && typeof node.num !== 'undefined';\r\n}\r\n\r\nfunction numberRe(node): number {\r\n    let result = 0;\r\n    if (isNumber(node)) {\r\n        if (typeof node.num === 'object') {\r\n            result =\r\n                typeof node.num.re !== 'undefined'\r\n                    ? parseFloatToPrecision(node.num.re)\r\n                    : 0;\r\n        } else {\r\n            result = parseFloat(node.num);\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\nfunction numberIm(node): number {\r\n    let result = 0;\r\n    if (isNumber(node)) {\r\n        if (typeof node.num === 'object') {\r\n            result =\r\n                typeof node.num.im !== 'undefined'\r\n                    ? parseFloatToPrecision(node.num.im)\r\n                    : 0;\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\nfunction isComplexWithRealAndImaginary(node) {\r\n    return numberRe(node) !== 0 && numberIm(node) !== 0;\r\n}\r\n\r\nfunction hasSup(node) {\r\n    return node && typeof node.sup !== 'undefined';\r\n}\r\n\r\nfunction hasSub(node) {\r\n    return node && typeof node.sub !== 'undefined';\r\n}\r\n\r\n/**\r\n * Return true if the current atom is of the specified type and value.\r\n */\r\nfunction isAtom(expr: ParseState, type: AtomType, value?): boolean {\r\n    let result = false;\r\n    const atom = expr.atoms[expr.index];\r\n    if (atom && atom.type === type) {\r\n        if (typeof value === 'undefined') {\r\n            result = true;\r\n        } else {\r\n            result = getString(atom) === value;\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\nfunction wrapFn(functionName: string, ...params: any[]): MathJsonFunction {\r\n    const result = { fn: functionName, arg: undefined };\r\n    if (params) {\r\n        const args = [];\r\n        for (const arg of params) {\r\n            if (arg) args.push(arg);\r\n        }\r\n        if (args.length > 0) result.arg = args;\r\n    }\r\n    return result;\r\n}\r\n\r\nfunction wrapNum(num: number | string | ComplexNumber): MathJsonNumber {\r\n    if (typeof num === 'number') {\r\n        return { num: num.toString() };\r\n    } else if (typeof num === 'string') {\r\n        return { num: num };\r\n    } else if (typeof num === 'object') {\r\n        // This is a complex number\r\n        console.assert(\r\n            typeof num['re'] === 'string' || typeof num['im'] === 'string'\r\n        );\r\n        return { num: num };\r\n    }\r\n    return undefined;\r\n}\r\n\r\n/**\r\n * Return the negative of the expression. Usually { fn:'negate', arg }\r\n * but for numbers, the negated number\r\n * @param {object} node\r\n * @private\r\n */\r\nfunction negate(node) {\r\n    if (isNumber(node)) {\r\n        const re = numberRe(node);\r\n        const im = numberIm(node);\r\n        if (im !== 0) {\r\n            if (re !== 0) {\r\n                node.num.re = (-re).toString();\r\n            }\r\n            node.num.im = (-im).toString();\r\n        } else {\r\n            node.num = (-re).toString();\r\n        }\r\n        return node;\r\n    }\r\n    return wrapFn('negate', node);\r\n}\r\n\r\nfunction nextIsSupsub(expr) {\r\n    const atom = expr.atoms[expr.index + 1];\r\n    return atom && atom.type === 'msubsup';\r\n}\r\n\r\n/**\r\n * Parse for a possible sup/sub attached directly to the current atom\r\n * or to a following 'msubsup' atom.\r\n * After the call, the index points to the next atom to process.\r\n * @param {object} expr\r\n * @private\r\n */\r\nfunction parseSupsub(expr, options) {\r\n    let atom = expr.atoms[expr.index];\r\n\r\n    // Is there a supsub directly on this atom?\r\n    if (\r\n        atom &&\r\n        (typeof atom.branches?.superscript !== 'undefined' ||\r\n            typeof atom.branches?.subscript !== 'undefined')\r\n    ) {\r\n        // Move to the following atom\r\n        expr.index += 1;\r\n    } else {\r\n        atom = null;\r\n    }\r\n\r\n    // If this atom didn't have a sup/sub,\r\n    // is the following atom a subsup atom?\r\n    if (!atom) {\r\n        atom = expr.atoms[expr.index + 1];\r\n        if (\r\n            !atom ||\r\n            atom.type !== 'msubsup' ||\r\n            !(atom.branches?.superscript || atom.branches?.subscript)\r\n        ) {\r\n            atom = null;\r\n        } else {\r\n            // Yes. Skip the current atom and the supsub\r\n            expr.index += 2;\r\n        }\r\n    }\r\n\r\n    if (atom) {\r\n        if (typeof atom.branches?.subscript !== 'undefined') {\r\n            expr.ast.sub = parse(atom.branches?.subscript, options);\r\n        }\r\n        if (typeof atom.branches?.superscript !== 'undefined') {\r\n            if (atom.type === 'msubsup') {\r\n                if (\r\n                    /['\\u2032]|\\\\prime/.test(\r\n                        getString(atom.branches?.superscript)\r\n                    )\r\n                ) {\r\n                    expr.index += 1;\r\n                    atom = expr.atoms[expr.index + 1];\r\n                    if (\r\n                        atom &&\r\n                        atom.type === 'msubsup' &&\r\n                        /['\\u2032]|\\\\prime/.test(\r\n                            getString(atom.branches?.superscript)\r\n                        )\r\n                    ) {\r\n                        expr.ast.sup = { sym: '\\u2033' }; // DOUBLE-PRIME\r\n                    } else {\r\n                        expr.ast.sup = { sym: '\\u2032' }; // PRIME\r\n                        expr.index -= 1;\r\n                    }\r\n                } else if (\r\n                    /['\\u2033]|\\\\doubleprime/.test(\r\n                        getString(atom.branches?.superscript)\r\n                    )\r\n                ) {\r\n                    expr.ast.sup = { sym: '\\u2033' }; // DOUBLE-PRIME\r\n                } else if (expr.ast) {\r\n                    expr.ast.sup = parse(atom.branches?.superscript, options);\r\n                }\r\n            } else {\r\n                expr.ast.sup = parse(atom.branches?.superscript, options);\r\n            }\r\n        }\r\n    } else {\r\n        // Didn't find a supsup either on this atom and there was no 'msubsup'\r\n        // Time to move on to the next atom.\r\n        expr.index += 1;\r\n    }\r\n\r\n    return expr;\r\n}\r\n\r\n/**\r\n * Parse postfix operators, such as \"!\" (factorial)\r\n * @private\r\n */\r\nfunction parsePostfix(expr, options) {\r\n    const lhs = expr.ast;\r\n    if (nextIsDigraph(expr, '!!')) {\r\n        expr.index += 1;\r\n        expr.ast = wrapFn('factorial2', lhs);\r\n        expr = parseSupsub(expr, options);\r\n        expr = parsePostfix(expr, options);\r\n        return expr;\r\n    }\r\n    if (nextIsDigraph(expr, '++')) {\r\n        expr.index += 1;\r\n        expr.ast = wrapFn('increment', lhs);\r\n        expr = parseSupsub(expr, options);\r\n        expr = parsePostfix(expr, options);\r\n        return expr;\r\n    }\r\n    if (nextIsDigraph(expr, '--')) {\r\n        expr.index += 1;\r\n        expr.ast = wrapFn('decrement', lhs);\r\n        expr = parseSupsub(expr, options);\r\n        expr = parsePostfix(expr, options);\r\n        return expr;\r\n    }\r\n    const atom = expr.atoms[expr.index];\r\n    if (atom?.symbol && POSTFIX_FUNCTION[atom.symbol]) {\r\n        expr.ast = wrapFn(POSTFIX_FUNCTION[atom.symbol], lhs);\r\n        expr = parseSupsub(expr, options);\r\n        expr = parsePostfix(expr, options);\r\n    }\r\n    return expr;\r\n}\r\n\r\n/**\r\n * Delimiters can be expressed:\r\n * - as a matching pair of regular characters: '(a)'\r\n * - a as 'leftright' expression: '\\left(a\\right)'\r\n * - as a matching pair of 'sizeddelim': '\\Bigl(a\\Bigr)\r\n *\r\n * Note that the '\\delim' command is only used for delimiters in the middle\r\n * of a \\left\\right pair and not to represent pair-matched delimiters.\r\n *\r\n * This function handles all three cases\r\n */\r\nfunction parseDelim(\r\n    expr: ParseState,\r\n    ldelim,\r\n    rdelim,\r\n    options: MathJsonLatexOptions\r\n) {\r\n    expr.index = expr.index || 0;\r\n\r\n    if (expr.atoms.length === 0 || expr.index >= expr.atoms.length) {\r\n        expr.ast = undefined;\r\n        return expr;\r\n    }\r\n\r\n    const savedPrec = expr.minPrec;\r\n    expr.minPrec = 0;\r\n    let atom = expr.atoms[expr.index];\r\n\r\n    if (!ldelim) {\r\n        // If we didn't expect a specific delimiter, parse any delimiter\r\n        // and return it as a function application\r\n        let pairedDelim = true;\r\n        if (atom.type === 'mopen') {\r\n            ldelim = atom.value;\r\n            rdelim = RIGHT_DELIM[ldelim];\r\n        } else if (atom.type === 'sizeddelim') {\r\n            ldelim = atom.value;\r\n            rdelim = RIGHT_DELIM[ldelim];\r\n        } else if (atom instanceof LeftRightAtom) {\r\n            pairedDelim = false;\r\n            ldelim = atom.leftDelim;\r\n            rdelim = atom.rightDelim;\r\n            // If we have an unclosed smart fence, assume the right delim is\r\n            // matching the left delim\r\n            if (rdelim === '?') rdelim = RIGHT_DELIM[ldelim];\r\n        } else if (atom.type === 'textord') {\r\n            ldelim = atom.value;\r\n            rdelim = RIGHT_DELIM[ldelim];\r\n        }\r\n        if (ldelim && rdelim) {\r\n            if (ldelim === '|' && rdelim === '|') {\r\n                // Check if this could be a ||x|| instead of |x|\r\n                const atom = expr.atoms[expr.index + 1];\r\n                if (atom && atom.type === 'textord' && atom.value === '|') {\r\n                    // Yes, it's a ||x||\r\n                    ldelim = '\\\\lVert';\r\n                    rdelim = '\\\\rVert';\r\n                }\r\n            }\r\n            expr = parseDelim(expr, ldelim, rdelim, options);\r\n            if (expr) {\r\n                if (pairedDelim) expr.index += 1;\r\n                expr.ast = {\r\n                    fn: DELIM_FUNCTION[ldelim + rdelim] || ldelim + rdelim,\r\n                    arg: [expr.ast],\r\n                };\r\n                expr.minPrec = savedPrec;\r\n                return expr;\r\n            }\r\n        }\r\n        return undefined;\r\n    }\r\n\r\n    if (atom.type === 'mopen' && getString(atom) === ldelim) {\r\n        expr.index += 1; // Skip the open delim\r\n        expr = parseExpression(expr, options);\r\n        atom = expr.atoms[expr.index];\r\n        if (atom && atom.type === 'mclose' && getString(atom) === rdelim) {\r\n            if (nextIsSupsub(expr)) {\r\n                // Wrap in a group if we have an upcoming superscript or subscript\r\n                expr.ast = { group: expr.ast };\r\n            }\r\n            expr = parseSupsub(expr, options);\r\n            expr = parsePostfix(expr, options);\r\n        } // TODO: else, syntax error?\r\n    } else if (atom.type === 'textord' && getString(atom) === ldelim) {\r\n        expr.index += 1; // Skip the open delim\r\n        expr = parseExpression(expr, options);\r\n        atom = expr.atoms[expr.index];\r\n        if (atom && atom.type === 'textord' && getString(atom) === rdelim) {\r\n            expr.index += 1;\r\n            expr = parseSupsub(expr, options);\r\n            expr = parsePostfix(expr, options);\r\n        } // TODO: else, syntax error?\r\n    } else if (\r\n        ldelim === '\\\\lVert' &&\r\n        atom.type === 'textord' &&\r\n        atom.value === '|'\r\n    ) {\r\n        atom = expr.atoms[expr.index + 1];\r\n        if (atom && atom.type === 'textord' && atom.value === '|') {\r\n            // This is an opening ||\r\n            expr.index += 2; // Skip the open delim\r\n            expr = parseExpression(expr, options);\r\n            atom = expr.atoms[expr.index];\r\n            const atom2 = expr.atoms[expr.index + 1];\r\n            if (\r\n                atom &&\r\n                atom.type === 'textord' &&\r\n                atom.value === '|' &&\r\n                atom2 &&\r\n                atom2.type === 'textord' &&\r\n                atom2.value === '|'\r\n            ) {\r\n                // This was a closing ||\r\n                expr.index += 2;\r\n                expr = parseSupsub(expr, options);\r\n                expr = parsePostfix(expr, options);\r\n            }\r\n        }\r\n    } else if (atom.type === 'sizeddelim' && atom.value === ldelim) {\r\n        expr.index += 1; // Skip the open delim\r\n        expr = parseExpression(expr, options);\r\n        atom = expr.atoms[expr.index];\r\n        if (atom && atom.type === 'sizeddelim' && atom.value === rdelim) {\r\n            expr.index += 1;\r\n            expr = parseSupsub(expr, options);\r\n            expr = parsePostfix(expr, options);\r\n        } // TODO: else, syntax error?\r\n    } else if (\r\n        atom instanceof LeftRightAtom &&\r\n        atom.leftDelim === ldelim &&\r\n        (atom.rightDelim === '?' || atom.rightDelim === rdelim)\r\n    ) {\r\n        // This atom type includes the content of the parenthetical expression\r\n        // in its body\r\n        expr.ast = parse(atom.branch('body'), options);\r\n        if (nextIsSupsub(expr)) {\r\n            // Wrap in a group if we have an upcoming superscript or subscript\r\n            expr.ast = { group: expr.ast };\r\n        }\r\n        expr = parseSupsub(expr, options);\r\n        expr = parsePostfix(expr, options);\r\n    } else {\r\n        return undefined;\r\n    }\r\n\r\n    expr.minPrec = savedPrec;\r\n    return expr;\r\n}\r\n\r\nfunction nextIsDigraph(expr, digraph) {\r\n    expr.index = expr.index || 0;\r\n\r\n    if (expr.atoms.length <= 1 || expr.index >= expr.atoms.length - 1) {\r\n        return false;\r\n    }\r\n\r\n    return (\r\n        digraph ===\r\n        getString(expr.atoms[expr.index]) +\r\n            getString(expr.atoms[expr.index + 1])\r\n    );\r\n}\r\n\r\n/**\r\n * Some symbols are made up of two consecutive characters.\r\n * Handle them here. Return undefined if not a digraph.\r\n * TODO: other digraphs:\r\n * :=\r\n * ++\r\n * **\r\n * =:\r\n * C U+2103\r\n * F U+2109\r\n * @private\r\n *\r\n */\r\nfunction parseDigraph(expr) {\r\n    expr.index = expr.index || 0;\r\n\r\n    if (expr.atoms.length <= 1 || expr.index >= expr.atoms.length - 1) {\r\n        return undefined;\r\n    }\r\n\r\n    if (isAtom(expr, 'textord', '\\\\nabla')) {\r\n        expr.index += 1;\r\n        if (isAtom(expr, 'mbin', '\\\\times')) {\r\n            expr.index += 1;\r\n            expr.ast = 'curl'; // divergence\r\n            return expr;\r\n        } else if (isAtom(expr, 'mbin', '\\\\cdot')) {\r\n            expr.index += 1;\r\n            expr.ast = 'div';\r\n            return expr;\r\n        }\r\n        expr.index -= 1;\r\n    } else {\r\n        const digraph =\r\n            expr.atoms[expr.index].symbol + expr.atoms[expr.index + 1].symbol;\r\n        const result = /^(>=|<=|>>|<<|:=|!=)$/.test(digraph) ? digraph : '';\r\n        if (result) {\r\n            expr.index += 1;\r\n        }\r\n        return result;\r\n    }\r\n\r\n    return undefined;\r\n}\r\n\r\nfunction parsePrimary(expr: ParseState, options: MathJsonLatexOptions) {\r\n    // <primary> := ('-'|'+) <primary> | <number> |\r\n    //              '(' <expression> ')' | <symbol> | <text> (<expression>)\r\n\r\n    expr.index = expr.index || 0;\r\n    expr.ast = undefined;\r\n\r\n    if (expr.atoms.length === 0 || expr.index >= expr.atoms.length) {\r\n        return expr;\r\n    }\r\n\r\n    let atom = expr.atoms[expr.index];\r\n    if (atom.mode === 'text') {\r\n        let text = '';\r\n        while (\r\n            expr.atoms[expr.index] &&\r\n            expr.atoms[expr.index].mode === 'text'\r\n        ) {\r\n            text += expr.atoms[expr.index].value;\r\n            expr.index += 1;\r\n        }\r\n        expr.ast = { text: text };\r\n        return expr;\r\n    }\r\n\r\n    const val = getCanonicalName(getString(atom));\r\n\r\n    const digraph = parseDigraph(expr);\r\n    if (digraph) {\r\n        expr.ast = wrapFn(expr.ast, parsePrimary(expr, options).ast);\r\n    } else if (atom.type === 'root') {\r\n        expr.index = 0;\r\n        expr.atoms = atom.branch('body');\r\n        return parsePrimary(expr, options);\r\n    } else if (atom.type === 'mbin' && val === '-') {\r\n        // Prefix - sign\r\n        expr.index += 1; // Skip the '-' symbol\r\n        expr = parsePrimary(expr, options);\r\n        expr.ast = negate(expr.ast);\r\n    } else if (atom.type === 'mbin' && val === '+') {\r\n        // Prefix + sign\r\n        expr.index += 1; // Skip the '+' symbol\r\n        expr = parsePrimary(expr, options);\r\n        expr.ast = wrapFn('add', expr.ast);\r\n    } else if (atom.type === 'mord' && /^[0-9.]$/.test(atom.value)) {\r\n        // Looks like a number\r\n        let num = '';\r\n        let done = false;\r\n        let pat = /^[0-9.eEdD]$/;\r\n        while (\r\n            expr.index < expr.atoms.length &&\r\n            !done &&\r\n            (isAtom(expr, 'spacing') ||\r\n                ((isAtom(expr, 'mord') ||\r\n                    isAtom(expr, 'mpunct', ',') ||\r\n                    isAtom(expr, 'mbin')) &&\r\n                    pat.test(expr.atoms[expr.index].value)))\r\n        ) {\r\n            if (expr.atoms[expr.index].type === 'spacing') {\r\n                expr.index += 1;\r\n            } else if (\r\n                typeof expr.atoms[expr.index].superscript !== 'undefined' ||\r\n                typeof expr.atoms[expr.index].subscript !== 'undefined'\r\n            ) {\r\n                done = true;\r\n            } else {\r\n                let digit = expr.atoms[expr.index].value;\r\n                if (digit === 'd' || digit === 'D') {\r\n                    digit = 'e';\r\n                    pat = /^[0-9+-.]$/;\r\n                } else if (digit === 'e' || digit === 'E') {\r\n                    if (nextIsSupsub(expr)) {\r\n                        digit = '';\r\n                        expr.index -= 1;\r\n                        done = true;\r\n                    } else {\r\n                        digit = 'E';\r\n                        pat = /^[0-9+-.]$/;\r\n                    }\r\n                } else if (pat === /^[0-9+-.]$/) {\r\n                    pat = /^[0-9]$/;\r\n                }\r\n                num += digit === ',' ? '' : digit;\r\n                expr.index += 1;\r\n            }\r\n        }\r\n        expr.ast = num ? wrapNum(num) : undefined;\r\n\r\n        // This was a number. Is it followed by a fraction, e.g. 2 1/2\r\n        atom = expr.atoms[expr.index];\r\n        if (atom && atom.type === 'genfrac' && !isNaN(expr.ast.num)) {\r\n            // Add an invisible plus, i.e. 2 1/2 = 2 + 1/2\r\n            const lhs = expr.ast;\r\n            expr = parsePrimary(expr, options);\r\n            expr.ast = wrapFn('add', lhs, expr.ast);\r\n        }\r\n        if (\r\n            atom &&\r\n            atom.type === 'group' &&\r\n            atom.command.startsWith('\\\\nicefrac')\r\n        ) {\r\n            // \\nicefrac macro, add an invisible plus\r\n            const lhs = expr.ast;\r\n            expr = parsePrimary(expr, options);\r\n            expr.ast = wrapFn('add', lhs, expr.ast);\r\n        }\r\n        if (atom && atom.type === 'msubsup') {\r\n            expr = parseSupsub(expr, options);\r\n        }\r\n        expr = parsePostfix(expr, options);\r\n    } else if (atom.type === 'genfrac' || atom.type === 'surd') {\r\n        // A fraction or a square/cube root\r\n        expr.ast = atomToMathJson(atom, options);\r\n        expr = parseSupsub(expr, options);\r\n        expr = parsePostfix(expr, options);\r\n    } else if (atom.type === 'mord' || atom.type === 'mbin') {\r\n        // A 'mord' but not a number: either an identifier ('x') or\r\n        // a function ('\\\\Zeta')\r\n        if (isFunction(val) && !isOperator(atom)) {\r\n            // A function\r\n            expr.ast = { fn: val };\r\n            expr = parseSupsub(expr, options);\r\n\r\n            const fn = expr.ast;\r\n            const arg = parsePrimary(expr, options).ast;\r\n            if (arg && /^(list0|list|list2)$/.test(arg.fn)) {\r\n                fn.arg = arg.arg;\r\n            } else if (arg) {\r\n                fn.arg = [arg];\r\n            }\r\n            expr.ast = fn;\r\n        } else {\r\n            // An identifier\r\n            expr.ast = atomToMathJson(atom, options);\r\n            if (expr.ast.sym === '') {\r\n                // It's 'i', the imaginary unit\r\n                expr.ast = wrapNum({ im: '1' });\r\n            }\r\n            expr = parseSupsub(expr, options);\r\n        }\r\n        expr = parsePostfix(expr, options);\r\n    } else if (atom.type === 'textord') {\r\n        // Note that 'textord' can also be operators, and are handled as such\r\n        // in parseExpression()\r\n        if (!isOperator(atom)) {\r\n            // This doesn't look like a textord operator\r\n            if (!RIGHT_DELIM[atom.value]) {\r\n                // Not an operator, not a fence, it's a symbol or a function\r\n                if (isFunction(val)) {\r\n                    // It's a function\r\n                    expr.ast = { fn: val };\r\n                    expr = parseSupsub(expr, options);\r\n\r\n                    const fn = expr.ast;\r\n                    expr.index += 1; // Skip the function name\r\n                    fn.arg = [parsePrimary(expr, options).ast];\r\n                    expr.ast = fn;\r\n\r\n                    expr = parsePostfix(expr, options);\r\n                } else {\r\n                    // It was a symbol...\r\n                    expr.ast = atomToMathJson(atom, options);\r\n                    if (typeof atom.superscript === 'undefined') {\r\n                        expr.index += 1;\r\n                    }\r\n                    expr = parseSupsub(expr, options);\r\n                    expr = parsePostfix(expr, options);\r\n                }\r\n            }\r\n        }\r\n    } else if (atom.type === 'mop') {\r\n        // Could be a function or an operator.\r\n        if (\r\n            (/^\\\\(mathop|operatorname|operatorname\\*)/.test(atom.command) ||\r\n                isFunction(val)) &&\r\n            !isOperator(atom)\r\n        ) {\r\n            expr.ast = {\r\n                fn: /^\\\\(mathop|operatorname|operatorname\\*)/.test(atom.command)\r\n                    ? getString(atom.branch('body'))\r\n                    : val,\r\n            };\r\n            expr = parseSupsub(expr, options);\r\n\r\n            if (hasSup(expr.ast)) {\r\n                // There was an exponent with the function.\r\n                // This may be an inverse function\r\n                const INVERSE_FUNCTION = {\r\n                    sin: 'arcsin',\r\n                    cos: 'arccos',\r\n                    tan: 'arctan',\r\n                    cot: 'arccot',\r\n                    sec: 'arcsec',\r\n                    csc: 'arccsc',\r\n                    sinh: 'arsinh',\r\n                    cosh: 'arcosh',\r\n                    tanh: 'artanh',\r\n                    csch: 'arcsch',\r\n                    sech: 'arsech',\r\n                    coth: 'arcoth',\r\n                };\r\n                if (\r\n                    asMachineNumber(expr.ast.sup) === -1 &&\r\n                    INVERSE_FUNCTION[val]\r\n                ) {\r\n                    expr.ast = wrapFn(\r\n                        INVERSE_FUNCTION[val],\r\n                        parsePrimary(expr, options).ast\r\n                    );\r\n                } else {\r\n                    // Keep the exponent, add the argument\r\n                    const fn = expr.ast;\r\n                    fn.arg = [parsePrimary(expr, options).ast];\r\n                    expr.ast = fn;\r\n                }\r\n            } else {\r\n                const fn = expr.ast;\r\n                const arg = parsePrimary(expr, options).ast;\r\n                if (arg && /^(list0|list|list2)$/.test(arg.fn)) {\r\n                    fn.arg = arg.arg;\r\n                } else if (arg) {\r\n                    fn.arg = [arg];\r\n                }\r\n\r\n                expr.ast = fn;\r\n            }\r\n        }\r\n    } else if (atom.type === 'array') {\r\n        expr.index += 1;\r\n        expr.ast = atomToMathJson(atom, options);\r\n    } else if (atom.type === 'group') {\r\n        expr.index += 1;\r\n        expr.ast = atomToMathJson(atom, options);\r\n    } else if (atom.type === 'mclose') {\r\n        return expr;\r\n    } else if (atom.type === 'error') {\r\n        expr.index += 1;\r\n        expr.ast = { error: atom.command };\r\n        return expr;\r\n    }\r\n\r\n    if (expr.ast === undefined) {\r\n        // Parse either a group of paren, and return their content as the result\r\n        // or a pair of delimiters, and return them as a function applied\r\n        // to their content, i.e. \"|x|\" -> {fn: \"||\", arg: \"x\"}\r\n        const delim =\r\n            parseDelim(expr, '(', ')', options) ||\r\n            parseDelim(expr, null, null, options);\r\n        if (delim) {\r\n            expr = delim;\r\n        } else if (!isOperator(atom)) {\r\n            // This is not an operator (if it is, it may be an operator\r\n            // dealing with an empty lhs. It's possible.\r\n            // Couldn't interpret the expression. Output an error.\r\n            if (atom.type === 'placeholder') {\r\n                // Default value for a placeholder is 0\r\n                // (except for the denominator of a 'genfrac')\r\n                expr.ast = wrapNum(0);\r\n            } else {\r\n                expr.ast = { text: '?' };\r\n                expr.ast.error = 'Unexpected token ' + \"'\" + atom.type + \"'\";\r\n                if (atom.latex) {\r\n                    expr.ast.latex = atom.latex;\r\n                }\r\n            }\r\n            expr.index += 1; // Skip the unexpected token, and attempt to continue\r\n        }\r\n    }\r\n\r\n    atom = expr.atoms[expr.index];\r\n    if (\r\n        atom &&\r\n        (atom.type === 'mord' ||\r\n            atom.type === 'surd' ||\r\n            atom.type === 'mop' ||\r\n            atom.type === 'mopen' ||\r\n            atom.type === 'sizeddelim' ||\r\n            atom.type === 'leftright')\r\n    ) {\r\n        if (atom instanceof SizedDelimAtom) {\r\n            for (const d in RIGHT_DELIM) {\r\n                if (atom.value === RIGHT_DELIM[d]) {\r\n                    // This is (most likely) a closing delim, exit.\r\n                    // There are ambiguous cases, for example |x|y|z|.\r\n                    expr.index += 1;\r\n                    return expr;\r\n                }\r\n            }\r\n        }\r\n        if ((atom.type === 'mord' || atom.type === 'mop') && isOperator(atom)) {\r\n            // It's actually an operator\r\n            return expr;\r\n        }\r\n        const lhs = expr.ast;\r\n        expr.ast = {};\r\n        expr = parsePrimary(expr, options);\r\n        if (expr?.ast && lhs) {\r\n            if (\r\n                (isFunction(lhs.fn) && typeof lhs.arg === 'undefined') ||\r\n                (isArray(lhs.arg) && lhs.arg.length === 0)\r\n            ) {\r\n                // A function with no arguments followed by a list ->\r\n                // the list becomes the argument to the function\r\n                if (expr.ast.fn === 'list2' || expr.ast.fn === 'list') {\r\n                    expr.ast = wrapFn(lhs.fn, expr.ast.arg);\r\n                } else {\r\n                    // A function \"f(x)\" or \"x\" followed by something else:\r\n                    // implicit multiply\r\n                    expr.ast = wrapFn('multiply', lhs, expr.ast);\r\n                }\r\n            } else {\r\n                // Invisible times, e.g. '2x'\r\n                if (expr.ast.fn === 'multiply') {\r\n                    expr.ast.arg.unshift(lhs);\r\n                } else if (\r\n                    numberIm(lhs) === 0 &&\r\n                    numberRe(lhs) !== 0 &&\r\n                    numberIm(expr.ast) === 1 &&\r\n                    numberRe(expr.ast) === 0\r\n                ) {\r\n                    // Imaginary number, i.e. \"3i\"\r\n                    expr.ast = wrapNum({ im: numberRe(lhs).toString() });\r\n                } else {\r\n                    expr.ast = wrapFn('multiply', lhs, expr.ast);\r\n                }\r\n            }\r\n        } else {\r\n            expr.ast = lhs;\r\n        }\r\n    }\r\n\r\n    return expr;\r\n}\r\n\r\n/**\r\n * Given an atom or an array of atoms, return their AST representation as\r\n * an object.\r\n * @param {object} expr An expressions, including expr.atoms, expr.index,\r\n * expr.minPrec the minimum precedence that this parser should parse\r\n * before returning; expr.ast, the resulting AST.\r\n * @return {object} the expr object, updated\r\n * @private\r\n */\r\nfunction parseExpression(expr: ParseState, options: MathJsonLatexOptions) {\r\n    expr.index = expr.index || 0;\r\n    expr.ast = undefined;\r\n    if (expr.atoms.length === 0 || expr.index >= expr.atoms.length) return expr;\r\n    expr.minPrec = expr.minPrec || 0;\r\n\r\n    let lhs = parsePrimary(expr, options).ast;\r\n\r\n    let done = false;\r\n    const minPrec = expr.minPrec;\r\n    while (!done) {\r\n        const atom = expr.atoms[expr.index];\r\n        const digraph = parseDigraph(expr);\r\n        done = !atom || atom.mode === 'text' || (!digraph && !isOperator(atom));\r\n        let prec, assoc;\r\n        if (!done) {\r\n            [prec, assoc] = digraph\r\n                ? [getPrecedence(digraph), getAssociativity(digraph)]\r\n                : opPrec(atom);\r\n            done = prec < minPrec;\r\n        }\r\n        if (!done) {\r\n            const opName = digraph || getCanonicalName(getString(atom));\r\n            if (assoc === 'left') {\r\n                expr.minPrec = prec + 1;\r\n            } else {\r\n                expr.minPrec = prec;\r\n            }\r\n            expr.index += 1;\r\n            if (opName === '|') {\r\n                if (\r\n                    typeof atom.subscript !== 'undefined' ||\r\n                    (expr.atoms[expr.index] &&\r\n                        typeof expr.atoms[expr.index].subscript !==\r\n                            'undefined' &&\r\n                        expr.atoms[expr.index].type === 'msubsup')\r\n                ) {\r\n                    // Bind is a special function. It doesn't have a rhs, and\r\n                    // its argument is a subscript.\r\n                    expr.ast = {};\r\n                    const subArg = parseSupsub(expr, options).ast.sub;\r\n                    lhs = wrapFn('bind', lhs);\r\n                    if (subArg && subArg.fn === 'equal' && lhs.arg) {\r\n                        // This is a subscript of the form \"x=...\"\r\n                        lhs.arg.push(getArg(subArg, 0));\r\n                        lhs.arg.push(getArg(subArg, 1));\r\n                    } else if (\r\n                        subArg &&\r\n                        lhs.arg &&\r\n                        (subArg.fn === 'list' || subArg.fn === 'list2')\r\n                    ) {\r\n                        // Form: \"x=0;n=3;z=5\"\r\n                        let currentSym = { sym: 'x' };\r\n                        for (let i = 0; i < subArg.arg.length; i++) {\r\n                            if (subArg.arg[i].fn === 'equal') {\r\n                                currentSym = getArg(subArg.arg[i], 0);\r\n                                lhs.arg.push(currentSym);\r\n                                lhs.arg.push(getArg(subArg.arg[i], 1));\r\n                            } else {\r\n                                lhs.arg.push(currentSym);\r\n                                lhs.arg.push(subArg.arg[i]);\r\n                            }\r\n                        }\r\n                    } else if (subArg) {\r\n                        // Default identifier if none provided\r\n                        lhs.arg.push({ sym: 'x' });\r\n                        lhs.arg.push(subArg);\r\n                    }\r\n                } else {\r\n                    // That was a \"|\", but not with a subscript after, so\r\n                    // it's the end of the expression, might be a right fence.\r\n                    done = true;\r\n                }\r\n            } else {\r\n                const rhs = parseExpression(expr, options).ast;\r\n\r\n                // Some operators (',' and ';' for example) convert into a function\r\n                // even if there's only two arguments. They're super associative...\r\n                let fn = SUPER_ASSOCIATIVE_FUNCTION[opName];\r\n                if (fn && lhs && lhs.fn !== fn) {\r\n                    // Only promote them if the lhs is not already the same function.\r\n                    // If it is, we'll combine it below.\r\n                    lhs = wrapFn(fn, lhs);\r\n                }\r\n\r\n                // Promote subtraction to an addition\r\n                if (opName === '-') {\r\n                    if (lhs?.arg && lhs.fn === 'add') {\r\n                        // add(x,y) - z -> add(x, y, -z)\r\n                        if (rhs !== undefined) lhs.arg.push(negate(rhs));\r\n                    } else if (lhs && lhs.fn === 'subtract') {\r\n                        // x-y - z      -> add(x, -y, -z)\r\n                        lhs = wrapFn(\r\n                            'add',\r\n                            getArg(lhs, 0),\r\n                            negate(getArg(lhs, 1)),\r\n                            negate(rhs)\r\n                        );\r\n                    } else if (\r\n                        isNumber(lhs) &&\r\n                        !hasSup(lhs) &&\r\n                        isNumber(rhs) &&\r\n                        !hasSup(rhs) &&\r\n                        (typeof rhs.num.re === 'undefined' ||\r\n                            rhs.num.re === '0') &&\r\n                        typeof rhs.num.im !== 'undefined'\r\n                    ) {\r\n                        lhs = {\r\n                            num: {\r\n                                re: lhs.num,\r\n                                im: (-parseFloat(rhs.num.im)).toString(),\r\n                            },\r\n                        };\r\n                    } else {\r\n                        lhs = wrapFn('subtract', lhs, rhs);\r\n                    }\r\n                } else {\r\n                    // Is there a function (e.g. 'add') implementing the\r\n                    // associative version of this operator (e.g. '+')?\r\n                    fn = ASSOCIATIVE_FUNCTION[opName];\r\n                    if (fn === 'add' && lhs && lhs.fn === 'subtract') {\r\n                        // subtract(x, y) + z -> add(x, -y, z)\r\n                        lhs = wrapFn(\r\n                            'add',\r\n                            getArg(lhs, 0),\r\n                            negate(getArg(lhs, 1)),\r\n                            rhs\r\n                        );\r\n                    } else if (fn && lhs && lhs.fn === fn && !hasSup(lhs)) {\r\n                        // add(x,y) + z -> add(x, y, z)\r\n                        if (typeof rhs !== 'undefined') {\r\n                            if (rhs.fn === fn && !hasSup(rhs) && rhs.arg) {\r\n                                // add(x, y) = add (a, b)\r\n                                lhs.arg = [...lhs.arg, ...rhs.arg];\r\n                            } else if (lhs.arg) {\r\n                                lhs.arg.push(rhs);\r\n                            }\r\n                        }\r\n                    } else if (fn && rhs && rhs.arg && rhs.fn === fn) {\r\n                        // x =    y = z -> equal(x, y, z)\r\n                        rhs.arg.unshift(lhs);\r\n                        lhs = rhs;\r\n                    } else if (\r\n                        fn === 'multiply' &&\r\n                        isNumber(lhs) &&\r\n                        !hasSup(lhs) &&\r\n                        rhs &&\r\n                        asMachineNumber(rhs) === 10 &&\r\n                        isNumber(rhs.sup)\r\n                    ) {\r\n                        // n * 10^m\r\n                        lhs = wrapNum(\r\n                            asMachineNumber(lhs) *\r\n                                Math.pow(10, asMachineNumber(rhs.sup))\r\n                        );\r\n                    } else if (\r\n                        fn === 'add' &&\r\n                        isNumber(lhs) &&\r\n                        !hasSup(lhs) &&\r\n                        rhs &&\r\n                        numberIm(rhs) !== 0 &&\r\n                        !hasSup(rhs)\r\n                    ) {\r\n                        lhs = {\r\n                            num: {\r\n                                re: lhs.num,\r\n                                im: rhs.num.im,\r\n                            },\r\n                        };\r\n                    } else {\r\n                        lhs = wrapFn(fn || OP_NAME[opName] || opName, lhs, rhs);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    expr.ast = lhs;\r\n    return expr;\r\n}\r\n\r\n/**\r\n * Return a string escaped as necessary to comply with the JSON format\r\n * @param {string} s\r\n * @return {string}\r\n * @private\r\n */\r\nfunction escapeText(s) {\r\n    return s\r\n        .replace(/[\\\\]/g, '\\\\\\\\')\r\n        .replace(/[\"]/g, '\\\\\"')\r\n        .replace(/[\\b]/g, '\\\\b')\r\n        .replace(/[\\f]/g, '\\\\f')\r\n        .replace(/[\\n]/g, '\\\\n')\r\n        .replace(/[\\r]/g, '\\\\r')\r\n        .replace(/[\\t]/g, '\\\\t');\r\n}\r\n\r\n/**\r\n * Return an AST representation of a single atom\r\n *\r\n */\r\nexport function atomToMathJson(\r\n    atom: Atom,\r\n    options: {\r\n        precision?: number;\r\n        decimalMarker?: string;\r\n        groupSeparator?: string;\r\n        product?: string;\r\n        exponentProduct?: string;\r\n        exponentMarker?: string;\r\n        arcSeparator?: string;\r\n        scientificNotation?: 'auto' | 'engineering' | 'on';\r\n        beginRepeatingDigits?: string;\r\n        endRepeatingDigits?: string;\r\n        macros?: any;\r\n    }\r\n): MathJson {\r\n    const MATH_VARIANTS = {\r\n        'double-struck': 'double-struck',\r\n        calligraphic: 'script',\r\n        script: 'script',\r\n        fraktur: 'fraktur',\r\n        'sans-serif': 'sans-serif',\r\n        monospace: 'monospace',\r\n    };\r\n    // TODO: See https://www.w3.org/TR/MathML2/chapter6.html#chars.letter-like-tables\r\n\r\n    let result: MathJsonExpression = {};\r\n    let sym = '';\r\n    let m;\r\n    let lhs, rhs;\r\n    const style = atom.computedStyle;\r\n    let variant =\r\n        MATH_VARIANTS[\r\n            style.variant +\r\n                (!style.variantStyle || style.variantStyle === 'up'\r\n                    ? ''\r\n                    : '-' + style.variantStyle)\r\n        ];\r\n    let variantSym;\r\n\r\n    let styleString = '';\r\n    if (style.fontSeries === 'b') styleString += 'bold';\r\n    if (style.fontShape === 'it') styleString += 'italic';\r\n\r\n    const command = atom.command;\r\n    switch (atom.type) {\r\n        case 'root':\r\n        case 'group':\r\n            // Macros appear as group as well. Handle some of them.\r\n            if (command?.startsWith('\\\\nicefrac')) {\r\n                m = command.slice(9).match(/({.*}|[^}])({.*}|[^}])/);\r\n                if (m) {\r\n                    if (m[1].length === 1) {\r\n                        lhs = m[1];\r\n                    } else {\r\n                        lhs = m[1].substr(1, m[1].length - 2);\r\n                    }\r\n                    lhs = parseString(lhs, 'math', null, options.macros);\r\n\r\n                    if (m[2].length === 1) {\r\n                        rhs = m[2];\r\n                    } else {\r\n                        rhs = m[2].substr(1, m[2].length - 2);\r\n                    }\r\n                    rhs = parseString(rhs, 'math', null, options.macros);\r\n\r\n                    result = wrapFn(\r\n                        'divide',\r\n                        parse(lhs, options),\r\n                        parse(rhs, options)\r\n                    );\r\n                } else {\r\n                    result = { fn: 'divide' };\r\n                }\r\n            } else {\r\n                result = { group: parse(atom.branch('body'), options) };\r\n            }\r\n            break;\r\n\r\n        case 'genfrac':\r\n            // If there's no denominator, or a placeholder, use \"1\" as the value\r\n            result = wrapFn(\r\n                'divide',\r\n                parse(atom.above, options),\r\n                atom.below?.[0]?.type === 'placeholder'\r\n                    ? wrapNum(1)\r\n                    : parse(atom.below, options)\r\n            );\r\n            break;\r\n\r\n        case 'surd':\r\n            if (!atom.hasEmptyBranch('above')) {\r\n                result = wrapFn(\r\n                    'pow',\r\n                    parse(atom.body, options),\r\n                    wrapFn('divide', wrapNum(1), parse(atom.above, options))\r\n                );\r\n            } else {\r\n                result = wrapFn('sqrt', parse(atom.body, options));\r\n            }\r\n            break;\r\n\r\n        case 'rule':\r\n            break;\r\n\r\n        // case 'line':\r\n        case 'overlap':\r\n            // case 'accent':\r\n            break;\r\n\r\n        case 'overunder':\r\n            break;\r\n\r\n        case 'mord':\r\n        case 'textord':\r\n        case 'mbin':\r\n            // Check to see if it's a \\char command\r\n            m = !command\r\n                ? undefined\r\n                : command.match(/[{]?\\\\char\"([0-9abcdefABCDEF]*)[}]?/);\r\n            if (m) {\r\n                sym = String.fromCodePoint(parseInt(m[1], 16));\r\n            } else {\r\n                sym = getCanonicalName(getString(atom));\r\n                if (sym.length > 0 && sym.charAt(0) === '\\\\') {\r\n                    // This is an identifier with no special handling.\r\n                    // Use the Unicode value if outside ASCII range\r\n                    if (typeof atom.value === 'string') {\r\n                        // TODO: consider making this an option?\r\n                        // if (atom.branch('body').charCodeAt(0) > 255) {\r\n                        //     sym = '&#x' + ('000000' +\r\n                        //         atom.branch('body').charCodeAt(0).toString(16)).substr(-4) + ';';\r\n                        // } else {\r\n                        sym = atom.value;\r\n                        // }\r\n                    }\r\n                }\r\n            }\r\n            variantSym = escapeText(\r\n                mathVariantToUnicode(sym, variant, styleString)\r\n            );\r\n            if (variantSym !== sym) {\r\n                // If there's a specific Unicode character matching this one\r\n                // no need to record a variant.\r\n                result = { sym: variantSym };\r\n                variant = 'normal';\r\n            } else {\r\n                result = { sym: sym };\r\n            }\r\n            break;\r\n\r\n        // case 'mpunct':\r\n        //     result = '<mo separator=\"true\">' + command + '</mo>';\r\n        //     break;\r\n\r\n        case 'minner':\r\n            break;\r\n\r\n        case 'mop':\r\n            break;\r\n\r\n        case 'box':\r\n            result = parse(atom.branch('body'), options);\r\n            break;\r\n\r\n        case 'enclose':\r\n            // result = '<menclose notation=\"';\r\n            // for (const notation in atom.notation) {\r\n            //     if (Object.prototype.hasOwnProperty.call(atom.notation, notation) &&\r\n            //         atom.notation[notation]) {\r\n            //         result += sep + notation;\r\n            //         sep = ' ';\r\n            //     }\r\n            // }\r\n            // result += '\">' + toAST(atom.branch('body')).mathML + '</menclose>';\r\n            break;\r\n\r\n        case 'array':\r\n            if (atom instanceof ArrayAtom) {\r\n                if (atom.environmentName === 'cardinality') {\r\n                    // @revisit... It's an environment, but not an array...?\r\n                    result = wrapFn(\r\n                        'card',\r\n                        parse((atom.array as unknown) as Atom[], options)\r\n                    );\r\n                } else if (\r\n                    /array|matrix|pmatrix|bmatrix/.test(atom.environmentName)\r\n                ) {\r\n                    result = { fn: 'array', args: [] };\r\n                    for (const row of atom.array) {\r\n                        result.args.push(\r\n                            row.map((cell) => parse(cell, options))\r\n                        );\r\n                    }\r\n                } else if (atom.environmentName === 'cases') {\r\n                    result = { fn: 'cases', args: [] };\r\n                    for (const row of atom.array) {\r\n                        if (row[0]) {\r\n                            const statement = [];\r\n                            statement.push(parse(row[0], options));\r\n                            let condition = parse(row[1], options);\r\n                            if (condition) {\r\n                                if (condition.fn === 'text' && condition.arg) {\r\n                                    if (\r\n                                        /^(if|when|for)$/i.test(\r\n                                            condition.arg[0].trim()\r\n                                        )\r\n                                    ) {\r\n                                        condition = condition.arg.filter(\r\n                                            (x) => typeof x !== 'string'\r\n                                        );\r\n                                    }\r\n                                }\r\n                            }\r\n\r\n                            statement.push(condition ?? {});\r\n                            result.args.push(statement);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            break;\r\n\r\n        case 'spacing':\r\n        case 'space':\r\n            break;\r\n        default:\r\n            result = undefined;\r\n            console.warn(\r\n                'Unhandled atom \"' +\r\n                    atom.type +\r\n                    '\" in \"' +\r\n                    (atom.command ?? atom.branch('body')) +\r\n                    '\"'\r\n            );\r\n    }\r\n\r\n    if (result && variant && variant !== 'normal') {\r\n        result.variant = variant;\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nfunction filterPresentationAtoms(\r\n    atoms: Atom | Atom[] | Atom[][] | Atom[][][]\r\n): Atom[] {\r\n    if (!atoms) return [];\r\n    let result;\r\n    if (isArray(atoms)) {\r\n        result = [];\r\n        for (const atom of atoms) {\r\n            const filter = filterPresentationAtoms(atom);\r\n            result = result.concat(filter);\r\n        }\r\n    } else {\r\n        if (atoms.type === 'spacing' || atoms.type === 'first') {\r\n            return [];\r\n        } else if (atoms.type === 'box') {\r\n            result = filterPresentationAtoms(atoms.branch('body'));\r\n        } else {\r\n            if (!atoms.hasEmptyBranch('body')) {\r\n                atoms.setChildren(\r\n                    filterPresentationAtoms(atoms.branch('body')),\r\n                    'body'\r\n                );\r\n            }\r\n            if (!atoms.hasEmptyBranch('superscript')) {\r\n                atoms.setChildren(\r\n                    filterPresentationAtoms(atoms.branch('superscript')),\r\n                    'superscript'\r\n                );\r\n            }\r\n            if (!atoms.hasEmptyBranch('subscript')) {\r\n                atoms.setChildren(\r\n                    filterPresentationAtoms(atoms.branch('subscript')),\r\n                    'subscript'\r\n                );\r\n            }\r\n            if (atoms instanceof ArrayAtom) {\r\n                atoms.array = atoms.array.map((row) =>\r\n                    row.map((cell) => filterPresentationAtoms(cell))\r\n                );\r\n            }\r\n            result = [atoms];\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\n/**\r\n * Parse a sequence of text zone and math zones:\r\n * <sentence> := ((<text>) <expression>)+\r\n */\r\nfunction parseSentence(\r\n    expr: ParseState,\r\n    options?: MathJsonLatexOptions\r\n): MathJson {\r\n    expr.index = expr.index || 0;\r\n    expr.ast = undefined;\r\n\r\n    const zones = [];\r\n    // Iterate while we have atoms to look at\r\n    while (expr.atoms[expr.index]) {\r\n        if (expr.atoms[expr.index].mode === 'text') {\r\n            // Text mode atom...\r\n            let text = '';\r\n            while (\r\n                expr.atoms[expr.index] &&\r\n                expr.atoms[expr.index].mode === 'text'\r\n            ) {\r\n                text += expr.atoms[expr.index].value;\r\n                expr.index += 1;\r\n            }\r\n            zones.push(wrapFn('text', text));\r\n        } else {\r\n            const z = parseExpression(expr, options).ast;\r\n            // Something went wrong in parsing the expression...\r\n            if (!z) return undefined;\r\n            zones.push(z);\r\n        }\r\n    }\r\n\r\n    if (zones.length > 1) {\r\n        return wrapFn('sequence', ...zones);\r\n    }\r\n\r\n    return zones[0] || undefined;\r\n}\r\n\r\nfunction parse(atoms: Atom | Atom[], options?: MathJsonLatexOptions): MathJson {\r\n    return parseSentence({ atoms: filterPresentationAtoms(atoms) }, options);\r\n}\r\n\r\nexport function atomtoMathJson(\r\n    atoms: Atom | Atom[],\r\n    options?: MathJsonLatexOptions\r\n): MathJson {\r\n    return parse(atoms, options);\r\n}\r\n\r\n/**\r\n *\r\n * @param {string} fence - The fence to wrap around the arguments\r\n * @return {string} - A string wrapped in the fence\r\n */\r\nfunction wrapFence(fence: string, ...args): string {\r\n    fence = fence || '.. ';\r\n    let result = '';\r\n    if (args.length > 0) {\r\n        if (fence[0] !== '.') result += fence[0];\r\n        let sep = '';\r\n        for (const arg of args) {\r\n            result += sep + arg;\r\n            sep = fence[2];\r\n        }\r\n        if (fence[1] !== '.') result += fence[1];\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n/**\r\n * Return a formatted mantissa:\r\n * 1234567 -> 123 456 7...\r\n * 1233333 -> 12(3)\r\n * @param {string} m\r\n * @param {Object.<string, any>} config\r\n * @private\r\n */\r\nfunction formatMantissa(m, config) {\r\n    const originalLength = m.length;\r\n    // The last digit may have been rounded, if it exceeds the precison,\r\n    // which could throw off the\r\n    // repeating pattern detection. Ignore   it.\r\n    m = m.substr(0, config.precision - 2);\r\n\r\n    for (let i = 0; i < m.length - 16; i++) {\r\n        // Offset is the part of the mantissa that is not repeating\r\n        const offset = m.substr(0, i);\r\n        // Try to find a repeating pattern of length j\r\n        for (let j = 0; j < 17; j++) {\r\n            const cycle = m.substr(i, j + 1);\r\n            const times = Math.floor((m.length - offset.length) / cycle.length);\r\n            if (times > 1) {\r\n                if ((offset + cycle.repeat(times + 1)).startsWith(m)) {\r\n                    // We've found a repeating pattern!\r\n                    if (cycle === '0') {\r\n                        return offset.replace(\r\n                            /(\\d{3})/g,\r\n                            '$1' + config.groupSeparator\r\n                        );\r\n                    }\r\n                    return (\r\n                        offset.replace(\r\n                            /(\\d{3})/g,\r\n                            '$1' + config.groupSeparator\r\n                        ) +\r\n                        config.beginRepeatingDigits +\r\n                        cycle.replace(\r\n                            /(\\d{3})/g,\r\n                            '$1' + config.groupSeparator\r\n                        ) +\r\n                        config.endRepeatingDigits\r\n                    );\r\n                }\r\n            }\r\n        }\r\n    }\r\n    if (originalLength !== m.length) {\r\n        m += '\\\\ldots';\r\n    }\r\n    return m.replace(/(\\d{3})/g, '$1' + config.groupSeparator);\r\n}\r\n\r\nfunction parseFloatToPrecision(num) {\r\n    return parseFloat(parseFloat(num).toPrecision(15));\r\n}\r\n\r\n/**\r\n *\r\n * @param num - A number, represented as a string (e.g. \"-12.45\"\r\n *  particularly useful for arbitrary precision numbers) or a number (-12.45)\r\n * @return A LaTeX representation of the AST\r\n */\r\nfunction numberAsLatex(\r\n    num: string | number,\r\n    config: Required<MathJsonLatexOptions>\r\n): string {\r\n    let result = '';\r\n    let value: number;\r\n\r\n    if (typeof config.precision === 'number') {\r\n        if (typeof num === 'number') {\r\n            value = parseFloatToPrecision(num);\r\n        } else {\r\n            let sign = '';\r\n            let exponent = '';\r\n            if (num[0] === '-') {\r\n                sign = '-';\r\n                num = num.substr(1);\r\n            } else if (num[0] === '+') {\r\n                num = num.substr(1);\r\n            }\r\n            if (num.indexOf('.') >= 0) {\r\n                const m = num.match(/(\\d*).(\\d*)([e|E]([-+]?[0-9]*))?/);\r\n                const base = m[1];\r\n                const mantissa = m[2].substring(\r\n                    0,\r\n                    Math.min(config.precision - base.length, m[2].length)\r\n                );\r\n                exponent = m[4] || '';\r\n\r\n                if (base === '0') {\r\n                    let p = 0; // Index of the first non-zero digit after the decimal\r\n                    while (mantissa[p] === '0' && p < mantissa.length) {\r\n                        p += 1;\r\n                    }\r\n                    let r = '';\r\n                    if (p <= 4) {\r\n                        r = '0' + config.decimalMarker;\r\n                        r += mantissa.substr(0, p);\r\n                        r += formatMantissa(num.substr(r.length), config);\r\n                    } else if (p + 1 >= config.precision) {\r\n                        r = '0';\r\n                        sign = '';\r\n                    } else {\r\n                        r = num[p];\r\n                        const f = formatMantissa(num.substr(p + 1), config);\r\n                        if (f) {\r\n                            r += config.decimalMarker + f;\r\n                        }\r\n                    }\r\n                    if (r !== '0') {\r\n                        if (\r\n                            num.length - 1 > config.precision &&\r\n                            !r.endsWith('}') &&\r\n                            !r.endsWith('\\\\ldots')\r\n                        ) {\r\n                            r += '\\\\ldots';\r\n                        }\r\n                        if (p > 4) {\r\n                            r += config.exponentProduct;\r\n                            if (config.exponentMarker) {\r\n                                r += config.exponentMarker + (1 - p).toString();\r\n                            } else {\r\n                                r += '10^{' + (1 - p).toString() + '}';\r\n                            }\r\n                        }\r\n                    }\r\n                    num = r;\r\n                } else {\r\n                    num = base.replace(\r\n                        /\\B(?=(\\d{3})+(?!\\d))/g,\r\n                        config.groupSeparator\r\n                    );\r\n                    const f = formatMantissa(mantissa, config);\r\n                    if (f) {\r\n                        num += config.decimalMarker + f;\r\n                        // if (num.length - 1 > config.precision && !num.endsWith('}') && !num.endsWith('\\\\ldots')) {\r\n                        //     num += '\\\\ldots';\r\n                        // }\r\n                    }\r\n                }\r\n            } else if (num.length > config.precision) {\r\n                const len = num.length;\r\n                let r = num[0];\r\n                const f = formatMantissa(num.substr(2), config);\r\n                if (f) {\r\n                    r += config.decimalMarker + f;\r\n                    if (r[r.length - 1] !== '}') {\r\n                        r += '\\\\ldots';\r\n                    }\r\n                }\r\n                if (r !== '1') {\r\n                    r += config.exponentProduct;\r\n                } else {\r\n                    r = '';\r\n                }\r\n                if (config.exponentMarker) {\r\n                    r += config.exponentMarker + (len - 2).toString();\r\n                } else {\r\n                    r += '10^{' + (len - 2).toString() + '}';\r\n                }\r\n                num = r;\r\n            } else {\r\n                num = num.replace(\r\n                    /\\B(?=(\\d{3})+(?!\\d))/g,\r\n                    config.groupSeparator\r\n                );\r\n            }\r\n\r\n            if (exponent) {\r\n                // There is an exponent...\r\n                if (config.exponentMarker) {\r\n                    exponent = config.exponentMarker + exponent;\r\n                } else {\r\n                    exponent =\r\n                        config.exponentProduct + ' 10^{' + exponent + '}';\r\n                }\r\n            }\r\n\r\n            return sign + num + exponent;\r\n        }\r\n    }\r\n    if (config.scientificNotation === 'engineering') {\r\n        // Ensure the exponent is a multiple of 3\r\n        if (value === 0) {\r\n            result = '0';\r\n        } else {\r\n            const y = Math.abs(value);\r\n            let exponent: number = Math.round(Math.log10(y));\r\n            exponent = exponent - (exponent % 3);\r\n            if (y < 1000) exponent = 0;\r\n            const mantissa = y / Math.pow(10, exponent);\r\n            let mantissaString = '';\r\n            const m = mantissa.toString().match(/^(.*)\\.(.*)$/);\r\n            if (m?.[1] && m[2]) {\r\n                mantissaString = m[1] + config.decimalMarker + m[2];\r\n            }\r\n            if (config.groupSeparator) {\r\n                mantissaString = formatMantissa(\r\n                    mantissa.toExponential(),\r\n                    config\r\n                );\r\n            }\r\n            let exponentString = '';\r\n            if (exponent === 0) {\r\n                exponentString = '';\r\n            } else if (config.exponentMarker) {\r\n                exponentString = config.exponentMarker + exponent;\r\n            } else {\r\n                exponentString =\r\n                    config.exponentProduct + ' 10^{' + exponent + '}';\r\n            }\r\n            result = (value < 0 ? '-' : '') + mantissaString + exponentString;\r\n        }\r\n    } else {\r\n        const valString = typeof num === 'string' ? num : num.toString();\r\n        let m = valString.match(/^(.*)[e|E]([-+]?[0-9]*)$/i);\r\n        let base, exponent, mantissa;\r\n        base = valString;\r\n        mantissa = '';\r\n        if (m?.[1] && m[2]) {\r\n            // There is an exponent...\r\n            base = m[1];\r\n            if (config.exponentMarker) {\r\n                exponent = config.exponentMarker + m[2];\r\n            } else {\r\n                exponent = config.exponentProduct + ' 10^{' + m[2] + '}';\r\n            }\r\n        }\r\n        m = base.match(/^(.*)\\.(.*)$/);\r\n        if (m?.[1] && m[2]) {\r\n            base = m[1];\r\n            mantissa = m[2];\r\n        }\r\n        if (config.groupSeparator) {\r\n            base = base.replace(/\\B(?=(\\d{3})+(?!\\d))/g, config.groupSeparator);\r\n            mantissa = formatMantissa(mantissa, config);\r\n        }\r\n        if (mantissa) mantissa = config.decimalMarker + mantissa;\r\n        result = base + mantissa + (exponent || '');\r\n    }\r\n    return result;\r\n}\r\n\r\n/**\r\n *\r\n * @param {object} ast - Abstract Syntax Tree object (in canonical form)\r\n * @return {string} A LaTeX representation of the AST\r\n */\r\nexport function jsonToLatex(\r\n    ast: MathJson,\r\n    options?: MathJsonLatexOptions\r\n): string {\r\n    const config = Object.assign(\r\n        {\r\n            precision: 14,\r\n            decimalMarker: '.',\r\n            groupSeparator: '\\\\, ',\r\n            product: '\\\\cdot ', // \\\\times, \\\\,\r\n            exponentProduct: '\\\\cdot ',\r\n            exponentMarker: '',\r\n            arcSeparator: '\\\\,',\r\n            scientificNotation: 'auto', // 'engineering', 'auto', 'on'\r\n            beginRepeatingDigits: '\\\\overline{',\r\n            endRepeatingDigits: '}',\r\n        },\r\n        options\r\n    );\r\n\r\n    let result = '';\r\n\r\n    if (ast === undefined) return '';\r\n    if (typeof ast === 'string') {\r\n        result = ast;\r\n    } else if (ast.latex) {\r\n        // If ast.latex key is present, use it to render the element\r\n        result = ast.latex;\r\n    } else if (isNumber(ast)) {\r\n        const val = asMachineNumber(ast);\r\n        if (val === -Infinity) {\r\n            result = '-\\\\infty ';\r\n        } else if (val === Infinity) {\r\n            result = '\\\\infty ';\r\n        } else if (\r\n            typeof ast.num === 'object' &&\r\n            (typeof ast.num.re === 'string' || typeof ast.num.im === 'string')\r\n        ) {\r\n            const re = numberRe(ast);\r\n            const im = numberIm(ast);\r\n            if (isNaN(re) || isNaN(im)) {\r\n                result = '\\\\text{NaN}';\r\n            } else if (\r\n                Math.abs(im) <= Number.EPSILON &&\r\n                Math.abs(re) <= Number.EPSILON\r\n            ) {\r\n                result = '0';\r\n            } else {\r\n                if (Math.abs(re) > Number.EPSILON) {\r\n                    result = numberAsLatex(re, config);\r\n                }\r\n                if (Math.abs(im) > Number.EPSILON) {\r\n                    if (Math.abs(re) > Number.EPSILON) {\r\n                        result += im > 0 ? '+' : '';\r\n                    }\r\n                    result +=\r\n                        (Math.abs(im) !== 1 ? numberAsLatex(im, config) : '') +\r\n                        '\\\\imaginaryI ';\r\n                }\r\n            }\r\n        } else if (isNaN(val)) {\r\n            result = '\\\\text{NaN}';\r\n        } else {\r\n            result = numberAsLatex(ast.num, config);\r\n        }\r\n        if (hasSup(ast)) result += '^{' + jsonToLatex(ast.sup, config) + '}';\r\n        if (hasSub(ast)) result += '_{' + jsonToLatex(ast.sub, config) + '}';\r\n    } else if (ast.group) {\r\n        result = jsonToLatex(ast.group, config);\r\n        if (!isNumber(ast.group) && !asSymbol(ast.group)) {\r\n            result = wrapFence(ast.fence || '(),', result);\r\n        } else if (numberIm(ast.group) !== 0) {\r\n            result = wrapFence(ast.fence || '(),', result);\r\n        }\r\n        if (hasSup(ast)) result += '^{' + jsonToLatex(ast.sup, config) + '}';\r\n        if (hasSub(ast)) result += '_{' + jsonToLatex(ast.sub, config) + '}';\r\n    } else if (ast.fn) {\r\n        if (ast.fn === 'bind') {\r\n            result = jsonToLatex(getArg(ast, 0), config) + '|_{';\r\n            if (ast.arg && ast.arg.length === 2) {\r\n                result += jsonToLatex(getArg(ast, 1));\r\n            } else {\r\n                let sep = '';\r\n                for (let i = 1; i < ast.arg.length; i += 2) {\r\n                    result +=\r\n                        sep +\r\n                        jsonToLatex(getArg(ast, i)) +\r\n                        ' = ' +\r\n                        jsonToLatex(getArg(ast, i + 1));\r\n                    sep = ', ';\r\n                }\r\n            }\r\n            result += '}';\r\n        } else if (ast.fn === 'divide') {\r\n            result =\r\n                '\\\\frac{' +\r\n                jsonToLatex(getArg(ast, 0), config) +\r\n                '}{' +\r\n                jsonToLatex(getArg(ast, 1), config) +\r\n                '}';\r\n        } else if (ast.fn === 'negate') {\r\n            result = '-' + jsonToLatex(getArg(ast, 0), config);\r\n        } else if (ast.fn === 'subtract') {\r\n            result =\r\n                jsonToLatex(getArg(ast, 0), config) +\r\n                ' - ' +\r\n                jsonToLatex(getArg(ast, 1), config);\r\n        } else if (\r\n            (ast.fn === 'add' || ast.fn === 'multiply') &&\r\n            isArray(ast.arg)\r\n        ) {\r\n            const a = [];\r\n            for (const exp of ast.arg) {\r\n                if (exp.fn === 'add' || exp.fn === 'subtract') {\r\n                    a.push(wrapFence('() ', jsonToLatex(exp, config)));\r\n                } else if (isComplexWithRealAndImaginary(exp)) {\r\n                    // Complex numbers that have both a real and imaginary part\r\n                    // should be wrapped in parentheses\r\n                    a.push(wrapFence('() ', jsonToLatex(exp, config)));\r\n                } else if (\r\n                    hasSup(ast) &&\r\n                    !(numberIm(exp) === 0 || numberIm(exp) === 1)\r\n                ) {\r\n                    // Wrap with parentheses if there's an exponent\r\n                    // and the imaginary part is neither 0 nor 1\r\n                    a.push(wrapFence('() ', jsonToLatex(exp, config)));\r\n                } else {\r\n                    a.push(jsonToLatex(exp, config));\r\n                }\r\n            }\r\n            if (ast.fn === 'multiply') {\r\n                if (\r\n                    ast.arg &&\r\n                    ast.arg.length === 2 &&\r\n                    (isNumber(ast.arg[0]) || ast.arg[0].fn === 'divide') &&\r\n                    (!isNumber(ast.arg[1]) ||\r\n                        (numberRe(ast.arg[1]) === 0 &&\r\n                            numberIm(ast.arg[1]) === 1))\r\n                ) {\r\n                    // Invisible times:\r\n                    // (number or fraction) * not a number\r\n                    // or (number or fraction) * imaginary unit\r\n                    result = a[0] + a[1];\r\n                } else {\r\n                    result = a.join(' \\\\times ');\r\n                }\r\n            } else {\r\n                // Addition (and subtraction)\r\n                if (ast.arg && ast.arg.length === 1) {\r\n                    if (\r\n                        ast.arg[0].fn === 'negate' ||\r\n                        (isNumber(ast.arg[0]) &&\r\n                            asMachineNumber(ast.arg[0]) < 0)\r\n                    ) {\r\n                        // a[0] has a negative sign\r\n                        result = a[0];\r\n                    } else {\r\n                        // Single non-negative element, add a '+' in front\r\n                        result = '+' + a[0];\r\n                    }\r\n                } else {\r\n                    result = a[0];\r\n                    for (let i = 1; i < ast.arg.length; i++) {\r\n                        if (\r\n                            ast.arg[i].fn === 'negate' ||\r\n                            (isNumber(ast.arg[i]) &&\r\n                                asMachineNumber(ast.arg[i]) < 0)\r\n                        ) {\r\n                            // a[i] already has a negative sign, so we can do an\r\n                            // implicit add\r\n                            result += a[i];\r\n                        } else {\r\n                            result += ' + ' + a[i];\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        } else if (ast.fn === 'list' || ast.fn === 'list2') {\r\n            const a = [];\r\n            if (ast.arg) {\r\n                for (const exp of ast.arg) {\r\n                    a.push(jsonToLatex(exp, config));\r\n                }\r\n            }\r\n            result = a.join(ast.fn === 'list2' ? '; ' : ', ');\r\n        } else if (ast.fn === 'sequence') {\r\n            result = joinLatex(ast.arg.map((x) => jsonToLatex(x, config)));\r\n        } else if (ast.fn === 'text') {\r\n            result = '\\\\text{' + (ast.arg[0] || '') + '}';\r\n        } else if (\r\n            ast.fn === 'pow' &&\r\n            isArray(ast.arg) &&\r\n            ast.arg.length >= 2\r\n        ) {\r\n            result = jsonToLatex(getArg(ast, 0), config);\r\n            if (!isNumber(getArg(ast, 0)) && !asSymbol(getArg(ast, 0))) {\r\n                result = wrapFence(ast.fence || '(),', result);\r\n            }\r\n\r\n            result += '^{' + jsonToLatex(getArg(ast, 1), config) + '}';\r\n        } else if (ast.fn === 'equal' && ast.arg && ast.arg.length > 2) {\r\n            result = ast.arg.map((x) => jsonToLatex(x, config)).join(' = ');\r\n        } else {\r\n            const fn = getLatexTemplateForFunction(ast.fn);\r\n            result = fn;\r\n            let argstring = '';\r\n            const parenRequired =\r\n                /%(?![01_^])/.test(fn) &&\r\n                isArray(ast.arg) &&\r\n                ast.arg.length > 1;\r\n            if (parenRequired) {\r\n                // Parenthesis are required if argument list is longer than 1\r\n                result += wrapFence(\r\n                    ast.fence || '(),',\r\n                    ...ast.arg.map((x) => jsonToLatex(x, config))\r\n                );\r\n            } else if (isArray(ast.arg) && ast.arg.length > 0) {\r\n                // The parenthesis may be optional...\r\n                const arg0 = jsonToLatex(getArg(ast, 0), config);\r\n                const arg1 = jsonToLatex(getArg(ast, 1), config);\r\n                const argsn = [...ast.arg];\r\n                if (/%0/.test(fn)) {\r\n                    result = result.replace('%0', arg0);\r\n                    argsn.shift();\r\n                }\r\n                if (/%1/.test(fn)) {\r\n                    result = result.replace('%1', arg1);\r\n                    argsn.shift();\r\n                }\r\n\r\n                if (argsn.length > 0) {\r\n                    argstring = wrapFence(\r\n                        ast.fence || '(),',\r\n                        ...argsn.map((x) => jsonToLatex(x, config))\r\n                    );\r\n                }\r\n            } else {\r\n                // Empty argument list\r\n                argstring = wrapFence(ast.fence || '(),', '');\r\n            }\r\n\r\n            if (hasSup(ast)) {\r\n                result = result.replace(\r\n                    '%^',\r\n                    '^{' + jsonToLatex(ast.sup, config) + '}'\r\n                );\r\n            } else {\r\n                result = result.replace('%^', '');\r\n            }\r\n            if (hasSub(ast)) {\r\n                result = result.replace(\r\n                    '%_',\r\n                    '_{' + jsonToLatex(ast.sub, config) + '}'\r\n                );\r\n            } else {\r\n                result = result.replace('%_', '');\r\n            }\r\n\r\n            // Insert the arguments in the function template (%)\r\n            result = result.replace(/%(?![01_^])/, argstring);\r\n            // If there are any placeholders left, remove them\r\n            result = result.replace('%0', '').replace('%1', '');\r\n        }\r\n    } else if (typeof ast.sym === 'string') {\r\n        result = asSymbol(ast);\r\n        // Is it a Unicode value?\r\n        let m = result.match(/^&#x([0-9a-f]+);$/i);\r\n        if (m?.[1]) {\r\n            result = String.fromCodePoint(parseInt(m[1], 16));\r\n        } else {\r\n            m = result.match(/^&#([0-9]+);$/i);\r\n            if (m?.[1]) {\r\n                result = String.fromCodePoint(parseInt(m[1]));\r\n            }\r\n        }\r\n\r\n        // Is there a variant info attached to it?\r\n        if (typeof ast.variant === 'string') {\r\n            const MATH_VARIANTS = {\r\n                normal: 'mathrm',\r\n                'double-struck': 'mathbb',\r\n                bold: 'mathbf',\r\n                // 'script': 'mathcal',\r\n                fraktur: 'mathfrak',\r\n                script: 'mathscr',\r\n                'sans-serif': 'mathsf',\r\n                monospace: 'mathtt',\r\n            };\r\n            result = '\\\\' + MATH_VARIANTS[ast.variant] + '{' + result + '}';\r\n        }\r\n        if (hasSup(ast)) result += '^{' + jsonToLatex(ast.sup, config) + '}';\r\n        if (hasSub(ast)) result += '_{' + jsonToLatex(ast.sub, config) + '}';\r\n    } else if (typeof ast.text === 'string') {\r\n        result = '\\\\text{' + ast.text + '}';\r\n    }\r\n\r\n    // If there was an error attached to this node,\r\n    // display it on a red background\r\n    if (typeof ast.error === 'string') {\r\n        result = '\\\\bbox[#F56165]{' + result + '}';\r\n    }\r\n\r\n    return result;\r\n}\r\n","import { isArray } from '../common/types';\r\nimport { ParseMode } from '../public/core';\r\nimport { Atom } from './atom-class';\r\n\r\n/**\r\n/**\r\n * Return an atom suitable for use as the root of a formula.\r\n */\r\n\r\nexport function makeRoot(parseMode: ParseMode, body: Atom[] = []): Atom {\r\n    const root = new Atom('root', { mode: parseMode });\r\n    // If making a new root, make sure the initial body is not already\r\n    // attached to another root. That spells trouble.\r\n    console.assert(body.every((x) => !x.parent));\r\n    root.body = body;\r\n    return root;\r\n}\r\n\r\nexport function isAtomArray(arg: string | Atom | Atom[]): arg is Atom[] {\r\n    return isArray(arg);\r\n}\r\n","import type { MathfieldOptions } from '../public/options';\r\nimport { Atom } from '../core/atom';\r\nimport { stringToColor } from '../core/color';\r\nconst SPECIAL_OPERATORS = {\r\n    '\\\\pm': '&#177;',\r\n    '\\\\times': '&#215;',\r\n    '\\\\colon': ':',\r\n    '\\\\vert': '|',\r\n    '\\\\Vert': '\\u2225',\r\n    '\\\\mid': '\\u2223',\r\n    '\\\\lbrace': '{',\r\n    '\\\\rbrace': '}',\r\n    '\\\\langle': '\\u27e8',\r\n    '\\\\rangle': '\\u27e9',\r\n    '\\\\lfloor': '\\u230a',\r\n    '\\\\rfloor': '\\u230b',\r\n    '\\\\lceil': '\\u2308',\r\n    '\\\\rceil': '\\u2309',\r\n\r\n    '\\\\vec': '&#x20d7;',\r\n    '\\\\acute': '&#x00b4;',\r\n    '\\\\grave': '&#x0060;',\r\n    '\\\\dot': '&#x02d9;',\r\n    '\\\\ddot': '&#x00a8;',\r\n    '\\\\tilde': '&#x007e;',\r\n    '\\\\bar': '&#x00af;',\r\n    '\\\\breve': '&#x02d8;',\r\n    '\\\\check': '&#x02c7;',\r\n    '\\\\hat': '&#x005e;',\r\n};\r\n\r\nfunction xmlEscape(str: string): string {\r\n    return (\r\n        str\r\n            // .replace(/&/g, '&amp;')\r\n            .replace(/\"/g, '&quot;')\r\n            .replace(/'/g, '&#39;')\r\n            .replace(/</g, '&lt;')\r\n            .replace(/>/g, '&gt;')\r\n    );\r\n}\r\n\r\nfunction makeID(id, options) {\r\n    if (!id || !options.generateID) return '';\r\n    // Note: the 'extid' attribute is recognized by SRE as an attribute\r\n    // to be passed to SSML as a <mark> tag.\r\n    return ' extid=\"' + id + '\"';\r\n}\r\n\r\nfunction scanIdentifier(stream, final, options) {\r\n    let result = false;\r\n    final = final || stream.atoms.length;\r\n    let mathML = '';\r\n    let body = '';\r\n    let superscript = -1;\r\n    let subscript = -1;\r\n    const atom = stream.atoms[stream.index];\r\n\r\n    if (\r\n        stream.index < final &&\r\n        (atom.type === 'mord' || atom.type === 'textord') &&\r\n        '0123456789,.'.indexOf(atom.value) < 0\r\n    ) {\r\n        body = atomToMathML(atom, options);\r\n        if (atom.branches?.superscript) {\r\n            superscript = stream.index;\r\n        }\r\n        if (atom.branches?.subscript) {\r\n            subscript = stream.index;\r\n        }\r\n        stream.index += 1;\r\n    }\r\n\r\n    if (body.length > 0) {\r\n        result = true;\r\n\r\n        // If there are separate atoms for sub/sup, record them\r\n        if (isSuperscriptAtom(stream)) {\r\n            superscript = stream.index;\r\n            stream.index += 1;\r\n        }\r\n        if (isSubscriptAtom(stream)) {\r\n            subscript = stream.index;\r\n            stream.index += 1;\r\n        }\r\n\r\n        if (superscript >= 0 && subscript >= 0) {\r\n            mathML = '<msubsup>' + body;\r\n            mathML += toMathML(stream.atoms[subscript].subscript, 0, 0, options)\r\n                .mathML;\r\n            mathML += toMathML(\r\n                stream.atoms[superscript].superscript,\r\n                0,\r\n                0,\r\n                options\r\n            ).mathML;\r\n            mathML += '</msubsup>';\r\n        } else if (superscript >= 0) {\r\n            mathML = '<msup>' + body;\r\n            if (isSuperscriptAtom(stream)) {\r\n                // There's another superscript after this one. Maybe double-prime?\r\n                const sup = toMathML(\r\n                    stream.atoms[superscript].superscript,\r\n                    0,\r\n                    0,\r\n                    options\r\n                ).mathML;\r\n\r\n                const sup2 = toMathML(\r\n                    stream.atoms[superscript + 1].superscript,\r\n                    0,\r\n                    0,\r\n                    options\r\n                ).mathML;\r\n                if (\r\n                    (sup === '<mi>\\u2032</mi>' ||\r\n                        sup === '<mi>&#x2032;</mi>') &&\r\n                    (sup2 === '<mi>\\u2032</mi>' || sup2 === '<mi>&#x2032;</mi>')\r\n                ) {\r\n                    mathML += '<mi>&#x2033;</mi>';\r\n                } else if (\r\n                    sup === '<mi>\\u2032</mi>' ||\r\n                    sup === '<mi>&#x2032;</mi>'\r\n                ) {\r\n                    mathML += '<mi>&#x2032;</mi>';\r\n                } else {\r\n                    mathML += sup;\r\n                }\r\n            } else {\r\n                mathML += toMathML(\r\n                    stream.atoms[superscript].superscript,\r\n                    0,\r\n                    0,\r\n                    options\r\n                ).mathML;\r\n            }\r\n            mathML += '</msup>';\r\n        } else if (subscript >= 0) {\r\n            mathML = '<msub>' + body;\r\n            mathML += toMathML(stream.atoms[subscript].subscript, 0, 0, options)\r\n                .mathML;\r\n            mathML += '</msub>';\r\n        } else {\r\n            mathML = body;\r\n        }\r\n\r\n        if (\r\n            (stream.lastType === 'mi' ||\r\n                stream.lastType === 'mn' ||\r\n                stream.lastType === 'mtext' ||\r\n                stream.lastType === 'fence') &&\r\n            !/^<mo>(.*)<\\/mo>$/.test(mathML)\r\n        ) {\r\n            mathML = '<mo>&#8290;</mo>' + mathML; // &InvisibleTimes;\r\n        }\r\n\r\n        if (body.endsWith('>f</mi>') || body.endsWith('>g</mi>')) {\r\n            mathML += '<mo>&x2061;</mo>'; // &ApplyFunction;\r\n            stream.lastType = 'applyfunction';\r\n        } else {\r\n            stream.lastType = /^<mo>(.*)<\\/mo>$/.test(mathML) ? 'mo' : 'mi';\r\n        }\r\n\r\n        stream.mathML += mathML;\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n/**\r\n * Return true if the current atom is a standalone superscript atom\r\n * i.e. an atom with no content, except of a superscript.\r\n * Superscripts can be encoded either as an attribute on the last atom\r\n * or as a standalone, empty, atom following the one to which it applies.\r\n * @param {object} stream\r\n */\r\nfunction isSuperscriptAtom(stream) {\r\n    return (\r\n        stream.index < stream.atoms.length &&\r\n        stream.atoms[stream.index].superscript &&\r\n        stream.atoms[stream.index].type === 'msubsup'\r\n    );\r\n}\r\n\r\nfunction isSubscriptAtom(stream) {\r\n    return (\r\n        stream.index < stream.atoms.length &&\r\n        stream.atoms[stream.index].subscript &&\r\n        stream.atoms[stream.index].type === 'msubsup'\r\n    );\r\n}\r\n\r\nfunction indexOfSuperscriptInNumber(stream) {\r\n    let result = -1;\r\n    let i = stream.index;\r\n    let done = false;\r\n    let found = false;\r\n    while (i < stream.atoms.length && !done && !found) {\r\n        done =\r\n            stream.atoms[i].type !== 'mord' ||\r\n            '0123456789,.'.indexOf(stream.atoms[i].body) < 0;\r\n        found = !done && stream.atoms[i].superscript;\r\n        i++;\r\n    }\r\n\r\n    if (found) {\r\n        result = i - 1;\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nfunction parseSubsup(base, stream, options) {\r\n    let result = false;\r\n    let mathML = '';\r\n    let atom = stream.atoms[stream.index - 1];\r\n\r\n    if (!atom) return false;\r\n\r\n    if (!atom.branches?.superscript && !atom.branches?.subscript) {\r\n        if (isSuperscriptAtom(stream) || isSubscriptAtom(stream)) {\r\n            atom = stream.atoms[stream.index];\r\n            stream.index += 1;\r\n        }\r\n    }\r\n    if (!atom) return false;\r\n\r\n    if (atom.branches?.superscript && atom.branches?.subscript) {\r\n        mathML = '<msubsup>' + base;\r\n        mathML += toMathML(atom.branches?.subscript, 0, 0, options).mathML;\r\n        mathML += toMathML(atom.branches?.superscript, 0, 0, options).mathML;\r\n        mathML += '</msubsup>';\r\n    } else if (atom.branches?.superscript) {\r\n        mathML = '<msup>' + base;\r\n        mathML += toMathML(atom.branches?.superscript, 0, 0, options).mathML;\r\n        mathML += '</msup>';\r\n    } else if (atom.branches?.subscript) {\r\n        mathML = '<msub>' + base;\r\n        mathML += toMathML(atom.branches?.subscript, 0, 0, options).mathML;\r\n        mathML += '</msub>';\r\n    }\r\n\r\n    if (mathML.length > 0) {\r\n        result = true;\r\n        stream.mathML += mathML;\r\n        stream.lastType = '';\r\n    }\r\n    return result;\r\n}\r\n\r\nfunction scanText(stream, final, options) {\r\n    let result = false;\r\n    final = final || stream.atoms.length;\r\n    const initial = stream.index;\r\n    let mathML = '';\r\n    while (stream.index < final && stream.atoms[stream.index].mode === 'text') {\r\n        mathML += stream.atoms[stream.index].body\r\n            ? stream.atoms[stream.index].body\r\n            : ' ';\r\n        stream.index += 1;\r\n    }\r\n\r\n    if (mathML.length > 0) {\r\n        result = true;\r\n        mathML =\r\n            '<mtext' +\r\n            makeID(stream.atoms[initial].id, options) +\r\n            '>' +\r\n            mathML +\r\n            '</mtext>';\r\n\r\n        stream.mathML += mathML;\r\n        stream.lastType = 'mtext';\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nfunction scanNumber(stream, final, options) {\r\n    let result = false;\r\n    final = final || stream.atoms.length;\r\n    const initial = stream.index;\r\n    let mathML = '';\r\n\r\n    let superscript = indexOfSuperscriptInNumber(stream);\r\n    if (superscript >= 0 && superscript < final) {\r\n        final = superscript;\r\n    }\r\n\r\n    while (\r\n        stream.index < final &&\r\n        stream.atoms[stream.index].type === 'mord' &&\r\n        '0123456789,.'.indexOf(stream.atoms[stream.index].body) >= 0\r\n    ) {\r\n        mathML += stream.atoms[stream.index].body;\r\n        stream.index += 1;\r\n    }\r\n\r\n    if (mathML.length > 0) {\r\n        result = true;\r\n        mathML =\r\n            '<mn' +\r\n            makeID(stream.atoms[initial].id, options) +\r\n            '>' +\r\n            mathML +\r\n            '</mn>';\r\n\r\n        if (superscript < 0 && isSuperscriptAtom(stream)) {\r\n            superscript = stream.index;\r\n            stream.index += 1;\r\n        }\r\n\r\n        if (superscript >= 0) {\r\n            mathML = '<msup>' + mathML;\r\n            mathML += toMathML(\r\n                stream.atoms[superscript].superscript,\r\n                0,\r\n                0,\r\n                options\r\n            ).mathML;\r\n            mathML += '</msup>';\r\n        }\r\n\r\n        stream.mathML += mathML;\r\n        stream.lastType = 'mn';\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nfunction scanFence(stream, final, options) {\r\n    let result = false;\r\n    final = final || stream.atoms.length;\r\n    let mathML = '';\r\n    let lastType = '';\r\n\r\n    if (stream.index < final && stream.atoms[stream.index].type === 'mopen') {\r\n        let found = false;\r\n        let depth = 0;\r\n        const openIndex = stream.index;\r\n        let closeIndex = -1;\r\n        let index = openIndex + 1;\r\n        while (index < final && !found) {\r\n            if (stream.atoms[index].type === 'mopen') {\r\n                depth += 1;\r\n            } else if (stream.atoms[index].type === 'mclose') {\r\n                depth -= 1;\r\n            }\r\n            if (depth === -1) {\r\n                found = true;\r\n                closeIndex = index;\r\n            }\r\n            index += 1;\r\n        }\r\n        if (found) {\r\n            // TODO: could add attribute indicating it's a fence (fence=true)\r\n            mathML = '<mrow>';\r\n            mathML += toMo(stream.atoms[openIndex], options);\r\n\r\n            mathML += toMathML(stream.atoms, openIndex + 1, closeIndex, options)\r\n                .mathML;\r\n\r\n            // TODO: could add attribute indicating it's a fence (fence=true)\r\n            mathML += toMo(stream.atoms[closeIndex], options);\r\n            mathML += '</mrow>';\r\n\r\n            if (\r\n                stream.lastType === 'mi' ||\r\n                stream.lastType === 'mn' ||\r\n                stream.lastType === 'mfrac' ||\r\n                stream.lastType === 'fence'\r\n            ) {\r\n                mathML = '<mo>&#8290;</mo>' + mathML; // &InvisibleTimes;\r\n            }\r\n            stream.index = closeIndex + 1;\r\n\r\n            if (parseSubsup(mathML, stream, options)) {\r\n                result = true;\r\n                stream.lastType = '';\r\n                mathML = '';\r\n            }\r\n\r\n            lastType = 'fence';\r\n        }\r\n    }\r\n\r\n    if (mathML.length > 0) {\r\n        result = true;\r\n        stream.mathML += mathML;\r\n        stream.lastType = lastType;\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nfunction scanOperator(stream, final, options) {\r\n    let result = false;\r\n    final = final || stream.atoms.length;\r\n    let mathML = '';\r\n    let lastType = '';\r\n    const atom = stream.atoms[stream.index];\r\n\r\n    if (\r\n        stream.index < final &&\r\n        (atom.type === 'mbin' || atom.type === 'mrel')\r\n    ) {\r\n        mathML += atomToMathML(stream.atoms[stream.index], options);\r\n        stream.index += 1;\r\n        lastType = 'mo';\r\n    } else if (stream.index < final && atom.type === 'mop') {\r\n        // mathML += '<mrow>';\r\n\r\n        if (\r\n            atom.limits === 'limits' &&\r\n            (atom.branches?.superscript || atom.branches?.subscript)\r\n        ) {\r\n            // Operator with limits, e.g. \\sum\r\n            const op = toMo(atom, options);\r\n            if (atom.branches?.superscript && atom.branches?.subscript) {\r\n                // Both superscript and subscript\r\n                mathML +=\r\n                    (atom.limits !== 'nolimits'\r\n                        ? '<munderover>'\r\n                        : '<msubsup>') + op;\r\n                mathML += toMathML(atom.branches?.subscript, 0, 0, options)\r\n                    .mathML;\r\n                mathML += toMathML(atom.branches?.superscript, 0, 0, options)\r\n                    .mathML;\r\n                mathML +=\r\n                    atom.limits !== 'nolimits' ? '</munderover>' : '</msubsup>';\r\n            } else if (atom.branches?.superscript) {\r\n                // Superscript only\r\n                mathML +=\r\n                    (atom.limits !== 'nolimits' ? '<mover>' : '<msup>') + op;\r\n                mathML += toMathML(atom.branches?.superscript, 0, 0, options)\r\n                    .mathML;\r\n                mathML += atom.limits !== 'nolimits' ? '</mover>' : '</msup>';\r\n            } else {\r\n                // Subscript only\r\n                mathML +=\r\n                    (atom.limits !== 'nolimits' ? '<munder>' : '<msub>') + op;\r\n                mathML += toMathML(atom.branches?.subscript, 0, 0, options)\r\n                    .mathML;\r\n                mathML += atom.limits !== 'nolimits' ? '</munder>' : '</msub>';\r\n            }\r\n            lastType = 'mo';\r\n        } else {\r\n            const atom = stream.atoms[stream.index];\r\n            const isUnit = atom.symbol === '\\\\operatorname';\r\n            const op = isUnit\r\n                ? '<mi class=\"MathML-Unit\"' +\r\n                  makeID(atom.id, options) +\r\n                  '>' +\r\n                  toString(atom.value) +\r\n                  '</mi>'\r\n                : toMo(atom, options);\r\n            mathML += op;\r\n            stream.index += 1;\r\n            if (parseSubsup(mathML, stream, options)) {\r\n                result = true;\r\n                stream.lastType = '';\r\n                mathML = '';\r\n            }\r\n            stream.index -= 1;\r\n            if (!isUnit && !/^<mo>(.*)<\\/mo>$/.test(op)) {\r\n                mathML += '<mo>&#x2061;</mo>'; // APPLY FUNCTION\r\n                // mathML += scanArgument(stream);\r\n                lastType = 'applyfunction';\r\n            } else {\r\n                lastType = isUnit ? 'mi' : 'mo';\r\n            }\r\n        }\r\n        // mathML += '</mrow>';\r\n\r\n        if (\r\n            (stream.lastType === 'mi' || stream.lastType === 'mn') &&\r\n            !/^<mo>(.*)<\\/mo>$/.test(mathML)\r\n        ) {\r\n            mathML = '<mo>&#8290;</mo>' + mathML; // &InvisibleTimes;\r\n        }\r\n        stream.index += 1;\r\n    }\r\n\r\n    if (mathML.length > 0) {\r\n        result = true;\r\n        stream.mathML += mathML;\r\n        stream.lastType = lastType;\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n/**\r\n * Given an atom or an array of atoms, return their MathML representation as\r\n * a string.\r\n * @param {string|Atom|Atom[]} input\r\n * @param initial index of the input to start conversion from\r\n * @param final last index of the input to stop conversion to\r\n */\r\nfunction toMathML(\r\n    input: number | boolean | string | Atom | Atom[],\r\n    initial: number,\r\n    final: number,\r\n    options: Partial<MathfieldOptions>\r\n): {\r\n    atoms: number | boolean | string | Atom | Atom[];\r\n    index: number;\r\n    mathML: string;\r\n    lastType: string;\r\n} {\r\n    const result = {\r\n        atoms: input,\r\n        index: initial ?? 0,\r\n        mathML: '',\r\n        lastType: '',\r\n    };\r\n\r\n    if (typeof input === 'number' || typeof input === 'boolean') {\r\n        result.mathML = input.toString();\r\n    } else if (typeof input === 'string') {\r\n        result.mathML = input;\r\n    } else if (input instanceof Atom) {\r\n        result.mathML = atomToMathML(input, options);\r\n    } else if (Array.isArray(input)) {\r\n        let count = 0;\r\n        final = final ? final : input ? input.length : 0;\r\n\r\n        while (result.index < final) {\r\n            if (\r\n                scanText(result, final, options) ||\r\n                scanNumber(result, final, options) ||\r\n                scanIdentifier(result, final, options) ||\r\n                scanOperator(result, final, options) ||\r\n                scanFence(result, final, options)\r\n            ) {\r\n                count += 1;\r\n            } else if (result.index < final) {\r\n                let mathML = atomToMathML(result.atoms[result.index], options);\r\n                if (\r\n                    result.lastType === 'mn' &&\r\n                    mathML.length > 0 &&\r\n                    result.atoms[result.index].type === 'genfrac'\r\n                ) {\r\n                    // If this is a fraction preceded by a number (e.g. 2 1/2),\r\n                    // add an \"invisible plus\" (U+0264) character in front of it\r\n                    mathML = '<mo>&#x2064;</mo>' + mathML;\r\n                }\r\n                if (result.atoms[result.index].type === 'genfrac') {\r\n                    result.lastType = 'mfrac';\r\n                } else {\r\n                    result.lastType = '';\r\n                }\r\n                if (mathML.length > 0) {\r\n                    result.mathML += mathML;\r\n                    count += 1;\r\n                }\r\n                result.index += 1;\r\n            }\r\n        }\r\n\r\n        // If there are more than a single element, wrap them in a mrow tag.\r\n        if (count > 1) {\r\n            result.mathML = '<mrow>' + result.mathML + '</mrow>';\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nfunction toMo(atom, options) {\r\n    let result = '';\r\n    const body = toString(atom.value);\r\n    if (body) {\r\n        result = '<mo' + makeID(atom.id, options) + '>' + body + '</mo>';\r\n    }\r\n    return result;\r\n}\r\n\r\nfunction toString(atoms) {\r\n    if (!atoms) return '';\r\n    if (typeof atoms === 'string') return xmlEscape(atoms);\r\n    if (!Array.isArray(atoms) && typeof atoms.body === 'string') {\r\n        return xmlEscape(atoms.body);\r\n    }\r\n    let result = '';\r\n    for (const atom of atoms) {\r\n        if (typeof atom.value === 'string') {\r\n            result += atom.value;\r\n        }\r\n    }\r\n    return xmlEscape(result);\r\n}\r\n\r\n/**\r\n * Return a MathML fragment representation of a single atom\r\n *\r\n */\r\nfunction atomToMathML(atom, options): string {\r\n    // For named SVG atoms, map to a Unicode char\r\n    const SVG_CODE_POINTS = {\r\n        widehat: '^',\r\n        widecheck: '',\r\n        widetilde: '~',\r\n        utilde: '~',\r\n        overleftarrow: '\\u2190',\r\n        underleftarrow: '\\u2190',\r\n        xleftarrow: '\\u2190',\r\n        overrightarrow: '\\u2192',\r\n        underrightarrow: '\\u2192',\r\n        xrightarrow: '\\u2192',\r\n        underbrace: '\\u23df',\r\n        overbrace: '\\u23de',\r\n        overgroup: '\\u23e0',\r\n        undergroup: '\\u23e1',\r\n        overleftrightarrow: '\\u2194',\r\n        underleftrightarrow: '\\u2194',\r\n        xleftrightarrow: '\\u2194',\r\n        Overrightarrow: '\\u21d2',\r\n        xRightarrow: '\\u21d2',\r\n        overleftharpoon: '\\u21bc',\r\n        xleftharpoonup: '\\u21bc',\r\n        overrightharpoon: '\\u21c0',\r\n        xrightharpoonup: '\\u21c0',\r\n        xLeftarrow: '\\u21d0',\r\n        xLeftrightarrow: '\\u21d4',\r\n        xhookleftarrow: '\\u21a9',\r\n        xhookrightarrow: '\\u21aa',\r\n        xmapsto: '\\u21a6',\r\n        xrightharpoondown: '\\u21c1',\r\n        xleftharpoondown: '\\u21bd',\r\n        xrightleftharpoons: '\\u21cc',\r\n        xleftrightharpoons: '\\u21cb',\r\n        xtwoheadleftarrow: '\\u219e',\r\n        xtwoheadrightarrow: '\\u21a0',\r\n        xlongequal: '=',\r\n        xtofrom: '\\u21c4',\r\n        xrightleftarrows: '\\u21c4',\r\n        xrightequilibrium: '\\u21cc', // Not a perfect match.\r\n        xleftequilibrium: '\\u21cb', // None better available.\r\n    };\r\n\r\n    const SPECIAL_IDENTIFIERS = {\r\n        '\\\\exponentialE': '&#x02147;',\r\n        '\\\\imaginaryI': '&#x2148;',\r\n        '\\\\differentialD': '&#x2146;',\r\n        '\\\\capitalDifferentialD': '&#x2145;',\r\n        '\\\\alpha': '&#x03b1;',\r\n        '\\\\pi': '&#x03c0;',\r\n        '\\\\infty': '&#x221e;',\r\n        '\\\\forall': '&#x2200;',\r\n        '\\\\nexists': '&#x2204;',\r\n        '\\\\exists': '&#x2203;',\r\n        '\\\\hbar': '\\u210f',\r\n        '\\\\cdotp': '\\u22c5',\r\n        '\\\\ldots': '\\u2026',\r\n        '\\\\cdots': '\\u22ef',\r\n        '\\\\ddots': '\\u22f1',\r\n        '\\\\vdots': '\\u22ee',\r\n        '\\\\ldotp': '\\u002e',\r\n        // TODO: include all the 'textord' that are identifiers, not operators.\r\n    };\r\n\r\n    const MATH_VARIANTS = {\r\n        cal: 'script',\r\n        frak: 'fraktur',\r\n        bb: 'double-struck',\r\n        scr: 'script',\r\n        cmtt: 'monospace',\r\n        cmss: 'sans-serif',\r\n    };\r\n    const SPACING = {\r\n        '\\\\!': -3 / 18,\r\n        '\\\\ ': 6 / 18,\r\n        '\\\\,': 3 / 18,\r\n        '\\\\:': 4 / 18,\r\n        '\\\\;': 5 / 18,\r\n        '\\\\enspace': 0.5,\r\n        '\\\\quad': 1,\r\n        '\\\\qquad': 2,\r\n        '\\\\enskip': 0.5,\r\n    };\r\n\r\n    let result = '';\r\n    let sep = '';\r\n    let col, row, i;\r\n    let underscript, overscript, body;\r\n    let variant = MATH_VARIANTS[atom.fontFamily || atom.font] || '';\r\n    if (variant) {\r\n        variant = ' mathvariant=\"' + variant + '\"';\r\n    }\r\n\r\n    const command = atom.command;\r\n    if (atom.mode === 'text') {\r\n        result = '<mi' + makeID(atom.id, options) + '>' + atom.value + '</mi>';\r\n    } else {\r\n        switch (atom.type) {\r\n            case 'first':\r\n                break; // nothing to do\r\n            case 'group':\r\n            case 'root':\r\n                result = toMathML(atom.body, 0, 0, options).mathML;\r\n                break;\r\n\r\n            case 'array':\r\n                if (\r\n                    (atom.leftDelim && atom.leftDelim !== '.') ||\r\n                    (atom.rightDelim && atom.rightDelim !== '.')\r\n                ) {\r\n                    result += '<mrow>';\r\n                    if (atom.leftDelim && atom.leftDelim !== '.') {\r\n                        result +=\r\n                            '<mo>' +\r\n                            (SPECIAL_OPERATORS[atom.leftDelim] ||\r\n                                atom.leftDelim) +\r\n                            '</mo>';\r\n                    }\r\n                }\r\n                result += '<mtable';\r\n                if (atom.colFormat) {\r\n                    result += ' columnalign=\"';\r\n                    for (i = 0; i < atom.colFormat.length; i++) {\r\n                        if (atom.colFormat[i].align) {\r\n                            result +=\r\n                                { l: 'left', c: 'center', r: 'right' }[\r\n                                    atom.colFormat[i].align\r\n                                ] + ' ';\r\n                        }\r\n                    }\r\n                    result += '\"';\r\n                }\r\n\r\n                result += '>';\r\n                for (row = 0; row < atom.array.length; row++) {\r\n                    result += '<mtr>';\r\n                    for (col = 0; col < atom.array[row].length; col++) {\r\n                        result +=\r\n                            '<mtd>' +\r\n                            toMathML(atom.array[row][col], 0, 0, options)\r\n                                .mathML +\r\n                            '</mtd>';\r\n                    }\r\n                    result += '</mtr>';\r\n                }\r\n\r\n                result += '</mtable>';\r\n\r\n                if (\r\n                    (atom.leftDelim && atom.leftDelim !== '.') ||\r\n                    (atom.rightDelim && atom.rightDelim !== '.')\r\n                ) {\r\n                    if (atom.rightDelim && atom.rightDelim !== '.') {\r\n                        result +=\r\n                            '<mo>' +\r\n                            (SPECIAL_OPERATORS[atom.leftDelim] ||\r\n                                atom.rightDelim) +\r\n                            '</mo>';\r\n                    }\r\n                    result += '</mrow>';\r\n                }\r\n                break;\r\n\r\n            case 'genfrac':\r\n                if (atom.leftDelim || atom.rightDelim) {\r\n                    result += '<mrow>';\r\n                }\r\n                if (atom.leftDelim && atom.leftDelim !== '.') {\r\n                    result +=\r\n                        '<mo' +\r\n                        makeID(atom.id, options) +\r\n                        '>' +\r\n                        (SPECIAL_OPERATORS[atom.leftDelim] || atom.leftDelim) +\r\n                        '</mo>';\r\n                }\r\n                if (atom.hasBarLine) {\r\n                    result += '<mfrac>';\r\n                    result +=\r\n                        toMathML(atom.above, 0, 0, options).mathML ||\r\n                        '<mi>&nbsp;</mi>';\r\n                    result +=\r\n                        toMathML(atom.below, 0, 0, options).mathML ||\r\n                        '<mi>&nbsp;</mi>';\r\n                    result += '</mfrac>';\r\n                } else {\r\n                    // No bar line, i.e. \\choose, etc...\r\n                    result += '<mtable' + makeID(atom.id, options) + '>';\r\n                    result +=\r\n                        '<mtr>' +\r\n                        toMathML(atom.above, 0, 0, options).mathML +\r\n                        '</mtr>';\r\n                    result +=\r\n                        '<mtr>' +\r\n                        toMathML(atom.below, 0, 0, options).mathML +\r\n                        '</mtr>';\r\n                    result += '</mtable>';\r\n                }\r\n                if (atom.rightDelim && atom.rightDelim !== '.') {\r\n                    result +=\r\n                        '<mo' +\r\n                        makeID(atom.id, options) +\r\n                        '>' +\r\n                        (SPECIAL_OPERATORS[atom.rightDelim] ||\r\n                            atom.rightDelim) +\r\n                        '</mo>';\r\n                }\r\n                if (atom.leftDelim || atom.rightDelim) {\r\n                    result += '</mrow>';\r\n                }\r\n                break;\r\n\r\n            case 'surd':\r\n                if (!atom.hasEmptyBranch('above')) {\r\n                    result += '<mroot' + makeID(atom.id, options) + '>';\r\n                    result += toMathML(atom.body, 0, 0, options).mathML;\r\n                    result += toMathML(atom.above, 0, 0, options).mathML;\r\n                    result += '</mroot>';\r\n                } else {\r\n                    result += '<msqrt' + makeID(atom.id, options) + '>';\r\n                    result += toMathML(atom.body, 0, 0, options).mathML;\r\n                    result += '</msqrt>';\r\n                }\r\n                break;\r\n\r\n            case 'leftright':\r\n                // TODO: could add fence=true attribute\r\n                result = '<mrow>';\r\n                if (atom.leftDelim && atom.leftDelim !== '.') {\r\n                    result +=\r\n                        '<mo' +\r\n                        makeID(atom.id, options) +\r\n                        '>' +\r\n                        (SPECIAL_OPERATORS[atom.leftDelim] || atom.leftDelim) +\r\n                        '</mo>';\r\n                }\r\n                if (atom.body) {\r\n                    result += toMathML(atom.body, 0, 0, options).mathML;\r\n                }\r\n                if (atom.rightDelim && atom.rightDelim !== '.') {\r\n                    result +=\r\n                        '<mo' +\r\n                        makeID(atom.id, options) +\r\n                        '>' +\r\n                        (SPECIAL_OPERATORS[atom.rightDelim] ||\r\n                            atom.rightDelim) +\r\n                        '</mo>';\r\n                }\r\n                result += '</mrow>';\r\n                break;\r\n\r\n            case 'sizeddelim':\r\n            case 'delim':\r\n                result +=\r\n                    '<mo separator=\"true\"' +\r\n                    makeID(atom.id, options) +\r\n                    '>' +\r\n                    (SPECIAL_OPERATORS[atom.delim] || atom.delim) +\r\n                    '</mo>';\r\n                break;\r\n\r\n            case 'accent':\r\n                result +=\r\n                    '<mover accent=\"true\"' + makeID(atom.id, options) + '>';\r\n                result += toMathML(atom.body, 0, 0, options).mathML;\r\n                result +=\r\n                    '<mo>' +\r\n                    (SPECIAL_OPERATORS[command] || atom.accent) +\r\n                    '</mo>';\r\n                result += '</mover>';\r\n                break;\r\n\r\n            case 'line':\r\n            case 'overlap':\r\n                break;\r\n\r\n            case 'overunder':\r\n                overscript = atom.above;\r\n                underscript = atom.below;\r\n                if (\r\n                    (atom.svgAbove || overscript) &&\r\n                    (atom.svgBelow || underscript)\r\n                ) {\r\n                    body = atom.body;\r\n                } else if (overscript && overscript.length > 0) {\r\n                    body = atom.body;\r\n                    if (atom.body?.[0]?.below) {\r\n                        underscript = atom.body[0].below;\r\n                        body = atom.body[0].body;\r\n                    } else if (\r\n                        atom.body?.[0]?.type === 'first' &&\r\n                        atom.body?.[1]?.below\r\n                    ) {\r\n                        underscript = atom.body[1].below;\r\n                        body = atom.body[1].body;\r\n                    }\r\n                } else if (underscript && underscript.length > 0) {\r\n                    body = atom.body;\r\n                    if (atom.body?.[0]?.above) {\r\n                        overscript = atom.body[0].above;\r\n                        body = atom.body[0].body;\r\n                    } else if (\r\n                        atom.body?.[0]?.type === 'first' &&\r\n                        atom.body?.[1]?.above\r\n                    ) {\r\n                        overscript = atom.body[1].overscript;\r\n                        body = atom.body[1].body;\r\n                    }\r\n                }\r\n\r\n                if (\r\n                    (atom.svgAbove || overscript) &&\r\n                    (atom.svgBelow || underscript)\r\n                ) {\r\n                    result += `<munderover ${variant} ${makeID(\r\n                        atom.id,\r\n                        options\r\n                    )}>`;\r\n                    result +=\r\n                        SVG_CODE_POINTS[atom.svgBody] ||\r\n                        toMathML(body, 0, 0, options).mathML;\r\n                    result +=\r\n                        SVG_CODE_POINTS[atom.svgBelow] ||\r\n                        toMathML(underscript, 0, 0, options).mathML;\r\n                    result +=\r\n                        SVG_CODE_POINTS[atom.svgAbove] ||\r\n                        toMathML(overscript, 0, 0, options).mathML;\r\n                    result += '</munderover>';\r\n                } else if (atom.svgAbove || overscript) {\r\n                    result +=\r\n                        `<mover ${variant} ${makeID(atom.id, options)}>` +\r\n                        (SVG_CODE_POINTS[atom.svgBody] ||\r\n                            toMathML(body, 0, 0, options).mathML);\r\n                    result +=\r\n                        SVG_CODE_POINTS[atom.svgAbove] ||\r\n                        toMathML(overscript, 0, 0, options).mathML;\r\n                    result += '</mover>';\r\n                } else if (atom.svgBelow || underscript) {\r\n                    result +=\r\n                        `<munder ${variant} ${makeID(atom.id, options)}>` +\r\n                        (SVG_CODE_POINTS[atom.svgBody] ||\r\n                            toMathML(body, 0, 0, options).mathML);\r\n                    result +=\r\n                        SVG_CODE_POINTS[atom.svgBelow] ||\r\n                        toMathML(underscript, 0, 0, options).mathML;\r\n                    result += '</munder>';\r\n                }\r\n                break;\r\n\r\n            case 'placeholder': // no real equivalent in MathML -- will generate a '?'qq\r\n            case 'mord': {\r\n                result =\r\n                    SPECIAL_IDENTIFIERS[command] ||\r\n                    command ||\r\n                    (typeof atom.value === 'string' ? atom.value : '');\r\n                const m = command\r\n                    ? command.match(/[{]?\\\\char\"([0-9abcdefABCDEF]*)[}]?/)\r\n                    : null;\r\n                if (m) {\r\n                    // It's a \\char command\r\n                    result = '&#x' + m[1] + ';';\r\n                } else if (result.length > 0 && result.charAt(0) === '\\\\') {\r\n                    // This is an identifier with no special handling. Use the\r\n                    // Unicode value\r\n                    if (\r\n                        typeof atom.value === 'string' &&\r\n                        atom.value.charCodeAt(0) > 255\r\n                    ) {\r\n                        result =\r\n                            '&#x' +\r\n                            (\r\n                                '000000' + atom.value.charCodeAt(0).toString(16)\r\n                            ).substr(-4) +\r\n                            ';';\r\n                    } else if (typeof atom.value === 'string') {\r\n                        result = atom.value.charAt(0);\r\n                    } else {\r\n                        console.log('Did not expect this');\r\n                        result = '';\r\n                    }\r\n                }\r\n                const tag = /\\d/.test(result) ? 'mn' : 'mi';\r\n                result =\r\n                    '<' +\r\n                    tag +\r\n                    variant +\r\n                    makeID(atom.id, options) +\r\n                    '>' +\r\n                    xmlEscape(result) +\r\n                    '</' +\r\n                    tag +\r\n                    '>';\r\n                break;\r\n            }\r\n            case 'mbin':\r\n            case 'mrel':\r\n            case 'textord':\r\n            case 'minner':\r\n                if (command && SPECIAL_IDENTIFIERS[command]) {\r\n                    // Some 'textord' are actually identifiers. Check them here.\r\n                    result =\r\n                        '<mi' +\r\n                        makeID(atom.id, options) +\r\n                        '>' +\r\n                        SPECIAL_IDENTIFIERS[command] +\r\n                        '</mi>';\r\n                } else if (command && SPECIAL_OPERATORS[command]) {\r\n                    result =\r\n                        '<mo' +\r\n                        makeID(atom.id, options) +\r\n                        '>' +\r\n                        SPECIAL_OPERATORS[command] +\r\n                        '</mo>';\r\n                } else {\r\n                    result = toMo(atom, options);\r\n                }\r\n                break;\r\n\r\n            case 'mpunct':\r\n                result =\r\n                    '<mo separator=\"true\"' +\r\n                    makeID(atom.id, options) +\r\n                    '>' +\r\n                    (SPECIAL_OPERATORS[command] || command) +\r\n                    '</mo>';\r\n                break;\r\n\r\n            case 'mop':\r\n                if (atom.body !== '\\u200b') {\r\n                    // Not ZERO-WIDTH\r\n                    result = '<mo' + makeID(atom.id, options) + '>';\r\n                    if (command === '\\\\operatorname') {\r\n                        result += atom.body;\r\n                    } else {\r\n                        result += command || atom.body;\r\n                    }\r\n                    result += '</mo>';\r\n                }\r\n                break;\r\n\r\n            // case 'mathstyle':\r\n            // TODO: mathstyle is a switch. Need to figure out its scope to properly wrap it around a <mstyle> tag\r\n            // if (atom.mathstyle === 'displaystyle') {\r\n            //     result += '<mstyle displaystyle=\"true\">';\r\n            //     result += '</mstyle>';\r\n            // } else {\r\n            //     result += '<mstyle displaystyle=\"false\">';\r\n            //     result += '</mstyle>';\r\n            // };\r\n            // break;\r\n\r\n            case 'box':\r\n                result = '<menclose notation=\"box\"';\r\n                if (atom.backgroundcolor) {\r\n                    result +=\r\n                        ' mathbackground=\"' +\r\n                        stringToColor(atom.backgroundcolor) +\r\n                        '\"';\r\n                }\r\n                result +=\r\n                    makeID(atom.id, options) +\r\n                    '>' +\r\n                    toMathML(atom.body, 0, 0, options).mathML +\r\n                    '</menclose>';\r\n                break;\r\n\r\n            case 'spacing':\r\n                result += '<mspace width=\"' + (SPACING[command] || 0) + 'em\"/>';\r\n                break;\r\n\r\n            case 'enclose':\r\n                result = '<menclose notation=\"';\r\n                for (const notation in atom.notation) {\r\n                    if (\r\n                        Object.prototype.hasOwnProperty.call(\r\n                            atom.notation,\r\n                            notation\r\n                        ) &&\r\n                        atom.notation[notation]\r\n                    ) {\r\n                        result += sep + notation;\r\n                        sep = ' ';\r\n                    }\r\n                }\r\n                result +=\r\n                    makeID(atom.id, options) +\r\n                    '\">' +\r\n                    toMathML(atom.body, 0, 0, options).mathML +\r\n                    '</menclose>';\r\n                break;\r\n\r\n            case 'space':\r\n                result += '&nbsp;';\r\n                break;\r\n\r\n            case 'msubsup':\r\n                break;\r\n\r\n            case 'phantom':\r\n                break;\r\n            case 'composition':\r\n                break;\r\n            default:\r\n                console.log(\r\n                    'In conversion to MathML, unknown type : ' + atom.type\r\n                );\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function atomsToMathML(\r\n    atoms: Atom | Atom[],\r\n    options: Partial<MathfieldOptions>\r\n): string {\r\n    return toMathML(atoms, 0, 0, options).mathML;\r\n}\r\n","import { isArray } from '../common/types';\r\n\r\nimport type { Atom } from '../core/atom';\r\nimport { GenfracAtom } from '../core-atoms/genfrac';\r\nimport { LeftRightAtom } from '../core-atoms/leftright';\r\n\r\nconst SPECIAL_IDENTIFIERS = {\r\n    '\\u2212': '-', // MINUS SIGN\r\n    '-': '-',\r\n    '\\\\alpha': 'alpha',\r\n    '\\\\beta': 'beta',\r\n    '\\\\gamma': 'gamma',\r\n    '\\\\delta': 'delta',\r\n    '\\\\epsilon': 'epsilon',\r\n    '\\\\varepsilon': 'varepsilon',\r\n    '\\\\zeta': 'zeta',\r\n    '\\\\eta': 'eta',\r\n    '\\\\theta': 'theta',\r\n    '\\\\vartheta': 'vartheta',\r\n    '\\\\iota': 'iota',\r\n    '\\\\kappa': 'kappa',\r\n    '\\\\lambda': 'lambda',\r\n    '\\\\mu': 'mu',\r\n    '\\\\nu': 'nu',\r\n    '\\\\xi': 'xi',\r\n    '\\\\pi': 'pi',\r\n    '\\\\rho': 'rho',\r\n    '\\\\sigma': 'sigma',\r\n    '\\\\tau': 'tau',\r\n    '\\\\upsilon': 'upsilon',\r\n    '\\\\phi': 'phi',\r\n    '\\\\varphi': 'varphi',\r\n    '\\\\chi': 'chi',\r\n    '\\\\psi': 'psi',\r\n    '\\\\omega': 'omega',\r\n    '\\\\Gamma': 'Gamma',\r\n    '\\\\Delta': 'Delta',\r\n    '\\\\Theta': 'Theta',\r\n    '\\\\Lambda': 'Lambda',\r\n    '\\\\Xi': 'Xi',\r\n    '\\\\Pi': 'Pi',\r\n    '\\\\Sigma': 'Sigma',\r\n    '\\\\Phi': 'Phi',\r\n    '\\\\Psi': 'Psi',\r\n    '\\\\Omega': 'Omega',\r\n};\r\n\r\nconst SPECIAL_OPERATORS = {\r\n    '\\\\pm': '+-',\r\n    '\\\\times': 'xx',\r\n    '\\\\colon': ':',\r\n    '\\\\vert': '|',\r\n    '\\\\Vert': '||',\r\n    '\\\\mid': '|',\r\n    '\\\\lbrace': '{',\r\n    '\\\\rbrace': '}',\r\n    '\\\\langle': '(:',\r\n    '\\\\rangle': ':)',\r\n    // '\\\\lfloor': '\\u230a',\r\n    // '\\\\rfloor': '\\u230b',\r\n    // '\\\\lceil': '\\u2308',\r\n    // '\\\\rceil': '\\u2309',\r\n\r\n    // '\\\\vec': '&#x20d7;',\r\n    // '\\\\acute': '&#x00b4;',\r\n    // '\\\\grave': '&#x0060;',\r\n    // '\\\\dot': '&#x02d9;',\r\n    // '\\\\ddot': '&#x00a8;',\r\n    // '\\\\tilde': '&#x007e;',\r\n    // '\\\\bar': '&#x00af;',\r\n    // '\\\\breve': '&#x02d8;',\r\n    // '\\\\check': '&#x02c7;',\r\n    // '\\\\hat': '&#x005e;'\r\n};\r\n\r\nexport function atomToAsciiMath(atom: Atom | Atom[]): string {\r\n    if (!atom) return '';\r\n    if (isArray(atom)) {\r\n        let result = '';\r\n        if (atom.length === 0) return '';\r\n        if (atom[0].type === 'first') atom = atom.slice(1);\r\n        if (atom.length === 0) return '';\r\n        if (atom[0].mode === 'text') {\r\n            // Text mode... put it in (ASCII) quotes\r\n            let i = 0;\r\n            result = '\"';\r\n            while (atom[i]?.mode === 'text') {\r\n                if (atom[i].body) {\r\n                    result += atomToAsciiMath(atom[i].body);\r\n                } else {\r\n                    result += atom[i].value;\r\n                }\r\n                i++;\r\n            }\r\n            result += '\"' + atomToAsciiMath(atom.slice(i));\r\n        } else if (atom[0].mode === 'math') {\r\n            let i = 0;\r\n            while (atom[i] && atom[i].mode === 'math') {\r\n                result += atomToAsciiMath(atom[i]);\r\n                i++;\r\n            }\r\n            result += atomToAsciiMath(atom.slice(i));\r\n        } else {\r\n            console.warn('toASCIIMath: Unexpected mode');\r\n        }\r\n        return result.trim();\r\n    }\r\n\r\n    if (atom.mode === 'text') {\r\n        return '\"' + atom.value + '\"'; // text -- add in (ASCII) quotes\r\n    }\r\n\r\n    let result = '';\r\n    const command = atom.command;\r\n    let m;\r\n\r\n    switch (atom.type) {\r\n        case 'group':\r\n        case 'root':\r\n            result = atomToAsciiMath(atom.body);\r\n            break;\r\n\r\n        case 'array':\r\n            break;\r\n\r\n        case 'genfrac':\r\n            {\r\n                const genfracAtom = atom as GenfracAtom;\r\n                if (genfracAtom.leftDelim || genfracAtom.rightDelim) {\r\n                    result +=\r\n                        genfracAtom.leftDelim === '.' || !genfracAtom.leftDelim\r\n                            ? '{:'\r\n                            : genfracAtom.leftDelim;\r\n                }\r\n                if (genfracAtom.hasBarLine) {\r\n                    result += '(';\r\n                    result += atomToAsciiMath(genfracAtom.above);\r\n                    result += ')/(';\r\n                    result += atomToAsciiMath(genfracAtom.below);\r\n                    result += ')';\r\n                } else {\r\n                    // No bar line, i.e. \\choose, etc...\r\n                    result += '(' + atomToAsciiMath(genfracAtom.above) + '),';\r\n                    result += '(' + atomToAsciiMath(genfracAtom.below) + ')';\r\n                }\r\n                if (genfracAtom.leftDelim || genfracAtom.rightDelim) {\r\n                    result +=\r\n                        genfracAtom.rightDelim === '.' ||\r\n                        !genfracAtom.rightDelim\r\n                            ? '{:'\r\n                            : genfracAtom.rightDelim;\r\n                }\r\n            }\r\n            break;\r\n\r\n        case 'surd':\r\n            if (!atom.hasEmptyBranch('above')) {\r\n                result +=\r\n                    'root(' +\r\n                    atomToAsciiMath(atom.above) +\r\n                    ')(' +\r\n                    atomToAsciiMath(atom.body) +\r\n                    ')';\r\n            } else {\r\n                result += 'sqrt(' + atomToAsciiMath(atom.body) + ')';\r\n            }\r\n            break;\r\n\r\n        case 'leftright':\r\n            {\r\n                const leftrightAtom = atom as LeftRightAtom;\r\n                result +=\r\n                    leftrightAtom.leftDelim === '.' || !leftrightAtom.leftDelim\r\n                        ? '{:'\r\n                        : leftrightAtom.leftDelim;\r\n                result += atomToAsciiMath(leftrightAtom.body);\r\n                result +=\r\n                    leftrightAtom.rightDelim === '.' ||\r\n                    !leftrightAtom.rightDelim\r\n                        ? ':}'\r\n                        : leftrightAtom.rightDelim;\r\n            }\r\n            break;\r\n\r\n        case 'sizeddelim':\r\n        case 'delim':\r\n            // result += '<mo separator=\"true\"' + makeID(atom.id, options) + '>' + (SPECIAL_OPERATORS[atom.delim] || atom.delim) + '</mo>';\r\n            break;\r\n\r\n        case 'overlap':\r\n            break;\r\n\r\n        case 'overunder':\r\n            break;\r\n\r\n        case 'mord':\r\n            // @todo, deal with some special identifiers: \\alpha, etc...\r\n            result =\r\n                SPECIAL_IDENTIFIERS[command] ??\r\n                command ??\r\n                (typeof atom.value === 'string' ? atom.value : '');\r\n            if (result[0] === '\\\\') result = String(result);\r\n            m = command\r\n                ? command.match(/[{]?\\\\char\"([0-9abcdefABCDEF]*)[}]?/)\r\n                : null;\r\n            if (m) {\r\n                // It's a \\char command\r\n                result = String.fromCharCode(parseInt('0x' + m[1]));\r\n            } else if (result.length > 0 && result.charAt(0) === '\\\\') {\r\n                // atom is an identifier with no special handling. Use the\r\n                // Unicode value\r\n                if (typeof atom.value === 'string') {\r\n                    result = atom.value.charAt(0);\r\n                } else {\r\n                    result = atom.command;\r\n                }\r\n            }\r\n            // result = '<mi' + variant + makeID(atom.id, options) + '>' + xmlEscape(result) + '</mi>';\r\n            break;\r\n\r\n        case 'mbin':\r\n        case 'mrel':\r\n        case 'textord':\r\n        case 'minner':\r\n            if (command && SPECIAL_IDENTIFIERS[command]) {\r\n                // Some 'textord' are actually identifiers. Check them here.\r\n                result = SPECIAL_IDENTIFIERS[command];\r\n            } else if (command && SPECIAL_OPERATORS[command]) {\r\n                result = SPECIAL_OPERATORS[command];\r\n            } else {\r\n                result = atom.value;\r\n            }\r\n            break;\r\n\r\n        case 'mopen':\r\n        case 'mclose':\r\n            result += atom.value;\r\n            break;\r\n\r\n        case 'mpunct':\r\n            result = SPECIAL_OPERATORS[command] || command;\r\n            break;\r\n\r\n        case 'mop':\r\n            if (atom.value !== '\\u200b') {\r\n                // Not ZERO-WIDTH\r\n                result = '';\r\n                if (command === '\\\\operatorname') {\r\n                    result += atomToAsciiMath(atom.body);\r\n                } else {\r\n                    result += atom.value ?? command;\r\n                }\r\n                result += ' ';\r\n            }\r\n            break;\r\n\r\n        case 'box':\r\n            break;\r\n\r\n        case 'spacing':\r\n            break;\r\n\r\n        case 'enclose':\r\n            break;\r\n\r\n        case 'space':\r\n            result = ' ';\r\n            break;\r\n    }\r\n    // Subscripts before superscripts (according to the ASCIIMath spec)\r\n    if (!atom.hasEmptyBranch('subscript')) {\r\n        result += '_';\r\n        const arg = atomToAsciiMath(atom.subscript);\r\n        if (arg.length > 1 && !/^(-)?\\d+(\\.\\d*)?$/.test(arg)) {\r\n            result += '(' + arg + ')';\r\n        } else {\r\n            result += arg;\r\n        }\r\n    }\r\n\r\n    if (!atom.hasEmptyBranch('superscript')) {\r\n        result += '^';\r\n        const arg = atomToAsciiMath(atom.superscript);\r\n        if (arg.length > 1 && !/^(-)?\\d+(\\.\\d*)?$/.test(arg)) {\r\n            result += '(' + arg + ')';\r\n        } else {\r\n            result += arg;\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n","import { TextToSpeechOptions } from '../public/options';\r\n\r\nimport { Atom, isAtomArray } from '../core/atom';\r\n\r\nimport { atomsToMathML } from '../addons/math-ml';\r\nimport { LeftRightAtom } from '../core-atoms/leftright';\r\n\r\n// Markup\r\n// Two common flavor of markups: SSML and 'mac'. The latter is only available\r\n// when using the native TTS synthesizer on Mac OS.\r\n// Use SSML in the production rules below. The markup will either be striped\r\n// off or replaced with the 'mac' markup as necessary.\r\n//\r\n// SSML                                             Mac\r\n// ----                                             ----\r\n// <emphasis>WORD</emphasis>                        [[emph +]]WORD\r\n// <break time=\"150ms\"/>                            [[slc 150]]\r\n// <say-as interpret-as=\"character\">A</say-as>      [[char LTRL] A [[char NORM]]\r\n\r\n// https://developer.apple.com/library/content/documentation/UserExperience/Conceptual/SpeechSynthesisProgrammingGuide/FineTuning/FineTuning.html#//apple_ref/doc/uid/TP40004365-CH5-SW3\r\n\r\n// https://pdfs.semanticscholar.org/8887/25b82b8dbb45dd4dd69b36a65f092864adb0.pdf\r\n\r\n// \"<audio src='non_existing_file.au'>File could not be played.</audio>\"\r\n\r\n// \"I am now <prosody rate='+0.06'>speaking 6% faster.</prosody>\"\r\n\r\nconst PRONUNCIATION = {\r\n    '\\\\alpha': 'alpha ',\r\n    '\\\\mu': 'mew ',\r\n    '\\\\sigma': 'sigma ',\r\n    '\\\\pi': 'pie ',\r\n    '\\\\imaginaryI': 'eye ',\r\n\r\n    '\\\\sum': 'Summation ',\r\n    '\\\\prod': 'Product ',\r\n\r\n    a: '<phoneme alphabet=\"ipa\" ph=\"e\">a</phoneme>',\r\n    A: 'capital <phoneme alphabet=\"ipa\" ph=\"e\">A</phoneme>',\r\n    '+': 'plus ',\r\n    '-': 'minus ',\r\n    ';': '<break time=\"150ms\"/> semi-colon <break time=\"150ms\"/>',\r\n    ',': '<break time=\"150ms\"/> comma  <break time=\"150ms\"/>',\r\n    '|': '<break time=\"150ms\"/>Vertical bar<break time=\"150ms\"/>',\r\n    '(': '<break time=\"150ms\"/>Open paren. <break time=\"150ms\"/>',\r\n    ')': '<break time=\"150ms\"/> Close paren. <break time=\"150ms\"/>',\r\n    '=': 'equals ',\r\n    '<': 'is less than ',\r\n    '\\\\lt': 'is less than ',\r\n    '<=': 'is less than or equal to ',\r\n    '\\\\le': 'is less than or equal to ',\r\n    '\\\\gt': 'is greater than ',\r\n    '>': 'is greater than ',\r\n    '\\\\ge': 'is greater than or equal to ',\r\n    '\\\\geq': 'is greater than or equal to ',\r\n    '\\\\leq': 'is less than or equal to ',\r\n    '!': 'factorial ',\r\n    '\\\\sin': 'sine ',\r\n    '\\\\cos': 'cosine ',\r\n    '\\u200b': '',\r\n    '\\u2212': 'minus ',\r\n    ':': '<break time=\"150ms\"/> such that <break time=\"200ms\"/> ',\r\n    '\\\\colon': '<break time=\"150ms\"/> such that <break time=\"200ms\"/> ',\r\n    '\\\\hbar': 'etch bar ',\r\n    '\\\\iff': '<break time=\"200ms\"/>if, and only if, <break time=\"200ms\"/>',\r\n    '\\\\Longleftrightarrow':\r\n        '<break time=\"200ms\"/>if, and only if, <break time=\"200ms\"/>',\r\n    '\\\\land': 'and ',\r\n    '\\\\lor': 'or ',\r\n    '\\\\neg': 'not ',\r\n    '\\\\div': 'divided by ',\r\n\r\n    '\\\\forall': 'for all ',\r\n    '\\\\exists': 'there exists ',\r\n    '\\\\nexists': 'there does not exists ',\r\n\r\n    '\\\\in': 'element of ',\r\n\r\n    '\\\\N':\r\n        'the set <break time=\"150ms\"/><say-as interpret-as=\"character\">n</say-as>',\r\n    '\\\\C':\r\n        'the set <break time=\"150ms\"/><say-as interpret-as=\"character\">c</say-as>',\r\n    '\\\\Z':\r\n        'the set <break time=\"150ms\"/><say-as interpret-as=\"character\">z</say-as>',\r\n    '\\\\Q':\r\n        'the set <break time=\"150ms\"/><say-as interpret-as=\"character\">q</say-as>',\r\n\r\n    '\\\\infty': 'infinity ',\r\n\r\n    '\\\\nabla': 'nabla ',\r\n\r\n    '\\\\partial': 'partial derivative of ',\r\n\r\n    '\\\\cdots': 'dot dot dot ',\r\n\r\n    '\\\\Rightarrow': 'implies ',\r\n\r\n    '\\\\lbrace': '<break time=\"150ms\"/>open brace<break time=\"150ms\"/>',\r\n    '\\\\{': '<break time=\"150ms\"/>open brace<break time=\"150ms\"/>',\r\n    '\\\\rbrace': '<break time=\"150ms\"/>close brace<break time=\"150ms\"/>',\r\n    '\\\\}': '<break time=\"150ms\"/>close brace<break time=\"150ms\"/>',\r\n    '\\\\langle': '<break time=\"150ms\"/>left angle bracket<break time=\"150ms\"/>',\r\n    '\\\\rangle': '<break time=\"150ms\"/>right angle bracket<break time=\"150ms\"/>',\r\n    '\\\\lfloor': '<break time=\"150ms\"/>open floor<break time=\"150ms\"/>',\r\n    '\\\\rfloor': '<break time=\"150ms\"/>close floor<break time=\"150ms\"/>',\r\n    '\\\\lceil': '<break time=\"150ms\"/>open ceiling<break time=\"150ms\"/>',\r\n    '\\\\rceil': '<break time=\"150ms\"/>close ceiling<break time=\"150ms\"/>',\r\n    '\\\\vert': '<break time=\"150ms\"/>vertical bar<break time=\"150ms\"/>',\r\n    '\\\\mvert': '<break time=\"150ms\"/>divides<break time=\"150ms\"/>',\r\n    '\\\\lvert': '<break time=\"150ms\"/>left vertical bar<break time=\"150ms\"/>',\r\n    '\\\\rvert': '<break time=\"150ms\"/>right vertical bar<break time=\"150ms\"/>',\r\n    // '\\\\lbrack':\t\t'left bracket',\r\n    // '\\\\rbrack':\t\t'right bracket',\r\n    '\\\\lbrack':\r\n        '<break time=\"150ms\"/> open square bracket <break time=\"150ms\"/>',\r\n    '\\\\rbrack':\r\n        '<break time=\"150ms\"/> close square bracket <break time=\"150ms\"/>',\r\n\r\n    // need to add code to detect singluar/plural. Until then spoken as plural since that is vastly more common\r\n    // note: need to worry about intervening &InvisibleTimes;.\r\n    // note: need to also do this when in numerator of fraction and number preceeds fraction\r\n    // note: need to do this for <msup>\r\n    mm: 'millimeters',\r\n    cm: 'centimeters',\r\n    km: 'kilometers',\r\n    kg: 'kilograms',\r\n};\r\n\r\nfunction getSpokenName(latex: string): string {\r\n    let result = '';\r\n    if (latex.charAt(0) === '\\\\') {\r\n        result = ' ' + latex.replace('\\\\', '') + ' ';\r\n    }\r\n    return result;\r\n}\r\n\r\nfunction platform(p: string): string {\r\n    let result = 'other';\r\n    if (navigator?.platform && navigator?.userAgent) {\r\n        if (/^(mac)/i.test(navigator.platform)) {\r\n            result = 'mac';\r\n        } else if (/^(win)/i.test(navigator.platform)) {\r\n            result = 'win';\r\n        } else if (/(android)/i.test(navigator.userAgent)) {\r\n            result = 'android';\r\n        } else if (\r\n            /(iphone)/i.test(navigator.userAgent) ||\r\n            /(ipod)/i.test(navigator.userAgent) ||\r\n            /(ipad)/i.test(navigator.userAgent)\r\n        ) {\r\n            result = 'ios';\r\n        } else if (/\\bCrOS\\b/i.test(navigator.userAgent)) {\r\n            result = 'chromeos';\r\n        }\r\n    }\r\n\r\n    return result === p ? p : '!' + p;\r\n}\r\n\r\nfunction isAtomic(atoms: Atom[]): boolean {\r\n    let count = 0;\r\n    if (isAtomArray(atoms)) {\r\n        for (const atom of atoms) {\r\n            if (atom.type !== 'first') {\r\n                count += 1;\r\n            }\r\n        }\r\n    }\r\n    return count === 1;\r\n}\r\n\r\nfunction atomicID(atoms: Atom[]): string {\r\n    if (isAtomArray(atoms)) {\r\n        for (const atom of atoms) {\r\n            if (atom.type !== 'first' && atom.id) {\r\n                return atom.id.toString();\r\n            }\r\n        }\r\n    }\r\n    return '';\r\n}\r\n\r\nfunction atomicValue(atoms: Atom[]): string {\r\n    let result = '';\r\n    if (isAtomArray(atoms)) {\r\n        for (const atom of atoms) {\r\n            if (atom.type !== 'first' && typeof atom.value === 'string') {\r\n                result += atom.value;\r\n            }\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\nfunction atomToSpeakableFragment(\r\n    mode: 'text' | 'math',\r\n    atom: Atom | Atom[],\r\n    options: TextToSpeechOptions\r\n): string {\r\n    function letter(c: string): string {\r\n        let result = '';\r\n        if (!options.textToSpeechMarkup) {\r\n            if (/[a-z]/.test(c)) {\r\n                result += \" '\" + c.toUpperCase() + \"'\";\r\n            } else if (/[A-Z]/.test(c)) {\r\n                result += \" 'capital \" + c.toUpperCase() + \"'\";\r\n            } else {\r\n                result += c;\r\n            }\r\n        } else {\r\n            if (/[a-z]/.test(c)) {\r\n                result +=\r\n                    ' <say-as interpret-as=\"character\">' + c + '</say-as>';\r\n            } else if (/[A-Z]/.test(c)) {\r\n                result += String('capital ' + c.toLowerCase());\r\n            } else {\r\n                result += c;\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    function emph(s: string): string {\r\n        return '<emphasis>' + s + '</emphasis>';\r\n    }\r\n\r\n    if (!atom) return '';\r\n\r\n    let result = '';\r\n\r\n    if (isAtomArray(atom)) {\r\n        let isInDigitRun = false; // need to group sequence of digits\r\n        let isInTextRun = false; // need to group text\r\n        for (let i = 0; i < atom.length; i++) {\r\n            if (atom[i].mode !== 'text') {\r\n                isInTextRun = false;\r\n            }\r\n            if (\r\n                i < atom.length - 2 &&\r\n                atom[i].type === 'mopen' &&\r\n                atom[i + 2].type === 'mclose' &&\r\n                atom[i + 1].type === 'mord'\r\n            ) {\r\n                result += ' of ';\r\n                result += emph(\r\n                    atomToSpeakableFragment(mode, atom[i + 1], options)\r\n                );\r\n                i += 2;\r\n            } else if (atom[i].mode === 'text') {\r\n                if (isInTextRun) {\r\n                    result += atom[i].value ?? ' ';\r\n                } else {\r\n                    isInTextRun = true;\r\n                    result += atomToSpeakableFragment('text', atom[i], options);\r\n                }\r\n                // '.' and ',' should only be allowed if prev/next entry is a digit\r\n                // However, if that isn't the case, this still works because 'toSpeakableFragment' is called in either case.\r\n                // Note: the first char in a digit/text run potentially needs to have a 'mark', hence the call to 'toSpeakableFragment'\r\n            } else if (\r\n                atom[i].type === 'mord' &&\r\n                /[0123456789,.]/.test(atom[i].value)\r\n            ) {\r\n                if (isInDigitRun) {\r\n                    result += atom[i].value;\r\n                } else {\r\n                    isInDigitRun = true;\r\n                    result += atomToSpeakableFragment(mode, atom[i], options);\r\n                }\r\n            } else {\r\n                isInDigitRun = false;\r\n                result += atomToSpeakableFragment(mode, atom[i], options);\r\n            }\r\n        }\r\n    } else if (atom.mode === 'text') {\r\n        if (atom.id && mode === 'math') {\r\n            result += '<mark name=\"' + atom.id.toString() + '\"/>';\r\n        }\r\n        result += atom.value;\r\n    } else {\r\n        if (atom.id && mode === 'math') {\r\n            result += '<mark name=\"' + atom.id.toString() + '\"/>';\r\n        }\r\n        let numer = '';\r\n        let denom = '';\r\n        let body = '';\r\n        let supsubHandled = false;\r\n        switch (atom.type) {\r\n            case 'group':\r\n            case 'root':\r\n                result += atomToSpeakableFragment('math', atom.body, options);\r\n                break;\r\n\r\n            case 'genfrac':\r\n                numer = atomToSpeakableFragment('math', atom.above, options);\r\n                denom = atomToSpeakableFragment('math', atom.below, options);\r\n                if (isAtomic(atom.above) && isAtomic(atom.below)) {\r\n                    const COMMON_FRACTIONS = {\r\n                        '1/2': ' half ',\r\n                        '1/3': ' one third ',\r\n                        '2/3': ' two third',\r\n                        '1/4': ' one quarter ',\r\n                        '3/4': ' three quarter ',\r\n                        '1/5': ' one fifth ',\r\n                        '2/5': ' two fifths ',\r\n                        '3/5': ' three fifths ',\r\n                        '4/5': ' four fifths ',\r\n                        '1/6': ' one sixth ',\r\n                        '5/6': ' five sixths ',\r\n                        '1/8': ' one eight ',\r\n                        '3/8': ' three eights ',\r\n                        '5/8': ' five eights ',\r\n                        '7/8': ' seven eights ',\r\n                        '1/9': ' one ninth ',\r\n                        '2/9': ' two ninths ',\r\n                        '4/9': ' four ninths ',\r\n                        '5/9': ' five ninths ',\r\n                        '7/9': ' seven ninths ',\r\n                        '8/9': ' eight ninths ',\r\n                        // '1/10':     ' one tenth ',\r\n                        // '1/12':     ' one twelfth ',\r\n                        // 'x/2':     ' <say-as interpret-as=\"character\">X</say-as> over 2',\r\n                    };\r\n                    const commonFraction =\r\n                        COMMON_FRACTIONS[\r\n                            atomicValue(atom.above) +\r\n                                '/' +\r\n                                atomicValue(atom.below)\r\n                        ];\r\n                    if (commonFraction) {\r\n                        result = commonFraction;\r\n                    } else {\r\n                        result += numer + ' over ' + denom;\r\n                    }\r\n                } else {\r\n                    result +=\r\n                        ' the fraction <break time=\"150ms\"/>' +\r\n                        numer +\r\n                        ', over <break time=\"150ms\"/>' +\r\n                        denom +\r\n                        '.<break time=\"150ms\"/> End fraction.<break time=\"150ms\"/>';\r\n                }\r\n\r\n                break;\r\n            case 'surd':\r\n                body = atomToSpeakableFragment('math', atom.body, options);\r\n\r\n                if (atom.hasEmptyBranch('above')) {\r\n                    if (isAtomic(atom.body)) {\r\n                        result += ' the square root of ' + body + ' , ';\r\n                    } else {\r\n                        result +=\r\n                            ' the square root of <break time=\"200ms\"/>' +\r\n                            body +\r\n                            '. <break time=\"200ms\"/> End square root';\r\n                    }\r\n                } else {\r\n                    let index = atomToSpeakableFragment(\r\n                        'math',\r\n                        atom.above,\r\n                        options\r\n                    );\r\n                    index = index.trim();\r\n                    const index2 = index.replace(/<mark([^/]*)\\/>/g, '');\r\n                    if (index2 === '3') {\r\n                        result +=\r\n                            ' the cube root of <break time=\"200ms\"/>' +\r\n                            body +\r\n                            '. <break time=\"200ms\"/> End cube root';\r\n                    } else if (index2 === 'n') {\r\n                        result +=\r\n                            ' the nth root of <break time=\"200ms\"/>' +\r\n                            body +\r\n                            '. <break time=\"200ms\"/> End root';\r\n                    } else {\r\n                        result +=\r\n                            ' the root with index: <break time=\"200ms\"/>' +\r\n                            index +\r\n                            ', of <break time=\"200ms\"/>' +\r\n                            body +\r\n                            '. <break time=\"200ms\"/> End root';\r\n                    }\r\n                }\r\n                break;\r\n            case 'leftright':\r\n                {\r\n                    const delimAtom = atom as LeftRightAtom;\r\n                    result +=\r\n                        PRONUNCIATION[delimAtom.leftDelim] ||\r\n                        delimAtom.leftDelim;\r\n                    result += atomToSpeakableFragment(\r\n                        'math',\r\n                        atom.body,\r\n                        options\r\n                    );\r\n                    result +=\r\n                        PRONUNCIATION[delimAtom.rightDelim] ||\r\n                        delimAtom.rightDelim;\r\n                }\r\n                break;\r\n            case 'rule':\r\n                // @todo\r\n                break;\r\n            case 'overunder':\r\n                // @todo\r\n                break;\r\n            case 'overlap':\r\n                // @todo\r\n                break;\r\n            case 'placeholder':\r\n                result += 'placeholder ';\r\n                break;\r\n            case 'delim':\r\n            case 'sizeddelim':\r\n            case 'mord':\r\n            case 'minner':\r\n            case 'mbin':\r\n            case 'mrel':\r\n            case 'mpunct':\r\n            case 'mopen':\r\n            case 'mclose':\r\n            case 'textord': {\r\n                const command = atom.command;\r\n                if (\r\n                    command === '\\\\mathbin' ||\r\n                    command === '\\\\mathrel' ||\r\n                    command === '\\\\mathopen' ||\r\n                    command === '\\\\mathclose' ||\r\n                    command === '\\\\mathpunct' ||\r\n                    command === '\\\\mathord' ||\r\n                    command === '\\\\mathinner'\r\n                ) {\r\n                    result = atomToSpeakableFragment(mode, atom.body, options);\r\n                    break;\r\n                }\r\n\r\n                let atomValue = atom.value;\r\n                let latexValue = atom.command;\r\n                if (atom.type === 'delim' || atom.type === 'sizeddelim') {\r\n                    atomValue = latexValue = atom.value;\r\n                }\r\n                if (mode === 'text') {\r\n                    result += atomValue;\r\n                } else {\r\n                    if (atom.type === 'mbin') {\r\n                        result += '<break time=\"150ms\"/>';\r\n                    }\r\n\r\n                    if (atomValue) {\r\n                        const value =\r\n                            PRONUNCIATION[atomValue] ||\r\n                            (latexValue\r\n                                ? PRONUNCIATION[latexValue.trim()]\r\n                                : '');\r\n                        if (value) {\r\n                            result += ' ' + value;\r\n                        } else {\r\n                            const spokenName = latexValue\r\n                                ? getSpokenName(latexValue.trim())\r\n                                : '';\r\n\r\n                            result += spokenName\r\n                                ? spokenName\r\n                                : letter(atomValue);\r\n                        }\r\n                    } else {\r\n                        result += atomToSpeakableFragment(\r\n                            'math',\r\n                            atom.body,\r\n                            options\r\n                        );\r\n                    }\r\n                    if (atom.type === 'mbin') {\r\n                        result += '<break time=\"150ms\"/>';\r\n                    }\r\n                }\r\n                break;\r\n            }\r\n            case 'mop':\r\n                // @todo\r\n                if (atom.value !== '\\u200b') {\r\n                    // Not ZERO-WIDTH\r\n                    const trimLatex = atom.command;\r\n                    if (trimLatex === '\\\\sum') {\r\n                        if (\r\n                            !atom.hasEmptyBranch('superscript') &&\r\n                            !atom.hasEmptyBranch('subscript')\r\n                        ) {\r\n                            let sup = atomToSpeakableFragment(\r\n                                'math',\r\n                                atom.superscript,\r\n                                options\r\n                            );\r\n                            sup = sup.trim();\r\n                            let sub = atomToSpeakableFragment(\r\n                                'math',\r\n                                atom.subscript,\r\n                                options\r\n                            );\r\n                            sub = sub.trim();\r\n                            result +=\r\n                                ' the summation from <break time=\"200ms\"/>' +\r\n                                sub +\r\n                                '<break time=\"200ms\"/> to  <break time=\"200ms\"/>' +\r\n                                sup +\r\n                                '<break time=\"200ms\"/> of <break time=\"150ms\"/>';\r\n                            supsubHandled = true;\r\n                        } else if (!atom.hasEmptyBranch('subscript')) {\r\n                            let sub = atomToSpeakableFragment(\r\n                                'math',\r\n                                atom.subscript,\r\n                                options\r\n                            );\r\n                            sub = sub.trim();\r\n                            result +=\r\n                                ' the summation from <break time=\"200ms\"/>' +\r\n                                sub +\r\n                                '<break time=\"200ms\"/> of <break time=\"150ms\"/>';\r\n                            supsubHandled = true;\r\n                        } else {\r\n                            result += ' the summation of';\r\n                        }\r\n                    } else if (trimLatex === '\\\\prod') {\r\n                        if (\r\n                            !atom.hasEmptyBranch('superscript') &&\r\n                            !atom.hasEmptyBranch('subscript')\r\n                        ) {\r\n                            let sup = atomToSpeakableFragment(\r\n                                'math',\r\n                                atom.superscript,\r\n                                options\r\n                            );\r\n                            sup = sup.trim();\r\n                            let sub = atomToSpeakableFragment(\r\n                                'math',\r\n                                atom.subscript,\r\n                                options\r\n                            );\r\n                            sub = sub.trim();\r\n                            result +=\r\n                                ' the product from <break time=\"200ms\"/>' +\r\n                                sub +\r\n                                '<break time=\"200ms\"/> to <break time=\"200ms\"/>' +\r\n                                sup +\r\n                                '<break time=\"200ms\"/> of <break time=\"150ms\"/>';\r\n                            supsubHandled = true;\r\n                        } else if (!atom.hasEmptyBranch('subscript')) {\r\n                            let sub = atomToSpeakableFragment(\r\n                                'math',\r\n                                atom.subscript,\r\n                                options\r\n                            );\r\n                            sub = sub.trim();\r\n                            result +=\r\n                                ' the product from <break time=\"200ms\"/>' +\r\n                                sub +\r\n                                '<break time=\"200ms\"/> of <break time=\"150ms\"/>';\r\n                            supsubHandled = true;\r\n                        } else {\r\n                            result += ' the product  of ';\r\n                        }\r\n                    } else if (trimLatex === '\\\\int') {\r\n                        if (\r\n                            !atom.hasEmptyBranch('superscript') &&\r\n                            !atom.hasEmptyBranch('subscript')\r\n                        ) {\r\n                            let sup = atomToSpeakableFragment(\r\n                                'math',\r\n                                atom.superscript,\r\n                                options\r\n                            );\r\n                            sup = sup.trim();\r\n                            let sub = atomToSpeakableFragment(\r\n                                'math',\r\n                                atom.subscript,\r\n                                options\r\n                            );\r\n                            sub = sub.trim();\r\n                            result +=\r\n                                ' the integral from <break time=\"200ms\"/>' +\r\n                                emph(sub) +\r\n                                '<break time=\"200ms\"/> to <break time=\"200ms\"/>' +\r\n                                emph(sup) +\r\n                                ' <break time=\"200ms\"/> of ';\r\n                            supsubHandled = true;\r\n                        } else {\r\n                            result += ' the integral of <break time=\"200ms\"/> ';\r\n                        }\r\n                    } else if (typeof atom.value === 'string') {\r\n                        const value =\r\n                            PRONUNCIATION[atom.value] ??\r\n                            PRONUNCIATION[atom.command];\r\n                        if (value) {\r\n                            result += value;\r\n                        } else {\r\n                            result += ' ' + atom.value;\r\n                        }\r\n                    } else if (atom.command) {\r\n                        if (atom.command[0] === '\\\\') {\r\n                            result += ' ' + atom.command.substr(1);\r\n                        } else {\r\n                            result += ' ' + atom.command;\r\n                        }\r\n                    }\r\n                }\r\n                break;\r\n\r\n            case 'enclose':\r\n                body = atomToSpeakableFragment('math', atom.body, options);\r\n\r\n                if (isAtomic(atom.body)) {\r\n                    result += ' crossed out ' + body + ' , ';\r\n                } else {\r\n                    result += ' crossed out ' + body + '. End cross out';\r\n                }\r\n                break;\r\n\r\n            case 'space':\r\n            case 'spacing':\r\n                // @todo\r\n                break;\r\n        }\r\n        if (!supsubHandled && !atom.hasEmptyBranch('superscript')) {\r\n            let sup = atomToSpeakableFragment(mode, atom.superscript, options);\r\n            sup = sup.trim();\r\n            const sup2 = sup.replace(/<[^>]*>/g, '');\r\n            if (isAtomic(atom.superscript)) {\r\n                if (mode === 'math') {\r\n                    const id = atomicID(atom.superscript);\r\n                    if (id) {\r\n                        result += '<mark name=\"' + id + '\"/>';\r\n                    }\r\n                }\r\n                if (sup2 === '\\u2032') {\r\n                    result += ' prime ';\r\n                } else if (sup2 === '2') {\r\n                    result += ' squared ';\r\n                } else if (sup2 === '3') {\r\n                    result += ' cubed ';\r\n                } else if (isNaN(parseInt(sup2))) {\r\n                    result += ' to the ' + sup + '; ';\r\n                } else {\r\n                    result +=\r\n                        ' to the <say-as interpret-as=\"ordinal\">' +\r\n                        sup2 +\r\n                        '</say-as> power; ';\r\n                }\r\n            } else {\r\n                if (isNaN(parseInt(sup2))) {\r\n                    result += ' raised to the ' + sup + '; ';\r\n                } else {\r\n                    result +=\r\n                        ' raised to the <say-as interpret-as=\"ordinal\">' +\r\n                        sup2 +\r\n                        '</say-as> power; ';\r\n                }\r\n            }\r\n        }\r\n        if (!supsubHandled && !atom.hasEmptyBranch('subscript')) {\r\n            let sub = atomToSpeakableFragment('math', atom.subscript, options);\r\n            sub = sub.trim();\r\n            if (isAtomic(atom.subscript)) {\r\n                result += ' sub ' + sub;\r\n            } else {\r\n                result += ' subscript ' + sub + '. End subscript. ';\r\n            }\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n/**\r\n * @param  atoms The atoms to represent as speakable text.\r\n */\r\nexport function atomToSpeakableText(\r\n    atoms: Atom | Atom[],\r\n    speechOptions: TextToSpeechOptions\r\n): string {\r\n    const options = {\r\n        ...speechOptions,\r\n        textToSpeechRulesOptions: { ...speechOptions.textToSpeechRulesOptions },\r\n    };\r\n\r\n    if (window['sre'] && options.textToSpeechRules === 'sre') {\r\n        const mathML = atomsToMathML(atoms, options);\r\n        if (mathML) {\r\n            if (options.textToSpeechMarkup) {\r\n                options.textToSpeechRulesOptions =\r\n                    options.textToSpeechRulesOptions ?? {};\r\n                options.textToSpeechRulesOptions.markup =\r\n                    options.textToSpeechMarkup;\r\n                if (options.textToSpeechRulesOptions.markup === 'ssml') {\r\n                    options.textToSpeechRulesOptions.markup = 'ssml_step';\r\n                }\r\n                options.textToSpeechRulesOptions.rate =\r\n                    options.speechEngineRate;\r\n            }\r\n            if (options.textToSpeechRulesOptions) {\r\n                window['sre'].System.getInstance().setupEngine(\r\n                    options.textToSpeechRulesOptions\r\n                );\r\n            }\r\n            return window['sre'].System.getInstance().toSpeech(mathML);\r\n        }\r\n        return '';\r\n    }\r\n\r\n    let result = atomToSpeakableFragment('math', atoms, options);\r\n\r\n    if (options.textToSpeechMarkup === 'ssml') {\r\n        let prosody = '';\r\n        if (options.speechEngineRate) {\r\n            prosody = '<prosody rate=\"' + options.speechEngineRate + '\">';\r\n        }\r\n        result =\r\n            `<?xml version=\"1.0\"?><speak version=\"1.1\" xmlns=\"http://www.w3.org/2001/10/synthesis\" xml:lang=\"en-US\">` +\r\n            '<amazon:auto-breaths>' +\r\n            prosody +\r\n            '<p><s>' +\r\n            result +\r\n            '</s></p>' +\r\n            (prosody ? '</prosody>' : '') +\r\n            '</amazon:auto-breaths>' +\r\n            '</speak>';\r\n    } else if (\r\n        options.textToSpeechMarkup === 'mac' &&\r\n        platform('mac') === 'mac'\r\n    ) {\r\n        // Convert SSML to Mac markup\r\n        result = result\r\n            .replace(/<mark([^/]*)\\/>/g, '')\r\n            .replace(/<emphasis>/g, '[[emph+]]')\r\n            .replace(/<\\/emphasis>/g, '')\r\n            .replace(/<break time=\"([0-9]*)ms\"\\/>/g, '[[slc $1]]')\r\n            .replace(/<say-as[^>]*>/g, '')\r\n            .replace(/<\\/say-as>/g, '');\r\n    } else {\r\n        // If no markup was requested, or 'mac' markup, but we're not on a mac,\r\n        // remove any that we may have\r\n        // Strip out the SSML markup\r\n        result = result.replace(/<[^>]*>/g, '').replace(/\\s{2,}/g, ' ');\r\n    }\r\n    return result;\r\n}\r\n","import type {\r\n    ErrorListener,\r\n    ParserErrorCode,\r\n    MathfieldErrorCode,\r\n} from '../public/core';\r\nimport { ModelPrivate } from './model-private';\r\n\r\nexport type ModelListeners = {\r\n    onContentWillChange: (sender: ModelPrivate) => void;\r\n    onContentDidChange: (sender: ModelPrivate) => void;\r\n    onSelectionWillChange: (sender: ModelPrivate) => void;\r\n    onSelectionDidChange: (sender: ModelPrivate) => void;\r\n    onError: ErrorListener<ParserErrorCode | MathfieldErrorCode>;\r\n};\r\n\r\nexport function selectionDidChange(model: ModelPrivate): void {\r\n    if (\r\n        typeof model.listeners?.onSelectionDidChange === 'function' &&\r\n        !model.suppressChangeNotifications\r\n    ) {\r\n        model.listeners.onSelectionDidChange(model);\r\n    }\r\n}\r\n\r\nexport function contentDidChange(model: ModelPrivate): void {\r\n    if (\r\n        typeof model.listeners?.onContentDidChange === 'function' &&\r\n        !model.suppressChangeNotifications\r\n    ) {\r\n        model.listeners.onContentDidChange(model);\r\n    }\r\n}\r\n\r\n//////\r\n\r\nexport interface Disposable {\r\n    dispose(): void;\r\n}\r\n\r\nexport type EventListener = (...payload: any[]) => void;\r\n\r\nexport class EventEmitter {\r\n    events: Map<string, EventListener[]>;\r\n\r\n    constructor() {\r\n        this.events = new Map();\r\n    }\r\n\r\n    addListener(\r\n        event: string,\r\n        listener: EventListener,\r\n        options?: { once?: boolean }\r\n    ): Disposable {\r\n        if (!this.events.has(event)) {\r\n            this.events.set(event, []);\r\n        }\r\n        options = options ?? {};\r\n        if (options.once ?? false) {\r\n            listener = (...payload: any[]): void => {\r\n                this.events.get(event).filter((x) => x !== listener);\r\n                listener.apply(this, ...payload);\r\n            };\r\n        }\r\n\r\n        this.events.get(event).push(listener);\r\n        return {\r\n            dispose: (): void => {\r\n                this.events.set(\r\n                    event,\r\n                    this.events.get(event).filter((x) => x !== listener)\r\n                );\r\n            },\r\n        };\r\n    }\r\n\r\n    on(event: string, listener: EventListener): Disposable {\r\n        return this.addListener(event, listener);\r\n    }\r\n\r\n    once(event: string, listener: EventListener): Disposable {\r\n        return this.addListener(event, listener, { once: true });\r\n    }\r\n\r\n    emit(event: string, ...payload: any[]): boolean {\r\n        const listeners = this.events.get(event);\r\n        if (listeners && listeners.length > 0) {\r\n            listeners.forEach((listener) => {\r\n                listener.apply(this, ...payload);\r\n            });\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n}\r\n\r\n/*\r\n// type User = { name: string };\r\n\r\n// interface UserEvents {\r\n//     login(user: User): void;\r\n//     logout(): string;\r\n// }\r\n\r\ntype Filter<T, Cond, U extends keyof T = keyof T> = {\r\n    [K in U]: T[K] extends Cond ? K : never;\r\n}[U];\r\n\r\ntype In<T> = T extends (...args: infer U) => any ? U : [];\r\ntype Out<T> = T extends () => infer U ? U : never;\r\n\r\n// Extract an array type of valid event keys\r\ntype EventKey<T> = Filter<T, Function> & string;\r\n\r\n// Extract the argument/return types of a valid event\r\ntype Arguments<T> = T extends (...args: infer U) => any ? U : [];\r\ntype Result<T> = T extends () => infer U ? U : never;\r\n\r\ntype EventIn<T, K extends EventKey<T>> = In<T[K]>;\r\ntype EventOut<T, K extends EventKey<T>> = Out<T[K]> | void;\r\n\r\nexport type Listener<T, K extends EventKey<T> = EventKey<T>> = (\r\n    ...args: EventIn<T, K>\r\n) => EventOut<T, K>;\r\n\r\nexport type ListenerMap<T> = Partial<{ [K in EventKey<T>]: Listener<T, K> }>;\r\n\r\ninterface Emitter<T> {\r\n    on<K extends EventKey<T>>(key: K, fn: Listener<T, K>): typeof fn;\r\n}\r\n\r\n// import { EventEmitter } from 'events';\r\n// const ee = (new EventEmitter() as unknown) as Emitter<UserEvents>;\r\n\r\n// ee.on('login', (user: string) => {});\r\n// ee.on('logout', () => {\r\n//     return 'done';\r\n// });\r\n*/\r\n","import { Range, Selection } from '../public/mathfield';\n\nexport function compareSelection(\n    a: Selection,\n    b: Selection\n): 'equal' | 'different' {\n    if (a.direction === b.direction) {\n        const l = a.ranges.length;\n        if (b.ranges.length === l) {\n            let i = 0;\n            while (\n                i < l &&\n                compareRange(a.ranges[i], b.ranges[i]) === 'equal'\n            ) {\n                i++;\n            }\n            return i === l ? 'equal' : 'different';\n        }\n    }\n    return 'different';\n}\n\nfunction compareRange(a: Range, b: Range): 'equal' | 'different' {\n    if (a[0] === b[0] && a[1] === b[1]) return 'equal';\n    return 'different';\n}\n\n/**\n * Return the smallest and largest offsets in a selection\n */\nexport function range(selection: Selection): Range {\n    let first = Infinity;\n    let last = -Infinity;\n    selection.ranges.forEach((x) => {\n        first = Math.min(first, x[0], x[1]);\n        last = Math.max(last, x[0], x[1]);\n    });\n    return [first, last];\n}\n","import type {\r\n    Model,\r\n    Mathfield,\r\n    Offset,\r\n    Range,\r\n    Selection,\r\n    OutputFormat,\r\n} from '../public/mathfield';\r\n\r\nimport type { MathfieldPrivate } from '../editor-mathfield/mathfield-private';\r\n\r\nimport { Atom, Branch, ToLatexOptions } from '../core/atom-class';\r\nimport { joinLatex } from '../core/tokenizer';\r\n\r\nimport { atomtoMathJson } from '../addons/math-json';\r\nimport { atomsToMathML } from '../addons/math-ml';\r\n\r\nimport { atomToAsciiMath } from '../editor/atom-to-ascii-math';\r\nimport { atomToSpeakableText } from '../editor/atom-to-speakable-text';\r\n\r\nimport {\r\n    contentDidChange,\r\n    ModelListeners,\r\n    selectionDidChange,\r\n} from './listeners';\r\nimport {\r\n    ModelOptions,\r\n    ModelHooks,\r\n    isOffset,\r\n    isSelection,\r\n    isRange,\r\n} from './utils';\r\nimport { compareSelection, range } from './selection-utils';\r\n\r\nexport type GetAtomOptions = {\r\n    includeChildren?: boolean;\r\n};\r\n\r\nexport class ModelPrivate implements Model {\r\n    readonly mathfield: MathfieldPrivate;\r\n    readonly options: ModelOptions;\r\n    listeners: ModelListeners;\r\n    hooks: Required<ModelHooks>;\r\n\r\n    root: Atom;\r\n\r\n    private _atoms: Atom[];\r\n    private _selection: Selection;\r\n    private _anchor: Offset;\r\n    private _position: Offset;\r\n\r\n    suppressChangeNotifications: boolean;\r\n\r\n    constructor(\r\n        options?: ModelOptions,\r\n        listeners?: ModelListeners,\r\n        hooks?: ModelHooks,\r\n        target?: Mathfield\r\n    ) {\r\n        this.options = {\r\n            mode: 'math',\r\n            removeExtraneousParentheses: false,\r\n            ...options,\r\n        };\r\n        this.root = new Atom('root', { mode: this.options.mode });\r\n        this.root.body = [];\r\n        this._atoms = null;\r\n        this._selection = { ranges: [[0, 0]], direction: 'none' };\r\n        this._anchor = 0;\r\n        this._position = 0;\r\n\r\n        this.setListeners(listeners);\r\n        this.setHooks(hooks);\r\n        this.mathfield = target as MathfieldPrivate;\r\n\r\n        this.suppressChangeNotifications = false;\r\n    }\r\n\r\n    get atoms(): Atom[] {\r\n        // The root is dirty when there has been some strucural changes\r\n        // (adding/removing atoms) which would invalidate the iterator\r\n        if (!this._atoms || this.root.isDirty) {\r\n            this._atoms = this.root.children;\r\n            this.root.isDirty = false;\r\n        }\r\n        return this._atoms;\r\n    }\r\n\r\n    /**\r\n     * The selection, accounting for the common ancestors\r\n     */\r\n    get selection(): Selection {\r\n        return this._selection;\r\n    }\r\n    set selection(value: Selection) {\r\n        this.setSelection(value);\r\n    }\r\n\r\n    setSelection(from: Offset, to: Offset): boolean;\r\n    setSelection(range: Range): boolean;\r\n    setSelection(selection: Selection): boolean;\r\n    setSelection(arg1: Offset | Range | Selection, arg2?: Offset): boolean {\r\n        return this.deferNotifications({ selection: true }, () => {\r\n            //\r\n            // 1/ Normalize the input\r\n            // (account for offset < 0, etc...)\r\n            //\r\n            const value = this.normalizeSelection(arg1, arg2);\r\n\r\n            if (typeof value === 'undefined') {\r\n                throw Error('Invalid selection');\r\n            }\r\n\r\n            //\r\n            // 2/ Short-circuit a common case...\r\n            //\r\n            if (\r\n                value.ranges.length === 1 &&\r\n                value.ranges[0][0] === value.ranges[0][1]\r\n            ) {\r\n                const pos = value.ranges[0][0];\r\n                this._position = pos;\r\n                this._anchor = pos;\r\n                this._selection = value;\r\n            } else {\r\n                //\r\n                // 2b/ Determine the anchor and position\r\n                // (smallest, largest offsets, oriented as per `direction`)\r\n                //\r\n                const selRange = range(value);\r\n                if (value.direction === 'backward') {\r\n                    [this._position, this._anchor] = selRange;\r\n                } else {\r\n                    [this._anchor, this._position] = selRange;\r\n                }\r\n                const first = this.at(selRange[0]);\r\n                const last = this.at(selRange[1]);\r\n\r\n                const commonAncestor = Atom.commonAncestor(first, last);\r\n                if (\r\n                    commonAncestor?.type === 'array' &&\r\n                    first.parent === commonAncestor &&\r\n                    last.parent === commonAncestor\r\n                ) {\r\n                    // 3a/ If the parent of all the ranges is an array...\r\n                    // Make a rectangular selection based on the col/row of the anchor\r\n                    // and cursor\r\n                    // @todo array\r\n                } else {\r\n                    // 3b/ Otherwise, account for the common ancestor\r\n\r\n                    // 3b.1/ Go up from the anchor until we reach the common ancestor\r\n                    // if (first.parent !== commonAncestor) {\r\n                    //     while (first.parent !== commonAncestor) {\r\n                    //         first = first.parent;\r\n                    //     }\r\n                    //     first = first.leftSibling;\r\n                    // }\r\n\r\n                    // 3b.2/ Go up from the cursor until we reach the common ancestor\r\n                    // while (last.parent !== commonAncestor) {\r\n                    //     last = last.parent;\r\n                    // }\r\n\r\n                    this._selection = {\r\n                        ranges: [[this.offsetOf(first), this.offsetOf(last)]],\r\n                        direction: value.direction,\r\n                    };\r\n                    // 3b.3/ Adjust the position to match the selection\r\n                    if (value.direction === 'backward') {\r\n                        this._position = this._selection.ranges[0][0];\r\n                    } else {\r\n                        this._position = this._selection.ranges[0][1];\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * The \"focus\" or \"cursor\" (i.e. not the anchor) a.k.a the insertion point\r\n     * or caret: where things are going to be inserted next.\r\n     *\r\n     */\r\n    get position(): Offset {\r\n        return this._position;\r\n    }\r\n    set position(value: Offset) {\r\n        this.setSelection(value, value);\r\n    }\r\n    /**\r\n     * The offset from which the selection is extended\r\n     */\r\n    get anchor(): Offset {\r\n        return this._anchor;\r\n    }\r\n\r\n    get selectionIsCollapsed(): boolean {\r\n        return this._anchor === this._position;\r\n    }\r\n\r\n    get selectionIsPlaceholder(): boolean {\r\n        if (Math.abs(this._anchor - this._position) === 1) {\r\n            return (\r\n                this.at(Math.max(this._anchor, this._position)).type ===\r\n                'placeholder'\r\n            );\r\n        }\r\n        return false;\r\n    }\r\n    collapseSelection(direction: 'forward' | 'backward' = 'forward'): boolean {\r\n        if (this._anchor === this._position) return false;\r\n        if (direction === 'backward') {\r\n            this.position = Math.min(this._anchor, this._position);\r\n        } else {\r\n            this.position = Math.max(this._anchor, this._position);\r\n        }\r\n        return true;\r\n    }\r\n\r\n    get lastOffset(): Offset {\r\n        return this.atoms.length - 1;\r\n    }\r\n\r\n    at(index: number): Atom {\r\n        return this.atoms[index];\r\n    }\r\n    offsetOf(atom: Atom): Offset {\r\n        return this.atoms.indexOf(atom);\r\n    }\r\n\r\n    getSiblingsRange(offset: Offset): Range {\r\n        const atom: Atom = this.at(offset);\r\n        const parent = atom.parent;\r\n        if (!parent) return [0, this.lastOffset];\r\n        const branch = atom.parent.branch(atom.treeBranch);\r\n        return [\r\n            this.offsetOf(branch[0]),\r\n            this.offsetOf(branch[branch.length - 1]),\r\n        ];\r\n    }\r\n    getBranchRange(offset: Offset, branchName: Branch): Range {\r\n        const branch = this.at(offset).branch(branchName);\r\n        return [\r\n            this.offsetOf(branch[0]),\r\n            this.offsetOf(branch[branch.length - 1]),\r\n        ];\r\n    }\r\n    // getAtoms([3, 5]) -> atoms 4 and 5\r\n    // getAtoms(3, 5) -> atoms 4 and 5\r\n    // getAtom(3) -> all atoms, starting at 4 till lastOffset, then 0 to 3\r\n    // getAtoms(3, -1) -> all atoms after 3 till lastOffset\r\n    // getAtoms(-5, -2) -> all atoms between lastOffset - 4 and lastOffset - 1\r\n    // Note that an atom with children is included in the result only if\r\n    // all its children are in range.\r\n    getAtoms(arg: Selection, options?: GetAtomOptions): Atom[];\r\n    getAtoms(arg: Range, options?: GetAtomOptions): Atom[];\r\n    getAtoms(from: Offset, to?: Offset, options?: GetAtomOptions): Atom[];\r\n    getAtoms(\r\n        arg1: Selection | Range | Offset,\r\n        arg2?: Offset | GetAtomOptions,\r\n        arg3?: GetAtomOptions\r\n    ): Atom[] {\r\n        let options = arg3 ?? {};\r\n        if (isSelection(arg1)) {\r\n            options = (arg2 as GetAtomOptions) ?? {};\r\n            if (arg1.ranges.length > 1) {\r\n                return arg1.ranges.reduce(\r\n                    (acc: Atom[], range) => [\r\n                        ...acc,\r\n                        ...this.getAtoms(range, options),\r\n                    ],\r\n                    []\r\n                );\r\n            }\r\n            arg1 = arg1.ranges[0];\r\n        }\r\n        let start: number;\r\n        let end: number;\r\n        if (isOffset(arg1)) {\r\n            start = arg1;\r\n            if (!isOffset(arg2)) return [];\r\n            end = arg2;\r\n        } else {\r\n            [start, end] = arg1;\r\n            options = (arg2 as GetAtomOptions) ?? {};\r\n        }\r\n\r\n        if (!isFinite(start)) return [];\r\n\r\n        if (typeof options.includeChildren === 'undefined') {\r\n            options.includeChildren = false;\r\n        }\r\n\r\n        if (start < 0) start = this.lastOffset - start + 1;\r\n        if (end < 0) end = this.lastOffset - end + 1;\r\n        const first = Math.min(start, end) + 1;\r\n        const last = Math.max(start, end);\r\n\r\n        let result: Atom[] = [];\r\n        for (let i = first; i <= last; i++) {\r\n            const atom = this.atoms[i];\r\n            if (atomIsInRange(this, atom, first, last)) {\r\n                result.push(atom);\r\n            }\r\n        }\r\n        if (!options.includeChildren) {\r\n            // Remove any atoms whose ancestor is also included\r\n            result = result.filter((atom) => {\r\n                let ancestorIncluded = false;\r\n                let parent = atom.parent;\r\n                while (parent && !ancestorIncluded) {\r\n                    ancestorIncluded = atomIsInRange(this, parent, first, last);\r\n                    parent = parent.parent;\r\n                }\r\n                return !ancestorIncluded;\r\n            });\r\n        }\r\n\r\n        return result;\r\n    }\r\n    // Unlike `getAtoms()`, the argument here is an index\r\n    // Return all the atoms, in order, starting at startingIndex\r\n    // then looping back at the beginning\r\n    getAllAtoms(startingIndex: number): Atom[] {\r\n        const result: Atom[] = [];\r\n        const last = this.lastOffset;\r\n        for (let i = startingIndex; i <= last; i++) {\r\n            result.push(this.atoms[i]);\r\n        }\r\n        for (let i = 0; i < startingIndex; i++) {\r\n            result.push(this.atoms[i]);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    extractAtoms(range: Range): Atom[] {\r\n        const result = this.getAtoms(range);\r\n        result.forEach((x) => x.parent.removeChild(x));\r\n\r\n        if (isFinite(range[0])) {\r\n            this.position = range[0];\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    deleteAtoms(range: Range): boolean {\r\n        const atoms = this.extractAtoms(range);\r\n        return atoms.length > 0;\r\n    }\r\n\r\n    atomToString(atom: Atom, format: OutputFormat): string {\r\n        format = format ?? 'latex';\r\n        let result = '';\r\n        if (format === 'latex' || format === 'latex-expanded') {\r\n            result = Atom.toLatex(atom, {\r\n                expandMacro: format === 'latex-expanded',\r\n            });\r\n        } else if (format === 'mathML') {\r\n            result = atomsToMathML(atom, this.mathfield.options);\r\n        } else if (format === 'spoken') {\r\n            result = atomToSpeakableText(atom, this.mathfield.options);\r\n        } else if (format === 'spoken-text') {\r\n            const saveTextToSpeechMarkup = this.mathfield.options\r\n                .textToSpeechMarkup;\r\n            this.mathfield.options.textToSpeechMarkup = '';\r\n            result = atomToSpeakableText(atom, this.mathfield.options);\r\n            this.mathfield.options.textToSpeechMarkup = saveTextToSpeechMarkup;\r\n        } else if (\r\n            format === 'spoken-ssml' ||\r\n            format === 'spoken-ssml-withHighlighting'\r\n        ) {\r\n            const saveTextToSpeechMarkup = this.mathfield.options\r\n                .textToSpeechMarkup;\r\n            // const savedAtomIdsSettings = this.config.atomIdsSettings;    // @revisit\r\n            this.mathfield.options.textToSpeechMarkup = 'ssml';\r\n            // if (format === 'spoken-ssml-withHighlighting') {     // @revisit\r\n            //     this.config.atomIdsSettings = { seed: 'random' };\r\n            // }\r\n            result = atomToSpeakableText(atom, this.mathfield.options);\r\n            this.mathfield.options.textToSpeechMarkup = saveTextToSpeechMarkup;\r\n            // this.config.atomIdsSettings = savedAtomIdsSettings;      // @revisit\r\n        } else if (format === 'json') {\r\n            console.log('deprecated format. Use MathJSON');\r\n            const json = atomtoMathJson(atom);\r\n            result = JSON.stringify(json);\r\n        } else if (format === 'json-2') {\r\n            console.log('deprecated format. Use MathJSON');\r\n            const json = atomtoMathJson(atom);\r\n            // const json = parseLatex(root.toLatex(true), {\r\n            //     form: 'canonical',\r\n            // });\r\n            result = JSON.stringify(json, null, 2);\r\n        } else if (format === 'ASCIIMath') {\r\n            result = atomToAsciiMath(atom);\r\n        } else {\r\n            console.warn('Unknown format :', format);\r\n        }\r\n        return result;\r\n    }\r\n    // getValue(): string;\r\n    // getValue(format: OutputFormat): string;\r\n    // getValue(start: Offset, end: Offset, format?: OutputFormat): string;\r\n    // getValue(range: Range, format?: OutputFormat): string;\r\n    // getValue(selection: Selection, format?: OutputFormat): string;\r\n    getValue(\r\n        arg1?: Offset | OutputFormat | Range | Selection,\r\n        arg2?: Offset | OutputFormat,\r\n        arg3?: OutputFormat\r\n    ): string {\r\n        if (typeof arg1 === 'undefined') {\r\n            // getValue()\r\n            return this.atomToString(this.root, 'latex');\r\n        }\r\n        if (typeof arg1 === 'string') {\r\n            // getValue(format): Output format only\r\n            return this.atomToString(this.root, arg1);\r\n        }\r\n        let ranges: Range[];\r\n        let format: OutputFormat;\r\n        if (isOffset(arg1) && isOffset(arg2)) {\r\n            ranges = [this.normalizeRange([arg1, arg2])];\r\n            format = arg3 as OutputFormat;\r\n        } else if (isRange(arg1)) {\r\n            ranges = [this.normalizeRange(arg1)];\r\n            format = arg2 as OutputFormat;\r\n        } else if (isSelection(arg1)) {\r\n            ranges = arg1.ranges;\r\n            format = arg2 as OutputFormat;\r\n        }\r\n        format = format ?? 'latex';\r\n        if (format === 'latex' || format === 'latex-expanded') {\r\n            const options: ToLatexOptions = {\r\n                expandMacro: format === 'latex-expanded',\r\n            };\r\n            return joinLatex(\r\n                ranges.map((range) =>\r\n                    Atom.toLatex(this.getAtoms(range), options)\r\n                )\r\n            );\r\n        }\r\n        return ranges\r\n            .map((range): string =>\r\n                this.getAtoms(range)\r\n                    .map((atom) => this.atomToString(atom, format))\r\n                    .join('')\r\n            )\r\n            .join('');\r\n    }\r\n\r\n    /**\r\n     * Method called in response to a user interaction\r\n     */\r\n    extendSelection(direction: 'forward' | 'backward'): boolean {\r\n        let anchor = this._anchor;\r\n        // Keep the anchor anchored, move the position forward or back\r\n        if (direction === 'forward') {\r\n            let pos = this._position;\r\n            do {\r\n                pos++;\r\n            } while (pos <= this.lastOffset && this.at(pos).isFirstSibling);\r\n\r\n            if (pos === anchor - 1 && this.at(anchor).type === 'first') {\r\n                pos = anchor;\r\n            }\r\n            return this.extendSelectionTo(anchor, pos);\r\n        }\r\n\r\n        //\r\n        // Extending backward\r\n        //\r\n        let pos = this._position - 1;\r\n\r\n        if (pos < 0) return false;\r\n\r\n        while (pos >= 0 && this.at(pos).isLastSibling) {\r\n            pos--;\r\n        }\r\n        if (pos < 0) pos = 0;\r\n\r\n        if (pos === anchor + 1 && this.at(pos).type === 'first') {\r\n            anchor = pos;\r\n        }\r\n\r\n        return this.extendSelectionTo(anchor, pos);\r\n    }\r\n\r\n    /**\r\n     * Unlike `setSelection`, this method is intended to be used in response\r\n     * to a user action, and it performs various adjustments to result\r\n     * in a more intuitive selection.\r\n     * For example:\r\n     * - when all the children of an atom are selected, the atom\r\n     * become selected.\r\n     * - this method will *not* change the anchor, but may result\r\n     * in a selection whose boundary is outside the anchor\r\n     */\r\n    extendSelectionTo(anchor: Offset, position: Offset): boolean {\r\n        return this.deferNotifications({ selection: true }, () => {\r\n            const range = this.normalizeRange([anchor, position]);\r\n            let [start, end] = range;\r\n\r\n            // Include the parent if all the chidlren are selected\r\n            let parent = this.at(end).parent;\r\n            while (\r\n                parent !== this.root &&\r\n                childrenInRange(this, parent, [start, end])\r\n            ) {\r\n                end = this.offsetOf(parent);\r\n                parent = parent.parent;\r\n            }\r\n            parent = this.at(start).parent;\r\n            while (\r\n                parent !== this.root &&\r\n                childrenInRange(this, parent, [start, end])\r\n            ) {\r\n                start = this.offsetOf(parent.leftSibling);\r\n                parent = parent.parent;\r\n            }\r\n            // Now that the start has potentially changed, check again\r\n            // if end needs to be updated\r\n            parent = this.at(end).parent;\r\n            while (\r\n                parent !== this.root &&\r\n                childrenInRange(this, parent, [start, end])\r\n            ) {\r\n                end = this.offsetOf(parent);\r\n                console.assert(end >= 0);\r\n                parent = parent.parent;\r\n            }\r\n\r\n            this._position = position;\r\n            this._selection = {\r\n                ranges: [[start, end]],\r\n                direction: 'none',\r\n            };\r\n        });\r\n    }\r\n    setListeners(listeners?: ModelListeners): void {\r\n        this.listeners = listeners;\r\n    }\r\n    setHooks(hooks?: ModelHooks): void {\r\n        this.hooks = {\r\n            announce: hooks?.announce\r\n                ? hooks.announce\r\n                : (\r\n                      _target: Mathfield,\r\n                      _command: string,\r\n                      _previousPosition: number,\r\n                      _atoms: Atom[]\r\n                  ): void => {\r\n                      return;\r\n                  },\r\n            moveOut: hooks?.moveOut ? hooks.moveOut : (): boolean => true,\r\n            tabOut: hooks?.tabOut ? hooks.tabOut : (): boolean => true,\r\n        };\r\n    }\r\n\r\n    announce(\r\n        command: string,\r\n        previousPosition?: number,\r\n        atoms: Atom[] = []\r\n    ): void {\r\n        this.hooks.announce(this.mathfield, command, previousPosition, atoms);\r\n    }\r\n\r\n    // Suppress notification while scope is executed,\r\n    // then notify of content change, and selection change (if actual change)\r\n    deferNotifications(\r\n        options: { content?: boolean; selection?: boolean },\r\n        f: () => void\r\n    ): boolean {\r\n        const oldSelection = this._selection;\r\n        const oldAnchor = this._anchor;\r\n        const oldPosition = this._position;\r\n        let contentChanged = false;\r\n        let selectionChanged = false;\r\n\r\n        const saved = this.suppressChangeNotifications;\r\n        this.suppressChangeNotifications = true;\r\n        f();\r\n\r\n        contentChanged = this.root._isDirty;\r\n        if (\r\n            oldAnchor !== this._anchor ||\r\n            oldPosition !== this._position ||\r\n            compareSelection(this._selection, oldSelection) === 'different'\r\n        ) {\r\n            selectionChanged = true;\r\n        }\r\n        this.suppressChangeNotifications = saved;\r\n        if (!this.suppressChangeNotifications) {\r\n            // Notify of content change, if requested\r\n            if (options.content && contentChanged) {\r\n                contentDidChange(this);\r\n            }\r\n            // If the selection has effectively changed, notify\r\n            if (options.selection && selectionChanged) {\r\n                selectionDidChange(this);\r\n            }\r\n        }\r\n\r\n        return contentChanged || selectionChanged;\r\n    }\r\n\r\n    normalizeOffset(value: Offset): Offset {\r\n        if (value > 0) {\r\n            value = Math.min(value, this.lastOffset);\r\n        } else if (value < 0) {\r\n            value = this.lastOffset + value + 1;\r\n        }\r\n        return value;\r\n    }\r\n\r\n    /**\r\n     * Ensure that the range is valid and canonical, i.e.\r\n     * - start <= end\r\n     * - collapsed = start === end\r\n     * - start >= 0, end >=0\r\n     */\r\n    normalizeRange(range: Range): Range {\r\n        // 1. Normalize the offsets\r\n        let [start, end] = range;\r\n        start = this.normalizeOffset(start);\r\n        end = this.normalizeOffset(end);\r\n\r\n        return start < end ? [start, end] : [end, start];\r\n    }\r\n\r\n    normalizeSelection(\r\n        value: Offset | Range | Selection,\r\n        value2?: Offset\r\n    ): Selection {\r\n        let result: Selection;\r\n        if (isOffset(value)) {\r\n            const offset = this.normalizeOffset(value);\r\n            if (isOffset(value2)) {\r\n                const offset2 = this.normalizeOffset(value2);\r\n                if (offset <= offset2) {\r\n                    result = { ranges: [[offset, offset2]], direction: 'none' };\r\n                } else {\r\n                    result = {\r\n                        ranges: [[offset2, offset]],\r\n                        direction: 'backward',\r\n                    };\r\n                }\r\n            } else {\r\n                result = { ranges: [[offset, offset]], direction: 'none' };\r\n            }\r\n        } else if (isRange(value)) {\r\n            const start = this.normalizeOffset(value[0]);\r\n            const end = this.normalizeOffset(value[1]);\r\n            if (start <= end) {\r\n                result = { ranges: [[start, end]], direction: 'none' };\r\n            } else {\r\n                result = { ranges: [[end, start]], direction: 'backward' };\r\n            }\r\n        } else if (isSelection(value)) {\r\n            result = {\r\n                ranges: value.ranges.map((x) => this.normalizeRange(x)),\r\n                direction: value.direction ?? 'none',\r\n            };\r\n        }\r\n        return result;\r\n    }\r\n}\r\n\r\nfunction atomIsInRange(\r\n    model: ModelPrivate,\r\n    atom: Atom,\r\n    first: Offset,\r\n    last: Offset\r\n): boolean {\r\n    const offset = model.offsetOf(atom);\r\n    if (offset < first || offset > last) {\r\n        return false;\r\n    }\r\n\r\n    if (!atom.hasChildren) return true;\r\n\r\n    const firstOffset = model.offsetOf(atom.firstChild);\r\n    if (firstOffset >= first && firstOffset <= last) {\r\n        const lastOffset = model.offsetOf(atom.lastChild);\r\n        if (lastOffset >= first && lastOffset <= last) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nfunction childrenInRange(\r\n    model: ModelPrivate,\r\n    atom: Atom,\r\n    range: Range\r\n): boolean {\r\n    if (!atom?.hasChildren) return false;\r\n    const [start, end] = range;\r\n    const first = model.offsetOf(atom.firstChild);\r\n    const last = model.offsetOf(atom.lastChild);\r\n    if (first >= start && first <= end && last >= first && last <= end) {\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n","import { colorToString } from './color';\r\nimport {\r\n    getInfo,\r\n    mathVariantToUnicode,\r\n} from '../core-definitions/definitions-utils';\r\nimport { Atom, ToLatexOptions } from './atom';\r\nimport { joinLatex } from './tokenizer';\r\nimport { getPropertyRuns, register } from './modes-utils';\r\nimport { Style } from '../public/core';\r\nimport { Span } from './span';\r\n\r\n// Each entry indicate the font-name (to be used to calculate font metrics)\r\n// and the CSS classes (for proper markup styling) for each possible\r\n// variant combinations.\r\nconst VARIANTS = {\r\n    // Handle some special characters which are only available in \"main\" font (not \"math\")\r\n    main: ['Main-Regular', 'ML__cmr'],\r\n    'main-italic': ['Main-Italic', 'ML__cmr ML__it'],\r\n    'main-bold': ['Main-Bold', 'ML__cmr ML__bold'],\r\n    'main-bolditalic': ['Main-BoldItalic', 'ML__cmr ML_bold ML__it'],\r\n\r\n    normal: ['Main-Regular', 'ML__cmr'], // 'main' font. There is no 'math' regular (upright)\r\n    'normal-bold': ['Main-Bold', 'ML__mathbf'], // 'main' font. There is no 'math' bold\r\n    'normal-italic': ['Math-Italic', 'ML__mathit'], // Special metrics for 'math'\r\n    'normal-bolditalic': ['Math-BoldItalic', 'ML__mathbfit'], // Special metrics for 'math'\r\n\r\n    // Extended math symbols, arrows, etc.. at their standard Unicode codepoints\r\n    ams: ['AMS-Regular', 'ML__ams'],\r\n    'ams-bold': ['AMS-Regular', 'ML__ams'],\r\n    'ams-italic': ['AMS-Regular', 'ML__ams'],\r\n    'ams-bolditalic': ['AMS-Regular', 'ML__ams'],\r\n\r\n    'sans-serif': ['SansSerif-Regular', 'ML__sans'],\r\n    'sans-serif-bold': ['SansSerif-Regular', 'ML__sans ML__bold'],\r\n    'sans-serif-italic': ['SansSerif-Regular', 'ML__sans'],\r\n    'sans-serif-bolditalic': ['SansSerif-Regular', 'ML__sans'],\r\n\r\n    calligraphic: ['Caligraphic-Regular', 'ML__cal'],\r\n    'calligraphic-bold': ['Caligraphic-Regular', 'ML__cal ML__bold'],\r\n    'calligraphic-italic': ['Caligraphic-Regular', 'ML__cal ML__it'],\r\n    'calligraphic-bolditalic': [\r\n        'Caligraphic-Regular',\r\n        'ML__cal ML__bold ML__it',\r\n    ],\r\n\r\n    script: ['Script-Regular', 'ML__script'],\r\n    'script-bold': ['Script-Regular', 'ML__script ML__bold'],\r\n    'script-italic': ['Script-Regular', 'ML__script ML__it'],\r\n    'script-bolditalic': ['Script-Regular', 'ML__script ML__bold ML__it'],\r\n\r\n    fraktur: ['Fraktur-Regular', 'ML__frak'],\r\n    'fraktur-bold': ['Fraktur-Regular', 'ML__frak'],\r\n    'fraktur-italic': ['Fraktur-Regular', 'ML__frak'],\r\n    'fraktur-bolditalic': ['Fraktur-Regular', 'ML__frak'],\r\n\r\n    monospace: ['Typewriter-Regular', 'ML__tt'],\r\n    'monospace-bold': ['Typewriter-Regular', 'ML__tt ML__bold'],\r\n    'monospace-italic': ['Typewriter-Regular', 'ML__tt ML__it'],\r\n    'monospace-bolditalic': ['Typewriter-Regular', 'ML__tt ML__bold ML__it'],\r\n\r\n    // Blackboard characters are 'A-Z' in the AMS font\r\n    'double-struck': ['AMS-Regular', 'ML__bb'],\r\n    'double-struck-bold': ['AMS-Regular', 'ML__bb'],\r\n    'double-struck-italic': ['AMS-Regular', 'ML__bb'],\r\n    'double-struck-bolditalic': ['AMS-Regular', 'ML__bb'],\r\n};\r\n\r\nconst VARIANT_REPERTOIRE = {\r\n    'double-struck': /^[A-Z ]$/,\r\n    script: /^[A-Z ]$/,\r\n    calligraphic: /^[0-9A-Z ]$/,\r\n    fraktur: /^[0-9A-Za-z ]$|^[!\"#$%&'()*+,\\-./:;=?[]^]$/,\r\n    monospace: /^[0-9A-Za-z ]$|^[!\"&'()*+,\\-./:;=?@[\\]^_~\\u0131\\u0237\\u0393\\u0394\\u0398\\u039b\\u039e\\u03A0\\u03A3\\u03A5\\u03A8\\u03a9]$/,\r\n    'sans-serif': /^[0-9A-Za-z ]$|^[!\"&'()*+,\\-./:;=?@[\\]^_~\\u0131\\u0237\\u0393\\u0394\\u0398\\u039b\\u039e\\u03A0\\u03A3\\u03A5\\u03A8\\u03a9]$/,\r\n};\r\n\r\nconst GREEK_LOWERCASE = /^[\\u03b1-\\u03c9]|\\u03d1|\\u03d5|\\u03d6|\\u03f1|\\u03f5]$/;\r\nconst GREEK_UPPERCASE = /^[\\u0393|\\u0394|\\u0398|\\u039b|\\u039E|\\u03A0|\\u03A3|\\u03a5|\\u03a6|\\u03a8|\\u03a9]$/;\r\n\r\nconst LETTER_SHAPE_RANGES = [\r\n    /^[a-z]$/, // Lowercase latin\r\n    /^[A-Z]$/, // Upppercase latin\r\n    GREEK_LOWERCASE,\r\n    GREEK_UPPERCASE,\r\n];\r\n\r\n// The letterShapeStyle property indicates which characters should be\r\n// automatically italicized (see LETTER_SHAPE_RANGES)\r\nconst LETTER_SHAPE_MODIFIER = {\r\n    iso: ['it', 'it', 'it', 'it'],\r\n    tex: ['it', 'it', 'it', 'up'],\r\n    french: ['it', 'up', 'up', 'up'],\r\n    upright: ['up', 'up', 'up', 'up'],\r\n};\r\n\r\n// See http://ctan.math.illinois.edu/macros/latex/base/fntguide.pdf\r\n\r\nfunction emitLatexMathRun(run: Atom[], options: ToLatexOptions): string {\r\n    const parent = run[0].parent;\r\n    const parentMode = parent?.mode ?? 'math';\r\n    const contextValue = variantString(parent);\r\n    const contextColor = parent?.computedStyle.color;\r\n    return joinLatex(\r\n        getPropertyRuns(run, 'color').map((x) => {\r\n            const result = joinLatex(\r\n                getPropertyRuns(x, 'variant').map((x) => {\r\n                    const value = variantString(x[0]);\r\n                    // Check if all the atoms in this run have a base\r\n                    // variant identical to the current variant\r\n                    // If so, we can skip wrapping them\r\n                    if (\r\n                        x.every((x) => {\r\n                            const info = getInfo(x.command, parentMode, null);\r\n                            if (!info || !info.variant) return false;\r\n\r\n                            return variantString(x) === value;\r\n                        })\r\n                    ) {\r\n                        return joinLatex(\r\n                            x.map((x) => Atom.toLatex(x, options))\r\n                        );\r\n                    }\r\n\r\n                    let command = '';\r\n                    if (value && value !== contextValue) {\r\n                        command = {\r\n                            calligraphic: '\\\\mathcal{',\r\n                            fraktur: '\\\\mathfrak{',\r\n                            'double-struck': '\\\\mathbb{',\r\n                            script: '\\\\mathscr{',\r\n                            monospace: '\\\\mathtt{',\r\n                            'sans-serif': '\\\\mathsf{',\r\n                            normal: '\\\\mathrm{',\r\n                            'normal-italic': '\\\\mathit{',\r\n                            'normal-bold': '\\\\mathbf{',\r\n                            'normal-bolditalic': '\\\\mathbfit{',\r\n                            ams: '',\r\n                            'ams-italic': '\\\\mathit{',\r\n                            'ams-bold': '\\\\mathbf{',\r\n                            'ams-bolditalic': '\\\\mathbfit{',\r\n                            main: '',\r\n                            'main-italic': '\\\\mathit{',\r\n                            'main-bold': '\\\\mathbf{',\r\n                            'main-bolditalic': '\\\\mathbfit{',\r\n                            // There are a few rare font families possible, which\r\n                            // are not supported:\r\n                            // mathbbm, mathbbmss, mathbbmtt, mathds, swab, goth\r\n                            // In addition, the 'main' and 'math' font technically\r\n                            // map to \\mathnormal{}\r\n                        }[value];\r\n                        console.assert(typeof command !== 'undefined');\r\n                    }\r\n                    return (\r\n                        joinLatex([\r\n                            command,\r\n                            ...x.map((x) => Atom.toLatex(x, options)),\r\n                        ]) + (command ? '}' : '')\r\n                    );\r\n                })\r\n            );\r\n            const style = x[0].computedStyle;\r\n            if (style.color && (!parent || contextColor !== style.color)) {\r\n                return (\r\n                    '\\\\textcolor{' +\r\n                    colorToString(style.color) +\r\n                    '}{' +\r\n                    result +\r\n                    '}'\r\n                );\r\n            }\r\n            return result;\r\n        })\r\n    );\r\n}\r\n\r\nfunction applyStyle(span: Span, style: Style): string {\r\n    // If no variant specified, don't change the font\r\n    if (!style.variant) return '';\r\n\r\n    // letterShapeStyle will usually be set automatically, except when the\r\n    // locale cannot be determined, in which case its value will be 'auto'\r\n    // which we default to 'tex'\r\n    const letterShapeStyle =\r\n        style.letterShapeStyle === 'auto' || !style.letterShapeStyle\r\n            ? 'tex'\r\n            : style.letterShapeStyle;\r\n    let variant = style.variant;\r\n    let variantStyle = style.variantStyle;\r\n\r\n    // 1. Remap to \"main\" font some characters that don't exist\r\n    // in the \"math\" font\r\n\r\n    // There are two fonts that include the roman italic characters, \"main-it\" and \"math\"\r\n    // They are similar, but the \"math\" font has some different kernings ('f')\r\n    // and some slightly different character shape. It doesn't include a few\r\n    // characters, so for those characters, \"main\" has to be used instead\r\n\r\n    // \\imath, \\jmath and \\pound don't exist in \"math\" font,\r\n    // so use \"main\" italic instead.\r\n    if (\r\n        variant === 'normal' &&\r\n        !variantStyle &&\r\n        /\\u00a3|\\u0131|\\u0237/.test(span.value)\r\n    ) {\r\n        variant = 'main';\r\n        variantStyle = 'italic';\r\n    }\r\n\r\n    // 2. If no explicit variant style, auto-italicize some symbols,\r\n    // depending on the letterShapeStyle\r\n    if (variant === 'normal' && !variantStyle && span.value.length === 1) {\r\n        LETTER_SHAPE_RANGES.forEach((x, i) => {\r\n            if (\r\n                x.test(span.value) &&\r\n                LETTER_SHAPE_MODIFIER[letterShapeStyle][i] === 'it'\r\n            ) {\r\n                variantStyle = 'italic';\r\n            }\r\n        });\r\n    }\r\n\r\n    // 3. Map the variant + variantStyle to a font\r\n    if (variantStyle === 'up') {\r\n        variantStyle = '';\r\n    }\r\n    const styledVariant = variantStyle ? variant + '-' + variantStyle : variant;\r\n\r\n    console.assert(VARIANTS[styledVariant]);\r\n\r\n    const [fontName, classes] = VARIANTS[styledVariant];\r\n\r\n    // 4. If outside the font repertoire, switch to system font\r\n    // (return NULL to use default metrics)\r\n    if (\r\n        VARIANT_REPERTOIRE[variant] &&\r\n        !VARIANT_REPERTOIRE[variant].test(span.value)\r\n    ) {\r\n        // Map to unicode character\r\n        span.value = mathVariantToUnicode(span.value, variant, variantStyle);\r\n        // Return NULL to use default metrics\r\n        return null;\r\n    }\r\n    // Lowercase greek letters have an incomplete repertoire (no bold)\r\n    // so, for \\mathbf to behave correctly, add a 'lcGreek' class.\r\n    if (GREEK_LOWERCASE.test(span.value)) {\r\n        span.classes += ' lcGreek';\r\n    }\r\n\r\n    // 5. Assign classes based on the font\r\n    if (classes) {\r\n        span.classes += ' ' + classes;\r\n    }\r\n\r\n    return fontName;\r\n}\r\n\r\nfunction variantString(atom: Atom): string {\r\n    const style = atom.computedStyle;\r\n    let result = style.variant ?? '';\r\n    if (style.variantStyle && style.variantStyle !== 'up') {\r\n        result += '-' + style.variantStyle;\r\n    }\r\n    return result;\r\n}\r\n\r\nregister('math', {\r\n    emitLatexRun: emitLatexMathRun,\r\n    applyStyle,\r\n});\r\n","import { Style } from '../public/core';\nimport { Atom, ToLatexOptions } from '../core/atom-class';\nimport { Span } from '../core/span';\nimport { Context } from '../core/context';\nimport { charToLatex } from '../core-definitions/definitions-utils';\n\nexport class TextAtom extends Atom {\n    constructor(command: string, value: string, style: Style) {\n        super('text', { command, mode: 'text' });\n        this.value = value;\n        this.applyStyle(style);\n    }\n    render(context: Context): Span[] {\n        const result = this.makeSpan(context, this.value);\n        if (this.caret) result.caret = this.caret;\n        return [result];\n    }\n    toLatex(_options: ToLatexOptions): string {\n        return this.latex ?? charToLatex('text', this.value);\n    }\n}\n","import { ErrorListener, Style, ParserErrorCode } from '../public/core';\r\nimport { register, getPropertyRuns, ParseTokensOptions } from './modes-utils';\r\nimport { colorToString } from './color';\r\nimport { joinLatex, Token } from './tokenizer';\r\nimport { Span } from './span';\r\nimport { Atom, ToLatexOptions } from './atom';\r\nimport { getInfo, charToLatex } from '../core-definitions/definitions';\r\nimport { TextAtom } from '../core-atoms/text';\r\n\r\nfunction emitStringTextRun(run: Atom[], options: ToLatexOptions): string {\r\n    // let needSpace = false;\r\n    return joinLatex(\r\n        run.map((x: Atom) => {\r\n            return Atom.toLatex(x, options);\r\n            // let result = x.toLatex(options);\r\n            // let space = '';\r\n\r\n            // if (x.latex && !options.expandMacro) {\r\n            //     result = x.latex;\r\n            // } else if (x.toLatexOverride) {\r\n            //     result = x.toLatexOverride(x, options);\r\n            // } else if (typeof x.value === 'string') {\r\n            //     result = unicodeStringToLatex('text', x.value);\r\n            // } else if (x.command) {\r\n            //     result = x.command.replace(/\\\\/g, '\\\\backslash ');\r\n            // }\r\n            // if (needSpace && (!result || /^[a-zA-Z0-9*]/.test(result))) {\r\n            //     space = '{}';\r\n            // }\r\n            // needSpace = /\\\\[a-zA-Z0-9]+\\*?$/.test(result);\r\n            // return space + result;\r\n        })\r\n    );\r\n}\r\n\r\nfunction emitFontShapeTextRun(run: Atom[], options: ToLatexOptions): string {\r\n    return joinLatex(\r\n        getPropertyRuns(run, 'fontShape').map((x: Atom[]) => {\r\n            const result = emitStringTextRun(x, options);\r\n            const fontShape = x[0].style.fontShape;\r\n            if (fontShape === 'it') {\r\n                return '\\\\textit{' + result + '}';\r\n            }\r\n            if (fontShape === 'sl') {\r\n                return '\\\\textsl{' + result + '}';\r\n            }\r\n            if (fontShape === 'sc') {\r\n                return '\\\\textsc{' + result + '}';\r\n            }\r\n            if (fontShape === 'n') {\r\n                return '\\\\textup{' + result + '}';\r\n            }\r\n            if (fontShape) {\r\n                return '\\\\fontshape{' + x[0].style.fontShape + '}' + result;\r\n            }\r\n            return result;\r\n        })\r\n    );\r\n}\r\n\r\nfunction emitFontSeriesTextRun(run: Atom[], options: ToLatexOptions): string {\r\n    return joinLatex(\r\n        getPropertyRuns(run, 'fontSeries').map((x) => {\r\n            const result = emitFontShapeTextRun(x, options);\r\n            const fontSeries = x[0].style.fontSeries;\r\n            if (fontSeries === 'b') {\r\n                return '\\\\textbf{' + result + '}';\r\n            }\r\n            if (fontSeries === 'l') {\r\n                return '\\\\textlf{' + result + '}';\r\n            }\r\n            if (fontSeries === 'm') {\r\n                return '\\\\textmd{' + result + '}';\r\n            }\r\n            if (fontSeries) {\r\n                return '\\\\fontseries{' + fontSeries + '}' + result;\r\n            }\r\n            return result;\r\n        })\r\n    );\r\n}\r\n\r\nfunction emitSizeTextRun(run: Atom[], options: ToLatexOptions): string {\r\n    return joinLatex(\r\n        getPropertyRuns(run, 'fontSize').map((x: Atom[]) => {\r\n            const result = emitFontSeriesTextRun(x, options);\r\n            const command =\r\n                {\r\n                    size1: 'tiny',\r\n                    size2: 'scriptsize',\r\n                    size3: 'footnotesize',\r\n                    size4: 'small',\r\n                    size5: 'normalsize',\r\n                    size6: 'large',\r\n                    size7: 'Large',\r\n                    size8: 'LARGE',\r\n                    size9: 'huge',\r\n                    size10: 'Huge',\r\n                }[x[0].style.fontSize] || '';\r\n            if (command) {\r\n                return '\\\\' + command + ' ' + result;\r\n            }\r\n            return result;\r\n        })\r\n    );\r\n}\r\n\r\nfunction emitFontFamilyTextRun(run: Atom[], options: ToLatexOptions): string {\r\n    return joinLatex(\r\n        getPropertyRuns(run, 'fontFamily').map((x: Atom[]) => {\r\n            const result = emitSizeTextRun(x, options);\r\n            const command =\r\n                {\r\n                    roman: 'textrm',\r\n                    monospace: 'texttt',\r\n                    'sans-serif': 'textsf',\r\n                }[x[0].style.fontFamily] || '';\r\n            if (command) {\r\n                return '\\\\' + command + '{' + result + '}';\r\n            }\r\n            if (x[0].style.fontFamily) {\r\n                return '\\\\fontfamily{' + x[0].style.fontFamily + '}' + result;\r\n            }\r\n            return result;\r\n        })\r\n    );\r\n}\r\n\r\nfunction emitStyledTextRun(run: Atom[], options: ToLatexOptions): string {\r\n    return emitFontFamilyTextRun(run, options);\r\n}\r\n\r\nfunction emitColorRun(run: Atom[], options: ToLatexOptions): string {\r\n    if (!run || run.length === 0) return '';\r\n    const parentColor = run[0].parent?.style.color;\r\n    return joinLatex(\r\n        getPropertyRuns(run, 'color').map((x) => {\r\n            const result = emitStyledTextRun(x, options);\r\n\r\n            if (\r\n                x[0].style.color &&\r\n                x[0].style.color !== 'none' &&\r\n                parentColor !== x[0].style.color\r\n            ) {\r\n                // If there is a color specified, and it is different\r\n                // from our context color, output a command\r\n                return (\r\n                    '\\\\textcolor{' +\r\n                    colorToString(x[0].style.color) +\r\n                    '}{' +\r\n                    result +\r\n                    '}'\r\n                );\r\n            }\r\n            return result;\r\n        })\r\n    );\r\n}\r\n\r\nfunction emitLatexTextRun(run: Atom[], options: ToLatexOptions): string {\r\n    const result = emitColorRun(run, options);\r\n\r\n    // const allAtomsHaveShapeOrSeriesOrFontFamily = run.every(\r\n    //     (x: Atom) =>\r\n    //         x.style.fontSeries || x.style.fontShape || x.style.fontFamily\r\n    // );\r\n    // if (\r\n    //     !allAtomsHaveShapeOrSeriesOrFontFamily ||\r\n    //     run[0].mode !== context.mode\r\n    // ) {\r\n    //     // Wrap in text, only if there isn't a shape or series on\r\n    //     // all the atoms, because if so, it will be wrapped in a\r\n    //     // \\\\textbf, \\\\textit, etc... and the \\\\text would be redundant\r\n    //     return `\\\\text{${result}}`;\r\n    // }\r\n    return result;\r\n}\r\n\r\nconst TEXT_FONT_CLASS = {\r\n    roman: '',\r\n    'sans-serif': 'ML__sans',\r\n    monospace: 'ML__tt',\r\n};\r\n\r\n/**\r\n * Return the font-family name\r\n */\r\nfunction applyStyle(span: Span, style: Style): string {\r\n    const fontFamily = style.fontFamily;\r\n\r\n    if (TEXT_FONT_CLASS[fontFamily]) {\r\n        span.classes += ' ' + TEXT_FONT_CLASS[fontFamily];\r\n    } else if (fontFamily) {\r\n        // Not a well-known family. Use a style.\r\n        span.setStyle('font-family', fontFamily);\r\n    }\r\n\r\n    if (style.fontShape) {\r\n        span.classes +=\r\n            ' ' +\r\n            ({\r\n                it: 'ML__it',\r\n                sl: 'ML__shape_sl', // slanted\r\n                sc: 'ML__shape_sc', // small caps\r\n                ol: 'ML__shape_ol', // outline\r\n            }[style.fontShape] || '');\r\n    }\r\n    if (style.fontSeries) {\r\n        const m = style.fontSeries.match(/(.?[lbm])?(.?[cx])?/);\r\n        if (m) {\r\n            span.classes +=\r\n                ' ' +\r\n                ({\r\n                    ul: 'ML__series_ul',\r\n                    el: 'ML__series_el',\r\n                    l: 'ML__series_l',\r\n                    sl: 'ML__series_sl',\r\n                    m: '', // medium (default)\r\n                    sb: 'ML__series_sb',\r\n                    b: 'ML__bold',\r\n                    eb: 'ML__series_eb',\r\n                    ub: 'ML__series_ub',\r\n                }[m[1] || ''] || '');\r\n            span.classes +=\r\n                ' ' +\r\n                ({\r\n                    uc: 'ML__series_uc',\r\n                    ec: 'ML__series_ec',\r\n                    c: 'ML__series_c',\r\n                    sc: 'ML__series_sc',\r\n                    n: '', // normal (default)\r\n                    sx: 'ML__series_sx',\r\n                    x: 'ML__series_x',\r\n                    ex: 'ML__series_ex',\r\n                    ux: 'ML__series_ux',\r\n                }[m[2] || ''] || '');\r\n        }\r\n    }\r\n    // Always use the metrics of 'Main-Regular' in text mode\r\n    return 'Main-Regular';\r\n}\r\n\r\n// Given an array of tokens, return an array of atoms\r\n// options.args\r\n// options.macros\r\n// options.smartFence\r\n// options.style\r\n// options.parser\r\nfunction parse(\r\n    tokens: Token[],\r\n    error: ErrorListener<ParserErrorCode>,\r\n    options: ParseTokensOptions\r\n): [Atom[], Token[]] {\r\n    let result = [];\r\n    let atom: Atom;\r\n\r\n    while (tokens.length > 0) {\r\n        const token = tokens.shift();\r\n        if (token === '<space>') {\r\n            result.push(new TextAtom(' ', ' ', options.style));\r\n        } else if (token[0] === '\\\\') {\r\n            // Invoke the 'main' parser to handle the command\r\n            tokens.unshift(token);\r\n            let atoms: Atom[];\r\n            [atoms, tokens] = options.parse('text', tokens, options);\r\n            result = [...result, ...atoms];\r\n        } else if (token === '<$>' || token === '<$$>') {\r\n            // Mode-shift\r\n            const subtokens = tokens.slice(\r\n                0,\r\n                tokens.findIndex((x: Token) => x === token)\r\n            );\r\n            tokens = tokens.slice(subtokens.length + 1);\r\n            const [atoms] = options.parse('math', subtokens, options);\r\n            result = [...result, ...atoms];\r\n        } else if (token === '<{>' || token === '<}>') {\r\n            // Spurious braces are ignored by TeX in text mode\r\n            // In text mode, braces are sometimes used to separate adjacent\r\n            // commands without inserting a space, e.g. \"\\backlash{}command\"\r\n        } else {\r\n            const info = getInfo(token, 'text', options.macros);\r\n            if (!info || (info.ifMode && !info.ifMode.includes('text'))) {\r\n                error({ code: 'unexpected-token' });\r\n            } else {\r\n                atom = new TextAtom(token, info.value, options.style);\r\n                atom.latex = charToLatex('text', token);\r\n                result.push(atom);\r\n            }\r\n        }\r\n    }\r\n    return [result, tokens];\r\n}\r\n\r\nregister('text', {\r\n    emitLatexRun: emitLatexTextRun,\r\n    applyStyle,\r\n    parse: (tokens, error, options) => parse(tokens, error, options)[0],\r\n});\r\n","import type { KeyboardLayoutName as KeyboardLayoutId } from '../public/options';\r\n\r\n// From https://www.w3.org/TR/uievents-code/\r\ntype Keycode =\r\n    | 'Sleep'\r\n    | 'WakeUp'\r\n    | 'KeyA'\r\n    | 'KeyB'\r\n    | 'KeyC'\r\n    | 'KeyD'\r\n    | 'KeyE'\r\n    | 'KeyF'\r\n    | 'KeyG'\r\n    | 'KeyH'\r\n    | 'KeyI'\r\n    | 'KeyJ'\r\n    | 'KeyK'\r\n    | 'KeyL'\r\n    | 'KeyM'\r\n    | 'KeyN'\r\n    | 'KeyO'\r\n    | 'KeyP'\r\n    | 'KeyQ'\r\n    | 'KeyR'\r\n    | 'KeyS'\r\n    | 'KeyT'\r\n    | 'KeyU'\r\n    | 'KeyV'\r\n    | 'KeyW'\r\n    | 'KeyX'\r\n    | 'KeyY'\r\n    | 'KeyZ'\r\n    | 'Digit1'\r\n    | 'Digit2'\r\n    | 'Digit3'\r\n    | 'Digit4'\r\n    | 'Digit5'\r\n    | 'Digit6'\r\n    | 'Digit7'\r\n    | 'Digit8'\r\n    | 'Digit9'\r\n    | 'Digit0'\r\n    | 'Enter'\r\n    | 'Escape'\r\n    | 'Backspace'\r\n    | 'Tab'\r\n    | 'Space'\r\n    | 'Minus'\r\n    | 'Equal'\r\n    | 'BracketLeft'\r\n    | 'BracketRight'\r\n    | 'Backslash'\r\n    | 'Semicolon'\r\n    | 'Quote'\r\n    | 'Backquote'\r\n    | 'Comma'\r\n    | 'Period'\r\n    | 'Slash'\r\n    | 'CapsLock'\r\n    | 'F1'\r\n    | 'F2'\r\n    | 'F3'\r\n    | 'F4'\r\n    | 'F5'\r\n    | 'F6'\r\n    | 'F7'\r\n    | 'F8'\r\n    | 'F9'\r\n    | 'F10'\r\n    | 'F11'\r\n    | 'F12'\r\n    | 'F13'\r\n    | 'F14'\r\n    | 'F15'\r\n    | 'F16'\r\n    | 'F17'\r\n    | 'F18'\r\n    | 'F19'\r\n    | 'F20'\r\n    | 'F21'\r\n    | 'F22'\r\n    | 'F23'\r\n    | 'F24'\r\n    | 'PrintScreen'\r\n    | 'ScrollLock'\r\n    | 'Pause'\r\n    | 'Insert'\r\n    | 'Home'\r\n    | 'PageUp'\r\n    | 'Delete'\r\n    | 'End'\r\n    | 'PageDown'\r\n    | 'ArrowRight'\r\n    | 'ArrowLeft'\r\n    | 'ArrowDown'\r\n    | 'ArrowUp'\r\n    | 'NumLock'\r\n    | 'Numpad1'\r\n    | 'Numpad2'\r\n    | 'Numpad3'\r\n    | 'Numpad4'\r\n    | 'Numpad5'\r\n    | 'Numpad6'\r\n    | 'Numpad7'\r\n    | 'Numpad8'\r\n    | 'Numpad9'\r\n    | 'Numpad0'\r\n    | 'NumpadDivide'\r\n    | 'NumpadMultiply'\r\n    | 'NumpadSubtract'\r\n    | 'NumpadAdd'\r\n    | 'NumpadEnter'\r\n    | 'NumpadDecimal'\r\n    | 'NumpadEqual'\r\n    | 'NumpadParenLeft'\r\n    | 'NumpadParenRight'\r\n    | 'IntlBackslash'\r\n    | 'ContextMenu'\r\n    | 'Power'\r\n    | 'Help'\r\n    | 'Undo'\r\n    | 'Cut'\r\n    | 'Copy'\r\n    | 'Paste'\r\n    | 'AudioVolumeMute'\r\n    | 'AudioVolumeUp'\r\n    | 'AudioVolumeDown'\r\n    | 'NumpadComma'\r\n    | 'IntlRo'\r\n    | 'KanaMode'\r\n    | 'IntlYen'\r\n    | 'Convert'\r\n    | 'NonConvert'\r\n    | 'Lang1'\r\n    | 'Lang2'\r\n    | 'Lang3'\r\n    | 'Lang4'\r\n    | 'ControlLeft'\r\n    | 'ShiftLeft'\r\n    | 'AltLeft'\r\n    | 'MetaLeft'\r\n    | 'ControlRight'\r\n    | 'ShiftRight'\r\n    | 'AltRight'\r\n    | 'MetaRight'\r\n    | 'MediaTrackNext'\r\n    | 'MediaTrackPrevious'\r\n    | 'MediaStop'\r\n    | 'Eject'\r\n    | 'MediaPlayPause'\r\n    | 'MediaSelect'\r\n    | 'LaunchMail'\r\n    | 'LaunchApp2'\r\n    | 'LaunchApp1'\r\n    | 'BrowserSearch'\r\n    | 'BrowserHome'\r\n    | 'BrowserBack'\r\n    | 'BrowserForward'\r\n    | 'BrowserStop'\r\n    | 'BrowserRefresh'\r\n    | 'BrowserFavorites';\r\n\r\ntype KeyboardLayout = {\r\n    id: KeyboardLayoutId;\r\n    displayName: string; // Doesn't have to be unique\r\n    locale: string;\r\n    platform: 'windows' | 'apple' | 'linux';\r\n    score: number;\r\n    mapping: { [K in Keycode]?: [string, string, string, string] };\r\n};\r\n\r\nconst DEFAULT_KEYBOARD_LAYOUT: KeyboardLayout =\r\n    platform() === 'apple'\r\n        ? {\r\n              id: 'apple.en-intl',\r\n              displayName: 'English (international)',\r\n              platform: 'apple',\r\n              locale: 'en',\r\n              score: 0,\r\n              mapping: {\r\n                  KeyA: ['a', 'A', '', ''],\r\n                  KeyB: ['b', 'B', '', ''],\r\n                  KeyC: ['c', 'C', '', ''],\r\n                  KeyD: ['d', 'D', '', ''],\r\n                  KeyE: ['e', 'E', '', ''],\r\n                  KeyF: ['f', 'F', '', ''],\r\n                  KeyG: ['g', 'G', '', ''],\r\n                  KeyH: ['h', 'H', '', ''],\r\n                  KeyI: ['i', 'I', '', ''],\r\n                  KeyJ: ['j', 'J', '', ''],\r\n                  KeyK: ['k', 'K', '', ''],\r\n                  KeyL: ['l', 'L', '', ''],\r\n                  KeyM: ['m', 'M', '', ''],\r\n                  KeyN: ['n', 'N', '', ''],\r\n                  KeyO: ['o', 'O', '', ''],\r\n                  KeyP: ['p', 'P', '', ''],\r\n                  KeyQ: ['q', 'Q', '', ''],\r\n                  KeyR: ['r', 'R', '', ''],\r\n                  KeyS: ['s', 'S', '', ''],\r\n                  KeyT: ['t', 'T', '', ''],\r\n                  KeyU: ['u', 'U', '', ''],\r\n                  KeyV: ['v', 'V', '', ''],\r\n                  KeyW: ['w', 'W', '', ''],\r\n                  KeyX: ['x', 'X', '', ''],\r\n                  KeyY: ['y', 'Y', '', ''],\r\n                  KeyZ: ['z', 'Z', '', ''],\r\n                  Digit1: ['1', '!', '', ''],\r\n                  Digit2: ['2', '@', '', ''],\r\n                  Digit3: ['3', '#', '', ''],\r\n                  Digit4: ['4', '$', '', ''],\r\n                  Digit5: ['5', '%', '', ''],\r\n                  Digit6: ['6', '', '', ''],\r\n                  Digit7: ['7', '&', '', ''],\r\n                  Digit8: ['8', '*', '', ''],\r\n                  Digit9: ['9', '(', '', ''],\r\n                  Digit0: ['0', ')', '', ''],\r\n                  Space: [' ', ' ', ' ', ' '],\r\n                  Minus: ['-', '_', '', ''],\r\n                  Equal: ['=', '+', '', ''],\r\n                  BracketLeft: ['[', '{', '', ''],\r\n                  BracketRight: [']', '}', '', ''],\r\n                  Backslash: ['\\\\', '|', '', ''],\r\n                  Semicolon: [';', ':', '', ''],\r\n                  Quote: [\"'\", '\"', '', ''],\r\n                  Backquote: ['`', '', '`', '`'],\r\n                  Comma: [',', '<', '', ''],\r\n                  Period: ['.', '>', '', ''],\r\n                  Slash: ['/', '?', '', ''],\r\n                  NumpadDivide: ['/', '/', '/', '/'],\r\n                  NumpadMultiply: ['*', '*', '*', '*'],\r\n                  NumpadSubtract: ['-', '-', '-', '-'],\r\n                  NumpadAdd: ['+', '+', '+', '+'],\r\n                  Numpad1: ['1', '1', '1', '1'],\r\n                  Numpad2: ['2', '2', '2', '2'],\r\n                  Numpad3: ['3', '3', '3', '3'],\r\n                  Numpad4: ['4', '4', '4', '4'],\r\n                  Numpad5: ['5', '5', '5', '5'],\r\n                  Numpad6: ['6', '6', '6', '6'],\r\n                  Numpad7: ['7', '7', '7', '7'],\r\n                  Numpad8: ['8', '8', '8', '8'],\r\n                  Numpad9: ['9', '9', '9', '9'],\r\n                  Numpad0: ['0', '0', '0', '0'],\r\n                  NumpadDecimal: ['.', '.', '.', '.'],\r\n                  IntlBackslash: ['', '', '', ''],\r\n                  NumpadEqual: ['=', '=', '=', '='],\r\n                  AudioVolumeUp: ['', '=', '', '='],\r\n              },\r\n          }\r\n        : platform() === 'windows'\r\n        ? {\r\n              id: 'windows.en-intl',\r\n              displayName: 'English (international)',\r\n              platform: 'windows',\r\n              locale: 'en',\r\n              score: 0,\r\n              mapping: {\r\n                  KeyA: ['a', 'A', '', ''],\r\n                  KeyB: ['b', 'B', '', ''],\r\n                  KeyC: ['c', 'C', '', ''],\r\n                  KeyD: ['d', 'D', '', ''],\r\n                  KeyE: ['e', 'E', '', ''],\r\n                  KeyF: ['f', 'F', '', ''],\r\n                  KeyG: ['g', 'G', '', ''],\r\n                  KeyH: ['h', 'H', '', ''],\r\n                  KeyI: ['i', 'I', '', ''],\r\n                  KeyJ: ['j', 'J', '', ''],\r\n                  KeyK: ['k', 'K', '', ''],\r\n                  KeyL: ['l', 'L', '', ''],\r\n                  KeyM: ['m', 'M', '', ''],\r\n                  KeyN: ['n', 'N', '', ''],\r\n                  KeyO: ['o', 'O', '', ''],\r\n                  KeyP: ['p', 'P', '', ''],\r\n                  KeyQ: ['q', 'Q', '', ''],\r\n                  KeyR: ['r', 'R', '', ''],\r\n                  KeyS: ['s', 'S', '', ''],\r\n                  KeyT: ['t', 'T', '', ''],\r\n                  KeyU: ['u', 'U', '', ''],\r\n                  KeyV: ['v', 'V', '', ''],\r\n                  KeyW: ['w', 'W', '', ''],\r\n                  KeyX: ['x', 'X', '', ''],\r\n                  KeyY: ['y', 'Y', '', ''],\r\n                  KeyZ: ['z', 'Z', '', ''],\r\n                  Digit1: ['1', '!', '', ''],\r\n                  Digit2: ['2', '@', '', ''],\r\n                  Digit3: ['3', '#', '', ''],\r\n                  Digit4: ['4', '$', '', ''],\r\n                  Digit5: ['5', '%', '', ''],\r\n                  Digit6: ['6', '^', '', ''],\r\n                  Digit7: ['7', '&', '', ''],\r\n                  Digit8: ['8', '*', '', ''],\r\n                  Digit9: ['9', '(', '', ''],\r\n                  Digit0: ['0', ')', '', ''],\r\n                  Space: [' ', ' ', '', ''],\r\n                  Minus: ['-', '_', '', ''],\r\n                  Equal: ['=', '+', '', ''],\r\n                  BracketLeft: ['[', '{', '', ''],\r\n                  BracketRight: [']', '}', '', ''],\r\n                  Backslash: ['\\\\', '|', '', ''],\r\n                  Semicolon: [';', ':', '', ''],\r\n                  Quote: [\"'\", '\"', '', ''],\r\n                  Backquote: ['`', '~', '', ''],\r\n                  Comma: [',', '<', '', ''],\r\n                  Period: ['.', '>', '', ''],\r\n                  Slash: ['/', '?', '', ''],\r\n                  NumpadDivide: ['/', '/', '', ''],\r\n                  NumpadMultiply: ['*', '*', '', ''],\r\n                  NumpadSubtract: ['-', '-', '', ''],\r\n                  NumpadAdd: ['+', '+', '', ''],\r\n                  IntlBackslash: ['\\\\', '|', '', ''],\r\n              },\r\n          }\r\n        : {\r\n              id: 'linux.en',\r\n              displayName: 'English',\r\n              platform: 'linux',\r\n              locale: 'en',\r\n              score: 0,\r\n              mapping: {\r\n                  KeyA: ['a', 'A', 'a', 'A'],\r\n                  KeyB: ['b', 'B', 'b', 'B'],\r\n                  KeyC: ['c', 'C', 'c', 'C'],\r\n                  KeyD: ['d', 'D', 'd', 'D'],\r\n                  KeyE: ['e', 'E', 'e', 'E'],\r\n                  KeyF: ['f', 'F', 'f', 'F'],\r\n                  KeyG: ['g', 'G', 'g', 'G'],\r\n                  KeyH: ['h', 'H', 'h', 'H'],\r\n                  KeyI: ['i', 'I', 'i', 'I'],\r\n                  KeyJ: ['j', 'J', 'j', 'J'],\r\n                  KeyK: ['k', 'K', 'k', 'K'],\r\n                  KeyL: ['l', 'L', 'l', 'L'],\r\n                  KeyM: ['m', 'M', 'm', 'M'],\r\n                  KeyN: ['n', 'N', 'n', 'N'],\r\n                  KeyO: ['o', 'O', 'o', 'O'],\r\n                  KeyP: ['p', 'P', 'p', 'P'],\r\n                  KeyQ: ['q', 'Q', 'q', 'Q'],\r\n                  KeyR: ['r', 'R', 'r', 'R'],\r\n                  KeyS: ['s', 'S', 's', 'S'],\r\n                  KeyT: ['t', 'T', 't', 'T'],\r\n                  KeyU: ['u', 'U', 'u', 'U'],\r\n                  KeyV: ['v', 'V', 'v', 'V'],\r\n                  KeyW: ['w', 'W', 'w', 'W'],\r\n                  KeyX: ['x', 'X', 'x', 'X'],\r\n                  KeyY: ['y', 'Y', 'y', 'Y'],\r\n                  KeyZ: ['z', 'Z', 'z', 'Z'],\r\n                  Digit1: ['1', '!', '1', '!'],\r\n                  Digit2: ['2', '@', '2', '@'],\r\n                  Digit3: ['3', '#', '3', '#'],\r\n                  Digit4: ['4', '$', '4', '$'],\r\n                  Digit5: ['5', '%', '5', '%'],\r\n                  Digit6: ['6', '^', '6', '^'],\r\n                  Digit7: ['7', '&', '7', '&'],\r\n                  Digit8: ['8', '*', '8', '*'],\r\n                  Digit9: ['9', '(', '9', '('],\r\n                  Digit0: ['0', ')', '0', ')'],\r\n                  Space: [' ', ' ', ' ', ' '],\r\n                  Minus: ['-', '_', '-', '_'],\r\n                  Equal: ['=', '+', '=', '+'],\r\n                  BracketLeft: ['[', '{', '[', '{'],\r\n                  BracketRight: [']', '}', ']', '}'],\r\n                  Backslash: ['\\\\', '|', '\\\\', '|'],\r\n                  Semicolon: [';', ':', ';', ':'],\r\n                  Quote: [\"'\", '\"', \"'\", '\"'],\r\n                  Backquote: ['`', '~', '`', '~'],\r\n                  Comma: [',', '<', ',', '<'],\r\n                  Period: ['.', '>', '.', '>'],\r\n                  Slash: ['/', '?', '/', '?'],\r\n                  NumpadDivide: ['/', '/', '/', '/'],\r\n                  NumpadMultiply: ['*', '*', '*', '*'],\r\n                  NumpadSubtract: ['-', '-', '-', '-'],\r\n                  NumpadAdd: ['+', '+', '+', '+'],\r\n                  Numpad1: ['1', '1', '1', '1'],\r\n                  Numpad2: ['2', '2', '2', '2'],\r\n                  Numpad3: ['3', '3', '3', '3'],\r\n                  Numpad4: ['4', '4', '4', '4'],\r\n                  Numpad5: ['5', '5', '5', '5'],\r\n                  Numpad6: ['6', '6', '6', '6'],\r\n                  Numpad7: ['7', '7', '7', '7'],\r\n                  Numpad8: ['8', '8', '8', '8'],\r\n                  Numpad9: ['9', '9', '9', '9'],\r\n                  Numpad0: ['0', '0', '0', '0'],\r\n                  NumpadDecimal: ['', '.', '', '.'],\r\n                  IntlBackslash: ['<', '>', '|', ''],\r\n                  NumpadEqual: ['=', '=', '=', '='],\r\n                  NumpadComma: ['.', '.', '.', '.'],\r\n                  NumpadParenLeft: ['(', '(', '(', '('],\r\n                  NumpadParenRight: [')', ')', ')', ')'],\r\n              },\r\n          };\r\n\r\n/* prettier-ignore */\r\nconst BASE_LAYOUT_MAPPING = {\r\n    enter: '[Enter]',\r\n    escape: '[Escape]',\r\n    backspace: '[Backspace]',\r\n    tab: '[Tab]',\r\n    space: '[Space]',\r\n    pausebreak: '[Pause]',\r\n    insert: '[Insert]',\r\n    home: '[Home]',\r\n    pageup: '[PageUp]',\r\n    delete: '[Delete]',\r\n    end: '[End]',\r\n    pagedown: '[PageDown]',\r\n    right: '[ArrowRight]',\r\n    left: '[ArrowLeft]',\r\n    down: '[ArrowDown]',\r\n    up: '[ArrowUp]',\r\n    numpad0: '[Numpad0]',\r\n    numpad1: '[Numpad1]',\r\n    numpad2: '[Numpad2]',\r\n    numpad3: '[Numpad3]',\r\n    numpad4: '[Numpad4]',\r\n    numpad5: '[Numpad5]',\r\n    numpad6: '[Numpad6]',\r\n    numpad7: '[Numpad7]',\r\n    numpad8: '[Numpad8]',\r\n    numpad9: '[Numpad9]',\r\n    'numpad_divide': '[NumpadDivide]',\r\n    'numpad_multiply': '[NumpadMultiply]',\r\n    'numpad_subtract': '[NumpadSubtract]',\r\n    'numpad_add': '[NumpadAdd]',\r\n    'numpad_decimal': '[NumpadDecimal]',\r\n    'numpad_separator': '[NumpadComma]',\r\n    capslock: '[Capslock]',\r\n    f1: '[F1]',\r\n    f2: '[F2]',\r\n    f3: '[F3]',\r\n    f4: '[F4]',\r\n    f5: '[F5]',\r\n    f6: '[F6]',\r\n    f7: '[F7]',\r\n    f8: '[F8]',\r\n    f9: '[F9]',\r\n    f10: '[F10]',\r\n    f11: '[F11]',\r\n    f12: '[F12]',\r\n    f13: '[F13]',\r\n    f14: '[F14]',\r\n    f15: '[F15]',\r\n    f16: '[F16]',\r\n    f17: '[F17]',\r\n    f18: '[F18]',\r\n    f19: '[F19]',\r\n};\r\n\r\nconst gKeyboardLayouts: KeyboardLayout[] = [];\r\n\r\nlet gKeyboardLayout: KeyboardLayout;\r\n\r\nexport function platform(): 'apple' | 'windows' | 'linux' {\r\n    let result: 'apple' | 'windows' | 'linux' = 'linux';\r\n    if (navigator?.platform && navigator?.userAgent) {\r\n        if (/^(mac)/i.test(navigator.platform)) {\r\n            result = 'apple';\r\n        } else if (/^(win)/i.test(navigator.platform)) {\r\n            result = 'windows';\r\n        } else if (/(android)/i.test(navigator.userAgent)) {\r\n            result = 'linux';\r\n        } else if (\r\n            /(iphone)/i.test(navigator.userAgent) ||\r\n            /(ipod)/i.test(navigator.userAgent) ||\r\n            /(ipad)/i.test(navigator.userAgent)\r\n        ) {\r\n            result = 'apple';\r\n        } else if (/\\bCrOS\\b/i.test(navigator.userAgent)) {\r\n            result = 'linux';\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nexport function register(layout: KeyboardLayout): void {\r\n    if (layout.platform === platform()) {\r\n        gKeyboardLayouts.push(layout);\r\n    }\r\n}\r\n\r\n/** Given the current estimated keyboard layout,\r\n *  return the unmodified key for the event.\r\n * For example, on AZERTY option+shift+'A' = '' -> 'a'\r\n * (event though the code is KeyQ)\r\n */\r\n// export function getUnmodifiedKey(evt: KeyboardEvent): string {\r\n//     if (!evt.shiftKey && !evt.altKey) {\r\n//         return evt.key;\r\n//     }\r\n//     // @todo: iterate over the entries for the current layout,\r\n//     // with the alt+shift modifiers set accordingly\r\n//     // and find the (first) entry that matches\r\n//     const layout = gKeyboardLayouts[0] ?? DEFAULT_KEYBOARD_LAYOUT;\r\n//     const index =\r\n//         evt.shiftKey && evt.altKey ? 3 : evt.altKey ? 2 : evt.shiftKey ? 1 : 0;\r\n\r\n//     for (const [key, value] of Object.entries(layout.mapping)) {\r\n//         if (key === evt.code && value[index] === evt.key) {\r\n//             return value[0];\r\n//         }\r\n//     }\r\n\r\n//     // We did not find a perfect match...\r\n//     // Look for an entry even if the keycode doesn't match...\r\n//     for (const [, value] of Object.entries(layout.mapping)) {\r\n//         if (value[index] === evt.key) {\r\n//             return value[0];\r\n//         }\r\n//     }\r\n\r\n//     // Really? Nothing matched?! Just return the key...\r\n//     return evt.key;\r\n// }\r\n\r\nexport function getCodeForKey(k: string): string {\r\n    const layout = getActiveKeyboardLayout() ?? DEFAULT_KEYBOARD_LAYOUT;\r\n\r\n    for (const [key, value] of Object.entries(layout.mapping)) {\r\n        if (value[0] === k) return '[' + key + ']';\r\n        if (value[1] === k) return 'shift+[' + key + ']';\r\n        if (value[2] === k) return 'alt+[' + key + ']';\r\n        if (value[3] === k) return 'shift+alt+[' + key + ']';\r\n    }\r\n\r\n    return BASE_LAYOUT_MAPPING[k] ?? '';\r\n}\r\n\r\nexport function normalizeKeyboardEvent(evt: KeyboardEvent): KeyboardEvent {\r\n    if (!evt.code) {\r\n        // For virtual keyboards (iOS, Android) and Microsoft Edge (!)\r\n        // the `evt.code`, which represents the physical key pressed, is set\r\n        // to undefined. In that case, map the virtual key (\"q\") to a\r\n        // pseudo-hardware key (\"KeyQ\")\r\n        const mapping = Object.entries(getActiveKeyboardLayout().mapping);\r\n        let altKey = false;\r\n        let shiftKey = false;\r\n        let code: string;\r\n        for (let index = 0; index < 4; index++) {\r\n            for (const [key, value] of mapping) {\r\n                if (value[index] === evt.key) {\r\n                    code = key;\r\n                    if (index === 3) {\r\n                        altKey = true;\r\n                        shiftKey = true;\r\n                    } else if (index === 2) {\r\n                        altKey = true;\r\n                    } else if (index === 1) {\r\n                        shiftKey = true;\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n            if (code) break;\r\n        }\r\n        return new KeyboardEvent(evt.type, { ...evt, altKey, shiftKey, code });\r\n    }\r\n    return new KeyboardEvent(evt.type, evt);\r\n}\r\n\r\n// Given this keyboard event, and the `code`, `key` and modifiers\r\n// in it, increase the score of layouts that do match it.\r\n// Calling repeatedly this function will improve the accuracy of the\r\n// keyboard layout estimate.\r\nexport function validateKeyboardLayout(evt: KeyboardEvent): void {\r\n    const index =\r\n        evt.shiftKey && evt.altKey ? 3 : evt.altKey ? 2 : evt.shiftKey ? 1 : 0;\r\n\r\n    if (evt.key === 'Unidentified') return;\r\n\r\n    // Dead keys do not have enough info to validate the keyboard\r\n    // (we dont' know what char they could produce, only the physical key associated with them )\r\n    if (evt.key === 'Dead') return;\r\n\r\n    const layouts = gKeyboardLayouts.filter(\r\n        (layout) => layout.mapping[evt.code]?.[index] === evt.key\r\n    );\r\n    if (layouts.length === 0) return;\r\n\r\n    // Increase the score of the layouts that have a mapping compatible with this keyboard event.\r\n    layouts.forEach((x) => {\r\n        x.score += 1;\r\n    });\r\n    gKeyboardLayouts.sort((a, b) => b.score - a.score);\r\n}\r\n\r\nexport function setKeyboardLayoutLocale(locale: string): void {\r\n    gKeyboardLayout = gKeyboardLayouts.find((x) => locale.startsWith(x.locale));\r\n}\r\n\r\nexport function setKeyboardLayout(\r\n    name: KeyboardLayoutId | 'auto'\r\n): KeyboardLayout {\r\n    // If name is 'auto', the layout is not found, and set to undefined\r\n    gKeyboardLayout = gKeyboardLayouts.find((x) => x.id === name);\r\n    return gKeyboardLayout;\r\n}\r\n\r\nexport function getActiveKeyboardLayout(): KeyboardLayout {\r\n    return gKeyboardLayout ?? gKeyboardLayouts[0];\r\n}\r\n\r\nexport function getKeyboardLayouts(): KeyboardLayout[] {\r\n    return gKeyboardLayouts;\r\n}\r\n\r\nregister(DEFAULT_KEYBOARD_LAYOUT);\r\n\r\nregister({\r\n    id: 'apple.french',\r\n    locale: 'fr',\r\n    displayName: 'French',\r\n    platform: 'apple',\r\n    score: 0,\r\n    mapping: {\r\n        KeyA: ['q', 'Q', '', ''],\r\n        KeyB: ['b', 'B', '', ''],\r\n        KeyC: ['c', 'C', '', ''],\r\n        KeyD: ['d', 'D', '', ''],\r\n        KeyE: ['e', 'E', '', ''],\r\n        KeyF: ['f', 'F', '', ''],\r\n        KeyG: ['g', 'G', '', ''],\r\n        KeyH: ['h', 'H', '', ''],\r\n        KeyI: ['i', 'I', '', ''],\r\n        KeyJ: ['j', 'J', '', ''],\r\n        KeyK: ['k', 'K', '', ''],\r\n        KeyL: ['l', 'L', '', '|'],\r\n        KeyM: [',', '?', '', ''],\r\n        KeyN: ['n', 'N', '~', ''],\r\n        KeyO: ['o', 'O', '', ''],\r\n        KeyP: ['p', 'P', '', ''],\r\n        KeyQ: ['a', 'A', '', ''],\r\n        KeyR: ['r', 'R', '', ''],\r\n        KeyS: ['s', 'S', '', ''],\r\n        KeyT: ['t', 'T', '', ''],\r\n        KeyU: ['u', 'U', '', ''],\r\n        KeyV: ['v', 'V', '', ''],\r\n        KeyW: ['z', 'Z', '', ''],\r\n        KeyX: ['x', 'X', '', ''],\r\n        KeyY: ['y', 'Y', '', ''],\r\n        KeyZ: ['w', 'W', '', ''],\r\n        Digit1: ['&', '1', '', ''],\r\n        Digit2: ['', '2', '', ''],\r\n        Digit3: ['\"', '3', '', ''],\r\n        Digit4: [\"'\", '4', '', ''],\r\n        Digit5: ['(', '5', '{', '['],\r\n        Digit6: ['', '6', '', ''],\r\n        Digit7: ['', '7', '', ''],\r\n        Digit8: ['!', '8', '', ''],\r\n        Digit9: ['', '9', '', ''],\r\n        Digit0: ['', '0', '', ''],\r\n        Space: [' ', ' ', ' ', ' '],\r\n        Minus: [')', '', '}', ']'],\r\n        Equal: ['-', '_', '', ''],\r\n        BracketLeft: ['^', '', '', ''],\r\n        BracketRight: ['$', '*', '', ''],\r\n        Backslash: ['`', '', '@', '#'],\r\n        Semicolon: ['m', 'M', '', ''],\r\n        Quote: ['', '%', '', ''],\r\n        Backquote: ['<', '>', '', ''],\r\n        Comma: [';', '.', '', ''],\r\n        Period: [':', '/', '', '\\\\'],\r\n        Slash: ['=', '+', '', ''],\r\n        NumpadDivide: ['/', '/', '/', '/'],\r\n        NumpadMultiply: ['*', '*', '*', '*'],\r\n        NumpadSubtract: ['-', '-', '-', '-'],\r\n        NumpadAdd: ['+', '+', '+', '+'],\r\n        NumpadDecimal: [',', '.', ',', '.'],\r\n        IntlBackslash: ['@', '#', '', ''],\r\n        NumpadEqual: ['=', '=', '=', '='],\r\n    },\r\n});\r\n\r\nregister({\r\n    id: 'apple.spanish',\r\n    locale: 'es',\r\n    displayName: 'Spanish ISO',\r\n    platform: 'apple',\r\n    score: 0,\r\n    mapping: {\r\n        KeyA: ['a', 'A', '', ''],\r\n        KeyB: ['b', 'B', '', ''],\r\n        KeyC: ['c', 'C', '', ' '],\r\n        KeyD: ['d', 'D', '', ''],\r\n        KeyE: ['e', 'E', '', ''],\r\n        KeyF: ['f', 'F', '', ''],\r\n        KeyG: ['g', 'G', '', ''],\r\n        KeyH: ['h', 'H', '', ' '],\r\n        KeyI: ['i', 'I', ' ', ' '],\r\n        KeyJ: ['j', 'J', '', ''],\r\n        KeyK: ['k', 'K', '', ''],\r\n        KeyL: ['l', 'L', ' ', ''],\r\n        KeyM: ['m', 'M', '', ''],\r\n        KeyN: ['n', 'N', ' ', ''],\r\n        KeyO: ['o', 'O', '', ''],\r\n        KeyP: ['p', 'P', '', ''],\r\n        KeyQ: ['q', 'Q', '', ''],\r\n        KeyR: ['r', 'R', '', ' '],\r\n        KeyS: ['s', 'S', '', ' '],\r\n        KeyT: ['t', 'T', '', ''],\r\n        KeyU: ['u', 'U', ' ', ' '],\r\n        KeyV: ['v', 'V', '', ''],\r\n        KeyW: ['w', 'W', '', ''],\r\n        KeyX: ['x', 'X', '', ''],\r\n        KeyY: ['y', 'Y', '', ' '],\r\n        KeyZ: ['z', 'Z', '', ''],\r\n        Digit1: ['1', '!', '|', ''],\r\n        Digit2: ['2', '\"', '@', ''],\r\n        Digit3: ['3', '', '#', ''],\r\n        Digit4: ['4', '$', '', ''],\r\n        Digit5: ['5', '%', '', ''],\r\n        Digit6: ['6', '&', '', ' '],\r\n        Digit7: ['7', '/', '', ''],\r\n        Digit8: ['8', '(', '', ''],\r\n        Digit9: ['9', ')', '', ''],\r\n        Digit0: ['0', '=', '', ''],\r\n        Space: [' ', ' ', ' ', ' '],\r\n        Minus: [\"'\", '?', '', ''],\r\n        Equal: ['', '', '', ''],\r\n        BracketLeft: ['`', '^', '[', ''],\r\n        BracketRight: ['+', '*', ']', ''],\r\n        Backslash: ['', '', '}', ''],\r\n        Semicolon: ['', '', '~', ''],\r\n        Quote: ['', '', '{', ''],\r\n        Backquote: ['<', '>', '', ''],\r\n        Comma: [',', ';', '', ''],\r\n        Period: ['.', ':', '', ''],\r\n        Slash: ['-', '_', '', ''],\r\n        NumpadDivide: ['/', '/', '/', '/'],\r\n        NumpadMultiply: ['*', '*', '*', '*'],\r\n        NumpadSubtract: ['-', '-', '-', '-'],\r\n        NumpadAdd: ['+', '+', '+', '+'],\r\n        Numpad1: ['1', '1', '1', '1'],\r\n        Numpad2: ['2', '2', '2', '2'],\r\n        Numpad3: ['3', '3', '3', '3'],\r\n        Numpad4: ['4', '4', '4', '4'],\r\n        Numpad5: ['5', '5', '5', '5'],\r\n        Numpad6: ['6', '6', '6', '6'],\r\n        Numpad7: ['7', '7', '7', '7'],\r\n        Numpad8: ['8', '8', '8', '8'],\r\n        Numpad9: ['9', '9', '9', '9'],\r\n        Numpad0: ['0', '0', '0', '0'],\r\n        NumpadDecimal: [',', ',', ',', ','],\r\n        IntlBackslash: ['', '', '\\\\', ''],\r\n    },\r\n});\r\n\r\nregister({\r\n    id: 'windows.spanish',\r\n    locale: 'es',\r\n    displayName: 'Spanish',\r\n    platform: 'windows',\r\n    score: 0,\r\n    mapping: {\r\n        KeyA: ['a', 'A', '', ''],\r\n        KeyB: ['b', 'B', '', ''],\r\n        KeyC: ['c', 'C', '', ''],\r\n        KeyD: ['d', 'D', '', ''],\r\n        KeyE: ['e', 'E', '', ''],\r\n        KeyF: ['f', 'F', '', ''],\r\n        KeyG: ['g', 'G', '', ''],\r\n        KeyH: ['h', 'H', '', ''],\r\n        KeyI: ['i', 'I', '', ''],\r\n        KeyJ: ['j', 'J', '', ''],\r\n        KeyK: ['k', 'K', '', ''],\r\n        KeyL: ['l', 'L', '', ''],\r\n        KeyM: ['m', 'M', '', ''],\r\n        KeyN: ['n', 'N', '', ''],\r\n        KeyO: ['o', 'O', '', ''],\r\n        KeyP: ['p', 'P', '', ''],\r\n        KeyQ: ['q', 'Q', '', ''],\r\n        KeyR: ['r', 'R', '', ''],\r\n        KeyS: ['s', 'S', '', ''],\r\n        KeyT: ['t', 'T', '', ''],\r\n        KeyU: ['u', 'U', '', ''],\r\n        KeyV: ['v', 'V', '', ''],\r\n        KeyW: ['w', 'W', '', ''],\r\n        KeyX: ['x', 'X', '', ''],\r\n        KeyY: ['y', 'Y', '', ''],\r\n        KeyZ: ['z', 'Z', '', ''],\r\n        Digit1: ['1', '!', '|', ''],\r\n        Digit2: ['2', '\"', '@', ''],\r\n        Digit3: ['3', '', '#', ''],\r\n        Digit4: ['4', '$', '~', ''],\r\n        Digit5: ['5', '%', '', ''],\r\n        Digit6: ['6', '&', '', ''],\r\n        Digit7: ['7', '/', '', ''],\r\n        Digit8: ['8', '(', '', ''],\r\n        Digit9: ['9', ')', '', ''],\r\n        Digit0: ['0', '=', '', ''],\r\n        Space: [' ', ' ', '', ''],\r\n        Minus: [\"'\", '?', '', ''],\r\n        Equal: ['', '', '', ''],\r\n        BracketLeft: ['`', '^', '[', ''],\r\n        BracketRight: ['+', '*', ']', ''],\r\n        Backslash: ['', '', '}', ''],\r\n        Semicolon: ['', '', '', ''],\r\n        Quote: ['', '', '{', ''],\r\n        Backquote: ['', '', '\\\\', ''],\r\n        Comma: [',', ';', '', ''],\r\n        Period: ['.', ':', '', ''],\r\n        Slash: ['-', '_', '', ''],\r\n        NumpadDivide: ['/', '/', '', ''],\r\n        NumpadMultiply: ['*', '*', '', ''],\r\n        NumpadSubtract: ['-', '-', '', ''],\r\n        NumpadAdd: ['+', '+', '', ''],\r\n        IntlBackslash: ['<', '>', '', ''],\r\n    },\r\n});\r\n\r\nregister({\r\n    id: 'linux.spanish',\r\n    locale: 'es',\r\n    displayName: 'Spanish',\r\n    platform: 'linux',\r\n    score: 0,\r\n    mapping: {\r\n        KeyA: ['a', 'A', '', ''],\r\n        KeyB: ['b', 'B', '', ''],\r\n        KeyC: ['c', 'C', '', ''],\r\n        KeyD: ['d', 'D', '', ''],\r\n        KeyE: ['e', 'E', '', ''],\r\n        KeyF: ['f', 'F', '', ''],\r\n        KeyG: ['g', 'G', '', ''],\r\n        KeyH: ['h', 'H', '', ''],\r\n        KeyI: ['i', 'I', '', ''],\r\n        KeyJ: ['j', 'J', '', ''],\r\n        KeyK: ['k', 'K', '', '&'],\r\n        KeyL: ['l', 'L', '', ''],\r\n        KeyM: ['m', 'M', '', ''],\r\n        KeyN: ['n', 'N', 'n', 'N'],\r\n        KeyO: ['o', 'O', '', ''],\r\n        KeyP: ['p', 'P', '', ''],\r\n        KeyQ: ['q', 'Q', '@', ''],\r\n        KeyR: ['r', 'R', '', ''],\r\n        KeyS: ['s', 'S', '', ''],\r\n        KeyT: ['t', 'T', '', ''],\r\n        KeyU: ['u', 'U', '', ''],\r\n        KeyV: ['v', 'V', '', ''],\r\n        KeyW: ['w', 'W', '', ''],\r\n        KeyX: ['x', 'X', '', '>'],\r\n        KeyY: ['y', 'Y', '', ''],\r\n        KeyZ: ['z', 'Z', '', '<'],\r\n        Digit1: ['1', '!', '|', ''],\r\n        Digit2: ['2', '\"', '@', ''],\r\n        Digit3: ['3', '', '#', ''],\r\n        Digit4: ['4', '$', '~', '$'],\r\n        Digit5: ['5', '%', '', ''],\r\n        Digit6: ['6', '&', '', ''],\r\n        Digit7: ['7', '/', '{', ''],\r\n        Digit8: ['8', '(', '[', ''],\r\n        Digit9: ['9', ')', ']', ''],\r\n        Digit0: ['0', '=', '}', ''],\r\n        Enter: ['\\r', '\\r', '\\r', '\\r'],\r\n        Escape: ['\\u001b', '\\u001b', '\\u001b', '\\u001b'],\r\n        Backspace: ['\\b', '\\b', '\\b', '\\b'],\r\n        Tab: ['\\t', '', '\\t', ''],\r\n        Space: [' ', ' ', ' ', ' '],\r\n        Minus: [\"'\", '?', '\\\\', ''],\r\n        Equal: ['', '', '', '~'],\r\n        BracketLeft: ['', '', '[', ''],\r\n        BracketRight: ['+', '*', ']', ''],\r\n        Backslash: ['', '', '}', ''],\r\n        Semicolon: ['', '', '~', ''],\r\n        Quote: ['', '', '{', '{'],\r\n        Backquote: ['', '', '\\\\', '\\\\'],\r\n        Comma: [',', ';', '', ''],\r\n        Period: ['.', ':', '', ''],\r\n        Slash: ['-', '_', '', ''],\r\n        NumpadDivide: ['/', '/', '/', '/'],\r\n        NumpadMultiply: ['*', '*', '*', '*'],\r\n        NumpadSubtract: ['-', '-', '-', '-'],\r\n        NumpadAdd: ['+', '+', '+', '+'],\r\n        NumpadEnter: ['\\r', '\\r', '\\r', '\\r'],\r\n        Numpad1: ['', '1', '', '1'],\r\n        Numpad2: ['', '2', '', '2'],\r\n        Numpad3: ['', '3', '', '3'],\r\n        Numpad4: ['', '4', '', '4'],\r\n        Numpad5: ['', '5', '', '5'],\r\n        Numpad6: ['', '6', '', '6'],\r\n        Numpad7: ['', '7', '', '7'],\r\n        Numpad8: ['', '8', '', '8'],\r\n        Numpad9: ['', '9', '', '9'],\r\n        Numpad0: ['', '0', '', '0'],\r\n        NumpadDecimal: ['', '.', '', '.'],\r\n        IntlBackslash: ['<', '>', '|', ''],\r\n        NumpadEqual: ['=', '=', '=', '='],\r\n        NumpadComma: ['.', '.', '.', '.'],\r\n        NumpadParenLeft: ['(', '(', '(', '('],\r\n        NumpadParenRight: [')', ')', ')', ')'],\r\n    },\r\n});\r\n\r\nregister({\r\n    id: 'linux.french',\r\n    locale: 'fr',\r\n    displayName: 'French',\r\n    platform: 'apple',\r\n    score: 0,\r\n    mapping: {\r\n        KeyA: ['q', 'Q', '@', ''],\r\n        KeyB: ['b', 'B', '', ''],\r\n        KeyC: ['c', 'C', '', ''],\r\n        KeyD: ['d', 'D', '', ''],\r\n        KeyE: ['e', 'E', '', ''],\r\n        KeyF: ['f', 'F', '', ''],\r\n        KeyG: ['g', 'G', '', ''],\r\n        KeyH: ['h', 'H', '', ''],\r\n        KeyI: ['i', 'I', '', ''],\r\n        KeyJ: ['j', 'J', '', ''],\r\n        KeyK: ['k', 'K', '', '&'],\r\n        KeyL: ['l', 'L', '', ''],\r\n        KeyM: [',', '?', '', ''],\r\n        KeyN: ['n', 'N', 'n', 'N'],\r\n        KeyO: ['o', 'O', '', ''],\r\n        KeyP: ['p', 'P', '', ''],\r\n        KeyQ: ['a', 'A', '', ''],\r\n        KeyR: ['r', 'R', '', ''],\r\n        KeyS: ['s', 'S', '', ''],\r\n        KeyT: ['t', 'T', '', ''],\r\n        KeyU: ['u', 'U', '', ''],\r\n        KeyV: ['v', 'V', '', ''],\r\n        KeyW: ['z', 'Z', '', '<'],\r\n        KeyX: ['x', 'X', '', '>'],\r\n        KeyY: ['y', 'Y', '', ''],\r\n        KeyZ: ['w', 'W', '', ''],\r\n        Digit1: ['&', '1', '', ''],\r\n        Digit2: ['', '2', '~', ''],\r\n        Digit3: ['\"', '3', '#', ''],\r\n        Digit4: [\"'\", '4', '{', '$'],\r\n        Digit5: ['(', '5', '[', ''],\r\n        Digit6: ['-', '6', '|', ''],\r\n        Digit7: ['', '7', '`', ''],\r\n        Digit8: ['_', '8', '\\\\', ''],\r\n        Digit9: ['', '9', '^', ''],\r\n        Digit0: ['', '0', '@', ''],\r\n        Enter: ['\\r', '\\r', '\\r', '\\r'],\r\n        Escape: ['\\u001b', '\\u001b', '\\u001b', '\\u001b'],\r\n        Backspace: ['\\b', '\\b', '\\b', '\\b'],\r\n        Tab: ['\\t', '', '\\t', ''],\r\n        Space: [' ', ' ', ' ', ' '],\r\n        Minus: [')', '', ']', ''],\r\n        Equal: ['=', '+', '}', ''],\r\n        BracketLeft: ['', '', '', ''],\r\n        BracketRight: ['$', '', '', ''],\r\n        Backslash: ['*', '', '', ''],\r\n        Semicolon: ['m', 'M', '', ''],\r\n        Quote: ['', '%', '', ''],\r\n        Backquote: ['', '~', '', ''],\r\n        Comma: [';', '.', '', ''],\r\n        Period: [':', '/', '', ''],\r\n        Slash: ['!', '', '', ''],\r\n        NumpadMultiply: ['*', '*', '*', '*'],\r\n        NumpadSubtract: ['-', '-', '-', '-'],\r\n        NumpadAdd: ['+', '+', '+', '+'],\r\n        NumpadDecimal: ['', '.', '', '.'],\r\n        IntlBackslash: ['<', '>', '|', ''],\r\n    },\r\n});\r\n\r\nregister({\r\n    id: 'windows.french',\r\n    locale: 'fr',\r\n    displayName: 'French',\r\n    platform: 'windows',\r\n    score: 0,\r\n    mapping: {\r\n        KeyA: ['q', 'Q', '', ''],\r\n        KeyB: ['b', 'B', '', ''],\r\n        KeyC: ['c', 'C', '', ''],\r\n        KeyD: ['d', 'D', '', ''],\r\n        KeyE: ['e', 'E', '', ''],\r\n        KeyF: ['f', 'F', '', ''],\r\n        KeyG: ['g', 'G', '', ''],\r\n        KeyH: ['h', 'H', '', ''],\r\n        KeyI: ['i', 'I', '', ''],\r\n        KeyJ: ['j', 'J', '', ''],\r\n        KeyK: ['k', 'K', '', ''],\r\n        KeyL: ['l', 'L', '', ''],\r\n        KeyM: [',', '?', '', ''],\r\n        KeyN: ['n', 'N', '', ''],\r\n        KeyO: ['o', 'O', '', ''],\r\n        KeyP: ['p', 'P', '', ''],\r\n        KeyQ: ['a', 'A', '', ''],\r\n        KeyR: ['r', 'R', '', ''],\r\n        KeyS: ['s', 'S', '', ''],\r\n        KeyT: ['t', 'T', '', ''],\r\n        KeyU: ['u', 'U', '', ''],\r\n        KeyV: ['v', 'V', '', ''],\r\n        KeyW: ['z', 'Z', '', ''],\r\n        KeyX: ['x', 'X', '', ''],\r\n        KeyY: ['y', 'Y', '', ''],\r\n        KeyZ: ['w', 'W', '', ''],\r\n        Digit1: ['&', '1', '', ''],\r\n        Digit2: ['', '2', '~', ''],\r\n        Digit3: ['\"', '3', '#', ''],\r\n        Digit4: [\"'\", '4', '{', ''],\r\n        Digit5: ['(', '5', '[', ''],\r\n        Digit6: ['-', '6', '|', ''],\r\n        Digit7: ['', '7', '`', ''],\r\n        Digit8: ['_', '8', '\\\\', ''],\r\n        Digit9: ['', '9', '^', ''],\r\n        Digit0: ['', '0', '@', ''],\r\n        Space: [' ', ' ', '', ''],\r\n        Minus: [')', '', ']', ''],\r\n        Equal: ['=', '+', '}', ''],\r\n        BracketLeft: ['^', '', '', ''],\r\n        BracketRight: ['$', '', '', ''],\r\n        Backslash: ['*', '', '', ''],\r\n        Semicolon: ['m', 'M', '', ''],\r\n        Quote: ['', '%', '', ''],\r\n        Backquote: ['', '', '', ''],\r\n        Comma: [';', '.', '', ''],\r\n        Period: [':', '/', '', ''],\r\n        Slash: ['!', '', '', ''],\r\n        NumpadDivide: ['/', '/', '', ''],\r\n        NumpadMultiply: ['*', '*', '', ''],\r\n        NumpadSubtract: ['-', '-', '', ''],\r\n        NumpadAdd: ['+', '+', '', ''],\r\n        IntlBackslash: ['<', '>', '', ''],\r\n    },\r\n});\r\n\r\nregister({\r\n    id: 'windows.german',\r\n    locale: 'de',\r\n    displayName: 'German',\r\n    platform: 'windows',\r\n    score: 0,\r\n    mapping: {\r\n        KeyA: ['a', 'A', '', ''],\r\n        KeyB: ['b', 'B', '', ''],\r\n        KeyC: ['c', 'C', '', ''],\r\n        KeyD: ['d', 'D', '', ''],\r\n        KeyE: ['e', 'E', '', ''],\r\n        KeyF: ['f', 'F', '', ''],\r\n        KeyG: ['g', 'G', '', ''],\r\n        KeyH: ['h', 'H', '', ''],\r\n        KeyI: ['i', 'I', '', ''],\r\n        KeyJ: ['j', 'J', '', ''],\r\n        KeyK: ['k', 'K', '', ''],\r\n        KeyL: ['l', 'L', '', ''],\r\n        KeyM: ['m', 'M', '', ''],\r\n        KeyN: ['n', 'N', '', ''],\r\n        KeyO: ['o', 'O', '', ''],\r\n        KeyP: ['p', 'P', '', ''],\r\n        KeyQ: ['q', 'Q', '@', ''],\r\n        KeyR: ['r', 'R', '', ''],\r\n        KeyS: ['s', 'S', '', ''],\r\n        KeyT: ['t', 'T', '', ''],\r\n        KeyU: ['u', 'U', '', ''],\r\n        KeyV: ['v', 'V', '', ''],\r\n        KeyW: ['w', 'W', '', ''],\r\n        KeyX: ['x', 'X', '', ''],\r\n        KeyY: ['z', 'Z', '', ''],\r\n        KeyZ: ['y', 'Y', '', ''],\r\n        Digit1: ['1', '!', '', ''],\r\n        Digit2: ['2', '\"', '', ''],\r\n        Digit3: ['3', '', '', ''],\r\n        Digit4: ['4', '$', '', ''],\r\n        Digit5: ['5', '%', '', ''],\r\n        Digit6: ['6', '&', '', ''],\r\n        Digit7: ['7', '/', '{', ''],\r\n        Digit8: ['8', '(', '[', ''],\r\n        Digit9: ['9', ')', ']', ''],\r\n        Digit0: ['0', '=', '}', ''],\r\n        Space: [' ', ' ', '', ''],\r\n        Minus: ['', '?', '\\\\', ''],\r\n        Equal: ['', '`', '', ''],\r\n        BracketLeft: ['', '', '', ''],\r\n        BracketRight: ['+', '*', '~', ''],\r\n        Backslash: ['#', \"'\", '', ''],\r\n        Semicolon: ['', '', '', ''],\r\n        Quote: ['', '', '', ''],\r\n        Backquote: ['^', '', '', ''],\r\n        Comma: [',', ';', '', ''],\r\n        Period: ['.', ':', '', ''],\r\n        Slash: ['-', '_', '', ''],\r\n        NumpadDivide: ['/', '/', '', ''],\r\n        NumpadMultiply: ['*', '*', '', ''],\r\n        NumpadSubtract: ['-', '-', '', ''],\r\n        NumpadAdd: ['+', '+', '', ''],\r\n        IntlBackslash: ['<', '>', '|', ''],\r\n    },\r\n});\r\n\r\nregister({\r\n    id: 'apple.german',\r\n    locale: 'de',\r\n    displayName: 'German',\r\n    platform: 'apple',\r\n    score: 0,\r\n    mapping: {\r\n        KeyA: ['a', 'A', '', ''],\r\n        KeyB: ['b', 'B', '', ''],\r\n        KeyC: ['c', 'C', '', ''],\r\n        KeyD: ['d', 'D', '', ''],\r\n        KeyE: ['e', 'E', '', ''],\r\n        KeyF: ['f', 'F', '', ''],\r\n        KeyG: ['g', 'G', '', ''],\r\n        KeyH: ['h', 'H', '', ''],\r\n        KeyI: ['i', 'I', '', ''],\r\n        KeyJ: ['j', 'J', '', ''],\r\n        KeyK: ['k', 'K', '', ''],\r\n        KeyL: ['l', 'L', '@', ''],\r\n        KeyM: ['m', 'M', '', ''],\r\n        KeyN: ['n', 'N', '~', ''],\r\n        KeyO: ['o', 'O', '', ''],\r\n        KeyP: ['p', 'P', '', ''],\r\n        KeyQ: ['q', 'Q', '', ''],\r\n        KeyR: ['r', 'R', '', ''],\r\n        KeyS: ['s', 'S', '', ''],\r\n        KeyT: ['t', 'T', '', ''],\r\n        KeyU: ['u', 'U', '', ''],\r\n        KeyV: ['v', 'V', '', ''],\r\n        KeyW: ['w', 'W', '', ''],\r\n        KeyX: ['x', 'X', '', ''],\r\n        KeyY: ['z', 'Z', '', ''],\r\n        KeyZ: ['y', 'Y', '', ''],\r\n        Digit1: ['1', '!', '', ''],\r\n        Digit2: ['2', '\"', '', ''],\r\n        Digit3: ['3', '', '', '#'],\r\n        Digit4: ['4', '$', '', ''],\r\n        Digit5: ['5', '%', '[', ''],\r\n        Digit6: ['6', '&', ']', '^'],\r\n        Digit7: ['7', '/', '|', '\\\\'],\r\n        Digit8: ['8', '(', '{', ''],\r\n        Digit9: ['9', ')', '}', ''],\r\n        Digit0: ['0', '=', '', ''],\r\n        Space: [' ', ' ', ' ', ' '],\r\n        Minus: ['', '?', '', ''],\r\n        Equal: ['', '`', \"'\", ''],\r\n        BracketLeft: ['', '', '', ''],\r\n        BracketRight: ['+', '*', '', ''],\r\n        Backslash: ['#', \"'\", '', ''],\r\n        Semicolon: ['', '', '', ''],\r\n        Quote: ['', '', '', ''],\r\n        Backquote: ['<', '>', '', ''],\r\n        Comma: [',', ';', '', ''],\r\n        Period: ['.', ':', '', ''],\r\n        Slash: ['-', '_', '', ''],\r\n        NumpadDivide: ['/', '/', '/', '/'],\r\n        NumpadMultiply: ['*', '*', '*', '*'],\r\n        NumpadSubtract: ['-', '-', '-', '-'],\r\n        NumpadAdd: ['+', '+', '+', '+'],\r\n        NumpadDecimal: [',', ',', '.', '.'],\r\n        IntlBackslash: ['^', '', '', ''],\r\n        NumpadEqual: ['=', '=', '=', '='],\r\n    },\r\n});\r\n","import type { Keybinding } from '../public/options';\r\n\r\nexport const DEFAULT_KEYBINDINGS: Keybinding[] = [\r\n    { key: 'ctrl+alt+e', command: ['insert', '\\\\text{cmd+alt+e}'] },\r\n    { key: 'cmd+alt+a', command: ['insert', '\\\\text{cmd+alt+a}'] },\r\n    { key: 'ctrl+alt+a', command: ['insert', '\\\\text{ctrl+alt+a}'] },\r\n    { key: 'meta+alt+2', command: ['insert', '\\\\text{meta+alt+2}'] },\r\n    {\r\n        key: 'ctrl+alt+shift+a',\r\n        command: ['insert', '\\\\text{ctrl+alt+shift+a}'],\r\n    },\r\n    // { key: 'meta+alt+@', command: ['insert', '\\\\text{cmd+alt+@}'] },\r\n\r\n    { key: 'left', command: 'moveToPreviousChar' },\r\n    { key: 'right', command: 'moveToNextChar' },\r\n    { key: 'up', command: 'moveUp' },\r\n    { key: 'down', command: 'moveDown' },\r\n\r\n    { key: 'shift+[ArrowLeft]', command: 'extendSelectionBackward' },\r\n    { key: 'shift+[ArrowRight]', command: 'extendSelectionForward' },\r\n    { key: 'shift+[ArrowUp]', command: 'extendSelectionUpward' },\r\n    { key: 'shift+[ArrowDown]', command: 'extendSelectionDownward' },\r\n\r\n    { key: '[Backspace]', command: 'deleteBackward' },\r\n    { key: 'alt+[Delete]', command: 'deleteBackward' },\r\n\r\n    { key: '[Delete]', command: 'deleteForward' },\r\n    { key: 'alt+[Backspace]', command: 'deleteForward' },\r\n\r\n    { key: 'alt+[ArrowLeft]', command: 'moveToPreviousWord' },\r\n    { key: 'alt+[ArrowRight]', command: 'moveToNextWord' },\r\n\r\n    { key: 'alt+shift+[ArrowLeft]', command: 'extendToPreviousWord' },\r\n    { key: 'alt+shift+[ArrowRight]', command: 'extendToNextWord' },\r\n\r\n    { key: 'ctrl+[ArrowLeft]', command: 'moveToGroupStart' },\r\n    { key: 'ctrl+[ArrowRight]', command: 'moveToGroupEnd' },\r\n\r\n    { key: 'ctrl+shift+[ArrowLeft]', command: 'extendToGroupStart' },\r\n    { key: 'ctrl+shift+[ArrowRight]', command: 'extendToGroupEnd' },\r\n\r\n    { key: '[Space]', ifMode: 'math', command: 'moveAfterParent' },\r\n    { key: 'shift+[Space]', ifMode: 'math', command: 'moveBeforeParent' },\r\n\r\n    { key: '[Home]', command: 'moveToMathFieldStart' },\r\n    { key: 'cmd+[ArrowLeft]', command: 'moveToMathFieldStart' },\r\n    { key: 'shift+[Home]', command: 'extendToMathFieldStart' },\r\n    { key: 'cmd+shift+[ArrowLeft]', command: 'extendToMathFieldStart' },\r\n\r\n    { key: '[End]', command: 'moveToMathFieldEnd' },\r\n    { key: 'cmd+[ArrowRight]', command: 'moveToMathFieldEnd' },\r\n    { key: 'shift+[End]', command: 'extendToMathFieldEnd' },\r\n    { key: 'cmd+shift+[ArrowRight]', command: 'extendToMathFieldEnd' },\r\n\r\n    { key: '[Pageup]', command: 'moveToGroupStart' },\r\n    { key: '[Pagedown]', command: 'moveToGroupEnd' },\r\n\r\n    { key: '[Tab]', ifMode: 'math', command: 'moveToNextPlaceholder' },\r\n    {\r\n        key: 'shift+[Tab]',\r\n        ifMode: 'math',\r\n        command: 'moveToPreviousPlaceholder',\r\n    },\r\n\r\n    { key: '[Tab]', ifMode: 'text', command: 'moveToNextPlaceholder' },\r\n    {\r\n        key: 'shift+[Tab]',\r\n        ifMode: 'text',\r\n        command: 'moveToPreviousPlaceholder',\r\n    },\r\n\r\n    { key: '[Escape]', ifMode: 'math', command: ['switchMode', 'command'] },\r\n    { key: '\\\\', ifMode: 'math', command: ['switchMode', 'command'] },\r\n\r\n    {\r\n        key: 'alt+[Equal]',\r\n        ifMode: 'math',\r\n        command: ['applyStyle', { mode: 'text' }],\r\n    },\r\n    {\r\n        key: 'alt+[Equal]',\r\n        ifMode: 'text',\r\n        command: ['applyStyle', { mode: 'math' }],\r\n    },\r\n\r\n    {\r\n        key: '[Escape]',\r\n        ifMode: 'command',\r\n        command: ['complete', 'reject'],\r\n    }, // discard the command} insert nothing\r\n    {\r\n        key: '[Tab]',\r\n        ifMode: 'command',\r\n        command: ['complete', 'accept-with-suggestion'],\r\n    }, // complete the suggestion\r\n    { key: '[Return]', ifMode: 'command', command: 'complete' },\r\n    { key: '[Enter]', ifMode: 'command', command: 'complete' },\r\n    {\r\n        key: 'shift+[Escape]',\r\n        ifMode: 'command',\r\n        command: ['complete', 'reject'],\r\n    }, // Some keyboards can't generate\r\n    // this combination, for example in 60% keyboards it is mapped to ~\r\n    { key: '[ArrowDown]', ifMode: 'command', command: 'nextSuggestion' },\r\n    // { key: 'ios:command:[Tab]', ifMode: 'command',command: 'nextSuggestion' },\r\n    { key: '[ArrowUp]', ifMode: 'command', command: 'previousSuggestion' },\r\n\r\n    { key: 'ctrl+a', ifPlatform: '!macos', command: 'selectAll' },\r\n    { key: 'cmd+a', command: 'selectAll' },\r\n\r\n    // Rare keys on some extended keyboards\r\n    { key: '[Cut]', command: 'cutToClipboard' },\r\n    { key: '[Copy]', command: 'copyToClipboard' },\r\n    { key: '[Paste]', command: 'pasteFromClipboard' },\r\n    { key: '[Clear]', command: 'deleteBackward' },\r\n\r\n    { key: 'ctrl+z', ifPlatform: '!macos', command: 'undo' },\r\n    { key: 'cmd+z', command: 'undo' },\r\n    { key: '[Undo]', command: 'undo' },\r\n    { key: 'ctrl+y', ifPlatform: '!macos', command: 'redo' }, // ARIA recommendation\r\n    { key: 'cmd+shift+y', command: 'redo' },\r\n    { key: 'ctrl+shift+z', ifPlatform: '!macos', command: 'redo' },\r\n    { key: 'cmd+shift+z', command: 'redo' },\r\n    { key: '[Redo]', command: 'redo' },\r\n\r\n    { key: '[EraseEof]', command: 'deleteToGroupEnd' },\r\n\r\n    // EMACS/MACOS BINDINGS\r\n    { key: 'ctrl+b', ifPlatform: 'macos', command: 'moveToPreviousChar' },\r\n    { key: 'ctrl+f', ifPlatform: 'macos', command: 'moveToNextChar' },\r\n    { key: 'ctrl+p', ifPlatform: 'macos', command: 'moveUp' },\r\n    { key: 'ctrl+n', ifPlatform: 'macos', command: 'moveDown' },\r\n    { key: 'ctrl+a', ifPlatform: 'macos', command: 'moveToMathFieldStart' },\r\n    { key: 'ctrl+e', ifPlatform: 'macos', command: 'moveToMathFieldEnd' },\r\n    {\r\n        key: 'ctrl+shift+b',\r\n        ifPlatform: 'macos',\r\n        command: 'extendSelectionBackward',\r\n    },\r\n    {\r\n        key: 'ctrl+shift+f',\r\n        ifPlatform: 'macos',\r\n        command: 'extendSelectionForward',\r\n    },\r\n    {\r\n        key: 'ctrl+shift+p',\r\n        ifPlatform: 'macos',\r\n        command: 'extendSelectionUpward',\r\n    },\r\n    {\r\n        key: 'ctrl+shift+n',\r\n        ifPlatform: 'macos',\r\n        command: 'extendSelectionDownward',\r\n    },\r\n    {\r\n        key: 'ctrl+shift+a',\r\n        ifPlatform: 'macos',\r\n        command: 'extendToMathFieldStart',\r\n    },\r\n    {\r\n        key: 'ctrl+shift+e',\r\n        ifPlatform: 'macos',\r\n        command: 'extendToMathFieldEnd',\r\n    },\r\n    { key: 'ctrl+alt+b', ifPlatform: 'macos', command: 'moveToPreviousWord' },\r\n    { key: 'ctrl+alt+f', ifPlatform: 'macos', command: 'moveToNextWord' },\r\n    {\r\n        key: 'ctrl+shift+alt+b',\r\n        ifPlatform: 'macos',\r\n        command: 'extendToPreviousWord',\r\n    },\r\n    {\r\n        key: 'ctrl+shift+alt+f',\r\n        ifPlatform: 'macos',\r\n        command: 'extendToNextWord',\r\n    },\r\n\r\n    { key: 'ctrl+h', ifPlatform: 'macos', command: 'deleteBackward' },\r\n    { key: 'ctrl+d', ifPlatform: 'macos', command: 'deleteForward' },\r\n    { key: 'ctrl+l', ifPlatform: 'macos', command: 'scrollIntoView' },\r\n    // { key: 'ctrl+t', ifPlatform: 'macos', command: 'transpose' },\r\n\r\n    {\r\n        key: 'shift+[Quote]',\r\n        ifMode: 'math',\r\n        command: ['switchMode', 'text', '', ''],\r\n    }, // ??\r\n    {\r\n        key: 'shift+[Quote]',\r\n        ifMode: 'text',\r\n        command: ['switchMode', 'math', '', ''],\r\n    }, // ??\r\n\r\n    // WOLFRAM MATHEMATICA BINDINGS\r\n    {\r\n        key: 'ctrl+[Digit2]',\r\n        ifMode: 'math',\r\n        command: ['insert', '$$\\\\sqrt{#0}$$'],\r\n    },\r\n    { key: 'ctrl+[Digit5]', ifMode: 'math', command: 'moveToOpposite' },\r\n    { key: 'ctrl+[Digit6]', ifMode: 'math', command: 'moveToSuperscript' },\r\n    { key: 'ctrl+[Minus]', ifMode: 'math', command: 'moveToSubscript' }, // ??\r\n    {\r\n        key: 'alt+[BracketLeft]',\r\n        ifMode: 'math',\r\n        command: ['insert', '$$\\\\left\\\\lbrack #0 \\\\right\\\\rbrack$$'],\r\n    }, // ??\r\n    {\r\n        key: 'alt+shift+[BracketLeft]',\r\n        ifMode: 'math',\r\n        command: ['insert', '$$\\\\left\\\\lbrace #0 \\\\right\\\\rbrace$$'],\r\n    }, // ??\r\n\r\n    { key: 'ctrl+[Return]', ifMode: 'math', command: 'addRowAfter' },\r\n    { key: 'ctrl+[Enter]', ifMode: 'math', command: 'addRowAfter' },\r\n    { key: 'cmd+[Return]', ifMode: 'math', command: 'addRowAfter' },\r\n    { key: 'cmd+[Enter]', ifMode: 'math', command: 'addRowAfter' },\r\n    { key: 'ctrl+;', ifMode: 'math', command: 'addRowAfter' },\r\n    { key: 'cmd+;', ifMode: 'math', command: 'addRowAfter' },\r\n    { key: 'ctrl+shift+;', ifMode: 'math', command: 'addRowBefore' },\r\n    { key: 'cmd+shift+;', ifMode: 'math', command: 'addRowBefore' },\r\n\r\n    { key: 'ctrl+[Comma]', ifMode: 'math', command: 'addColumnAfter' },\r\n    { key: 'cmd+[Comma]', ifMode: 'math', command: 'addColumnAfter' },\r\n    { key: 'ctrl+shift+[Comma]', ifMode: 'math', command: 'addColumnAfter' },\r\n    { key: 'cmd+shift+[Comma]', ifMode: 'math', command: 'addColumnAfter' },\r\n\r\n    // Excel keybindings:\r\n    // shift+space: select entire row, ctrl+space: select an entire column\r\n    // ctrl+shift++ or ctrl+numpad+\r\n    // ctrl+- to delete a row or columns\r\n\r\n    // MATHLIVE BINDINGS\r\n    // { key: 'alt+a', command: ['insert', '$$\\\\theta$$'] },\r\n    { key: 'alt+p', ifMode: 'math', command: ['insert', '$$\\\\pi$$'] },\r\n    { key: 'alt+v', ifMode: 'math', command: ['insert', '$$\\\\sqrt{#0}$$'] },\r\n    {\r\n        key: 'alt+w',\r\n        ifMode: 'math',\r\n        command: ['insert', '$$\\\\sum_{i=#?}^{#?}$$'],\r\n    },\r\n    // { key: 'alt+b', command: ['insert', '$$\\\\int_{#?}^{#?}$$'] },\r\n    { key: 'alt+u', ifMode: 'math', command: ['insert', '$$\\\\cup$$'] },\r\n    { key: 'alt+n', ifMode: 'math', command: ['insert', '$$\\\\cap$$'] },\r\n    { key: 'alt+o', ifMode: 'math', command: ['insert', '$$\\\\emptyset$$'] },\r\n    {\r\n        key: 'alt+d',\r\n        ifMode: 'math',\r\n        command: ['insert', '$$\\\\differentialD$$'],\r\n    },\r\n    {\r\n        key: 'alt+shift+o',\r\n        ifMode: 'math',\r\n        command: ['insert', '$$\\\\varnothing$$'],\r\n    },\r\n    {\r\n        key: 'alt+shift+d',\r\n        ifMode: 'math',\r\n        command: ['insert', '$$\\\\partial$$'],\r\n    },\r\n    {\r\n        key: 'alt+shift+p',\r\n        ifMode: 'math',\r\n        command: ['insert', '$$\\\\prod_{i=#?}^{#?}$$'],\r\n    },\r\n    { key: 'alt+shift+u', ifMode: 'math', command: ['insert', '$$\\\\bigcup$$'] },\r\n    { key: 'alt+shift+n', ifMode: 'math', command: ['insert', '$$\\\\bigcap$$'] },\r\n    { key: 'alt+shift+a', ifMode: 'math', command: ['insert', '$$\\\\forall$$'] },\r\n    { key: 'alt+shift+e', ifMode: 'math', command: ['insert', '$$\\\\exists$$'] },\r\n    { key: 'alt+[Digit5]', ifMode: 'math', command: ['insert', '$\\\\infty$$'] }, // \"%\" key\r\n    { key: 'alt+[Digit6]', ifMode: 'math', command: ['insert', '$$\\\\wedge$$'] }, // \"^\" key\r\n    {\r\n        key: 'alt+shift+[Digit6]',\r\n        ifMode: 'math',\r\n        command: ['insert', '$$\\\\vee$$'],\r\n    }, // \"^\" key\r\n    { key: 'alt+[Digit9]', ifMode: 'math', command: ['insert', '('] }, // \"(\" key} override smartFence\r\n    { key: 'alt+[Digit0]', ifMode: 'math', command: ['insert', ')'] }, // \")\" key} override smartFence\r\n    { key: 'alt+shift+[Backslash]', ifMode: 'math', command: ['insert', '|'] }, // \"|\" key} override smartFence\r\n    {\r\n        key: 'alt+[Backslash]',\r\n        ifMode: 'math',\r\n        command: ['insert', '$$\\\\backslash$$'],\r\n    }, // \"|\" key} override command mode\r\n    {\r\n        key: '/',\r\n        ifMode: 'math',\r\n        command: ['insert', '$$\\\\frac{#@}{#?}$$'],\r\n    },\r\n    {\r\n        key: 'alt+/',\r\n        ifMode: 'math',\r\n        command: ['insert', '$$\\\\/$$'],\r\n    },\r\n    {\r\n        key: '[NumpadDivide]',\r\n        ifMode: 'math',\r\n        command: ['insert', '$$\\\\frac{#@}{#?}$$'],\r\n    }, // ??\r\n    {\r\n        key: 'alt+[NumpadDivide]',\r\n        ifMode: 'math',\r\n        command: ['insert', '\\\\frac{#?}{#@}'],\r\n    }, // ??\r\n    {\r\n        key: 'shift+[Backquote]',\r\n        ifMode: 'math',\r\n        command: ['insert', '$$\\\\~$$'],\r\n    }, // ??\r\n\r\n    // Accessibility\r\n    { key: 'alt+shift+k', command: 'toggleKeystrokeCaption' },\r\n    { key: 'alt+[Space]', command: 'toggleVirtualKeyboard' },\r\n\r\n    // Note: On Mac OS (as of 10.12), there is a bug/behavior that causes\r\n    // a beep to be generated with certain command+control key combinations.\r\n    // The workaround is to create a default binding file to silence them.\r\n    // In ~/Library/KeyBindings/DefaultKeyBinding.dict add these entries:\r\n    /*\r\n     {\r\n        \"^@\\UF701\" = \"noop:\";\r\n        \"^@\\UF702\" = \"noop:\";\r\n        \"^@\\UF703\" = \"noop:\";\r\n    }\r\n    */\r\n    {\r\n        key: 'ctrl+alt+[ArrowUp]',\r\n        command: ['speak', 'parent', { withHighlighting: false }],\r\n    },\r\n    {\r\n        key: 'ctrl+alt+[ArrowDown]',\r\n        command: ['speak', 'all', { withHighlighting: false }],\r\n    },\r\n];\r\n\r\n/**\r\n * Most commands can be associated to their keyboard shortcuts from the\r\n * DEFAULT_KEYBINDINGS table above, for example 'speakSelection' -> 'ctrl+KeyR'\r\n * However, those that contain complex commands are more ambiguous.\r\n * For example, '\\sqrt' -> 'math:alt+KeyV'. This table provides the reverse\r\n * mapping for those more complex commands. It is used when displaying\r\n * keybindings for specific commands in the popover.\r\n */\r\nexport const REVERSE_KEYBINDINGS = {\r\n    '\\\\theta': 'alt+q',\r\n    '\\\\sqrt': ['alt+v', 'ctrl+[Digit2]'],\r\n    '\\\\pi': 'alt+p',\r\n    '\\\\prod': 'alt+shift+p',\r\n    '\\\\sum': 'alt+w',\r\n    '\\\\int': 'alt+b',\r\n    '\\\\cup': 'alt+u',\r\n    '\\\\cap': 'alt+n',\r\n    '\\\\bigcup': 'alt+shift+u',\r\n    '\\\\bigcap': 'alt+shift+n',\r\n    '\\\\forall': 'alt+shift+a',\r\n    '\\\\exists': 'alt+shift+e',\r\n    '\\\\infty': 'alt+[Digit5]',\r\n    '\\\\wedge': 'alt+[Digit5]',\r\n    '\\\\vee': 'alt+shift+[Digit6]',\r\n    '\\\\differentialD': 'alt+d',\r\n    '\\\\partial': 'alt+shift+d',\r\n    '\\\\frac': 'Slash',\r\n    '\\\\emptyset': 'alt+o',\r\n    '\\\\varnothing': 'alt+shift+o',\r\n    '\\\\~': '~',\r\n};\r\n","import { isArray } from '../common/types';\r\n\r\nimport type { Selector } from '../public/commands';\r\nimport type { Keybinding } from '../public/options';\r\n\r\nimport { getCodeForKey } from './keyboard-layout';\r\nimport { REVERSE_KEYBINDINGS } from './keybindings-definitions';\r\nimport type { ParseMode } from '../public/core';\r\n\r\ntype KeybindingPlatform =\r\n    | 'macos'\r\n    | 'windows'\r\n    | 'android'\r\n    | 'ios'\r\n    | 'chromeos'\r\n    | 'other';\r\n\r\n/**\r\n * @param p The platform to test against.\r\n */\r\nfunction matchPlatform(p: string): boolean {\r\n    if (navigator?.platform && navigator?.userAgent) {\r\n        let plat: KeybindingPlatform;\r\n        if (/^(mac)/i.test(navigator.platform)) {\r\n            plat = 'macos';\r\n        } else if (/^(win)/i.test(navigator.platform)) {\r\n            plat = 'windows';\r\n        } else if (/(android)/i.test(navigator.userAgent)) {\r\n            plat = 'android';\r\n        } else if (\r\n            /(iphone)/i.test(navigator.userAgent) ||\r\n            /(ipod)/i.test(navigator.userAgent) ||\r\n            /(ipad)/i.test(navigator.userAgent)\r\n        ) {\r\n            plat = 'ios';\r\n        } else if (/\\bCrOS\\b/i.test(navigator.userAgent)) {\r\n            plat = 'chromeos';\r\n        }\r\n        if (p.startsWith('!') && !p.endsWith(plat)) return true;\r\n        if (p.endsWith(plat)) return true;\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\n/**\r\n * Return the selector matching the keystroke.\r\n * The keybindings and keystroke should be in normalized form\r\n * (i.e. using key code, e.g. `[KeyQ]`\r\n *\r\n */\r\nexport function getCommandForKeybinding(\r\n    keybindings: Keybinding[],\r\n    mode: ParseMode,\r\n    keystroke: string\r\n): Selector | [Selector, ...any[]] | '' {\r\n    if (keybindings.length === 0) return '';\r\n\r\n    // Try to match using a virtual keystroke\r\n    for (let i = keybindings.length - 1; i >= 0; i--) {\r\n        if (keybindings[i].key === keystroke) {\r\n            if (!keybindings[i].ifMode || keybindings[i].ifMode === mode) {\r\n                return keybindings[i].command;\r\n            }\r\n        }\r\n    }\r\n    return '';\r\n}\r\n\r\nfunction commandToString(command: string | Selector | string[]): string {\r\n    let result: string | string[] = command;\r\n\r\n    if (isArray(result)) {\r\n        if (result.length > 0) {\r\n            result = result[0] + '(' + result.slice(1).join('') + ')';\r\n        } else {\r\n            result = '';\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nexport function getKeybindingsForCommand(\r\n    keybindings: Keybinding[],\r\n    command: string\r\n): string[] {\r\n    let result = [];\r\n\r\n    if (typeof command === 'string') {\r\n        const candidate = REVERSE_KEYBINDINGS[command];\r\n        if (isArray(candidate)) {\r\n            result = candidate.slice();\r\n        } else if (candidate) {\r\n            result.push(candidate);\r\n        }\r\n    }\r\n\r\n    // A command can be either a simple selector, or a selector\r\n    // with arguments. Normalize it to a string\r\n    const normalizedCommand = commandToString(command);\r\n\r\n    const regex = new RegExp(\r\n        '^' +\r\n            normalizedCommand\r\n                .replace('\\\\', '\\\\\\\\')\r\n                .replace('|', '\\\\|')\r\n                .replace('*', '\\\\*')\r\n                .replace('$', '\\\\$')\r\n                .replace('^', '\\\\^') +\r\n            '([^*a-zA-Z]|$)'\r\n    );\r\n    keybindings.forEach((keybinding) => {\r\n        if (regex.test(commandToString(keybinding.command))) {\r\n            result.push(keybinding);\r\n        }\r\n    });\r\n\r\n    return result.map(getKeybindingMarkup);\r\n}\r\n\r\n/**\r\n * Return a human readable representation of a shortcut as a markup string\r\n * @revisit\r\n */\r\nexport function getKeybindingMarkup(keystroke: string): string {\r\n    const useSymbol = matchPlatform('macos') || matchPlatform('ios');\r\n    const segments = keystroke.split('+');\r\n    let result = '';\r\n    for (const segment of segments) {\r\n        if (!useSymbol && result) {\r\n            result += '<span class=\"ML__shortcut-join\">+</span>';\r\n        }\r\n        if (segment.startsWith('Key')) {\r\n            result += segment.substr(3, 1);\r\n        } else if (segment.startsWith('Digit')) {\r\n            result += segment.substr(5, 1);\r\n        } else {\r\n            result +=\r\n                {\r\n                    cmd: '\\u2318',\r\n                    meta: useSymbol ? '\\u2318' : 'command',\r\n                    shift: useSymbol ? '\\u21e7' : 'shift',\r\n                    alt: useSymbol ? '\\u2325' : 'alt',\r\n                    ctrl: useSymbol ? '\\u2303' : 'control',\r\n                    '\\n': useSymbol ? '\\u23ce' : 'return',\r\n                    '[return]': useSymbol ? '\\u23ce' : 'return',\r\n                    '[enter]': useSymbol ? '\\u2324' : 'enter',\r\n                    '[tab]': useSymbol ? '\\u21e5' : 'tab',\r\n                    // 'Esc':          useSymbol ? '\\u238b' : 'esc',\r\n                    '[escape]': 'esc',\r\n\r\n                    '[backspace]': useSymbol ? '\\u232b' : 'backspace',\r\n                    '[delete]': useSymbol ? '\\u2326' : 'del',\r\n                    '[pageup]': useSymbol ? '\\u21de' : 'page up',\r\n                    '[pagedown]': useSymbol ? '\\u21df' : 'page down',\r\n                    '[home]': useSymbol ? '\\u2912' : 'home',\r\n                    '[end]': useSymbol ? '\\u2913' : 'end',\r\n                    '[space]': 'space',\r\n                    '[equal]': '=',\r\n                    '[minus]': '-',\r\n                    '[comma]': ',',\r\n                    '[backslash]': '\\\\',\r\n                    '[bracketleft]': '[',\r\n                    '[bracketright]': ']',\r\n                    semicolon: ';',\r\n                    period: '.',\r\n                    comma: ',',\r\n                    minus: '-',\r\n                    equal: '=',\r\n                    quote: \"'\",\r\n                    bracketLeft: '[',\r\n                    bracketRight: ']',\r\n                    backslash: '\\\\',\r\n                    intlbackslash: '\\\\',\r\n                    backquote: '`',\r\n                    slash: '/',\r\n                    numpadmultiply: '* &#128290;',\r\n                    numpaddivide: '/ &#128290;', // Numeric keypad\r\n                    numpadsubtract: '- &#128290;',\r\n                    numpadadd: '+ &#128290;',\r\n                    numpaddecimal: '. &#128290;',\r\n                    numpadcomma: ', &#128290;',\r\n                    help: 'help',\r\n                    left: '\\u21E0',\r\n                    up: '\\u21E1',\r\n                    right: '\\u21E2',\r\n                    down: '\\u21E3',\r\n                    '[arrowleft]': '\\u21E0',\r\n                    '[arrowup]': '\\u21E1',\r\n                    '[arrowright]': '\\u21E2',\r\n                    '[arrowdown]': '\\u21E3',\r\n                    '[digit0]': '0',\r\n                    '[digit1]': '1',\r\n                    '[digit2]': '2',\r\n                    '[digit3]': '3',\r\n                    '[digit4]': '4',\r\n                    '[digit5]': '5',\r\n                    '[digit6]': '6',\r\n                    '[digit7]': '7',\r\n                    '[digit8]': '8',\r\n                    '[digit9]': '9',\r\n                }[segment.toLowerCase()] ?? segment.toUpperCase();\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\nfunction normalizeKeybinding(keybinding: Keybinding): Keybinding {\r\n    if (\r\n        keybinding.ifPlatform &&\r\n        !/^!?(macos|windows|android|ios|chromeos|other)$/.test(\r\n            keybinding.ifPlatform\r\n        )\r\n    ) {\r\n        throw new Error(\r\n            `Unexpected platform \"${keybinding.ifPlatform}\" for keybinding ${keybinding.key}`\r\n        );\r\n    }\r\n    let segments = keybinding.key.split('+');\r\n    const key = segments.pop();\r\n    let platform = keybinding.ifPlatform;\r\n\r\n    segments = segments.map((segment) => {\r\n        const x = segment.toLowerCase();\r\n        if (x === 'cmd') {\r\n            if (platform && platform !== 'macos' && platform !== 'ios') {\r\n                throw new Error(\r\n                    'Unexpected \"cmd\" modifier with platform \"' + platform + '\"'\r\n                );\r\n            }\r\n            if (!platform) {\r\n                platform = matchPlatform('ios') ? 'ios' : 'macos';\r\n            }\r\n\r\n            return 'meta';\r\n        } else if (x === 'win') {\r\n            if (platform && platform !== 'windows') {\r\n                throw new Error(\r\n                    'Unexpected \"win\" modifier with platform \"' + platform + '\"'\r\n                );\r\n            }\r\n            platform = 'windows';\r\n            return 'meta';\r\n        }\r\n        return x;\r\n    });\r\n\r\n    if (platform && !matchPlatform(platform)) return undefined;\r\n\r\n    if (!/^\\[(.*)\\]$/.test(key)) {\r\n        // This is not a key code (e.g. `[KeyQ]`) it's a simple key (e.g. `a`)\r\n        // Convert it to a key code\r\n        const code = getCodeForKey(key);\r\n        if (!code) {\r\n            throw new Error('Invalid keybinding key \"' + keybinding.key + '\"');\r\n        }\r\n        segments = segments.concat(code.split('+'));\r\n    } else {\r\n        segments.push(key);\r\n    }\r\n\r\n    return { ...keybinding, ifPlatform: platform, key: segments.join('+') };\r\n}\r\n\r\n/**\r\n * Parse the input keybindings and return them normalized:\r\n * - 'keys' are transformed to 'code' according to the current keyboard layout\r\n * - keybindings that don't apply to the current platform are removed\r\n */\r\nexport function normalizeKeybindings(\r\n    keybindings: Keybinding[],\r\n    onError: (e: any) => void\r\n): Keybinding[] {\r\n    const result = [];\r\n    const errors = [];\r\n    keybindings.forEach((x) => {\r\n        try {\r\n            const keybinding = normalizeKeybinding(x);\r\n            if (keybinding) {\r\n                result.push(keybinding);\r\n            }\r\n        } catch (e) {\r\n            errors.push(e.message);\r\n        }\r\n    });\r\n    if (errors.length > 0) {\r\n        onError(errors);\r\n    }\r\n    return result;\r\n}\r\n","import { Atom } from '../core/atom-class';\r\nimport type { Range } from '../public/mathfield';\r\nimport { MathfieldPrivate } from './mathfield-private';\r\n\r\nexport type Rect = {\r\n    top: number;\r\n    bottom: number;\r\n    left: number;\r\n    right: number;\r\n};\r\n\r\nexport function on(\r\n    el: EventTarget,\r\n    inSelectors: string,\r\n    listener: EventListenerOrEventListenerObject,\r\n    options?: AddEventListenerOptions\r\n): void {\r\n    const selectors = inSelectors.split(' ');\r\n    for (const sel of selectors) {\r\n        const m = sel.match(/(.*):(.*)/);\r\n        if (m) {\r\n            const options2 = options ?? {};\r\n            if (m[2] === 'active') {\r\n                options2.passive = false;\r\n            } else {\r\n                options2[m[2]] = true;\r\n            }\r\n            el.addEventListener(m[1], listener, options2);\r\n        } else {\r\n            el.addEventListener(sel, listener, options);\r\n        }\r\n    }\r\n}\r\n\r\nexport function off(\r\n    el: EventTarget,\r\n    inSelectors: string,\r\n    listener: EventListenerOrEventListenerObject,\r\n    options?: AddEventListenerOptions\r\n): void {\r\n    const selectors = inSelectors.split(' ');\r\n    for (const sel of selectors) {\r\n        const m = sel.match(/(.*):(.*)/);\r\n        if (m) {\r\n            const options2 = options ?? {};\r\n            if (m[2] === 'active') {\r\n                options2.passive = false;\r\n            } else {\r\n                options2[m[2]] = true;\r\n            }\r\n            el.removeEventListener(m[1], listener, options2);\r\n        } else {\r\n            el.removeEventListener(sel, listener, options);\r\n        }\r\n    }\r\n}\r\n\r\nexport function getSharedElement(id: string, cls: string): HTMLElement {\r\n    let result = document.getElementById(id);\r\n    if (result) {\r\n        result.setAttribute(\r\n            'data-refcount',\r\n            Number(\r\n                parseInt(result.getAttribute('data-refcount')) + 1\r\n            ).toString()\r\n        );\r\n    } else {\r\n        result = document.createElement('div');\r\n        result.setAttribute('aria-hidden', 'true');\r\n        result.setAttribute('data-refcount', '1');\r\n        result.className = cls;\r\n        result.id = id;\r\n        document.body.appendChild(result);\r\n    }\r\n    return result;\r\n}\r\n\r\n// @revisit: check the elements are correctly released\r\nexport function releaseSharedElement(el: HTMLElement): void {\r\n    if (!el) return;\r\n    const refcount = parseInt(el.getAttribute('data-refcount'));\r\n    if (refcount <= 1) {\r\n        el.remove();\r\n    } else {\r\n        el.setAttribute('data-refcount', Number(refcount - 1).toString());\r\n    }\r\n}\r\n\r\n/**\r\n * Checks if the argument is a valid Mathfield.\r\n * After a Mathfield has been destroyed (for example by calling `dispose()`\r\n * the Mathfield is no longer valid. However, there may be some pending\r\n * operations invoked via requestAnimationFrame() for example, that would\r\n * need to ensure the mathfield is still valid by the time they're executed.\r\n */\r\nexport function isValidMathfield(mf: MathfieldPrivate): boolean {\r\n    return mf.element && mf.element['mathfield'] === mf;\r\n}\r\n\r\n/**\r\n * Return the element which has the caret\r\n */\r\nfunction findElementWithCaret(el: Element): Element {\r\n    return (\r\n        el.querySelector('.ML__caret') ??\r\n        el.querySelector('.ML__text-caret') ??\r\n        el.querySelector('.ML__command-caret')\r\n    );\r\n}\r\n\r\n/**\r\n * Return the (x,y) client coordinates of the caret\r\n */\r\nexport function getCaretPoint(\r\n    el: Element\r\n): { x: number; y: number; height: number } | null {\r\n    const caret = findElementWithCaret(el);\r\n    if (!caret) return null;\r\n    const bounds = caret.getBoundingClientRect();\r\n    return {\r\n        x: bounds.right,\r\n        y: bounds.bottom,\r\n        height: bounds.height,\r\n    };\r\n}\r\n\r\nfunction branchId(atom: Atom): string {\r\n    let result = atom.parent ? atom.parent.id : 'root';\r\n    if (typeof atom.treeBranch === 'string') {\r\n        result += '-' + atom.treeBranch;\r\n    } else {\r\n        result += `-${atom.treeBranch[0]}/${atom.treeBranch[0]}`;\r\n    }\r\n    return result;\r\n}\r\n\r\nfunction adjustForScrolling(\r\n    mathfield: MathfieldPrivate,\r\n    rect: Rect | null\r\n): Rect | null {\r\n    if (!rect) return null;\r\n    const fieldRect = mathfield.field.getBoundingClientRect();\r\n    const w = rect.right - rect.left;\r\n    const h = rect.bottom - rect.top;\r\n    const left = Math.ceil(\r\n        rect.left - fieldRect.left + mathfield.field.scrollLeft\r\n    );\r\n    const top = Math.ceil(rect.top - fieldRect.top);\r\n    return {\r\n        left: left,\r\n        right: left + w,\r\n        top: top,\r\n        bottom: top + h,\r\n    };\r\n}\r\n\r\nfunction getNodeBounds(node: Element): Rect {\r\n    const bounds = node.getBoundingClientRect();\r\n    const result: Rect = {\r\n        top: bounds.top,\r\n        bottom: bounds.bottom,\r\n        left: bounds.left,\r\n        right: bounds.right,\r\n    };\r\n    if (node.tagName !== 'svg') {\r\n        Array.from(node.children).forEach((x) => {\r\n            if (x.nodeType === 1) {\r\n                const r: Rect = getNodeBounds(x);\r\n                result.left = Math.min(result.left, r.left);\r\n                result.right = Math.max(result.right, r.right);\r\n                result.top = Math.min(result.top, r.top);\r\n                result.bottom = Math.max(result.bottom, r.bottom);\r\n            }\r\n        });\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function getAtomBounds(\r\n    mathfield: MathfieldPrivate,\r\n    atom: Atom\r\n): Rect | null {\r\n    const node = mathfield.field.querySelector(`[data-atom-id=\"${atom.id}\"]`);\r\n    if (!node) return null;\r\n    return getNodeBounds(node);\r\n}\r\n\r\n/*\r\n * Return an array of bounds for the specified branch, at most\r\n * one rect per branch.\r\n */\r\nexport function getRangeBounds(\r\n    mathfield: MathfieldPrivate,\r\n    range: Range\r\n): Rect[] {\r\n    // The key of the map is a 'branchId', i.e. \"atom id + branch\"\r\n    const rects = new Map<string, Rect>();\r\n\r\n    mathfield.model\r\n        .getAtoms(range, { includeChildren: true })\r\n        .forEach((x: Atom) => {\r\n            const bounds = adjustForScrolling(\r\n                mathfield,\r\n                getAtomBounds(mathfield, x)\r\n            );\r\n            if (bounds) {\r\n                const id = branchId(x);\r\n                if (rects.has(id)) {\r\n                    const r = rects.get(id);\r\n                    rects.set(id, {\r\n                        top: Math.min(r.top, bounds.top),\r\n                        bottom: Math.max(r.bottom, bounds.bottom),\r\n                        left: Math.min(r.left, bounds.left),\r\n                        right: Math.max(r.right, bounds.right),\r\n                    });\r\n                } else {\r\n                    rects.set(id, bounds);\r\n                }\r\n            }\r\n        });\r\n\r\n    return Array.from(rects.values());\r\n}\r\n\r\nexport function getSelectionBounds(mathfield: MathfieldPrivate): Rect[] {\r\n    return mathfield.model.selection.ranges.reduce(\r\n        (acc, x) => acc.concat(...getRangeBounds(mathfield, x)),\r\n        []\r\n    );\r\n}\r\n","import { on } from './utils';\r\nimport type { MathfieldPrivate } from './mathfield-private';\r\n\r\n/**\r\n * Attach event handlers to an element so that it will react by executing\r\n * a command when pressed.\r\n * `\"command\"` can be:\r\n * - a string, a single selector\r\n * - an array, whose first element is a selector followed by one or more arguments.\r\n * - an object, with the following keys:\r\n *    * 'default': command performed on up, with a down + up sequence with no\r\n *      delay between down and up\r\n *    * 'alt', 'shift', 'altshift' keys: command performed on up with\r\n *      one of these modifiers pressed\r\n *    * 'pressed': command performed on 'down'\r\n *    * 'pressAndHoldStart': command performed after a tap/down followed by a\r\n * delay (optional)\r\n *    * 'pressAndHoldEnd': command performed on up, if there was a delay\r\n *     between down and up, if absent, 'default' is performed\r\n * The value of the keys specify which selector (string\r\n * or array) to perform depending on the keyboard state when the button is\r\n * pressed.\r\n *\r\n * The 'pressed' and 'active' classes will get added to\r\n * the element, as the :hover and :active pseudo-classes are not reliable\r\n * (at least on Chrome Android).\r\n *\r\n */\r\nexport function attachButtonHandlers(\r\n    mathfield: MathfieldPrivate,\r\n    el: Element,\r\n    command:\r\n        | string\r\n        | {\r\n              default: string | any[];\r\n              pressed?: string | any[];\r\n              alt?: string | any[];\r\n              altshift?: string | any[];\r\n              shift?: string | any[];\r\n              pressAndHoldStart?: string | any[];\r\n              pressAndHoldEnd?: string | any[];\r\n          }\r\n): void {\r\n    if (typeof command === 'object' && (command.default || command.pressed)) {\r\n        // Attach the default (no modifiers pressed) command to the element\r\n        if (command.default) {\r\n            el.setAttribute(\r\n                'data-' + mathfield.options.namespace + 'command',\r\n                JSON.stringify(command.default)\r\n            );\r\n        }\r\n        if (command.alt) {\r\n            el.setAttribute(\r\n                'data-' + mathfield.options.namespace + 'command-alt',\r\n                JSON.stringify(command.alt)\r\n            );\r\n        }\r\n        if (command.altshift) {\r\n            el.setAttribute(\r\n                'data-' + mathfield.options.namespace + 'command-altshift',\r\n                JSON.stringify(command.altshift)\r\n            );\r\n        }\r\n        if (command.shift) {\r\n            el.setAttribute(\r\n                'data-' + mathfield.options.namespace + 'command-shift',\r\n                JSON.stringify(command.shift)\r\n            );\r\n        }\r\n        // .pressed: command to perform when the button is pressed (i.e.\r\n        // on mouse down/touch). Otherwise the command is performed when\r\n        // the button is released\r\n        if (command.pressed) {\r\n            el.setAttribute(\r\n                'data-' + mathfield.options.namespace + 'command-pressed',\r\n                JSON.stringify(command.pressed)\r\n            );\r\n        }\r\n        if (command.pressAndHoldStart) {\r\n            el.setAttribute(\r\n                'data-' +\r\n                    mathfield.options.namespace +\r\n                    'command-pressAndHoldStart',\r\n                JSON.stringify(command.pressAndHoldStart)\r\n            );\r\n        }\r\n        if (command.pressAndHoldEnd) {\r\n            el.setAttribute(\r\n                'data-' +\r\n                    mathfield.options.namespace +\r\n                    'command-pressAndHoldEnd',\r\n                JSON.stringify(command.pressAndHoldEnd)\r\n            );\r\n        }\r\n    } else {\r\n        // We need to turn the command into a string to attach it to the dataset\r\n        // associated with the button (the command could be an array made of a\r\n        // selector and one or more parameters)\r\n        el.setAttribute(\r\n            'data-' + mathfield.options.namespace + 'command',\r\n            JSON.stringify(command)\r\n        );\r\n    }\r\n    let pressHoldStart;\r\n    let pressHoldElement;\r\n    let touchID;\r\n    let syntheticTarget; // Target while touch move\r\n    let pressAndHoldTimer;\r\n    on(\r\n        el,\r\n        'mousedown touchstart:passive',\r\n        (ev: MouseEvent & TouchEvent & PointerEvent) => {\r\n            if (ev.type !== 'mousedown' || ev.buttons === 1) {\r\n                // The primary button was pressed or the screen was tapped.\r\n                ev.stopPropagation();\r\n                // Can't preventDefault() in a passive listener\r\n                if (ev.type !== 'touchstart') {\r\n                    ev.preventDefault();\r\n                }\r\n                el.classList.add('pressed');\r\n                pressHoldStart = Date.now();\r\n                // Record the ID of the primary touch point for tracking on touchmove\r\n                if (ev.type === 'touchstart') {\r\n                    touchID = ev.changedTouches[0].identifier;\r\n                }\r\n                // Parse the JSON to get the command (and its optional arguments)\r\n                // and perform it immediately\r\n                const command = el.getAttribute(\r\n                    'data-' + mathfield.options.namespace + 'command-pressed'\r\n                );\r\n                if (command) {\r\n                    mathfield.executeCommand(JSON.parse(command));\r\n                }\r\n                // If there is a `press and hold start` command, perform it\r\n                // after a delay, if we're still pressed by then.\r\n                const pressAndHoldStartCommand = el.getAttribute(\r\n                    'data-' +\r\n                        mathfield.options.namespace +\r\n                        'command-pressAndHoldStart'\r\n                );\r\n                if (pressAndHoldStartCommand) {\r\n                    pressHoldElement = el;\r\n                    if (pressAndHoldTimer) {\r\n                        clearTimeout(pressAndHoldTimer);\r\n                    }\r\n                    pressAndHoldTimer = window.setTimeout(function () {\r\n                        if (el.classList.contains('pressed')) {\r\n                            mathfield.executeCommand(\r\n                                JSON.parse(pressAndHoldStartCommand)\r\n                            );\r\n                        }\r\n                    }, 300);\r\n                }\r\n            }\r\n        }\r\n    );\r\n    on(el, 'mouseleave touchcancel', () => {\r\n        el.classList.remove('pressed');\r\n        // let command = el.getAttribute('data-' + mathfield.config.namespace +\r\n        //     'command-pressAndHoldEnd');\r\n        // const now = Date.now();\r\n        // if (command && now > pressHoldStart + 300) {\r\n        //     mathfield.executeCommand(JSON.parse(command));\r\n        // }\r\n    });\r\n    on(\r\n        el,\r\n        'touchmove:passive',\r\n        (ev: MouseEvent & TouchEvent & PointerEvent) => {\r\n            // Unlike with mouse tracking, touch tracking only sends events\r\n            // to the target that was originally tapped on. For consistency,\r\n            // we want to mimic the behavior of the mouse interaction by\r\n            // tracking the touch events and dispatching them to potential targets\r\n            // ev.preventDefault(); // can't preventDefault inside a passive event handler\r\n            for (let i = 0; i < ev.changedTouches.length; i++) {\r\n                if (ev.changedTouches[i].identifier === touchID) {\r\n                    // Found a touch matching our primary/tracked touch\r\n                    const target = document.elementFromPoint(\r\n                        ev.changedTouches[i].clientX,\r\n                        ev.changedTouches[i].clientY\r\n                    );\r\n                    if (target !== syntheticTarget && syntheticTarget) {\r\n                        syntheticTarget.dispatchEvent(\r\n                            new MouseEvent('mouseleave'),\r\n                            { bubbles: true }\r\n                        );\r\n                        syntheticTarget = null;\r\n                    }\r\n                    if (target) {\r\n                        syntheticTarget = target;\r\n                        target.dispatchEvent(\r\n                            new MouseEvent('mouseenter', {\r\n                                bubbles: true,\r\n                                buttons: 1,\r\n                            })\r\n                        );\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    );\r\n    on(el, 'mouseenter', (ev: MouseEvent & TouchEvent & PointerEvent) => {\r\n        if (ev.buttons === 1) {\r\n            el.classList.add('pressed');\r\n        }\r\n    });\r\n    on(\r\n        el,\r\n        'mouseup touchend click',\r\n        (ev: MouseEvent & TouchEvent & PointerEvent) => {\r\n            if (syntheticTarget) {\r\n                ev.stopPropagation();\r\n                ev.preventDefault();\r\n                const target = syntheticTarget;\r\n                syntheticTarget = null;\r\n                target.dispatchEvent(\r\n                    new MouseEvent('mouseup', { bubbles: true })\r\n                );\r\n                return;\r\n            }\r\n            el.classList.remove('pressed');\r\n            el.classList.add('active');\r\n            if (ev.type === 'click' && ev.detail !== 0) {\r\n                // This is a click event triggered by a mouse interaction\r\n                // (and not a keyboard interaction)\r\n                // Ignore it, we'll handle the mouseup (or touchend) instead.\r\n                ev.stopPropagation();\r\n                ev.preventDefault();\r\n                return;\r\n            }\r\n            // Since we want the active state to be visible for a while,\r\n            // use a timer to remove it after a short delay\r\n            window.setTimeout(function () {\r\n                el.classList.remove('active');\r\n            }, 150);\r\n            let command = el.getAttribute(\r\n                'data-' +\r\n                    mathfield.options.namespace +\r\n                    'command-pressAndHoldEnd'\r\n            );\r\n            const now = Date.now();\r\n            // If the button has not been pressed for very long or if we were\r\n            // not the button that started the press and hold, don't consider\r\n            // it a press-and-hold.\r\n            if (el !== pressHoldElement || now < pressHoldStart + 300) {\r\n                command = undefined;\r\n            }\r\n            if (!command && ev.altKey && ev.shiftKey) {\r\n                command = el.getAttribute(\r\n                    'data-' + mathfield.options.namespace + 'command-altshift'\r\n                );\r\n            }\r\n            if (!command && ev.altKey) {\r\n                command = el.getAttribute(\r\n                    'data-' + mathfield.options.namespace + 'command-alt'\r\n                );\r\n            }\r\n            if (!command && ev.shiftKey) {\r\n                command = el.getAttribute(\r\n                    'data-' + mathfield.options.namespace + 'command-shift'\r\n                );\r\n            }\r\n            if (!command) {\r\n                command = el.getAttribute(\r\n                    'data-' + mathfield.options.namespace + 'command'\r\n                );\r\n            }\r\n            if (command) {\r\n                // Parse the JSON to get the command (and its optional arguments)\r\n                // and perform it\r\n                mathfield.executeCommand(JSON.parse(command));\r\n            }\r\n            ev.stopPropagation();\r\n            ev.preventDefault();\r\n        }\r\n    );\r\n}\r\n","import { isArray } from '../common/types';\r\n\r\nimport {\r\n    MATHSTYLES,\r\n    makeSpan,\r\n    makeStruts,\r\n    parseString,\r\n    Atom,\r\n} from '../core/core';\r\n\r\nimport { getKeybindingsForCommand } from './keybindings';\r\nimport { attachButtonHandlers } from '../editor-mathfield/buttons';\r\nimport { getCaretPoint } from '../editor-mathfield/utils';\r\n\r\nimport type { MathfieldPrivate } from '../editor-mathfield/mathfield-private';\r\n\r\n// A textual description of a LaTeX command.\r\n// The value can be either a single string, or an array of string\r\n// in order to provide alternatives or additional context.\r\n// In that case, the first string in the array should be appropriate\r\n// to be spoken for accessibility.\r\nexport const NOTES = {\r\n    '\\\\text': 'roman text',\r\n    '\\\\textrm': 'roman text',\r\n    '\\\\textnormal': 'roman text',\r\n    '\\\\textit': 'italic text',\r\n    '\\\\textbf': 'bold text',\r\n    '\\\\texttt': 'monospaced text',\r\n    '\\\\textsf': 'sans-serif text',\r\n    '\\\\mathrm': ['roman', '(upright)'],\r\n    '\\\\mathbf': 'bold',\r\n    '\\\\bf': 'bold',\r\n    '\\\\bold': 'bold',\r\n    '\\\\mathit': 'italic',\r\n    '\\\\mathbb': 'blackboard',\r\n    '\\\\mathscr': 'script',\r\n    '\\\\mathtt': ['typewriter', '(monospaced)'],\r\n    '\\\\mathsf': 'sans-serif',\r\n    '\\\\mathcal': 'caligraphic',\r\n    '\\\\frak': ['fraktur', '(gothic)'],\r\n    '\\\\mathfrak': ['fraktur', '(gothic)'],\r\n\r\n    '\\\\textcolor': 'text color',\r\n    '\\\\color': 'color',\r\n\r\n    '\\\\forall': 'for all',\r\n    '\\\\exists': 'there exists',\r\n    '\\\\nexists': 'there does not exist',\r\n    '\\\\frac': 'fraction',\r\n    '\\\\dfrac': 'display fraction',\r\n    '\\\\cfrac': 'continuous fraction',\r\n    '\\\\tfrac': 'text fraction',\r\n    '\\\\binom': 'binomial coefficient',\r\n    '\\\\dbinom': 'display binomial coefficient',\r\n    '\\\\tbinom': 'text binomial coefficient',\r\n    '\\\\pdiff': 'partial differential',\r\n\r\n    '\\\\vec': 'vector',\r\n    '\\\\check': 'caron',\r\n    '\\\\acute': 'acute',\r\n    '\\\\breve': 'breve',\r\n    '\\\\tilde': 'tilde',\r\n    '\\\\dot': 'dot',\r\n    '\\\\hat': ['hat', 'circumflex'],\r\n    '\\\\ddot': 'double dot',\r\n    '\\\\bar': 'bar',\r\n\r\n    '\\\\prime': 'prime',\r\n    '\\\\doubleprime': 'double prime',\r\n    '\\\\varnothing': 'empty set',\r\n    '\\\\emptyset': 'empty set',\r\n    '\\\\subseteq': 'subset of or <br>equal to',\r\n    '\\\\supseteq': 'superset of or <br>equal to',\r\n    '\\\\supset': 'superset of',\r\n    '\\\\subset': 'subset of',\r\n    '\\\\partial': 'partial derivative',\r\n    '\\\\bigcup': 'union',\r\n    '\\\\bigcap': 'intersection',\r\n    '\\\\approx': 'approximately equal to',\r\n    '\\\\notin': 'not an element of',\r\n    '\\\\in': ['element of', 'included in'],\r\n    '\\\\infty': 'infinity',\r\n    '\\\\land': 'logical and',\r\n    '\\\\sqrt': 'square root',\r\n    '\\\\prod': 'product',\r\n    '\\\\sum': 'summation',\r\n    '\\\\amalg': ['amalgamation', 'coproduct', 'free product', 'disjoint union'],\r\n    '\\\\cup': 'union with',\r\n    '\\\\cap': 'intersection with',\r\n    '\\\\int': 'integral',\r\n    '\\\\iint': 'surface integral',\r\n    '\\\\oint': 'curve integral',\r\n    '\\\\iiint': 'volume integral',\r\n    '\\\\iff': 'if and only if',\r\n    '\\\\ln': 'natural logarithm',\r\n    '\\\\boldsymbol': 'bold',\r\n    '\\\\setminus': 'set subtraction',\r\n    '\\\\stackrel': 'relation with symbol above',\r\n    '\\\\stackbin': 'operator with symbol above',\r\n    '\\\\underset': 'symbol with annotation below',\r\n    '\\\\overset': 'symbol with annotation above',\r\n    '\\\\hslash': ['h-bar', 'Planck constant'],\r\n    '\\\\gtrsim': 'greater than or <br>similar to',\r\n    '\\\\propto': 'proportional to',\r\n    '\\\\equiv': 'equivalent to',\r\n\r\n    '\\\\!': ['negative thin space', '(-3 mu)'],\r\n    '\\\\ ': ['space', '(6 mu)'],\r\n    '\\\\,': ['thin space', '(3 mu)'],\r\n    '\\\\:': ['medium space', '(4 mu)'],\r\n    '\\\\;': ['thick space', '(5 mu)'],\r\n    '\\\\quad': ['1 em space', '(18 mu)'],\r\n    '\\\\qquad': ['2 em space', '(36 mu)'],\r\n    '\\\\enskip': ['&#189; em space', '(9 mu)'],\r\n\r\n    '\\\\mp': 'minus or plus',\r\n    '\\\\pm': 'plus or minus',\r\n    '\\\\Im': 'Imaginary part of',\r\n    '\\\\Re': 'Real part of',\r\n    '\\\\gothicCapitalR': 'Real part of',\r\n    '\\\\gothicCapitalI': 'Imaginary part part of',\r\n    '\\\\differentialD': 'differential d',\r\n    '\\\\aleph': [\r\n        'aleph',\r\n        'infinite cardinal',\r\n        '<a target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Cardinal_number\">Wikipedia <big>&#x203A;</big></a>',\r\n    ],\r\n    '\\\\beth': [\r\n        'beth',\r\n        'beth number',\r\n        '<a target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Beth_number\">Wikipedia <big>&#x203A;</big></a>',\r\n    ],\r\n    '\\\\gimel': [\r\n        'gimel',\r\n        'gimel function',\r\n        '<a target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Gimel_function\">Wikipedia <big>&#x203A;</big></a>',\r\n    ],\r\n\r\n    '\\\\O': 'empty set',\r\n    '\\\\N': 'set of <br>natural numbers',\r\n    '\\\\Z': 'set of <br>integers',\r\n    '\\\\Q': 'set of <br>rational numbers',\r\n    '\\\\C': 'set of <br>complex numbers',\r\n    '\\\\R': 'set of <br>real numbers',\r\n    '\\\\P': 'set of <br>prime numbers',\r\n\r\n    '\\\\lesseqqgtr': 'less than, equal to or<br> greater than',\r\n    '\\\\gnapprox': 'greater than and <br>not approximately',\r\n    '\\\\lnapprox': 'lesser than and <br>not approximately',\r\n\r\n    '\\\\j': 'dotless j',\r\n    '\\\\i': 'dotless i',\r\n    '\\\\cdot': 'centered dot',\r\n    '\\\\lmoustache': 'left moustache',\r\n    '\\\\rmoustache': 'right moustache',\r\n    '\\\\nabla': ['nabla', 'del', 'differential vector operator'],\r\n\r\n    '\\\\square': [\r\n        'square',\r\n        'dAlembert operator',\r\n        '<a target=\"_blank\" href=\"https://en.wikipedia.org/wiki/D%27Alembert_operator\">Wikipedia <big>&#x203A;</big></a>',\r\n    ],\r\n    '\\\\blacksquare': [\r\n        'black square',\r\n        'end of proof',\r\n        'tombstone',\r\n        'Halmos symbol',\r\n    ],\r\n    '\\\\Box': 'end of proof',\r\n    '\\\\colon': ['such that', 'ratio'],\r\n    '\\\\coloneq': ['is defined by', 'is assigned'],\r\n    '\\\\Colon': ['is defined by', 'as'],\r\n    '\\\\_': ['underbar', 'underscore'],\r\n    '\\\\ll': 'much less than',\r\n    '\\\\gg': 'much greater than',\r\n    '\\\\doteq': 'approximately equal to',\r\n    '\\\\Doteq': 'approximately equal to',\r\n    '\\\\doteqdot': 'approximately equal to',\r\n    '\\\\cong': ['isomorphism of', '(for algebras, modules...)'],\r\n    '\\\\det': ['determinant of', '(of a matrix)'],\r\n    '\\\\dotplus': 'Cartesian product algebra',\r\n    '\\\\otimes': [\r\n        'tensor product',\r\n        '(of algebras)',\r\n        'Kronecker product',\r\n        '(of matrices)',\r\n    ],\r\n    '\\\\oplus': ['direct sum', '(of modules)'],\r\n    '\\\\lb': 'base-2 logarithm',\r\n    '\\\\lg': 'base-10 logarithm',\r\n    '\\\\wp': [\r\n        'Weierstrass P',\r\n        '<a target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Weierstrass%27s_elliptic_functions\">Wikipedia <big>&#x203A;</big></a>',\r\n    ],\r\n    '\\\\wr': [\r\n        'wreath product',\r\n        '<a target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Wreath_product\">Wikipedia <big>&#x203A;</big></a>',\r\n    ],\r\n    '\\\\top': ['tautology', 'Proposition P is universally true'],\r\n    '\\\\bot': ['contradiction', 'Proposition P is contradictory'],\r\n    '\\\\mid': ['probability', 'of event A given B'],\r\n    '\\\\mho': [\r\n        'Siemens',\r\n        'electrical conductance in SI unit',\r\n        '<a target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Siemens_(unit)\">Wikipedia <big>&#x203A;</big></a>',\r\n    ],\r\n\r\n    '\\\\Longrightarrow': 'implies',\r\n    '\\\\Longleftrightarrow': 'if, and only if,',\r\n\r\n    '\\\\prec': 'precedes',\r\n    '\\\\preceq': 'precedes or is equal to',\r\n    '\\\\succ': 'succeedes',\r\n    '\\\\succeq': 'succeedes or is equal to',\r\n    '\\\\perp': ['is perpendicular to', 'is independent of'],\r\n\r\n    '\\\\models': [\r\n        'entails',\r\n        'double-turnstyle, models',\r\n        'is a semantic consequence of',\r\n        '<a target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Double_turnstile\">Wikipedia <big>&#x203A;</big></a>',\r\n    ],\r\n    '\\\\vdash': [\r\n        'satisfies',\r\n        'turnstyle, assertion sign',\r\n        'syntactic inference',\r\n        '<a target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Turnstile_(symbol)\">Wikipedia <big>&#x203A;</big></a>',\r\n    ],\r\n\r\n    '\\\\implies': ['implies', 'logical consequence'],\r\n    '\\\\impliedby': ['implied by', 'logical consequence'],\r\n\r\n    '\\\\surd': ['surd', 'root of', 'checkmark'],\r\n    '\\\\ltimes': [\r\n        'semi direct product',\r\n        '<a target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Semidirect_product\">Wikipedia <big>&#x203A;</big></a>',\r\n    ],\r\n    '\\\\rtimes': [\r\n        'semi direct product',\r\n        '<a target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Semidirect_product\">Wikipedia <big>&#x203A;</big></a>',\r\n    ],\r\n    '\\\\leftthreetimes': [\r\n        'semi direct product',\r\n        '<a target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Semidirect_product\">Wikipedia <big>&#x203A;</big></a>',\r\n    ],\r\n    '\\\\rightthreetimes': [\r\n        'semi direct product',\r\n        '<a target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Semidirect_product\">Wikipedia <big>&#x203A;</big></a>',\r\n    ],\r\n    '\\\\divideontimes': ['divide on times'],\r\n    '\\\\curlywedge': 'nor',\r\n    '\\\\curlyvee': 'nand',\r\n\r\n    '\\\\simeq': 'is group isomorphic with',\r\n    '\\\\vartriangleleft': ['is a normal subgroup of', 'is an ideal ring of'],\r\n\r\n    '\\\\circ': ['circle', 'ring', 'function composition'],\r\n\r\n    '\\\\rlap': ['overlap right', '\\\\rlap{x}o'],\r\n    '\\\\llap': ['overlap left', 'o\\\\llap{/}'],\r\n    '\\\\colorbox': ['color box', '\\\\colorbox{#fbc0bd}{...}'],\r\n    '\\\\ast': ['asterisk', 'reflexive closure (as a superscript)'],\r\n    '\\\\bullet': 'bullet',\r\n\r\n    '\\\\lim': 'limit',\r\n};\r\n\r\nfunction getNote(symbol): string {\r\n    let result = NOTES[symbol] || '';\r\n    if (isArray(result)) {\r\n        result = result.join('<br>');\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nfunction latexToMarkup(latex: string, mf: MathfieldPrivate): string {\r\n    const parse = parseString(latex, 'math', null, mf.options.macros);\r\n    const spans = Atom.render(\r\n        {\r\n            mathstyle: MATHSTYLES.displaystyle,\r\n            macros: mf.options.macros,\r\n        },\r\n        parse\r\n    );\r\n\r\n    const wrapper = makeStruts(makeSpan(spans, 'ML__base'), 'ML__mathlive');\r\n\r\n    return wrapper.toMarkup();\r\n}\r\n\r\nexport function showPopoverWithLatex(\r\n    mf: MathfieldPrivate,\r\n    latex: string,\r\n    displayArrows: boolean\r\n): void {\r\n    if (!latex || latex.length === 0) {\r\n        hidePopover(mf);\r\n        return;\r\n    }\r\n\r\n    const command = latex;\r\n    const commandMarkup = latexToMarkup(latex, mf);\r\n    const commandNote = getNote(command);\r\n    const keybinding = getKeybindingsForCommand(mf.keybindings, command).join(\r\n        '<br>'\r\n    );\r\n\r\n    let template = displayArrows\r\n        ? '<div class=\"ML__popover__prev-shortcut\" role=\"button\" aria-label=\"Previous suggestion\"><span><span>&#x25B2;</span></span></div>'\r\n        : '';\r\n    template += '<span class=\"ML__popover__content\" role=\"button\">';\r\n    template += '<div class=\"ML__popover__command\">' + commandMarkup + '</div>';\r\n    if (commandNote) {\r\n        template += '<div class=\"ML__popover__note\">' + commandNote + '</div>';\r\n    }\r\n    if (keybinding) {\r\n        template +=\r\n            '<div class=\"ML__popover__shortcut\">' + keybinding + '</div>';\r\n    }\r\n    template += '</span>';\r\n    template += displayArrows\r\n        ? '<div class=\"ML__popover__next-shortcut\" role=\"button\" aria-label=\"Next suggestion\"><span><span>&#x25BC;</span></span></div>'\r\n        : '';\r\n    showPopover(mf, template);\r\n\r\n    let el = mf.popover.getElementsByClassName('ML__popover__content');\r\n    if (el && el.length > 0) {\r\n        attachButtonHandlers(mf, el[0], {\r\n            default: ['complete', 'accept-with-suggestion'],\r\n        });\r\n    }\r\n\r\n    el = mf.popover.getElementsByClassName('ML__popover__prev-shortcut');\r\n    if (el && el.length > 0) {\r\n        attachButtonHandlers(mf, el[0], 'previousSuggestion');\r\n    }\r\n\r\n    el = mf.popover.getElementsByClassName('ML__popover__next-shortcut');\r\n    if (el && el.length > 0) {\r\n        attachButtonHandlers(mf, el[0], 'nextSuggestion');\r\n    }\r\n}\r\n\r\nexport function updatePopoverPosition(\r\n    mf: MathfieldPrivate,\r\n    options?: { deferred: boolean }\r\n): void {\r\n    // Check that the mathfield is still valid\r\n    // (we're calling ourselves from requestAnimationFrame() and the mathfield\r\n    // could have gotten destroyed\r\n    if (!mf.element || mf.element['mathfield'] !== mf) return;\r\n\r\n    // If the popover pane is visible...\r\n    if (!mf.popover.classList.contains('is-visible')) return;\r\n    if (options?.deferred) {\r\n        // Call ourselves again later, typically after the\r\n        // rendering/layout of the DOM has been completed\r\n        // (don't do it on next frame, it might be too soon)\r\n        window.setTimeout(() => updatePopoverPosition(mf), 100);\r\n        return;\r\n    }\r\n    if (mf.model.at(mf.model.position)?.type !== 'command') {\r\n        hidePopover(mf);\r\n    } else {\r\n        // ... get the caret position\r\n        const caretPoint = getCaretPoint(mf.field);\r\n        if (caretPoint) setPopoverPosition(mf, caretPoint);\r\n    }\r\n}\r\n\r\nexport function showPopover(mf: MathfieldPrivate, markup: string): void {\r\n    mf.popover.innerHTML = mf.options.createHTML(markup);\r\n\r\n    const caretPoint = getCaretPoint(mf.field);\r\n    if (caretPoint) setPopoverPosition(mf, caretPoint);\r\n\r\n    mf.popover.classList.add('is-visible');\r\n}\r\n\r\nfunction setPopoverPosition(\r\n    mf: MathfieldPrivate,\r\n    position: { x: number; y: number; height: number }\r\n): void {\r\n    // get screen width & height (browser compatibility)\r\n    const screenHeight =\r\n        window.innerHeight ||\r\n        document.documentElement.clientHeight ||\r\n        document.body.clientHeight;\r\n    const screenWidth =\r\n        window.innerWidth ||\r\n        document.documentElement.clientWidth ||\r\n        document.body.clientWidth;\r\n\r\n    // get scrollbar size. This would be 0 in mobile device (also no needed).\r\n    const scrollbarWidth =\r\n        window.innerWidth - document.documentElement.clientWidth;\r\n    const scrollbarHeight =\r\n        window.innerHeight - document.documentElement.clientHeight;\r\n    const virtualkeyboardHeight = mf.virtualKeyboardVisible\r\n        ? mf.virtualKeyboard.offsetHeight\r\n        : 0;\r\n    // prevent screen overflow horizontal.\r\n    if (\r\n        position.x + mf.popover.offsetWidth / 2 >\r\n        screenWidth - scrollbarWidth\r\n    ) {\r\n        mf.popover.style.left =\r\n            screenWidth - mf.popover.offsetWidth - scrollbarWidth + 'px';\r\n    } else if (position.x - mf.popover.offsetWidth / 2 < 0) {\r\n        mf.popover.style.left = '0';\r\n    } else {\r\n        mf.popover.style.left = position.x - mf.popover.offsetWidth / 2 + 'px';\r\n    }\r\n\r\n    // and position the popover right below or above the caret\r\n    if (\r\n        position.y + mf.popover.offsetHeight + 5 >\r\n        screenHeight - scrollbarHeight - virtualkeyboardHeight\r\n    ) {\r\n        mf.popover.classList.add('ML__popover--reverse-direction');\r\n        mf.popover.style.top =\r\n            position.y - position.height - mf.popover.offsetHeight - 5 + 'px';\r\n    } else {\r\n        mf.popover.classList.remove('ML__popover--reverse-direction');\r\n        mf.popover.style.top = position.y + 5 + 'px';\r\n    }\r\n}\r\n\r\nexport function hidePopover(mf: MathfieldPrivate): void {\r\n    mf.popover.classList.remove('is-visible');\r\n}\r\n","import { Atom } from '../core/atom-class';\nimport { Span } from '../core/span';\nimport { Context } from '../core/context';\nimport { Style } from '../public/core';\n\nexport class CommandAtom extends Atom {\n    isSuggestion?: boolean; // This atom is a suggestion\n    isError?: boolean;\n    constructor(\n        value: string,\n        options?: {\n            isSuggestion: boolean;\n        }\n    ) {\n        super('command', { value, mode: 'command' });\n        if (options?.isSuggestion) {\n            this.isSuggestion = true;\n        }\n    }\n    get computedStyle(): Style {\n        return {};\n    }\n    render(context: Context): Span[] {\n        const result = this.makeSpan(context, this.value);\n        result.classes = ''; // Override fonts and other attributes.\n        if (this.isSuggestion) {\n            result.classes = ' ML__suggestion';\n        } else if (this.isError) {\n            result.classes = ' ML__error';\n        }\n        if (this.caret) result.caret = this.caret;\n        return [result];\n    }\n}\n","import type { Range } from '../public/mathfield';\r\nimport { CommandAtom } from '../core-atoms/command';\r\nimport type { ModelPrivate } from './model-private';\r\n\r\n/**\r\n * Return the range of the command in the expression or\r\n * `[undefined, undefined]`.\r\n *\r\n * (There should be at most one command in an expression)\r\n */\r\nexport function getCommandRange(model: ModelPrivate): Range {\r\n    let start = 0;\r\n    let found = false;\r\n    while (start <= model.lastOffset && !found) {\r\n        found = model.at(start) instanceof CommandAtom;\r\n        if (!found) start++;\r\n    }\r\n    if (!found) return [undefined, undefined];\r\n\r\n    let end = start;\r\n    let done = false;\r\n    while (end <= model.lastOffset && !done) {\r\n        done = !(model.at(end) instanceof CommandAtom);\r\n        end++;\r\n    }\r\n    return [start - 1, end - 1];\r\n}\r\n\r\nexport function getCommandSuggestionRange(model: ModelPrivate): Range {\r\n    let start = 0;\r\n    let found = false;\r\n    while (start <= model.lastOffset && !found) {\r\n        const atom = model.at(start);\r\n        found = atom instanceof CommandAtom && atom.isSuggestion;\r\n        if (!found) start++;\r\n    }\r\n    if (!found) return [undefined, undefined];\r\n\r\n    let end = start;\r\n    let done = false;\r\n    while (end <= model.lastOffset && !done) {\r\n        const atom = model.at(end);\r\n        done = !(atom instanceof CommandAtom && atom.isSuggestion);\r\n        end++;\r\n    }\r\n    return [start - 1, end - 1];\r\n}\r\n\r\nexport function getCommandAtoms(model: ModelPrivate): CommandAtom[] {\r\n    return model.getAtoms(getCommandRange(model));\r\n}\r\n\r\nexport function getCommandString(\r\n    model: ModelPrivate,\r\n    options?: { withSuggestion: boolean }\r\n): string {\r\n    const commandAtoms = getCommandAtoms(model);\r\n    if (options?.withSuggestion ?? false) {\r\n        return commandAtoms.map((x) => x.value).join('');\r\n    }\r\n    return commandAtoms\r\n        .filter((x) => !x.isSuggestion)\r\n        .map((x) => x.value)\r\n        .join('');\r\n}\r\n","import { makeSpan, makeStruts } from '../core/span';\r\nimport { MATHSTYLES } from '../core/mathstyle';\r\n\r\nimport { Rect, getSelectionBounds, isValidMathfield } from './utils';\r\nimport type { MathfieldPrivate } from './mathfield-private';\r\n\r\nimport { atomsToMathML } from '../addons/math-ml';\r\nimport { Atom, Context } from '../core/core';\r\n\r\n/*\r\n * Return a hash (32-bit integer) representing the content of the mathfield\r\n * (but not the selection state)\r\n */\r\nfunction hash(latex: string): number {\r\n    let result = 0;\r\n    for (let i = 0; i < latex.length; i++) {\r\n        result = result * 31 + latex.charCodeAt(i);\r\n        result = result | 0; // Force it to a 32-bit number\r\n    }\r\n    return Math.abs(result);\r\n}\r\n\r\nexport function requestUpdate(mathfield: MathfieldPrivate): void {\r\n    if (!mathfield.dirty) {\r\n        mathfield.dirty = true;\r\n        requestAnimationFrame(() => {\r\n            if (isValidMathfield(mathfield) && mathfield.dirty) {\r\n                render(mathfield);\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n * Lay-out the mathfield and generate the DOM.\r\n *\r\n * This is usually done automatically, but if the font-size, or other geometric\r\n * attributes are modified, outside of MathLive, this function may need to be\r\n * called explicitly.\r\n *\r\n */\r\nexport function render(\r\n    mathfield: MathfieldPrivate,\r\n    renderOptions?: { forHighlighting?: boolean }\r\n): void {\r\n    renderOptions = renderOptions ?? {};\r\n    mathfield.dirty = false;\r\n    const model = mathfield.model;\r\n\r\n    //\r\n    // 1. Stop and reset read aloud state\r\n    //\r\n    if (!window['mathlive']) {\r\n        window['mathlive'] = {};\r\n    }\r\n    //\r\n    // 2. Update selection state and blinking cursor (caret)\r\n    //\r\n    model.root.caret = undefined;\r\n    model.root.isSelected = false;\r\n    model.root.containsCaret = false;\r\n    model.atoms.forEach((a) => {\r\n        a.caret = undefined;\r\n        a.isSelected = false;\r\n        a.containsCaret = false;\r\n    });\r\n    const hasFocus = mathfield.hasFocus() && !mathfield.options.readOnly;\r\n    if (model.selectionIsCollapsed) {\r\n        model.at(model.position).caret = hasFocus ? mathfield.mode : '';\r\n    } else {\r\n        model\r\n            .getAtoms(model.selection, { includeChildren: true })\r\n            .forEach((x) => {\r\n                x.isSelected = true;\r\n            });\r\n    }\r\n\r\n    if (hasFocus) {\r\n        let ancestor = model.at(model.position).parent;\r\n        let done = false;\r\n        while (ancestor && !done) {\r\n            // The `surd` and `leftright` types of atom have a special display,\r\n            // mark the first of them in the path from the caret (`position`) to\r\n            // the root  as such.\r\n            if (ancestor.type === 'surd' || ancestor.type === 'leftright') {\r\n                ancestor.containsCaret = true;\r\n                done = true;\r\n            }\r\n            ancestor = ancestor.parent;\r\n        }\r\n    }\r\n    //\r\n    // 3. Render spans\r\n    //\r\n    const spans = model.root.render(\r\n        new Context({\r\n            mathstyle: MATHSTYLES.displaystyle,\r\n            letterShapeStyle: mathfield.options.letterShapeStyle,\r\n            atomIdsSettings: {\r\n                // Using the hash as a seed for the ID\r\n                // keeps the IDs the same until the content of the field changes.\r\n                seed: hash(Atom.toLatex(model.root, { expandMacro: false })),\r\n                // The `groupNumbers` flag indicates that extra spans should be generated\r\n                // to represent group of atoms, for example, a span to group\r\n                // consecutive digits to represent a number.\r\n                groupNumbers: renderOptions.forHighlighting,\r\n            },\r\n            smartFence: mathfield.options.smartFence,\r\n            macros: mathfield.options.macros,\r\n        })\r\n    );\r\n\r\n    //\r\n    // 4. Construct struts around the spans\r\n    //\r\n    const base = makeSpan(spans, 'ML__base');\r\n    base.setTop(base.height - base.depth);\r\n    const wrapper = makeStruts(base, 'ML__mathlive');\r\n    wrapper.attributes = {\r\n        // Sometimes Google Translate kicks in an attempts to 'translate' math\r\n        // This doesn't work very well, so turn off translate\r\n        translate: 'no',\r\n        // Hint to screen readers to not attempt to read this <span>.\r\n        // They should use instead the 'aria-label' attribute.\r\n        'aria-hidden': 'true',\r\n    };\r\n\r\n    //\r\n    // 5. Generate markup and accessible node\r\n    //\r\n    const isFocused = mathfield.field.classList.contains('ML__focused');\r\n    if (isFocused && !hasFocus) {\r\n        mathfield.field.classList.remove('ML__focused');\r\n    } else if (!isFocused && hasFocus) {\r\n        mathfield.field.classList.add('ML__focused');\r\n    }\r\n    mathfield.field.innerHTML = mathfield.options.createHTML(\r\n        wrapper.toMarkup({\r\n            hskip: 0,\r\n            hscale: mathfield.options.horizontalSpacingScale,\r\n        })\r\n    );\r\n    mathfield.fieldContent = mathfield.field.querySelector('.ML__mathlive');\r\n\r\n    mathfield.accessibleNode.innerHTML = mathfield.options.createHTML(\r\n        '<math xmlns=\"http://www.w3.org/1998/Math/MathML\">' +\r\n            atomsToMathML(model.root, mathfield.options) +\r\n            '</math>'\r\n    );\r\n\r\n    //\r\n    // 6. Render the selection\r\n    //\r\n    if (!model.selectionIsCollapsed) {\r\n        renderSelection(mathfield);\r\n        // (re-render a bit later because the layout, sometimes, is not\r\n        // up to date by now)\r\n        setTimeout(() => renderSelection(mathfield), 32);\r\n    }\r\n}\r\n\r\nfunction renderSelection(mathfield: MathfieldPrivate): void {\r\n    mathfield.field.querySelectorAll('.ML__selection').forEach((x) => {\r\n        x.parentElement.removeChild(x);\r\n    });\r\n    const selectionRects: Rect[] = getSelectionBounds(mathfield);\r\n    selectionRects.forEach((x) => {\r\n        const selectionElement = document.createElement('div');\r\n        selectionElement.classList.add('ML__selection');\r\n        selectionElement.style.position = 'absolute';\r\n        selectionElement.style.left = `${x.left}px`;\r\n        selectionElement.style.top = `${x.top}px`;\r\n        selectionElement.style.width = `${Math.ceil(x.right - x.left)}px`;\r\n        selectionElement.style.height = `${Math.ceil(x.bottom - x.top - 1)}px`;\r\n        mathfield.field.insertBefore(\r\n            selectionElement,\r\n            mathfield.field.childNodes[0]\r\n        );\r\n    });\r\n}\r\n","import { isArray } from '../common/types';\r\n\r\nimport { hidePopover, showPopoverWithLatex } from './popover'; // @revisit\r\nimport { suggest } from '../core-definitions/definitions';\r\nimport type { MathfieldPrivate } from '../editor-mathfield/mathfield-private';\r\nimport { getCommandString } from '../editor-model/command-mode';\r\nimport { requestUpdate } from '../editor-mathfield/render';\r\nimport { SelectorPrivate, CommandRegistry } from './commands-definitions';\r\nexport { SelectorPrivate };\r\n\r\n// @revisit: move to mathfield.vibrate()\r\nexport const HAPTIC_FEEDBACK_DURATION = 3; // in ms\r\n\r\ninterface RegisterCommandOptions {\r\n    target: 'model' | 'mathfield' | 'virtual-keyboard';\r\n    category?:\r\n        | 'delete'\r\n        | 'edit' // Changes the content\r\n        | 'array-edit' // Changes the content\r\n        | 'autocomplete'\r\n        | 'clipboard'\r\n        | 'scroll'\r\n        | 'selection-anchor'\r\n        | 'selection-extend'\r\n        | 'speech'\r\n        | 'virtual-keyboard'\r\n        | '';\r\n    audioFeedback?: string;\r\n    canUndo?: boolean;\r\n    changeContent?: boolean; // To update popover\r\n    changeSelection?: boolean; // To update inline shortcut buffer\r\n}\r\n\r\nconst COMMANDS: CommandRegistry<RegisterCommandOptions> = {};\r\n\r\nexport function register(\r\n    commands: { [selector: string]: (...args: any[]) => boolean },\r\n    options?: RegisterCommandOptions\r\n): void {\r\n    options = options ?? { target: 'mathfield', canUndo: false };\r\n\r\n    Object.keys(commands).forEach((selector) => {\r\n        console.assert(\r\n            !COMMANDS[selector],\r\n            'Selector already defined: ',\r\n            selector\r\n        );\r\n        COMMANDS[selector] = { ...options, fn: commands[selector] };\r\n    });\r\n}\r\n\r\nexport function perform(\r\n    mathfield: MathfieldPrivate,\r\n    command: SelectorPrivate | [SelectorPrivate, ...any[]]\r\n): boolean {\r\n    if (!command) {\r\n        return false;\r\n    }\r\n\r\n    let selector: SelectorPrivate;\r\n    let args: string[] = [];\r\n    let handled = false;\r\n    let dirty = false;\r\n\r\n    if (isArray(command)) {\r\n        selector = command[0] as SelectorPrivate;\r\n        args = command.slice(1);\r\n    } else {\r\n        selector = command;\r\n    }\r\n\r\n    // Convert kebab case (like-this) to camel case (likeThis).\r\n    selector = selector.replace(/-\\w/g, (m) =>\r\n        m[1].toUpperCase()\r\n    ) as SelectorPrivate;\r\n    if (COMMANDS[selector]?.target === 'model') {\r\n        if (/^(delete|transpose|add)/.test(selector)) {\r\n            if (selector !== 'deleteBackward') {\r\n                mathfield.resetKeystrokeBuffer();\r\n            }\r\n        }\r\n        if (\r\n            /^(delete|transpose|add)/.test(selector) &&\r\n            mathfield.mode !== 'command'\r\n        ) {\r\n            // Update the undo state to account for the current selection\r\n            mathfield.popUndoStack();\r\n            mathfield.snapshot();\r\n        }\r\n        COMMANDS[selector].fn(mathfield.model, ...args);\r\n        if (\r\n            /^(delete|transpose|add)/.test(selector) &&\r\n            mathfield.mode !== 'command'\r\n        ) {\r\n            mathfield.snapshot();\r\n        }\r\n        if (/^(delete)/.test(selector) && mathfield.mode === 'command') {\r\n            const command = getCommandString(mathfield.model);\r\n            const suggestions = suggest(command);\r\n            if (suggestions.length === 0) {\r\n                hidePopover(mathfield);\r\n            } else {\r\n                showPopoverWithLatex(\r\n                    mathfield,\r\n                    suggestions[0].match,\r\n                    suggestions.length > 1\r\n                );\r\n            }\r\n        }\r\n        dirty = true;\r\n        handled = true;\r\n    } else if (COMMANDS[selector]) {\r\n        dirty = COMMANDS[selector].fn(mathfield, ...args);\r\n        handled = true;\r\n    } else {\r\n        throw Error('Unknown command \"' + selector + '\"');\r\n    }\r\n    // If the command changed the selection so that it is no longer\r\n    // collapsed, or if it was an editing command, reset the inline\r\n    // shortcut buffer and the user style\r\n    if (\r\n        !mathfield.model.selectionIsCollapsed ||\r\n        /^(transpose|paste|complete|((moveToNextChar|moveToPreviousChar|extend).*))_$/.test(\r\n            selector\r\n        )\r\n    ) {\r\n        mathfield.resetKeystrokeBuffer();\r\n        mathfield.style = {};\r\n    }\r\n    // Render the mathlist\r\n    if (dirty) {\r\n        requestUpdate(mathfield);\r\n    }\r\n    return handled;\r\n}\r\n\r\n/**\r\n * Perform a command, but:\r\n * * focus the mathfield\r\n * * provide haptic and audio feedback\r\n * This is used by the virtual keyboard when command keys (delete, arrows, etc..)\r\n * are pressed.\r\n */\r\n\r\nexport function performWithFeedback(\r\n    mathfield: MathfieldPrivate,\r\n    selector: SelectorPrivate\r\n): boolean {\r\n    // @revisit: have a registry of commands -> sound\r\n    mathfield.focus();\r\n    if (mathfield.options.keypressVibration && navigator?.vibrate) {\r\n        navigator.vibrate(HAPTIC_FEEDBACK_DURATION);\r\n    }\r\n    // Convert kebab case to camel case.\r\n    selector = selector.replace(/-\\w/g, (m) =>\r\n        m[1].toUpperCase()\r\n    ) as SelectorPrivate;\r\n    if (\r\n        selector === 'moveToNextPlaceholder' ||\r\n        selector === 'moveToPreviousPlaceholder' ||\r\n        selector === 'complete'\r\n    ) {\r\n        mathfield.returnKeypressSound?.play().catch(console.warn);\r\n    } else if (\r\n        selector === 'deleteBackward' ||\r\n        selector === 'deleteForward' ||\r\n        selector === 'deletePreviousWord' ||\r\n        selector === 'deleteNextWord' ||\r\n        selector === 'deleteToGroupStart' ||\r\n        selector === 'deleteToGroupEnd' ||\r\n        selector === 'deleteToMathFieldStart' ||\r\n        selector === 'deleteToMathFieldEnd'\r\n    ) {\r\n        mathfield.deleteKeypressSound?.play().catch(console.warn);\r\n    } else {\r\n        mathfield.keypressSound?.play().catch(console.warn);\r\n    }\r\n    return mathfield.executeCommand(selector);\r\n}\r\n\r\nregister({\r\n    performWithFeedback: (\r\n        mathfield: MathfieldPrivate,\r\n        command: SelectorPrivate\r\n    ): boolean => performWithFeedback(mathfield, command),\r\n});\r\n","// import { getEnvironmentDefinition } from '../core/definitions';\r\nimport { Atom } from '../core/atom';\r\nimport type { ModelPrivate } from './model-private';\r\nimport { contentDidChange } from './listeners';\r\nimport { register as registerCommand } from '../editor/commands';\r\nimport { arrayIndex, arrayCell } from './array-utils';\r\nimport { Style } from '../public/core';\r\nexport * from './array-utils';\r\n\r\n/**\r\n * Join all the cells at the indicated row into a single list of atoms\r\n */\r\nexport function arrayJoinColumns(\r\n    row: Atom[][],\r\n    separator = ',',\r\n    style?: Style\r\n): Atom[] {\r\n    if (!row) return [];\r\n    let result: Atom[] = [new Atom('first')];\r\n    let sep: Atom;\r\n    for (let cell of row) {\r\n        if (cell && cell.length > 0 && cell[0].type === 'first') {\r\n            // Remove the 'first' atom, if present\r\n            cell = cell.slice(1);\r\n        }\r\n        if (cell && cell.length > 0) {\r\n            if (sep) {\r\n                result.push(sep);\r\n            } else {\r\n                sep = new Atom('mpunct', { value: separator, style: style });\r\n            }\r\n            result = result.concat(cell);\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\n/**\r\n * Join all the rows into a single atom list\r\n */\r\nexport function arrayJoinRows(\r\n    array: Atom[][][],\r\n    separators = [';', ','],\r\n    style?: Style\r\n): Atom[] {\r\n    let result: Atom[] = [new Atom('first')];\r\n    let sep: Atom;\r\n    for (const row of array) {\r\n        if (sep) {\r\n            result.push(sep);\r\n        } else {\r\n            sep = new Atom('mpunct', { value: separators[0], style: style });\r\n        }\r\n        result = result.concat(arrayJoinColumns(row, separators[1]));\r\n    }\r\n    return result;\r\n}\r\n\r\n/**\r\n * Return the number of non-empty cells in that column\r\n */\r\nexport function arrayColumnCellCount(array: Atom[][][], col: number): number {\r\n    let result = 0;\r\n    const colRow = { col: col, row: 0 };\r\n    while (colRow.row < array.length) {\r\n        const cell = arrayCell(array, colRow);\r\n        if (cell && cell.length > 0) {\r\n            let cellLen = cell.length;\r\n            if (cell[0].type === 'first') cellLen -= 1;\r\n            if (cellLen > 0) {\r\n                result += 1;\r\n            }\r\n        }\r\n        colRow.row += 1;\r\n    }\r\n    return result;\r\n}\r\n\r\n/**\r\n * Remove the indicated column from the array\r\n */\r\nexport function arrayRemoveColumn(array: Atom[][][], col: number): void {\r\n    let row = 0;\r\n    while (row < array.length) {\r\n        if (array[row][col]) {\r\n            array[row].splice(col, 1);\r\n        }\r\n        row += 1;\r\n    }\r\n}\r\n\r\n/**\r\n * Remove the indicated row from the array\r\n */\r\nexport function arrayRemoveRow(array: Atom[][][], row: number): void {\r\n    array.splice(row, 1);\r\n}\r\n\r\n/**\r\n * Return the first non-empty cell, row by row\r\n */\r\nexport function arrayFirstCellByRow(array: Atom[][][]): string {\r\n    const colRow = { col: 0, row: 0 };\r\n    while (colRow.row < array.length && !arrayCell(array, colRow)) {\r\n        colRow.row += 1;\r\n    }\r\n    return arrayCell(array, colRow) ? 'cell' + arrayIndex(array, colRow) : '';\r\n}\r\n\r\n/**\r\n * Internal primitive to add a column/row in a matrix\r\n */\r\nfunction addCell(\r\n    _model: ModelPrivate,\r\n    _where: 'after row' | 'before row' | 'after column' | 'before column'\r\n): void {\r\n    // This command is only applicable if we're in an array\r\n    // const parent = model.parent;\r\n    // if (parent && parent.type === 'array' && isArray(parent.array)) {\r\n    //     const relation = model.relation;\r\n    //     if (parent.array) {\r\n    //         const colRow = arrayColRow(parent.array, relation);\r\n    //         if (where === 'after row' || where === 'before row') {\r\n    //             // Insert a row\r\n    //             colRow.col = 0;\r\n    //             colRow.row = colRow.row + (where === 'after row' ? 1 : 0);\r\n    //             parent.array.splice(colRow.row, 0, [[]]);\r\n    //         } else {\r\n    //             // Insert a column\r\n    //             colRow.col += where === 'after column' ? 1 : 0;\r\n    //             parent.array[colRow.row].splice(colRow.col, 0, []);\r\n    //         }\r\n    //         const cellIndex = arrayIndex(parent.array, colRow);\r\n    //         model.path.pop();\r\n    //         model.path.push({\r\n    //             relation: ('cell' + cellIndex.toString()) as Relation,\r\n    //             offset: 0,\r\n    //         });\r\n    //         model.insertFirstAtom();\r\n    //     }\r\n    // }\r\n}\r\n\r\nexport function convertParentToArray(_model: ModelPrivate): void {\r\n    // const parent = model.parent;\r\n    // if (parent.type === 'leftright') {\r\n    //     parent.type = 'array';\r\n    //     const envName =\r\n    //         { '(': 'pmatrix', '\\\\lbrack': 'bmatrix', '\\\\lbrace': 'cases' }[\r\n    //             parent.leftDelim\r\n    //         ] ?? 'matrix';\r\n    //     const env = getEnvironmentDefinition(envName);\r\n    //     const array = [[parent.branches.body]];\r\n    //     Object.assign(parent, env.parser(envName, [], array));\r\n    //     parent.mode = getAnchorMode(model);\r\n    //     parent.environmentName = envName;\r\n    //     parent.array = array;\r\n    //     parent.rowGaps = [0];\r\n    //     delete parent.branches.body;\r\n    //     model.path[model.path.length - 1].relation = 'cell0' as Relation;\r\n    // }\r\n    // Note: could also be a group, or we could be a subscript or an\r\n    // underscript (for multi-valued conditions on a \\sum, for example)\r\n    // Or if at root, this could be a 'align*' environment\r\n}\r\n\r\nexport function addRowAfter(model: ModelPrivate): boolean {\r\n    convertParentToArray(model);\r\n    addCell(model, 'after row');\r\n    contentDidChange(model);\r\n    return true;\r\n}\r\n\r\nexport function addRowBefore(model: ModelPrivate): boolean {\r\n    convertParentToArray(model);\r\n    addCell(model, 'before row');\r\n    contentDidChange(model);\r\n    return true;\r\n}\r\nexport function addColumnAfter(model: ModelPrivate): boolean {\r\n    convertParentToArray(model);\r\n    addCell(model, 'after column');\r\n    contentDidChange(model);\r\n    return true;\r\n}\r\n\r\nexport function addColumnBefore(model: ModelPrivate): boolean {\r\n    convertParentToArray(model);\r\n    addCell(model, 'before column');\r\n    contentDidChange(model);\r\n    return true;\r\n}\r\n\r\nregisterCommand(\r\n    {\r\n        addRowAfter: addRowAfter,\r\n        addColumnAfter: addColumnAfter,\r\n        addRowBefore: addRowBefore,\r\n        addColumnBefore: addColumnBefore,\r\n    },\r\n    { target: 'model', category: 'array-edit' }\r\n);\r\n","import { LeftRightAtom } from '../core-atoms/leftright';\r\nimport { OperatorAtom } from '../core-atoms/operator';\r\nimport { Atom, Branch } from '../core/atom';\r\nimport type { Range } from '../public/mathfield';\r\nimport { ModelPrivate } from './model-private';\r\nimport { range } from './selection-utils';\r\n// import {\r\n//     arrayFirstCellByRow,\r\n//     arrayColRow,\r\n//     arrayAdjustRow,\r\n//     arrayIndex,\r\n//     arrayJoinColumns,\r\n//     arrayRemoveRow,\r\n//     arrayColumnCellCount,\r\n//     arrayRemoveColumn,\r\n//     arrayJoinRows,\r\n// } from './model-array';\r\n\r\n// function deleteFirstSiblingInArray(model: ModelPrivate): boolean {\r\n//     const contentWasChanging = model.suppressChangeNotifications;\r\n//     model.suppressChangeNotifications = true;\r\n//     const array = model.parent.array;\r\n//     if (arrayFirstCellByRow(array) === model.relation) {\r\n//         // (1) First cell:\r\n//         // delete array, replace it with linearized content\r\n//         const atoms = arrayJoinRows(array);\r\n//         model.path.pop();\r\n//         model.siblings().splice(model.anchorOffset(), 1, ...atoms);\r\n//         model._iter = null;\r\n//         setSelectionOffset(model, model.anchorOffset() - 1, atoms.length);\r\n//     } else {\r\n//         const colRow = arrayColRow(array, model.relation);\r\n//         if (colRow.col === 0) {\r\n//             // (2) First (non-empty) column (but not first row):\r\n\r\n//             // Move to the end of the last cell of the previous row\r\n//             const dest = arrayAdjustRow(array, colRow, -1);\r\n//             dest.col = array[dest.row].length - 1;\r\n\r\n//             model.path[model.path.length - 1].relation = ('cell' +\r\n//                 arrayIndex(array, dest)) as Relation;\r\n//             const destLength = array[dest.row][dest.col].length;\r\n\r\n//             // (2.1) Linearize it and merge it with last cell of previous row\r\n//             // (note that atoms could be empty if there are no non-empty\r\n//             // cells left in the row)\r\n//             const atoms = arrayJoinColumns(array[colRow.row]);\r\n//             array[dest.row][dest.col] = array[dest.row][dest.col].concat(atoms);\r\n//             setSelectionOffset(model, destLength - 1, atoms.length);\r\n\r\n//             // (2.2) Remove row\r\n//             arrayRemoveRow(array, colRow.row);\r\n//         } else {\r\n//             // (3) Non-first column\r\n//             // (3.1) If column is empty, remove it\r\n//             if (arrayColumnCellCount(array, colRow.col) === 0) {\r\n//                 arrayRemoveColumn(array, colRow.col);\r\n//                 colRow.col -= 1;\r\n//                 model.path[model.path.length - 1].relation = ('cell' +\r\n//                     arrayIndex(array, colRow)) as Relation;\r\n//                 const destCell = array[colRow.row][colRow.col];\r\n//                 setSelectionOffset(model, destCell.length - 1, 0);\r\n//             }\r\n//             // (3.2) merge cell with cell in previous column\r\n//         }\r\n//     }\r\n\r\n//     // Dispatch notifications\r\n//     model.suppressChangeNotifications = contentWasChanging;\r\n//     selectionDidChange(model);\r\n//     contentDidChange(model);\r\n//     return true;\r\n// }\r\n\r\n/**\r\n * Handle special cases when deleting an atom as per the table below\r\n * - deleting an empty numerator: demote fraction\r\n * - forward-deleting a square root: demote it\r\n * - delete last atom inside a square root: delete the square root\r\n * - delete last atom in a subsup: delete the subsup\r\n * - etc...\r\n *\r\n *\r\n * @param branch: if deleting inside an atom, the branch being delete\r\n * (always the first or last atom of the branch). If undefined, the atom\r\n * itself is about to be deleted.\r\n *\r\n * @return true if handled\r\n */\r\nfunction onDelete(\r\n    model: ModelPrivate,\r\n    direction: 'forward' | 'backward',\r\n    atom: Atom,\r\n    branch?: Branch\r\n): boolean {\r\n    const parent = atom.parent;\r\n    if (atom instanceof LeftRightAtom) {\r\n        //\r\n        // 'leftright': \\left\\right\r\n        //\r\n        const atStart =\r\n            (!branch && direction === 'forward') ||\r\n            (branch === 'body' && direction === 'backward');\r\n        const pos = atStart\r\n            ? model.offsetOf(atom) - 1\r\n            : model.offsetOf(atom.lastChild);\r\n        if (!atStart && atom.leftDelim !== '?' && atom.leftDelim !== '.') {\r\n            // Insert open fence\r\n            parent.addChildBefore(\r\n                new Atom('mopen', { value: atom.leftDelim }),\r\n                atom\r\n            );\r\n        } else if (\r\n            atStart &&\r\n            atom.rightDelim !== '?' &&\r\n            atom.rightDelim !== '.'\r\n        ) {\r\n            // Insert closing fence\r\n            parent.addChildAfter(\r\n                new Atom('mclose', { value: atom.rightDelim }),\r\n                atom\r\n            );\r\n        }\r\n        // Hoist body\r\n        parent.addChildrenAfter(atom.removeBranch('body'), atom);\r\n        parent.removeChild(atom);\r\n        model.position = pos;\r\n        return true;\r\n    } else if (atom.type === 'surd') {\r\n        //\r\n        // 'surd': square root\r\n        //\r\n        if (\r\n            (direction === 'forward' && !branch) ||\r\n            (direction === 'backward' && branch === 'body')\r\n        ) {\r\n            // Before fwd or body 1st bwd: Demote body\r\n            const pos = atom.leftSibling;\r\n            parent.addChildrenAfter(atom.removeBranch('body'), atom);\r\n            parent.removeChild(atom);\r\n            model.position = model.offsetOf(pos);\r\n        } else if (direction === 'forward' && branch === 'body') {\r\n            // body last fwd: move to after\r\n            model.position = model.offsetOf(atom);\r\n        } else if (!branch && direction === 'backward') {\r\n            // after bwd: move to last of body\r\n            model.position = model.offsetOf(atom.lastChild);\r\n        } else if (branch === 'above') {\r\n            if (atom.hasEmptyBranch('above')) {\r\n                atom.removeBranch('above');\r\n            }\r\n            if (direction === 'backward') {\r\n                // above 1st\r\n                model.position = model.offsetOf(atom.leftSibling);\r\n            } else {\r\n                // above last\r\n                model.position = model.offsetOf(atom.body[0]);\r\n            }\r\n        }\r\n        return true;\r\n    } else if (atom.type === 'box' || atom.type === 'enclose') {\r\n        //\r\n        // 'box': \\boxed, \\fbox 'enclose': \\cancel\r\n        //\r\n        const pos =\r\n            (branch && direction === 'backward') ||\r\n            (!branch && direction === 'forward')\r\n                ? atom.leftSibling\r\n                : atom.lastChild;\r\n        parent.addChildrenAfter(atom.removeBranch('body'), atom);\r\n        parent.removeChild(atom);\r\n        model.position = model.offsetOf(pos);\r\n        return true;\r\n    } else if (atom.type === 'genfrac' || atom.type === 'overunder') {\r\n        //\r\n        // 'genfrac': \\frac, \\choose, etc...\r\n        //\r\n        if (!branch) {\r\n            // After or before atom\r\n            model.position = model.offsetOf(\r\n                direction === 'forward' ? atom.firstChild : atom.lastChild\r\n            );\r\n            return true;\r\n        }\r\n        if (\r\n            (direction === 'forward' && branch === 'above') ||\r\n            (direction === 'backward' && branch === 'below')\r\n        ) {\r\n            // above last or below first: hoist\r\n            const pos = atom.leftSibling;\r\n            parent.addChildrenAfter(atom.removeBranch('below'), atom);\r\n            parent.addChildrenAfter(atom.removeBranch('above'), atom);\r\n            parent.removeChild(atom);\r\n\r\n            model.position = model.offsetOf(pos);\r\n            return true;\r\n        }\r\n\r\n        if (direction === 'backward') {\r\n            // above first: move to before\r\n            model.position = model.offsetOf(atom.leftSibling);\r\n            return true;\r\n        }\r\n        // below last: move to after\r\n        model.position = model.offsetOf(atom);\r\n        return true;\r\n    } else if (\r\n        (atom instanceof OperatorAtom && atom.isExtensibleSymbol) ||\r\n        atom.type === 'msubsup'\r\n    ) {\r\n        //\r\n        // Extensible operator: \\sum, \\int, etc...\r\n        // Superscript/subscript carrier\r\n        //\r\n        if (!branch && direction === 'forward') return false;\r\n        if (!branch) {\r\n            if (atom.subscript || atom.superscript) {\r\n                let pos: Atom;\r\n                if (direction === 'forward') {\r\n                    // before\r\n                    pos = atom.superscript?.[0] ?? atom.subscript?.[0];\r\n                } else {\r\n                    // after\r\n                    pos =\r\n                        atom.subscript?.[0].lastSibling ??\r\n                        atom.superscript?.[0].lastSibling;\r\n                }\r\n                model.position = model.offsetOf(pos);\r\n                return true;\r\n            }\r\n\r\n            return false;\r\n        }\r\n        if (branch && atom.hasEmptyBranch(branch)) {\r\n            atom.removeBranch(branch);\r\n        }\r\n\r\n        if (branch === 'superscript') {\r\n            if (direction === 'backward') {\r\n                const pos = model.offsetOf(atom.firstChild) - 1;\r\n                console.assert(pos >= 0);\r\n                model.position = pos;\r\n            } else if (atom.subscript) {\r\n                model.position = model.offsetOf(atom.subscript[0]);\r\n            } else {\r\n                model.position = model.offsetOf(atom);\r\n            }\r\n        } else if (branch === 'subscript') {\r\n            if (direction === 'backward' && atom.superscript) {\r\n                // subscript first: move to superscript end\r\n                model.position = model.offsetOf(\r\n                    atom.superscript[0].lastSibling\r\n                );\r\n            } else if (direction === 'backward') {\r\n                // subscript first: move to before\r\n                model.position = model.offsetOf(atom.firstChild) - 1;\r\n            } else {\r\n                // subscript last: move after\r\n                model.position = model.offsetOf(atom);\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\n/**\r\n * Delete the item at the current position\r\n */\r\nexport function deleteBackward(model: ModelPrivate): boolean {\r\n    if (!model.selectionIsCollapsed) {\r\n        return deleteRange(model, range(model.selection));\r\n    }\r\n\r\n    let target = model.at(model.position);\r\n\r\n    if (target && onDelete(model, 'backward', target)) return true;\r\n\r\n    if (target?.isFirstSibling) {\r\n        if (onDelete(model, 'backward', target.parent, target.treeBranch)) {\r\n            return true;\r\n        }\r\n        target = null;\r\n    }\r\n\r\n    // At the first position: nothing to delete...\r\n    if (!target) {\r\n        model.announce('plonk');\r\n        return false;\r\n    }\r\n\r\n    return model.deferNotifications({ content: true, selection: true }, () => {\r\n        const offset = model.offsetOf(target.leftSibling);\r\n        target.parent.removeChild(target);\r\n        model.announce('deleted', null, [target]);\r\n        model.position = offset;\r\n    });\r\n}\r\n\r\n/**\r\n * Delete the item forward of the current position, update the position and\r\n * send notifications\r\n */\r\nexport function deleteForward(model: ModelPrivate): boolean {\r\n    if (!model.selectionIsCollapsed) {\r\n        return deleteRange(model, range(model.selection));\r\n    }\r\n\r\n    let target = model.at(model.position).rightSibling;\r\n\r\n    if (target && onDelete(model, 'forward', target)) return true;\r\n\r\n    if (!target) {\r\n        target = model.at(model.position);\r\n        if (\r\n            target.isLastSibling &&\r\n            onDelete(model, 'forward', target.parent, target.treeBranch)\r\n        ) {\r\n            return true;\r\n        }\r\n        target = null;\r\n    } else if (\r\n        model.at(model.position).isLastSibling &&\r\n        onDelete(model, 'forward', target.parent, target.treeBranch)\r\n    ) {\r\n        return true;\r\n    }\r\n\r\n    if (model.position === model.lastOffset || !target) {\r\n        model.announce('plonk');\r\n        return false;\r\n    }\r\n\r\n    return model.deferNotifications({ content: true, selection: true }, () => {\r\n        target.parent.removeChild(target);\r\n        let sibling = model.at(model.position)?.rightSibling;\r\n        while (sibling?.type === 'msubsup') {\r\n            sibling.parent.removeChild(sibling);\r\n            sibling = model.at(model.position)?.rightSibling;\r\n        }\r\n        model.announce('deleted', null, [target]);\r\n    });\r\n}\r\n\r\n/**\r\n * Delete the specified range, as a result of a user action: this will\r\n * account for special cases such as deleting empty denominator, and will\r\n * provide appropriate feedback to screen readers.\r\n *\r\n * Use model.deleteAtoms() for operations that are not a result of\r\n * user action.\r\n */\r\n\r\nexport function deleteRange(model: ModelPrivate, range: Range): boolean {\r\n    model.deleteAtoms(range);\r\n    return true;\r\n}\r\n","import type { InlineShortcutDefinition } from '../public/options';\r\n\r\n/**\r\n * These shortcut strings are replaced with the corresponding LaTeX expression\r\n * without requiring an escape sequence or command.\r\n */\r\nexport const INLINE_SHORTCUTS: {\r\n    [shorcut: string]: InlineShortcutDefinition;\r\n} = {\r\n    // Primes\r\n    \"''\": { mode: 'math', value: '^{\\\\doubleprime}' },\r\n\r\n    // Greek letters\r\n    alpha: '\\\\alpha',\r\n    delta: '\\\\delta',\r\n    Delta: '\\\\Delta',\r\n    pi: { mode: 'math', value: '\\\\pi' },\r\n    'pi ': { mode: 'text', value: '\\\\pi ' },\r\n    Pi: { mode: 'math', value: '\\\\Pi' },\r\n    theta: '\\\\theta',\r\n    Theta: '\\\\Theta',\r\n\r\n    // Letter-like\r\n    ii: {\r\n        after:\r\n            'nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text',\r\n        value: '\\\\imaginaryI',\r\n    },\r\n    jj: {\r\n        after:\r\n            'nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text',\r\n        value: '\\\\imaginaryJ',\r\n    },\r\n    ee: {\r\n        mode: 'math',\r\n        after:\r\n            'nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text',\r\n        value: '\\\\exponentialE',\r\n    },\r\n\r\n    nabla: { mode: 'math', value: '\\\\nabla' },\r\n    grad: { mode: 'math', value: '\\\\nabla' },\r\n    del: { mode: 'math', value: '\\\\partial' },\r\n\r\n    '\\u221e': '\\\\infty', // @TODO: doesn't work\r\n    // '&infin;': '\\\\infty',\r\n    // '&#8734;': '\\\\infty',\r\n    oo: {\r\n        mode: 'math',\r\n        after:\r\n            'nothing+digit+frac+surd+binop+relop+punct+array+openfence+closefence+space',\r\n        value: '\\\\infty',\r\n    },\r\n\r\n    // Big operators\r\n    '': { mode: 'math', value: '\\\\sum' },\r\n    sum: { mode: 'math', value: '\\\\sum_{#?}^{#?}' },\r\n    prod: { mode: 'math', value: '\\\\prod_{#?}^{#?}' },\r\n    sqrt: { mode: 'math', value: '\\\\sqrt{#?}' },\r\n    // '':                    '\\\\int',             // There's a alt-B command for this\r\n    '': { mode: 'math', value: '\\\\differentialD' }, // @TODO: is \\\\diffD most common?\r\n    '': { mode: 'math', value: '\\\\differentialD' },\r\n\r\n    // Functions\r\n    arcsin: { mode: 'math', value: '\\\\arcsin' },\r\n    arccos: { mode: 'math', value: '\\\\arccos' },\r\n    arctan: { mode: 'math', value: '\\\\arctan' },\r\n    sin: { mode: 'math', value: '\\\\sin' },\r\n    sinh: { mode: 'math', value: '\\\\sinh' },\r\n    cos: { mode: 'math', value: '\\\\cos' },\r\n    cosh: { mode: 'math', value: '\\\\cosh' },\r\n    tan: { mode: 'math', value: '\\\\tan' },\r\n    tanh: { mode: 'math', value: '\\\\tanh' },\r\n    sec: { mode: 'math', value: '\\\\sec' },\r\n    csc: { mode: 'math', value: '\\\\csc' },\r\n    cot: { mode: 'math', value: '\\\\cot' },\r\n\r\n    log: { mode: 'math', value: '\\\\log' },\r\n    ln: { mode: 'math', value: '\\\\ln' },\r\n    exp: { mode: 'math', value: '\\\\exp' },\r\n    lim: { mode: 'math', value: '\\\\lim_{#?}' },\r\n\r\n    // Differentials\r\n    // According to ISO31/XI (ISO 80000-2), differentials should be upright\r\n    dx: {\r\n        mode: 'math',\r\n        after:\r\n            'nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text',\r\n        value: '\\\\differentialD x',\r\n    },\r\n    dy: {\r\n        mode: 'math',\r\n        after:\r\n            'nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text',\r\n        value: '\\\\differentialD y',\r\n    },\r\n    dt: {\r\n        mode: 'math',\r\n        after:\r\n            'nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text',\r\n        value: '\\\\differentialD t',\r\n    },\r\n\r\n    // Logic\r\n    AA: { mode: 'math', value: '\\\\forall' },\r\n    EE: { mode: 'math', value: '\\\\exists' },\r\n    '!EE': { mode: 'math', value: '\\\\nexists' },\r\n    '&&': { mode: 'math', value: '\\\\land' },\r\n    // The shortcut for the greek letter \"xi\" is interfering with \"x in\"\r\n    xin: {\r\n        mode: 'math',\r\n        after: 'nothing+text+relop+punct+openfence+space',\r\n        value: 'x \\\\in',\r\n    },\r\n    in: {\r\n        mode: 'math',\r\n        after: 'nothing+letter+closefence',\r\n        value: '\\\\in',\r\n    },\r\n    '!in': { mode: 'math', value: '\\\\notin' },\r\n\r\n    // Sets\r\n    NN: '\\\\N', // Natural numbers\r\n    ZZ: '\\\\Z', // Integers\r\n    QQ: '\\\\Q', // Rational numbers\r\n    RR: '\\\\R', // Real numbers\r\n    CC: '\\\\C', // Complex numbers\r\n    PP: '\\\\P', // Prime numbers\r\n\r\n    // Operators\r\n    xx: { mode: 'math', value: '\\\\times' },\r\n    '+-': { mode: 'math', value: '\\\\pm' },\r\n\r\n    // Relational operators\r\n    '!=': { mode: 'math', value: '\\\\ne' },\r\n    '>=': { mode: 'math', value: '\\\\ge' },\r\n    '<=': { mode: 'math', value: '\\\\le' },\r\n    '<<': { mode: 'math', value: '\\\\ll' },\r\n    '>>': { mode: 'math', value: '\\\\gg' },\r\n    '~~': { mode: 'math', value: '\\\\approx' },\r\n\r\n    // More operators\r\n    '': { mode: 'math', value: '\\\\approx' },\r\n    '?=': { mode: 'math', value: '\\\\questeq' },\r\n    '': { mode: 'math', value: '\\\\div' },\r\n    '': { mode: 'math', value: '\\\\neg' },\r\n    ':=': { mode: 'math', value: '\\\\coloneq' },\r\n    '::': { mode: 'math', value: '\\\\Colon' },\r\n\r\n    // Fences\r\n    '(:': { mode: 'math', value: '\\\\langle' },\r\n    ':)': { mode: 'math', value: '\\\\rangle' },\r\n\r\n    // More Greek letters\r\n    beta: '\\\\beta',\r\n    chi: '\\\\chi',\r\n    epsilon: '\\\\epsilon',\r\n    varepsilon: '\\\\varepsilon',\r\n    eta: {\r\n        mode: 'math',\r\n        after:\r\n            'nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text',\r\n        value: '\\\\eta',\r\n    },\r\n    'eta ': {\r\n        mode: 'text',\r\n        after:\r\n            'nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text',\r\n        value: '\\\\eta ',\r\n    },\r\n    gamma: '\\\\gamma',\r\n    Gamma: '\\\\Gamma',\r\n    iota: '\\\\iota',\r\n    kappa: '\\\\kappa',\r\n    lambda: '\\\\lambda',\r\n    Lambda: '\\\\Lambda',\r\n    mu: {\r\n        mode: 'math',\r\n        after:\r\n            'nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text',\r\n        value: '\\\\mu',\r\n    },\r\n    'mu ': {\r\n        mode: 'text',\r\n        after:\r\n            'nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text',\r\n        value: '\\\\mu ',\r\n    },\r\n    nu: {\r\n        mode: 'math',\r\n        after:\r\n            'nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text',\r\n        value: '\\\\nu',\r\n    },\r\n    'nu ': {\r\n        mode: 'text',\r\n        after:\r\n            'nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text',\r\n        value: '\\\\nu ',\r\n    },\r\n    : '\\\\mu', // @TODO: or micro?\r\n    phi: {\r\n        after:\r\n            'nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text',\r\n        value: '\\\\phi',\r\n    },\r\n    Phi: {\r\n        after:\r\n            'nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text',\r\n        value: '\\\\Phi',\r\n    },\r\n    varphi: '\\\\varphi',\r\n    psi: {\r\n        after:\r\n            'nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text',\r\n        value: '\\\\psi',\r\n    },\r\n    Psi: {\r\n        after:\r\n            'nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text',\r\n        value: '\\\\Psi',\r\n    },\r\n    rho: {\r\n        after:\r\n            'nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text',\r\n        value: '\\\\rho',\r\n    },\r\n    sigma: '\\\\sigma',\r\n    Sigma: '\\\\Sigma',\r\n    tau: {\r\n        after:\r\n            'nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text',\r\n        value: '\\\\tau',\r\n    },\r\n    vartheta: '\\\\vartheta',\r\n    upsilon: '\\\\upsilon',\r\n    xi: {\r\n        after:\r\n            'nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text',\r\n        value: '\\\\xi',\r\n    },\r\n    Xi: {\r\n        after:\r\n            'nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text',\r\n        value: '\\\\Xi',\r\n    },\r\n    zeta: '\\\\zeta',\r\n    omega: '\\\\omega',\r\n    Omega: '\\\\Omega',\r\n    : '\\\\omega', // @TODO: or ohm?\r\n\r\n    // More Logic\r\n    forall: { mode: 'math', value: '\\\\forall' },\r\n    exists: {\r\n        mode: 'math',\r\n        value: '\\\\exists',\r\n    },\r\n    '!exists': {\r\n        mode: 'math',\r\n        value: '\\\\nexists',\r\n    },\r\n    ':.': {\r\n        mode: 'math',\r\n        value: '\\\\therefore',\r\n    },\r\n\r\n    // MORE FUNCTIONS\r\n    // 'arg': '\\\\arg',\r\n    liminf: '\\\\operatorname*{lim~inf}_{#?}',\r\n    limsup: '\\\\operatorname*{lim~sup}_{#?}',\r\n    argmin: '\\\\operatorname*{arg~min}_{#?}',\r\n    argmax: '\\\\operatorname*{arg~max}_{#?}',\r\n    det: '\\\\det',\r\n    mod: {\r\n        mode: 'math',\r\n        value: '\\\\mod',\r\n    },\r\n    max: {\r\n        mode: 'math',\r\n        value: '\\\\max',\r\n    },\r\n    min: {\r\n        mode: 'math',\r\n        value: '\\\\min',\r\n    },\r\n    erf: '\\\\operatorname{erf}',\r\n    erfc: '\\\\operatorname{erfc}',\r\n    bessel: {\r\n        mode: 'math',\r\n        value: '\\\\operatorname{bessel}',\r\n    },\r\n    mean: {\r\n        mode: 'math',\r\n        value: '\\\\operatorname{mean}',\r\n    },\r\n    median: {\r\n        mode: 'math',\r\n        value: '\\\\operatorname{median}',\r\n    },\r\n    fft: {\r\n        mode: 'math',\r\n        value: '\\\\operatorname{fft}',\r\n    },\r\n    lcm: {\r\n        mode: 'math',\r\n        value: '\\\\operatorname{lcm}',\r\n    },\r\n    gcd: {\r\n        mode: 'math',\r\n        value: '\\\\operatorname{gcd}',\r\n    },\r\n    randomReal: '\\\\operatorname{randomReal}',\r\n    randomInteger: '\\\\operatorname{randomInteger}',\r\n    Re: {\r\n        mode: 'math',\r\n        value: '\\\\operatorname{Re}',\r\n    },\r\n    Im: {\r\n        mode: 'math',\r\n        value: '\\\\operatorname{Im}',\r\n    },\r\n\r\n    // UNITS\r\n    mm: {\r\n        mode: 'math',\r\n        after: 'nothing+digit',\r\n        value: '\\\\operatorname{mm}', // millimeter\r\n    },\r\n    cm: {\r\n        mode: 'math',\r\n        after: 'nothing+digit',\r\n        value: '\\\\operatorname{cm}', // centimeter\r\n    },\r\n    km: {\r\n        mode: 'math',\r\n        after: 'nothing+digit',\r\n        value: '\\\\operatorname{km}', // kilometer\r\n    },\r\n    kg: {\r\n        mode: 'math',\r\n        after: 'nothing+digit',\r\n        value: '\\\\operatorname{kg}', // kilogram\r\n    },\r\n\r\n    // '||':                   '\\\\lor',\r\n    '...': '\\\\ldots', // In general, use \\ldots\r\n    '+...': '+\\\\cdots', // ... but use \\cdots after + ...\r\n    '-...': '-\\\\cdots', // ... - and ...\r\n    '->...': '\\\\to\\\\cdots', // ->\r\n\r\n    '->': '\\\\to',\r\n    '|->': '\\\\mapsto',\r\n    '-->': '\\\\longrightarrow',\r\n    //    '<-':                   '\\\\leftarrow',\r\n    '<--': '\\\\longleftarrow',\r\n    '=>': '\\\\Rightarrow',\r\n    '==>': '\\\\Longrightarrow',\r\n    // '<=': '\\\\Leftarrow',     // CONFLICTS WITH LESS THAN OR EQUAL\r\n    '<=>': '\\\\Leftrightarrow',\r\n    '<->': '\\\\leftrightarrow',\r\n\r\n    '(.)': '\\\\odot',\r\n    '(+)': '\\\\oplus',\r\n    '(/)': '\\\\oslash',\r\n    '(*)': '\\\\otimes',\r\n    '(-)': '\\\\ominus',\r\n    // '(-)':                  '\\\\circleddash',\r\n\r\n    '||': '\\\\Vert',\r\n    '{': '\\\\{',\r\n    '}': '\\\\}',\r\n\r\n    '*': '\\\\cdot',\r\n\r\n    /*\r\n    //\r\n    // ASCIIIMath\r\n    //\r\n    // Binary operation symbols\r\n    '**':                   '\\\\ast',\r\n    '***':                  '\\\\star',\r\n    '//':                   '\\\\slash',\r\n    '\\\\\\\\':                 '\\\\backslash',\r\n    'setminus':             '\\\\backslash',\r\n    '|><':                  '\\\\ltimes',\r\n    '><|':                  '\\\\rtimes',\r\n    '|><|':                 '\\\\bowtie',\r\n    '-:':                   '\\\\div',\r\n    'divide':               '\\\\div',\r\n    '@':                    '\\\\circ',\r\n    'o+':                   '\\\\oplus',\r\n    'ox':                   '\\\\otimes',\r\n    'o.':                   '\\\\odot',\r\n    '^^':                   '\\\\wedge',\r\n    '^^^':                  '\\\\bigwedge',\r\n    'vv':                   '\\\\vee',\r\n    'vvv':                  '\\\\bigvee',\r\n    'nn':                   '\\\\cap',\r\n    'nnn':                  '\\\\bigcap',\r\n    'uu':                   '\\\\cup',\r\n    'uuu':                  '\\\\bigcup',\r\n\r\n    // Binary relation symbols\r\n    '-=':                   '\\\\equiv',\r\n    '~=':                   '\\\\cong',\r\n    'lt':                   '<',\r\n    'lt=':                  '\\\\leq',\r\n    'gt':                   '>',\r\n    'gt=':                  '\\\\geq',\r\n    '-<':                   '\\\\prec',\r\n    '-lt':                  '\\\\prec',\r\n    '-<=':                  '\\\\preceq',\r\n    // '>-':                   '\\\\succ',\r\n    '>-=':                  '\\\\succeq',\r\n    'prop':                 '\\\\propto',\r\n    'diamond':              '\\\\diamond',\r\n    'square':               '\\\\square',\r\n    'iff':                  '\\\\iff',\r\n\r\n    'sub':                  '\\\\subset',\r\n    'sup':                  '\\\\supset',\r\n    'sube':                 '\\\\subseteq',\r\n    'supe':                 '\\\\supseteq',\r\n    'uarr':                 '\\\\uparrow',\r\n    'darr':                 '\\\\downarrow',\r\n    'rarr':                 '\\\\rightarrow',\r\n    'rArr':                 '\\\\Rightarrow',\r\n    'larr':                 '\\\\leftarrow',\r\n    'lArr':                 '\\\\Leftarrow',\r\n    'harr':                 '\\\\leftrightarrow',\r\n    'hArr':                 '\\\\Leftrightarrow',\r\n    'aleph':                '\\\\aleph',\r\n\r\n    // Logic\r\n    'and':                  '\\\\land',\r\n    'or':                   '\\\\lor',\r\n    'not':                  '\\\\neg',\r\n    '_|_':                   '\\\\bot',\r\n    'TT':                   '\\\\top',\r\n    '|--':                  '\\\\vdash',\r\n    '|==':                  '\\\\models',\r\n    \r\n    // Other functions\r\n    '|__':                  '\\\\lfloor',\r\n    '__|':                  '\\\\rfloor',\r\n\r\n    '|~':                   '\\\\lceil',\r\n    '~|':                   '\\\\rceil',\r\n\r\n    // Arrows\r\n    '>->':                   '\\\\rightarrowtail',\r\n    '->>':                   '\\\\twoheadrightarrow',\r\n    '>->>':                  '\\\\twoheadrightarrowtail'\r\n*/\r\n};\r\n","import type { InlineShortcutDefinition } from '../public/options';\r\nimport { LETTER } from '../core-definitions/definitions';\r\nimport type { Atom } from '../core/atom';\r\n\r\nimport { MathfieldOptionsPrivate } from './options';\r\nimport { INLINE_SHORTCUTS } from './shortcuts-definitions';\r\n\r\nexport { InlineShortcutDefinition };\r\nexport { INLINE_SHORTCUTS } from './shortcuts-definitions';\r\n\r\n/**\r\n * Return an array of potential shortcuts\r\n */\r\nexport function getInlineShortcutsStartingWith(\r\n    s: string,\r\n    config: MathfieldOptionsPrivate\r\n): string[] {\r\n    const result = [];\r\n\r\n    const skipDefaultShortcuts = config.overrideDefaultInlineShortcuts;\r\n\r\n    for (let i = 0; i <= s.length - 1; i++) {\r\n        const s2 = s.substring(i);\r\n        if (!skipDefaultShortcuts) {\r\n            Object.keys(INLINE_SHORTCUTS).forEach((key) => {\r\n                if (key.startsWith(s2) && !result.includes(key)) {\r\n                    result.push(key);\r\n                }\r\n            });\r\n        }\r\n\r\n        const customInlineShortcuts = config?.inlineShortcuts\r\n            ? config.inlineShortcuts\r\n            : null;\r\n        if (customInlineShortcuts) {\r\n            Object.keys(customInlineShortcuts).forEach((key) => {\r\n                if (key.startsWith(s2)) {\r\n                    result.push(key);\r\n                }\r\n            });\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\n/**\r\n *\r\n * @param siblings atoms preceding this potential shortcut\r\n */\r\nfunction validateShortcut(\r\n    siblings: Atom[],\r\n    shortcut: InlineShortcutDefinition\r\n): string {\r\n    if (!shortcut) return '';\r\n\r\n    // If it's a simple shortcut (no conditional), it's always valid\r\n    if (typeof shortcut === 'string') return shortcut;\r\n\r\n    // If we have no context, we assume all the shortcuts are valid\r\n    if (!siblings) return shortcut.value;\r\n\r\n    let nothing = false;\r\n    let letter = false;\r\n    let digit = false;\r\n    let isFunction = false;\r\n    let frac = false;\r\n    let surd = false;\r\n    let binop = false;\r\n    let relop = false;\r\n    let punct = false;\r\n    let array = false;\r\n    let openfence = false;\r\n    let closefence = false;\r\n    let text = false;\r\n    let space = false;\r\n    let sibling = siblings[siblings.length - 1];\r\n    let index = siblings.length - 1;\r\n    while (sibling && /msubsup|placeholder/.test(sibling.type)) {\r\n        index -= 1;\r\n        sibling = siblings[index];\r\n    }\r\n    nothing = !sibling || sibling.type === 'first'; // start of a group\r\n    if (sibling) {\r\n        if (\r\n            typeof shortcut.mode !== 'undefined' &&\r\n            sibling.mode !== shortcut.mode\r\n        ) {\r\n            return '';\r\n        }\r\n        text = sibling.mode === 'text';\r\n        letter = !text && sibling.type === 'mord' && LETTER.test(sibling.value);\r\n        digit =\r\n            !text && sibling.type === 'mord' && /[0-9]+$/.test(sibling.value);\r\n        isFunction = !text && sibling.isFunction;\r\n        frac = sibling.type === 'genfrac';\r\n        surd = sibling.type === 'surd';\r\n        binop = sibling.type === 'mbin';\r\n        relop = sibling.type === 'mrel';\r\n        punct = sibling.type === 'mpunct' || sibling.type === 'minner';\r\n        array = sibling.type === 'array';\r\n        openfence = sibling.type === 'mopen';\r\n        closefence = sibling.type === 'mclose' || sibling.type === 'leftright';\r\n        space = sibling.type === 'space';\r\n    }\r\n\r\n    if (typeof shortcut.after !== 'undefined') {\r\n        // If this is a conditional shortcut, consider the conditions now\r\n        if (\r\n            (/nothing/.test(shortcut.after) && nothing) ||\r\n            (/letter/.test(shortcut.after) && letter) ||\r\n            (/digit/.test(shortcut.after) && digit) ||\r\n            (/function/.test(shortcut.after) && isFunction) ||\r\n            (/frac/.test(shortcut.after) && frac) ||\r\n            (/surd/.test(shortcut.after) && surd) ||\r\n            (/binop/.test(shortcut.after) && binop) ||\r\n            (/relop/.test(shortcut.after) && relop) ||\r\n            (/punct/.test(shortcut.after) && punct) ||\r\n            (/array/.test(shortcut.after) && array) ||\r\n            (/openfence/.test(shortcut.after) && openfence) ||\r\n            (/closefence/.test(shortcut.after) && closefence) ||\r\n            (/text/.test(shortcut.after) && text) ||\r\n            (/space/.test(shortcut.after) && space)\r\n        ) {\r\n            return shortcut.value;\r\n        }\r\n        return '';\r\n    }\r\n\r\n    return shortcut.value;\r\n}\r\n\r\n/**\r\n *\r\n * @param context - atoms preceding the candidate, potentially used\r\n * to reduce which shortcuts are applicable. If 'null', no restrictions are\r\n * applied.\r\n * @param s - candidate inline shortcuts (e.g. `'pi'`)\r\n * @return A replacement string matching the shortcut (e.g. `'\\pi'`)\r\n */\r\nexport function getInlineShortcut(\r\n    context: Atom[],\r\n    s: string,\r\n    shortcuts?: { [key: string]: InlineShortcutDefinition }\r\n): string {\r\n    return validateShortcut(context, shortcuts?.[s] ?? INLINE_SHORTCUTS[s]);\r\n}\r\n","import { OutputFormat } from '../public/mathfield';\nimport { InlineShortcutDefinition, getInlineShortcut } from './shortcuts';\n\n/**\n * Attempts to parse and interpret a string in an unknown format, possibly\n * ASCIIMath and return a canonical LaTeX string.\n *\n * The format recognized are one of these variations:\n * - ASCIIMath: Only supports a subset\n * (1/2x)\n * 1/2sin x                     -> \\frac {1}{2}\\sin x\n * 1/2sinx                      -> \\frac {1}{2}\\sin x\n * (1/2sin x (x^(2+1))          // Unbalanced parentheses\n * (1/2sin(x^(2+1))             -> \\left(\\frac {1}{2}\\sin \\left(x^{2+1}\\right)\\right)\n * alpha + (pi)/(4)             -> \\alpha +\\frac {\\pi }{4}\n * x=(-b +- sqrt(b^2  4ac))/(2a)\n * alpha/beta\n * sqrt2 + sqrtx + sqrt(1+a) + sqrt(1/2)\n * f(x) = x^2 \"when\" x >= 0\n * AA n in QQ\n * AA x in RR \",\" |x| > 0\n * AA x in RR \",\" abs(x) > 0\n *\n * - UnicodeMath (generated by Microsoft Word): also only supports a subset\n *      - See https://www.unicode.org/notes/tn28/UTN28-PlainTextMath-v3.1.pdf\n * (3&x+1)\n * {a+b/c}\n * [a+b/c]\n * _a^b x\n * lim_(n->\\infty) n\n * \\iint_(a=0)^\\infty  a\n *\n * - \"JavaScript Latex\": a variant that is LaTeX, but with escaped backslashes\n *  \\\\frac{1}{2} \\\\sin x\n */\nexport function parseMathString(\n    s: string,\n    options?: {\n        format?: OutputFormat;\n        inlineShortcuts?: { [key: string]: InlineShortcutDefinition };\n    }\n): [OutputFormat, string] {\n    if (!s) return ['latex', ''];\n\n    // Nothing to do if a single character\n    if (s.length <= 1) return ['latex', s];\n\n    if (!options || options.format !== 'ASCIIMath') {\n        // This is not explicitly ASCIIMath. Try to infer if this is LaTex...\n\n        // If the strings is surrounded by `$..$` or `$$..$$`, assumes it is LaTeX\n        const trimedString = s.trim();\n        if (\n            (trimedString.startsWith('$$') && trimedString.endsWith('$$')) ||\n            (trimedString.startsWith('\\\\[') && trimedString.endsWith('\\\\]')) ||\n            (trimedString.startsWith('\\\\(') && trimedString.endsWith('\\\\)'))\n        ) {\n            return [\n                'latex',\n                trimedString.substring(2, trimedString.length - 2),\n            ];\n        }\n\n        if (trimedString.startsWith('$') && trimedString.endsWith('$')) {\n            return [\n                'latex',\n                trimedString.substring(1, trimedString.length - 1),\n            ];\n        }\n\n        // Replace double-backslash (coming from JavaScript) to a single one\n        s = s.replace(/\\\\\\\\([^\\s\\n])/g, '\\\\$1');\n\n        if (/\\\\/.test(s)) {\n            // If the string includes a '\\' it's probably a LaTeX string\n            // (that's not completely true, it could be a UnicodeMath string, since\n            // UnicodeMath supports some LaTeX commands. However, we need to pick\n            // one in order to correctly interpret {} (which are argument delimiters\n            // in LaTeX, and are fences in UnicodeMath)\n            return ['latex', s];\n        }\n    }\n\n    s = s.replace(/\\u2061/gu, ''); // Remove function application\n    s = s.replace(/\\u3016/gu, '{'); // WHITE LENTICULAR BRACKET (grouping)\n    s = s.replace(/\\u3017/gu, '}'); // WHITE LENTICULAR BRACKET (grouping)\n\n    s = s.replace(/([^\\\\])sinx/g, '$1\\\\sin x'); // common typo\n    s = s.replace(/([^\\\\])cosx/g, '$1\\\\cos x '); // common typo\n    s = s.replace(/\\u2013/g, '-'); // EN-DASH, sometimes used as a minus sign\n\n    return [\n        options?.format ?? 'ASCIIMath',\n        parseMathExpression(s, options ?? {}),\n    ];\n}\n\nfunction parseMathExpression(\n    s: string,\n    options: {\n        format?: string;\n        inlineShortcuts?: { [key: string]: InlineShortcutDefinition };\n    }\n): string {\n    if (!s) return '';\n    let done = false;\n    let m;\n\n    if (!done && (s[0] === '^' || s[0] === '_')) {\n        // Superscript and subscript\n        m = parseMathArgument(s.substr(1), {\n            inlineShortcuts: options?.inlineShortcuts ?? {},\n            noWrap: true,\n        });\n        s = s[0] + '{' + m.match + '}';\n        s += parseMathExpression(m.rest, options);\n        done = true;\n    }\n\n    if (!done) {\n        m = s.match(/^(sqrt|\\u221a)(.*)/);\n        if (m) {\n            // Square root\n            m = parseMathArgument(m[2], {\n                inlineShortcuts: options?.inlineShortcuts ?? {},\n                noWrap: true,\n            });\n            const sqrtArgument = m.match ?? '\\\\placeholder{}';\n            s = '\\\\sqrt{' + sqrtArgument + '}';\n            s += parseMathExpression(m.rest, options);\n            done = true;\n        }\n    }\n\n    if (!done) {\n        m = s.match(/^(\\\\cbrt|\\u221b)(.*)/);\n        if (m) {\n            // Cube root\n            m = parseMathArgument(m[2], {\n                inlineShortcuts: options?.inlineShortcuts ?? {},\n                noWrap: true,\n            });\n            const sqrtArgument = m.match ?? '\\\\placeholder{}';\n            s = '\\\\sqrt[3]{' + sqrtArgument + '}';\n            s += parseMathExpression(m.rest, options);\n            done = true;\n        }\n    }\n\n    if (!done) {\n        m = s.match(/^abs(.*)/);\n        if (m) {\n            // Absolute value\n            m = parseMathArgument(m[1], {\n                inlineShortcuts: options?.inlineShortcuts ?? {},\n                noWrap: true,\n            });\n            s = '\\\\left|' + m.match + '\\\\right|';\n            s += parseMathExpression(m.rest, options);\n            done = true;\n        }\n    }\n\n    if (!done) {\n        m = s.match(/^[\"](.*?)[\"](.*)/);\n        if (m) {\n            // Quoted text\n            s = '\\\\text{' + m[1] + '}';\n            s += parseMathExpression(m[2], options);\n            done = true;\n        }\n    }\n\n    if (!done) {\n        m = s.match(/^([^a-zA-Z({[_^\\\\\\s\"]+)(.*)/);\n        // A string of symbols...\n        // Could be a binary or relational operator, etc...\n        if (m) {\n            s = paddedShortcut(m[1], options);\n            s += parseMathExpression(m[2], options);\n            done = true;\n        }\n    }\n\n    if (!done && /^(f|g|h)[^a-zA-Z]/.test(s)) {\n        // This could be a function...\n        m = parseMathArgument(s.substring(1), {\n            inlineShortcuts: options.inlineShortcuts ?? {},\n            noWrap: true,\n        });\n        if (s[1] === '(') {\n            s = s[0] + '\\\\mleft(' + m.match + '\\\\mright)';\n        } else {\n            s = s[0] + m.match;\n        }\n        s += parseMathExpression(m.rest, options);\n        done = true;\n    }\n\n    if (!done) {\n        m = s.match(/^([a-zA-Z]+)(.*)/);\n        if (m) {\n            // Some alphabetical string...\n            // Could be a function name (sin) or symbol name (alpha)\n            s = paddedShortcut(m[1], options);\n            s += parseMathExpression(m[2], options);\n            done = true;\n        }\n    }\n\n    if (!done) {\n        m = parseMathArgument(s, {\n            inlineShortcuts: options.inlineShortcuts ?? {},\n            noWrap: true,\n        });\n        if (m.match && m.rest[0] === '/') {\n            // Fraction\n            const m2 = parseMathArgument(m.rest.substr(1), {\n                inlineShortcuts: options.inlineShortcuts ?? {},\n                noWrap: true,\n            });\n            if (m2.match) {\n                s =\n                    '\\\\frac{' +\n                    m.match +\n                    '}{' +\n                    m2.match +\n                    '}' +\n                    parseMathExpression(m2.rest, options);\n            }\n            done = true;\n        } else if (m.match) {\n            if (s[0] === '(') {\n                s =\n                    '\\\\left(' +\n                    m.match +\n                    '\\\\right)' +\n                    parseMathExpression(m.rest, options);\n            } else {\n                s = m.match + parseMathExpression(m.rest, options);\n            }\n            done = true;\n        }\n    }\n\n    if (!done) {\n        m = s.match(/^(\\s+)(.*)$/);\n        // Whitespace\n        if (m) {\n            s = ' ' + parseMathExpression(m[2], options);\n            done = true;\n        }\n    }\n\n    return s;\n}\n\n/**\n * Parse a math argument, as defined by ASCIIMath and UnicodeMath:\n * - Either an expression fenced in (), {} or []\n * - a number (- sign, digits, decimal point, digits)\n * - a single [a-zA-Z] letter (an identifier)\n * - a multi-letter shortcut (e.g., pi)\n * - a LaTeX command (\\pi) (for UnicodeMath)\n * @return\n * - match: the parsed (and converted) portion of the string that is an argument\n * - rest: the raw, unconverted, rest of the string\n */\nfunction parseMathArgument(\n    s: string,\n    options: {\n        noWrap?: boolean;\n        format?: string;\n        inlineShortcuts?: { [key: string]: InlineShortcutDefinition };\n    }\n): { match: string; rest: string } {\n    let match = '';\n    s = s.trim();\n    let rest = s;\n    let lFence = s.charAt(0);\n    let rFence = { '(': ')', '{': '}', '[': ']' }[lFence];\n    if (rFence) {\n        // It's a fence\n        let level = 1;\n        let i = 1;\n        while (i < s.length && level > 0) {\n            if (s[i] === lFence) level++;\n            if (s[i] === rFence) level--;\n            i++;\n        }\n        if (level === 0) {\n            // We've found the matching closing fence\n            if (options.noWrap && lFence === '(') {\n                match = parseMathExpression(s.substring(1, i - 1), options);\n            } else {\n                if (lFence === '{' && rFence === '}') {\n                    lFence = '\\\\{';\n                    rFence = '\\\\}';\n                }\n                match =\n                    '\\\\left' +\n                    lFence +\n                    parseMathExpression(s.substring(1, i - 1), options) +\n                    '\\\\right' +\n                    rFence;\n            }\n            rest = s.substring(i);\n        } else {\n            // Unbalanced fence...\n            match = s.substring(1, i);\n            rest = '';\n        }\n    } else {\n        let m = s.match(/^([a-zA-Z]+)/);\n        if (m) {\n            // It's a string of letter, maybe a shortcut\n            let shortcut = getInlineShortcut(null, s, options.inlineShortcuts);\n            if (shortcut) {\n                shortcut = shortcut.replace('_{#?}', '');\n                shortcut = shortcut.replace('^{#?}', '');\n                return { match: shortcut, rest: s.substring(shortcut.length) };\n            }\n        }\n\n        m = s.match(/^([a-zA-Z])/);\n        if (m) {\n            // It's a single letter\n            return { match: m[1], rest: s.substring(1) };\n        }\n\n        m = s.match(/^(-)?\\d+(\\.\\d*)?/);\n        if (m) {\n            // It's a number\n            return { match: m[0], rest: s.substring(m[0].length) };\n        }\n\n        if (!/^\\\\(left|right)/.test(s)) {\n            // It's a LaTeX command (but not a \\left\\right)\n            m = s.match(/^(\\\\[a-zA-Z]+)/);\n            if (m) {\n                rest = s.substring(m[1].length);\n                match = m[1];\n            }\n        }\n    }\n\n    return { match: match, rest: rest };\n}\n\nfunction paddedShortcut(s: string, options: { format?: string }): string {\n    let result = getInlineShortcut(null, s, options);\n    if (result) {\n        result = result.replace('_{#?}', '');\n        result = result.replace('^{#?}', '');\n        result += ' ';\n    } else {\n        result = s;\n    }\n    return result;\n}\n","import { Atom, isAtomArray } from '../core/atom';\r\nimport type { ModelPrivate } from './model-private';\r\nimport { contentDidChange } from './listeners';\r\nimport { Range } from '../public/mathfield';\r\nimport { Style } from '../public/core';\r\n\r\nexport function applyStyleToUnstyledAtoms(\r\n    atom: Atom | Atom[],\r\n    style: Style\r\n): void {\r\n    if (!atom || !style) return;\r\n    if (isAtomArray(atom)) {\r\n        // Apply styling options to each atom\r\n        atom.forEach((x) => applyStyleToUnstyledAtoms(x, style));\r\n    } else if (typeof atom === 'object') {\r\n        if (\r\n            !atom.style.color &&\r\n            !atom.style.backgroundColor &&\r\n            !atom.style.fontFamily &&\r\n            !atom.style.fontShape &&\r\n            !atom.style.fontSeries &&\r\n            !atom.style.fontSize\r\n        ) {\r\n            atom.applyStyle(style);\r\n            applyStyleToUnstyledAtoms(atom.body, style);\r\n            applyStyleToUnstyledAtoms(atom.above, style);\r\n            applyStyleToUnstyledAtoms(atom.below, style);\r\n            applyStyleToUnstyledAtoms(atom.subscript, style);\r\n            applyStyleToUnstyledAtoms(atom.superscript, style);\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * Apply a style (color, background) to the selection.\r\n *\r\n * If the style is already applied to the selection, remove it. If the selection\r\n * has the style partially applied (i.e. only some sections), remove it from\r\n * those sections, and apply it to the entire selection.\r\n */\r\n\r\nexport function applyStyle(\r\n    model: ModelPrivate,\r\n    range: Range,\r\n    style: Style\r\n    //  & { series?: FontSeries; shape?: FontShape; size?: string }\r\n): boolean {\r\n    function everyStyle(property, value): boolean {\r\n        let result = true;\r\n        model.getAtoms(model.selection).forEach((x) => {\r\n            result = result && x[property] === value;\r\n        });\r\n        return result;\r\n    }\r\n\r\n    range = model.normalizeRange(range);\r\n    if (range[0] === range[1]) return false;\r\n\r\n    if (style.color && everyStyle('color', style.color)) {\r\n        // If the selection already has this color, turn it off\r\n        style.color = 'none';\r\n    }\r\n\r\n    if (\r\n        style.backgroundColor &&\r\n        everyStyle('backgroundColor', style.backgroundColor)\r\n    ) {\r\n        // If the selection already has this color, turn it off\r\n        style.backgroundColor = 'none';\r\n    }\r\n\r\n    if (style.fontFamily && everyStyle('fontFamily', style.fontFamily)) {\r\n        // If the selection already has this font family, turn it off\r\n        style.fontFamily = 'none';\r\n    }\r\n\r\n    // if (style.series) style.fontSeries = style.series;\r\n    if (style.fontSeries && everyStyle('fontSeries', style.fontSeries)) {\r\n        // If the selection already has this series (weight), turn it off\r\n        style.fontSeries = 'auto';\r\n    }\r\n\r\n    // if (style.shape) style.fontShape = style.shape;\r\n    if (style.fontShape && everyStyle('fontShape', style.fontShape)) {\r\n        // If the selection already has this shape (italic), turn it off\r\n        style.fontShape = 'auto';\r\n    }\r\n\r\n    // if (style.size) style.fontSize = style.size;\r\n    if (style.fontSize && everyStyle('fontSize', style.fontSize)) {\r\n        // If the selection already has this size, reset it to default size\r\n        style.fontSize = 'size5';\r\n    }\r\n\r\n    model.getAtoms(range).forEach((x) => x.applyStyle(style));\r\n\r\n    contentDidChange(model);\r\n\r\n    return true;\r\n}\r\n","import type { ParseMode } from '../public/core';\r\n\r\nimport { LETTER_AND_DIGITS } from '../core-definitions/definitions';\r\nimport { Atom } from '../core/atom';\r\n\r\nimport { ModelPrivate } from './model-private';\r\n// import {\r\n//     arrayCell,\r\n//     arrayIndex,\r\n//     arrayColRow,\r\n//     arrayAdjustRow,\r\n// } from './model-array-utils';\r\nimport { Offset } from '../public/mathfield';\r\nimport { deleteRange } from './delete';\r\nimport { getCommandSuggestionRange } from './command-mode';\r\nimport { SubsupAtom } from '../core-atoms/subsup';\r\n\r\n/**\r\n * Return true if the atom could be a part of a number\r\n * i.e. \"-12354.568\"\r\n */\r\nfunction isNumber(atom: Atom): boolean {\r\n    if (!atom) return false;\r\n    return (\r\n        (atom.type === 'mord' && /[0-9.]/.test(atom.value)) ||\r\n        (atom.type === 'mpunct' && atom.value === ',')\r\n    );\r\n}\r\n\r\nexport function getMode(model: ModelPrivate, offset: Offset): ParseMode {\r\n    const atom = model.at(offset);\r\n    let result: ParseMode;\r\n    if (atom) {\r\n        result = atom.mode as ParseMode;\r\n        let ancestor = atom.parent;\r\n        while (!result && ancestor) {\r\n            if (ancestor) result = ancestor.mode as ParseMode;\r\n            ancestor = ancestor.parent;\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\n/**\r\n * Move to the next/previous placeholder or empty child list.\r\n * @return False if no placeholder found and did not move\r\n */\r\nexport function leap(\r\n    model: ModelPrivate,\r\n    dir: 'forward' | 'backward',\r\n    callHooks = true\r\n): boolean {\r\n    const dist = dir === 'forward' ? 1 : -1;\r\n    if (model.at(model.anchor).type === 'placeholder') {\r\n        // If we're already at a placeholder, move by one more (the placeholder\r\n        // is right after the insertion point)\r\n        move(model, dir);\r\n    }\r\n    // Candidate placeholders are atom of type 'placeholder'\r\n    // or empty children list (except for the root: if the root is empty,\r\n    // it is not a valid placeholder)\r\n    const atoms = model.getAllAtoms(model.position + dist);\r\n    if (dir === 'backward') atoms.reverse();\r\n    const placeholders = atoms.filter(\r\n        (atom) =>\r\n            atom.type === 'placeholder' ||\r\n            (atom.treeDepth > 0 && atom.isFirstSibling && atom.isLastSibling)\r\n    );\r\n\r\n    // If no placeholders were found, call handler or move to the next focusable\r\n    // element in the document\r\n    if (placeholders.length === 0) {\r\n        const handled = !callHooks || !model.hooks.tabOut?.(model, dir);\r\n        if (handled) return false;\r\n        const tabbable = getTabbableElements();\r\n        if (!document.activeElement || tabbable.length === 1) {\r\n            model.announce('plonk');\r\n            return false;\r\n        }\r\n        let index =\r\n            tabbable.indexOf(document.activeElement as HTMLElement) + dist;\r\n        if (index < 0) index = tabbable.length - 1;\r\n        if (index >= tabbable.length) index = 0;\r\n        tabbable[index].focus();\r\n\r\n        return false;\r\n    }\r\n\r\n    // Set the selection to the next placeholder\r\n    const previousPosition = model.position;\r\n    const newPosition = model.offsetOf(placeholders[0]);\r\n    if (placeholders[0].type === 'placeholder') {\r\n        model.setSelection(newPosition - 1, newPosition);\r\n    } else {\r\n        model.position = newPosition;\r\n    }\r\n    model.announce('move', previousPosition);\r\n    return true;\r\n}\r\n\r\n/**\r\n * Return an array of tabbable elements, approximately in the order a browser\r\n * would (the browsers are inconsistent), which is first by accounting\r\n * for non-null tabIndex, then null tabIndex, then document order of focusable\r\n * elements.\r\n */\r\nfunction getTabbableElements(): HTMLElement[] {\r\n    // const focussableElements = `a[href]:not([disabled]),\r\n    // button:not([disabled]),\r\n    // textarea:not([disabled]),\r\n    // input[type=text]:not([disabled]),\r\n    // select:not([disabled]),\r\n    // [contentEditable=\"true\"],\r\n    // [tabindex]:not([disabled]):not([tabindex=\"-1\"])`;\r\n    // // Get all the potentially focusable elements\r\n    // // and exclude (1) those that are invisible (width and height = 0)\r\n    // // (2) not the active element\r\n    // // (3) the ancestor of the active element\r\n\r\n    // return Array.prototype.filter.call(\r\n    //     document.querySelectorAll(focussableElements),\r\n    //     (element) =>\r\n    //         ((element.offsetWidth > 0 || element.offsetHeight > 0) &&\r\n    //             !element.contains(document.activeElement)) ||\r\n    //         element === document.activeElement\r\n    // );\r\n\r\n    function tabbable(el: HTMLElement) {\r\n        const regularTabbables = [];\r\n        const orderedTabbables = [];\r\n\r\n        const candidates = Array.from(\r\n            el.querySelectorAll<\r\n                HTMLElement\r\n            >(`input, select, textarea, a[href], button, \r\n        [tabindex], audio[controls], video[controls],\r\n        [contenteditable]:not([contenteditable=\"false\"]), details>summary`)\r\n        ).filter(isNodeMatchingSelectorTabbable);\r\n\r\n        candidates.forEach((candidate, i) => {\r\n            const candidateTabindex = getTabindex(candidate);\r\n            if (candidateTabindex === 0) {\r\n                regularTabbables.push(candidate);\r\n            } else {\r\n                orderedTabbables.push({\r\n                    documentOrder: i,\r\n                    tabIndex: candidateTabindex,\r\n                    node: candidate,\r\n                });\r\n            }\r\n        });\r\n\r\n        return orderedTabbables\r\n            .sort((a, b) =>\r\n                a.tabIndex === b.tabIndex\r\n                    ? a.documentOrder - b.documentOrder\r\n                    : a.tabIndex - b.tabIndex\r\n            )\r\n            .map((a) => a.node)\r\n            .concat(regularTabbables);\r\n    }\r\n\r\n    function isNodeMatchingSelectorTabbable(el: HTMLElement): boolean {\r\n        if (\r\n            !isNodeMatchingSelectorFocusable(el) ||\r\n            isNonTabbableRadio(el) ||\r\n            getTabindex(el) < 0\r\n        ) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    function isNodeMatchingSelectorFocusable(node) {\r\n        if (\r\n            node.disabled ||\r\n            (node.tagName === 'INPUT' && node.type === 'hidden') ||\r\n            isHidden(node)\r\n        ) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    function getTabindex(node: HTMLElement): number {\r\n        const tabindexAttr = parseInt(node.getAttribute('tabindex'), 10);\r\n\r\n        if (!isNaN(tabindexAttr)) {\r\n            return tabindexAttr;\r\n        }\r\n\r\n        // Browsers do not return `tabIndex` correctly for contentEditable nodes;\r\n        // so if they don't have a tabindex attribute specifically set, assume it's 0.\r\n        if (node.contentEditable === 'true') {\r\n            return 0;\r\n        }\r\n\r\n        // in Chrome, <audio controls/> and <video controls/> elements get a default\r\n        //  `tabIndex` of -1 when the 'tabindex' attribute isn't specified in the DOM,\r\n        //  yet they are still part of the regular tab order; in FF, they get a default\r\n        //  `tabIndex` of 0; since Chrome still puts those elements in the regular tab\r\n        //  order, consider their tab index to be 0\r\n        if (\r\n            (node.nodeName === 'AUDIO' || node.nodeName === 'VIDEO') &&\r\n            node.getAttribute('tabindex') === null\r\n        ) {\r\n            return 0;\r\n        }\r\n\r\n        return node.tabIndex;\r\n    }\r\n\r\n    function isNonTabbableRadio(node: HTMLElement): boolean {\r\n        return (\r\n            node.tagName === 'INPUT' &&\r\n            (node as HTMLInputElement).type === 'radio' &&\r\n            !isTabbableRadio(node as HTMLInputElement)\r\n        );\r\n    }\r\n\r\n    function getCheckedRadio(nodes, form) {\r\n        for (let i = 0; i < nodes.length; i++) {\r\n            if (nodes[i].checked && nodes[i].form === form) {\r\n                return nodes[i];\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    function isTabbableRadio(node: HTMLInputElement): boolean {\r\n        if (!node.name) {\r\n            return true;\r\n        }\r\n        const radioScope = node.form || node.ownerDocument;\r\n        const radioSet = radioScope.querySelectorAll(\r\n            'input[type=\"radio\"][name=\"' + node.name + '\"]'\r\n        );\r\n        const checked = getCheckedRadio(radioSet, node.form);\r\n        return !checked || checked === node;\r\n    }\r\n\r\n    function isHidden(el: HTMLElement) {\r\n        if (\r\n            el === document.activeElement ||\r\n            el.contains(document.activeElement)\r\n        ) {\r\n            return false;\r\n        }\r\n\r\n        if (getComputedStyle(el).visibility === 'hidden') return true;\r\n\r\n        // Note that browsers generally don't consider the bounding rect\r\n        // as a criteria to determine if an item is focusable, but we want\r\n        // to exclude the invisible textareas used to capture keyoard input.\r\n        const bounds = el.getBoundingClientRect();\r\n        if (bounds.width === 0 || bounds.height === 0) return true;\r\n\r\n        while (el) {\r\n            if (getComputedStyle(el).display === 'none') return true;\r\n            el = el.parentElement;\r\n        }\r\n\r\n        return false;\r\n    }\r\n    return tabbable(document.body);\r\n}\r\n\r\n/**\r\n * Handle keyboard navigation (arrow keys)\r\n */\r\nexport function move(\r\n    model: ModelPrivate,\r\n    direction: 'forward' | 'backward' | 'upward' | 'downward',\r\n    options?: { extend: boolean }\r\n): boolean {\r\n    options = options ?? { extend: false };\r\n\r\n    deleteRange(model, getCommandSuggestionRange(model));\r\n\r\n    if (direction === 'upward') return moveUpward(model, options);\r\n    if (direction === 'downward') return moveDownward(model, options);\r\n\r\n    const previousPosition = model.position;\r\n\r\n    if (options.extend) {\r\n        return model.extendSelection(direction);\r\n    }\r\n    if (model.selectionIsPlaceholder) {\r\n        model.collapseSelection(direction);\r\n        return move(model, direction);\r\n    }\r\n    if (!model.collapseSelection(direction)) {\r\n        let pos = model.position + (direction === 'forward' ? +1 : -1);\r\n\r\n        //\r\n        // 1. Handle `captureSelection` and `skipBoundary`\r\n        //\r\n        if (direction === 'forward') {\r\n            const atom = model.at(model.position + 1);\r\n            if (atom?.parent?.captureSelection) {\r\n                // When going forward, if in a capture selection, jump to\r\n                // after\r\n                pos = model.offsetOf(atom?.parent.lastChild) + 1;\r\n            } else if (atom?.skipBoundary) {\r\n                // When going forward if next is skipboundary, move 2\r\n                pos += 1;\r\n            }\r\n        } else if (direction === 'backward') {\r\n            const atom = model.at(model.position - 1);\r\n            if (atom?.parent?.captureSelection) {\r\n                // When going backward, if in a capture selection, jump to\r\n                // before\r\n                pos = Math.max(0, model.offsetOf(atom?.parent.firstChild) - 1);\r\n            } else if (atom?.isFirstSibling && atom.parent?.skipBoundary) {\r\n                // When going backward, if land on first of group and previous is\r\n                // skipbounday,  move -2\r\n                pos -= 1;\r\n            }\r\n        }\r\n\r\n        //\r\n        // 2. Handle out of bounds\r\n        //\r\n        if (pos < 0 || pos > model.lastOffset) {\r\n            // We're going out of bounds\r\n            let result = true; // true => perform default handling\r\n            if (!model.suppressChangeNotifications) {\r\n                result = model.hooks?.moveOut(model, direction);\r\n            }\r\n            if (result) model.announce('plonk');\r\n            return result;\r\n        }\r\n\r\n        //\r\n        // 3. Handle placeholder\r\n        //\r\n        if (model.at(pos)?.type === 'placeholder') {\r\n            // We're going right of a placeholder: select it\r\n            model.setSelection(pos - 1, pos);\r\n        } else if (model.at(pos)?.rightSibling?.type === 'placeholder') {\r\n            // We're going left of a placeholder: select it\r\n            model.setSelection(pos, pos + 1);\r\n        } else {\r\n            model.position = pos;\r\n        }\r\n    }\r\n\r\n    model.announce('move', previousPosition);\r\n    return true;\r\n}\r\n\r\nfunction moveUpward(\r\n    model: ModelPrivate,\r\n    options?: { extend: boolean }\r\n): boolean {\r\n    const extend = options?.extend ?? false;\r\n\r\n    model.collapseSelection('backward');\r\n    // Find a target branch\r\n    // This is to handle the case: `\\frac{x}{\\sqrt{y}}`. If we're at `y`\r\n    // we'd expectto move to `x`, even though `\\sqrt` doesn't have an 'above'\r\n    // branch, but one of its ancestor does.\r\n    let atom = model.at(model.position);\r\n    while (atom && atom.treeBranch !== 'below') {\r\n        atom = atom.parent;\r\n    }\r\n\r\n    if (atom) {\r\n        if (extend) {\r\n            model.setSelection(\r\n                model.offsetOf(atom.parent.leftSibling),\r\n                model.offsetOf(atom.parent)\r\n            );\r\n        } else {\r\n            // If branch doesn't exist, create it\r\n            const branch =\r\n                atom.parent.branch('above') ??\r\n                atom.parent.createBranch('above');\r\n\r\n            // Move to the last atom of the branch\r\n            model.position = model.offsetOf(branch[branch.length - 1]);\r\n        }\r\n        model.announce('moveUp');\r\n        // } else if (model.parent.array) {\r\n        //     // In an array\r\n        //     let colRow = arrayColRow(model.parent.array, relation);\r\n        //     colRow = arrayAdjustRow(model.parent.array, colRow, -1);\r\n        //     if (colRow && arrayCell(model.parent.array, colRow)) {\r\n        //         model.path[model.path.length - 1].relation = ('cell' +\r\n        //             arrayIndex(model.parent.array, colRow)) as Relation;\r\n        //         setSelectionOffset(model, model.anchorOffset());\r\n\r\n        //         model.announce('moveUp');\r\n        //     } else {\r\n        //         move(model, 'backward', options);\r\n        //     }\r\n    } else {\r\n        if (!model.at(model.position).parent?.parent) {\r\n            let result = true; // true => perform default handling\r\n            if (!model.suppressChangeNotifications) {\r\n                result = model.hooks?.moveOut(model, 'upward');\r\n            }\r\n            model.announce(result ? 'plonk' : 'line');\r\n            return result;\r\n        }\r\n    }\r\n    return true;\r\n}\r\n\r\nfunction moveDownward(\r\n    model: ModelPrivate,\r\n    options?: { extend: boolean }\r\n): boolean {\r\n    const extend = options?.extend ?? false;\r\n\r\n    model.collapseSelection('forward');\r\n    let atom = model.at(model.position);\r\n    while (atom && atom.treeBranch !== 'above') {\r\n        atom = atom.parent;\r\n    }\r\n\r\n    if (atom) {\r\n        if (extend) {\r\n            model.setSelection(\r\n                model.offsetOf(atom.parent.leftSibling),\r\n                model.offsetOf(atom.parent)\r\n            );\r\n        } else {\r\n            // If branch doesn't exist, create it\r\n            const branch =\r\n                atom.parent.branch('below') ??\r\n                atom.parent.createBranch('below');\r\n\r\n            // Move to the last atom of the branch\r\n            model.position = model.offsetOf(branch[branch.length - 1]);\r\n        }\r\n        model.announce('moveDown');\r\n        //     // In an array\r\n        //     let colRow = arrayColRow(model.parent.array, relation);\r\n        //     colRow = arrayAdjustRow(model.parent.array, colRow, +1);\r\n        //     // @revisit: validate this codepath\r\n        //     if (colRow && arrayCell(model.parent.array, colRow)) {\r\n        //         model.path[model.path.length - 1].relation = ('cell' +\r\n        //             arrayIndex(model.parent.array, colRow)) as Relation;\r\n        //         setSelectionOffset(model, model.anchorOffset());\r\n        //         model.announce('moveDown');\r\n        //     } else {\r\n        //         move(model, 'forward', options);\r\n        //     }\r\n    } else {\r\n        if (!model.at(model.position).parent?.parent) {\r\n            let result = true; // true => perform default handling\r\n            if (!model.suppressChangeNotifications) {\r\n                result = model.hooks?.moveOut(model, 'downward');\r\n            }\r\n            model.announce(result ? 'plonk' : 'line');\r\n            return result;\r\n        }\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\n/**\r\n * Keyboard navigation with alt/option:\r\n * Move the insertion point to the next/previous point of interest.\r\n * A point of interest is an atom of a different type (mbin, mord, etc...)\r\n * than the current focus.\r\n * If `extend` is true, the selection will be extended. Otherwise, it is\r\n * collapsed, then moved.\r\n * @param dir +1 to skip forward, -1 to skip back\r\n * @revisit: to do\r\n */\r\nexport function skip(\r\n    model: ModelPrivate,\r\n    direction: 'forward' | 'backward',\r\n    options?: { extend: boolean }\r\n): boolean {\r\n    const previousPosition = model.position;\r\n\r\n    if (!(options?.extend ?? false)) {\r\n        model.collapseSelection(direction);\r\n    }\r\n    let atom = model.at(model.position);\r\n    if (direction === 'forward') {\r\n        if (atom.type === 'msubsup') {\r\n            atom = atom.rightSibling;\r\n            if (!atom) {\r\n                atom = model.at(model.position + 1);\r\n            }\r\n        } else {\r\n            atom = model.at(model.position + 1);\r\n        }\r\n    }\r\n    if (!atom) return false;\r\n    let offset = model.offsetOf(atom);\r\n\r\n    if (atom.mode === 'text') {\r\n        //\r\n        // We're in a text zone, skip word by word\r\n        //\r\n        offset = wordBoundaryOffset(model, offset, direction);\r\n    } else if (direction === 'forward' && atom.type === 'mopen') {\r\n        //\r\n        // Right before a 'mopen', skip to the corresponding balanced fence\r\n        //\r\n        let level = 0;\r\n        do {\r\n            if (atom.type === 'mopen') {\r\n                level += 1;\r\n            } else if (atom.type === 'mclose') {\r\n                level -= 1;\r\n            }\r\n            atom = atom.rightSibling;\r\n        } while (!atom.isLastSibling && level !== 0);\r\n        offset = model.offsetOf(atom.leftSibling);\r\n    } else if (direction === 'backward' && atom.type === 'mclose') {\r\n        //\r\n        // Right after a 'mclose', skip to the corresponding balanced fence\r\n        //\r\n        let level = 0;\r\n        do {\r\n            if (atom.type === 'mopen') {\r\n                level += 1;\r\n            } else if (atom.type === 'mclose') {\r\n                level -= 1;\r\n            }\r\n            atom = atom.leftSibling;\r\n        } while (!atom.isFirstSibling && level !== 0);\r\n        offset = model.offsetOf(atom);\r\n    } else {\r\n        //\r\n        // We're in a regular math zone (not before/after a fence)\r\n        //\r\n        if (direction === 'backward') {\r\n            if (atom.type === 'first') {\r\n                while (offset > 0 && atom.type === 'first') {\r\n                    offset -= 1;\r\n                    atom = model.at(offset);\r\n                }\r\n            } else {\r\n                const type =\r\n                    atom instanceof SubsupAtom ? atom.baseType : atom.type;\r\n                if (atom.type === 'msubsup') {\r\n                    // If we're after a 'msubsup', skip to its left sibling\r\n                    // (the base of the super/subscript)\r\n                    offset = model.offsetOf(model.at(offset).leftSibling);\r\n                }\r\n                offset -= 1;\r\n                let nextType = model.at(offset)?.type;\r\n                // if (nextType === 'msubsup') {\r\n                //     offset = model.offsetOf(model.at(offset).leftSibling);\r\n                // }\r\n                while (offset >= 0 && nextType === type) {\r\n                    if (model.at(offset)?.type === 'msubsup') {\r\n                        offset = model.offsetOf(model.at(offset).leftSibling);\r\n                    } else {\r\n                        offset -= 1;\r\n                    }\r\n                    nextType = model.at(offset).type;\r\n                }\r\n            }\r\n        } else {\r\n            const type = atom.type;\r\n            // if (atom.type === 'msubsup') {\r\n            //     offset = model.offsetOf(model.at(offset).rightSibling);\r\n            // }\r\n            let nextType = model.at(offset)?.type;\r\n            const lastOffset = model.lastOffset;\r\n            while (\r\n                offset <= lastOffset &&\r\n                (nextType === type || nextType === 'msubsup')\r\n            ) {\r\n                while (model.at(offset).rightSibling?.type === 'msubsup') {\r\n                    offset = model.offsetOf(model.at(offset).rightSibling);\r\n                }\r\n                offset += 1;\r\n                nextType = model.at(offset)?.type;\r\n            }\r\n            offset -= 1;\r\n        }\r\n    }\r\n\r\n    if (options?.extend ?? false) {\r\n        model.setSelection(model.anchor, offset);\r\n    } else {\r\n        model.position = offset;\r\n    }\r\n    model.announce('move', previousPosition);\r\n    return true;\r\n}\r\n\r\n/**\r\n * Select all the atoms in the current group, that is all the siblings.\r\n * When the selection is in a numerator, the group is the numerator. When\r\n * the selection is a superscript or subscript, the group is the supsub.\r\n * When the selection is in a text zone, the \"group\" is a word.\r\n */\r\nexport function selectGroup(model: ModelPrivate): boolean {\r\n    if (getMode(model, model.position) === 'text') {\r\n        let start = Math.min(model.anchor, model.position);\r\n        let end = Math.max(model.anchor, model.position);\r\n        //\r\n        let done = false;\r\n        while (!done && start > 0) {\r\n            const atom = model.at(start);\r\n            if (atom.mode === 'text' && LETTER_AND_DIGITS.test(atom.value)) {\r\n                start -= 1;\r\n            } else {\r\n                done = true;\r\n            }\r\n        }\r\n        done = false;\r\n        while (!done && end <= model.lastOffset) {\r\n            const atom = model.at(end);\r\n            if (atom.mode === 'text' && LETTER_AND_DIGITS.test(atom.value)) {\r\n                end += 1;\r\n            } else {\r\n                done = true;\r\n            }\r\n        }\r\n        if (done) {\r\n            end -= 1;\r\n        }\r\n        if (start >= end) {\r\n            // No word found. Select a single character\r\n            model.setSelection(end - 1, end);\r\n            return true;\r\n        }\r\n\r\n        model.setSelection(start, end);\r\n    } else {\r\n        const atom = model.at(model.position);\r\n        // In a math zone, select all the sibling nodes\r\n        if (isNumber(atom)) {\r\n            // In a number, select all the digits\r\n            let start = Math.min(model.anchor, model.position);\r\n            let end = Math.max(model.anchor, model.position);\r\n            //\r\n            while (isNumber(model.at(start))) start -= 1;\r\n            while (isNumber(model.at(end))) end += 1;\r\n            model.setSelection(start, end - 1);\r\n        } else {\r\n            model.setSelection(\r\n                model.offsetOf(atom.firstSibling),\r\n                model.offsetOf(atom.lastSibling)\r\n            );\r\n        }\r\n    }\r\n    return true;\r\n}\r\n\r\nexport function moveAfterParent(model: ModelPrivate): boolean {\r\n    const previousPosition = model.position;\r\n    if (!model.at(previousPosition).parent) {\r\n        model.announce('plonk');\r\n        return false;\r\n    }\r\n    model.position = model.offsetOf(model.at(model.position).parent);\r\n    model.announce('move', previousPosition);\r\n    return true;\r\n}\r\n\r\n/*\r\n * Calculates the offset of the \"next word\".\r\n * This is inspired by the behavior of text editors on macOS, namely:\r\n    blue   yellow\r\n      ^-\r\n         ^-------\r\n * That is:\r\n\r\n * (1) If starts with an alphanumerical character, find the first alphanumerical\r\n * character which is followed by a non-alphanumerical character\r\n *\r\n * The behavior regarding non-alphanumeric characters is less consistent.\r\n * Here's the behavior we use:\r\n *\r\n *   +=-()_:     blue\r\n * ^---------\r\n *   +=-()_:     blue\r\n *      ^---------\r\n *   +=-()_:blue\r\n *      ^--------\r\n *\r\n * (2) If starts in whitespace, skip whitespace, then find first non-whitespace*\r\n *    followed by whitespace\r\n * (*) Pages actually uses the character class of the first non-whitespace\r\n * encountered.\r\n *\r\n * (3) If starts in a non-whitespace, non alphanumerical character, find the first\r\n *      whitespace\r\n *\r\n */\r\nexport function wordBoundaryOffset(\r\n    model: ModelPrivate,\r\n    offset: Offset,\r\n    direction: 'forward' | 'backward'\r\n): number {\r\n    if (model.at(offset).mode !== 'text') return offset;\r\n    const dir = direction === 'backward' ? -1 : +1;\r\n    let result;\r\n    if (LETTER_AND_DIGITS.test(model.at(offset).value)) {\r\n        // (1) We start with an alphanumerical character\r\n        let i = offset;\r\n        let match;\r\n        do {\r\n            match =\r\n                model.at(i).mode === 'text' &&\r\n                LETTER_AND_DIGITS.test(model.at(i).value);\r\n            i += dir;\r\n        } while (model.at(i) && match);\r\n        result = model.at(i) ? i - 2 * dir : i - dir;\r\n    } else if (/\\s/.test(model.at(offset).value)) {\r\n        // (2) We start with whitespace\r\n\r\n        // Skip whitespace\r\n        let i = offset;\r\n        while (\r\n            model.at(i) &&\r\n            model.at(i).mode === 'text' &&\r\n            /\\s/.test(model.at(i).value)\r\n        ) {\r\n            i += dir;\r\n        }\r\n        if (!model.at(i)) {\r\n            // We've reached the end\r\n            result = i - dir;\r\n        } else {\r\n            let match = true;\r\n            do {\r\n                match =\r\n                    model.at(i).mode === 'text' &&\r\n                    !/\\s/.test(model.at(i).value);\r\n                i += dir;\r\n            } while (model.at(i) && match);\r\n            result = model.at(i) ? i - 2 * dir : i - dir;\r\n        }\r\n    } else {\r\n        // (3)\r\n        let i = offset;\r\n        // Skip non-whitespace\r\n        while (\r\n            model.at(i) &&\r\n            model.at(i).mode === 'text' &&\r\n            !/\\s/.test(model.at(i).value)\r\n        ) {\r\n            i += dir;\r\n        }\r\n        result = model.at(i) ? i : i - dir;\r\n        let match = true;\r\n        while (model.at(i) && match) {\r\n            match = model.at(i).mode === 'text' && /\\s/.test(model.at(i).value);\r\n            if (match) result = i;\r\n            i += dir;\r\n        }\r\n        result = model.at(i) ? i - 2 * dir : i - dir;\r\n    }\r\n\r\n    return result - (dir > 0 ? 0 : 1);\r\n}\r\n","import { Atom, ToLatexOptions } from '../core/atom-class';\nimport { Span } from '../core/span';\nimport { Context } from '../core/context';\nimport { ParseMode, Style } from '../public/core';\n\nexport class CompositionAtom extends Atom {\n    constructor(value: string, options?: { mode: ParseMode }) {\n        super('composition', { mode: options?.mode ?? 'math', value });\n    }\n    get computedStyle(): Style {\n        return {};\n    }\n    render(context: Context): Span[] {\n        // In theory one would like to be able to draw the clauses\n        // in an active composition. Unfortunately, there are\n        // no API to give access to those clauses :(\n        const result = this.makeSpan(context, this.value);\n        result.classes = 'ML__composition';\n        if (this.caret) result.caret = this.caret;\n        return [result];\n    }\n    toLatex(_options: ToLatexOptions): string {\n        return '';\n    }\n}\n","import { InsertOptions, Offset } from '../public/mathfield';\r\n\r\nimport { COMMAND_MODE_CHARACTERS, parseString } from '../core/core';\r\nimport { Atom, BranchName, NAMED_BRANCHES } from '../core/atom-class';\r\nimport { ArrayAtom } from '../core-atoms/array';\r\n\r\nimport { parseMathString } from '../editor/parse-math-string';\r\n\r\nimport { ModelPrivate } from './model-private';\r\nimport { applyStyleToUnstyledAtoms } from './styling';\r\nimport { contentDidChange, selectionDidChange } from './listeners';\r\n\r\nimport { getMode, move } from './selection';\r\n\r\nimport type { Style } from '../public/core';\r\nimport { LeftRightAtom } from '../core-atoms/leftright';\r\nimport { CommandAtom } from '../core-atoms/command';\r\nimport { CompositionAtom } from '../core-atoms/composition';\r\nimport { RIGHT_DELIM } from '../core/delimiters';\r\nimport { range } from './selection-utils';\r\n\r\nfunction convertStringToAtoms(\r\n    model: ModelPrivate,\r\n    s: string,\r\n    args: string[],\r\n    options: InsertOptions\r\n): Atom[] {\r\n    const mode = options.mode ?? getMode(model, model.position);\r\n\r\n    let result = [];\r\n    if (mode === 'math' && options.format === 'ASCIIMath') {\r\n        [, s] = parseMathString(s, { format: 'ASCIIMath' });\r\n        result = parseString(\r\n            s,\r\n            'math',\r\n            null,\r\n            options?.macros,\r\n            false,\r\n            model.listeners.onError\r\n        );\r\n\r\n        // Simplify result.\r\n        if (model.options.removeExtraneousParentheses) {\r\n            simplifyParen(result);\r\n        }\r\n    } else if (\r\n        mode !== 'text' &&\r\n        (options.format === 'auto' || options.format === 'latex')\r\n    ) {\r\n        if (mode === 'command') {\r\n            // Short-circuit the tokenizer and parser if in command mode\r\n            result = [];\r\n            for (const c of s) {\r\n                if (COMMAND_MODE_CHARACTERS.test(c)) {\r\n                    result.push(new CommandAtom(c));\r\n                }\r\n            }\r\n        } else if (mode === 'math') {\r\n            if (options.format === 'auto') {\r\n                [options.format, s] = parseMathString(s);\r\n            }\r\n\r\n            // If the whole string is bracketed by a mode shift command, remove it\r\n            if (/^\\$\\$(.*)\\$\\$$/.test(s)) {\r\n                s = s.substring(2, s.length - 2);\r\n            }\r\n\r\n            result = parseString(\r\n                s,\r\n                mode,\r\n                args,\r\n                options.macros,\r\n                options.smartFence ?? false,\r\n                model.listeners.onError\r\n            );\r\n\r\n            // Simplify result.\r\n            if (\r\n                options.format !== 'latex' &&\r\n                model.options.removeExtraneousParentheses\r\n            ) {\r\n                simplifyParen(result);\r\n            }\r\n        }\r\n    } else if (mode === 'text') {\r\n        // Map special TeX characters to alternatives\r\n        // Must do this one first, since other replacements include backslash\r\n        s = s.replace(/\\\\/g, '\\\\textbackslash ');\r\n\r\n        s = s.replace(/#/g, '\\\\#');\r\n        s = s.replace(/\\$/g, '\\\\$');\r\n        s = s.replace(/%/g, '\\\\%');\r\n        s = s.replace(/&/g, '\\\\&');\r\n        // s = s.replace(/:/g, '\\\\colon');     // text colon?\r\n        // s = s.replace(/\\[/g, '\\\\lbrack');\r\n        // s = s.replace(/]/g, '\\\\rbrack');\r\n        s = s.replace(/_/g, '\\\\_');\r\n        s = s.replace(/{/g, '\\\\textbraceleft ');\r\n        s = s.replace(/}/g, '\\\\textbraceright ');\r\n        s = s.replace(/\\^/g, '\\\\textasciicircum ');\r\n        s = s.replace(/~/g, '\\\\textasciitilde ');\r\n        s = s.replace(//g, '\\\\textsterling ');\r\n\r\n        result = parseString(\r\n            s,\r\n            'text',\r\n            args,\r\n            options.macros,\r\n            false,\r\n            model.listeners.onError\r\n        );\r\n    }\r\n\r\n    // Some atoms may already have a style (for example if there was an\r\n    // argument, i.e. the selection, that this was applied to).\r\n    // So, don't apply style to atoms that are already styled, but *do*\r\n    // apply it to newly created atoms that have no style yet.\r\n    applyStyleToUnstyledAtoms(result, options.style);\r\n\r\n    return result;\r\n}\r\n\r\nexport function insert(\r\n    model: ModelPrivate,\r\n    s: string,\r\n    options: InsertOptions\r\n): boolean {\r\n    if (!options.insertionMode) options.insertionMode = 'replaceSelection';\r\n    if (!options.selectionMode) options.selectionMode = 'placeholder';\r\n    if (!options.format) options.format = 'auto';\r\n    options.macros = options.macros ?? model.options.macros;\r\n\r\n    //\r\n    // Try to insert a smart fence.\r\n    //\r\n    if (!(options.smartFence ?? false)) {\r\n        // When smartFence is turned off, only do a \"smart\" fence insert\r\n        // if we're inside a `leftright`, at the last char\r\n        const parent = model.at(model.position).parent;\r\n        if (\r\n            parent instanceof LeftRightAtom &&\r\n            parent.rightDelim === '?' &&\r\n            model.at(model.position).isLastSibling &&\r\n            /^[)}\\]|]$/.test(s)\r\n        ) {\r\n            parent.rightDelim = s;\r\n            model.position += 1;\r\n            selectionDidChange(model);\r\n            contentDidChange(model);\r\n            return true;\r\n        }\r\n    } else if (\r\n        model.selectionIsCollapsed &&\r\n        insertSmartFence(model, s, options.style)\r\n    ) {\r\n        return true;\r\n    }\r\n\r\n    const suppressChangeNotifications = model.suppressChangeNotifications;\r\n    if (options.suppressChangeNotifications) {\r\n        model.suppressChangeNotifications = true;\r\n    }\r\n    const contentWasChanging = model.suppressChangeNotifications;\r\n    model.suppressChangeNotifications = true;\r\n\r\n    //\r\n    // Save the content of the selection, if any\r\n    //\r\n    const args: string[] = [];\r\n    args[0] = model.getValue(model.selection);\r\n    args['?'] = options.placeholder ?? '\\\\placeholder{}';\r\n    args['@'] = args['?'];\r\n\r\n    //\r\n    // Delete any selected items\r\n    //\r\n    if (\r\n        options.insertionMode === 'replaceSelection' &&\r\n        !model.selectionIsCollapsed\r\n    ) {\r\n        model.deleteAtoms(range(model.selection));\r\n    } else if (options.insertionMode === 'replaceAll') {\r\n        model.root.setChildren([], 'body');\r\n        model.position = 0;\r\n    } else if (options.insertionMode === 'insertBefore') {\r\n        model.collapseSelection('backward');\r\n    } else if (options.insertionMode === 'insertAfter') {\r\n        model.collapseSelection('forward');\r\n    }\r\n\r\n    //\r\n    // Delete any placeholders before or after the insertion point\r\n    //\r\n    if (\r\n        !model.at(model.position).isLastSibling &&\r\n        model.at(model.position + 1).type === 'placeholder'\r\n    ) {\r\n        // Before a `placeholder`\r\n        model.deleteAtoms([model.position, model.position + 1]);\r\n    } else if (model.at(model.position).type === 'placeholder') {\r\n        // After a `placeholder`\r\n        model.deleteAtoms([model.position - 1, model.position]);\r\n    }\r\n\r\n    //\r\n    // Calculate the implicit argument (#@)\r\n    //\r\n    const mode = options.mode ?? getMode(model, model.position);\r\n    if (mode === 'math') {\r\n        if (args[0]) {\r\n            // There was a selection, we'll use it for #@\r\n            args['@'] = args[0];\r\n        } else if (/(^|[^\\\\])#@/.test(s)) {\r\n            // We'll use the preceding `mord`s or text mode atoms for it (implicit argument)\r\n            const offset = getImplicitArgOffset(model);\r\n            if (offset >= 0) {\r\n                args['@'] = model.getValue(offset, model.position);\r\n                model.deleteAtoms([offset, model.position]);\r\n            }\r\n        }\r\n        if (!args[0]) args[0] = args['?'];\r\n    }\r\n\r\n    const newAtoms = convertStringToAtoms(model, s, args, options);\r\n    if (!newAtoms) return false;\r\n\r\n    //\r\n    // Insert the new atoms\r\n    //\r\n    const parent = model.at(model.position).parent;\r\n    // Are we inserting a fraction inside a lefright?\r\n    if (\r\n        options.format !== 'latex' &&\r\n        model.options.removeExtraneousParentheses &&\r\n        parent instanceof LeftRightAtom &&\r\n        parent.leftDelim === '(' &&\r\n        parent.hasEmptyBranch('body') &&\r\n        newAtoms.length === 1 &&\r\n        newAtoms[0].type === 'genfrac'\r\n    ) {\r\n        // Remove the leftright\r\n        // i.e. `\\left(\\frac{}{}\\right))` -> `\\frac{}{}`\r\n        const newParent = parent.parent;\r\n        const branch = parent.treeBranch;\r\n        newParent.removeChild(parent);\r\n        newParent.setChildren(newAtoms, branch);\r\n    } else {\r\n        if (options.format === 'latex' && args.length === 1 && !args[0]) {\r\n            // If we are given a latex string with no arguments, store it verbatim\r\n            // Caution: we can only do this if the toLatex() for this parent\r\n            // would return an empty string. If the latex is generated using other\r\n            // properties than parent.body, for example by adding '\\left.' and\r\n            // '\\right.' with a 'leftright' type, we can't use this shortcut.\r\n            if (parent.type === 'root' && parent.hasEmptyBranch('body')) {\r\n                parent.latex = s;\r\n            }\r\n        }\r\n        const cursor = model.at(model.position);\r\n        cursor.parent.addChildrenAfter(newAtoms, cursor);\r\n    }\r\n\r\n    // Prepare to dispatch notifications\r\n    // (for selection changes, then content change)\r\n    model.suppressChangeNotifications = contentWasChanging;\r\n\r\n    const lastNewAtom = newAtoms[newAtoms.length - 1];\r\n    // Update the anchor's location\r\n    if (options.selectionMode === 'placeholder') {\r\n        // Move to the next placeholder\r\n        const newPlaceholders = newAtoms.reduce(\r\n            (acc, atom) => [\r\n                ...acc,\r\n                ...atom.children.filter((x) => x.type === 'placeholder'),\r\n            ],\r\n            []\r\n        );\r\n\r\n        if (newPlaceholders.length > 0) {\r\n            const placeholderOffset = model.offsetOf(newPlaceholders[0]);\r\n            model.setSelection(placeholderOffset - 1, placeholderOffset);\r\n            model.announce('move'); // should have placeholder selected\r\n        } else if (lastNewAtom) {\r\n            // No placeholder found, move to right after what we just inserted\r\n            model.position = model.offsetOf(lastNewAtom);\r\n        }\r\n    } else if (options.selectionMode === 'before') {\r\n        // Do nothing: don't change the anchorOffset.\r\n    } else if (options.selectionMode === 'after') {\r\n        if (lastNewAtom) {\r\n            model.position = model.offsetOf(lastNewAtom);\r\n        }\r\n    } else if (options.selectionMode === 'item') {\r\n        model.setSelection(model.anchor, model.offsetOf(lastNewAtom));\r\n    }\r\n\r\n    contentDidChange(model);\r\n\r\n    model.suppressChangeNotifications = suppressChangeNotifications;\r\n\r\n    return true;\r\n}\r\n\r\n/**\r\n * Create, remove or update a composition atom at the current location\r\n */\r\nexport function updateComposition(model: ModelPrivate, s: string): void {\r\n    const cursor = model.at(model.position);\r\n\r\n    // We're creating or updating a composition\r\n    if (cursor.type === 'composition') {\r\n        // Composition already in progress, update it\r\n        cursor.value = s;\r\n    } else {\r\n        // No composition yet, create one\r\n\r\n        // Remove previous caret\r\n        const caret = cursor.caret;\r\n        cursor.caret = '';\r\n\r\n        // Create 'composition' atom, with caret\r\n        const atom = new CompositionAtom(s, { mode: cursor.mode });\r\n        atom.caret = caret;\r\n        cursor.parent.addChildAfter(atom, cursor);\r\n\r\n        //Move cursor one past the composition zone\r\n        model.position += 1;\r\n    }\r\n}\r\n\r\n/**\r\n * Remove the composition zone\r\n */\r\nexport function removeComposition(model: ModelPrivate): void {\r\n    const cursor = model.at(model.position);\r\n    if (cursor.type === 'composition') {\r\n        cursor.parent.removeChild(cursor);\r\n        model.position -= 1;\r\n    }\r\n}\r\n\r\nfunction removeParen(atoms: Atom[]): Atom[] | null {\r\n    if (!atoms) return null;\r\n\r\n    console.assert(atoms[0].type === 'first');\r\n    if (atoms.length > 1) return null;\r\n\r\n    const atom = atoms[0];\r\n    if (\r\n        atom instanceof LeftRightAtom &&\r\n        atom.leftDelim === '(' &&\r\n        atom.rightDelim === ')'\r\n    ) {\r\n        return atom.removeBranch('body');\r\n    }\r\n    return null;\r\n}\r\n\r\n/**\r\n * If it's a fraction with a parenthesized numerator or denominator\r\n * remove the parentheses\r\n * @revisit: don't need model, only need to know if removeExtraneousParentheses\r\n *              Check at callsites.\r\n */\r\nfunction simplifyParen(atoms: Atom[]): void {\r\n    if (!atoms) return;\r\n    for (let i = 0; atoms[i]; i++) {\r\n        const atom = atoms[i];\r\n        if (atom instanceof LeftRightAtom && atom.leftDelim === '(') {\r\n            let genFracCount = 0;\r\n            let genFracIndex = 0;\r\n            let nonGenFracCount = 0;\r\n            for (let j = 0; atom.body[j]; j++) {\r\n                if (atom.body[j].type === 'genfrac') {\r\n                    genFracCount++;\r\n                    genFracIndex = j;\r\n                }\r\n                nonGenFracCount++;\r\n            }\r\n            if (nonGenFracCount === 0 && genFracCount === 1) {\r\n                // This is a single frac inside a leftright: remove the leftright\r\n                atoms[i] = atom.body[genFracIndex];\r\n            }\r\n        }\r\n    }\r\n\r\n    atoms.forEach((atom) => {\r\n        NAMED_BRANCHES.forEach((branch: BranchName) => {\r\n            if (!atom.hasEmptyBranch(branch)) {\r\n                simplifyParen(atom.branch(branch));\r\n                const newChildren = removeParen(atom.branch(branch));\r\n                if (newChildren) atom.setChildren(newChildren, branch);\r\n            }\r\n        });\r\n\r\n        if (atom instanceof ArrayAtom) {\r\n            atom.cells.forEach((x) => simplifyParen(x));\r\n        }\r\n    });\r\n}\r\n\r\n// const MATCHING_FENCE = {\r\n//     '\\\\lbrace': ['\\\\rbrace'],\r\n//     '(': [')', ']', '\\\\rbrack'],\r\n//     // For (open/closed) intervals\r\n//     '\\\\rbrack': [')', ']', '\\\\rbrack', '[', '\\\\lbrack'],\r\n//     '\\\\lbrack': [')', ']', '\\\\rbrack', '[', '\\\\lbrack'],\r\n// };\r\n\r\n/**\r\n * Insert a smart fence '(', '{', '[', etc...\r\n * If not handled (because `fence` wasn't a fence), return false.\r\n */\r\nexport function insertSmartFence(\r\n    model: ModelPrivate,\r\n    fence: string,\r\n    style: Style\r\n): boolean {\r\n    console.assert(model.selectionIsCollapsed);\r\n    const atom = model.at(model.position);\r\n    const parent = atom.parent;\r\n    let delims =\r\n        parent instanceof LeftRightAtom\r\n            ? parent.leftDelim + parent.rightDelim\r\n            : '';\r\n    if (delims === '\\\\lbrace\\\\rbrace') delims = '{}';\r\n    if (delims === '\\\\{\\\\}') delims = '{}';\r\n\r\n    //\r\n    // 1. Are we inserting a middle fence?\r\n    // ...as in {...|...}\r\n    //\r\n    if (delims === '{}' && /\\||\\\\vert|\\\\Vert|\\\\mvert|\\\\mid/.test(fence)) {\r\n        insert(model, '\\\\,\\\\middle' + fence + '\\\\, ', {\r\n            mode: 'math',\r\n            format: 'latex',\r\n            style: style,\r\n        });\r\n        return true;\r\n    }\r\n    // Normalize some fences.\r\n    // Note that '{' and '}' are not valid braces.\r\n    // They should be '\\{' or '\\lbrace' and '\\}' or '\\rbrace'\r\n    if (fence === '{' || fence === '\\\\{') fence = '\\\\lbrace';\r\n    if (fence === '}' || fence === '\\\\}') fence = '\\\\rbrace';\r\n    if (fence === '[') fence = '\\\\lbrack';\r\n    if (fence === ']') fence = '\\\\rbrack';\r\n\r\n    //\r\n    // 2. Is it an open fence?\r\n    //\r\n    const rDelim = RIGHT_DELIM[fence];\r\n    if (\r\n        rDelim &&\r\n        !(parent instanceof LeftRightAtom && parent.leftDelim === '|')\r\n    ) {\r\n        // We have a valid open fence as input\r\n        let s = '';\r\n\r\n        if (atom.isFunction) {\r\n            // We're before a function (e.g. `\\sin`, or 'f'):  this is an\r\n            // argument list.\r\n            // Use `\\mleft...\\mright'.\r\n            s = '\\\\mleft' + fence + '\\\\mright' + rDelim;\r\n        } else {\r\n            s = '\\\\left' + fence + '\\\\right?';\r\n        }\r\n\r\n        const lastSiblingOffset = model.offsetOf(atom.lastSibling);\r\n        const content = model.extractAtoms([model.position, lastSiblingOffset]);\r\n        insert(model, s, { mode: 'math', format: 'latex', style: style });\r\n        // Move everything that was after the anchor into the leftright\r\n        model.at(model.position).body = content;\r\n        model.position -= 1;\r\n        return true;\r\n    }\r\n\r\n    //\r\n    // 3. Is it a close fence?\r\n    //\r\n    let lDelim: string;\r\n    Object.keys(RIGHT_DELIM).forEach((delim) => {\r\n        if (fence === RIGHT_DELIM[delim]) lDelim = delim;\r\n    });\r\n    if (lDelim) {\r\n        // We found a matching open fence, so it was a valid close fence.\r\n        // Note that `lDelim` may not match `fence`. That's OK.\r\n\r\n        // If we're the last atom inside a 'leftright',\r\n        // update the parent\r\n        if (parent instanceof LeftRightAtom && atom.isLastSibling) {\r\n            parent.rightDelim = fence;\r\n            model.position += 1;\r\n            contentDidChange(model);\r\n            return true;\r\n        }\r\n        // If we have a `leftright` sibling to our left\r\n        // with an indeterminate right fence,\r\n        // move what's between us and the `leftright` inside the `leftright`\r\n        const firstSibling = model.offsetOf(atom.firstSibling);\r\n        let i: number;\r\n        for (i = model.position; i >= firstSibling; i--) {\r\n            const atom = model.at(i);\r\n            if (atom instanceof LeftRightAtom && atom.rightDelim === '?') {\r\n                break;\r\n            }\r\n        }\r\n        const match = model.at(i);\r\n        if (i >= firstSibling && match instanceof LeftRightAtom) {\r\n            match.rightDelim = fence;\r\n            match.addChildren(\r\n                model.extractAtoms([i, model.position]),\r\n                atom.treeBranch\r\n            );\r\n            contentDidChange(model);\r\n            return true;\r\n        }\r\n\r\n        // If we're inside a `leftright`, but not the last atom,\r\n        // and the `leftright` right delim is indeterminate\r\n        // adjust the body (put everything after the insertion point outside)\r\n        if (parent instanceof LeftRightAtom && parent.rightDelim === '?') {\r\n            parent.rightDelim = fence;\r\n\r\n            parent.parent.addChildren(\r\n                model.extractAtoms([\r\n                    model.position,\r\n                    model.offsetOf(atom.lastSibling),\r\n                ]),\r\n                parent.treeBranch\r\n            );\r\n            model.position = model.offsetOf(parent);\r\n            contentDidChange(model);\r\n\r\n            return true;\r\n        }\r\n\r\n        // Is our grand-parent a 'leftright'?\r\n        // If `\\left(\\frac{1}{x|}\\right?` with the cursor at `|`\r\n        // go up to the 'leftright' and apply it there instead\r\n        const grandparent = parent.parent;\r\n        if (\r\n            grandparent instanceof LeftRightAtom &&\r\n            grandparent.rightDelim === '?' &&\r\n            model.at(model.position).isLastSibling\r\n        ) {\r\n            move(model, 'forward');\r\n            return insertSmartFence(model, fence, style);\r\n        }\r\n\r\n        // Meh... We couldn't find a matching open fence. Just insert the\r\n        // closing fence as a regular character\r\n        return false;\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\n/**\r\n * Locate the offset before the insertion point that would indicate\r\n * a good place to select as an implicit argument.\r\n *\r\n * For example with '1+\\sin(x)', if the insertion point is at the\r\n * end, the implicit arg offset would be after the plus. As a result,\r\n * inserting a fraction after the sin would yield: '1+\\frac{\\sin(c)}{\\placeholder{}}'\r\n */\r\nfunction getImplicitArgOffset(model: ModelPrivate): Offset {\r\n    let atom = model.at(model.position);\r\n    if (atom.mode === 'text') {\r\n        while (!atom.isFirstSibling && atom.mode === 'text') {\r\n            atom = atom.leftSibling;\r\n        }\r\n        return model.offsetOf(atom);\r\n    }\r\n    if (!isImplicitArg(atom)) {\r\n        return -1;\r\n    }\r\n    // Find the first 'mrel', etc... to the left of the insertion point\r\n    // until the first sibling\r\n    while (!atom.isFirstSibling && isImplicitArg(atom)) {\r\n        atom = atom.leftSibling;\r\n    }\r\n\r\n    return model.offsetOf(atom);\r\n}\r\n\r\n/**\r\n *\r\n * Predicate returns true if the atom should be considered an implicit argument.\r\n *\r\n * Used for example when typing \"/\" to insert a fraction: all the atoms to\r\n * the left of insertion point that return true for `isImplicitArg()` will\r\n * be included as the numerator\r\n */\r\nfunction isImplicitArg(atom: Atom): boolean {\r\n    if (/^(mord|surd|msubsup|leftright|mop)$/.test(atom.type)) {\r\n        // Exclude `\\int`, \\`sum`, etc...\r\n        if (atom.isExtensibleSymbol) return false;\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n","import { register } from '../editor/commands';\r\nimport type { ModelPrivate } from './model-private';\r\nimport {\r\n    move,\r\n    leap,\r\n    skip,\r\n    selectGroup,\r\n    moveAfterParent,\r\n    wordBoundaryOffset,\r\n} from './selection';\r\nimport { deleteForward, deleteBackward, deleteRange } from './delete';\r\nimport { Atom, BranchName } from '../core/atom';\r\nimport { SubsupAtom } from '../core-atoms/subsup';\r\n\r\n/**\r\n * Switch the cursor to the superscript and select it. If there is no subscript\r\n * yet, create one.\r\n */\r\nexport function moveToSuperscript(model: ModelPrivate): boolean {\r\n    model.collapseSelection();\r\n    if (superscriptDepth(model) >= model.mathfield.options.scriptDepth[1]) {\r\n        model.announce('plonk');\r\n        return false;\r\n    }\r\n    let target = model.at(model.position);\r\n\r\n    if (target.limits !== 'limits' && target.limits !== 'auto') {\r\n        // This atom can't have a superscript/subscript:\r\n        // add an adjacent `msubsup` atom instead.\r\n        if (model.at(model.position + 1)?.type !== 'msubsup') {\r\n            target.parent.addChildAfter(\r\n                new SubsupAtom({\r\n                    baseType: target.type,\r\n                    style: model.at(model.position).computedStyle,\r\n                }),\r\n                target\r\n            );\r\n        }\r\n        target = model.at(model.position + 1);\r\n    }\r\n    // Ensure there is a superscript branch\r\n    target.createBranch('superscript');\r\n    model.setSelection(\r\n        model.getSiblingsRange(model.offsetOf(target.superscript[0]))\r\n    );\r\n\r\n    return true;\r\n}\r\n\r\n/**\r\n * Switch the cursor to the subscript and select it. If there is no subscript\r\n * yet, create one.\r\n */\r\nexport function moveToSubscript(model: ModelPrivate): boolean {\r\n    model.collapseSelection();\r\n    if (subscriptDepth(model) >= model.mathfield.options.scriptDepth[0]) {\r\n        model.announce('plonk');\r\n        return false;\r\n    }\r\n    let target = model.at(model.position);\r\n\r\n    if (target.limits !== 'limits' && target.limits !== 'auto') {\r\n        // This atom can't have a superscript/subscript:\r\n        // add an adjacent `msubsup` atom instead.\r\n        if (model.at(model.position + 1)?.type !== 'msubsup') {\r\n            target.parent.addChildAfter(\r\n                new Atom('msubsup', {\r\n                    mode: target.mode,\r\n                    value: '\\u200b',\r\n                    style: model.at(model.position).computedStyle,\r\n                }),\r\n                target\r\n            );\r\n        }\r\n        target = model.at(model.position + 1);\r\n    }\r\n    // Ensure there is a subscript branch\r\n    target.createBranch('subscript');\r\n    model.setSelection(\r\n        model.getSiblingsRange(model.offsetOf(target.subscript[0]))\r\n    );\r\n    return true;\r\n}\r\n\r\n/**\r\n * If cursor is currently in:\r\n * - superscript: move to subscript, creating it if necessary\r\n * - subscript: move to superscript, creating it if necessary\r\n * - numerator: move to denominator\r\n * - denominator: move to numerator\r\n * - otherwise: move to superscript\r\n */\r\nregister(\r\n    {\r\n        moveToOpposite: (model: ModelPrivate): boolean => {\r\n            const OPPOSITE_RELATIONS = {\r\n                superscript: 'subscript',\r\n                subscript: 'superscript',\r\n                above: 'below',\r\n                below: 'above',\r\n            };\r\n            const cursor = model.at(model.position);\r\n            const parent = cursor.parent;\r\n            if (!parent) return false;\r\n            const relation = cursor.treeBranch;\r\n            let oppositeRelation: BranchName;\r\n            if (typeof relation === 'string') {\r\n                oppositeRelation = OPPOSITE_RELATIONS[relation];\r\n            }\r\n            if (!oppositeRelation) {\r\n                if (!cursor.limits) {\r\n                    return moveToSuperscript(model);\r\n                }\r\n                return moveToSubscript(model);\r\n            }\r\n\r\n            if (!parent.branch(oppositeRelation)) {\r\n                // Don't have children of the opposite relation yet\r\n                // Add them\r\n                parent.createBranch(oppositeRelation);\r\n            }\r\n\r\n            return model.setSelection(\r\n                model.getBranchRange(model.offsetOf(parent), oppositeRelation)\r\n            );\r\n        },\r\n        moveBeforeParent: (model: ModelPrivate): boolean => {\r\n            const parent = model.at(model.position).parent;\r\n            if (!parent) {\r\n                model.announce('plonk');\r\n                return false;\r\n            }\r\n            model.position = model.offsetOf(parent);\r\n            return true;\r\n        },\r\n        moveAfterParent: (model: ModelPrivate): boolean =>\r\n            moveAfterParent(model),\r\n\r\n        moveToNextPlaceholder: (model: ModelPrivate): boolean =>\r\n            leap(model, 'forward'),\r\n        moveToPreviousPlaceholder: (model: ModelPrivate): boolean =>\r\n            leap(model, 'backward'),\r\n        moveToNextChar: (model: ModelPrivate): boolean =>\r\n            move(model, 'forward'),\r\n        moveToPreviousChar: (model: ModelPrivate): boolean =>\r\n            move(model, 'backward'),\r\n        moveUp: (model: ModelPrivate): boolean => move(model, 'upward'),\r\n        moveDown: (model: ModelPrivate): boolean => move(model, 'downward'),\r\n        moveToNextWord: (model: ModelPrivate): boolean =>\r\n            skip(model, 'forward'),\r\n        moveToPreviousWord: (model: ModelPrivate): boolean =>\r\n            skip(model, 'backward'),\r\n        moveToGroupStart: (model: ModelPrivate): boolean => {\r\n            model.position = model.offsetOf(\r\n                model.at(model.position).firstSibling\r\n            );\r\n            return true;\r\n        },\r\n        moveToGroupEnd: (model: ModelPrivate): boolean => {\r\n            model.position = model.offsetOf(\r\n                model.at(model.position).lastSibling\r\n            );\r\n            return true;\r\n        },\r\n        moveToMathFieldStart: (model: ModelPrivate): boolean => {\r\n            model.position = 0;\r\n            return true;\r\n        },\r\n        moveToMathFieldEnd: (model: ModelPrivate): boolean => {\r\n            model.position = model.lastOffset;\r\n            return true;\r\n        },\r\n        moveToSuperscript: (model: ModelPrivate): boolean =>\r\n            moveToSuperscript(model),\r\n        moveToSubscript: (model: ModelPrivate): boolean =>\r\n            moveToSubscript(model),\r\n    },\r\n    { target: 'model', category: 'selection-anchor' }\r\n);\r\n\r\nregister(\r\n    {\r\n        selectGroup: (model: ModelPrivate): boolean => selectGroup(model),\r\n\r\n        selectAll: (model: ModelPrivate): boolean =>\r\n            model.setSelection(0, model.lastOffset),\r\n        extendSelectionForward: (model: ModelPrivate): boolean =>\r\n            model.extendSelection('forward'),\r\n        extendSelectionBackward: (model: ModelPrivate): boolean =>\r\n            model.extendSelection('backward'),\r\n        extendToNextWord: (model: ModelPrivate): boolean =>\r\n            skip(model, 'forward', { extend: true }),\r\n        extendToPreviousWord: (model: ModelPrivate): boolean =>\r\n            skip(model, 'backward', { extend: true }),\r\n        extendSelectionUpward: (model: ModelPrivate): boolean =>\r\n            move(model, 'upward', { extend: true }),\r\n        extendSelectionDownward: (model: ModelPrivate): boolean =>\r\n            move(model, 'downward', { extend: true }),\r\n        /**\r\n         * Extend the selection until the next boundary is reached. A boundary\r\n         * is defined by an atom of a different type (mbin, mord, etc...)\r\n         * than the current focus. For example, in \"1234+x=y\", if the focus is between\r\n         * \"1\" and \"2\", invoking `extendToNextBoundary_` would extend the selection\r\n         * to \"234\".\r\n         */\r\n        extendToNextBoundary: (model: ModelPrivate): boolean =>\r\n            skip(model, 'forward', { extend: true }),\r\n        /**\r\n         * Extend the selection until the previous boundary is reached. A boundary\r\n         * is defined by an atom of a different type (mbin, mord, etc...)\r\n         * than the current focus. For example, in \"1+23456\", if the focus is between\r\n         * \"5\" and \"6\", invoking `extendToPreviousBoundary` would extend the selection\r\n         * to \"2345\".\r\n         */\r\n        extendToPreviousBoundary: (model: ModelPrivate): boolean =>\r\n            skip(model, 'backward', { extend: true }),\r\n        extendToGroupStart: (model: ModelPrivate): boolean =>\r\n            model.setSelection(\r\n                model.anchor,\r\n                model.offsetOf(model.at(model.position).firstSibling)\r\n            ),\r\n        extendToGroupEnd: (model: ModelPrivate): boolean =>\r\n            model.setSelection(\r\n                model.anchor,\r\n                model.offsetOf(model.at(model.position).lastSibling)\r\n            ),\r\n        extendToMathFieldStart: (model: ModelPrivate): boolean =>\r\n            model.setSelection(model.anchor, 0),\r\n        extendToMathFieldEnd: (model: ModelPrivate): boolean =>\r\n            model.setSelection(model.anchor, model.lastOffset),\r\n    },\r\n    { target: 'model', category: 'selection-extend' }\r\n);\r\n\r\nfunction superscriptDepth(model: ModelPrivate): number {\r\n    let result = 0;\r\n    let atom = model.at(model.position);\r\n    let wasSuperscript = false;\r\n    while (atom) {\r\n        if (\r\n            !atom.hasEmptyBranch('superscript') ||\r\n            !atom.hasEmptyBranch('subscript')\r\n        ) {\r\n            result += 1;\r\n        }\r\n        if (!atom.hasEmptyBranch('superscript')) {\r\n            wasSuperscript = true;\r\n        } else if (!atom.hasEmptyBranch('subscript')) {\r\n            wasSuperscript = false;\r\n        }\r\n        atom = atom.parent;\r\n    }\r\n    return wasSuperscript ? result : 0;\r\n}\r\nfunction subscriptDepth(model: ModelPrivate): number {\r\n    let result = 0;\r\n    let atom = model.at(model.position);\r\n    let wasSubscript = false;\r\n    while (atom) {\r\n        if (\r\n            !atom.hasEmptyBranch('superscript') ||\r\n            !atom.hasEmptyBranch('subscript')\r\n        ) {\r\n            result += 1;\r\n        }\r\n        if (!atom.hasEmptyBranch('superscript')) {\r\n            wasSubscript = false;\r\n        } else if (!atom.hasEmptyBranch('subscript')) {\r\n            wasSubscript = true;\r\n        }\r\n        atom = atom.parent;\r\n    }\r\n    return wasSubscript ? result : 0;\r\n}\r\n\r\nregister(\r\n    {\r\n        deleteAll: (model: ModelPrivate): boolean => {\r\n            return deleteRange(model, [0, -1]);\r\n        },\r\n        deleteForward: (model: ModelPrivate): boolean => deleteForward(model),\r\n        deleteBackward: (model: ModelPrivate): boolean => deleteBackward(model),\r\n        deleteNextWord: (model: ModelPrivate): boolean =>\r\n            deleteRange(model, [\r\n                model.anchor,\r\n                wordBoundaryOffset(model, model.position, 'forward'),\r\n            ]),\r\n        deletePreviousWord: (model: ModelPrivate): boolean =>\r\n            deleteRange(model, [\r\n                model.anchor,\r\n                wordBoundaryOffset(model, model.position, 'backward'),\r\n            ]),\r\n        deleteToGroupStart: (model: ModelPrivate): boolean =>\r\n            deleteRange(model, [\r\n                model.anchor,\r\n                model.offsetOf(model.at(model.position).firstSibling),\r\n            ]),\r\n        deleteToGroupEnd: (model: ModelPrivate): boolean =>\r\n            deleteRange(model, [\r\n                model.anchor,\r\n                model.offsetOf(model.at(model.position).lastSibling),\r\n            ]),\r\n        deleteToMathFieldStart: (model: ModelPrivate): boolean =>\r\n            deleteRange(model, [model.anchor, 0]),\r\n        deleteToMathFieldEnd: (model: ModelPrivate): boolean =>\r\n            deleteRange(model, [model.anchor, -1]),\r\n    },\r\n    { target: 'model', category: 'delete' }\r\n);\r\n","/**\r\n * This modules handles low-level keyboard events and normalize them across\r\n * browsers.\r\n *\r\n * See https://dvcs.w3.org/hg/d4e/raw-file/tip/key-event-test.html\r\n * (also at https://w3c.github.io/uievents/tools/key-event-viewer.html)\r\n *\r\n *\r\n * - **KeyboardEvent.key** (the printable value associated with the key or a string\r\n * for special keys)\r\n *  https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values\r\n *  https://www.w3.org/TR/uievents-key/\r\n *\r\n * - **KeyboardEvent.code** (the physical key being pressed. On an AZERTY keyboard\r\n * the key labelled \"A\" is KeyQ)\r\n *  https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/code/code_values\r\n *  https://www.w3.org/TR/uievents-code/\r\n *\r\n * Note:\r\n * - `charCode`, `keyCode` and `which` are deprecated\r\n *\r\n * For background, see this info regarding keybinding in VSCode:\r\n * - https://github.com/microsoft/vscode/tree/master/src/vs/workbench/services/keybinding\r\n * - https://github.com/microsoft/vscode/wiki/Keybinding-Issues\r\n */\r\n\r\nimport { normalizeKeyboardEvent } from './keyboard-layout';\r\n\r\nconst PRINTABLE_KEYCODE = [\r\n    'Backquote', // Japanese keyboard: hankaku/zenkaku/kanji key, which is non-printable\r\n    'Digit0',\r\n    'Digit1',\r\n    'Digit2',\r\n    'Digit3',\r\n    'Digit4',\r\n    'Digit5',\r\n    'Digit6',\r\n    'Digit7',\r\n    'Digit8',\r\n    'Digit9',\r\n    'Minus',\r\n    'Equal',\r\n    'IntlYen', // Japanese Keyboard. Russian keyboard: \\/\r\n\r\n    'KeyQ', // AZERTY keyboard: labeled 'a'\r\n    'KeyW', // AZERTY keyboard: labeled 'z'\r\n    'KeyE',\r\n    'KeyR',\r\n    'KeyT',\r\n    'KeyY', // QWERTZ keyboard: labeled 'z'\r\n    'KeyU',\r\n    'KeyI',\r\n    'KeyO',\r\n    'KeyP',\r\n    'BracketLeft',\r\n    'BracketRight',\r\n    'Backslash', // May be labeled #~ on UK 102 keyboard\r\n    'KeyA', // AZERTY keyboard: labeled 'q'\r\n    'KeyS',\r\n    'KeyD',\r\n    'KeyF',\r\n    'KeyG',\r\n    'KeyH',\r\n    'KeyJ',\r\n    'KeyK',\r\n    'KeyL',\r\n    'Semicolon',\r\n    'Quote',\r\n    'IntlBackslash', // QWERTZ keyboard '><'\r\n    'KeyZ', // AZERTY: 'w', QWERTZ: 'y'\r\n    'KeyX',\r\n    'KeyC',\r\n    'KeyV',\r\n    'KeyB',\r\n    'KeyN',\r\n    'KeyM',\r\n    'Comma',\r\n    'Period',\r\n    'Slash',\r\n    'IntlRo', // Japanse keyboard '\\'\r\n\r\n    'Space',\r\n\r\n    'Numpad0',\r\n    'Numpad1',\r\n    'Numpad2',\r\n    'Numpad3',\r\n    'Numpad4',\r\n    'Numpad5',\r\n    'Numpad6',\r\n    'Numpad7',\r\n    'Numpad8',\r\n    'Numpad9',\r\n    'NumpadAdd',\r\n    'NumpadComma',\r\n    'NumpadDecimal',\r\n    'NumpadDivide',\r\n    'NumpadEqual',\r\n    'NumpadHash',\r\n    'NumpadMultiply',\r\n    'NumpadParenLeft',\r\n    'NumpadParenRight',\r\n    'NumpadStar',\r\n    'NumpadSubstract',\r\n];\r\n\r\nexport function mightProducePrintableCharacter(evt: KeyboardEvent): boolean {\r\n    if (evt.ctrlKey || evt.metaKey) {\r\n        // ignore ctrl/cmd-combination but not shift/alt-combinations\r\n        return false;\r\n    }\r\n\r\n    // https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values\r\n    if (evt.key === 'Dead') return false;\r\n\r\n    // When issued via a composition, the `code` field is empty\r\n    if (evt.code === '') return true;\r\n\r\n    return PRINTABLE_KEYCODE.indexOf(evt.code) >= 0;\r\n}\r\n\r\n/**\r\n * Create a normalized representation of a keyboard event,\r\n * i.e., key code and modifier keys. For example:\r\n * - `ctrl+Shift+alt+[KeyF]`\r\n *\r\n * Note: the key code corresponds to a physical key, e.g. 'KeyQ' is\r\n * the key labeled 'A' on a French keyboard\r\n *\r\n */\r\nfunction keyboardEventToString(evt: KeyboardEvent): string {\r\n    evt = normalizeKeyboardEvent(evt);\r\n\r\n    const modifiers = [];\r\n\r\n    if (evt.ctrlKey) modifiers.push('ctrl');\r\n    if (evt.metaKey) modifiers.push('meta');\r\n    if (evt.altKey) modifiers.push('alt');\r\n    if (evt.shiftKey) modifiers.push('shift');\r\n\r\n    // If no modifiers, simply return the key name\r\n    if (modifiers.length === 0) return '[' + evt.code + ']';\r\n\r\n    modifiers.push('[' + evt.code + ']');\r\n\r\n    return modifiers.join('+');\r\n}\r\n\r\nexport interface KeyboardDelegate {\r\n    cancelComposition: () => void;\r\n    blur: () => void;\r\n    focus: () => void;\r\n    hasFocus: () => boolean;\r\n    setValue: (value: string) => void;\r\n    setAriaLabel: (value: string) => void;\r\n    moveTo: (x: number, y: number) => void;\r\n}\r\n\r\n/**\r\n * Setup to capture the keyboard events from a `TextArea` and redispatch them to\r\n * handlers.\r\n *\r\n * In general, commands (arrows, delete, etc..) should be handled\r\n * in the `keystroke()` handler while text input should be handled in\r\n * `typedtext()`.\r\n *\r\n * @param {HTMLElement} textarea A `TextArea` element that will capture the keyboard\r\n * events. While this element will usually be a `TextArea`, it could be any\r\n * element that is focusable and can receive keyboard events.\r\n * @param {Object.<string, any>} handlers\r\n * @param {function} handlers.keystroke invoked on a key down event, including\r\n * for special keys such as ESC, arrow keys, tab, etc... and their variants\r\n * with modifiers.\r\n * @param {function} handlers.typedtext invoked on a keypress or other events\r\n * when a key corresponding to a character has been pressed. This include `a-z`,\r\n * `0-9`, `{}`, `^_()`, etc...\r\n * This does not include arrow keys, tab, etc... but does include 'space'\r\n * When a 'character' key is pressed, both `keystroke()` and `typedtext()` will\r\n * be invoked. When a control/function key is pressed, only `keystroke()` will\r\n * be invoked. In some cases, for example when using input methods or entering\r\n * emoji, only `typedtext()` will be invoked.\r\n */\r\nexport function delegateKeyboardEvents(\r\n    textarea: HTMLTextAreaElement,\r\n    handlers: {\r\n        typedText: (text: string) => void;\r\n        cut: () => void;\r\n        copy: (ev: ClipboardEvent) => void;\r\n        paste: (ev: ClipboardEvent) => void;\r\n        keystroke: (keystroke: string, ev: KeyboardEvent) => boolean;\r\n        focus: () => void;\r\n        blur: () => void;\r\n        compositionStart: (composition: string) => void;\r\n        compositionUpdate: (composition: string) => void;\r\n        compositionEnd: (composition: string) => void;\r\n    }\r\n): KeyboardDelegate {\r\n    let keydownEvent = null;\r\n    let keypressEvent = null;\r\n    let compositionInProgress = false;\r\n    let focusInProgress = false;\r\n    let blurInProgress = false;\r\n\r\n    // This callback is invoked after a keyboard event has been processed\r\n    // by the textarea\r\n    let callbackTimeoutID: number;\r\n    function defer(cb: () => void): void {\r\n        clearTimeout(callbackTimeoutID);\r\n        callbackTimeoutID = setTimeout(() => {\r\n            clearTimeout(callbackTimeoutID);\r\n            cb();\r\n        });\r\n    }\r\n\r\n    function handleTypedText(): void {\r\n        // Some browsers (Firefox, Opera) fire a keypress event for commands\r\n        // such as cmd+C where there might be a non-empty selection.\r\n        // We need to ignore these.\r\n        if (textarea.selectionStart !== textarea.selectionEnd) return;\r\n\r\n        const text = textarea.value;\r\n        textarea.value = '';\r\n        if (text.length > 0) handlers.typedText(text);\r\n    }\r\n\r\n    const target = textarea;\r\n\r\n    target.addEventListener(\r\n        'keydown',\r\n        (e: KeyboardEvent): void => {\r\n            // \"Process\" key indicates commit of IME session (on Firefox)\r\n            // It's handled with compositionEnd so it can be safely ignored\r\n            if (\r\n                compositionInProgress ||\r\n                e.key === 'Process' ||\r\n                e.code === 'CapsLock' ||\r\n                /(Control|Meta|Alt|Shift)(Left|Right)/.test(e.code)\r\n            ) {\r\n                keydownEvent = null;\r\n                return;\r\n            }\r\n\r\n            keydownEvent = e;\r\n            keypressEvent = null;\r\n            if (!handlers.keystroke(keyboardEventToString(e), e)) {\r\n                keydownEvent = null;\r\n                textarea.value = '';\r\n            }\r\n        },\r\n        true\r\n    );\r\n    target.addEventListener(\r\n        'keypress',\r\n        (e) => {\r\n            if (compositionInProgress) return;\r\n            // If this is not the first keypress after a keydown, that is,\r\n            // if this is a repeated keystroke, call the keystroke handler.\r\n            if (!compositionInProgress) {\r\n                if (keydownEvent && keypressEvent) {\r\n                    handlers.keystroke(\r\n                        keyboardEventToString(keydownEvent),\r\n                        keydownEvent\r\n                    );\r\n                }\r\n\r\n                keypressEvent = e;\r\n                defer(handleTypedText);\r\n            }\r\n        },\r\n        true\r\n    );\r\n    target.addEventListener(\r\n        'keyup',\r\n        () => {\r\n            if (compositionInProgress) return;\r\n            // If we've received a keydown, but no keypress, check what's in the\r\n            // textarea field.\r\n            if (keydownEvent && !keypressEvent) {\r\n                handleTypedText();\r\n            }\r\n        },\r\n        true\r\n    );\r\n    target.addEventListener(\r\n        'paste',\r\n        (ev: ClipboardEvent) => {\r\n            // In some cases (Linux browsers), the text area might not be focused\r\n            // when doing a middle-click paste command.\r\n            textarea.focus();\r\n            textarea.value = '';\r\n            handlers.paste(ev);\r\n        },\r\n        true\r\n    );\r\n    target.addEventListener(\r\n        'cut',\r\n        () => {\r\n            handlers.cut();\r\n        },\r\n        true\r\n    );\r\n    target.addEventListener(\r\n        'copy',\r\n        (ev) => {\r\n            handlers.copy(ev);\r\n        },\r\n        true\r\n    );\r\n    target.addEventListener(\r\n        'blur',\r\n        (ev) => {\r\n            // If the relatedTarget (the element that is gaining the focus)\r\n            // is contained in our shadow host, ignore the blur event\r\n            if (\r\n                ev.relatedTarget ===\r\n                (((ev.target as HTMLElement).getRootNode() as any) as ShadowRoot)\r\n                    .host\r\n            ) {\r\n                ev.preventDefault();\r\n                ev.stopPropagation();\r\n                return;\r\n            }\r\n            if (blurInProgress || focusInProgress) return;\r\n\r\n            blurInProgress = true;\r\n            keydownEvent = null;\r\n            keypressEvent = null;\r\n            if (handlers.blur) handlers.blur();\r\n            blurInProgress = false;\r\n        },\r\n        true\r\n    );\r\n    target.addEventListener(\r\n        'focus',\r\n        (_ev) => {\r\n            if (blurInProgress || focusInProgress) return;\r\n\r\n            focusInProgress = true;\r\n            if (handlers.focus) handlers.focus();\r\n            focusInProgress = false;\r\n        },\r\n        true\r\n    );\r\n    target.addEventListener(\r\n        'compositionstart',\r\n        (ev: CompositionEvent) => {\r\n            compositionInProgress = true;\r\n            textarea.value = '';\r\n\r\n            if (handlers.compositionStart) handlers.compositionStart(ev.data);\r\n        },\r\n        true\r\n    );\r\n    target.addEventListener(\r\n        'compositionupdate',\r\n        (ev: CompositionEvent) => {\r\n            if (!compositionInProgress) return;\r\n            if (handlers.compositionUpdate) handlers.compositionUpdate(ev.data);\r\n        },\r\n        true\r\n    );\r\n    target.addEventListener(\r\n        'compositionend',\r\n        (ev: CompositionEvent) => {\r\n            textarea.value = '';\r\n            if (!compositionInProgress) return;\r\n            compositionInProgress = false;\r\n            if (handlers.compositionEnd) handlers.compositionEnd(ev.data);\r\n        },\r\n        true\r\n    );\r\n\r\n    // The `input` handler gets called when the field is changed,\r\n    // but no other relevant events have been triggered\r\n    // for example with emoji input...\r\n    target.addEventListener('input', (ev: InputEvent) => {\r\n        if (compositionInProgress) return;\r\n        // If this was an `input` event sent as a result of a commit of\r\n        // IME, ignore it.\r\n        // (This is what FireFox does, even though the spec says it shouldn't happen)\r\n        // See https://github.com/w3c/uievents/issues/202\r\n        if (ev.inputType === 'insertCompositionText') return;\r\n\r\n        // Paste is handled in paste handler\r\n        if (ev.inputType === 'insertFromPaste') {\r\n            ev.preventDefault();\r\n            ev.stopPropagation();\r\n            return;\r\n        }\r\n\r\n        defer(handleTypedText);\r\n    });\r\n\r\n    return {\r\n        cancelComposition: (): void => {\r\n            const savedBlur = handlers.blur;\r\n            const savedFocus = handlers.focus;\r\n            handlers.blur = null;\r\n            handlers.focus = null;\r\n            textarea.blur();\r\n            textarea.focus();\r\n            handlers.blur = savedBlur;\r\n            handlers.focus = savedFocus;\r\n        },\r\n        blur: (): void => {\r\n            if (typeof textarea.blur === 'function') {\r\n                textarea.blur();\r\n            }\r\n        },\r\n        focus: (): void => {\r\n            if (typeof textarea.focus === 'function') {\r\n                textarea.focus();\r\n            }\r\n        },\r\n        hasFocus: (): boolean => {\r\n            return deepActiveElement() === textarea;\r\n        },\r\n        setValue: (value: string): void => {\r\n            if (value) {\r\n                textarea.value = value;\r\n                // The textarea may be a span (on mobile, for example), so check that\r\n                // it has a select() before calling it.\r\n                if (deepActiveElement() === textarea && textarea.select) {\r\n                    textarea.select();\r\n                }\r\n            } else {\r\n                textarea.value = '';\r\n                textarea.setAttribute('aria-label', '');\r\n            }\r\n        },\r\n        setAriaLabel: (value: string): void => {\r\n            textarea.setAttribute('aria-label', 'after: ' + value);\r\n        },\r\n        moveTo: (x: number, y: number): void => {\r\n            textarea.style.top = y + 'px';\r\n            textarea.style.left = x + 'px';\r\n        },\r\n    };\r\n}\r\n\r\nfunction deepActiveElement(): Element | null {\r\n    let a = document.activeElement;\r\n    while (a && a.shadowRoot && a.shadowRoot.activeElement) {\r\n        a = a.shadowRoot.activeElement;\r\n    }\r\n    return a;\r\n}\r\n\r\nexport function eventToChar(evt: KeyboardEvent): string {\r\n    if (!evt) return '';\r\n    let result: string;\r\n    if (evt.key === 'Unidentified') {\r\n        // On Android, the evt.key seems to always be 'Unidentified'.\r\n        // Get the value entered in the event target\r\n        if (evt.target) {\r\n            result = evt.target['value'];\r\n        }\r\n    }\r\n    result = result ?? evt.key ?? evt.code;\r\n    if (\r\n        /^(Dead|Return|Enter|Tab|Escape|Delete|PageUp|PageDown|Home|End|Help|ArrowLeft|ArrowRight|ArrowUp|ArrowDown)$/.test(\r\n            result\r\n        )\r\n    ) {\r\n        result = '';\r\n    }\r\n    return result;\r\n}\r\n","import type { Selection } from '../public/mathfield';\r\nimport { UndoStateChangeListener } from '../public/options';\r\nimport type { ModelPrivate } from '../editor-model/model-private';\r\nimport { insert } from '../editor-model/insert';\r\nimport { Atom } from '../core/atom-class';\r\n\r\nexport type UndoRecord = {\r\n    latex: string;\r\n    selection: Selection;\r\n};\r\n\r\ninterface UndoOptions {\r\n    onUndoStateWillChange?: UndoStateChangeListener;\r\n    onUndoStateDidChange?: UndoStateChangeListener;\r\n    suppressChangeNotifications?: boolean;\r\n}\r\n\r\nexport class UndoManager {\r\n    private model: ModelPrivate;\r\n    private maximumDepth = 1000; // Maximum number of undo/redo states\r\n    private record = false;\r\n    private canCoalesce = false;\r\n    private stack: UndoRecord[]; // Stack of undo/redo states\r\n    private index: number; // Index pointing to the undo/redo stack\r\n\r\n    constructor(model: ModelPrivate) {\r\n        this.model = model;\r\n        this.reset();\r\n    }\r\n\r\n    reset(): void {\r\n        this.stack = [];\r\n        this.index = -1;\r\n    }\r\n\r\n    startRecording(): void {\r\n        this.record = true;\r\n    }\r\n\r\n    canUndo(): boolean {\r\n        return this.index > 0;\r\n    }\r\n\r\n    canRedo(): boolean {\r\n        return this.index !== this.stack.length - 1;\r\n    }\r\n\r\n    undo(options: UndoOptions): void {\r\n        if (this.canUndo()) {\r\n            if (typeof options?.onUndoStateWillChange === 'function') {\r\n                options.onUndoStateWillChange(this.model.mathfield, 'undo');\r\n            }\r\n            this.restore(this.stack[this.index - 1], options);\r\n            this.index -= 1;\r\n            if (options && typeof options.onUndoStateDidChange === 'function') {\r\n                options.onUndoStateDidChange(this.model.mathfield, 'undo');\r\n            }\r\n            this.canCoalesce = false;\r\n        }\r\n    }\r\n    redo(options: UndoOptions): void {\r\n        if (this.canRedo()) {\r\n            if (typeof options?.onUndoStateWillChange === 'function') {\r\n                options.onUndoStateWillChange(this.model.mathfield, 'redo');\r\n            }\r\n            this.index += 1;\r\n            this.restore(this.stack[this.index], options);\r\n            if (options && typeof options.onUndoStateDidChange === 'function') {\r\n                options.onUndoStateDidChange(this.model.mathfield, 'redo');\r\n            }\r\n            this.canCoalesce = false;\r\n        }\r\n    }\r\n    pop(): void {\r\n        if (this.canUndo()) {\r\n            this.index -= 1;\r\n            this.stack.pop();\r\n        }\r\n    }\r\n    /**\r\n     * Push a snapshot of the content and selection of the mathfield onto the\r\n     * undo stack so that it can potentially be reverted to later.\r\n     */\r\n    snapshot(options: UndoOptions): void {\r\n        if (!this.record) return;\r\n\r\n        if (typeof options?.onUndoStateWillChange === 'function') {\r\n            options.onUndoStateWillChange(this.model.mathfield, 'snapshot');\r\n        }\r\n        // Drop any entries that are part of the redo stack\r\n        this.stack.splice(this.index + 1, this.stack.length - this.index - 1);\r\n        // Add a new entry\r\n        this.stack.push({\r\n            latex: Atom.toLatex(this.model.root, { expandMacro: false }),\r\n            selection: this.model.selection,\r\n        });\r\n\r\n        this.index++;\r\n        // If we've reached the maximum number of undo operations, forget the\r\n        // oldest one.\r\n        if (this.stack.length > this.maximumDepth) {\r\n            this.stack.shift();\r\n        }\r\n        if (options && typeof options.onUndoStateDidChange === 'function') {\r\n            options.onUndoStateDidChange(this.model.mathfield, 'snapshot');\r\n        }\r\n        this.canCoalesce = false;\r\n    }\r\n\r\n    snapshotAndCoalesce(options: UndoOptions): void {\r\n        if (this.canCoalesce) {\r\n            this.pop();\r\n        }\r\n        this.snapshot(options);\r\n        this.canCoalesce = true;\r\n    }\r\n\r\n    /**\r\n     * Return an object capturing the state of the content and selection of the\r\n     * mathfield. Pass this object to restore() to reset the value of the math\r\n     * field to this saved value. This does not affect the undo stack.\r\n     */\r\n    save(): UndoRecord {\r\n        return {\r\n            latex: Atom.toLatex(this.model.root, { expandMacro: false }),\r\n            selection: this.model.selection,\r\n        };\r\n    }\r\n    /**\r\n     * Set the content and selection of the mathfield to a value previously\r\n     * captured with save() or stored in the undo stack.\r\n     * This does not affect the undo stack.\r\n     */\r\n    restore(state: UndoRecord, options: UndoOptions): void {\r\n        const wasSuppressing = this.model.suppressChangeNotifications;\r\n        if (typeof options.suppressChangeNotifications !== 'undefined') {\r\n            this.model.suppressChangeNotifications =\r\n                options.suppressChangeNotifications;\r\n        }\r\n\r\n        // Restore the content\r\n        insert(this.model, state ? state.latex : '', {\r\n            ...options,\r\n            format: 'latex',\r\n            mode: 'math',\r\n            insertionMode: 'replaceAll',\r\n            selectionMode: 'after',\r\n            smartFence: false,\r\n        });\r\n\r\n        // Restore the selection\r\n        this.model.selection = state ? state.selection : { ranges: [[0, 0]] };\r\n\r\n        this.model.suppressChangeNotifications = wasSuppressing;\r\n    }\r\n}\r\n","export const STRINGS = {\r\n    en: {\r\n        'keyboard.tooltip.functions': 'Functions',\r\n        'keyboard.tooltip.symbols': 'Symbols',\r\n        'keyboard.tooltip.greek': 'Greek Letters',\r\n        'keyboard.tooltip.command': 'LaTeX Command Mode',\r\n        'keyboard.tooltip.numeric': 'Numeric',\r\n        'keyboard.tooltip.roman': 'Roman Letters',\r\n        'tooltip.copy to clipboard': 'Copy to Clipboard',\r\n        'tooltip.redo': 'Redo',\r\n        'tooltip.toggle virtual keyboard': 'Toggle Virtual Keyboard',\r\n        'tooltip.undo': 'Undo',\r\n    },\r\n    ar: {\r\n        'keyboard.tooltip.functions': '',\r\n        'keyboard.tooltip.symbols': '  ',\r\n        'keyboard.tooltip.greek': ' ',\r\n        'keyboard.tooltip.command': '   ',\r\n        'keyboard.tooltip.numeric': '',\r\n        'keyboard.tooltip.roman': '  ',\r\n        'tooltip.copy to clipboard': '  ',\r\n        'tooltip.redo': '',\r\n        'tooltip.toggle virtual keyboard': '   ',\r\n        'tooltip.undo': '',\r\n    },\r\n    de: {\r\n        'keyboard.tooltip.functions': 'Funktionen',\r\n        'keyboard.tooltip.symbols': 'Symbole',\r\n        'keyboard.tooltip.greek': 'Griechische Buchstaben',\r\n        'keyboard.tooltip.command': 'LaTeX-Befehlsmodus',\r\n        'keyboard.tooltip.numeric': 'Numerisch',\r\n        'keyboard.tooltip.roman': 'Rmische Buchstaben',\r\n        'tooltip.copy to clipboard': 'In die Zwischenablage kopieren',\r\n        'tooltip.redo': 'Wiederholen',\r\n        'tooltip.toggle virtual keyboard': 'Virtuelle Tastatur umschalten',\r\n        'tooltip.undo': 'Widerrufen',\r\n    },\r\n    el: {\r\n        'keyboard.tooltip.functions': '',\r\n        'keyboard.tooltip.symbols': '',\r\n        'keyboard.tooltip.greek': ' ',\r\n        'keyboard.tooltip.command': '  LaTeX',\r\n        'keyboard.tooltip.numeric': '',\r\n        'keyboard.tooltip.roman': ' ',\r\n        'tooltip.copy to clipboard': '  ',\r\n        'tooltip.redo': '',\r\n        'tooltip.toggle virtual keyboard': '  ',\r\n        'tooltip.undo': '',\r\n    },\r\n    es: {\r\n        'keyboard.tooltip.functions': 'Funciones',\r\n        'keyboard.tooltip.symbols': 'Smbolos',\r\n        'keyboard.tooltip.greek': 'Letras griegas',\r\n        'keyboard.tooltip.command': 'Modo Comando LaTeX',\r\n        'keyboard.tooltip.numeric': 'Numrico',\r\n        'keyboard.tooltip.roman': 'Letras romanas',\r\n        'tooltip.copy to clipboard': 'Copiar al portapapeles',\r\n        'tooltip.redo': 'Rehacer',\r\n        'tooltip.toggle virtual keyboard': 'Alternar teclado virtual',\r\n        'tooltip.undo': 'Deshacer',\r\n    },\r\n    fa: {\r\n        'keyboard.tooltip.functions': '',\r\n        'keyboard.tooltip.symbols': '',\r\n        'keyboard.tooltip.greek': ' ',\r\n        'keyboard.tooltip.command': '  ',\r\n        'keyboard.tooltip.numeric': '',\r\n        'keyboard.tooltip.roman': ' ',\r\n        'tooltip.copy to clipboard': '  ',\r\n        'tooltip.redo': '  ',\r\n        'tooltip.toggle virtual keyboard': '/  ',\r\n        'tooltip.undo': '  ',\r\n    },\r\n    fr: {\r\n        'keyboard.tooltip.functions': 'Fonctions',\r\n        'keyboard.tooltip.symbols': 'Symboles',\r\n        'keyboard.tooltip.greek': 'Lettres grecques',\r\n        'keyboard.tooltip.command': 'Mode de commandes LaTeX',\r\n        'keyboard.tooltip.numeric': 'Numrique',\r\n        'keyboard.tooltip.roman': 'Lettres romaines',\r\n        'tooltip.copy to clipboard': 'Copier dans le presse-papiers',\r\n        'tooltip.redo': 'Rtablir',\r\n        'tooltip.toggle virtual keyboard':\r\n            'Afficher/Masquer le clavier virtuel',\r\n        'tooltip.undo': 'Annuler',\r\n    },\r\n    it: {\r\n        'keyboard.tooltip.functions': 'Funzioni',\r\n        'keyboard.tooltip.symbols': 'Simboli',\r\n        'keyboard.tooltip.greek': 'Lettere greche',\r\n        'keyboard.tooltip.command': 'Modalit di comando LaTeX',\r\n        'keyboard.tooltip.numeric': 'Numerico',\r\n        'keyboard.tooltip.roman': 'Lettere romane',\r\n        'tooltip.copy to clipboard': 'Copia negli appunti',\r\n        'tooltip.redo': 'Rifare',\r\n        'tooltip.toggle virtual keyboard':\r\n            'Attiva / disattiva la tastiera virtuale',\r\n        'tooltip.undo': 'Disfare',\r\n    },\r\n    ja: {\r\n        'keyboard.tooltip.functions': '',\r\n        'keyboard.tooltip.symbols': '',\r\n        'keyboard.tooltip.greek': '',\r\n        'keyboard.tooltip.command': 'LaTeX',\r\n        'keyboard.tooltip.numeric': '',\r\n        'keyboard.tooltip.roman': '',\r\n        'tooltip.copy to clipboard': '',\r\n        'tooltip.redo': '',\r\n        'tooltip.toggle virtual keyboard': '',\r\n        'tooltip.undo': '',\r\n    },\r\n    pl: {\r\n        'keyboard.tooltip.functions': 'Funkcje',\r\n        'keyboard.tooltip.symbols': 'Symbolika',\r\n        'keyboard.tooltip.greek': 'Litery greckie',\r\n        'keyboard.tooltip.command': 'Tryb polece LaTeX',\r\n        'keyboard.tooltip.numeric': 'Numeryczne',\r\n        'keyboard.tooltip.roman': 'Litery rzymskie',\r\n        'tooltip.copy to clipboard': 'Kopiuj do Schowka',\r\n        'tooltip.redo': 'Przywr',\r\n        'tooltip.toggle virtual keyboard': 'Przecz wirtualn klawiatur',\r\n        'tooltip.undo': 'Cofnij',\r\n    },\r\n    ru: {\r\n        'keyboard.tooltip.functions': '',\r\n        'keyboard.tooltip.symbols': '',\r\n        'keyboard.tooltip.greek': ' ',\r\n        'keyboard.tooltip.command': '   LaTeX',\r\n        'keyboard.tooltip.numeric': '',\r\n        'keyboard.tooltip.roman': ' ',\r\n        'tooltip.copy to clipboard': '   ',\r\n        'tooltip.redo': '',\r\n        'tooltip.toggle virtual keyboard': '  ',\r\n        'tooltip.undo': '',\r\n    },\r\n};\r\n","// import { Keys } from '../types-utils';\r\nimport { STRINGS } from './l10n-strings';\r\n\r\nexport const l10n: {\r\n    locale?: string;\r\n    plural?(value, s, options): Intl.PluralRules;\r\n    ordinal?(value, s, options): Intl.PluralRules;\r\n    cardinal?(value, s, options): Intl.PluralRules;\r\n    merge?(\r\n        locale: string | { [language: string]: { [key: string]: string } },\r\n        strings?: { [key: string]: string }\r\n    ): void;\r\n    _ordinalEnglishPluralCategories?: string[];\r\n    _ordinalPluralCategories?: string[];\r\n    _ordinalEnglish?: Intl.PluralRules;\r\n    _ordinal?: Intl.PluralRules;\r\n    _cardinalPluralCategories?: string[];\r\n    _cardinalEnglishPluralCategories?: string[];\r\n    _cardinalEnglish?: Intl.PluralRules;\r\n    _cardinal?: Intl.PluralRules;\r\n    _locale?: string;\r\n    strings?: { [language: string]: { [key: string]: string } };\r\n} = {};\r\n\r\nl10n.plural = function (value: number, s: string, options): Intl.PluralRules {\r\n    options = options ?? {};\r\n    options.type = options.type ?? 'cardinal';\r\n    const language = l10n.locale.substring(0, 2);\r\n    const rules = options.type === 'ordinal' ? l10n._ordinal : l10n._cardinal;\r\n    let rule =\r\n        options.type === 'ordinal'\r\n            ? l10n._ordinalPluralCategories.indexOf(rules.select(value))\r\n            : l10n._cardinalPluralCategories.indexOf(rules.select(value));\r\n\r\n    let result;\r\n    if (l10n.strings[l10n.locale]) result = l10n.strings[l10n.locale][s];\r\n    if (!result && l10n.strings[language]) result = l10n.strings[language][s];\r\n    if (!result) {\r\n        result = l10n.strings['en'][s];\r\n        if (!result) result = s;\r\n        if (options.type === 'ordinal') {\r\n            rule = l10n._ordinalPluralCategories.indexOf(\r\n                l10n._ordinalEnglish.select(value)\r\n            );\r\n        } else {\r\n            rule = l10n._cardinalPluralCategories.indexOf(\r\n                l10n._cardinalEnglish.select(value)\r\n            );\r\n        }\r\n    }\r\n    return result.split(';')[rule] || result.split(';')[0];\r\n};\r\n\r\n/*\r\n * Two forms for this function:\r\n * - merge(locale, strings)\r\n * Merge a dictionary of keys -> values for the specified locale\r\n * - merge(strings)\r\n * Merge a dictionary of locale code -> dictionary of keys -> values\r\n *\r\n */\r\nl10n.merge = function (\r\n    locale: string | { [language: string]: { [key: string]: string } },\r\n    strings?: { [key: string]: string }\r\n): void {\r\n    if (locale && strings) {\r\n        const savedLocale = l10n._locale;\r\n        l10n.locale = locale as string; // Load the necessary json file\r\n\r\n        l10n.strings[locale as string] = {\r\n            ...l10n.strings[locale as string],\r\n            ...strings,\r\n        };\r\n        l10n.locale = savedLocale;\r\n    } else if (locale && !strings) {\r\n        Object.keys(\r\n            locale as { [language: string]: { [key: string]: string } }\r\n        ).forEach((l) => l10n.merge(l, locale[l]));\r\n    }\r\n};\r\n\r\n// Add getter and setter for the _locale property of l10n\r\nObject.defineProperty(l10n, 'locale', {\r\n    set(locale) {\r\n        l10n._locale = locale;\r\n        l10n._ordinal = null;\r\n        l10n._cardinal = null;\r\n    },\r\n    get() {\r\n        // Use the browser defined language as the default language,\r\n        // \"english\" if not running in a browser (node.js)\r\n        if (!l10n._locale) {\r\n            // Use the setter, which will load the necessary .json files.\r\n            l10n._locale = navigator?.language.slice(0, 5) ?? 'en';\r\n        }\r\n        return l10n._locale;\r\n    },\r\n});\r\n\r\nObject.defineProperty(l10n, 'ordinal', {\r\n    get() {\r\n        if (!l10n._ordinal) {\r\n            l10n._ordinalEnglish = new Intl.PluralRules('en', {\r\n                type: 'ordinal',\r\n            });\r\n            l10n._ordinalEnglishPluralCategories = l10n._ordinalEnglish.resolvedOptions().pluralCategories;\r\n            l10n._ordinal = new Intl.PluralRules(l10n.locale, {\r\n                type: 'ordinal',\r\n            });\r\n            l10n._ordinalPluralCategories = l10n._ordinal.resolvedOptions().pluralCategories;\r\n            //    \"zero\", \"one\", \"two\", \"few\", \"many\" and \"other\"\r\n        }\r\n        return l10n._ordinal;\r\n    },\r\n});\r\n\r\nObject.defineProperty(l10n, 'cardinal', {\r\n    get() {\r\n        if (!l10n._cardinal) {\r\n            l10n._cardinalEnglish = new Intl.PluralRules('en', {\r\n                type: 'cardinal',\r\n            });\r\n            l10n._cardinalEnglishPluralCategories = l10n._cardinalEnglish.resolvedOptions().pluralCategories;\r\n            l10n._cardinal = new Intl.PluralRules(l10n.locale, {\r\n                type: 'cardinal',\r\n            });\r\n            l10n._cardinalPluralCategories = l10n._ordinal.resolvedOptions().pluralCategories;\r\n        }\r\n        return l10n._cardinal;\r\n    },\r\n});\r\n\r\nl10n.strings = STRINGS;\r\n\r\nexport function localize(s: string): string {\r\n    const language = l10n.locale.substring(0, 2);\r\n\r\n    let result = '';\r\n\r\n    // Attempt to find a match for the current locale\r\n    if (l10n.strings[l10n.locale]) result = l10n.strings[l10n.locale][s];\r\n    // If none is found, attempt to find a match for the language\r\n    if (!result && l10n.strings[language]) result = l10n.strings[language][s];\r\n    // If none is found, try english\r\n    if (!result) result = l10n.strings['en'][s];\r\n    // If that didn't work, use the key...\r\n    if (!result) result = s;\r\n\r\n    return result;\r\n}\r\n","import type { Range } from '../public/mathfield';\nimport { ModelPrivate } from './model-private';\n\n/**\n * @todo: handle RegExp\n */\nexport function find(model: ModelPrivate, value: string | RegExp): Range[] {\n    if (typeof value !== 'string') return []; // @todo: handle RegExp\n\n    const result = [];\n    const lastOffset = model.lastOffset;\n\n    for (let i = 0; i < lastOffset; i++) {\n        const depth = model.at(i).treeDepth;\n        // @todo: adjust for depth, use the smallest depth of start and end\n        // and adjust start/end to be at the same depth\n        // if parent of start and end is not the same,\n        // look at common ancestor, if start's parent is common ancestor,\n        // use start, otherwise start =  position of common ancestor.\n        // if end's parent is common ancestor, use end, otherwise use position\n        // of common ancestor + 1.\n        // And maybe that \"adjustment\" need to be in getValue()? but then\n        // the range result might include duplicates\n        for (let j = i; j < lastOffset; j++) {\n            let fragment = '';\n            for (let k = i + 1; k <= j; k++) {\n                if (model.at(k).treeDepth === depth) {\n                    fragment += model.atomToString(model.at(k), 'latex');\n                    console.log(\n                        `fragment(${\n                            i + 1\n                        }, ${j}) = \"${fragment}\" = '${model.getValue(i, j)}'`\n                    );\n                }\n            }\n            if (\n                (typeof value === 'string' && value === fragment) ||\n                (typeof value !== 'string' && value.test(fragment))\n            ) {\n                result.push(model.normalizeRange([i, j]));\n            }\n        }\n    }\n    return result;\n}\n","import { ParseMode } from '../public/core';\r\nimport type { Atom } from '../core/atom';\r\nimport { CommandAtom } from '../core-atoms/command';\r\n\r\nimport { suggest } from '../core-definitions/definitions-utils';\r\n\r\nimport type { ModelPrivate } from '../editor-model/model-private';\r\nimport { contentDidChange } from '../editor-model/listeners';\r\nimport {\r\n    getCommandString,\r\n    getCommandRange,\r\n    getCommandSuggestionRange,\r\n    getCommandAtoms,\r\n} from '../editor-model/command-mode';\r\n\r\nimport { register as registerCommand } from './commands';\r\nimport type { MathfieldPrivate } from '../editor-mathfield/mathfield-private';\r\nimport { hidePopover, showPopoverWithLatex } from './popover';\r\nimport { insert } from '../editor-model/insert';\r\nimport { parseString } from '../core/parser';\r\nimport { requestUpdate } from '../editor-mathfield/render';\r\n\r\nexport function acceptCommandSuggestion(model: ModelPrivate): void {\r\n    model\r\n        .getAtoms(getCommandSuggestionRange(model))\r\n        .forEach((x: CommandAtom) => {\r\n            x.isSuggestion = false;\r\n        });\r\n}\r\n\r\nexport function insertSuggestion(model: ModelPrivate, s: string): void {\r\n    // Remove any previous suggestion\r\n    model.deleteAtoms(getCommandSuggestionRange(model));\r\n\r\n    const atoms = [];\r\n    for (const c of s) {\r\n        atoms.push(new CommandAtom(c, { isSuggestion: true }));\r\n    }\r\n\r\n    const cursor = model.at(model.position);\r\n    cursor.parent.addChildrenAfter(atoms, cursor);\r\n}\r\n\r\n/**\r\n * When in command mode, insert the command in progress and leave command mode\r\n *\r\n * @param options.discard if true, the entire command is discarded and the\r\n * mode switched back to math\r\n * @param options.acceptSuggestion if true, accept the suggestion to\r\n * complete the command. Otherwise, only use what has been entered so far.\r\n */\r\nexport function complete(\r\n    mathfield: MathfieldPrivate,\r\n    completion: 'reject' | 'accept' | 'accept-with-suggestion',\r\n    options?: { mode: ParseMode }\r\n): boolean {\r\n    hidePopover(mathfield);\r\n\r\n    if (completion === 'reject') {\r\n        mathfield.model.deleteAtoms(getCommandRange(mathfield.model));\r\n        mathfield.switchMode(options?.mode ?? 'math');\r\n        return true;\r\n    }\r\n    const command = getCommandString(mathfield.model, {\r\n        withSuggestion: completion === 'accept-with-suggestion',\r\n    });\r\n    if (!command) return false;\r\n\r\n    if (command === '\\\\(' || command === '\\\\)') {\r\n        mathfield.model.deleteAtoms(getCommandRange(mathfield.model));\r\n        insert(mathfield.model, command.slice(1), {\r\n            mode: mathfield.mode,\r\n        });\r\n    } else {\r\n        // We'll assume we want to insert in math mode\r\n        // (commands are only available in math mode)\r\n        mathfield.switchMode('math');\r\n        // Interpret the input as LaTeX code\r\n        const atoms = parseString(\r\n            command,\r\n            'math',\r\n            null,\r\n            mathfield.options.macros\r\n        );\r\n        if (atoms) {\r\n            insertCommand(mathfield.model, atoms);\r\n        } else {\r\n            getCommandAtoms(mathfield.model).forEach((x) => {\r\n                x.isError = true;\r\n            });\r\n        }\r\n    }\r\n    mathfield.snapshot();\r\n    mathfield.model.announce('replacement');\r\n    return true;\r\n}\r\n\r\nfunction updateSuggestion(mathfield: MathfieldPrivate): boolean {\r\n    const model = mathfield.model;\r\n    model.deleteAtoms(getCommandSuggestionRange(model));\r\n    const command = getCommandString(model);\r\n    const suggestions = suggest(command);\r\n    if (suggestions.length === 0) {\r\n        hidePopover(mathfield);\r\n        getCommandAtoms(mathfield.model).forEach((x) => {\r\n            x.isError = true;\r\n        });\r\n    } else {\r\n        const index = mathfield.suggestionIndex % suggestions.length;\r\n        const l = command.length - suggestions[index].match.length;\r\n        if (l !== 0) {\r\n            insertSuggestion(\r\n                mathfield.model,\r\n                suggestions[index].match.substr(l)\r\n            );\r\n        }\r\n        showPopoverWithLatex(\r\n            mathfield,\r\n            suggestions[index].match,\r\n            suggestions.length > 1\r\n        );\r\n    }\r\n    requestUpdate(mathfield);\r\n    return true;\r\n}\r\n\r\nfunction nextSuggestion(mathfield: MathfieldPrivate): boolean {\r\n    mathfield.suggestionIndex += 1;\r\n    // The modulo of the suggestionIndex is used to determine which suggestion\r\n    // to display, so no need to worry about rolling over.\r\n    updateSuggestion(mathfield);\r\n    return false;\r\n}\r\n\r\nfunction previousSuggestion(mathfield: MathfieldPrivate): boolean {\r\n    mathfield.suggestionIndex -= 1;\r\n    if (mathfield.suggestionIndex < 0) {\r\n        // We're rolling over\r\n        // Get the list of suggestions, so we can know how many there are\r\n        // Not very efficient, but simple.\r\n        mathfield.model.deleteAtoms(getCommandSuggestionRange(mathfield.model));\r\n        const suggestions = suggest(getCommandString(mathfield.model));\r\n        mathfield.suggestionIndex = suggestions.length - 1;\r\n    }\r\n    updateSuggestion(mathfield);\r\n    return false;\r\n}\r\n\r\nfunction insertCommand(model: ModelPrivate, atoms: Atom[]): void {\r\n    let didChange = model.deleteAtoms(getCommandRange(model));\r\n\r\n    if (atoms) {\r\n        // Find any placeholders in the new atoms\r\n        const placeholders = [];\r\n        atoms.forEach((atom) =>\r\n            atom.children.forEach((x) => {\r\n                if (x.type === 'placeholder') placeholders.push(x);\r\n            })\r\n        );\r\n\r\n        // Insert the new atoms\r\n        const cursor = model.at(model.position);\r\n        cursor.parent.addChildrenAfter(atoms, cursor);\r\n        didChange = true;\r\n\r\n        // Change the selection\r\n        if (placeholders.length > 0) {\r\n            const offset = model.offsetOf(placeholders[0]);\r\n            console.assert(offset >= 0);\r\n            model.setSelection(offset - 1, offset);\r\n        } else {\r\n            // No placeholder, move after the last new atom\r\n            model.position = model.offsetOf(atoms[atoms.length - 1]);\r\n        }\r\n    }\r\n\r\n    if (didChange) {\r\n        // Dispatch notifications\r\n        contentDidChange(model);\r\n    }\r\n}\r\n\r\nregisterCommand(\r\n    {\r\n        complete: complete,\r\n        nextSuggestion: nextSuggestion,\r\n        previousSuggestion: previousSuggestion,\r\n    },\r\n    { target: 'mathfield', category: 'autocomplete' }\r\n);\r\n","import type { TextToSpeechOptions, MathfieldOptions } from '../public/options';\r\nimport type { SpeechScope } from '../public/commands';\r\n\r\nimport type { Atom } from '../core/atom';\r\n\r\nimport type { MathfieldPrivate } from '../editor-mathfield/mathfield-private';\r\n\r\nimport { atomToSpeakableText } from './atom-to-speakable-text';\r\nimport { register as registerCommand } from './commands';\r\nimport { render } from '../editor-mathfield/render';\r\n\r\nexport function speakableText(\r\n    speechOptions: Required<TextToSpeechOptions>,\r\n    prefix: string,\r\n    atoms: Atom | Atom[]\r\n): string {\r\n    const options: TextToSpeechOptions = {\r\n        ...speechOptions,\r\n        textToSpeechMarkup: '',\r\n        textToSpeechRulesOptions: {\r\n            ...speechOptions.textToSpeechRulesOptions,\r\n            markup: 'none',\r\n        },\r\n    };\r\n    return prefix + atomToSpeakableText(atoms, options);\r\n}\r\n\r\n/**\r\n *\r\n * Speak some part of the expression, either with or without synchronized highlighting.\r\n *\r\n * @param speakOptions.withHighlighting - If true, synchronized\r\n * highlighting of speech will happen (if possible). Default is false.\r\n */\r\n\r\n// @revisit: register 'speak' command with mathfield (to get access to SpeechOptions, which need to be passed down)\r\nregisterCommand(\r\n    {\r\n        speak: (\r\n            mathfield: MathfieldPrivate,\r\n            scope: SpeechScope,\r\n            options: { withHighlighting: boolean }\r\n        ): boolean => {\r\n            return speak(mathfield, scope, options);\r\n        },\r\n    },\r\n    { target: 'mathfield', category: 'speech' }\r\n);\r\n\r\nfunction speak(\r\n    mathfield: MathfieldPrivate,\r\n    scope: SpeechScope,\r\n    speakOptions: { withHighlighting: boolean }\r\n): boolean {\r\n    speakOptions = speakOptions ?? { withHighlighting: false };\r\n    const model = mathfield.model;\r\n    function getAtoms(mathfield: MathfieldPrivate, scope: SpeechScope): Atom[] {\r\n        let result = null;\r\n        switch (scope) {\r\n            case 'all':\r\n                result = model.root;\r\n                break;\r\n            case 'selection':\r\n                result = model.getAtoms(model.selection);\r\n                break;\r\n            case 'left': {\r\n                result = model.getAtoms(\r\n                    model.offsetOf(model.at(model.position).firstSibling),\r\n                    model.position\r\n                );\r\n                break;\r\n            }\r\n            case 'right': {\r\n                result = model.getAtoms(\r\n                    model.position,\r\n                    model.offsetOf(model.at(model.position).lastSibling)\r\n                );\r\n                break;\r\n            }\r\n            case 'group':\r\n                result = model.getAtoms(model.getSiblingsRange(model.position));\r\n                break;\r\n            case 'parent': {\r\n                const parent = model.at(model.position).parent;\r\n                if (parent && parent.type !== 'root') {\r\n                    result = parent;\r\n                }\r\n                break;\r\n            }\r\n            // case 'start':\r\n            // case 'end':\r\n            // not yet implemented\r\n            // break;\r\n            default:\r\n                break;\r\n        }\r\n        return result;\r\n    }\r\n    function getFailedSpeech(scope: string): string {\r\n        let result = '';\r\n        switch (scope) {\r\n            case 'all':\r\n                console.log('Internal failure: speak all failed');\r\n                break;\r\n            case 'selection':\r\n                result = 'no selection';\r\n                break;\r\n            case 'left':\r\n                result = 'at start';\r\n                break;\r\n            case 'right':\r\n                result = 'at end';\r\n                break;\r\n            case 'group':\r\n                console.log('Internal failure: speak group failed');\r\n                break;\r\n            case 'parent':\r\n                result = 'no parent';\r\n                break;\r\n            default:\r\n                console.log('unknown speak_ param value: \"' + scope + '\"');\r\n                break;\r\n        }\r\n        return result;\r\n    }\r\n    const atoms = getAtoms(mathfield, scope);\r\n    if (atoms === null) {\r\n        mathfield.options.speakHook(getFailedSpeech(scope), mathfield.options);\r\n        return false;\r\n    }\r\n    const options = { ...mathfield.options };\r\n    if (speakOptions.withHighlighting || options.speechEngine === 'amazon') {\r\n        options.textToSpeechMarkup =\r\n            window['sre'] && options.textToSpeechRules === 'sre'\r\n                ? 'ssml_step'\r\n                : 'ssml';\r\n    }\r\n    const text = atomToSpeakableText(atoms, options);\r\n    if (speakOptions.withHighlighting) {\r\n        window['mathlive'].readAloudMathField = mathfield;\r\n        render(mathfield, { forHighlighting: true });\r\n        if (mathfield.options.readAloudHook) {\r\n            mathfield.options.readAloudHook(\r\n                mathfield.field,\r\n                text,\r\n                mathfield.options\r\n            );\r\n        }\r\n    } else {\r\n        if (mathfield.options.speakHook) {\r\n            mathfield.options.speakHook(text, options);\r\n        }\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\nexport function defaultSpeakHook(\r\n    text: string,\r\n    config?: Partial<MathfieldOptions>\r\n): void {\r\n    if (!config && window && window['mathlive']) {\r\n        config = window['mathlive'].config;\r\n    }\r\n    config = config ?? {};\r\n\r\n    if (!config.speechEngine || config.speechEngine === 'local') {\r\n        // On ChromeOS: chrome.accessibilityFeatures.spokenFeedback\r\n        // See also https://developer.chrome.com/apps/tts\r\n        const utterance = new SpeechSynthesisUtterance(text);\r\n        if (window) {\r\n            window.speechSynthesis.speak(utterance);\r\n        } else {\r\n            console.log('Speak: ', text);\r\n        }\r\n    } else if (config.speechEngine === 'amazon') {\r\n        if (!window || !window['AWS']) {\r\n            console.warn(\r\n                'AWS SDK not loaded. See https://www.npmjs.com/package/aws-sdk'\r\n            );\r\n        } else {\r\n            const polly = new window['AWS'].Polly({ apiVersion: '2016-06-10' });\r\n            const params = {\r\n                OutputFormat: 'mp3',\r\n                VoiceId: config.speechEngineVoice,\r\n                Engine: [\r\n                    'Amy',\r\n                    'Emma',\r\n                    'Brian',\r\n                    'Ivy',\r\n                    'Joanna',\r\n                    'Kendra',\r\n                    'Kimberly',\r\n                    'Salli',\r\n                    'Joey',\r\n                    'Justin',\r\n                    'Matthew',\r\n                ].includes(config.speechEngineVoice)\r\n                    ? 'neural'\r\n                    : 'standard',\r\n                // SampleRate: '24000',\r\n                Text: text,\r\n                TextType: 'ssml',\r\n                // SpeechMarkTypes: ['ssml]'\r\n            };\r\n            // https://docs.aws.amazon.com/AWSJavaScriptSDK/latest/AWS/Polly.html#synthesizeSpeech-property\r\n            polly.synthesizeSpeech(params, function (err, data) {\r\n                if (err) {\r\n                    console.warn(\r\n                        'polly.synthesizeSpeech() error:',\r\n                        err,\r\n                        err.stack\r\n                    );\r\n                    // announce('plonk');\r\n                } else if (data?.AudioStream) {\r\n                    const uInt8Array = new Uint8Array(data.AudioStream);\r\n                    const blob = new Blob([uInt8Array.buffer], {\r\n                        type: 'audio/mpeg',\r\n                    });\r\n                    const url = URL.createObjectURL(blob);\r\n\r\n                    const audioElement = new Audio(url);\r\n                    audioElement.play().catch((err) => console.log(err));\r\n                } else {\r\n                    console.log('polly.synthesizeSpeech():' + data);\r\n                }\r\n            });\r\n\r\n            // Can call AWS.Request() on the result of synthesizeSpeech()\r\n        }\r\n    } else if (config.speechEngine === 'google') {\r\n        console.warn(\r\n            'The Google speech engine is not supported yet. Please come again.'\r\n        );\r\n        // @todo: implement support for Google Text-to-Speech API,\r\n        // using config.speechEngineToken, config.speechEngineVoice and\r\n        // config.speechEngineAudioConfig\r\n\r\n        // curl -H \"Authorization: Bearer \"$(gcloud auth application-default print-access-token) \\\r\n        //   -H \"Content-Type: application/json; charset=utf-8\" \\\r\n        //   --data \"{\r\n        //     'input':{\r\n        //       'text':'Android is a mobile operating system developed by Google,\r\n        //          based on the Linux kernel and designed primarily for\r\n        //          touchscreen mobile devices such as smartphones and tablets.'\r\n        //     },\r\n        //     'voice':{\r\n        //       'languageCode':'en-gb',\r\n        //       'name':'en-GB-Standard-A',\r\n        //       'ssmlGender':'FEMALE'\r\n        //     },\r\n        //     'audioConfig':{\r\n        //       'audioEncoding':'MP3'\r\n        //     }\r\n        //   }\" \"https://texttospeech.googleapis.com/v1beta1/text:synthesize\" > synthesize-text.txt\r\n    }\r\n}\r\n","import type { TextToSpeechOptions } from '../public/options';\r\n\r\nimport { Atom } from '../core/atom';\r\n\r\nimport { atomsToMathML } from '../addons/math-ml';\r\nimport { speakableText } from './speech';\r\nimport type { ModelPrivate } from '../editor-model/model-private';\r\nimport type { MathfieldPrivate } from '../editor-mathfield/mathfield-private';\r\n\r\n/**\r\n * Given an atom, describe the relationship between the atom\r\n * and its siblings and their parent.\r\n */\r\nfunction relationName(atom: Atom): string {\r\n    let result: string;\r\n    if (atom.treeBranch === 'body') {\r\n        result = {\r\n            enclose: 'cross out',\r\n            leftright: 'fence',\r\n            surd: 'square root',\r\n            root: 'math field',\r\n            mop: 'operator', // e.g. `\\operatorname`, a `mop` with a body\r\n        }[atom.parent.type];\r\n    } else if (atom.parent.type === 'genfrac') {\r\n        if (atom.treeBranch === 'above') {\r\n            return 'numerator';\r\n        } else if (atom.treeBranch === 'below') {\r\n            return 'denominator';\r\n        }\r\n    } else if (atom.parent.type === 'surd') {\r\n        if (atom.treeBranch === 'above') {\r\n            result = 'index';\r\n        }\r\n    } else if (atom.treeBranch === 'superscript') {\r\n        result = 'superscript';\r\n    } else if (atom.treeBranch === 'subscript') {\r\n        result = 'subscript';\r\n    }\r\n\r\n    if (!result) {\r\n        console.log('unknown relationship');\r\n    }\r\n    return result ?? 'parent';\r\n}\r\n\r\n/**\r\n * Announce a change in selection or content via the aria-live region.\r\n *\r\n * @param action The action that invoked the change.\r\n * @param previousPosition The position of the insertion point before the change\r\n */\r\nexport function defaultAnnounceHook(\r\n    mathfield: MathfieldPrivate,\r\n    action: string,\r\n    previousPosition: number,\r\n    atoms: Atom[]\r\n): void {\r\n    //** Fix: the focus is the end of the selection, so it is before where we want it\r\n    let liveText = '';\r\n    // const action = moveAmount > 0 ? \"right\" : \"left\";\r\n\r\n    if (action === 'plonk') {\r\n        // Use this sound to indicate (minor) errors, for\r\n        // example when a action has no effect.\r\n        mathfield.plonkSound?.play().catch((err) => console.warn(err));\r\n        // As a side effect, reset the keystroke buffer\r\n        mathfield.resetKeystrokeBuffer();\r\n    } else if (action === 'delete') {\r\n        liveText = speakableText(mathfield.options, 'deleted: ', atoms);\r\n        //*** FIX: could also be moveUp or moveDown -- do something different like provide context???\r\n    } else if (action === 'focus' || /move/.test(action)) {\r\n        //*** FIX -- should be xxx selected/unselected */\r\n        liveText =\r\n            getRelationshipAsSpokenText(mathfield.model, previousPosition) +\r\n            (mathfield.model.selectionIsCollapsed ? '' : 'selected: ') +\r\n            getNextAtomAsSpokenText(mathfield.model, mathfield.options);\r\n    } else if (action === 'replacement') {\r\n        // announce the contents\r\n        liveText = speakableText(\r\n            mathfield.options,\r\n            '',\r\n            mathfield.model.at(mathfield.model.position)\r\n        );\r\n    } else if (action === 'line') {\r\n        // announce the current line -- currently that's everything\r\n        mathfield.accessibleNode.innerHTML = mathfield.options.createHTML(\r\n            '<math xmlns=\"http://www.w3.org/1998/Math/MathML\">' +\r\n                atomsToMathML(mathfield.model.root, mathfield.options) +\r\n                '</math>'\r\n        );\r\n\r\n        liveText = speakableText(mathfield.options, '', mathfield.model.root);\r\n        mathfield.keyboardDelegate.setAriaLabel('after: ' + liveText);\r\n\r\n        /*** FIX -- testing hack for setting braille ***/\r\n        // mathfield.accessibleNode.focus();\r\n        // console.log(\"before sleep\");\r\n        // sleep(1000).then(() => {\r\n        //     mathfield.textarea.focus();\r\n        //     console.log(\"after sleep\");\r\n        // });\r\n    } else {\r\n        liveText = atoms\r\n            ? speakableText(mathfield.options, action + ' ', atoms)\r\n            : action;\r\n    }\r\n    // aria-live regions are only spoken when it changes; force a change by\r\n    // alternately using nonbreaking space or narrow nonbreaking space\r\n    const ariaLiveChangeHack = /\\u00a0/.test(mathfield.ariaLiveText.textContent)\r\n        ? ' \\u202f '\r\n        : ' \\u00a0 ';\r\n    mathfield.ariaLiveText.textContent = liveText + ariaLiveChangeHack;\r\n    console.info('live text = ', liveText);\r\n    // this.textarea.setAttribute('aria-label', liveText + ariaLiveChangeHack);\r\n}\r\n\r\nfunction getRelationshipAsSpokenText(\r\n    model: ModelPrivate,\r\n    previousOffset?: number\r\n): string {\r\n    if (isNaN(previousOffset)) return '';\r\n    const previous = model.at(previousOffset);\r\n    if (previous.treeDepth <= model.at(model.position).treeDepth) {\r\n        return '';\r\n    }\r\n    let result = '';\r\n    let ancestor = previous.parent;\r\n    const newParent = model.at(model.position).parent;\r\n    while (ancestor !== model.root && ancestor !== newParent) {\r\n        result += `out of ${relationName(ancestor)};`;\r\n        ancestor = ancestor.parent;\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n/**\r\n *\r\n * Return the spoken text for the atom to the right of the current selection.\r\n * Take into consideration the position amongst siblings to include 'start of'\r\n * and 'end of' if applicable.\r\n */\r\nfunction getNextAtomAsSpokenText(\r\n    model: ModelPrivate,\r\n    options: TextToSpeechOptions\r\n): string {\r\n    if (!model.selectionIsCollapsed) {\r\n        return speakableText(options, '', model.getAtoms(model.selection));\r\n    }\r\n    let result = '';\r\n\r\n    // announce start of denominator, etc\r\n    const cursor = model.at(model.position);\r\n    const relation = relationName(cursor);\r\n    if (cursor.isFirstSibling) {\r\n        result = (relation ? 'start of ' + relation : 'unknown') + ': ';\r\n    }\r\n    if (cursor.isLastSibling) {\r\n        // don't say both start and end\r\n        if (!cursor.isFirstSibling) {\r\n            result += relation ? 'end of ' + relation : 'unknown';\r\n        }\r\n    } else {\r\n        result += speakableText(options, '', cursor);\r\n    }\r\n    return result;\r\n}\r\n","import type { MathfieldOptions } from '../public/options';\r\n\r\nimport { isArray } from '../common/types';\r\n\r\nimport type { Atom } from '../core/atom';\r\nimport { MACROS } from '../core-definitions/definitions';\r\n\r\nimport type { MathfieldPrivate } from '../editor-mathfield/mathfield-private';\r\nimport { l10n } from './l10n';\r\nimport { defaultAnnounceHook } from './a11y';\r\nimport { INLINE_SHORTCUTS } from './shortcuts-definitions';\r\nimport { DEFAULT_KEYBINDINGS } from './keybindings-definitions';\r\nimport { gScriptUrl } from '../common/script-url';\r\n\r\nconst AUDIO_FEEDBACK_VOLUME = 0.5; // from 0.0 to 1.0\r\n\r\nconst NO_OP_LISTENER = (): void => {\r\n    return;\r\n};\r\n\r\nexport type MathfieldOptionsPrivate = MathfieldOptions & {\r\n    onAnnounce: (\r\n        target: MathfieldPrivate,\r\n        command: string, // verb\r\n        previousPosition: number,\r\n        atoms: Atom[] // object of the command\r\n    ) => void; // @revisit 1.0: rename announceHook\r\n};\r\n\r\nfunction loadSound(\r\n    soundDirectory: string,\r\n    sound: string | HTMLAudioElement\r\n): HTMLAudioElement {\r\n    if (sound instanceof HTMLAudioElement) {\r\n        sound.load();\r\n        return sound;\r\n    }\r\n\r\n    const url = new URL(\r\n        (soundDirectory ?? './sounds') + '/' + sound,\r\n        gScriptUrl\r\n    ).toString();\r\n\r\n    const result: HTMLAudioElement = new Audio();\r\n    result.preload = 'auto';\r\n    result.src = url;\r\n    result.volume = AUDIO_FEEDBACK_VOLUME;\r\n    result.load();\r\n    return result;\r\n}\r\n\r\nfunction unloadSound(\r\n    sound:\r\n        | string\r\n        | HTMLAudioElement\r\n        | { [key: string]: HTMLAudioElement | string }\r\n): void {\r\n    if (sound instanceof HTMLAudioElement) {\r\n        sound.pause();\r\n        sound.removeAttribute('src');\r\n        // Important to properly unload: call load() after removing the\r\n        // `src` attribute\r\n        sound.load();\r\n    }\r\n}\r\n\r\nexport function update(\r\n    current: Required<MathfieldOptionsPrivate>,\r\n    updates: Partial<MathfieldOptionsPrivate>\r\n): Required<MathfieldOptionsPrivate> {\r\n    const soundsDirectory =\r\n        updates.soundsDirectory ?? current.soundsDirectory ?? './sounds';\r\n    const result: Required<MathfieldOptionsPrivate> = get(\r\n        current,\r\n        Object.keys(current)\r\n    ) as Required<MathfieldOptionsPrivate>;\r\n    Object.keys(updates).forEach((key) => {\r\n        switch (key) {\r\n            case 'scriptDepth':\r\n                if (isArray(updates.scriptDepth)) {\r\n                    result.scriptDepth = [\r\n                        updates.scriptDepth[0],\r\n                        updates.scriptDepth[1],\r\n                    ];\r\n                } else if (typeof updates.scriptDepth === 'number') {\r\n                    result.scriptDepth = [\r\n                        updates.scriptDepth,\r\n                        updates.scriptDepth,\r\n                    ];\r\n                } else {\r\n                    throw Error('Unexpected value for scriptDepth');\r\n                }\r\n                break;\r\n            case 'namespace':\r\n                // Validate the namespace (used for `data-` attributes)\r\n                if (!/^[a-z]*[-]?$/.test(updates.namespace)) {\r\n                    throw Error(\r\n                        'namespace must be a string of lowercase characters only'\r\n                    );\r\n                }\r\n                if (!/-$/.test(updates.namespace)) {\r\n                    result.namespace = updates.namespace + '-';\r\n                } else {\r\n                    result.namespace = updates.namespace;\r\n                }\r\n                break;\r\n            case 'locale':\r\n                result.locale =\r\n                    updates.locale === 'auto'\r\n                        ? navigator?.language.slice(0, 5) ?? 'en'\r\n                        : updates.locale;\r\n                l10n.locale = result.locale;\r\n                break;\r\n            case 'strings':\r\n                l10n.merge(updates.strings);\r\n                result.strings = l10n.strings;\r\n                break;\r\n            case 'virtualKeyboardLayout':\r\n                if (updates.virtualKeyboardLayout === 'auto') {\r\n                    result.virtualKeyboardLayout =\r\n                        {\r\n                            fr: 'azerty',\r\n                            be: 'azerty',\r\n                            al: 'qwertz',\r\n                            ba: 'qwertz',\r\n                            cz: 'qwertz',\r\n                            de: 'qwertz',\r\n                            hu: 'qwertz',\r\n                            sk: 'qwertz',\r\n                            ch: 'qwertz',\r\n                        }[l10n.locale.substring(0, 2)] ?? 'qwerty';\r\n                } else {\r\n                    result.virtualKeyboardLayout =\r\n                        updates.virtualKeyboardLayout;\r\n                }\r\n                break;\r\n            case 'virtualKeyboardMode':\r\n                {\r\n                    const isTouchDevice = window.matchMedia?.(\r\n                        '(any-pointer: coarse)'\r\n                    ).matches;\r\n                    if (updates.virtualKeyboardMode === 'auto') {\r\n                        result.virtualKeyboardMode = isTouchDevice\r\n                            ? 'onfocus'\r\n                            : 'off';\r\n                    } else {\r\n                        result.virtualKeyboardMode =\r\n                            updates.virtualKeyboardMode;\r\n                    }\r\n                }\r\n                break;\r\n\r\n            case 'letterShapeStyle':\r\n                if (updates.letterShapeStyle === 'auto') {\r\n                    // Letter shape style (locale dependent)\r\n                    if (l10n.locale.substring(0, 2) === 'fr') {\r\n                        result.letterShapeStyle = 'french';\r\n                    } else {\r\n                        result.letterShapeStyle = 'tex';\r\n                    }\r\n                } else {\r\n                    result.letterShapeStyle = updates.letterShapeStyle;\r\n                }\r\n                break;\r\n            case 'plonkSound':\r\n                unloadSound(result.plonkSound);\r\n                result.plonkSound = loadSound(\r\n                    soundsDirectory,\r\n                    updates.plonkSound\r\n                );\r\n                break;\r\n            case 'keypressSound':\r\n                unloadSound(result.keypressSound);\r\n                if (typeof updates.keypressSound === 'string') {\r\n                    const sound = loadSound(\r\n                        soundsDirectory,\r\n                        updates.keypressSound\r\n                    );\r\n                    result.keypressSound = {\r\n                        delete: sound,\r\n                        return: sound,\r\n                        spacebar: sound,\r\n                        default: sound,\r\n                    };\r\n                } else if (updates.keypressSound instanceof HTMLAudioElement) {\r\n                    result.keypressSound = {\r\n                        delete: updates.keypressSound,\r\n                        return: updates.keypressSound,\r\n                        spacebar: updates.keypressSound,\r\n                        default: updates.keypressSound,\r\n                    };\r\n                } else {\r\n                    if (!updates.keypressSound.default) {\r\n                        throw Error('Missing keypressSound.default');\r\n                    }\r\n                    result.keypressSound = { ...updates.keypressSound };\r\n                    result.keypressSound.default = loadSound(\r\n                        soundsDirectory,\r\n                        result.keypressSound.default\r\n                    );\r\n                    result.keypressSound.delete =\r\n                        loadSound(\r\n                            soundsDirectory,\r\n                            result.keypressSound.delete\r\n                        ) ?? updates.keypressSound.default;\r\n                    result.keypressSound.return =\r\n                        loadSound(\r\n                            soundsDirectory,\r\n                            result.keypressSound.return\r\n                        ) ?? updates.keypressSound.default;\r\n                    result.keypressSound.spacebar =\r\n                        loadSound(\r\n                            soundsDirectory,\r\n                            result.keypressSound.spacebar\r\n                        ) ?? updates.keypressSound.default;\r\n                }\r\n                break;\r\n            case 'onBlur':\r\n            case 'onFocus':\r\n            case 'onContentWillChange':\r\n            case 'onContentDidChange':\r\n            case 'onSelectionWillChange':\r\n            case 'onSelectionDidChange':\r\n            case 'onUndoStateWillChange':\r\n            case 'onUndoStateDidChange':\r\n            case 'onModeChange':\r\n            case 'onCommit':\r\n            case 'onVirtualKeyboardToggle':\r\n            case 'onReadAloudStatus':\r\n            case 'onError':\r\n                if (updates[key] === null) {\r\n                    result[key] = NO_OP_LISTENER;\r\n                } else if (typeof updates[key] !== 'function') {\r\n                    throw Error(key + ' must be a function or null');\r\n                }\r\n                result[key] = updates[key] as any;\r\n                break;\r\n            default:\r\n                if (isArray(updates[key])) {\r\n                    result[key] = [...updates[key]];\r\n                } else if (typeof updates[key] === 'object') {\r\n                    result[key] = { ...updates[key] };\r\n                } else {\r\n                    result[key] = updates[key];\r\n                }\r\n        }\r\n    });\r\n\r\n    // @revisit 1.0: for backward compatibility, interprets the overrideDefaultInlineShortcuts\r\n    // property\r\n    if (typeof updates.overrideDefaultInlineShortcuts !== 'undefined') {\r\n        if (updates.overrideDefaultInlineShortcuts) {\r\n            result.inlineShortcuts = updates.inlineShortcuts;\r\n        } else {\r\n            result.inlineShortcuts = {\r\n                ...INLINE_SHORTCUTS,\r\n                ...updates.inlineShortcuts,\r\n            };\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function get(\r\n    config: Required<MathfieldOptionsPrivate>,\r\n    keys?: keyof MathfieldOptionsPrivate | string[]\r\n): any | Partial<MathfieldOptionsPrivate> {\r\n    let resolvedKeys: string[];\r\n    if (typeof keys === 'string') {\r\n        resolvedKeys = [keys];\r\n    } else if (typeof keys === 'undefined') {\r\n        resolvedKeys = Object.keys(config);\r\n    } else {\r\n        resolvedKeys = keys;\r\n    }\r\n    const result: Partial<MathfieldOptionsPrivate> = {};\r\n    resolvedKeys.forEach((x) => {\r\n        if (isArray(result[x])) {\r\n            result[x] = [...result[x]];\r\n        } else if (typeof result[x] === 'object') {\r\n            result[x] = { ...result[x] };\r\n        } else {\r\n            result[x] = config[x];\r\n        }\r\n    });\r\n    // If requested a single key, return its value\r\n    if (typeof keys === 'string') {\r\n        return result[keys];\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function getDefault(): Required<MathfieldOptionsPrivate> {\r\n    return {\r\n        namespace: '',\r\n        substituteTextArea: undefined,\r\n        readOnly: false,\r\n        createHTML: (s: string): any => s,\r\n        fontsDirectory: './fonts',\r\n        soundsDirectory: './sounds',\r\n\r\n        defaultMode: 'math',\r\n        macros: MACROS,\r\n        horizontalSpacingScale: 1.0,\r\n        letterShapeStyle: 'auto',\r\n\r\n        smartMode: false,\r\n        smartFence: true,\r\n        smartSuperscript: true,\r\n        scriptDepth: [Infinity, Infinity],\r\n        removeExtraneousParentheses: true,\r\n        ignoreSpacebarInMathMode: true,\r\n\r\n        locale: l10n.locale,\r\n        strings: l10n.strings,\r\n\r\n        keybindings: DEFAULT_KEYBINDINGS,\r\n\r\n        overrideDefaultInlineShortcuts: false, // @revisit: don't need this if we return the actual shortcuts\r\n        inlineShortcuts: {}, // @revisit: return the actual shortcuts\r\n        inlineShortcutTimeout: 0,\r\n\r\n        virtualKeyboardToggleGlyph: `<span style=\"width: 21px; margin-top: 4px;\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 576 512\"><path d=\"M528 64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h480c26.51 0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm16 336c0 8.823-7.177 16-16 16H48c-8.823 0-16-7.177-16-16V112c0-8.823 7.177-16 16-16h480c8.823 0 16 7.177 16 16v288zM168 268v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm-336 80v-24c0-6.627-5.373-12-12-12H84c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm384 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zM120 188v-24c0-6.627-5.373-12-12-12H84c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm-96 152v-8c0-6.627-5.373-12-12-12H180c-6.627 0-12 5.373-12 12v8c0 6.627 5.373 12 12 12h216c6.627 0 12-5.373 12-12z\"/></svg></span>`,\r\n        virtualKeyboardMode: 'auto',\r\n        virtualKeyboards: 'all',\r\n        virtualKeyboardLayout: 'auto',\r\n        customVirtualKeyboardLayers: {},\r\n        customVirtualKeyboards: {},\r\n        virtualKeyboardTheme: /android|cros/i.test(navigator?.userAgent)\r\n            ? 'material'\r\n            : 'apple',\r\n        keypressVibration: true,\r\n        keypressSound: null,\r\n        plonkSound: null,\r\n\r\n        textToSpeechRules: 'mathlive',\r\n        textToSpeechMarkup: '', // no markup\r\n        textToSpeechRulesOptions: {},\r\n        speechEngine: 'local',\r\n        speechEngineVoice: 'Joanna',\r\n        speechEngineRate: '100%',\r\n        speakHook: NO_OP_LISTENER,\r\n        readAloudHook: NO_OP_LISTENER,\r\n\r\n        onAnnounce: defaultAnnounceHook,\r\n        onKeystroke: (): boolean => true,\r\n        onMoveOutOf: (): boolean => true,\r\n        onTabOutOf: (): boolean => true,\r\n\r\n        onBlur: NO_OP_LISTENER,\r\n        onFocus: NO_OP_LISTENER,\r\n        onContentWillChange: NO_OP_LISTENER,\r\n        onContentDidChange: NO_OP_LISTENER,\r\n        onSelectionWillChange: NO_OP_LISTENER,\r\n        onSelectionDidChange: NO_OP_LISTENER,\r\n        onUndoStateWillChange: NO_OP_LISTENER,\r\n        onUndoStateDidChange: NO_OP_LISTENER,\r\n        onModeChange: NO_OP_LISTENER,\r\n        onVirtualKeyboardToggle: NO_OP_LISTENER,\r\n        onReadAloudStatus: NO_OP_LISTENER,\r\n        onCommit: NO_OP_LISTENER,\r\n\r\n        onError: (): void => {\r\n            return;\r\n        },\r\n    };\r\n}\r\n","import { eventToChar } from '../editor/keyboard';\r\nimport { contentDidChange } from '../editor-model/listeners';\r\nimport type { MathfieldPrivate } from './mathfield-private';\r\nimport { mightProducePrintableCharacter } from '../editor/keyboard';\r\nimport { ModelPrivate } from '../editor-model/model-private';\r\nimport { Atom } from '../core/atom-class';\r\nimport { LeftRightAtom } from '../core-atoms/leftright';\r\n\r\n/**\r\n * Convert the atoms before the anchor to 'text' mode\r\n * @param count - how many atoms back to look at\r\n * @param {function} until - callback to indicate when to stop\r\n * @private\r\n */\r\nfunction convertLastAtomsToText(\r\n    model: ModelPrivate,\r\n    count?: number | ((a: Atom) => boolean),\r\n    until?: (a: Atom) => boolean\r\n): void {\r\n    if (typeof count !== 'number') {\r\n        until = count;\r\n        count = Infinity;\r\n    }\r\n    if (typeof count === 'undefined') {\r\n        count = Infinity;\r\n    }\r\n    let i = model.position;\r\n    let done = false;\r\n    while (!done) {\r\n        const atom = model.at(i);\r\n        done =\r\n            count === 0 ||\r\n            !atom ||\r\n            atom.mode !== 'math' ||\r\n            !(\r\n                /mord|textord|mpunct/.test(atom.type) ||\r\n                (atom.type === 'mop' && /[a-zA-Z]+/.test(atom.value))\r\n            ) ||\r\n            !atom.hasEmptyBranch('superscript') ||\r\n            !atom.hasEmptyBranch('subscript') ||\r\n            (until && !until(atom));\r\n        if (!done) {\r\n            atom.mode = 'text';\r\n            atom.command = atom.value;\r\n            atom.latex = undefined;\r\n        }\r\n        i -= 1;\r\n        count -= 1;\r\n    }\r\n    contentDidChange(model);\r\n}\r\n/**\r\n * Convert the atoms before the anchor to 'math' mode 'mord'\r\n * @param {number} count - how many atoms back to look at\r\n * @param {function} until - callback to indicate when to stop\r\n * @private\r\n */\r\nfunction convertLastAtomsToMath(\r\n    model: ModelPrivate,\r\n    count?: number,\r\n    until?\r\n): void {\r\n    if (typeof count === 'function') {\r\n        until = count;\r\n        count = Infinity;\r\n    }\r\n    if (typeof count === 'undefined') {\r\n        count = Infinity;\r\n    }\r\n    let i = model.position;\r\n    let done = false;\r\n    while (!done) {\r\n        const atom = model.at(i);\r\n        done =\r\n            count === 0 ||\r\n            !atom ||\r\n            atom.isFirstSibling ||\r\n            atom.mode !== 'text' ||\r\n            atom.value === ' ' ||\r\n            (until && !until(atom));\r\n        if (!done) {\r\n            atom.mode = 'math';\r\n        }\r\n        i -= 1;\r\n        count -= 1;\r\n    }\r\n    removeIsolatedSpace(model);\r\n    contentDidChange(model);\r\n}\r\n\r\n// export function applyMode(\r\n//     _mathfield: MathfieldPrivate,\r\n//     _range: Range,\r\n//     _mode: ParseMode\r\n// ): boolean {\r\n// const model = mathfield.model;\r\n// There's a mode ('text', 'math', 'command') change\r\n// if (model.selectionIsCollapsed) {\r\n//     // Nothing selected\r\n//     mathfield.switchMode(mode as ParseMode);\r\n//     return\r\n// }\r\n// Convert the selection from one mode to another\r\n//         const previousMode = mathfield.mode;\r\n//         const targetMode =\r\n//             (getMode(model, model.position) ??\r\n//                 mathfield.options.defaultMode) === 'math'\r\n//                 ? 'text'\r\n//                 : 'math';\r\n//         let convertedSelection = mathfield.getValue(\r\n//             mathfield.selection,\r\n//             'ASCIIMath'\r\n//         );\r\n//         if (targetMode === 'math' && /^\"[^\"]+\"$/.test(convertedSelection)) {\r\n//             convertedSelection = convertedSelection.slice(1, -1);\r\n//         }\r\n//         mathfield.insert(convertedSelection, {\r\n//             mode: targetMode,\r\n//             selectionMode: 'item',\r\n//             format: targetMode === 'text' ? 'text' : 'ASCIIMath',\r\n//         });\r\n//         mathfield.mode = targetMode;\r\n//         const [groupStart, groupEnd] = model.getSiblingsRange(\r\n//             model.position\r\n//         );\r\n//         const first = Math.min(model.anchor, model.position);\r\n//         const last = Math.max(model.anchor, model.position);\r\n//         if (\r\n//             groupStart >= first &&\r\n//             groupStart <= last &&\r\n//             groupEnd >= first &&\r\n//             groupEnd <= last\r\n//         ) {\r\n//             // The entire group was selected. Adjust parent mode if\r\n//             // appropriate\r\n//             const parent = model.at(model.position).parent;\r\n//             if (\r\n//                 parent &&\r\n//                 (parent.type === 'group' || parent.type === 'root')\r\n//             ) {\r\n//                 parent.mode = targetMode;\r\n//             }\r\n//         }\r\n//         // Notify of mode change\r\n//         if (\r\n//             mathfield.mode !== previousMode &&\r\n//             typeof mathfield.options.onModeChange === 'function'\r\n//         ) {\r\n//             mathfield.options.onModeChange(mathfield, mathfield.mode);\r\n//         }\r\n// }\r\n//     return false;\r\n// }\r\n\r\n/**\r\n * Going backwards from the anchor, if a text zone consisting of a single\r\n * space character is found (i.e. it is surrounded by math zone),\r\n * remove it.\r\n */\r\nexport function removeIsolatedSpace(model: ModelPrivate): void {\r\n    let i = model.position - 1;\r\n    while (i >= 0 && model.at(i)?.mode === 'math') {\r\n        i -= 1;\r\n    }\r\n    if (i < 0) return;\r\n    // If the atom before the last one converted is a\r\n    // text mode space, preceded by a math mode atom,\r\n    // remove the space\r\n    if (\r\n        model.at(i).mode === 'text' &&\r\n        model.at(i).value === ' ' &&\r\n        model.at(i - 1).mode === 'math'\r\n    ) {\r\n        model.at(i - 1).parent.removeChild(model.at(i - 1));\r\n        contentDidChange(model);\r\n        // We need to adjust the selection after doing some surgery on the atoms list\r\n        // But we don't want to receive selection notification changes\r\n        // which could have a side effect of changing the mode :(\r\n        const save = model.suppressChangeNotifications;\r\n        model.suppressChangeNotifications = true;\r\n        model.position -= 1;\r\n        model.suppressChangeNotifications = save;\r\n    }\r\n}\r\n/**\r\n * Return the characters before the insertion point that could potentially be\r\n * turned into text mode.\r\n * This excludes things like 'mop' (e.g. \\sin)\r\n */\r\nfunction getTextBeforePosition(model: ModelPrivate): string {\r\n    // Going backwards, accumulate\r\n    let result = '';\r\n    let i = model.position;\r\n    let done = false;\r\n    while (!done) {\r\n        const atom = model.at(i);\r\n        done = !(\r\n            atom &&\r\n            (atom.mode === 'text' ||\r\n                (atom.mode === 'math' && /mord|textord|mpunct/.test(atom.type)))\r\n        );\r\n        if (!done) {\r\n            result = atom.value + result;\r\n        }\r\n        i -= 1;\r\n    }\r\n    return result;\r\n}\r\n/**\r\n * Consider whether to switch mode give the content before the insertion point\r\n * and the character being input\r\n *\r\n * @param keystroke\r\n * @param evt - a Event corresponding to the keystroke\r\n * @return true if the mode should change\r\n */\r\n\r\nexport function smartMode(\r\n    mathfield: MathfieldPrivate,\r\n    keystroke: string,\r\n    evt: KeyboardEvent\r\n): boolean {\r\n    if (mathfield.smartModeSuppressed) {\r\n        return false;\r\n    }\r\n    const model = mathfield.model;\r\n    // Are we at the end of a group?\r\n    if (!model.at(model.position).isLastSibling) {\r\n        return false;\r\n    }\r\n    // Is there an event that would produce a printable char?\r\n    // (i.e. not an arrow key, etc...)\r\n    if (!evt || !mightProducePrintableCharacter(evt)) {\r\n        return false;\r\n    }\r\n    const c = eventToChar(evt);\r\n    if (!model.selectionIsCollapsed) {\r\n        // There is a selection\r\n        if (mathfield.mode === 'text') {\r\n            // If the character is '/' or '_' or '^', switch to 'math'\r\n            if (/[/_^]/.test(c)) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    const context = getTextBeforePosition(model) + c;\r\n    if (mathfield.mode === 'text') {\r\n        // We're in text mode. Should we switch to math?\r\n        if (keystroke === 'Esc' || /[/\\\\]/.test(c)) {\r\n            // If this is a command for a fraction,\r\n            // or the '\\' command mode key\r\n            // switch to 'math'\r\n            return true;\r\n        }\r\n        if (/[\\^_]/.test(c)) {\r\n            // If this is a superscript or subscript\r\n            // switch to 'math'\r\n            if (/(^|\\s)[a-zA-Z][^_]$/.test(context)) {\r\n                // If left hand context is a single letter,\r\n                // convert it to math\r\n                convertLastAtomsToMath(model, 1);\r\n            }\r\n            return true;\r\n        }\r\n        // If this is a closing matching fence\r\n        // switch to 'math' mode\r\n        const lFence = { ')': '(', '}': '{', ']': '[' }[c];\r\n        const parent = model.at(model.position).parent;\r\n        if (\r\n            lFence &&\r\n            parent instanceof LeftRightAtom &&\r\n            parent.leftDelim === lFence\r\n        ) {\r\n            return true;\r\n        }\r\n        if (/(^|[^a-zA-Z])(a|I)[ ]$/.test(context)) {\r\n            // Single letters that are valid words in the current language\r\n            // Do nothing. @todo: localization\r\n            return false;\r\n        }\r\n        if (/[$]/u.test(c)) {\r\n            // A currency symbol.\r\n            // Switch to math mode\r\n            return true;\r\n        }\r\n        if (/(^|[^a-zA-Z'])[a-zA-Z][ ]$/.test(context)) {\r\n            // An isolated letter, followed by a space:\r\n            // Convert the letter to math, stay in text mode.\r\n            convertLastAtomsToMath(model, 1);\r\n            return false;\r\n        }\r\n        if (/[^0-9]\\.[^0-9\\s]$/.test(context)) {\r\n            // A period followed by something other than space or a digit\r\n            // and not preceded by a digit.\r\n            // We thought this was a text period, but turns out it's not\r\n            // Turn it into a \\cdot\r\n            convertLastAtomsToMath(model, 1);\r\n            const atom = model.at(model.position);\r\n            atom.value = ''; // centered dot\r\n            atom.style.variant = 'normal'; // @revisit. Was 'auto'. Check for proper conversion.\r\n            atom.command = '\\\\cdot';\r\n            atom.latex = undefined;\r\n            contentDidChange(model);\r\n            return true;\r\n        }\r\n        if (/(^|\\s)[a-zA-Z][^a-zA-Z]$/.test(context)) {\r\n            // Single letter (x), followed by a non-letter (>, =...)\r\n            convertLastAtomsToMath(model, 1);\r\n            return true;\r\n        }\r\n        if (/\\.[0-9]$/.test(context)) {\r\n            // If the new character is a digit,\r\n            // and it was preceded by a dot (which may have been converted\r\n            // to text)\r\n            // turn the dot back into 'math'\r\n            convertLastAtomsToMath(model, 1);\r\n            return true;\r\n        }\r\n        if (/[(][0-9+\\-.]$/.test(context)) {\r\n            // An open paren followed by a number\r\n            // Turn the paren back to math and switch.\r\n            convertLastAtomsToMath(model, 1);\r\n            return true;\r\n        }\r\n        if (/[(][a-z][,;]$/.test(context)) {\r\n            // An open paren followed by a single letter, then a \",\" or \";\"\r\n            // Turn the paren back and letter to math and switch.\r\n            convertLastAtomsToMath(model, 2);\r\n            return true;\r\n        }\r\n        // The tests above can look behind and change what had previously\r\n        // been entered. Now, let's just look at the typed character.\r\n        if (/[0-9+\\-=><*|]$/.test(c)) {\r\n            // If this new character looks like a number,\r\n            // or a relational operator (=, <, >)\r\n            // or a \"*\" or \"|\"\r\n            // (note that <=, >=, etc... are handled separately as shortcuts)\r\n            // switch to 'math'\r\n            removeIsolatedSpace(model);\r\n            return true;\r\n        }\r\n    } else {\r\n        // We're in math mode. Should we switch to text?\r\n        if (keystroke === '[Space]') {\r\n            convertLastAtomsToText(model, undefined, (a) =>\r\n                /[a-z][:,;.]$/.test(a.value)\r\n            );\r\n            return true;\r\n        }\r\n        if (\r\n            /[a-zA-Z]{3,}$/.test(context) &&\r\n            !/(dxd|abc|xyz|uvw)$/.test(context)\r\n        ) {\r\n            // A sequence of three characters\r\n            // (except for some exceptions)\r\n            // Convert them to text.\r\n            convertLastAtomsToText(model, undefined, (a) =>\r\n                /[a-zA-Z]/.test(a.value)\r\n            );\r\n            return true;\r\n        }\r\n        if (/(^|\\W)(if|If)$/i.test(context)) {\r\n            // @todo localization\r\n            convertLastAtomsToText(model, 1);\r\n            return true;\r\n        }\r\n        if (\r\n            /(\\u0393|\\u0394|\\u0398|\\u039b|\\u039E|\\u03A0|\\u03A3|\\u03a5|\\u03a6|\\u03a8|\\u03a9|[\\u03b1-\\u03c9]|\\u03d1|\\u03d5|\\u03d6|\\u03f1|\\u03f5){3,}$/u.test(\r\n                context\r\n            ) &&\r\n            !/()$/.test(context)\r\n        ) {\r\n            // A sequence of three *greek* characters\r\n            // (except for one exception)\r\n            // Convert them to text.\r\n            convertLastAtomsToText(model, undefined, (a) =>\r\n                /(:|,|;|.|\\u0393|\\u0394|\\u0398|\\u039b|\\u039E|\\u03A0|\\u03A3|\\u03a5|\\u03a6|\\u03a8|\\u03a9|[\\u03b1-\\u03c9]|\\u03d1|\\u03d5|\\u03d6|\\u03f1|\\u03f5)/u.test(\r\n                    a.value\r\n                )\r\n            );\r\n            return true;\r\n        }\r\n        if (c === '?') {\r\n            // If the last character is a question mark,\r\n            // turn it to 'text'\r\n            return true;\r\n        }\r\n        if (c === '.' && !/[0-9-+]\\.$/.test(context)) {\r\n            // A period after something other than a digit (or minus)\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n","import type { Selector } from '../public/commands';\r\nimport { suggest } from '../core-definitions/definitions';\r\nimport { Atom } from '../core/atom-class';\r\nimport { parseString } from '../core/parser';\r\nimport { moveAfterParent } from '../editor-model/selection';\r\nimport {\r\n    mightProducePrintableCharacter,\r\n    eventToChar,\r\n} from '../editor/keyboard';\r\nimport {\r\n    getInlineShortcutsStartingWith,\r\n    getInlineShortcut,\r\n} from '../editor/shortcuts';\r\nimport {\r\n    getCommandForKeybinding,\r\n    getKeybindingMarkup,\r\n    normalizeKeybindings,\r\n} from '../editor/keybindings';\r\nimport { showPopoverWithLatex } from '../editor/popover';\r\nimport { splitGraphemes } from '../core/grapheme-splitter';\r\nimport { HAPTIC_FEEDBACK_DURATION } from '../editor/commands';\r\nimport { insertSuggestion } from '../editor/autocomplete';\r\nimport {\r\n    getCommandAtoms,\r\n    getCommandString,\r\n    getCommandSuggestionRange,\r\n} from '../editor-model/command-mode';\r\n\r\nimport { insert, insertSmartFence } from '../editor-model/insert';\r\nimport { requestUpdate } from './render';\r\n\r\nimport type { MathfieldPrivate } from './mathfield-private';\r\n\r\nimport { removeIsolatedSpace } from './smartmode';\r\nimport { smartMode } from './smartmode';\r\nimport {\r\n    getActiveKeyboardLayout,\r\n    validateKeyboardLayout,\r\n} from '../editor/keyboard-layout';\r\nimport { ParseMode } from '../public/core';\r\n\r\nexport function showKeystroke(\r\n    mathfield: MathfieldPrivate,\r\n    keystroke: string\r\n): void {\r\n    const vb = mathfield.keystrokeCaption;\r\n    if (vb && mathfield.keystrokeCaptionVisible) {\r\n        const bounds = mathfield.element.getBoundingClientRect();\r\n        vb.style.left = bounds.left + 'px';\r\n        vb.style.top = bounds.top - 64 + 'px';\r\n        vb.innerHTML = mathfield.options.createHTML(\r\n            '<span>' +\r\n                (getKeybindingMarkup(keystroke) || keystroke) +\r\n                '</span>' +\r\n                vb.innerHTML\r\n        );\r\n        vb.style.visibility = 'visible';\r\n        setTimeout(function () {\r\n            if (vb.childNodes.length > 0) {\r\n                vb.removeChild(vb.childNodes[vb.childNodes.length - 1]);\r\n            }\r\n            if (vb.childNodes.length === 0) {\r\n                vb.style.visibility = 'hidden';\r\n            }\r\n        }, 3000);\r\n    }\r\n}\r\n\r\n/**\r\n * @param evt - An Event corresponding to the keystroke.\r\n */\r\nexport function onKeystroke(\r\n    mathfield: MathfieldPrivate,\r\n    keystroke: string,\r\n    evt: KeyboardEvent\r\n): boolean {\r\n    const model = mathfield.model;\r\n\r\n    // 1. Update the keybindings according to the current keyboard layout\r\n\r\n    // 1.1 Possibly update the current keyboard layout based on this event\r\n    validateKeyboardLayout(evt);\r\n\r\n    const activeLayout = getActiveKeyboardLayout();\r\n    if (mathfield.keyboardLayout !== activeLayout.id) {\r\n        // console.log('Switching to keyboard layout ' + activeLayout.id);\r\n        mathfield.keyboardLayout = activeLayout.id;\r\n        mathfield.keybindings = normalizeKeybindings(\r\n            mathfield.options.keybindings,\r\n            (e) => {\r\n                if (typeof mathfield.options.onError === 'function') {\r\n                    mathfield.options.onError({\r\n                        code: 'invalid-keybinding',\r\n                        arg: e.join('\\n'),\r\n                    });\r\n                }\r\n                console.log(e.join('\\n'));\r\n            }\r\n        );\r\n    }\r\n\r\n    // 2. Display the keystroke in the keystroke panel (if visible)\r\n    showKeystroke(mathfield, keystroke);\r\n\r\n    // 3. Reset the timer for the keystroke buffer reset\r\n    clearTimeout(mathfield.keystrokeBufferResetTimer);\r\n\r\n    // 4. Give a chance to the custom keystroke handler to intercept the event\r\n    if (\r\n        mathfield.options.onKeystroke &&\r\n        !mathfield.options.onKeystroke(mathfield, keystroke, evt)\r\n    ) {\r\n        if (evt?.preventDefault) {\r\n            evt.preventDefault();\r\n            evt.stopPropagation();\r\n        }\r\n        return false;\r\n    }\r\n\r\n    // 5. Let's try to find a matching shortcut or command\r\n    let shortcut: string;\r\n    let stateIndex: number;\r\n    let selector: Selector | '' | [Selector, ...any[]];\r\n    let resetKeystrokeBuffer = false;\r\n    // 5.1 Check if the keystroke, prefixed with the previously typed keystrokes,\r\n    // would match a long shortcut (i.e. '~~')\r\n    // Ignore the key if command or control is pressed (it may be a keybinding,\r\n    // see 5.3)\r\n    if (\r\n        mathfield.mode !== 'command' &&\r\n        (!evt || (!evt.ctrlKey && !evt.metaKey))\r\n    ) {\r\n        if (keystroke === '[Backspace]') {\r\n            // Special case for backspace\r\n            mathfield.keystrokeBuffer = mathfield.keystrokeBuffer.slice(0, -1);\r\n            mathfield.keystrokeBufferStates.pop();\r\n            mathfield.resetKeystrokeBuffer({ defer: true });\r\n        } else if (!mightProducePrintableCharacter(evt)) {\r\n            // It was a non-alpha character (PageUp, End, etc...)\r\n            mathfield.resetKeystrokeBuffer();\r\n        } else {\r\n            const c = eventToChar(evt);\r\n            // Find the longest substring that matches a shortcut\r\n            const candidate = mathfield.keystrokeBuffer + c;\r\n            let i = 0;\r\n            while (!shortcut && i < candidate.length) {\r\n                let context: Atom[];\r\n                if (mathfield.keystrokeBufferStates[i]) {\r\n                    const root = new Atom('root', { mode: 'math' });\r\n                    context = parseString(\r\n                        mathfield.keystrokeBufferStates[i].latex,\r\n                        mathfield.options.defaultMode,\r\n                        null,\r\n                        mathfield.options.macros\r\n                    );\r\n                    root.body = context;\r\n                } else {\r\n                    // The context is from the start of the group to the current position\r\n                    context = model.getAtoms(\r\n                        model.offsetOf(model.at(model.position).firstSibling),\r\n                        model.position\r\n                    );\r\n                }\r\n                shortcut = getInlineShortcut(\r\n                    context,\r\n                    candidate.slice(i),\r\n                    mathfield.options.inlineShortcuts\r\n                );\r\n                i += 1;\r\n            }\r\n\r\n            stateIndex =\r\n                mathfield.keystrokeBufferStates.length - (candidate.length - i);\r\n            mathfield.keystrokeBuffer += c;\r\n            mathfield.keystrokeBufferStates.push(mathfield.getUndoRecord());\r\n            if (\r\n                getInlineShortcutsStartingWith(candidate, mathfield.options)\r\n                    .length <= 1\r\n            ) {\r\n                resetKeystrokeBuffer = true;\r\n            } else {\r\n                mathfield.resetKeystrokeBuffer({ defer: true });\r\n            }\r\n        }\r\n    }\r\n    // 5.2. Should we switch mode?\r\n    // Need to check this before determing if there's a valid shortcut\r\n    // since if we switch to math mode, we may want to apply the shortcut\r\n    // e.g. \"slope = rise/run\"\r\n    if (mathfield.options.smartMode) {\r\n        const previousMode = mathfield.mode;\r\n        if (shortcut) {\r\n            // If we found a shortcut (e.g. \"alpha\"),\r\n            // switch to math mode and insert it\r\n            mathfield.mode = 'math';\r\n        } else if (smartMode(mathfield, keystroke, evt)) {\r\n            mathfield.mode = { math: 'text', text: 'math' }[mathfield.mode];\r\n            selector = '';\r\n        }\r\n        // Notify of mode change\r\n        if (\r\n            mathfield.mode !== previousMode &&\r\n            typeof mathfield.options.onModeChange === 'function'\r\n        ) {\r\n            mathfield.options.onModeChange(mathfield, mathfield.mode);\r\n        }\r\n    }\r\n    // 5.3 Check if this matches a keybinding\r\n    // Need to check this **after** checking for inline shortcuts because\r\n    // shift+backquote is a keybinding that inserts \"\\~\"\", but \"~~\" is a\r\n    // shortcut for \"\\approx\" and needs to have priority over shift+backquote\r\n    if (!shortcut && !selector) {\r\n        selector = getCommandForKeybinding(\r\n            mathfield.keybindings,\r\n            mathfield.mode,\r\n            keystroke\r\n        );\r\n    }\r\n    if (\r\n        !shortcut &&\r\n        !selector &&\r\n        (keystroke === '[Enter]' || keystroke === '[Return]')\r\n    ) {\r\n        // No matching keybinding: trigger a commit\r\n        if (typeof mathfield.options.onCommit === 'function') {\r\n            mathfield.options.onCommit(mathfield);\r\n            if (evt?.preventDefault) {\r\n                evt.preventDefault();\r\n                evt.stopPropagation();\r\n            }\r\n            return false;\r\n        }\r\n    }\r\n\r\n    // No shortcut :( We're done.\r\n    if (!shortcut && !selector) {\r\n        return true;\r\n    }\r\n    if (mathfield.options.readOnly && selector[0] === 'insert') {\r\n        return true;\r\n    }\r\n\r\n    //\r\n    // 6. Perform the action matching this selector or insert the shortcut\r\n    //\r\n\r\n    //\r\n    // 6.1 Remove any error indicator (wavy underline) on the current command\r\n    // sequence (if there is one)\r\n    //\r\n    getCommandAtoms(model).forEach((x) => {\r\n        x.isError = false;\r\n    });\r\n\r\n    //\r\n    // 6.2 If we have a `moveAfterParent` selector (usually triggered with\r\n    // `spacebar), and we're at the end of a smart fence, close the fence with\r\n    // an empty (.) right delimiter\r\n    //\r\n    const child = model.at(Math.max(model.position, model.anchor));\r\n    const parent = child.parent;\r\n    if (\r\n        selector === 'moveAfterParent' &&\r\n        parent &&\r\n        parent.type === 'leftright' &&\r\n        child.isLastSibling &&\r\n        mathfield.options.smartFence &&\r\n        insertSmartFence(model, '.', mathfield.style)\r\n    ) {\r\n        // Pressing the space bar (moveAfterParent selector) when at the end\r\n        // of a potential smartFence will close it as a semi-open fence\r\n        selector = '';\r\n        requestUpdate(mathfield); // Re-render the closed smartFence\r\n    }\r\n    //\r\n    // 6.3 If this is the Spacebar and we're just before or right after\r\n    // a text zone, insert the space inside the text zone\r\n    //\r\n    if (mathfield.mode === 'math' && keystroke === '[Spacebar]' && !shortcut) {\r\n        const nextSibling = model.at(model.position + 1);\r\n        const previousSibling = model.at(model.position - 1);\r\n        if (\r\n            (nextSibling && nextSibling.mode === 'text') ||\r\n            (previousSibling && previousSibling.mode === 'text')\r\n        ) {\r\n            insert(model, ' ', { mode: 'text' });\r\n        }\r\n    }\r\n    //\r\n    // 6.4 If there's a selector, perform it.\r\n    //\r\n    if (selector) {\r\n        mathfield.executeCommand(selector);\r\n    } else if (shortcut) {\r\n        //\r\n        // 6.5 Cancel the (upcoming) composition\r\n\r\n        // This is to prevent starting a composition when the keyboard event\r\n        // has already been handled.\r\n        // Example: alt+U -> \\cup, but could also be diaeresis deak key () which\r\n        // starts a composition\r\n        //\r\n        mathfield.keyboardDelegate.cancelComposition();\r\n\r\n        //\r\n        // 6.6 Insert the shortcut\r\n        // If the shortcut is a mandatory escape sequence (\\}, etc...)\r\n        // don't make it undoable, this would result in syntactically incorrect\r\n        // formulas\r\n        //\r\n        const style = {\r\n            ...model.at(model.position).computedStyle,\r\n            ...mathfield.style,\r\n        };\r\n        if (\r\n            !/^(\\\\{|\\\\}|\\\\[|\\\\]|\\\\@|\\\\#|\\\\$|\\\\%|\\\\^|\\\\_|\\\\backslash)$/.test(\r\n                shortcut\r\n            )\r\n        ) {\r\n            // To enable the substitution to be undoable,\r\n            // insert the character before applying the substitution\r\n            const saveMode = mathfield.mode;\r\n            insert(model, eventToChar(evt), {\r\n                suppressChangeNotifications: true,\r\n                mode: mathfield.mode,\r\n                style: style,\r\n            });\r\n            // Create a snapshot with the inserted character\r\n            mathfield.snapshotAndCoalesce();\r\n            // Revert to the state before the beginning of the shortcut\r\n            // (restore doesn't change the undo stack)\r\n            mathfield.restoreToUndoRecord(\r\n                mathfield.keystrokeBufferStates[stateIndex]\r\n            );\r\n            mathfield.mode = saveMode;\r\n        }\r\n        model.deferNotifications({ content: true, selection: true }, () => {\r\n            // Insert the substitute, possibly as a smart fence\r\n            insert(model, shortcut, {\r\n                format: 'latex',\r\n                mode: mathfield.mode,\r\n                style: style,\r\n                smartFence: true,\r\n            });\r\n            // Check if as a result of the substitution there is now an isolated\r\n            // (text mode) space (surrounded by math). In which case, remove it.\r\n            removeIsolatedSpace(mathfield.model);\r\n            // Switch (back) to text mode if the shortcut ended with a space\r\n            if (shortcut.endsWith(' ')) {\r\n                mathfield.mode = 'text';\r\n                insert(model, ' ', { mode: 'text', style: style });\r\n            }\r\n        });\r\n        mathfield.snapshot();\r\n        mathfield.dirty = true; // Mark the field as dirty. It will get rendered in scrollIntoView()\r\n        model.announce('replacement');\r\n        // If we're done with the shortcuts (found a unique one), reset it.\r\n        if (resetKeystrokeBuffer) {\r\n            mathfield.resetKeystrokeBuffer();\r\n        }\r\n    }\r\n\r\n    //\r\n    // 7. Make sure the insertion point is scrolled into view\r\n    //\r\n    mathfield.scrollIntoView();\r\n\r\n    //\r\n    // 8. Keystroke has been handled, if it wasn't caught in the default\r\n    // case, so prevent propagation\r\n    //\r\n    if (evt?.preventDefault) {\r\n        evt.preventDefault();\r\n        evt.stopPropagation();\r\n    }\r\n    return false;\r\n}\r\n\r\n/**\r\n * This handler is invoked when text has been typed, pasted in or input with\r\n * an input method. As a result, `text` can be a sequence of characters to\r\n * be inserted.\r\n * @param {object} options\r\n * @param {boolean} options.focus - If true, the mathfield will be focused\r\n * @param {boolean} options.feedback - If true, provide audio and haptic feedback\r\n * @param {boolean} options.simulateKeystroke - If true, generate some synthetic\r\n * keystrokes (useful to trigger inline shortcuts, for example)\r\n * @private\r\n */\r\nexport function onTypedText(\r\n    mathfield: MathfieldPrivate,\r\n    text: string,\r\n    options?: {\r\n        focus?: boolean;\r\n        feedback?: boolean;\r\n        mode?: ParseMode;\r\n        simulateKeystroke?: boolean;\r\n    }\r\n): void {\r\n    const model = mathfield.model;\r\n    if (mathfield.options.readOnly) {\r\n        model.announce('plonk');\r\n        return;\r\n    }\r\n    options = options ?? {};\r\n\r\n    //\r\n    // 1/ Focus, then provide audio and haptic feedback\r\n    //\r\n    if (options.focus) {\r\n        mathfield.focus();\r\n    }\r\n    if (options.feedback) {\r\n        if (mathfield.options.keypressVibration && navigator?.vibrate) {\r\n            navigator.vibrate(HAPTIC_FEEDBACK_DURATION);\r\n        }\r\n        mathfield.keypressSound?.play().catch(console.warn);\r\n    }\r\n    //\r\n    // 2/ Switch mode if requested\r\n    //\r\n    if (typeof options.mode === 'string' && mathfield.mode !== options.mode) {\r\n        mathfield.switchMode(options.mode);\r\n    }\r\n\r\n    //\r\n    // 3/ Simulate keystroke, if requested\r\n    //\r\n    if (options.simulateKeystroke) {\r\n        // for (const c of text) {\r\n        const c = text.charAt(0);\r\n        const ev = new KeyboardEvent('keypress', { key: c });\r\n        if (!onKeystroke(mathfield, c, ev)) {\r\n            return;\r\n        }\r\n        // }\r\n    }\r\n\r\n    //\r\n    // 4/ Insert the specified text at the current insertion point.\r\n    // If the selection is not collapsed, the content will be deleted first.\r\n    //\r\n    let popoverText = '';\r\n    let displayArrows = false;\r\n\r\n    const style = {\r\n        ...model.at(model.position).computedStyle,\r\n        ...mathfield.style,\r\n    };\r\n    // Decompose the string into an array of graphemes.\r\n    // This is necessary to correctly process what is displayed as a single\r\n    // glyph (a grapheme) but which is composed of multiple Unicode\r\n    // codepoints. This is the case in particular for some emojis, such as\r\n    // those with a skin tone modifier, the country flags emojis or\r\n    // compound emojis such as the professional emojis, including the\r\n    // David Bowie emoji: \r\n    const graphemes = splitGraphemes(text);\r\n    if (mathfield.mode === 'command') {\r\n        for (const c of graphemes) {\r\n            // Remove any error indicator on the current command sequence\r\n            // (if there is one)\r\n            getCommandAtoms(model).forEach((x) => {\r\n                x.isError = false;\r\n            });\r\n            model.deleteAtoms(getCommandSuggestionRange(model));\r\n            mathfield.suggestionIndex = 0;\r\n            const command = getCommandString(model);\r\n            insert(model, c, { mode: 'command' });\r\n            const suggestions = suggest(command + c);\r\n            if (suggestions.length === 0) {\r\n                if (/^\\\\[a-zA-Z\\\\*]+$/.test(command + c)) {\r\n                    // This looks like a command name, but not a known one\r\n                    getCommandAtoms(model).forEach((x) => {\r\n                        x.isError = true;\r\n                    });\r\n                }\r\n            } else {\r\n                if (suggestions[0].match !== command + c) {\r\n                    insertSuggestion(\r\n                        model,\r\n                        suggestions[0].match.substr(\r\n                            command.length - suggestions[0].match.length + 1\r\n                        )\r\n                    );\r\n                }\r\n                popoverText = suggestions[0].match;\r\n                displayArrows = suggestions.length > 1;\r\n            }\r\n        }\r\n    } else if (mathfield.mode === 'text') {\r\n        for (const c of graphemes) {\r\n            insert(model, c, { mode: 'text', style: style });\r\n        }\r\n    } else if (mathfield.mode === 'math') {\r\n        for (const c of graphemes) {\r\n            // Some characters are mapped to commands. Handle them here.\r\n            // This is important to handle synthetic text input and\r\n            // non-US keyboards, on which, fop example, the '^' key is\r\n            // not mapped to  'Shift-Digit6'.\r\n            const selector = {\r\n                '^': 'moveToSuperscript',\r\n                _: 'moveToSubscript',\r\n                ' ': 'moveAfterParent',\r\n            }[c];\r\n            if (selector) {\r\n                mathfield.executeCommand(selector);\r\n            } else if (\r\n                /[0-9]/.test(c) &&\r\n                mathfield.options.smartSuperscript &&\r\n                model.at(model.position).treeBranch === 'superscript' &&\r\n                model.at(model.position).hasNoSiblings\r\n            ) {\r\n                // We are inserting a digit into an empty superscript\r\n                // If smartSuperscript is on, insert the digit, and\r\n                // exit the superscript.\r\n                insert(model, c, {\r\n                    mode: 'math',\r\n                    style: style,\r\n                });\r\n                moveAfterParent(model);\r\n            } else {\r\n                insert(model, c, {\r\n                    mode: 'math',\r\n                    style: style,\r\n                    smartFence: mathfield.options.smartFence,\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    //\r\n    // 5/ Take a snapshot for undo stack\r\n    //\r\n    if (mathfield.mode !== 'command') {\r\n        mathfield.snapshotAndCoalesce();\r\n    }\r\n\r\n    //\r\n    // 6/ Render the mathfield\r\n    //\r\n    mathfield.dirty = true;\r\n\r\n    // Render and make sure the insertion point is visible\r\n    mathfield.scrollIntoView();\r\n\r\n    //\r\n    // 7/ Update popover\r\n    //\r\n    // Since the location of the popover depends on the position of the caret\r\n    // only show the popover after the formula has been rendered and the\r\n    // position of the caret calculated\r\n    showPopoverWithLatex(mathfield, popoverText, displayArrows);\r\n}\r\n","import { ParseMode } from '../public/core';\r\nimport { register as registerCommand } from '../editor/commands';\r\nimport { complete } from '../editor/autocomplete';\r\nimport type { MathfieldPrivate } from './mathfield-private';\r\nimport { onTypedText } from './keyboard-input';\r\n\r\nregisterCommand({\r\n    undo: (mathfield: MathfieldPrivate) => {\r\n        complete(mathfield, 'accept');\r\n        // Undo to the previous state\r\n        mathfield.undo();\r\n        return true;\r\n    },\r\n    redo: (mathfield: MathfieldPrivate) => {\r\n        complete(mathfield, 'accept');\r\n        mathfield.redo();\r\n        return true;\r\n    },\r\n    scrollIntoView: (mathfield: MathfieldPrivate) => {\r\n        mathfield.scrollIntoView();\r\n        return true;\r\n    },\r\n    scrollToStart: (mathfield: MathfieldPrivate) => {\r\n        mathfield.field.scroll(0, 0);\r\n        return true;\r\n    },\r\n    scrollToEnd: (mathfield: MathfieldPrivate) => {\r\n        const fieldBounds = mathfield.field.getBoundingClientRect();\r\n        mathfield.field.scroll(fieldBounds.left - window.scrollX, 0);\r\n        return true;\r\n    },\r\n    enterCommandMode: (mathfield: MathfieldPrivate) => {\r\n        mathfield.switchMode('command');\r\n        return true;\r\n    },\r\n    toggleKeystrokeCaption: (mathfield: MathfieldPrivate) => {\r\n        mathfield.keystrokeCaptionVisible = !mathfield.keystrokeCaptionVisible;\r\n        mathfield.keystrokeCaption.innerHTML = '';\r\n        if (!mathfield.keystrokeCaptionVisible) {\r\n            mathfield.keystrokeCaption.style.visibility = 'hidden';\r\n        }\r\n        return false;\r\n    },\r\n    switchMode: (mathfield: MathfieldPrivate, mode: ParseMode) => {\r\n        mathfield.switchMode(mode);\r\n        return true;\r\n    },\r\n    insert: (mathfield: MathfieldPrivate, s: string, options) =>\r\n        mathfield.insert(s, options),\r\n    typedText: (mathfield: MathfieldPrivate, text: string, options) => {\r\n        onTypedText(mathfield, text, options);\r\n        return true;\r\n    },\r\n    commit: (mathfield: MathfieldPrivate) => {\r\n        if (typeof mathfield.options.onCommit === 'function') {\r\n            mathfield.options.onCommit(mathfield);\r\n        }\r\n        return true;\r\n    },\r\n});\r\n","import { Style, FontSeries, FontShape } from '../public/core';\r\nimport { MathfieldPrivate } from './mathfield-private';\r\nimport { applyStyle as applyStyleToModel } from '../editor-model/styling';\r\nimport { register as registerCommand } from '../editor/commands';\r\n\r\nexport function applyStyle(\r\n    mathfield: MathfieldPrivate,\r\n    inStyle: Style\r\n): boolean {\r\n    const style = validateStyle(inStyle);\r\n    mathfield.resetKeystrokeBuffer();\r\n    const model = mathfield.model;\r\n    if (model.selectionIsCollapsed) {\r\n        // No selection, let's update the 'current' style\r\n        if (\r\n            mathfield.style.fontSeries &&\r\n            style.fontSeries === mathfield.style.fontSeries\r\n        ) {\r\n            style.fontSeries = 'auto';\r\n        }\r\n        if (style.fontShape && style.fontShape === mathfield.style.fontShape) {\r\n            style.fontShape = 'auto';\r\n        }\r\n        if (style.color && style.color === mathfield.style.color) {\r\n            style.color = 'none';\r\n        }\r\n        if (\r\n            style.backgroundColor &&\r\n            style.backgroundColor === mathfield.style.backgroundColor\r\n        ) {\r\n            style.backgroundColor = 'none';\r\n        }\r\n        if (style.fontSize && style.fontSize === mathfield.style.fontSize) {\r\n            style.fontSize = 'auto';\r\n        }\r\n        // This global style will be used the next time an atom is inserted\r\n        mathfield.style = { ...mathfield.style, ...style };\r\n    } else {\r\n        // Change the style of the selection\r\n        model.selection.ranges.forEach((range) =>\r\n            applyStyleToModel(model, range, style)\r\n        );\r\n        mathfield.snapshot();\r\n    }\r\n    return true;\r\n}\r\n\r\nregisterCommand({ applyStyle }, { target: 'mathfield' });\r\n\r\n/**\r\n * Validate a style specification object\r\n */\r\nfunction validateStyle(style: { [key: string]: any }): Style {\r\n    const result: Style = {};\r\n\r\n    if (typeof style.color === 'string') {\r\n        result.color = style.color;\r\n    }\r\n\r\n    if (typeof style.backgroundColor === 'string') {\r\n        result.backgroundColor = style.backgroundColor;\r\n    }\r\n\r\n    if (typeof style.fontFamily === 'string') {\r\n        result.fontFamily = style.fontFamily;\r\n    }\r\n\r\n    if (typeof style.series === 'string') {\r\n        result.fontSeries = style.series as FontSeries;\r\n    }\r\n    if (typeof style.fontSeries === 'string') {\r\n        result.fontSeries = style.fontSeries.toLowerCase() as FontSeries;\r\n    }\r\n    if (result.fontSeries) {\r\n        result.fontSeries =\r\n            {\r\n                bold: 'b',\r\n                medium: 'm',\r\n                normal: 'm',\r\n            }[result.fontSeries] || result.fontSeries;\r\n    }\r\n\r\n    if (typeof style.shape === 'string') {\r\n        result.fontShape = style.shape as FontShape;\r\n    }\r\n    if (typeof style.fontShape === 'string') {\r\n        result.fontShape = style.fontShape.toLowerCase() as FontShape;\r\n    }\r\n    if (result.fontShape) {\r\n        result.fontShape =\r\n            {\r\n                italic: 'it',\r\n                up: 'n',\r\n                upright: 'n',\r\n                normal: 'n',\r\n            }[result.fontShape] || result.fontShape;\r\n    }\r\n\r\n    if (typeof style.size === 'string') {\r\n        result.fontSize = style.size;\r\n    } else if (typeof style.size === 'number') {\r\n        result.fontSize = 'size' + Math.min(0, Math.max(10, style.size));\r\n    }\r\n    if (typeof style.fontSize === 'string') {\r\n        result.fontSize = style.fontSize.toLowerCase();\r\n    }\r\n    if (result.fontSize) {\r\n        result.fontSize =\r\n            {\r\n                tiny: 'size1',\r\n                scriptsize: 'size2',\r\n                footnotesize: 'size3',\r\n                small: 'size4',\r\n                normal: 'size5',\r\n                normalsize: 'size5',\r\n                large: 'size6',\r\n                Large: 'size7',\r\n                LARGE: 'size8',\r\n                huge: 'size9',\r\n                Huge: 'size10',\r\n            }[result.fontSize] || result.fontSize;\r\n    }\r\n\r\n    return result;\r\n}\r\n","import { register as registerCommand } from '../editor/commands';\r\nimport type { MathfieldPrivate } from './mathfield-private';\r\nimport { requestUpdate } from './render';\r\nimport { insert } from '../editor-model/insert';\r\nimport { jsonToLatex } from '../addons/math-json';\r\n\r\nexport function onPaste(\r\n    mathfield: MathfieldPrivate,\r\n    ev: ClipboardEvent\r\n): boolean {\r\n    let text = '';\r\n\r\n    // Try to get a MathJSON data type\r\n    const json = ev.clipboardData.getData('application/json');\r\n    if (json) {\r\n        try {\r\n            text = jsonToLatex(JSON.parse(json), {});\r\n        } catch (e) {\r\n            text = '';\r\n        }\r\n    }\r\n    // If that didn't work, try some plain text\r\n    if (!text) {\r\n        text = ev.clipboardData.getData('text/plain');\r\n    }\r\n\r\n    if (text) {\r\n        if (\r\n            insert(mathfield.model, text, {\r\n                smartFence: mathfield.options.smartFence,\r\n                mode: 'math',\r\n            })\r\n        ) {\r\n            requestUpdate(mathfield);\r\n        }\r\n        ev.preventDefault();\r\n        ev.stopPropagation();\r\n    }\r\n    return true;\r\n}\r\nexport function onCut(mathfield: MathfieldPrivate): boolean {\r\n    // Clearing the selection will have the side effect of clearing the\r\n    // content of the textarea. However, the textarea value is what will\r\n    // be copied to the clipboard, so defer the clearing of the selection\r\n    // to later, after the cut operation has been handled.\r\n    setTimeout(\r\n        function (): void {\r\n            mathfield.$clearSelection();\r\n            requestUpdate(mathfield);\r\n        }.bind(mathfield),\r\n        0\r\n    );\r\n    return true;\r\n}\r\nexport function onCopy(mathfield: MathfieldPrivate, e: ClipboardEvent): void {\r\n    if (mathfield.model.selectionIsCollapsed) {\r\n        e.clipboardData.setData(\r\n            'text/plain',\r\n            '$$' + mathfield.getValue('latex-expanded') + '$$'\r\n        );\r\n        e.clipboardData.setData('application/json', mathfield.getValue('json'));\r\n        e.clipboardData.setData(\r\n            'application/xml',\r\n            mathfield.getValue('mathML')\r\n        );\r\n    } else {\r\n        e.clipboardData.setData(\r\n            'text/plain',\r\n            '$$' +\r\n                mathfield.getValue(mathfield.selection, 'latex-expanded') +\r\n                '$$'\r\n        );\r\n        e.clipboardData.setData(\r\n            'application/json',\r\n            mathfield.getValue(mathfield.selection, 'json')\r\n        );\r\n        e.clipboardData.setData(\r\n            'application/xml',\r\n            mathfield.getValue(mathfield.selection, 'mathML')\r\n        );\r\n    }\r\n    // Prevent the current document selection from being written to the clipboard.\r\n    e.preventDefault();\r\n}\r\n\r\nregisterCommand(\r\n    {\r\n        copyToClipboard: (mathfield: MathfieldPrivate) => {\r\n            mathfield.focus();\r\n            // If the selection is empty, select the entire field before\r\n            // copying it.\r\n            if (mathfield.model.selectionIsCollapsed) {\r\n                mathfield.select();\r\n            }\r\n            document.execCommand('copy');\r\n            return false;\r\n        },\r\n\r\n        cutToClipboard: (mathfield: MathfieldPrivate) => {\r\n            mathfield.focus();\r\n            document.execCommand('cut');\r\n            return true;\r\n        },\r\n\r\n        pasteFromClipboard: (mathfield: MathfieldPrivate) => {\r\n            mathfield.focus();\r\n            document.execCommand('paste');\r\n            return true;\r\n        },\r\n    },\r\n    { target: 'mathfield', category: 'clipboard' }\r\n);\r\n","import { selectGroup } from '../editor-model/selection';\r\nimport { on, off, getAtomBounds, Rect } from './utils';\r\nimport type { MathfieldPrivate } from './mathfield-private';\r\nimport { requestUpdate } from './render';\r\nimport { Offset } from '../public/mathfield';\r\nimport { Atom } from '../core/atom-class';\r\n\r\nlet gLastTap: { x: number; y: number; time: number };\r\nlet gTapCount = 0;\r\n\r\nexport function onPointerDown(\r\n    mathfield: MathfieldPrivate,\r\n    evt: PointerEvent\r\n): void {\r\n    const that = mathfield;\r\n    let anchor: Offset;\r\n    let trackingPointer = false;\r\n    let trackingWords = false;\r\n    let dirty = false;\r\n\r\n    // If a mouse button other than the main one was pressed, return.\r\n    // On iOS 12.4 Safari and Firefox on Android (which do not support\r\n    // PointerEvent) the touchstart event is sent with event.buttons = 0\r\n    // which for a mouse event would normally be an\r\n    // invalid button. Accept this button 0.\r\n    if (evt.buttons !== 1 && evt.buttons !== 0) {\r\n        return;\r\n    }\r\n    let scrollLeft = false;\r\n    let scrollRight = false;\r\n    // Note: evt['touches'] is for touchstart (when PointerEvent is not supported)\r\n    const anchorX = evt['touches'] ? evt['touches'][0].clientX : evt.clientX;\r\n    const anchorY = evt['touches'] ? evt['touches'][0].clientY : evt.clientY;\r\n    const anchorTime = Date.now();\r\n    const scrollInterval = setInterval(() => {\r\n        if (scrollLeft) {\r\n            that.field.scroll({ top: 0, left: that.field.scrollLeft - 16 });\r\n        } else if (scrollRight) {\r\n            that.field.scroll({ top: 0, left: that.field.scrollLeft + 16 });\r\n        }\r\n    }, 32);\r\n    function endPointerTracking(evt?: PointerEvent): void {\r\n        if (window.PointerEvent) {\r\n            off(that.field, 'pointermove', onPointerMove);\r\n            off(that.field, 'pointerup pointercancel', endPointerTracking);\r\n            // off(window, 'pointermove', onPointerMove);\r\n            // off(window, 'pointerup blur', endPointerTracking);\r\n            if (evt) that.field.releasePointerCapture(evt.pointerId);\r\n        } else {\r\n            off(that.field, 'touchmove', onPointerMove);\r\n            off(that.field, 'touchcancel touchend', endPointerTracking);\r\n            off(window, 'mousemove', onPointerMove);\r\n            off(window, 'mouseup blur', endPointerTracking);\r\n        }\r\n        trackingPointer = false;\r\n        clearInterval(scrollInterval);\r\n        mathfield.element.classList.remove('tracking');\r\n        if (evt) {\r\n            evt.preventDefault();\r\n            evt.stopPropagation();\r\n        }\r\n    }\r\n\r\n    function onPointerMove(evt: PointerEvent): void {\r\n        // If we've somehow lost focus, end tracking\r\n        if (!that.hasFocus()) {\r\n            endPointerTracking();\r\n            return;\r\n        }\r\n        const x = evt['touches'] ? evt['touches'][0].clientX : evt.clientX;\r\n        const y = evt['touches'] ? evt['touches'][0].clientY : evt.clientY;\r\n        // Ignore events that are within small spatial and temporal bounds\r\n        // of the pointer down\r\n        const hysteresis = evt.pointerType === 'touch' ? 20 : 5;\r\n        if (\r\n            Date.now() < anchorTime + 500 &&\r\n            Math.abs(anchorX - x) < hysteresis &&\r\n            Math.abs(anchorY - y) < hysteresis\r\n        ) {\r\n            evt.preventDefault();\r\n            evt.stopPropagation();\r\n            return;\r\n        }\r\n        const fieldBounds = that.field.getBoundingClientRect();\r\n        scrollRight = x > fieldBounds.right;\r\n        scrollLeft = x < fieldBounds.left;\r\n        let actualAnchor: Offset = anchor;\r\n        if (window.PointerEvent) {\r\n            if (!evt.isPrimary) {\r\n                actualAnchor = offsetFromPoint(that, evt.clientX, evt.clientY, {\r\n                    bias: 0,\r\n                });\r\n            }\r\n        } else {\r\n            if (evt['touches'] && evt['touches'].length === 2) {\r\n                actualAnchor = offsetFromPoint(\r\n                    that,\r\n                    evt['touches'][1].clientX,\r\n                    evt['touches'][1].clientY,\r\n                    { bias: 0 }\r\n                );\r\n            }\r\n        }\r\n        const focus = offsetFromPoint(that, x, y, {\r\n            bias: x <= anchorX ? (x === anchorX ? 0 : -1) : +1,\r\n        });\r\n        if (trackingWords) {\r\n            // @revisit: extend focus, actualAnchor to word boundary\r\n        }\r\n        if (actualAnchor >= 0 && focus >= 0) {\r\n            that.model.extendSelectionTo(actualAnchor, focus);\r\n            requestUpdate(mathfield);\r\n        }\r\n        // Prevent synthetic mouseMove event when this is a touch event\r\n        evt.preventDefault();\r\n        evt.stopPropagation();\r\n    }\r\n\r\n    // Calculate the tap count\r\n    if (\r\n        gLastTap &&\r\n        Math.abs(gLastTap.x - anchorX) < 5 &&\r\n        Math.abs(gLastTap.y - anchorY) < 5 &&\r\n        Date.now() < gLastTap.time + 500\r\n    ) {\r\n        gTapCount += 1;\r\n        gLastTap.time = anchorTime;\r\n    } else {\r\n        gLastTap = {\r\n            x: anchorX,\r\n            y: anchorY,\r\n            time: anchorTime,\r\n        };\r\n        gTapCount = 1;\r\n    }\r\n    const bounds = mathfield.field.getBoundingClientRect();\r\n    if (\r\n        anchorX >= bounds.left &&\r\n        anchorX <= bounds.right &&\r\n        anchorY >= bounds.top &&\r\n        anchorY <= bounds.bottom\r\n    ) {\r\n        // Focus the mathfield\r\n        if (!mathfield.hasFocus()) {\r\n            dirty = true;\r\n            mathfield.keyboardDelegate.focus();\r\n        }\r\n\r\n        // Clicking or tapping the field resets the keystroke buffer and\r\n        // smart mode\r\n        mathfield.resetKeystrokeBuffer();\r\n        mathfield.smartModeSuppressed = false;\r\n\r\n        anchor = offsetFromPoint(mathfield, anchorX, anchorY, {\r\n            bias: 0,\r\n        });\r\n        if (anchor >= 0) {\r\n            // Set a `tracking` class to avoid triggering the hover of the virtual\r\n            // keyboard toggle, for example\r\n            mathfield.element.classList.add('tracking');\r\n\r\n            if (evt.shiftKey) {\r\n                // If the Shift key is down, extend the selection\r\n                // (in that case, 'anchor' is actually the focus\r\n                mathfield.model.extendSelectionTo(\r\n                    mathfield.model.anchor,\r\n                    anchor\r\n                );\r\n            } else {\r\n                if (mathfield.model.at(anchor).type === 'placeholder') {\r\n                    mathfield.model.setSelection(anchor - 1, anchor);\r\n                } else if (\r\n                    mathfield.model.at(anchor).rightSibling?.type ===\r\n                    'placeholder'\r\n                ) {\r\n                    mathfield.model.setSelection(anchor, anchor + 1);\r\n                } else {\r\n                    mathfield.model.position = anchor;\r\n                }\r\n            }\r\n\r\n            // The selection has changed, so we'll need to re-render\r\n            dirty = true;\r\n\r\n            // Reset any user-specified style\r\n            mathfield.style = {};\r\n            // `evt.detail` contains the number of consecutive clicks\r\n            // for double-click, triple-click, etc...\r\n            // (note that `evt.detail` is not set when using pointerEvent)\r\n            if (evt.detail === 3 || gTapCount > 2) {\r\n                endPointerTracking(evt);\r\n                if (evt.detail === 3 || gTapCount === 3) {\r\n                    // This is a triple-click\r\n                    mathfield.model.selection = {\r\n                        ranges: [[0, mathfield.model.lastOffset]],\r\n                    };\r\n                }\r\n            } else if (!trackingPointer) {\r\n                trackingPointer = true;\r\n                if (window.PointerEvent) {\r\n                    on(that.field, 'pointermove', onPointerMove);\r\n                    on(\r\n                        that.field,\r\n                        'pointerup pointercancel',\r\n                        endPointerTracking\r\n                    );\r\n                    that.field.setPointerCapture(evt.pointerId);\r\n                } else {\r\n                    on(window, 'blur', endPointerTracking);\r\n                    if (evt['touches']) {\r\n                        // This is a touchstart event (and PointerEvent is not supported)\r\n                        // To receive the subsequent touchmove/touch, need to\r\n                        // listen to this evt.target.\r\n                        // This was a touch event\r\n                        on(evt.target, 'touchmove', onPointerMove);\r\n                        on(\r\n                            evt.target,\r\n                            'touchcancel touchend',\r\n                            endPointerTracking\r\n                        );\r\n                    } else {\r\n                        on(window, 'mousemove', onPointerMove);\r\n                        on(window, 'mouseup', endPointerTracking);\r\n                    }\r\n                }\r\n                if (evt.detail === 2 || gTapCount === 2) {\r\n                    // This is a double-click\r\n                    trackingWords = true;\r\n                    selectGroup(mathfield.model);\r\n                }\r\n            }\r\n        }\r\n    } else {\r\n        gLastTap = null;\r\n    }\r\n    if (dirty) {\r\n        requestUpdate(mathfield);\r\n    }\r\n    // Prevent the browser from handling. In particular when this is a\r\n    // touch event, prevent the synthetic mouseDown event from being generated\r\n    evt.preventDefault();\r\n}\r\n\r\nfunction distance(x: number, y: number, r: Rect): number {\r\n    const dx = x - (r.left + r.right) / 2;\r\n    const dy = y - (r.top + r.bottom) / 2;\r\n    return dx * dx + dy * dy;\r\n}\r\n\r\nfunction nearestAtomFromPointRecursive(\r\n    mathfield: MathfieldPrivate,\r\n    atom: Atom,\r\n    x: number,\r\n    y: number\r\n): { distance: number; atom: Atom } {\r\n    let result = { distance: Infinity, atom: null };\r\n\r\n    if (atom.type === 'leftright') {\r\n        console.log('found');\r\n    }\r\n    const bounds = getAtomBounds(mathfield, atom);\r\n    if (!bounds) return result;\r\n\r\n    //\r\n    // 1. Consider any children within the horizontal bounds\r\n    //\r\n    if (\r\n        !atom.captureSelection &&\r\n        x >= bounds.left &&\r\n        x <= bounds.right &&\r\n        atom.hasChildren\r\n    ) {\r\n        atom.children.forEach((atom) => {\r\n            const r = nearestAtomFromPointRecursive(mathfield, atom, x, y);\r\n            if (r.distance < result.distance) {\r\n                result = r;\r\n            }\r\n        });\r\n    }\r\n\r\n    //\r\n    // 2. If no children matched, this atom matches\r\n    //\r\n    if (!result.atom) {\r\n        result.atom = atom;\r\n        result.distance = distance(x, y, bounds);\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nfunction nearestAtomFromPoint(\r\n    mathfield: MathfieldPrivate,\r\n    x: number,\r\n    y: number\r\n): Atom {\r\n    return nearestAtomFromPointRecursive(mathfield, mathfield.model.root, x, y)\r\n        .atom;\r\n}\r\n/**\r\n * @param options.bias  if 0, the midpoint of the bounding box\r\n * is considered to return the sibling. If <0, the left sibling is\r\n * favored, if >0, the right sibling\r\n */\r\nexport function offsetFromPoint(\r\n    mathfield: MathfieldPrivate,\r\n    x: number,\r\n    y: number,\r\n    options?: { bias?: number }\r\n): Offset {\r\n    const bounds = mathfield.fieldContent.getBoundingClientRect();\r\n    if (x > bounds.right || y > bounds.bottom + 8) {\r\n        return mathfield.model.lastOffset;\r\n    }\r\n    if (x < bounds.left || y < bounds.top - 8) {\r\n        return 0;\r\n    }\r\n\r\n    options = options ?? {};\r\n    options.bias = options.bias ?? 0;\r\n\r\n    // Try to find the deepest element that is near the point that was\r\n    // clicked on (the point could be outside of the element)\r\n    const atom = nearestAtomFromPoint(mathfield, x, y);\r\n    console.log(atom);\r\n    let result = mathfield.model.offsetOf(atom);\r\n\r\n    if (result < 0) return -1;\r\n\r\n    // (There should be exactly one atom that matches this ID...)\r\n    if (options.bias === 0) {\r\n        // If the point clicked is to the left of the vertical midline,\r\n        // adjust the offset to *before* the atom (i.e. after the\r\n        // preceding atom)\r\n        const bounds = getAtomBounds(mathfield, atom);\r\n        if (\r\n            x < (bounds.left + bounds.right) / 2 &&\r\n            atom.type !== 'placeholder'\r\n        ) {\r\n            result = Math.min(mathfield.model.lastOffset, result - 1);\r\n        }\r\n    } else if (options.bias < 0) {\r\n        result = Math.max(0, result - 1);\r\n    }\r\n    return result;\r\n}\r\n","import { Atom } from '../core/atom';\r\nimport { makeSpan, makeStruts } from '../core/span';\r\nimport { parseString } from '../core/parser';\r\nimport { LINE_COLORS, AREA_COLORS } from '../core/color';\r\nimport { localize as l10n } from './l10n';\r\nimport { MATHSTYLES } from '../core/mathstyle';\r\nimport { attachButtonHandlers } from '../editor-mathfield/buttons';\r\nimport { releaseSharedElement } from '../editor-mathfield/utils';\r\n\r\nimport type { MathfieldPrivate } from '../editor-mathfield/mathfield-private';\r\n\r\nimport { inject as injectStylesheet } from '../common/stylesheet';\r\n\r\n// @ts-ignore\r\nimport virtualKeyboardStylesheet from '../../css/virtual-keyboard.less';\r\n// @ts-ignore\r\nimport coreStylesheet from '../../css/core.less';\r\nimport { VirtualKeyboardLayer } from '../public/options';\r\n\r\nconst KEYBOARDS = {\r\n    numeric: {\r\n        tooltip: 'keyboard.tooltip.numeric',\r\n        layer: 'math',\r\n        label: '123',\r\n        layers: ['math'],\r\n    },\r\n    roman: {\r\n        tooltip: 'keyboard.tooltip.roman',\r\n        layer: 'lower-roman',\r\n        label: 'ABC',\r\n        layers: ['lower-roman', 'upper-roman'],\r\n    },\r\n    greek: {\r\n        tooltip: 'keyboard.tooltip.greek',\r\n        layer: 'lower-greek',\r\n        label: '&alpha;&beta;&gamma;',\r\n        classes: 'tex-math',\r\n        layers: ['lower-greek', 'upper-greek'],\r\n    },\r\n    functions: {\r\n        tooltip: 'keyboard.tooltip.functions',\r\n        layer: 'functions',\r\n        label: '<i>f</i>&thinsp;()',\r\n        classes: 'tex',\r\n        layers: ['functions'],\r\n    },\r\n    symbols: {\r\n        tooltip: 'keyboard.tooltip.symbols',\r\n        layer: 'symbols',\r\n        label: '&infin;',\r\n        classes: 'tex',\r\n        layers: ['symbols'],\r\n    },\r\n    command: {\r\n        tooltip: 'keyboard.tooltip.command',\r\n        // For the command keyboard, perform a command rather than\r\n        // doing a simple layer switch, as we want to enter command mode\r\n        // when the keyboard is activated\r\n        command: 'enterCommandMode',\r\n        label: `<svg><use xlink:href='#svg-command' /></svg>`,\r\n        layers: ['lower-command', 'upper-command', 'symbols-command'],\r\n    },\r\n    style: {\r\n        tooltip: 'keyboard.tooltip.style',\r\n        layer: 'style',\r\n        label: '<b>b</b><i>i</i>',\r\n    },\r\n};\r\n\r\nconst SHIFTED_KEYS = {\r\n    '\\\\varphi ': ['&Phi;', '\\\\Phi '],\r\n    '\\\\varsigma ': ['&Sigma;', '\\\\Sigma '],\r\n    '\\\\epsilon ': ['&#x0190;', '{\\\\char\"0190}'],\r\n    '\\\\rho ': ['&#x3A1', '{\\\\char\"3A1}'],\r\n    '\\\\tau ': ['&#x3A4;', '{\\\\char\"3A4}'],\r\n    '\\\\upsilon ': ['&Upsilon;', '\\\\Upsilon '],\r\n    '\\\\theta ': ['&Theta;', '\\\\Theta '],\r\n    '\\\\iota ': ['&Iota;', '{\\\\char\"399}'],\r\n    '\\\\omicron ': ['&#x039F;', '{\\\\char\"39F}'],\r\n    '\\\\pi ': ['&Pi;', '\\\\Pi '],\r\n    '\\\\alpha ': ['&Alpha;', '{\\\\char\"391}'],\r\n    '\\\\sigma ': ['&Sigma;', '\\\\Sigma '],\r\n    '\\\\delta ': ['&Delta;', '\\\\Delta '],\r\n    '\\\\phi ': ['&#x03a6;', '\\\\Phi '],\r\n    '\\\\gamma ': ['&Gamma;', '\\\\Gamma '],\r\n    '\\\\eta ': ['&Eta;', '{\\\\char\"397}'],\r\n    '\\\\xi ': ['&Xi;', '\\\\Xi '],\r\n    '\\\\kappa ': ['&Kappa;', '{\\\\char\"39A}'],\r\n    '\\\\lambda ': ['&Lambda;', '\\\\Lambda '],\r\n    '\\\\zeta ': ['&Zeta;', '{\\\\char\"396}'],\r\n    '\\\\chi ': ['&Chi;', '{\\\\char\"3A7}'],\r\n    '\\\\psi ': ['&Psi;', '\\\\Psi '],\r\n    '\\\\omega ': ['&Omega;', '\\\\Omega '],\r\n    '\\\\beta ': ['&Beta;', '{\\\\char\"392}'],\r\n    '\\\\nu ': ['&Nu;', '{\\\\char\"39D}'],\r\n    '\\\\mu ': ['&Mu;', '{\\\\char\"39C}'],\r\n};\r\n\r\n// const FUNCTIONS = [\r\n//     'Basic',\r\n//         ['\\\\sin', '\\\\cos', '\\\\tan', '\\\\min', '\\\\max', '\\\\gcd', '\\\\lcm', '\\\\repeat', 'encapsulate', 'recognize'],\r\n//     'Operators',\r\n//         ['\\\\sum', '\\\\prod', '\\\\bigcup_x']\r\n// ]\r\nconst ALT_KEYS_BASE = {\r\n    '0': [\r\n        '\\\\emptyset',\r\n        '\\\\varnothing',\r\n        '\\\\infty',\r\n        { latex: '#?_0', insert: '#@_0' },\r\n        '\\\\circ',\r\n        '\\\\bigcirc',\r\n        '\\\\bullet',\r\n    ],\r\n    '2': ['\\\\frac{1}{2}', { latex: '#?^2', insert: '#@^2' }],\r\n    '3': ['\\\\frac{1}{3}', { latex: '#?^3', insert: '#@^3' }],\r\n    '.': [\r\n        ',',\r\n        ';',\r\n        '\\\\colon',\r\n        { latex: ':', aside: 'ratio' },\r\n        { latex: '\\\\cdotp', aside: 'center dot', classes: 'box' },\r\n        { latex: '\\\\cdots', aside: 'center ellipsis', classes: 'box' },\r\n        { latex: '\\\\ldotp', aside: 'low dot', classes: 'box' },\r\n        { latex: '\\\\ldots', aside: 'low ellipsis', classes: 'box' },\r\n        { latex: '\\\\vdots', aside: '', classes: 'box' },\r\n        { latex: '\\\\ddots', aside: '', classes: 'box' },\r\n        '\\\\odot',\r\n        '\\\\oslash',\r\n        '\\\\circledcirc',\r\n    ],\r\n\r\n    '*': [\r\n        '\\\\cdot',\r\n        '\\\\ast',\r\n        '\\\\star',\r\n        '\\\\bigstar',\r\n        '\\\\ltimes',\r\n        '\\\\rtimes',\r\n        '\\\\rightthreetimes',\r\n        '\\\\leftthreetimes',\r\n        '\\\\intercal',\r\n        '\\\\prod',\r\n        { latex: '\\\\prod_{n\\\\mathop=0}^{\\\\infty}', classes: 'small' },\r\n    ],\r\n\r\n    '+': [\r\n        '\\\\pm',\r\n        '\\\\mp',\r\n        '\\\\sum',\r\n        { latex: '\\\\sum_{n\\\\mathop=0}^{\\\\infty}', classes: 'small' },\r\n        '\\\\dotplus',\r\n        '\\\\oplus',\r\n    ],\r\n    '-': ['\\\\pm', '\\\\mp', '\\\\ominus', '\\\\vert #0  \\\\vert'],\r\n\r\n    '/': ['\\\\divideontimes', '/', '\\\\div'],\r\n\r\n    '(': [\r\n        '\\\\left( #0\\\\right)',\r\n        '\\\\left[ #0\\\\right]',\r\n        '\\\\left\\\\{ #0\\\\right\\\\}',\r\n        '\\\\left\\\\langle #0\\\\right\\\\rangle',\r\n        '\\\\lfloor',\r\n        '\\\\llcorner',\r\n        '(',\r\n        '\\\\lbrack',\r\n        '\\\\lvert',\r\n        '\\\\lVert',\r\n        '\\\\lgroup',\r\n        '\\\\langle',\r\n        '\\\\lceil',\r\n        '\\\\ulcorner',\r\n        '\\\\lmoustache',\r\n        '\\\\lbrace',\r\n    ],\r\n\r\n    ')': [\r\n        '\\\\rfloor',\r\n        '\\\\lrcorner',\r\n        ')',\r\n        '\\\\rbrack',\r\n        '\\\\rvert',\r\n        '\\\\rVert',\r\n        '\\\\rgroup',\r\n        '\\\\rangle',\r\n        '\\\\rceil',\r\n        '\\\\urcorner',\r\n        '\\\\rmoustache',\r\n        '\\\\rbrace',\r\n    ],\r\n\r\n    '=': [\r\n        '\\\\cong',\r\n        '\\\\asymp',\r\n        '\\\\equiv',\r\n        '\\\\differencedelta',\r\n        '\\\\varpropto',\r\n        '\\\\thickapprox',\r\n        '\\\\approxeq',\r\n        '\\\\thicksim',\r\n        '\\\\backsim',\r\n        '\\\\eqsim',\r\n        '\\\\simeq',\r\n        '\\\\Bumpeq',\r\n        '\\\\bumpeq',\r\n        '\\\\doteq',\r\n        '\\\\Doteq',\r\n        '\\\\fallingdotseq',\r\n        '\\\\risingdotseq',\r\n        '\\\\coloneq',\r\n        '\\\\eqcirc',\r\n        '\\\\circeq',\r\n        '\\\\triangleq',\r\n        '\\\\between',\r\n    ],\r\n\r\n    '!=': ['\\\\neq', '\\\\ncong', '', '\\\\nsim'],\r\n\r\n    '<': [\r\n        '\\\\leq',\r\n        '\\\\leqq',\r\n        '\\\\lneqq',\r\n        '\\\\ll',\r\n        '\\\\nless',\r\n        '\\\\nleq',\r\n        '\\\\precsim',\r\n        '\\\\lesssim',\r\n        '\\\\lessgtr',\r\n        '\\\\prec',\r\n        '\\\\preccurlyeq',\r\n        '\\\\lessdot',\r\n        '\\\\nprec',\r\n    ],\r\n\r\n    '>': [\r\n        '\\\\geq',\r\n        '\\\\geqq',\r\n        '\\\\gneqq',\r\n        '\\\\gg',\r\n        '\\\\ngtr',\r\n        '\\\\ngeq',\r\n        '\\\\succsim',\r\n        '\\\\gtrsim',\r\n        '\\\\gtrless',\r\n        '\\\\succ',\r\n        '\\\\succcurlyeq',\r\n        '\\\\gtrdot',\r\n        '\\\\nsucc',\r\n    ],\r\n\r\n    set: ['\\\\in', '\\\\owns', '\\\\subset', '\\\\nsubset', '\\\\supset', '\\\\nsupset'],\r\n\r\n    '!set': ['\\\\notin', '\\\\backepsilon'],\r\n\r\n    subset: [],\r\n    supset: [],\r\n\r\n    infinity: ['\\\\aleph_0', '\\\\aleph_1', '\\\\omega', '\\\\mathfrak{m}'],\r\n\r\n    'numeric-pi': ['\\\\prod', '\\\\theta', '\\\\rho', '\\\\sin', '\\\\cos', '\\\\tan'],\r\n\r\n    ee: ['\\\\times 10^{#?}', '\\\\ln', '\\\\ln_{10}', '\\\\log'],\r\n\r\n    '^': ['_{#?}'],\r\n\r\n    // Integrals\r\n    int: [\r\n        { latex: '\\\\int_{#?}^{#?}', classes: 'small' },\r\n        { latex: '\\\\int', classes: 'small' },\r\n        { latex: '\\\\smallint', classes: 'small' },\r\n        { latex: '\\\\iint', classes: 'small' },\r\n        { latex: '\\\\iiint', classes: 'small' },\r\n        { latex: '\\\\oint', classes: 'small' },\r\n        { latex: '\\\\dfrac{\\\\rd}{\\\\rd x}', classes: 'small' },\r\n        { latex: '\\\\frac{\\\\partial}{\\\\partial x}', classes: 'small' },\r\n\r\n        '\\\\capitalDifferentialD',\r\n        '\\\\rd',\r\n        '\\\\partial',\r\n    ],\r\n\r\n    nabla: ['\\\\nabla\\\\times', '\\\\nabla\\\\cdot', '\\\\nabla^{2}'],\r\n\r\n    '!': ['!!', '\\\\Gamma', '\\\\Pi'],\r\n    accents: [\r\n        '\\\\bar{#@}',\r\n        '\\\\vec{#@}',\r\n        '\\\\hat{#@}',\r\n        '\\\\check{#@}',\r\n        '\\\\dot{#@}',\r\n        '\\\\ddot{#@}',\r\n        '\\\\mathring{#@}',\r\n        '\\\\breve{#@}',\r\n        '\\\\acute{#@}',\r\n        '\\\\tilde{#@}',\r\n        '\\\\grave{#@}',\r\n    ],\r\n    // 'absnorm': [{latex:'\\\\lVert #@ \\\\rVert', aside:'norm'},\r\n    //     {latex:'\\\\lvert #@ \\\\rvert', aside:'determinant'},\r\n    //     {latex:'\\\\begin{cardinality} #@ \\\\end{cardinality}', aside:'cardinality'},\r\n    //     {latex:'\\\\lvert #@ \\\\rvert', aside:'length'},\r\n    //     {latex:'\\\\lvert #@ \\\\rvert', aside:'order'},\r\n\r\n    // ],\r\n    A: [\r\n        { latex: '\\\\aleph', aside: 'aleph' },\r\n        { latex: '\\\\forall', aside: 'for all' },\r\n    ],\r\n    a: [\r\n        { latex: '\\\\aleph', aside: 'aleph' },\r\n        { latex: '\\\\forall', aside: 'for all' },\r\n    ],\r\n    b: [{ latex: '\\\\beth', aside: 'beth' }],\r\n    B: [{ latex: '\\\\beth', aside: 'beth' }],\r\n    c: [{ latex: '\\\\C', aside: 'set of complex numbers' }],\r\n    d: [{ latex: '\\\\daleth', aside: 'daleth' }],\r\n    D: [{ latex: '\\\\daleth', aside: 'daleth' }],\r\n    e: [\r\n        { latex: '\\\\exponentialE', aside: 'exponential e' },\r\n        { latex: '\\\\exists', aside: 'there is' },\r\n        { latex: '\\\\nexists', aside: 'there isnt' },\r\n    ],\r\n    g: [{ latex: '\\\\gimel', aside: 'gimel' }],\r\n    G: [{ latex: '\\\\gimel', aside: 'gimel' }],\r\n    h: [\r\n        { latex: '\\\\hbar', aside: 'h bar' },\r\n        { latex: '\\\\hslash', aside: 'h slash' },\r\n    ],\r\n    i: [{ latex: '\\\\imaginaryI', aside: 'imaginary i' }],\r\n    j: [{ latex: '\\\\imaginaryJ', aside: 'imaginary j' }],\r\n    l: [{ latex: '\\\\ell', aside: 'ell' }],\r\n    n: [{ latex: '\\\\N', aside: 'set of natural numbers' }],\r\n    p: [{ latex: '\\\\P', aside: 'set of primes' }],\r\n    q: [{ latex: '\\\\Q', aside: 'set of rational numbers' }],\r\n    r: [{ latex: '\\\\R', aside: 'set of real numbers' }],\r\n    z: [{ latex: '\\\\Z', aside: 'set of integers' }],\r\n\r\n    'x-var': [\r\n        'y',\r\n        'z',\r\n        't',\r\n        'r',\r\n        { latex: 'f(#?)', classes: 'small' },\r\n        { latex: 'g(#?)', classes: 'small' },\r\n        'x^2',\r\n        'x^n',\r\n        'x_n',\r\n        'x_{n+1}',\r\n        'x_i',\r\n        'x_{i+1}',\r\n    ],\r\n    'n-var': ['i', 'j', 'p', 'k', 'a', 'u'],\r\n    ii: ['\\\\Re', '\\\\Im', '\\\\imaginaryJ', '\\\\Vert #0 \\\\Vert'],\r\n\r\n    logic: [\r\n        { latex: '\\\\exists', aside: 'there is' },\r\n        { latex: '\\\\nexists', aside: 'there isnt' },\r\n\r\n        { latex: '\\\\ni', aside: 'such that' },\r\n        { latex: '\\\\Colon', aside: 'such that' },\r\n\r\n        { latex: '\\\\implies', aside: 'implies' },\r\n        { latex: '\\\\impliedby', aside: 'implied by' },\r\n\r\n        { latex: '\\\\iff', aside: 'if and only if' },\r\n\r\n        { latex: '\\\\land', aside: 'and' },\r\n        { latex: '\\\\lor', aside: 'or' },\r\n        { latex: '\\\\oplus', aside: 'xor' },\r\n        { latex: '\\\\lnot', aside: 'not' },\r\n\r\n        { latex: '\\\\downarrow', aside: 'nor' },\r\n        { latex: '\\\\uparrow', aside: 'nand' },\r\n\r\n        { latex: '\\\\curlywedge', aside: 'nor' },\r\n        { latex: '\\\\bar\\\\curlywedge', aside: 'nand' },\r\n\r\n        // {latex:'\\\\barwedge', aside:'bar wedge'},\r\n        // {latex:'\\\\curlyvee', aside:'curly vee'},\r\n        // {latex:'\\\\veebar', aside:'vee bar'},\r\n\r\n        { latex: '\\\\therefore', aside: 'therefore' },\r\n        { latex: '\\\\because', aside: 'because' },\r\n\r\n        { latex: '^\\\\biconditional', aside: 'biconditional' },\r\n\r\n        '\\\\leftrightarrow',\r\n        '\\\\Leftrightarrow',\r\n        '\\\\to',\r\n        '\\\\models',\r\n        '\\\\vdash',\r\n        '\\\\gets',\r\n        '\\\\dashv',\r\n        '\\\\roundimplies',\r\n    ],\r\n\r\n    'set-operators': [\r\n        '\\\\cap',\r\n        '\\\\cup',\r\n        '\\\\setminus',\r\n        '\\\\smallsetminus',\r\n        '\\\\complement',\r\n    ],\r\n\r\n    'set-relations': [\r\n        '\\\\in',\r\n        '\\\\notin',\r\n        '\\\\ni',\r\n        '\\\\owns',\r\n        '\\\\subset',\r\n        '\\\\supset',\r\n        '\\\\subseteq',\r\n        '\\\\supseteq',\r\n        '\\\\subsetneq',\r\n        '\\\\supsetneq',\r\n        '\\\\varsubsetneq',\r\n        '\\\\subsetneqq',\r\n        '\\\\nsubset',\r\n        '\\\\nsupset',\r\n        '\\\\nsubseteq',\r\n        '\\\\nsupseteq',\r\n    ],\r\n\r\n    space: [\r\n        {\r\n            latex: '\\\\char\"203A\\\\!\\\\char\"2039',\r\n            insert: '\\\\!',\r\n            aside: 'negative thin space<br> em',\r\n        },\r\n        {\r\n            latex: '\\\\unicode{\"203A}\\\\,\\\\unicode{\"2039}',\r\n            insert: '\\\\,',\r\n            aside: 'thin space<br> em',\r\n        },\r\n        {\r\n            latex: '\\\\unicode{\"203A}\\\\:\\\\unicode{\"2039}',\r\n            insert: '\\\\:',\r\n            aside: 'medium space<br> em',\r\n        },\r\n        {\r\n            latex: '\\\\unicode{\"203A}\\\\;\\\\unicode{\"2039}',\r\n            insert: '\\\\;',\r\n            aside: 'thick space<br> em',\r\n        },\r\n        {\r\n            latex: '\\\\unicode{\"203A}\\\\ \\\\unicode{\"2039}',\r\n            insert: '\\\\ ',\r\n            aside: ' em',\r\n        },\r\n        {\r\n            latex: '\\\\unicode{\"203A}\\\\enspace\\\\unicode{\"2039}',\r\n            insert: '\\\\enspace',\r\n            aside: ' em',\r\n        },\r\n        {\r\n            latex: '\\\\unicode{\"203A}\\\\quad\\\\unicode{\"2039}',\r\n            insert: '\\\\quad',\r\n            aside: '1 em',\r\n        },\r\n        {\r\n            latex: '\\\\unicode{\"203A}\\\\qquad\\\\unicode{\"2039}',\r\n            insert: '\\\\qquad',\r\n            aside: '2 em',\r\n        },\r\n    ],\r\n\r\n    // @todo could also delete to end\r\n    delete: [\r\n        {\r\n            label:\r\n                '<span class=\"warning\"><svg><use xlink:href=\"#svg-trash\" /></svg></span>',\r\n            command: '\"deleteAll\"',\r\n        },\r\n    ],\r\n\r\n    // @todo Tab: could turn on speech, visible keyboard...\r\n    '->|': [],\r\n};\r\nlet ALT_KEYS = {};\r\n\r\nconst LAYERS = {\r\n    math: `\r\n        <div class='rows'>\r\n            <ul>\r\n                <li class='keycap tex' data-alt-keys='x-var'><i>x</i></li>\r\n                <li class='keycap tex' data-alt-keys='n-var'><i>n</i></li>\r\n                <li class='separator w5'></li>\r\n                <row name='numpad-1'/>\r\n                <li class='separator w5'></li>\r\n                <li class='keycap tex' data-insert='$$\\\\exponentialE$$' data-alt-keys='ee'>e</li>\r\n                <li class='keycap tex' data-insert='$$\\\\imaginaryI$$' data-alt-keys='ii'>i</li>\r\n                <li class='keycap tex' data-latex='\\\\pi' data-alt-keys='numeric-pi'></li>\r\n            </ul>\r\n            <ul>\r\n                <li class='keycap tex' data-key='<' data-alt-keys='<'>&lt;</li>\r\n                <li class='keycap tex' data-key='>' data-alt-keys='>'>&gt;</li>\r\n                <li class='separator w5'></li>\r\n                <row name='numpad-2'/>\r\n                <li class='separator w5'></li>\r\n                <li class='keycap tex' data-alt-keys='x2' data-insert='$$#@^{2}$$'><span><i>x</i>&thinsp;</span></li>\r\n                <li class='keycap tex' data-alt-keys='^' data-insert='$$#@^{#?}$$'><span><i>x</i><sup>&thinsp;<small>&#x2b1a;</small></sup></span></li>\r\n                <li class='keycap tex' data-alt-keys='sqrt' data-insert='$$\\\\sqrt{#0}$$' data-latex='\\\\sqrt{#0}'></li>\r\n            </ul>\r\n            <ul>\r\n                <li class='keycap tex' data-alt-keys='(' >(</li>\r\n                <li class='keycap tex' data-alt-keys=')' >)</li>\r\n                <li class='separator w5'></li>\r\n                <row name='numpad-3'/>\r\n                <li class='separator w5'></li>\r\n                <li class='keycap tex small' data-alt-keys='int' data-latex='\\\\int_0^\\\\infty'><span></span></li>\r\n                <li class='keycap tex' data-latex='\\\\forall' data-alt-keys='logic' ></li>\r\n                <li class='action font-glyph bottom right' data-alt-keys='delete' data-command='[\"performWithFeedback\",\"deleteBackward\"]'>&#x232b;</li></ul>\r\n            </ul>\r\n            <ul>\r\n                <li class='keycap' data-alt-keys='foreground-color' data-command='[\"applyStyle\",{\"color\":\"#cc2428\"}]'><span style='border-radius: 50%;width:22px;height:22px; border: 3px solid #cc2428; box-sizing: border-box'></span></li>\r\n                <li class='keycap' data-alt-keys='background-color' data-command='[\"applyStyle\",{\"backgroundColor\":\"#fff590\"}]'><span style='border-radius: 50%;width:22px;height:22px; background:#fff590; box-sizing: border-box'></span></li>\r\n                <li class='separator w5'></li>\r\n                <row name='numpad-4'/>\r\n                <li class='separator w5'></li>\r\n                <arrows/>\r\n            </ul>\r\n        </div>\r\n    `,\r\n    'lower-roman': `\r\n        <div class='rows'>\r\n            <ul>\r\n                <row name='numpad-1' class='if-wide'/>\r\n                <row name='lower-1' shift-layer='upper-roman'/>\r\n            </ul>\r\n            <ul>\r\n                <row name='numpad-2' class='if-wide'/>\r\n                <row name='lower-2'  shift-layer='upper-roman''/>\r\n            </ul>\r\n            <ul>\r\n                <row name='numpad-3' class='if-wide'/>\r\n                <row name='lower-3'  shift-layer='upper-roman''/>\r\n            </ul>\r\n            <ul>\r\n                <row name='numpad-4' class='if-wide'/>\r\n                <li class='keycap' >;</li>\r\n                <li class='keycap' data-alt-keys=','>,</li>\r\n                <li class='keycap w50' data-key=' ' data-alt-keys='space'>&nbsp;</li>\r\n                <arrows/>\r\n            </ul>\r\n        </div>`,\r\n    'upper-roman': `\r\n        <div class='rows'>\r\n            <ul>\r\n                <row name='numpad-1' class='if-wide'/>\r\n                <row name='upper-1'  shift-layer='lower-roman'/>\r\n            </ul>\r\n            <ul>\r\n                <row name='numpad-2' class='if-wide'/>\r\n                <row name='upper-2' shift-layer='lower-roman'/>\r\n            </ul>\r\n            <ul>\r\n                <row name='numpad-3' class='if-wide'/>\r\n                <row name='upper-3' shift-layer='lower-roman'/>\r\n            </ul>\r\n            <ul>\r\n                <row name='numpad-4' class='if-wide'/>\r\n                <li class='keycap' >;</li>\r\n                <li class='keycap' data-alt-keys='.'>;</li>\r\n                <li class='keycap w50' data-key=' '>&nbsp;</li>\r\n                <arrows/>\r\n            </ul>\r\n        </div>`,\r\n    symbols: `\r\n        <div class='rows'>\r\n            <ul>\r\n                <row name='numpad-1' class='if-wide'/>\r\n                <li class='keycap tex' data-alt-keys='(' data-insert='\\\\lbrace '>{</li>\r\n                <li class='keycap tex' data-alt-keys=')' data-insert='\\\\rbrace '>}</li>\r\n                <li class='separator w5'></li>\r\n                <li class='keycap tex' data-alt-keys='set' data-insert='\\\\in '>&#x2208;</li>\r\n                <li class='keycap tex' data-alt-keys='!set' data-insert='\\\\notin '>&#x2209;</li>\r\n                <li class='keycap tex' data-insert='\\\\Re '>&#x211c;<aside>Real</aside></li>\r\n                <li class='keycap tex' data-insert='\\\\Im '>&#x2111;<aside>Imaginary</aside></li>\r\n                <li class='keycap w15' data-insert='\\\\ulcorner#0\\\\urcorner '><span><sup>&#x250c;</sup><span><span style='color:#ddd'>o</span><sup>&#x2510;</sup></span><aside>ceil</aside></li>\r\n                <li class='keycap tex' data-alt-keys='nabla' data-insert='\\\\nabla '>&#x2207;<aside>nabla</aside></li>\r\n                <li class='keycap tex' data-alt-keys='infinity' data-insert='\\\\infty '>&#x221e;</li>\r\n\r\n            </ul>\r\n            <ul>\r\n                <row name='numpad-2' class='if-wide'/>\r\n                <li class='keycap tex' data-alt-keys='(' data-insert='\\\\lbrack '>[</li>\r\n                <li class='keycap tex' data-alt-keys=')' data-insert='\\\\rbrack '>]</li>\r\n                <li class='separator w5'></li>\r\n                <li class='keycap tex' data-alt-keys='subset' data-insert='\\\\subset '>&#x2282;</li>\r\n                <li class='keycap tex' data-alt-keys='supset' data-insert='\\\\supset '>&#x2283;</li>\r\n                <li class='keycap tex' data-key='!' data-alt-keys='!'>!<aside>factorial</aside></li>\r\n                <li class='keycap' data-insert='$$^{\\\\prime} $$'><span><sup><span><span style='color:#ddd'>o</span>&#x2032</sup></span><aside>prime</aside></li>\r\n                <li class='keycap w15' data-insert='\\\\llcorner#0\\\\lrcorner '><span><sub>&#x2514;</sub><span style='color:#ddd'>o</span><sub>&#x2518;</sub></span><aside>floor</aside></li>\r\n                <li class='keycap tex' data-insert='\\\\partial '>&#x2202;<aside>partial<br>derivative</aside></li>\r\n                <li class='keycap tex' data-insert='\\\\emptyset '>&#x2205;<aside>empty set</aside></li>\r\n\r\n            </ul>\r\n            <ul>\r\n                <row name='numpad-3' class='if-wide'/>\r\n                <li class='keycap tex' data-alt-keys='(' data-insert='\\\\langle '>&#x27e8;</li>\r\n                <li class='keycap tex' data-alt-keys=')' data-insert='\\\\rangle '>&#x27e9;</li>\r\n                <li class='separator w5'></li>\r\n                <li class='keycap tex' data-insert='\\\\subseteq '>&#x2286;</li>\r\n                <li class='keycap tex' data-insert='\\\\supseteq '>&#x2287;</li>\r\n                <li class='keycap tex' data-alt-keys='accents' data-insert='$$\\\\vec{#@}$$' data-latex='\\\\vec{#?}' data-aside='vector'></li>\r\n                <li class='keycap tex' data-alt-keys='accents' data-insert='$$\\\\bar{#@}$$' data-latex='\\\\bar{#?}' data-aside='bar'></li>\r\n                <li class='keycap tex' data-alt-keys='absnorm' data-insert='$$\\\\left| #0 \\\\right|$$' data-latex='\\\\left| #? \\\\right|' data-aside='abs'></li>\r\n                <li class='keycap tex' data-insert='\\\\ast '>&#x2217;<aside>asterisk</aside></li>\r\n\r\n                <li class='action font-glyph bottom right w15'\r\n                    data-shifted='<span class=\"warning\"><svg><use xlink:href=\"#svg-trash\" /></svg></span>'\r\n                    data-shifted-command='\"deleteAll\"'\r\n                    data-alt-keys='delete' data-command='[\"performWithFeedback\",\"deleteBackward\"]'\r\n                >&#x232b;</li>\r\n            </ul>\r\n            <ul>\r\n                <row name='numpad-4' class='if-wide'/>\r\n                <li class='keycap tex' data-insert=','>,</li>\r\n                <li class='keycap tex' data-insert='\\\\cdot '>&#x22c5;<aside>centered dot</aside></li>\r\n                <li class='keycap tex' data-insert='\\\\colon '>:<aside>colon</aside></li>\r\n                <li class='keycap tex' data-insert='\\\\circ '>&#x2218;<aside>circle</aside></li>\r\n                <li class='keycap tex' data-insert='\\\\approx '>&#x2248;<aside>approx.</aside></li>\r\n                <li class='keycap tex' data-insert='\\\\ne '>&#x2260;</li>\r\n                <li class='keycap tex' data-insert='\\\\pm '>&#x00b1;</li>\r\n                <arrows/>\r\n            </ul>\r\n        </div>`,\r\n    'lower-greek': `\r\n        <div class='rows'>\r\n            <ul><li class='keycap tex' data-insert='\\\\varphi '><i>&#x03c6;</i><aside>phi var.</aside></li>\r\n                <li class='keycap tex' data-insert='\\\\varsigma '><i>&#x03c2;</i><aside>sigma var.</aside></li>\r\n                <li class='keycap tex' data-insert='\\\\epsilon '><i>&#x03f5;</i></li>\r\n                <li class='keycap tex' data-insert='\\\\rho '><i>&rho;</i></li>\r\n                <li class='keycap tex' data-insert='\\\\tau '><i>&tau;</i></li>\r\n                <li class='keycap tex' data-insert='\\\\upsilon '><i>&upsilon;</i></li>\r\n                <li class='keycap tex' data-insert='\\\\theta '><i>&theta;</i></li>\r\n                <li class='keycap tex' data-insert='\\\\iota '><i>&iota;</i></li>\r\n                <li class='keycap tex' data-insert='\\\\omicron '>&omicron;</i></li>\r\n                <li class='keycap tex' data-insert='\\\\pi '><i>&pi;</i></li>\r\n            </ul>\r\n            <ul><li class='keycap tex' data-insert='\\\\alpha ' data-shifted='&Alpha;' data-shifted-command='[\"insert\",\"{\\\\\\\\char\\\\\"391}\"]'><i>&alpha;</i></li>\r\n                <li class='keycap tex' data-insert='\\\\sigma '><i>&sigma;</i></li>\r\n                <li class='keycap tex' data-insert='\\\\delta '><i>&delta;</i></li>\r\n                <li class='keycap tex' data-insert='\\\\phi '><i>&#x03d5;</i></i></li>\r\n                <li class='keycap tex' data-insert='\\\\gamma '><i>&gamma;</i></li>\r\n                <li class='keycap tex' data-insert='\\\\eta '><i>&eta;</i></li>\r\n                <li class='keycap tex' data-insert='\\\\xi '><i>&xi;</i></li>\r\n                <li class='keycap tex' data-insert='\\\\kappa '><i>&kappa;</i></li>\r\n                <li class='keycap tex' data-insert='\\\\lambda '><i>&lambda;</i></li>\r\n            </ul>\r\n            <ul><li class='shift modifier font-glyph bottom left w15 layer-switch' data-layer='upper-greek'>&#x21e7;</li>\r\n                <li class='keycap tex' data-insert='\\\\zeta '><i>&zeta;</i></li>\r\n                <li class='keycap tex' data-insert='\\\\chi '><i>&chi;</i></li>\r\n                <li class='keycap tex' data-insert='\\\\psi '><i>&psi;</i></li>\r\n                <li class='keycap tex' data-insert='\\\\omega '><i>&omega;</i></li>\r\n                <li class='keycap tex' data-insert='\\\\beta '><i>&beta;</i></li>\r\n                <li class='keycap tex' data-insert='\\\\nu '><i>&nu;</i></li>\r\n                <li class='keycap tex' data-insert='\\\\mu '><i>&mu;</i></li>\r\n                <li class='action font-glyph bottom right w15'\r\n                    data-shifted='<span class=\"warning\"><svg><use xlink:href=\"#svg-trash\" /></svg></span>'\r\n                    data-shifted-command='\"deleteAll\"'\r\n                    data-alt-keys='delete' data-command='[\"performWithFeedback\",\"deleteBackward\"]'\r\n                >&#x232b;</li>\r\n            </ul>\r\n            <ul>\r\n                <li class='keycap ' data-key=' '>&nbsp;</li>\r\n                <li class='keycap'>,</li>\r\n                <li class='keycap tex' data-insert='\\\\varepsilon '><i>&#x03b5;</i><aside>epsilon var.</aside></li>\r\n                <li class='keycap tex' data-insert='\\\\vartheta '><i>&#x03d1;</i><aside>theta var.</aside></li>\r\n                <li class='keycap tex' data-insert='\\\\varkappa '><i>&#x3f0;</i><aside>kappa var.</aside></li>\r\n                <li class='keycap tex' data-insert='\\\\varpi '><i>&#x03d6;<aside>pi var.</aside></i></li>\r\n                <li class='keycap tex' data-insert='\\\\varrho '><i>&#x03f1;</i><aside>rho var.</aside></li>\r\n                <arrows/>\r\n            </ul>\r\n        </div>`,\r\n    'upper-greek': `\r\n        <div class='rows'>\r\n            <ul><li class='keycap tex' data-insert='\\\\Phi '>&Phi;<aside>phi</aside></li>\r\n                <li class='keycap tex' data-insert='\\\\Sigma '>&Sigma;<aside>sigma</aside></li>\r\n                <li class='keycap tex' data-insert='{\\\\char\"0190}'>&#x0190;<aside>epsilon</aside></li>\r\n                <li class='keycap tex' data-insert='{\\\\char\"3A1}'>&#x3A1;<aside>rho</aside></li>\r\n                <li class='keycap tex' data-insert='{\\\\char\"3A4}'>&#x3A4;<aside>tau</aside></li>\r\n                <li class='keycap tex' data-insert='\\\\Upsilon '>&Upsilon;<aside>upsilon</aside></li>\r\n                <li class='keycap tex' data-insert='\\\\Theta '>&Theta;<aside>theta</aside></li>\r\n                <li class='keycap tex' data-insert='{\\\\char\"399}'>&Iota;<aside>iota</aside></li>\r\n                <li class='keycap tex' data-insert='{\\\\char\"39F}'>&#x039F;<aside>omicron</aside></li>\r\n                <li class='keycap tex' data-insert='\\\\Pi '>&Pi;<aside>pi</aside></li></ul>\r\n            <ul><li class='keycap tex' data-insert='{\\\\char\"391}'>&#x391;<aside>alpha</aside></li>\r\n                <li class='keycap tex' data-insert='\\\\Sigma '>&Sigma;<aside>sigma</aside></li>\r\n                <li class='keycap tex' data-insert='\\\\Delta '>&Delta;<aside>delta</aside></li>\r\n                <li class='keycap tex' data-insert='\\\\Phi '>&#x03a6;<aside>phi</aside></li>\r\n                <li class='keycap tex' data-insert='\\\\Gamma '>&Gamma;<aside>gamma</aside></li>\r\n                <li class='keycap tex' data-insert='{\\\\char\"397}'>&Eta;<aside>eta</aside></li>\r\n                <li class='keycap tex' data-insert='\\\\Xi '>&Xi;<aside>xi</aside></li>\r\n                <li class='keycap tex' data-insert='{\\\\char\"39A}'>&Kappa;<aside>kappa</aside></li>\r\n                <li class='keycap tex' data-insert='\\\\Lambda '>&Lambda;<aside>lambda</aside></li></ul>\r\n            <ul><li class='shift modifier font-glyph bottom left selected w15 layer-switch' data-layer='lower-greek'>&#x21e7;</li>\r\n                <li class='keycap tex' data-insert='{\\\\char\"396}'>&Zeta;<aside>zeta</aside></li>\r\n                <li class='keycap tex' data-insert='{\\\\char\"3A7}'>&Chi;<aside>chi</aside></li>\r\n                <li class='keycap tex' data-insert='\\\\Psi '>&Psi;<aside>psi</aside></li>\r\n                <li class='keycap tex' data-insert='\\\\Omega '>&Omega;<aside>omega</aside></li>\r\n                <li class='keycap tex' data-insert='{\\\\char\"392}'>&Beta;<aside>beta</aside></li>\r\n                <li class='keycap tex' data-insert='{\\\\char\"39D}'>&Nu;<aside>nu</aside></li>\r\n                <li class='keycap tex' data-insert='{\\\\char\"39C}'>&Mu;<aside>mu</aside></li>\r\n                <li class='action font-glyph bottom right w15' data-command='[\"performWithFeedback\",\"deleteBackward\"]'>&#x232b;</li></ul>\r\n            <ul>\r\n                <li class='separator w10'>&nbsp;</li>\r\n                <li class='keycap'>.</li>\r\n                <li class='keycap w50' data-key=' '>&nbsp;</li>\r\n                <arrows/>\r\n            </ul>\r\n        </div>`,\r\n    'lower-command': `\r\n        <div class='rows'>\r\n            <ul><row name='lower-1' class='tt' shift-layer='upper-command'/></ul>\r\n            <ul><row name='lower-2' class='tt' shift-layer='upper-command'/></ul>\r\n            <ul><row name='lower-3' class='tt' shift-layer='upper-command'/></ul>\r\n            <ul>\r\n                <li class='layer-switch font-glyph modifier bottom left' data-layer='symbols-command'>01#</li>\r\n                <li class='keycap tt' data-shifted='[' data-shifted-command='[\"insertAndUnshiftKeyboardLayer\", \"[\"]'>{</li>\r\n                <li class='keycap tt' data-shifted=']' data-shifted-command='[\"insertAndUnshiftKeyboardLayer\", \"]\"]'>}</li>\r\n                <li class='keycap tt' data-shifted='(' data-shifted-command='[\"insertAndUnshiftKeyboardLayer\", \"(\"]'>^</li>\r\n                <li class='keycap tt' data-shifted=')' data-shifted-command='[\"insertAndUnshiftKeyboardLayer\", \")\"]'>_</li>\r\n                <li class='keycap w20' data-key=' '>&nbsp;</li>\r\n                <arrows/>\r\n            </ul>\r\n        </div>`,\r\n    'upper-command': `\r\n        <div class='rows'>\r\n            <ul><row name='upper-1' class='tt' shift-layer='lower-command'/></ul>\r\n            <ul><row name='upper-2' class='tt' shift-layer='lower-command'/></ul>\r\n            <ul><row name='upper-3' class='tt' shift-layer='lower-command'/></ul>\r\n            <ul>\r\n                <li class='layer-switch font-glyph modifier bottom left' data-layer='symbols-command'01#</li>\r\n                <li class='keycap tt'>[</li>\r\n                <li class='keycap tt'>]</li>\r\n                <li class='keycap tt'>(</li>\r\n                <li class='keycap tt'>)</li>\r\n                <li class='keycap w20' data-key=' '>&nbsp;</li>\r\n                <arrows/>\r\n            </ul>\r\n        </div>`,\r\n    'symbols-command': `\r\n        <div class='rows'>\r\n            <ul><li class='keycap tt'>1</li><li class='keycap tt'>2</li><li class='keycap tt'>3</li><li class='keycap tt'>4</li><li class='keycap tt'>5</li><li class='keycap tt'>6</li><li class='keycap tt'>7</li><li class='keycap tt'>8</li><li class='keycap tt'>9</li><li class='keycap tt'>0</li></ul>\r\n            <ul><li class='keycap tt'>!</li><li class='keycap tt'>@</li><li class='keycap tt'>#</li><li class='keycap tt'>$</li><li class='keycap tt'>%</li><li class='keycap tt'>^</li><li class='keycap tt'>&</li><li class='keycap tt'>*</li><li class='keycap tt'>+</li><li class='keycap tt'>=</li></ul>\r\n            <ul>\r\n                <li class='keycap tt'>\\\\</li>\r\n                <li class='keycap tt'>|</li>\r\n                <li class='keycap tt'>/</li>\r\n                <li class='keycap tt'>\\`</li>\r\n                <li class='keycap tt'>;</li>\r\n                <li class='keycap tt'>:</li>\r\n                <li class='keycap tt'>?</li>\r\n                <li class='keycap tt'>'</li>\r\n                <li class='keycap tt'>\"</li>\r\n                <li class='action font-glyph bottom right'\r\n                    data-shifted='<span class=\"warning\"><svg><use xlink:href=\"#svg-trash\" /></svg></span>'\r\n                    data-shifted-command='\"deleteAll\"'\r\n                    data-alt-keys='delete' data-command='[\"performWithFeedback\",\"deleteBackward\"]'\r\n                >&#x232b;</li>\r\n            </ul>\r\n            <ul>\r\n                <li class='layer-switch font-glyph modifier bottom left' data-layer='lower-command'>abc</li>\r\n                <li class='keycap tt'>&lt;</li>\r\n                <li class='keycap tt'>&gt;</li>\r\n                <li class='keycap tt'>~</li>\r\n                <li class='keycap tt'>,</li>\r\n                <li class='keycap tt'>.</li>\r\n                <li class='keycap' data-key=' '>&nbsp;</li>\r\n                <arrows/>\r\n            </ul>\r\n        </div>`,\r\n    functions: `\r\n        <div class='rows'>\r\n            <ul><li class='separator'></li>\r\n                <li class='fnbutton' data-insert='\\\\sin'></li>\r\n                <li class='fnbutton' data-insert='\\\\sin^{-1}'></li>\r\n                <li class='fnbutton' data-insert='\\\\ln'></li>\r\n                <li class='fnbutton' data-insert='\\\\exponentialE^{#?}'></li>\r\n                <li class='bigfnbutton' data-insert='$$\\\\operatorname{lcm}(#?)$$' data-latex='\\\\operatorname{lcm}()'></li>\r\n                <li class='bigfnbutton' data-insert='$$\\\\operatorname{ceil}(#?)$$' data-latex='\\\\operatorname{ceil}()'></li>\r\n                <li class='bigfnbutton' data-insert='$$\\\\lim_{n\\\\to\\\\infty}$$'></li>\r\n                <li class='bigfnbutton' data-insert='$$\\\\int$$'></li>\r\n                <li class='bigfnbutton' data-insert='$$\\\\operatorname{abs}(#?)$$' data-latex='\\\\operatorname{abs}()'></li>\r\n            </ul>\r\n            <ul><li class='separator'></li>\r\n                <li class='fnbutton' data-insert='\\\\cos'></li>\r\n                <li class='fnbutton' data-insert='\\\\cos^{-1}'></li>\r\n                <li class='fnbutton' data-insert='\\\\ln_{10}'></li>\r\n                <li class='fnbutton' data-insert='$$10^{#?}$$'></li>\r\n                <li class='bigfnbutton' data-insert='$$\\\\operatorname{gcd}(#?)$$' data-latex='\\\\operatorname{gcd}()'></li>\r\n                <li class='bigfnbutton' data-insert='$$\\\\operatorname{floor}(#?)$$' data-latex='\\\\operatorname{floor}()'></li>\r\n                <li class='bigfnbutton' data-insert='$$\\\\sum_{n\\\\mathop=0}^{\\\\infty}$$'></li>\r\n                <li class='bigfnbutton' data-insert='$$\\\\int_{0}^{\\\\infty}$$'></li>\r\n                <li class='bigfnbutton' data-insert='$$\\\\operatorname{sign}(#?)$$' data-latex='\\\\operatorname{sign}()'></li>\r\n            </ul>\r\n            <ul><li class='separator'></li>\r\n                <li class='fnbutton' data-insert='\\\\tan'></li>\r\n                <li class='fnbutton' data-insert='\\\\tan^{-1}'></li>\r\n                <li class='fnbutton' data-insert='$$\\\\log_{#?}$$'></li>\r\n                <li class='fnbutton' data-insert='$$\\\\sqrt[#?]{#0}$$'></li>\r\n                <li class='bigfnbutton' data-insert='$$#0 \\\\mod$$' data-latex='\\\\mod'></li>\r\n                <li class='bigfnbutton' data-insert='$$\\\\operatorname{round}(#?) $$' data-latex='\\\\operatorname{round}()'></li>\r\n                <li class='bigfnbutton' data-insert='$$\\\\prod_{n\\\\mathop=0}^{\\\\infty}$$' data-latex='{\\\\scriptstyle \\\\prod_{n=0}^{\\\\infty}}'></li>\r\n                <li class='bigfnbutton' data-insert='$$\\\\frac{\\\\differentialD #0}{\\\\differentialD x}$$'></li>\r\n                <li class='action font-glyph bottom right' data-command='[\"performWithFeedback\",\"deleteBackward\"]'>&#x232b;</li></ul>\r\n            <ul><li class='separator'></li>\r\n                <li class='fnbutton'>(</li>\r\n                <li class='fnbutton'>)</li>\r\n                <li class='fnbutton' data-insert='$$^{#?} $$' data-latex='x^{#?} '></li>\r\n                <li class='fnbutton' data-insert='$$_{#?} $$' data-latex='x_{#?} '></li>\r\n                <li class='keycap w20 ' data-key=' '>&nbsp;</li>\r\n                <arrows/>\r\n            </ul>\r\n        </div>`,\r\n    style: `\r\n        <div class='rows'>\r\n            <ul>\r\n                <li class='keycap' data-alt-keys='foreground-color' data-command='[\"applyStyle\",{\"color\":\"#cc2428\"}]'><span style='border-radius: 50%;width:22px;height:22px; border: 3px solid #cc2428'></span></li>\r\n                <li class='keycap' data-alt-keys='background-color' data-command='[\"applyStyle\",{\"backgroundColor\":\"#fff590\"}]'><span style='border-radius: 50%;width:22px;height:22px; background:#fff590'></span></li>\r\n                <li class='separator w5'></li>\r\n                <li class='keycap' data-command='[\"applyStyle\",{\"size\":\"size3\"}]' data-latex='\\\\scriptsize\\\\text{small}'></li>\r\n                <li class='keycap' data-command='[\"applyStyle\",{\"size\":\"size5\"}]' data-latex='\\\\scriptsize\\\\text{normal}'></li>\r\n                <li class='keycap' data-command='[\"applyStyle\",{\"size\":\"size9\"}]' data-latex='\\\\huge\\\\text{big}'></li>\r\n                <li class='separator w5'></li>\r\n                <li class='keycap' data-latex='\\\\langle' data-command='[\"insert\", \"\\\\\\\\langle\", {\"smartFence\":true}]'></li>\r\n            </ul>\r\n            <ul>\r\n                <li class='keycap' data-command='[\"applyStyle\",{\"series\":\"l\"}]' data-latex='\\\\fontseries{l}\\\\text{Ab}'></li>\r\n                <li class='keycap' data-command='[\"applyStyle\",{\"series\":\"m\"}]' data-latex='\\\\fontseries{m}\\\\text{Ab}'></li>\r\n                <li class='keycap' data-command='[\"applyStyle\",{\"series\":\"b\"}]' data-latex='\\\\fontseries{b}\\\\text{Ab}'></li>\r\n                <li class='keycap' data-command='[\"applyStyle\",{\"series\":\"bx\"}]' data-latex='\\\\fontseries{bx}\\\\text{Ab}'></li>\r\n                <li class='keycap' data-command='[\"applyStyle\",{\"series\":\"sb\"}]' data-latex='\\\\fontseries{sb}\\\\text{Ab}'></li>\r\n                <li class='keycap' data-command='[\"applyStyle\",{\"series\":\"c\"}]' data-latex='\\\\fontseries{c}\\\\text{Ab}'></li>\r\n            </ul>\r\n            <ul>\r\n                <li class='keycap' data-command='[\"applyStyle\",{\"shape\":\"up\"}]' data-latex='\\\\textup{Ab}'></li>\r\n                <li class='keycap' data-command='[\"applyStyle\",{\"shape\":\"it\"}]' data-latex='\\\\textit{Ab}'></li>\r\n                <li class='keycap' data-command='[\"applyStyle\",{\"shape\":\"sl\"}]' data-latex='\\\\textsl{Ab}'></li>\r\n                <li class='keycap' data-command='[\"applyStyle\",{\"shape\":\"sc\"}]' data-latex='\\\\textsc{Ab}'></li>\r\n                <li class='separator w5'></li>\r\n                <li class='keycap' data-insert='$$\\\\emph{#?} $$' data-latex='\\\\text{\\\\emph{emph}}'></li>\r\n            </ul>\r\n            <ul>\r\n                <li class='keycap' data-command='[\"applyStyle\",{\"fontFamily\":\"cmr\"}]' data-latex='\\\\textrm{Az}'></li>\r\n                <li class='keycap' data-command='[\"applyStyle\",{\"fontFamily\":\"cmtt\"}]' data-latex='\\\\texttt{Az}'></li>\r\n                <li class='keycap' data-command='[\"applyStyle\",{\"fontFamily\":\"cmss\"}]' data-latex='\\\\textsf{Az}'></li>\r\n\r\n                <li class='keycap' data-command='[\"applyStyle\",{\"fontFamily\":\"bb\"}]'  data-latex='\\\\mathbb{AZ}'></li>\r\n                <li class='keycap' data-command='[\"applyStyle\",{\"fontFamily\":\"scr\"}]'  data-latex='\\\\mathscr{AZ}'></li>\r\n                <li class='keycap' data-command='[\"applyStyle\",{\"fontFamily\":\"cal\"}]' data-latex='\\\\mathcal{A1}'></li>\r\n                <li class='keycap' data-command='[\"applyStyle\",{\"fontFamily\":\"frak\"}]' data-latex='\\\\mathfrak{Az}'></li>\r\n            </ul>\r\n        </div>`,\r\n};\r\n\r\nfunction latexToMarkup(latex: string, arg, mf: MathfieldPrivate): string {\r\n    // Since we don't have preceding atoms, we'll interpret #@ as a placeholder\r\n    latex = latex.replace(/(^|[^\\\\])#@/g, '$1#?');\r\n\r\n    return makeStruts(\r\n        makeSpan(\r\n            Atom.render(\r\n                {\r\n                    mathstyle: MATHSTYLES.displaystyle,\r\n                    macros: mf.options.macros,\r\n                },\r\n                parseString(latex, 'math', arg, mf.options.macros)\r\n            ),\r\n            'ML__base'\r\n        ),\r\n        'ML__mathlive'\r\n    ).toMarkup();\r\n}\r\n\r\n/**\r\n * Return a markup string for the keyboard toolbar for the specified layer.\r\n */\r\nfunction makeKeyboardToolbar(\r\n    mf: MathfieldPrivate,\r\n    keyboardIDs,\r\n    currentKeyboard\r\n): string {\r\n    // The left hand side of the toolbar has a list of all the available keyboards\r\n    let result = \"<div class='left'>\";\r\n    const keyboardList = keyboardIDs.replace(/\\s+/g, ' ').split(' ');\r\n    if (keyboardList.length > 1) {\r\n        const keyboards = {\r\n            ...KEYBOARDS,\r\n            ...(mf.options.customVirtualKeyboards ?? {}),\r\n        };\r\n        for (const keyboard of keyboardList) {\r\n            if (!keyboards[keyboard]) {\r\n                console.error('Unknown virtual keyboard \"' + keyboard + '\"');\r\n                break;\r\n            }\r\n            result += \"<div class='\";\r\n            if (keyboard === currentKeyboard) {\r\n                result += 'selected ';\r\n            } else {\r\n                if (keyboards[keyboard].command) {\r\n                    result += 'action ';\r\n                } else {\r\n                    result += 'layer-switch ';\r\n                }\r\n            }\r\n\r\n            result += (keyboards[keyboard].classes || '') + \"'\";\r\n\r\n            if (keyboards[keyboard].tooltip) {\r\n                result +=\r\n                    \"data-ML__tooltip='\" +\r\n                    l10n(keyboards[keyboard].tooltip) +\r\n                    \"' \";\r\n                result += \"data-placement='top' data-delay='1s'\";\r\n            }\r\n\r\n            if (keyboard !== currentKeyboard) {\r\n                if (keyboards[keyboard].command) {\r\n                    result +=\r\n                        'data-command=\\'\"' +\r\n                        keyboards[keyboard].command +\r\n                        '\"\\'';\r\n                }\r\n\r\n                if (keyboards[keyboard].layer) {\r\n                    result += \"data-layer='\" + keyboards[keyboard].layer + \"'\";\r\n                }\r\n            }\r\n            result += '>' + keyboards[keyboard].label + '</div>';\r\n        }\r\n    }\r\n    result += '</div>';\r\n\r\n    // The right hand side of the toolbar, with the copy/undo/redo commands\r\n    result += `\r\n        <div class='right'>\r\n            <div class='action'\r\n                data-command='\"copyToClipboard\"'\r\n                data-ML__tooltip='${l10n(\r\n                    'tooltip.copy to clipboard'\r\n                )}' data-placement='top' data-delay='1s'>\r\n                <svg><use xlink:href='#svg-copy' /></svg>\r\n            </div>\r\n            <div class='action disabled'\r\n                data-command='\"undo\"'\r\n                data-ML__tooltip='${l10n(\r\n                    'tooltip.undo'\r\n                )}' data-placement='top' data-delay='1s'>\r\n                <svg><use xlink:href='#svg-undo' /></svg>\r\n            </div>\r\n            <div class='action disabled'\r\n                data-command='\"redo\"'\r\n                data-ML__tooltip='${l10n(\r\n                    'tooltip.redo'\r\n                )}' data-placement='top' data-delay='1s'>\r\n                <svg><use xlink:href='#svg-redo' /></svg>\r\n            </div>\r\n        </div>\r\n    `;\r\n\r\n    return \"<div class='keyboard-toolbar' role='toolbar'>\" + result + '</div>';\r\n}\r\n\r\nexport function makeKeycap(\r\n    mf: MathfieldPrivate,\r\n    elList: HTMLElement[],\r\n    chainedCommand?: string | any[]\r\n): void {\r\n    for (let i = 0; i < elList.length; ++i) {\r\n        const el = elList[i];\r\n        let html: string;\r\n        // Display\r\n        if (el.getAttribute('data-latex')) {\r\n            html = latexToMarkup(\r\n                el.getAttribute('data-latex').replace(/&quot;/g, '\"'),\r\n                { '?': '{\\\\color{#555}{\\\\scriptstyle \\\\char\"2B1A}}' },\r\n                mf\r\n            );\r\n        } else if (el.getAttribute('data-insert') && el.innerHTML === '') {\r\n            html = latexToMarkup(\r\n                el.getAttribute('data-insert').replace(/&quot;/g, '\"'),\r\n                { '?': '{\\\\color{#555}{\\\\scriptstyle \\\\char\"2B1A}}' },\r\n                mf\r\n            );\r\n        } else if (el.getAttribute('data-content')) {\r\n            html = el.getAttribute('data-content').replace(/&quot;/g, '\"');\r\n        }\r\n\r\n        if (el.getAttribute('data-aside')) {\r\n            html =\r\n                (html ?? '') +\r\n                '<aside>' +\r\n                el.getAttribute('data-aside').replace(/&quot;/g, '\"') +\r\n                '</aside>';\r\n        }\r\n        if (typeof html !== 'undefined') {\r\n            el.innerHTML = mf.options.createHTML(html);\r\n        }\r\n        if (el.getAttribute('data-classes')) {\r\n            el.classList.add(el.getAttribute('data-classes'));\r\n        }\r\n\r\n        const key = el.getAttribute('data-insert')?.replace(/&quot;/g, '\"');\r\n        if (key && SHIFTED_KEYS[key]) {\r\n            el.setAttribute('data-shifted', SHIFTED_KEYS[key][0]);\r\n            el.setAttribute(\r\n                'data-shifted-command',\r\n                JSON.stringify([\r\n                    'insertAndUnshiftKeyboardLayer',\r\n                    SHIFTED_KEYS[key][1],\r\n                ])\r\n            );\r\n        }\r\n\r\n        // Commands\r\n        let handlers;\r\n        if (el.getAttribute('data-command')) {\r\n            handlers = JSON.parse(el.getAttribute('data-command'));\r\n        } else if (el.getAttribute('data-insert')) {\r\n            handlers = [\r\n                'insert',\r\n                el.getAttribute('data-insert'),\r\n                {\r\n                    focus: true,\r\n                    feedback: true,\r\n                    mode: 'math',\r\n                    format: 'latex',\r\n                    resetStyle: true,\r\n                },\r\n            ];\r\n        } else if (el.getAttribute('data-latex')) {\r\n            handlers = [\r\n                'insert',\r\n                el.getAttribute('data-latex'),\r\n                {\r\n                    focus: true,\r\n                    feedback: true,\r\n                    mode: 'math',\r\n                    format: 'latex',\r\n                    resetStyle: true,\r\n                },\r\n            ];\r\n        } else {\r\n            handlers = [\r\n                'typedText',\r\n                el.getAttribute('data-key') || el.textContent,\r\n                { focus: true, feedback: true, simulateKeystroke: true },\r\n            ];\r\n        }\r\n        if (chainedCommand) {\r\n            handlers = [chainedCommand, handlers];\r\n        }\r\n        if (el.getAttribute('data-alt-keys')) {\r\n            const altKeys = ALT_KEYS[el.getAttribute('data-alt-keys')];\r\n            if (altKeys) {\r\n                handlers = {\r\n                    default: handlers,\r\n                    pressAndHoldStart: [\r\n                        'showAlternateKeys',\r\n                        el.getAttribute('data-alt-keys'),\r\n                        altKeys,\r\n                    ],\r\n                    pressAndHoldEnd: 'hideAlternateKeys',\r\n                };\r\n            } else {\r\n                console.warn(\r\n                    'Unknown alt key set: \"' + el.getAttribute('data-alt-keys')\r\n                );\r\n            }\r\n        }\r\n\r\n        attachButtonHandlers(mf, el, handlers);\r\n    }\r\n}\r\n\r\n/**\r\n * Expand the shortcut tags (e.g. <row>) inside a layer.\r\n */\r\nfunction expandLayerMarkup(mf: MathfieldPrivate, layer): string {\r\n    const ROWS = {\r\n        // First row should be 10 key wide\r\n        // Second row should be 10 key wide\r\n        // Third row should be 8.5 key wide\r\n        // One row should have ^ (shift key) which is 1.5 key wide\r\n        // One row should have ~ (delete key) which is .5 or 1.5 key wide\r\n        qwerty: {\r\n            'lower-1': 'qwertyuiop',\r\n            'lower-2': ' asdfghjkl ',\r\n            'lower-3': '^zxcvbnm~',\r\n            'upper-1': 'QWERTYUIOP',\r\n            'upper-2': ' ASDFGHJKL ',\r\n            'upper-3': '^ZXCVBNM~',\r\n            'numpad-1': '789/',\r\n            'numpad-2': '456*',\r\n            'numpad-3': '123-',\r\n            'numpad-4': '0.=+',\r\n        },\r\n        azerty: {\r\n            'lower-1': 'azertyuiop',\r\n            'lower-2': 'qsdfghjklm',\r\n            'lower-3': '^ wxcvbn ~',\r\n            'upper-1': 'AZERTYUIOP',\r\n            'upper-2': 'QSDFGHJKLM',\r\n            'upper-3': '^ WXCVBN ~',\r\n        },\r\n        qwertz: {\r\n            'lower-1': 'qwertzuiop',\r\n            'lower-2': ' asdfghjkl ',\r\n            'lower-3': '^yxcvbnm~',\r\n            'upper-1': 'QWERTZUIOP',\r\n            'upper-2': ' ASDFGHJKL',\r\n            'upper-3': '^YXCVBNM~',\r\n        },\r\n        dvorak: {\r\n            'lower-1': '^  pyfgcrl ',\r\n            'lower-2': 'aoeuidhtns',\r\n            'lower-3': 'qjkxbmwvz~',\r\n            'upper-1': '^  PYFGCRL ',\r\n            'upper-2': 'AOEUIDHTNS',\r\n            'upper-3': 'QJKXBMWVZ~',\r\n        },\r\n        colemak: {\r\n            'lower-1': ' qwfpgjluy ',\r\n            'lower-2': 'arstdhneio',\r\n            'lower-3': '^zxcvbkm~',\r\n            'upper-1': ' QWFPGNLUY ',\r\n            'upper-2': 'ARSTDHNEIO',\r\n            'upper-3': '^ZXCVBKM~',\r\n        },\r\n    };\r\n    const layout = ROWS[mf.options.virtualKeyboardLayout]\r\n        ? ROWS[mf.options.virtualKeyboardLayout]\r\n        : ROWS['qwerty'];\r\n\r\n    let result = layer;\r\n    let row;\r\n\r\n    result = result.replace(\r\n        /<arrows\\/>/g,\r\n        `\r\n        <li class='action' data-command='[\"performWithFeedback\",\"moveToPreviousChar\"]'\r\n            data-shifted='<svg><use xlink:href=\"#svg-angle-double-left\" /></svg>'\r\n            data-shifted-command='[\"performWithFeedback\",\"extendToPreviousChar\"]'>\r\n            <svg><use xlink:href='#svg-arrow-left' /></svg>\r\n        </li>\r\n        <li class='action' data-command='[\"performWithFeedback\",\"moveToNextChar\"]'\r\n            data-shifted='<svg><use xlink:href=\"#svg-angle-double-right\" /></svg>'\r\n            data-shifted-command='[\"performWithFeedback\",\"extendToNextChar\"]'>\r\n            <svg><use xlink:href='#svg-arrow-right' /></svg>\r\n        </li>\r\n        <li class='action' data-command='[\"performWithFeedback\",\"moveToNextPlaceholder\"]'>\r\n        <svg><use xlink:href='#svg-tab' /></svg></li>`\r\n    );\r\n\r\n    let m = result.match(/(<row\\s+)(.*)((?:<\\/row|\\/)>)/);\r\n    while (m) {\r\n        row = '';\r\n        const attributesArray = m[2].match(\r\n            /[a-zA-Z][a-zA-Z0-9-]*=(['\"])(.*?)\\1/g\r\n        );\r\n        const attributes = {};\r\n        for (const attribute of attributesArray) {\r\n            const m2 = attribute.match(/([a-zA-Z][a-zA-Z0-9-]*)=(['\"])(.*?)\\2/);\r\n            attributes[m2[1]] = m2[3];\r\n        }\r\n\r\n        let keys = layout[attributes['name']];\r\n        if (!keys) keys = ROWS['qwerty'][attributes['name']];\r\n        if (!keys) {\r\n            console.warn('Unknown roman keyboard row: ' + attributes['name']);\r\n        } else {\r\n            for (const c of keys) {\r\n                let cls = attributes['class'] || '';\r\n                if (cls) cls = ' ' + cls;\r\n                if (c === '~') {\r\n                    row += `<li class='action font-glyph bottom right `;\r\n                    row +=\r\n                        keys.length - (keys.match(/ /g) || []).length / 2 === 10\r\n                            ? 'w10'\r\n                            : 'w15';\r\n                    row += `' data-shifted='<span class=\"warning\"><svg><use xlink:href=\"#svg-trash\" /></svg></span>'\r\n                        data-shifted-command='\"deleteAll\"'\r\n                        data-alt-keys='delete' data-command='[\"performWithFeedback\",\"deleteBackward\"]'\r\n                        >&#x232b;</li>`;\r\n                } else if (c === ' ') {\r\n                    // Separator\r\n                    row += \"<li class='separator w5'></li>\";\r\n                } else if (c === '^') {\r\n                    // Shift key\r\n                    row +=\r\n                        `<li class='shift modifier font-glyph bottom left w15 layer-switch' data-layer='` +\r\n                        attributes['shift-layer'] +\r\n                        `'>&#x21e7;</li>`;\r\n                } else if (c === '/') {\r\n                    row +=\r\n                        \"<li class='keycap\" +\r\n                        cls +\r\n                        \"' data-alt-keys='/' data-insert='\\\\frac{#@}{#?}'>&divide;</li>\";\r\n                } else if (c === '*') {\r\n                    row +=\r\n                        \"<li class='keycap\" +\r\n                        cls +\r\n                        \"' data-alt-keys='*' data-insert='\\\\times '>&times;</li>\";\r\n                } else if (c === '-') {\r\n                    row +=\r\n                        \"<li class='keycap\" +\r\n                        cls +\r\n                        \"' data-alt-keys='-' data-key='-' data-alt-keys='-'>&#x2212;</li>\";\r\n                } else if (/tt/.test(cls)) {\r\n                    row +=\r\n                        \"<li class='keycap\" +\r\n                        cls +\r\n                        \"' data-alt-keys='\" +\r\n                        c +\r\n                        \"'\" +\r\n                        ` data-command='[\"typedText\",\"` +\r\n                        c +\r\n                        `\",{\"mode\":\"command\", \"focus\":true, \"feedback\":true}]'` +\r\n                        '>' +\r\n                        c +\r\n                        '</li>';\r\n                } else {\r\n                    row +=\r\n                        \"<li class='keycap\" +\r\n                        cls +\r\n                        \"' data-alt-keys='\" +\r\n                        c +\r\n                        \"'>\" +\r\n                        c +\r\n                        '</li>';\r\n                }\r\n            }\r\n        }\r\n        result = result.replace(new RegExp(m[1] + m[2] + m[3]), row);\r\n\r\n        m = result.match(/(<row\\s+)(.*)((?:<\\/row|\\/)>)/);\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n/**\r\n * Construct a virtual keyboard element based on the config options in the\r\n * mathfield and an optional theme.\r\n */\r\nexport function makeKeyboard(\r\n    mf: MathfieldPrivate,\r\n    theme: 'apple' | 'material' | ''\r\n): HTMLElement {\r\n    const svgIcons = `<svg xmlns=\"http://www.w3.org/2000/svg\" style=\"display: none;\">\r\n\r\n            <symbol id=\"svg-command\" viewBox=\"0 0 640 512\">\r\n                <path d=\"M34.495 36.465l211.051 211.05c4.686 4.686 4.686 12.284 0 16.971L34.495 475.535c-4.686 4.686-12.284 4.686-16.97 0l-7.071-7.07c-4.686-4.686-4.686-12.284 0-16.971L205.947 256 10.454 60.506c-4.686-4.686-4.686-12.284 0-16.971l7.071-7.07c4.686-4.687 12.284-4.687 16.97 0zM640 468v-10c0-6.627-5.373-12-12-12H300c-6.627 0-12 5.373-12 12v10c0 6.627 5.373 12 12 12h328c6.627 0 12-5.373 12-12z\"/>\r\n            </symbol>\r\n\r\n            <symbol id=\"svg-undo\" viewBox=\"0 0 512 512\">\r\n                <path d=\"M20 8h10c6.627 0 12 5.373 12 12v110.625C85.196 57.047 165.239 7.715 256.793 8.001 393.18 8.428 504.213 120.009 504 256.396 503.786 393.181 392.834 504 256 504c-63.926 0-122.202-24.187-166.178-63.908-5.113-4.618-5.354-12.561-.482-17.433l7.069-7.069c4.503-4.503 11.749-4.714 16.482-.454C150.782 449.238 200.935 470 256 470c117.744 0 214-95.331 214-214 0-117.744-95.331-214-214-214-82.862 0-154.737 47.077-190.289 116H180c6.627 0 12 5.373 12 12v10c0 6.627-5.373 12-12 12H20c-6.627 0-12-5.373-12-12V20c0-6.627 5.373-12 12-12z\"/>\r\n            </symbol>\r\n            <symbol id=\"svg-redo\" viewBox=\"0 0 512 512\">\r\n                <path d=\"M492 8h-10c-6.627 0-12 5.373-12 12v110.625C426.804 57.047 346.761 7.715 255.207 8.001 118.82 8.428 7.787 120.009 8 256.396 8.214 393.181 119.166 504 256 504c63.926 0 122.202-24.187 166.178-63.908 5.113-4.618 5.354-12.561.482-17.433l-7.069-7.069c-4.503-4.503-11.749-4.714-16.482-.454C361.218 449.238 311.065 470 256 470c-117.744 0-214-95.331-214-214 0-117.744 95.331-214 214-214 82.862 0 154.737 47.077 190.289 116H332c-6.627 0-12 5.373-12 12v10c0 6.627 5.373 12 12 12h160c6.627 0 12-5.373 12-12V20c0-6.627-5.373-12-12-12z\"/>\r\n            </symbol>\r\n            <symbol id=\"svg-arrow-left\" viewBox=\"0 0 192 512\">\r\n                <path d=\"M25.1 247.5l117.8-116c4.7-4.7 12.3-4.7 17 0l7.1 7.1c4.7 4.7 4.7 12.3 0 17L64.7 256l102.2 100.4c4.7 4.7 4.7 12.3 0 17l-7.1 7.1c-4.7 4.7-12.3 4.7-17 0L25 264.5c-4.6-4.7-4.6-12.3.1-17z\"/>\r\n            </symbol>\r\n            <symbol id=\"svg-arrow-right\" viewBox=\"0 0 192 512\">\r\n                    <path d=\"M166.9 264.5l-117.8 116c-4.7 4.7-12.3 4.7-17 0l-7.1-7.1c-4.7-4.7-4.7-12.3 0-17L127.3 256 25.1 155.6c-4.7-4.7-4.7-12.3 0-17l7.1-7.1c4.7-4.7 12.3-4.7 17 0l117.8 116c4.6 4.7 4.6 12.3-.1 17z\"/>\r\n            </symbol>\r\n            <symbol id=\"svg-tab\" viewBox=\"0 0 448 512\">\r\n                    <path d=\"M32 217.1c0-8.8 7.2-16 16-16h144v-93.9c0-7.1 8.6-10.7 13.6-5.7l143.5 143.1c6.3 6.3 6.3 16.4 0 22.7L205.6 410.4c-5 5-13.6 1.5-13.6-5.7v-93.9H48c-8.8 0-16-7.2-16-16v-77.7m-32 0v77.7c0 26.5 21.5 48 48 48h112v61.9c0 35.5 43 53.5 68.2 28.3l143.6-143c18.8-18.8 18.8-49.2 0-68L228.2 78.9c-25.1-25.1-68.2-7.3-68.2 28.3v61.9H48c-26.5 0-48 21.6-48 48zM436 64h-8c-6.6 0-12 5.4-12 12v360c0 6.6 5.4 12 12 12h8c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12z\"/>\r\n            </symbol>\r\n            <symbol id=\"svg-copy\" viewBox=\"0 0 448 512\">\r\n                <path d=\"M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM352 32.491a15.88 15.88 0 0 1 7.431 4.195l51.882 51.883A15.885 15.885 0 0 1 415.508 96H352V32.491zM288 464c0 8.822-7.178 16-16 16H48c-8.822 0-16-7.178-16-16V144c0-8.822 7.178-16 16-16h80v240c0 26.51 21.49 48 48 48h112v48zm128-96c0 8.822-7.178 16-16 16H176c-8.822 0-16-7.178-16-16V48c0-8.822 7.178-16 16-16h144v72c0 13.2 10.8 24 24 24h72v240z\"/>\r\n            </symbol>\r\n            <symbol id=\"svg-angle-double-right\" viewBox=\"0 0 320 512\">\r\n                <path d=\"M166.9 264.5l-117.8 116c-4.7 4.7-12.3 4.7-17 0l-7.1-7.1c-4.7-4.7-4.7-12.3 0-17L127.3 256 25.1 155.6c-4.7-4.7-4.7-12.3 0-17l7.1-7.1c4.7-4.7 12.3-4.7 17 0l117.8 116c4.6 4.7 4.6 12.3-.1 17zm128-17l-117.8-116c-4.7-4.7-12.3-4.7-17 0l-7.1 7.1c-4.7 4.7-4.7 12.3 0 17L255.3 256 153.1 356.4c-4.7 4.7-4.7 12.3 0 17l7.1 7.1c4.7 4.7 12.3 4.7 17 0l117.8-116c4.6-4.7 4.6-12.3-.1-17z\"/>\r\n            </symbol>\r\n            <symbol id=\"svg-angle-double-left\" viewBox=\"0 0 320 512\">\r\n                <path d=\"M153.1 247.5l117.8-116c4.7-4.7 12.3-4.7 17 0l7.1 7.1c4.7 4.7 4.7 12.3 0 17L192.7 256l102.2 100.4c4.7 4.7 4.7 12.3 0 17l-7.1 7.1c-4.7 4.7-12.3 4.7-17 0L153 264.5c-4.6-4.7-4.6-12.3.1-17zm-128 17l117.8 116c4.7 4.7 12.3 4.7 17 0l7.1-7.1c4.7-4.7 4.7-12.3 0-17L64.7 256l102.2-100.4c4.7-4.7 4.7-12.3 0-17l-7.1-7.1c-4.7-4.7-12.3-4.7-17 0L25 247.5c-4.6 4.7-4.6 12.3.1 17z\"/>\r\n            </symbol>\r\n            <symbol id=\"svg-trash\" viewBox=\"0 0 448 512\">\r\n                <path d=\"M336 64l-33.6-44.8C293.3 7.1 279.1 0 264 0h-80c-15.1 0-29.3 7.1-38.4 19.2L112 64H24C10.7 64 0 74.7 0 88v2c0 3.3 2.7 6 6 6h26v368c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V96h26c3.3 0 6-2.7 6-6v-2c0-13.3-10.7-24-24-24h-88zM184 32h80c5 0 9.8 2.4 12.8 6.4L296 64H152l19.2-25.6c3-4 7.8-6.4 12.8-6.4zm200 432c0 8.8-7.2 16-16 16H80c-8.8 0-16-7.2-16-16V96h320v368zm-176-44V156c0-6.6 5.4-12 12-12h8c6.6 0 12 5.4 12 12v264c0 6.6-5.4 12-12 12h-8c-6.6 0-12-5.4-12-12zm-80 0V156c0-6.6 5.4-12 12-12h8c6.6 0 12 5.4 12 12v264c0 6.6-5.4 12-12 12h-8c-6.6 0-12-5.4-12-12zm160 0V156c0-6.6 5.4-12 12-12h8c6.6 0 12 5.4 12 12v264c0 6.6-5.4 12-12 12h-8c-6.6 0-12-5.4-12-12z\"/>\r\n            </symbol>\r\n        </svg>\r\n        `;\r\n    // <symbol id=\"svg-wikipedia\" viewBox=\"0 0 640 512\">\r\n    //         <path d=\"M640 51.2l-.3 12.2c-28.1.8-45 15.8-55.8 40.3-25 57.8-103.3 240-155.3 358.6H415l-81.9-193.1c-32.5 63.6-68.3 130-99.2 193.1-.3.3-15 0-15-.3C172 352.3 122.8 243.4 75.8 133.4 64.4 106.7 26.4 63.4.2 63.7c0-3.1-.3-10-.3-14.2h161.9v13.9c-19.2 1.1-52.8 13.3-43.3 34.2 21.9 49.7 103.6 240.3 125.6 288.6 15-29.7 57.8-109.2 75.3-142.8-13.9-28.3-58.6-133.9-72.8-160-9.7-17.8-36.1-19.4-55.8-19.7V49.8l142.5.3v13.1c-19.4.6-38.1 7.8-29.4 26.1 18.9 40 30.6 68.1 48.1 104.7 5.6-10.8 34.7-69.4 48.1-100.8 8.9-20.6-3.9-28.6-38.6-29.4.3-3.6 0-10.3.3-13.6 44.4-.3 111.1-.3 123.1-.6v13.6c-22.5.8-45.8 12.8-58.1 31.7l-59.2 122.8c6.4 16.1 63.3 142.8 69.2 156.7L559.2 91.8c-8.6-23.1-36.4-28.1-47.2-28.3V49.6l127.8 1.1.2.5z\"/>\r\n    // </symbol>\r\n    // <symbol id=\"svg-link\" viewBox=\"0 0 512 512\">\r\n    //         <path d=\"M301.148 394.702l-79.2 79.19c-50.778 50.799-133.037 50.824-183.84 0-50.799-50.778-50.824-133.037 0-183.84l79.19-79.2a132.833 132.833 0 0 1 3.532-3.403c7.55-7.005 19.795-2.004 20.208 8.286.193 4.807.598 9.607 1.216 14.384.481 3.717-.746 7.447-3.397 10.096-16.48 16.469-75.142 75.128-75.3 75.286-36.738 36.759-36.731 96.188 0 132.94 36.759 36.738 96.188 36.731 132.94 0l79.2-79.2.36-.36c36.301-36.672 36.14-96.07-.37-132.58-8.214-8.214-17.577-14.58-27.585-19.109-4.566-2.066-7.426-6.667-7.134-11.67a62.197 62.197 0 0 1 2.826-15.259c2.103-6.601 9.531-9.961 15.919-7.28 15.073 6.324 29.187 15.62 41.435 27.868 50.688 50.689 50.679 133.17 0 183.851zm-90.296-93.554c12.248 12.248 26.362 21.544 41.435 27.868 6.388 2.68 13.816-.68 15.919-7.28a62.197 62.197 0 0 0 2.826-15.259c.292-5.003-2.569-9.604-7.134-11.67-10.008-4.528-19.371-10.894-27.585-19.109-36.51-36.51-36.671-95.908-.37-132.58l.36-.36 79.2-79.2c36.752-36.731 96.181-36.738 132.94 0 36.731 36.752 36.738 96.181 0 132.94-.157.157-58.819 58.817-75.3 75.286-2.651 2.65-3.878 6.379-3.397 10.096a163.156 163.156 0 0 1 1.216 14.384c.413 10.291 12.659 15.291 20.208 8.286a131.324 131.324 0 0 0 3.532-3.403l79.19-79.2c50.824-50.803 50.799-133.062 0-183.84-50.802-50.824-133.062-50.799-183.84 0l-79.2 79.19c-50.679 50.682-50.688 133.163 0 183.851z\"/>\r\n    // </symbol>\r\n    //     <symbol id=\"svg-external-link\" viewBox=\"0 0 448 512\">\r\n    //     <path d=\"M400 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V80c0-26.51-21.49-48-48-48zm16 400c0 8.822-7.178 16-16 16H48c-8.822 0-16-7.178-16-16V80c0-8.822 7.178-16 16-16h352c8.822 0 16 7.178 16 16v352zM99.515 374.828c-4.686-4.686-4.686-12.284 0-16.971l195.15-195.15-.707-.707-89.958.342c-6.627 0-12-5.373-12-12v-9.999c0-6.628 5.372-12 12-12L340 128c6.627 0 12 5.372 12 12l-.343 136c0 6.627-5.373 12-12 12h-9.999c-6.627 0-12-5.373-12-12l.342-89.958-.707-.707-195.15 195.15c-4.686 4.686-12.284 4.686-16.971 0l-5.657-5.657z\"/>\r\n    // </symbol>\r\n    // <symbol id=\"svg-external-link\" viewBox=\"0 0 512 512\">\r\n    //     <path d=\"M256 40c118.621 0 216 96.075 216 216 0 119.291-96.61 216-216 216-119.244 0-216-96.562-216-216 0-119.203 96.602-216 216-216m0-32C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm-36 344h12V232h-12c-6.627 0-12-5.373-12-12v-8c0-6.627 5.373-12 12-12h48c6.627 0 12 5.373 12 12v140h12c6.627 0 12 5.373 12 12v8c0 6.627-5.373 12-12 12h-72c-6.627 0-12-5.373-12-12v-8c0-6.627 5.373-12 12-12zm36-240c-17.673 0-32 14.327-32 32s14.327 32 32 32 32-14.327 32-32-14.327-32-32-32z\"/>\r\n    // </symbol>\r\n\r\n    let markup = svgIcons;\r\n\r\n    injectStylesheet(null, virtualKeyboardStylesheet);\r\n    injectStylesheet(null, coreStylesheet);\r\n\r\n    // Auto-populate the ALT_KEYS table\r\n    ALT_KEYS_BASE['foreground-color'] = [];\r\n    for (const color of LINE_COLORS) {\r\n        ALT_KEYS_BASE['foreground-color'].push({\r\n            classes: 'small-button',\r\n            content:\r\n                '<span style=\"border-radius:50%;width:32px;height:32px; box-sizing: border-box; border: 3px solid ' +\r\n                color +\r\n                '\"></span>',\r\n            command: '[\"applyStyle\",{\"color\":\"' + color + '\"}]',\r\n        });\r\n    }\r\n    ALT_KEYS_BASE['background-color'] = [];\r\n    for (const color of AREA_COLORS) {\r\n        ALT_KEYS_BASE['background-color'].push({\r\n            classes: 'small-button',\r\n            content:\r\n                '<span style=\"border-radius:50%;width:32px;height:32px; background:' +\r\n                color +\r\n                '\"></span>',\r\n            command: '[\"applyStyle\",{\"backgroundColor\":\"' + color + '\"}]',\r\n        });\r\n    }\r\n\r\n    ALT_KEYS = { ...ALT_KEYS_BASE };\r\n    Object.keys(ALT_KEYS).forEach((key) => {\r\n        ALT_KEYS[key] = ALT_KEYS[key].slice();\r\n    });\r\n\r\n    const UPPER_ALPHA = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';\r\n    const LOWER_ALPHA = 'abcdefghijklmnopqrstuvwxyz';\r\n    const DIGITS = '0123456789';\r\n    // Define the alternate set for uppercase keys\r\n    for (let i = 0; i < 26; i++) {\r\n        const key = UPPER_ALPHA[i];\r\n        if (!ALT_KEYS[key]) ALT_KEYS[key] = [];\r\n        ALT_KEYS[key].unshift({\r\n            latex: '\\\\mathbb{' + key + '}',\r\n            aside: 'blackboard',\r\n            insert: '\\\\mathbb{' + key + '}',\r\n        });\r\n        ALT_KEYS[key].unshift({\r\n            latex: '\\\\mathbf{' + key + '}',\r\n            aside: 'bold',\r\n            insert: '\\\\mathbf{' + key + '}',\r\n        });\r\n        ALT_KEYS[key].unshift({\r\n            latex: '\\\\mathsf{' + key + '}',\r\n            aside: 'sans',\r\n            insert: '\\\\mathsf{' + key + '}',\r\n        });\r\n        ALT_KEYS[key].unshift({\r\n            latex: '\\\\mathtt{' + key + '}',\r\n            aside: 'monospace',\r\n            insert: '\\\\mathtt{' + key + '}',\r\n        });\r\n        ALT_KEYS[key].unshift({\r\n            latex: '\\\\mathcal{' + key + '}',\r\n            aside: 'calligraphy',\r\n            insert: '\\\\mathcal{' + key + '}',\r\n        });\r\n        ALT_KEYS[key].unshift({\r\n            latex: '\\\\mathfrak{' + key + '}',\r\n            aside: 'fraktur',\r\n            insert: '\\\\mathfrak{' + key + '}',\r\n        });\r\n    }\r\n    // Define the alternate set for lowercase keys\r\n    for (let i = 0; i <= 26; i++) {\r\n        const key = LOWER_ALPHA[i];\r\n        if (!ALT_KEYS[key]) ALT_KEYS[key] = [];\r\n        ALT_KEYS[key].unshift({\r\n            latex: '\\\\mathsf{' + key + '}',\r\n            aside: 'sans',\r\n            insert: '\\\\mathsf{' + key + '}',\r\n        });\r\n        ALT_KEYS[key].unshift({\r\n            latex: '\\\\mathbf{' + key + '}',\r\n            aside: 'bold',\r\n            insert: '\\\\mathbf{' + key + '}',\r\n        });\r\n        ALT_KEYS[key].unshift({\r\n            latex: '\\\\mathtt{' + key + '}',\r\n            aside: 'monospace',\r\n            insert: '\\\\mathtt{' + key + '}',\r\n        });\r\n        ALT_KEYS[key].unshift({\r\n            latex: '\\\\mathfrak{' + key + '}',\r\n            aside: 'fraktur',\r\n            insert: '\\\\mathfrak{' + key + '}',\r\n        });\r\n    }\r\n    for (let i = 0; i < 10; i++) {\r\n        const key = DIGITS[i];\r\n        if (!ALT_KEYS[key]) ALT_KEYS[key] = [];\r\n        // The mathbb font does not appear to include digits,\r\n        // although it's supposed to.\r\n        // ALT_KEYS[key].push({\r\n        //         latex: '\\\\underset{\\\\textsf{\\\\footnotesize blackboard}}{\\\\mathbb{' + key + '}}',\r\n        //         insert: '\\\\mathbb{' + key + '}}'});\r\n        ALT_KEYS[key].unshift({\r\n            latex: '\\\\mathbf{' + key + '}',\r\n            aside: 'bold',\r\n            insert: '\\\\mathbf{' + key + '}',\r\n        });\r\n        ALT_KEYS[key].unshift({\r\n            latex: '\\\\mathsf{' + key + '}',\r\n            aside: 'sans',\r\n            insert: '\\\\mathsf{' + key + '}',\r\n        });\r\n        ALT_KEYS[key].unshift({\r\n            latex: '\\\\mathtt{' + key + '}',\r\n            aside: 'monospace',\r\n            insert: '\\\\mathtt{' + key + '}',\r\n        });\r\n        ALT_KEYS[key].unshift({\r\n            latex: '\\\\mathcal{' + key + '}',\r\n            aside: 'script',\r\n            insert: '\\\\mathcal{' + key + '}',\r\n        });\r\n        ALT_KEYS[key].unshift({\r\n            latex: '\\\\mathfrak{' + key + '}',\r\n            aside: 'fraktur',\r\n            insert: '\\\\mathfrak{' + key + '}',\r\n        });\r\n    }\r\n\r\n    let keyboardIDs = mf.options.virtualKeyboards;\r\n    if (!keyboardIDs) {\r\n        keyboardIDs = 'all';\r\n    }\r\n    keyboardIDs = keyboardIDs.replace(\r\n        /\\ball\\b/i,\r\n        'numeric functions symbols roman  greek'\r\n    );\r\n\r\n    const layers: {\r\n        [layerName: string]: string | VirtualKeyboardLayer;\r\n    } = {\r\n        ...LAYERS,\r\n        ...(mf.options.customVirtualKeyboardLayers ?? {}),\r\n    };\r\n    const keyboards = {\r\n        ...KEYBOARDS,\r\n        ...(mf.options.customVirtualKeyboards ?? {}),\r\n    };\r\n\r\n    const keyboardList = keyboardIDs.replace(/\\s+/g, ' ').split(' ');\r\n    for (const keyboard of keyboardList) {\r\n        if (!keyboards[keyboard]) {\r\n            console.error('Unknown virtual keyboard \"' + keyboard + '\"');\r\n            break;\r\n        }\r\n        // Add the default layer to the list of layers,\r\n        // and make sure the list of layers is uniquified.\r\n        let keyboardLayers = keyboards[keyboard].layers || [];\r\n        if (keyboards[keyboard].layer) {\r\n            keyboardLayers.push(keyboards[keyboard].layer);\r\n        }\r\n        keyboardLayers = Array.from(new Set(keyboardLayers));\r\n\r\n        for (const layerName of keyboardLayers) {\r\n            if (!layers[layerName]) {\r\n                console.error(\r\n                    'Unknown virtual keyboard layer: \"' + layerName + '\"'\r\n                );\r\n                break;\r\n            }\r\n\r\n            if (typeof layers[layerName] === 'object') {\r\n                const layer = layers[layerName] as VirtualKeyboardLayer;\r\n                // Process JSON layer to web element based layer.\r\n\r\n                let tempLayer = '';\r\n                if (layer.styles) {\r\n                    tempLayer += `<style>${layer.styles}</style>`;\r\n                }\r\n\r\n                if (layer.backdrop) {\r\n                    tempLayer += `<div class='${layer.backdrop}'>`;\r\n                }\r\n\r\n                if (layer.container) {\r\n                    tempLayer += `<div class='${layer.container}'>`;\r\n                }\r\n\r\n                if (layer.rows) {\r\n                    tempLayer += `<div class='rows'>`;\r\n                    for (const row of layer.rows) {\r\n                        tempLayer += `<ul>`;\r\n                        for (const keycap of row) {\r\n                            tempLayer += `<li`;\r\n                            if (keycap.class) {\r\n                                tempLayer += ` class=\"${keycap.class}\"`;\r\n                            }\r\n                            if (keycap.key) {\r\n                                tempLayer += ` data-key=\"${keycap.key}\"`;\r\n                            }\r\n\r\n                            if (keycap.command) {\r\n                                if (typeof keycap.command === 'string') {\r\n                                    tempLayer += ` data-command='\"${keycap.command}\"'`;\r\n                                } else {\r\n                                    tempLayer += ` data-command='`;\r\n                                    tempLayer += JSON.stringify(keycap.command);\r\n                                    tempLayer += `'`;\r\n                                }\r\n                            }\r\n                            if (keycap.insert) {\r\n                                tempLayer += ` data-insert=\"${keycap.insert}\"`;\r\n                            }\r\n\r\n                            if (keycap.latex) {\r\n                                tempLayer += ` data-latex=\"${keycap.latex}\"`;\r\n                            }\r\n\r\n                            if (keycap.aside) {\r\n                                tempLayer += ` data-aside=\"${keycap.aside}\"`;\r\n                            }\r\n\r\n                            if (keycap.altKeys) {\r\n                                tempLayer += ` data-alt-keys=\"${keycap.altKeys}\"`;\r\n                            }\r\n\r\n                            if (keycap.shifted) {\r\n                                tempLayer += ` data-shifted=\"${keycap.shifted}\"`;\r\n                            }\r\n\r\n                            if (keycap.shiftedCommand) {\r\n                                tempLayer += ` data-shifted-command=\"${keycap.shiftedCommand}\"`;\r\n                            }\r\n\r\n                            tempLayer += `>${\r\n                                keycap.label ? keycap.label : ''\r\n                            }</li>`;\r\n                        }\r\n                        tempLayer += `</ul>`;\r\n                    }\r\n                    tempLayer += `</div>`;\r\n                }\r\n\r\n                if (layer.container) {\r\n                    tempLayer += '</div>';\r\n                }\r\n\r\n                if (layer.backdrop) {\r\n                    tempLayer += '</div>';\r\n                }\r\n\r\n                layers[layerName] = tempLayer;\r\n            }\r\n\r\n            markup +=\r\n                `<div tabindex=\"-1\" class='keyboard-layer' data-layer='` +\r\n                layerName +\r\n                `'>`;\r\n            markup += makeKeyboardToolbar(mf, keyboardIDs, keyboard);\r\n            const layerMarkup = layers[layerName];\r\n            // A layer can contain 'shortcuts' (i.e. <row> tags) that need to\r\n            // be expanded\r\n            markup += expandLayerMarkup(mf, layerMarkup);\r\n            markup += '</div>';\r\n        }\r\n    }\r\n\r\n    const result = document.createElement('div');\r\n    result.className = 'ML__keyboard';\r\n    if (theme) {\r\n        result.classList.add(theme);\r\n    } else if (mf.options.virtualKeyboardTheme) {\r\n        result.classList.add(mf.options.virtualKeyboardTheme);\r\n    }\r\n    result.innerHTML = mf.options.createHTML(markup);\r\n\r\n    // Attach the element handlers\r\n    makeKeycap(\r\n        mf,\r\n        [].slice.call(\r\n            result.querySelectorAll<HTMLElement>(\r\n                '.keycap, .action, .fnbutton, .bigfnbutton'\r\n            )\r\n        )\r\n    );\r\n\r\n    const elList = result.getElementsByClassName('layer-switch');\r\n    for (let i = 0; i < elList.length; ++i) {\r\n        if (elList[i].classList.contains('shift')) {\r\n            // This is a potential press-and-hold layer switch\r\n            attachButtonHandlers(mf, elList[i], {\r\n                // When the modifier is initially pressed, we will shift the labels\r\n                // (if available)\r\n                pressed: ['shiftKeyboardLayer', 'shift'],\r\n\r\n                // If the key is released before a delay, we switch to the target layer\r\n                default: [\r\n                    'switchKeyboardLayer',\r\n                    elList[i].getAttribute('data-layer'),\r\n                ],\r\n\r\n                // If the key is released after a longer delay, we restore the\r\n                // shifted labels\r\n                pressAndHoldEnd: 'unshiftKeyboardLayer',\r\n            });\r\n        } else {\r\n            // This is a simple layer switch\r\n            attachButtonHandlers(mf, elList[i], {\r\n                default: [\r\n                    'switchKeyboardLayer',\r\n                    elList[i].getAttribute('data-layer'),\r\n                ],\r\n            });\r\n        }\r\n    }\r\n\r\n    // Select the first keyboard as the initial one.\r\n    const layerElements = result.getElementsByClassName('keyboard-layer');\r\n    Array.from(layerElements).forEach((x) => {\r\n        x.addEventListener('mousedown', (evt) => {\r\n            evt.preventDefault();\r\n            evt.stopPropagation();\r\n        });\r\n        x.addEventListener(\r\n            'touchstart',\r\n            (evt) => {\r\n                evt.preventDefault();\r\n                evt.stopPropagation();\r\n            },\r\n            { passive: false }\r\n        );\r\n    });\r\n    layerElements[0].classList.add('is-visible');\r\n\r\n    // Listen to know when the mouse has been released without being\r\n    // captured to remove the alternate keys panel and the shifted state of the\r\n    // keyboard.\r\n    // @todo should use a scrim instead (to prevent elements underneat the alt\r\n    // layer from reacting while the alt layer is up)\r\n    window.addEventListener('mouseup', function () {\r\n        hideAlternateKeys(mf);\r\n        unshiftKeyboardLayer(mf);\r\n    });\r\n    window.addEventListener('blur', function () {\r\n        hideAlternateKeys(mf);\r\n        unshiftKeyboardLayer(mf);\r\n    });\r\n    window.addEventListener('touchend', function () {\r\n        hideAlternateKeys(mf);\r\n        unshiftKeyboardLayer(mf);\r\n    });\r\n    window.addEventListener('touchcancel', function () {\r\n        hideAlternateKeys(mf);\r\n        unshiftKeyboardLayer(mf);\r\n    });\r\n\r\n    return result;\r\n}\r\n\r\nexport function hideAlternateKeys(_mathfield: MathfieldPrivate): boolean {\r\n    const altContainer = document.getElementById(\r\n        'mathlive-alternate-keys-panel'\r\n    );\r\n    if (altContainer) {\r\n        altContainer.classList.remove('is-visible');\r\n        altContainer.innerHTML = '';\r\n        releaseSharedElement(altContainer);\r\n    }\r\n    return false;\r\n}\r\n/*\r\n * Restore the key labels and commands to the state before a modifier key\r\n * was pressed.\r\n *\r\n */\r\nexport function unshiftKeyboardLayer(mathfield: MathfieldPrivate): boolean {\r\n    const keycaps = mathfield.virtualKeyboard.querySelectorAll(\r\n        'div.keyboard-layer.is-visible .rows .keycap, div.keyboard-layer.is-visible .rows .action'\r\n    );\r\n    if (keycaps) {\r\n        for (let i = 0; i < keycaps.length; i++) {\r\n            const keycap = keycaps[i];\r\n            const content = keycap.getAttribute('data-unshifted-content');\r\n            if (content) {\r\n                keycap.innerHTML = mathfield.options.createHTML(content);\r\n            }\r\n            const command = keycap.getAttribute('data-unshifted-command');\r\n            if (command) {\r\n                keycap.setAttribute(\r\n                    'data-' + mathfield.options.namespace + 'command',\r\n                    command\r\n                );\r\n            }\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function updateUndoRedoButtons(mathfield: MathfieldPrivate): void {\r\n    const virtualKeyboardToolbar = mathfield.virtualKeyboard?.querySelector(\r\n        '.keyboard-toolbar'\r\n    );\r\n    if (virtualKeyboardToolbar) {\r\n        const undoButton = virtualKeyboardToolbar.querySelector(\r\n            '[data-command=\\'\"undo\"\\']'\r\n        );\r\n        const redoButton = virtualKeyboardToolbar.querySelector(\r\n            '[data-command=\\'\"redo\"\\']'\r\n        );\r\n        if (mathfield.canRedo()) {\r\n            redoButton.classList.remove('disabled');\r\n        } else {\r\n            redoButton.classList.add('disabled');\r\n        }\r\n        if (mathfield.canUndo()) {\r\n            undoButton.classList.remove('disabled');\r\n        } else {\r\n            undoButton.classList.add('disabled');\r\n        }\r\n    }\r\n}\r\n","import { isArray } from '../common/types';\r\n\r\nimport {\r\n    makeKeycap,\r\n    makeKeyboard,\r\n    hideAlternateKeys,\r\n    unshiftKeyboardLayer,\r\n} from './virtual-keyboard-utils';\r\nimport { complete } from './autocomplete';\r\nimport { getSharedElement } from '../editor-mathfield/utils';\r\nimport { register as registerCommand } from './commands';\r\nimport { on } from '../editor-mathfield/utils';\r\nimport type { MathfieldPrivate } from '../editor-mathfield/mathfield-private';\r\n/*\r\n * Alternate options are displayed when a key on the virtual keyboard is pressed\r\n * and held.\r\n *\r\n */\r\nregisterCommand(\r\n    {\r\n        showAlternateKeys: (mathfield: MathfieldPrivate, keycap, altKeys) => {\r\n            const altContainer = getSharedElement(\r\n                'mathlive-alternate-keys-panel',\r\n                'ML__keyboard alternate-keys'\r\n            );\r\n            if (mathfield.virtualKeyboard.classList.contains('material')) {\r\n                altContainer.classList.add('material');\r\n            }\r\n            if (altKeys.length >= 7) {\r\n                // Width 4\r\n                altContainer.style.width = '286px';\r\n            } else if (altKeys.length === 4 || altKeys.length === 2) {\r\n                // Width 2\r\n                altContainer.style.width = '146px';\r\n            } else if (altKeys.length === 1) {\r\n                // Width 1\r\n                altContainer.style.width = '86px';\r\n            } else {\r\n                // Width 3\r\n                altContainer.style.width = '146px';\r\n            }\r\n            // Reset container height\r\n            altContainer.style.height = 'auto';\r\n            let markup = '';\r\n            for (const altKey of altKeys) {\r\n                markup += '<li';\r\n                if (typeof altKey === 'string') {\r\n                    markup +=\r\n                        ' data-latex=\"' + altKey.replace(/\"/g, '&quot;') + '\"';\r\n                } else {\r\n                    if (altKey.latex) {\r\n                        markup +=\r\n                            ' data-latex=\"' +\r\n                            altKey.latex.replace(/\"/g, '&quot;') +\r\n                            '\"';\r\n                    }\r\n                    if (altKey.content) {\r\n                        markup +=\r\n                            ' data-content=\"' +\r\n                            altKey.content.replace(/\"/g, '&quot;') +\r\n                            '\"';\r\n                    }\r\n                    if (altKey.insert) {\r\n                        markup +=\r\n                            ' data-insert=\"' +\r\n                            altKey.insert.replace(/\"/g, '&quot;') +\r\n                            '\"';\r\n                    }\r\n                    if (altKey.command) {\r\n                        markup +=\r\n                            \" data-command='\" +\r\n                            altKey.command.replace(/\"/g, '&quot;') +\r\n                            \"'\";\r\n                    }\r\n                    if (altKey.aside) {\r\n                        markup +=\r\n                            ' data-aside=\"' +\r\n                            altKey.aside.replace(/\"/g, '&quot;') +\r\n                            '\"';\r\n                    }\r\n                    if (altKey.classes) {\r\n                        markup += ' data-classes=\"' + altKey.classes + '\"';\r\n                    }\r\n                }\r\n                markup += '>';\r\n                markup += altKey.label || '';\r\n                markup += '</li>';\r\n            }\r\n            markup = '<ul>' + markup + '</ul>';\r\n            altContainer.innerHTML = mathfield.options.createHTML(markup);\r\n            makeKeycap(\r\n                mathfield,\r\n                [].slice.call(altContainer.getElementsByTagName('li')),\r\n                'performAlternateKeys'\r\n            );\r\n            const keycapEl = mathfield.virtualKeyboard.querySelector(\r\n                'div.keyboard-layer.is-visible div.rows ul li[data-alt-keys=\"' +\r\n                    keycap +\r\n                    '\"]'\r\n            );\r\n            const position = keycapEl.getBoundingClientRect();\r\n            if (position) {\r\n                if (position.top - altContainer.clientHeight < 0) {\r\n                    // altContainer.style.maxWidth = '320px';  // Up to six columns\r\n                    altContainer.style.width = 'auto';\r\n                    if (altKeys.length <= 6) {\r\n                        altContainer.style.height = '56px'; // 1 row\r\n                    } else if (altKeys.length <= 12) {\r\n                        altContainer.style.height = '108px'; // 2 rows\r\n                    } else {\r\n                        altContainer.style.height = '205px'; // 3 rows\r\n                    }\r\n                }\r\n                const top =\r\n                    (position.top - altContainer.clientHeight + 5).toString() +\r\n                    'px';\r\n                const left =\r\n                    Math.max(\r\n                        0,\r\n                        Math.min(\r\n                            window.innerWidth - altContainer.offsetWidth,\r\n                            (position.left +\r\n                                position.right -\r\n                                altContainer.offsetWidth) /\r\n                                2\r\n                        )\r\n                    ) + 'px';\r\n                altContainer.style.transform =\r\n                    'translate(' + left + ',' + top + ')';\r\n                altContainer.classList.add('is-visible');\r\n            }\r\n            return false;\r\n        },\r\n    },\r\n    { target: 'virtual-keyboard' }\r\n);\r\n\r\nexport function switchKeyboardLayer(\r\n    mathfield: MathfieldPrivate,\r\n    layer: string\r\n): boolean {\r\n    if (mathfield.options.virtualKeyboardMode !== 'off') {\r\n        if (\r\n            layer !== 'lower-command' &&\r\n            layer !== 'upper-command' &&\r\n            layer !== 'symbols-command'\r\n        ) {\r\n            // If we switch to a non-command keyboard layer, first exit command mode.\r\n            complete(mathfield, 'accept');\r\n        }\r\n        showVirtualKeyboard(mathfield);\r\n        // If the alternate keys panel was visible, hide it\r\n        hideAlternateKeys(mathfield);\r\n        // If we were in a temporarily shifted state (shift-key held down)\r\n        // restore our state before switching to a new layer.\r\n        unshiftKeyboardLayer(mathfield);\r\n        const layers = mathfield.virtualKeyboard.getElementsByClassName(\r\n            'keyboard-layer'\r\n        );\r\n        // Search for the requested layer\r\n        let found = false;\r\n        for (let i = 0; i < layers.length; i++) {\r\n            if ((layers[i] as HTMLElement).dataset.layer === layer) {\r\n                found = true;\r\n                break;\r\n            }\r\n        }\r\n        // We did find the layer, switch to it.\r\n        // If we didn't find it, do nothing and keep the current layer\r\n        if (found) {\r\n            for (let i = 0; i < layers.length; i++) {\r\n                if ((layers[i] as HTMLElement).dataset.layer === layer) {\r\n                    layers[i].classList.add('is-visible');\r\n                } else {\r\n                    layers[i].classList.remove('is-visible');\r\n                }\r\n            }\r\n        }\r\n        mathfield.focus();\r\n    }\r\n    return true;\r\n}\r\n\r\n/*\r\n * Temporarily change the labels and the command of the keys\r\n * (for example when a modifier key is held down.)\r\n */\r\nregisterCommand(\r\n    {\r\n        shiftKeyboardLayer: (mathfield: MathfieldPrivate) => {\r\n            const keycaps = mathfield.virtualKeyboard.querySelectorAll(\r\n                'div.keyboard-layer.is-visible .rows .keycap, div.keyboard-layer.is-visible .rows .action'\r\n            );\r\n            if (keycaps) {\r\n                for (let i = 0; i < keycaps.length; i++) {\r\n                    const keycap = keycaps[i];\r\n                    let shiftedContent = keycap.getAttribute('data-shifted');\r\n                    if (shiftedContent || /^[a-z]$/.test(keycap.innerHTML)) {\r\n                        keycap.setAttribute(\r\n                            'data-unshifted-content',\r\n                            keycap.innerHTML\r\n                        );\r\n                        if (!shiftedContent) {\r\n                            shiftedContent = keycap.innerHTML.toUpperCase();\r\n                        }\r\n                        keycap.innerHTML = mathfield.options.createHTML(\r\n                            shiftedContent\r\n                        );\r\n                        const command = keycap.getAttribute(\r\n                            'data-' + mathfield.options.namespace + 'command'\r\n                        );\r\n                        if (command) {\r\n                            keycap.setAttribute(\r\n                                'data-unshifted-command',\r\n                                command\r\n                            );\r\n                            const shifteCommand = keycap.getAttribute(\r\n                                'data-shifted-command'\r\n                            );\r\n                            if (shifteCommand) {\r\n                                keycap.setAttribute(\r\n                                    'data-' +\r\n                                        mathfield.options.namespace +\r\n                                        'command',\r\n                                    shifteCommand\r\n                                );\r\n                            } else {\r\n                                const commandObj = JSON.parse(command);\r\n                                if (isArray(commandObj)) {\r\n                                    commandObj[1] = commandObj[1].toUpperCase();\r\n                                }\r\n                                keycap.setAttribute(\r\n                                    'data-' +\r\n                                        mathfield.options.namespace +\r\n                                        'command',\r\n                                    JSON.stringify(commandObj)\r\n                                );\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return false;\r\n        },\r\n    },\r\n    { target: 'virtual-keyboard' }\r\n);\r\n\r\nregisterCommand(\r\n    {\r\n        hideAlternateKeys: (mathfield: MathfieldPrivate) =>\r\n            hideAlternateKeys(mathfield),\r\n\r\n        /*\r\n         * The command invoked when an alternate key is pressed.\r\n         * We need to hide the Alternate Keys panel, then perform the\r\n         * command.\r\n         */\r\n        performAlternateKeys: (mathfield: MathfieldPrivate, command) => {\r\n            hideAlternateKeys(mathfield);\r\n            return mathfield.executeCommand(command);\r\n        },\r\n        switchKeyboardLayer: (mathfield: MathfieldPrivate, layer) =>\r\n            switchKeyboardLayer(mathfield, layer),\r\n        unshiftKeyboardLayer: (mathfield: MathfieldPrivate) =>\r\n            unshiftKeyboardLayer(mathfield),\r\n\r\n        insertAndUnshiftKeyboardLayer: (mathfield: MathfieldPrivate, c) => {\r\n            mathfield.insert(c);\r\n            unshiftKeyboardLayer(mathfield);\r\n            return true;\r\n        },\r\n    },\r\n    { target: 'virtual-keyboard' }\r\n);\r\n\r\nregisterCommand(\r\n    {\r\n        /* Toggle the virtual keyboard, but switch to the alternate theme if available */\r\n        toggleVirtualKeyboardAlt: (mathfield: MathfieldPrivate) => {\r\n            let hadAltTheme = false;\r\n            if (mathfield.virtualKeyboard) {\r\n                hadAltTheme = mathfield.virtualKeyboard.classList.contains(\r\n                    'material'\r\n                );\r\n                mathfield.virtualKeyboard.remove();\r\n                delete mathfield.virtualKeyboard;\r\n                mathfield.virtualKeyboard = null;\r\n            }\r\n            showVirtualKeyboard(mathfield, hadAltTheme ? '' : 'material');\r\n            return false;\r\n        },\r\n        /** Toggle the virtual keyboard, but switch another keyboard layout */\r\n        toggleVirtualKeyboardShift: (mathfield: MathfieldPrivate) => {\r\n            mathfield.options.virtualKeyboardLayout = {\r\n                qwerty: 'azerty',\r\n\r\n                azerty: 'qwertz',\r\n                qwertz: 'dvorak',\r\n                dvorak: 'colemak',\r\n                colemak: 'qwerty',\r\n            }[mathfield.options.virtualKeyboardLayout];\r\n            const layer =\r\n                mathfield.virtualKeyboard?.querySelector(\r\n                    'div.keyboard-layer.is-visible'\r\n                ).id ?? '';\r\n            if (mathfield.virtualKeyboard) {\r\n                mathfield.virtualKeyboard.remove();\r\n                delete mathfield.virtualKeyboard;\r\n                mathfield.virtualKeyboard = null;\r\n            }\r\n            showVirtualKeyboard(mathfield);\r\n            if (layer) {\r\n                switchKeyboardLayer(mathfield, layer);\r\n            }\r\n            return false;\r\n        },\r\n    },\r\n    { target: 'virtual-keyboard' }\r\n);\r\n\r\nexport function showVirtualKeyboard(\r\n    mathfield: MathfieldPrivate,\r\n    theme: 'apple' | 'material' | '' = ''\r\n): boolean {\r\n    mathfield.virtualKeyboardVisible = false;\r\n    toggleVirtualKeyboard(mathfield, theme);\r\n    return false;\r\n}\r\n\r\nexport function hideVirtualKeyboard(mathfield: MathfieldPrivate): boolean {\r\n    mathfield.virtualKeyboardVisible = true;\r\n    toggleVirtualKeyboard(mathfield);\r\n    return false;\r\n}\r\n\r\nfunction toggleVirtualKeyboard(\r\n    mathfield: MathfieldPrivate,\r\n    theme?: 'apple' | 'material' | ''\r\n): boolean {\r\n    mathfield.virtualKeyboardVisible = !mathfield.virtualKeyboardVisible;\r\n    if (mathfield.virtualKeyboardVisible) {\r\n        mathfield.focus();\r\n        if (mathfield.virtualKeyboard) {\r\n            mathfield.virtualKeyboard.classList.add('is-visible');\r\n        } else {\r\n            // Construct the virtual keyboard\r\n            mathfield.virtualKeyboard = makeKeyboard(mathfield, theme);\r\n            // Let's make sure that tapping on the keyboard focuses the field\r\n            on(\r\n                mathfield.virtualKeyboard,\r\n                'touchstart:passive mousedown',\r\n                () => {\r\n                    mathfield.focus();\r\n                }\r\n            );\r\n            document.body.appendChild(mathfield.virtualKeyboard);\r\n        }\r\n        // For the transition effect to work, the property has to be changed\r\n        // after the insertion in the DOM. Use setTimeout\r\n        window.setTimeout(() => {\r\n            mathfield.virtualKeyboard.classList.add('is-visible');\r\n        }, 1);\r\n    } else if (mathfield.virtualKeyboard) {\r\n        mathfield.virtualKeyboard.classList.remove('is-visible');\r\n    }\r\n    if (typeof mathfield.options.onVirtualKeyboardToggle === 'function') {\r\n        mathfield.options.onVirtualKeyboardToggle(\r\n            mathfield,\r\n            mathfield.virtualKeyboardVisible,\r\n            mathfield.virtualKeyboard\r\n        );\r\n    }\r\n    return false;\r\n}\r\n\r\nregisterCommand(\r\n    {\r\n        toggleVirtualKeyboard: (mathfield: MathfieldPrivate, theme) =>\r\n            toggleVirtualKeyboard(mathfield, theme),\r\n        hideVirtualKeyboard: (mathfield: MathfieldPrivate) =>\r\n            hideVirtualKeyboard(mathfield),\r\n        showVirtualKeyboard: (mathfield: MathfieldPrivate, theme): boolean =>\r\n            showVirtualKeyboard(mathfield, theme),\r\n    },\r\n    { target: 'virtual-keyboard' }\r\n);\r\n","import type { ParseMode, Style } from '../public/core';\r\nimport type { Keybinding, KeyboardLayoutName } from '../public/options';\r\nimport type {\r\n    Mathfield,\r\n    InsertOptions,\r\n    OutputFormat,\r\n    Offset,\r\n    Range,\r\n    Selection,\r\n} from '../public/mathfield';\r\n\r\nimport { Atom } from '../core/atom-class';\r\n\r\nimport { loadFonts } from '../core/fonts';\r\nimport { Stylesheet, inject as injectStylesheet } from '../common/stylesheet';\r\n\r\nimport {\r\n    deleteRange,\r\n    getCommandAtoms,\r\n    getCommandRange,\r\n    ModelPrivate,\r\n} from '../editor/model';\r\nimport { applyStyle } from '../editor-model/styling';\r\nimport { delegateKeyboardEvents, KeyboardDelegate } from '../editor/keyboard';\r\nimport { UndoRecord, UndoManager } from '../editor/undo';\r\nimport { hidePopover, updatePopoverPosition } from '../editor/popover';\r\nimport { localize as l10n } from '../editor/l10n';\r\nimport {\r\n    HAPTIC_FEEDBACK_DURATION,\r\n    SelectorPrivate,\r\n    perform,\r\n} from '../editor/commands';\r\nimport { getMode } from '../editor-model/selection';\r\nimport { find } from '../editor-model/find';\r\nimport { acceptCommandSuggestion, complete } from '../editor/autocomplete';\r\nimport { requestUpdate } from './render';\r\nimport {\r\n    MathfieldOptionsPrivate,\r\n    update as updateOptions,\r\n    getDefault as getDefaultOptions,\r\n    get as getOptions,\r\n} from '../editor/options';\r\nimport {\r\n    insert,\r\n    removeComposition,\r\n    updateComposition,\r\n} from '../editor-model/insert';\r\nimport { addRowAfter, addColumnAfter } from '../editor-model/array';\r\nimport { onTypedText, onKeystroke } from './keyboard-input';\r\nimport { render } from './render';\r\n\r\nimport './commands';\r\nimport './styling';\r\n\r\nimport {\r\n    getCaretPoint,\r\n    getSelectionBounds,\r\n    getSharedElement,\r\n    releaseSharedElement,\r\n    isValidMathfield,\r\n    on,\r\n    off,\r\n} from './utils';\r\n\r\nimport { onCut, onCopy, onPaste } from './clipboard';\r\nimport { attachButtonHandlers } from './buttons';\r\nimport { onPointerDown, offsetFromPoint } from './pointer-input';\r\nimport {\r\n    showVirtualKeyboard,\r\n    hideVirtualKeyboard,\r\n    switchKeyboardLayer,\r\n} from '../editor/virtual-keyboard-commands';\r\n\r\nimport { normalizeKeybindings } from '../editor/keybindings';\r\nimport {\r\n    setKeyboardLayoutLocale,\r\n    getActiveKeyboardLayout,\r\n} from '../editor/keyboard-layout';\r\n\r\nimport { updateUndoRedoButtons } from '../editor/virtual-keyboard';\r\n\r\n// @ts-ignore\r\nimport mathfieldStylesheet from '../../css/mathfield.less';\r\n// @ts-ignore\r\nimport coreStylesheet from '../../css/core.less';\r\n\r\n// @ts-ignore\r\nimport popoverStylesheet from '../../css/popover.less';\r\n// @ts-ignore\r\nimport keystrokeCaptionStylesheet from '../../css/keystroke-caption.less';\r\nimport { range } from '../editor-model/selection-utils';\r\nimport { CommandAtom } from '../core-atoms/command';\r\n\r\nexport class MathfieldPrivate implements Mathfield {\r\n    model: ModelPrivate;\r\n    options: Required<MathfieldOptionsPrivate>;\r\n\r\n    private undoManager: UndoManager;\r\n\r\n    private blurred: boolean;\r\n    // The value of the mathfield when it is focussed.\r\n    // If this value is different when the field is blured\r\n    // the `onCommit` listener is triggered\r\n    private valueOnFocus: string;\r\n    dirty: boolean; // If true, need to be redrawn\r\n    smartModeSuppressed: boolean;\r\n    private resizeTimer: number; // Timer handle\r\n\r\n    element: HTMLElement;\r\n    /** @deprecated */\r\n    readonly originalContent: string;\r\n\r\n    private stylesheets: Stylesheet[] = [];\r\n\r\n    keyboardDelegate: KeyboardDelegate;\r\n    field: HTMLElement;\r\n    fieldContent: HTMLElement;\r\n    virtualKeyboardToggle: HTMLElement;\r\n    ariaLiveText: HTMLElement;\r\n    accessibleNode: HTMLElement;\r\n    popover: HTMLElement;\r\n\r\n    keystrokeCaptionVisible: boolean;\r\n    keystrokeCaption: HTMLElement;\r\n\r\n    virtualKeyboardVisible: boolean;\r\n    virtualKeyboard: HTMLElement;\r\n\r\n    keybindings: Keybinding[]; // Normalized keybindings (raw ones in config)\r\n    keyboardLayout: KeyboardLayoutName;\r\n\r\n    keystrokeBuffer: string;\r\n    keystrokeBufferStates: UndoRecord[];\r\n    keystrokeBufferResetTimer: ReturnType<typeof setTimeout>;\r\n\r\n    suggestionIndex: number;\r\n\r\n    mode: ParseMode;\r\n    style: Style;\r\n\r\n    private eventHandlingInProgress = '';\r\n\r\n    keypressSound: HTMLAudioElement;\r\n    spacebarKeypressSound: HTMLAudioElement;\r\n    returnKeypressSound: HTMLAudioElement;\r\n    deleteKeypressSound: HTMLAudioElement;\r\n    plonkSound: HTMLAudioElement;\r\n\r\n    /**\r\n     * To create a mathfield, you would typically use {@linkcode makeMathField | MathLive.makeMathField()}\r\n     * instead of invoking directly this constructor.\r\n     *\r\n     *\r\n     * @param element - The DOM element that this mathfield is attached to.\r\n     * Note that `element.mathfield` is this object.\r\n     */\r\n    constructor(\r\n        element: HTMLElement,\r\n        options: Partial<MathfieldOptionsPrivate>\r\n    ) {\r\n        // Setup default config options\r\n        this.options = updateOptions(getDefaultOptions(), {\r\n            plonkSound: 'plonk.wav',\r\n            keypressSound: {\r\n                spacebar: 'keypress-spacebar.wav',\r\n                return: 'keypress-return.wav',\r\n                delete: 'keypress-delete.wav',\r\n                default: 'keypress-standard.wav',\r\n            },\r\n            ...options,\r\n        });\r\n\r\n        this.plonkSound = this.options.plonkSound as HTMLAudioElement;\r\n        if (\r\n            typeof this.options.keypressSound !== 'string' &&\r\n            !(this.options.keypressSound instanceof HTMLAudioElement)\r\n        ) {\r\n            this.keypressSound = this.options.keypressSound\r\n                .default as HTMLAudioElement;\r\n            this.spacebarKeypressSound = this.options.keypressSound\r\n                .spacebar as HTMLAudioElement;\r\n            this.returnKeypressSound = this.options.keypressSound\r\n                .return as HTMLAudioElement;\r\n            this.deleteKeypressSound = this.options.keypressSound\r\n                .delete as HTMLAudioElement;\r\n        }\r\n\r\n        this.element = element;\r\n        element['mathfield'] = this;\r\n\r\n        // Save existing content\r\n        this.originalContent = element.innerHTML;\r\n        let elementText = this.element.textContent;\r\n        if (elementText) {\r\n            elementText = elementText.trim();\r\n        }\r\n\r\n        // Load the fonts, inject the core and mathfield stylesheets\r\n        loadFonts(this.options.fontsDirectory, this.options.onError);\r\n        this.stylesheets.push(injectStylesheet(element, coreStylesheet));\r\n        this.stylesheets.push(injectStylesheet(element, mathfieldStylesheet));\r\n\r\n        // Additional elements used for UI.\r\n        // They are retrieved in order a bit later, so they need to be kept in sync\r\n        // 1.0/ The field, where the math equation will be displayed\r\n        // 1.1/ The virtual keyboard toggle\r\n        // 2/ The popover panel which displays info in command mode\r\n        // 3/ The keystroke caption panel (option+shift+K)\r\n        // 4/ The virtual keyboard\r\n        // 5.0/ The area to stick MathML for screen reading larger exprs (not used right now)\r\n        //      The for the area is that focus would bounce their and then back triggering the\r\n        //         screen reader to read it\r\n        // 5.1/ The aria-live region for announcements\r\n        let markup = '';\r\n        if (!this.options.substituteTextArea) {\r\n            if (/android|ipad|ipod|iphone/i.test(navigator?.userAgent)) {\r\n                // On Android or iOS, don't use a textarea, which has the side effect of\r\n                // bringing up the OS virtual keyboard\r\n                markup += `<span class='ML__textarea'>\r\n                <span class='ML__textarea__textarea'\r\n                    tabindex=\"-1\" role=\"textbox\"\r\n                    style='display:inline-block;height:1px;width:1px' >\r\n                </span>\r\n            </span>`;\r\n            } else {\r\n                markup +=\r\n                    '<span class=\"ML__textarea\">' +\r\n                    '<textarea class=\"ML__textarea__textarea\" autocapitalize=\"off\" autocomplete=\"off\" ' +\r\n                    `autocorrect=\"off\" spellcheck=\"false\" aria-hidden=\"true\" tabindex=\"${\r\n                        element.tabIndex ?? 0\r\n                    }\">` +\r\n                    '</textarea>' +\r\n                    '</span>';\r\n            }\r\n        } else {\r\n            if (typeof this.options.substituteTextArea === 'string') {\r\n                markup += this.options.substituteTextArea;\r\n            } else {\r\n                // We don't really need this one, but we keep it here so that the\r\n                // indexes below remain the same whether a substituteTextArea is\r\n                // provided or not.\r\n                markup += '<span></span>';\r\n            }\r\n        }\r\n        markup +=\r\n            '<span class=\"ML__fieldcontainer\">' +\r\n            '<span class=\"ML__fieldcontainer__field\"></span>';\r\n\r\n        // Only display the virtual keyboard toggle if the virtual keyboard mode is\r\n        // 'manual'\r\n        if (this.options.virtualKeyboardMode === 'manual') {\r\n            markup += `<div part='virtual-keyboard-toggle' class=\"ML__virtual-keyboard-toggle\" role=\"button\" data-ML__tooltip=\"${l10n(\r\n                'tooltip.toggle virtual keyboard'\r\n            )}\">`;\r\n            // data-ML__tooltip='Toggle Virtual Keyboard'\r\n            if (this.options.virtualKeyboardToggleGlyph) {\r\n                markup += this.options.virtualKeyboardToggleGlyph;\r\n            } else {\r\n                markup += `<span style=\"width: 21px; margin-top: 4px;\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 576 512\"><path d=\"M528 64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h480c26.51 0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm16 336c0 8.823-7.177 16-16 16H48c-8.823 0-16-7.177-16-16V112c0-8.823 7.177-16 16-16h480c8.823 0 16 7.177 16 16v288zM168 268v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm-336 80v-24c0-6.627-5.373-12-12-12H84c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm384 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zM120 188v-24c0-6.627-5.373-12-12-12H84c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm-96 152v-8c0-6.627-5.373-12-12-12H180c-6.627 0-12 5.373-12 12v8c0 6.627 5.373 12 12 12h216c6.627 0 12-5.373 12-12z\"/></svg></span>`;\r\n            }\r\n            markup += '</div>';\r\n        } else {\r\n            markup += '<span ></span>';\r\n        }\r\n        markup += '</span>';\r\n        markup += `\r\n        <div class=\"ML__sr-only\">\r\n            <span aria-live=\"assertive\" aria-atomic=\"true\"></span>\r\n            <span></span>\r\n        </div>\r\n    `;\r\n\r\n        this.element.innerHTML = this.options.createHTML(markup);\r\n        if (!this.element.children) {\r\n            console.error(\r\n                '%cMathlive: Something went wrong and the mathfield could not be created.%c\\n' +\r\n                    'If you are using Vue, this may be because you are using the ' +\r\n                    'runtime-only build of Vue. Make sure to include ' +\r\n                    \"'runtimeCompiler: true' in your Vue configuration. There\" +\r\n                    'may a warning from Vue in the log above.',\r\n\r\n                'color:red;font-family:system-ui;font-size:1.2rem;font-weight:bold',\r\n                'color:inherith;font-family:system-ui;font-size:inherit;font-weight:inherit'\r\n            );\r\n            return null;\r\n        }\r\n\r\n        let iChild = 0; // index of child -- used to make changes below easier\r\n        let textarea: HTMLElement;\r\n        if (typeof this.options.substituteTextArea === 'function') {\r\n            textarea = this.options.substituteTextArea();\r\n        } else {\r\n            textarea = this.element.children[iChild++]\r\n                .firstElementChild as HTMLElement;\r\n        }\r\n        this.field = this.element.children[iChild].children[0] as HTMLElement;\r\n        // Listen to 'wheel' events to scroll (horizontally) the field when it overflows\r\n        this.field.addEventListener(\r\n            'wheel',\r\n            (ev) => {\r\n                ev.preventDefault();\r\n                ev.stopPropagation();\r\n                const wheelDelta =\r\n                    typeof ev.deltaX === 'undefined' ? ev.detail : -ev.deltaX;\r\n                if (isFinite(wheelDelta)) {\r\n                    this.field.scroll({\r\n                        top: 0,\r\n                        left: this.field.scrollLeft - wheelDelta * 5,\r\n                    });\r\n                }\r\n            },\r\n            { passive: false }\r\n        );\r\n\r\n        // When fonts are done loading, re-render\r\n        // (the selection state may be out of date)\r\n        document.fonts.ready.then(() => {\r\n            render(this);\r\n        });\r\n\r\n        this.virtualKeyboardToggle = this.element.children[iChild++]\r\n            .children[1] as HTMLElement;\r\n        attachButtonHandlers(this, this.virtualKeyboardToggle, {\r\n            default: 'toggleVirtualKeyboard',\r\n            alt: 'toggleVirtualKeyboardAlt',\r\n            shift: 'toggleVirtualKeyboardShift',\r\n        });\r\n        this.ariaLiveText = this.element.children[iChild]\r\n            .children[0] as HTMLElement;\r\n        this.accessibleNode = this.element.children[iChild++]\r\n            .children[1] as HTMLElement;\r\n        // Some panels are shared amongst instances of mathfield\r\n        // (there's a single instance in the document)\r\n        this.popover = getSharedElement(\r\n            'mathlive-popover-panel',\r\n            'ML__popover'\r\n        );\r\n        this.stylesheets.push(injectStylesheet(null, popoverStylesheet));\r\n        this.keystrokeCaption = getSharedElement(\r\n            'mathlive-keystroke-caption-panel',\r\n            'ML__keystroke-caption'\r\n        );\r\n        this.stylesheets.push(\r\n            injectStylesheet(null, keystrokeCaptionStylesheet)\r\n        );\r\n        // The keystroke caption panel and the command bar are\r\n        // initially hidden\r\n        this.keystrokeCaptionVisible = false;\r\n        this.virtualKeyboardVisible = false;\r\n        this.keystrokeBuffer = '';\r\n        this.keystrokeBufferStates = [];\r\n        this.keystrokeBufferResetTimer = null;\r\n        // This index indicates which of the suggestions available to\r\n        // display in the popover panel\r\n        this.suggestionIndex = 0;\r\n        // The input mode (text, math, command)\r\n        // While getAnchorMode() represent the mode of the current selection,\r\n        // this.mode is the mode chosen by the user. It indicates the mode the\r\n        // next character typed will be interpreted in.\r\n        // It is often identical to getAnchorMode() since changing the selection\r\n        // changes the mode, but sometimes it is not, for example when a user\r\n        // enters a mode changing command.\r\n        this.mode = this.options.defaultMode;\r\n        this.smartModeSuppressed = false;\r\n        // Current style (color, weight, italic, etc...):\r\n        // reflects the style to be applied on next insertion.\r\n        this.style = {};\r\n        // Focus/blur state\r\n        this.blurred = true;\r\n        on(this.element, 'focus', this);\r\n        on(this.element, 'blur', this);\r\n        // Capture clipboard events\r\n        // Delegate keyboard events\r\n        this.keyboardDelegate = delegateKeyboardEvents(\r\n            textarea as HTMLTextAreaElement,\r\n            {\r\n                typedText: (text: string): void => onTypedText(this, text),\r\n                cut: () => onCut(this),\r\n                copy: (ev) => onCopy(this, ev),\r\n                paste: (ev) => onPaste(this, ev),\r\n                keystroke: (keystroke, e) => onKeystroke(this, keystroke, e),\r\n                focus: () => this.onFocus(),\r\n                blur: () => this.onBlur(),\r\n                compositionStart: (composition: string) =>\r\n                    this.onCompositionStart(composition),\r\n                compositionUpdate: (composition: string) =>\r\n                    this.onCompositionUpdate(composition),\r\n                compositionEnd: (composition: string) =>\r\n                    this.onCompositionEnd(composition),\r\n            }\r\n        );\r\n\r\n        // Delegate mouse and touch events\r\n        if (window.PointerEvent) {\r\n            // Use modern pointer events if available\r\n            on(this.field, 'pointerdown', this);\r\n        } else {\r\n            on(this.field, 'touchstart:active mousedown', this);\r\n        }\r\n\r\n        // Request notification for when the window is resized (\r\n        // or the device switched from portrait to landscape) to adjust\r\n        // the UI (popover, etc...)\r\n        on(window, 'resize', this);\r\n\r\n        // Setup the model\r\n        this.model = new ModelPrivate(\r\n            {\r\n                mode: this.options.defaultMode,\r\n                macros: this.options.macros,\r\n                removeExtraneousParentheses: this.options\r\n                    .removeExtraneousParentheses,\r\n            },\r\n            {\r\n                onContentDidChange: (_sender: ModelPrivate): void =>\r\n                    this.options.onContentDidChange(this),\r\n                onSelectionDidChange: (_sender: ModelPrivate): void =>\r\n                    this._onSelectionDidChange(),\r\n                onContentWillChange: (): void =>\r\n                    this.options.onContentWillChange(this),\r\n                onSelectionWillChange: (): void =>\r\n                    this.options.onSelectionWillChange(this),\r\n                onError: this.options.onError,\r\n            },\r\n            {\r\n                announce: (\r\n                    _sender: Mathfield,\r\n                    command: string,\r\n                    previousPosition: number,\r\n                    atoms: Atom[]\r\n                ): void =>\r\n                    this.options.onAnnounce?.(\r\n                        this,\r\n                        command,\r\n                        previousPosition,\r\n                        atoms\r\n                    ),\r\n                moveOut: (_sender, direction): boolean =>\r\n                    this.options.onMoveOutOf(this, direction),\r\n                tabOut: (_sender, direction): boolean =>\r\n                    this.options.onTabOutOf(this, direction),\r\n            },\r\n            this\r\n        );\r\n\r\n        // Prepare to manage undo/redo\r\n        this.undoManager = new UndoManager(this.model);\r\n\r\n        // Use the content of the element for the initial value of the mathfield\r\n        if (elementText) {\r\n            insert(this.model, elementText, {\r\n                insertionMode: 'replaceAll',\r\n                selectionMode: 'after',\r\n                format: 'latex',\r\n                mode: 'math',\r\n                suppressChangeNotifications: true,\r\n                macros: this.options.macros,\r\n            });\r\n        }\r\n\r\n        // Now start recording potentially undoable actions\r\n        this.undoManager.startRecording();\r\n        this.undoManager.snapshot(this.options);\r\n\r\n        this.model.setListeners({\r\n            onContentDidChange: (_sender: ModelPrivate) =>\r\n                this.options.onContentDidChange(this),\r\n            onSelectionDidChange: (_sender: ModelPrivate) =>\r\n                this._onSelectionDidChange(),\r\n            onContentWillChange: () => this.options.onContentWillChange(this),\r\n            onSelectionWillChange: () =>\r\n                this.options.onSelectionWillChange(this),\r\n            onError: this.options.onError,\r\n        });\r\n        this.model.setHooks({\r\n            announce: (_sender: Mathfield, command, previousPosition, atoms) =>\r\n                this.options.onAnnounce?.(\r\n                    this,\r\n                    command,\r\n                    previousPosition,\r\n                    atoms\r\n                ),\r\n            moveOut: (_sender, direction) =>\r\n                this.options.onMoveOutOf(this, direction),\r\n            tabOut: (_sender, direction) =>\r\n                this.options.onTabOutOf(this, direction),\r\n        });\r\n\r\n        if (!this.options.locale.startsWith(getActiveKeyboardLayout().locale)) {\r\n            setKeyboardLayoutLocale(this.options.locale);\r\n        }\r\n        this.keybindings = normalizeKeybindings(\r\n            this.options.keybindings,\r\n            (e) => {\r\n                if (typeof this.options.onError === 'function') {\r\n                    this.options.onError({\r\n                        code: 'invalid-keybinding',\r\n                        arg: e.join('\\n'),\r\n                    });\r\n                }\r\n                console.log(e.join('\\n'));\r\n            }\r\n        );\r\n        requestUpdate(this);\r\n    }\r\n\r\n    /** @deprecated */\r\n    $setConfig(config: Partial<MathfieldOptionsPrivate>): void {\r\n        deprecated('$setConfig');\r\n        this.setOptions(config);\r\n    }\r\n    setOptions(config: Partial<MathfieldOptionsPrivate>): void {\r\n        this.options = updateOptions(this.options, config);\r\n        this.model.setListeners({\r\n            onContentDidChange: (_sender: ModelPrivate) =>\r\n                this.options.onContentDidChange(this),\r\n            onSelectionDidChange: (_sender: ModelPrivate) =>\r\n                this._onSelectionDidChange(),\r\n            onContentWillChange: () => this.options.onContentWillChange(this),\r\n            onSelectionWillChange: () =>\r\n                this.options.onSelectionWillChange(this),\r\n            onError: this.options.onError,\r\n        });\r\n        this.model.setHooks({\r\n            announce: (_sender: Mathfield, command, previousPosition, atoms) =>\r\n                this.options.onAnnounce?.(\r\n                    this,\r\n                    command,\r\n                    previousPosition,\r\n                    atoms\r\n                ),\r\n            moveOut: (_sender, direction) =>\r\n                this.options.onMoveOutOf(this, direction),\r\n            tabOut: (_sender, direction) =>\r\n                this.options.onTabOutOf(this, direction),\r\n        });\r\n\r\n        if (!this.options.locale.startsWith(getActiveKeyboardLayout().locale)) {\r\n            setKeyboardLayoutLocale(this.options.locale);\r\n        }\r\n        this.keybindings = normalizeKeybindings(\r\n            this.options.keybindings,\r\n            (e) => {\r\n                if (typeof this.options.onError === 'function') {\r\n                    this.options.onError({\r\n                        code: 'invalid-keybinding',\r\n                        arg: e.join('\\n'),\r\n                    });\r\n                }\r\n                console.log(e.join('\\n'));\r\n            }\r\n        );\r\n\r\n        this.plonkSound = this.options.plonkSound as HTMLAudioElement;\r\n        if (\r\n            typeof this.options.keypressSound !== 'string' &&\r\n            !(this.options.keypressSound instanceof HTMLAudioElement)\r\n        ) {\r\n            this.keypressSound = this.options.keypressSound\r\n                .default as HTMLAudioElement;\r\n            this.spacebarKeypressSound = this.options.keypressSound\r\n                .spacebar as HTMLAudioElement;\r\n            this.returnKeypressSound = this.options.keypressSound\r\n                .return as HTMLAudioElement;\r\n            this.deleteKeypressSound = this.options.keypressSound\r\n                .delete as HTMLAudioElement;\r\n        }\r\n\r\n        if (!this.options.readOnly) {\r\n            this.onBlur();\r\n        }\r\n        // Changing some config options (i.e. `macros`) may\r\n        // require the content to be reparsed and re-rendered\r\n        const content = Atom.toLatex(this.model.root, { expandMacro: false });\r\n        insert(this.model, content, {\r\n            insertionMode: 'replaceAll',\r\n            selectionMode: 'after',\r\n            format: 'latex',\r\n            mode: 'math',\r\n            suppressChangeNotifications: true,\r\n            macros: this.options.macros,\r\n        });\r\n        requestUpdate(this);\r\n    }\r\n\r\n    /** @deprecated */\r\n    getConfig<K extends keyof MathfieldOptionsPrivate>(\r\n        keys: K[]\r\n    ): Pick<MathfieldOptionsPrivate, K>;\r\n    /** @deprecated */\r\n    getConfig<K extends keyof MathfieldOptionsPrivate>(\r\n        key: K\r\n    ): MathfieldOptionsPrivate[K];\r\n    /** @deprecated */\r\n    getConfig(): MathfieldOptionsPrivate;\r\n    /** @deprecated */\r\n    getConfig(\r\n        keys?: keyof MathfieldOptionsPrivate | (keyof MathfieldOptionsPrivate)[]\r\n    ): any | Partial<MathfieldOptionsPrivate> {\r\n        deprecated('getConfig');\r\n        return getOptions(this.options, keys);\r\n    }\r\n\r\n    getOptions<K extends keyof MathfieldOptionsPrivate>(\r\n        keys: K[]\r\n    ): Pick<MathfieldOptionsPrivate, K>;\r\n    getOptions(): MathfieldOptionsPrivate;\r\n    getOptions(\r\n        keys?: keyof MathfieldOptionsPrivate | (keyof MathfieldOptionsPrivate)[]\r\n    ): any | Partial<MathfieldOptionsPrivate> {\r\n        return getOptions(this.options, keys);\r\n    }\r\n    getOption<K extends keyof MathfieldOptionsPrivate>(\r\n        key: K\r\n    ): MathfieldOptionsPrivate[K] {\r\n        return getOptions(this.options, key);\r\n    }\r\n\r\n    /*\r\n     * handleEvent is a function invoked when an event is registered with an\r\n     * object instead ( see `addEventListener()` in `on()`)\r\n     * The name is defined by `addEventListener()` and cannot be changed.\r\n     * This pattern is used to be able to release bound event handlers,\r\n     * (event handlers that need access to `this`) as the bind() function\r\n     * would create a new function that would have to be kept track off\r\n     * to be able to properly remove the event handler later.\r\n     */\r\n    handleEvent(evt: Event): void {\r\n        switch (evt.type) {\r\n            case 'focus':\r\n                if (!this.eventHandlingInProgress) {\r\n                    this.eventHandlingInProgress = 'focus';\r\n                    this.onFocus();\r\n                    this.eventHandlingInProgress = '';\r\n                }\r\n                break;\r\n            case 'blur':\r\n                if (!this.eventHandlingInProgress) {\r\n                    this.eventHandlingInProgress = 'blur';\r\n                    this.onBlur();\r\n                    this.eventHandlingInProgress = '';\r\n                }\r\n                break;\r\n            case 'touchstart':\r\n            case 'mousedown':\r\n                // iOS <=13 Safari and Firefox on Android\r\n                onPointerDown(this, evt as PointerEvent);\r\n                break;\r\n            case 'pointerdown':\r\n                onPointerDown(this, evt as PointerEvent);\r\n                break;\r\n            case 'resize': {\r\n                if (this.resizeTimer) {\r\n                    window.cancelAnimationFrame(this.resizeTimer);\r\n                }\r\n                this.resizeTimer = window.requestAnimationFrame(\r\n                    () => isValidMathfield(this) && this.onResize()\r\n                );\r\n                break;\r\n            }\r\n            default:\r\n                console.warn('Unexpected event type', evt.type);\r\n        }\r\n    }\r\n    /** @deprecated */\r\n    $revertToOriginalContent(): void {\r\n        deprecated('$revertToOriginalContent');\r\n        this.dispose();\r\n        this.element.innerHTML = this.options.createHTML(this.originalContent);\r\n    }\r\n    dispose(): void {\r\n        this.element.innerHTML = '$$' + this.getValue() + '$$';\r\n        delete this.element['mathfield'];\r\n        delete this.accessibleNode;\r\n        delete this.ariaLiveText;\r\n        delete this.field;\r\n        delete this.fieldContent;\r\n        delete this.keyboardDelegate;\r\n        this.virtualKeyboardToggle.remove();\r\n        delete this.virtualKeyboardToggle;\r\n        releaseSharedElement(this.popover);\r\n        delete this.popover;\r\n        releaseSharedElement(this.keystrokeCaption);\r\n        delete this.keystrokeCaption;\r\n        releaseSharedElement(this.virtualKeyboard);\r\n        delete this.virtualKeyboard;\r\n        releaseSharedElement(\r\n            document.getElementById('mathlive-alternate-keys-panel')\r\n        );\r\n        off(this.element, 'pointerdown', this);\r\n        off(this.element, 'touchstart:active mousedown', this);\r\n        off(this.element, 'focus', this);\r\n        off(this.element, 'blur', this);\r\n        off(window, 'resize', this);\r\n        delete this.element;\r\n        this.stylesheets.forEach((x) => x.release());\r\n    }\r\n\r\n    resetKeystrokeBuffer(options?: { defer: boolean }): void {\r\n        options = options ?? { defer: false };\r\n        if (options.defer) {\r\n            if (this.options.inlineShortcutTimeout) {\r\n                // Set a timer to reset the shortcut buffer\r\n                this.keystrokeBufferResetTimer = setTimeout(() => {\r\n                    this.resetKeystrokeBuffer();\r\n                }, this.options.inlineShortcutTimeout);\r\n            }\r\n            return;\r\n        }\r\n        this.keystrokeBuffer = '';\r\n        this.keystrokeBufferStates = [];\r\n        clearTimeout(this.keystrokeBufferResetTimer);\r\n    }\r\n\r\n    private _onSelectionDidChange(): void {\r\n        // Every suggestion atom is now committed\r\n        acceptCommandSuggestion(this.model);\r\n        // Keep the content of the textarea in sync wiht the selection.\r\n        // This will allow cut/copy to work.\r\n        this.keyboardDelegate.setValue(\r\n            this.getValue(this.model.selection, 'latex-expanded')\r\n        );\r\n\r\n        // Update the mode\r\n        {\r\n            const newMode =\r\n                getMode(this.model, this.model.position) ||\r\n                this.options.defaultMode;\r\n            if (this.mode === 'command' && newMode !== 'command') {\r\n                complete(this, 'reject', { mode: newMode });\r\n            } else {\r\n                this.switchMode(newMode);\r\n            }\r\n        }\r\n        // Defer the updating of the popover position: we'll need the tree to be\r\n        // re-rendered first to get an updated caret position\r\n        updatePopoverPosition(this, { deferred: true });\r\n\r\n        // Invoke client listeners, if provided.\r\n        if (typeof this.options.onSelectionDidChange === 'function') {\r\n            this.options.onSelectionDidChange(this);\r\n        }\r\n    }\r\n\r\n    private onFocus(): void {\r\n        if (this.options.readOnly) return;\r\n        if (this.blurred) {\r\n            this.blurred = false;\r\n            this.keyboardDelegate.focus();\r\n            if (this.options.virtualKeyboardMode === 'onfocus') {\r\n                showVirtualKeyboard(this);\r\n            }\r\n            updatePopoverPosition(this);\r\n            if (this.options.onFocus) {\r\n                this.options.onFocus(this);\r\n            }\r\n            // Save the current value.\r\n            // It will be compared in `onBlur()` to see if the\r\n            // `onCommit` listener needs to be invoked. This\r\n            // mimic the `<input>` and `<textarea>` behavior\r\n            this.valueOnFocus = this.getValue();\r\n            requestUpdate(this);\r\n        }\r\n    }\r\n    private onBlur(): void {\r\n        if (!this.blurred) {\r\n            this.blurred = true;\r\n            this.ariaLiveText.textContent = '';\r\n            if (/onfocus|manual/.test(this.options.virtualKeyboardMode)) {\r\n                hideVirtualKeyboard(this);\r\n            }\r\n            complete(this, 'reject');\r\n            requestUpdate(this);\r\n            if (typeof this.options.onBlur === 'function') {\r\n                this.options.onBlur(this);\r\n            }\r\n            if (\r\n                typeof this.options.onCommit === 'function' &&\r\n                this.getValue() !== this.valueOnFocus\r\n            ) {\r\n                this.options.onCommit(this);\r\n            }\r\n        }\r\n    }\r\n    private onCompositionStart(_composition: string): void {\r\n        // Clear the selection if there is one\r\n        this.model.deleteAtoms(range(this.model.selection));\r\n        requestAnimationFrame(() => {\r\n            render(this); // Recalculate the position of the caret\r\n            // Synchronize the location and style of textarea\r\n            // so that the IME candidate window can align with the composition\r\n            const caretPoint = getCaretPoint(this.field);\r\n            if (!caretPoint) return;\r\n            this.keyboardDelegate.moveTo(caretPoint.x, caretPoint.y);\r\n        });\r\n    }\r\n    private onCompositionUpdate(composition: string): void {\r\n        updateComposition(this.model, composition);\r\n        requestUpdate(this);\r\n    }\r\n    private onCompositionEnd(composition: string): void {\r\n        removeComposition(this.model);\r\n        onTypedText(this, composition, {\r\n            simulateKeystroke: true,\r\n        });\r\n    }\r\n    private onResize(): void {\r\n        this.element.classList.remove(\r\n            'ML__isNarrowWidth',\r\n            'ML__isWideWidth',\r\n            'ML__isExtendedWidth'\r\n        );\r\n        if (window.innerWidth >= 1024) {\r\n            this.element.classList.add('ML__isExtendedWidth');\r\n        } else if (window.innerWidth >= 768) {\r\n            this.element.classList.add('ML__isWideWidth');\r\n        } else {\r\n            this.element.classList.add('ML__isNarrowWidth');\r\n        }\r\n        updatePopoverPosition(this);\r\n    }\r\n\r\n    /** @deprecated */\r\n    $perform(command: SelectorPrivate | [SelectorPrivate, ...any[]]): boolean {\r\n        deprecated('$perform');\r\n        return this.executeCommand(command);\r\n    }\r\n\r\n    executeCommand(\r\n        command: SelectorPrivate | [SelectorPrivate, ...any[]]\r\n    ): boolean {\r\n        return perform(this, command);\r\n    }\r\n\r\n    get lastOffset(): number {\r\n        return this.model.lastOffset;\r\n    }\r\n    get selection(): Selection {\r\n        return this.model.selection;\r\n    }\r\n    set selection(value: Selection) {\r\n        this.model.selection = value;\r\n    }\r\n\r\n    /** @deprecated */\r\n    $text(format: OutputFormat): string {\r\n        return this.getValue(format);\r\n    }\r\n\r\n    getValue(): string;\r\n    getValue(format: OutputFormat): string;\r\n    getValue(start: Offset, end: Offset, format?: OutputFormat): string;\r\n    getValue(range: Range, format?: OutputFormat): string;\r\n    getValue(selection: Selection, format?: OutputFormat): string;\r\n    getValue(\r\n        arg1?: Offset | OutputFormat | Range | Selection,\r\n        arg2?: Offset | OutputFormat,\r\n        arg3?: OutputFormat\r\n    ): string {\r\n        return this.model.getValue(arg1, arg2, arg3);\r\n    }\r\n\r\n    setValue(value: string, options?: InsertOptions): void {\r\n        options = options ?? { mode: 'math' };\r\n        if (typeof options.insertionMode === 'undefined') {\r\n            options.insertionMode = 'replaceAll';\r\n        }\r\n        if (\r\n            typeof options.format === 'undefined' ||\r\n            options.format === 'auto'\r\n        ) {\r\n            options.format = 'latex';\r\n        }\r\n        if (insert(this.model, value, options)) {\r\n            this.undoManager.snapshot(this.options);\r\n            requestUpdate(this);\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     */\r\n    find(value: string | RegExp): Range[] {\r\n        return find(this.model, value);\r\n    }\r\n\r\n    /** @deprecated */\r\n    $selectedText(format: OutputFormat): string {\r\n        deprecated('$selectedText');\r\n\r\n        return this.getValue(this.model.selection, format);\r\n    }\r\n\r\n    /** @deprecated */\r\n    $selectionIsCollapsed(): boolean {\r\n        deprecated('$selectionIsCollapsed');\r\n        return this.model.selectionIsCollapsed;\r\n    }\r\n    /** @deprecated */\r\n    $selectionDepth(): number {\r\n        deprecated('$selectionDepth');\r\n        return this.model.at(this.model.position).treeDepth;\r\n    }\r\n\r\n    /**\r\n     * Checks if the selection starts at the beginning of the selection group.\r\n     *\r\n     * @deprecated\r\n     */\r\n    $selectionAtStart(): boolean {\r\n        deprecated('$selectionAtStart');\r\n        return false;\r\n    }\r\n    /** @deprecated */\r\n    $selectionAtEnd(): boolean {\r\n        deprecated('$selectionAtEnd');\r\n        return false;\r\n    }\r\n\r\n    /** @deprecated */\r\n    $latex(text?: string, options?: InsertOptions): string {\r\n        deprecated('$latex');\r\n        if (typeof text === 'string') {\r\n            const oldValue = Atom.toLatex(this.model.root, {\r\n                expandMacro: false,\r\n            });\r\n            if (text !== oldValue) {\r\n                options = options ?? { mode: 'math' };\r\n                insert(this.model, text, {\r\n                    insertionMode: 'replaceAll',\r\n                    selectionMode: 'after',\r\n                    format: 'latex',\r\n                    mode: 'math',\r\n                    suppressChangeNotifications:\r\n                        options.suppressChangeNotifications,\r\n                    macros: this.options.macros,\r\n                });\r\n                this.undoManager.snapshot(this.options);\r\n                requestUpdate(this);\r\n            }\r\n            return text;\r\n        }\r\n        // Return the content as LaTeX\r\n        return Atom.toLatex(this.model.root, { expandMacro: false });\r\n    }\r\n    /** @deprecated */\r\n    $el(): HTMLElement {\r\n        deprecated('$el');\r\n        return this.element;\r\n    }\r\n    scrollIntoView(): void {\r\n        // If a render is pending, do it now to make sure we have correct layout\r\n        // and caret position\r\n        if (this.dirty) {\r\n            render(this);\r\n        }\r\n        const fieldBounds = this.field.getBoundingClientRect();\r\n        let caretPoint: number;\r\n        if (this.model.selectionIsCollapsed) {\r\n            caretPoint = getCaretPoint(this.field)?.x;\r\n        } else {\r\n            const selectionBounds = getSelectionBounds(this);\r\n            if (selectionBounds.length > 0) {\r\n                caretPoint =\r\n                    selectionBounds[0].right +\r\n                    fieldBounds.left -\r\n                    this.field.scrollLeft;\r\n            }\r\n        }\r\n        if (typeof caretPoint !== 'undefined') {\r\n            const x = caretPoint - window.scrollX;\r\n            if (x < fieldBounds.left) {\r\n                this.field.scroll({\r\n                    top: 0,\r\n                    left: x - fieldBounds.left + this.field.scrollLeft - 20,\r\n                    behavior: 'smooth',\r\n                });\r\n            } else if (x > fieldBounds.right) {\r\n                this.field.scroll({\r\n                    top: 0,\r\n                    left: x - fieldBounds.right + this.field.scrollLeft + 20,\r\n                    behavior: 'smooth',\r\n                });\r\n            }\r\n        }\r\n    }\r\n    /** @deprecated */\r\n    $insert(s: string, options?: InsertOptions): boolean {\r\n        deprecated('$insert');\r\n        return this.insert(s, options);\r\n    }\r\n    insert(s: string, options?: InsertOptions): boolean {\r\n        if (typeof s === 'string' && s.length > 0) {\r\n            options = options ?? { mode: 'math' };\r\n            if (options.focus) {\r\n                this.focus();\r\n            }\r\n            if (options.feedback) {\r\n                if (this.options.keypressVibration && navigator?.vibrate) {\r\n                    navigator.vibrate(HAPTIC_FEEDBACK_DURATION);\r\n                }\r\n                this.keypressSound?.play();\r\n            }\r\n            if (s === '\\\\\\\\') {\r\n                // This string is interpreted as an \"insert row after\" command\r\n                addRowAfter(this.model);\r\n            } else if (s === '&') {\r\n                addColumnAfter(this.model);\r\n            } else {\r\n                const savedStyle = this.style;\r\n                insert(this.model, s, {\r\n                    mode: this.mode,\r\n                    style: this.model.at(this.model.position).computedStyle,\r\n                    ...options,\r\n                });\r\n                if (options.resetStyle) {\r\n                    this.style = savedStyle;\r\n                }\r\n            }\r\n            this.undoManager.snapshot(this.options);\r\n            requestUpdate(this);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    switchMode(mode: ParseMode, prefix = '', suffix = ''): void {\r\n        if (this.mode === mode) return;\r\n        this.model.deferNotifications(\r\n            { content: !!suffix || !!prefix, selection: true },\r\n            () => {\r\n                this.resetKeystrokeBuffer();\r\n                // Suppress (temporarily) smart mode if switching to/from text or math\r\n                // This prevents switching to/from command mode from supressing smart mode.\r\n                this.smartModeSuppressed =\r\n                    /text|math/.test(this.mode) && /text|math/.test(mode);\r\n                if (prefix) {\r\n                    this.insert(prefix, {\r\n                        format: 'latex',\r\n                        mode: { math: 'text', text: 'math' }[mode],\r\n                    });\r\n                }\r\n\r\n                this.mode = mode;\r\n\r\n                if (mode === 'command') {\r\n                    this.model.deleteAtoms(getCommandRange(this.model));\r\n                    hidePopover(this);\r\n                    this.suggestionIndex = 0;\r\n                    // Switch to the command mode keyboard layer\r\n                    if (this.virtualKeyboardVisible) {\r\n                        switchKeyboardLayer(this, 'lower-command');\r\n                    }\r\n\r\n                    // Inserting a command atom\r\n                    const cursor = this.model.at(this.model.position);\r\n                    cursor.parent.addChildrenAfter(\r\n                        [new CommandAtom('\\\\')],\r\n                        cursor\r\n                    );\r\n                    this.model.position += 1;\r\n                } else {\r\n                    // Remove any error indicator on the current command sequence (if there is one)\r\n                    getCommandAtoms(this.model).forEach((x) => {\r\n                        x.isError = false;\r\n                    });\r\n                }\r\n                if (suffix) {\r\n                    this.insert(suffix, {\r\n                        format: 'latex',\r\n                        mode: mode,\r\n                    });\r\n                }\r\n                // Notify of mode change\r\n                if (typeof this.options.onModeChange === 'function') {\r\n                    this.options.onModeChange(this, this.mode);\r\n                }\r\n                requestUpdate(this);\r\n            }\r\n        );\r\n    }\r\n\r\n    /** @deprecated */\r\n    $hasFocus(): boolean {\r\n        deprecated('$hasFocus');\r\n        return this.hasFocus();\r\n    }\r\n    hasFocus(): boolean {\r\n        return document.hasFocus() && this.keyboardDelegate.hasFocus();\r\n    }\r\n    focus(): void {\r\n        if (!this.hasFocus()) {\r\n            this.keyboardDelegate.focus();\r\n            this.model.announce('line');\r\n        }\r\n    }\r\n    blur(): void {\r\n        if (this.hasFocus()) {\r\n            this.keyboardDelegate.blur();\r\n        }\r\n    }\r\n    /** @deprecated */\r\n    $focus(): void {\r\n        deprecated('$focus');\r\n        return this.focus();\r\n    }\r\n    /** @deprecated */\r\n    $blur(): void {\r\n        deprecated('$blur');\r\n        return this.blur();\r\n    }\r\n    /** @deprecated */\r\n    $select(): void {\r\n        this.select();\r\n    }\r\n    select(): void {\r\n        this.model.selection = { ranges: [[0, this.model.lastOffset]] };\r\n    }\r\n    /** @deprecated */\r\n    $clearSelection(): void {\r\n        deprecated('$clearSelection');\r\n        deleteRange(this.model, range(this.model.selection));\r\n    }\r\n\r\n    applyStyle(style: Style, range?: Range): void {\r\n        if (typeof range === 'undefined') {\r\n            this.model.selection.ranges.forEach((range) =>\r\n                applyStyle(this.model, range, style)\r\n            );\r\n        } else {\r\n            applyStyle(this.model, range, style);\r\n        }\r\n    }\r\n\r\n    /** @deprecated */\r\n    $applyStyle(style: Style): void {\r\n        this.model.selection.ranges.forEach((range) =>\r\n            applyStyle(this.model, range, style)\r\n        );\r\n    }\r\n\r\n    /** @deprecated */\r\n    $keystroke(keys: string, evt?: KeyboardEvent): boolean {\r\n        deprecated('$keystroke');\r\n        return onKeystroke(this, keys, evt);\r\n    }\r\n    /** @deprecated */\r\n    $typedText(text: string): void {\r\n        deprecated('$typedText');\r\n        onTypedText(this, text);\r\n    }\r\n\r\n    getCaretPoint(): { x: number; y: number } | null {\r\n        const caretOffset = getCaretPoint(this.field);\r\n        return caretOffset ? { x: caretOffset.x, y: caretOffset.y } : null;\r\n    }\r\n    setCaretPoint(x: number, y: number): boolean {\r\n        const newPosition = offsetFromPoint(this, x, y, { bias: 0 });\r\n        if (newPosition < 0) return false;\r\n        const previousPosition = this.model.position;\r\n        this.model.position = newPosition;\r\n        this.model.announce('move', previousPosition);\r\n        requestUpdate(this);\r\n        return true;\r\n    }\r\n\r\n    canUndo(): boolean {\r\n        return this.undoManager.canUndo();\r\n    }\r\n    canRedo(): boolean {\r\n        return this.undoManager.canRedo();\r\n    }\r\n    popUndoStack(): void {\r\n        this.undoManager.pop();\r\n    }\r\n    snapshot(): void {\r\n        this.undoManager.snapshot({\r\n            ...this.options,\r\n            onUndoStateDidChange: (mf, reason): void => {\r\n                updateUndoRedoButtons(this);\r\n                this.options.onUndoStateDidChange(mf, reason);\r\n            },\r\n        });\r\n    }\r\n    snapshotAndCoalesce(): void {\r\n        this.undoManager.snapshotAndCoalesce({\r\n            ...this.options,\r\n            onUndoStateDidChange: (mf, reason): void => {\r\n                updateUndoRedoButtons(this);\r\n                this.options.onUndoStateDidChange(mf, reason);\r\n            },\r\n        });\r\n    }\r\n    getUndoRecord(): UndoRecord {\r\n        return this.undoManager.save();\r\n    }\r\n    restoreToUndoRecord(s: UndoRecord): void {\r\n        this.undoManager.restore(s, {\r\n            ...this.options,\r\n            suppressChangeNotifications: true,\r\n        });\r\n    }\r\n    undo(): void {\r\n        return this.undoManager.undo({\r\n            ...this.options,\r\n            onUndoStateDidChange: (mf, reason): void => {\r\n                updateUndoRedoButtons(this);\r\n                this.options.onUndoStateDidChange(mf, reason);\r\n            },\r\n        });\r\n    }\r\n    redo(): void {\r\n        return this.undoManager.redo({\r\n            ...this.options,\r\n            onUndoStateDidChange: (mf, reason): void => {\r\n                updateUndoRedoButtons(this);\r\n                this.options.onUndoStateDidChange(mf, reason);\r\n            },\r\n        });\r\n    }\r\n}\r\n\r\nfunction deprecated(method: string) {\r\n    console.warn(`Method \"${method}\" is deprecated`);\r\n}\r\n","/* eslint no-console:0 */\r\nimport '../core/atom';\r\nimport { MACROS, MacroDictionary } from '../core-definitions/definitions';\r\nimport { AutoRenderOptions } from '../public/mathlive';\r\nimport { ErrorListener, ParserErrorCode } from '../public/core';\r\nimport { loadFonts } from '../core/fonts';\r\nimport { inject as injectStylesheet } from '../common/stylesheet';\r\n// @ts-ignore\r\nimport coreStylesheet from '../../css/core.less';\r\n\r\nexport type AutoRenderOptionsPrivate = AutoRenderOptions & {\r\n    /** A function that will convert any LaTeX found to\r\n     * HTML markup. This is only useful to override the default MathLive renderer\r\n     */\r\n    renderToMarkup?: (\r\n        text: string,\r\n        options: {\r\n            mathstyle?: 'displaystyle' | 'textstyle';\r\n            letterShapeStyle?: 'tex' | 'french' | 'iso' | 'upright' | 'auto';\r\n            macros?: MacroDictionary;\r\n            onError?: ErrorListener<ParserErrorCode>;\r\n            format?: string;\r\n        }\r\n    ) => string;\r\n\r\n    /**\r\n     * a function that will convert any LaTeX found to\r\n     * MathML markup.\r\n     */\r\n    renderToMathML?: (\r\n        text: string,\r\n        options: {\r\n            mathstyle?: string;\r\n            format?: string;\r\n            macros?: MacroDictionary;\r\n        }\r\n    ) => string;\r\n\r\n    /** A function that will convert any LaTeX found to\r\n     * speakable text markup. */\r\n    renderToSpeakableText?: (\r\n        text: string,\r\n        options: {\r\n            mathstyle?: string;\r\n            format?: string;\r\n            macros?: MacroDictionary;\r\n        }\r\n    ) => string;\r\n    ignoreClassPattern?: RegExp;\r\n    processClassPattern?: RegExp;\r\n    processScriptTypePattern?: RegExp;\r\n\r\n    mathstyle?: string;\r\n    format?: string;\r\n};\r\n\r\nfunction findEndOfMath(delimiter, text, startIndex): number {\r\n    // Adapted from\r\n    // https://github.com/Khan/perseus/blob/master/src/perseus-markdown.jsx\r\n    let index = startIndex;\r\n    let braceLevel = 0;\r\n\r\n    const delimLength = delimiter.length;\r\n\r\n    while (index < text.length) {\r\n        const character = text[index];\r\n\r\n        if (\r\n            braceLevel <= 0 &&\r\n            text.slice(index, index + delimLength) === delimiter\r\n        ) {\r\n            return index;\r\n        } else if (character === '\\\\') {\r\n            index++;\r\n        } else if (character === '{') {\r\n            braceLevel++;\r\n        } else if (character === '}') {\r\n            braceLevel--;\r\n        }\r\n\r\n        index++;\r\n    }\r\n\r\n    return -1;\r\n}\r\n\r\nfunction splitAtDelimiters(\r\n    startData,\r\n    leftDelim,\r\n    rightDelim,\r\n    mathstyle\r\n): {\r\n    type: string;\r\n    data: string;\r\n    rawData?: string;\r\n    mathstyle?: string;\r\n}[] {\r\n    const finalData = [];\r\n\r\n    for (let i = 0; i < startData.length; i++) {\r\n        if (startData[i].type === 'text') {\r\n            const text = startData[i].data;\r\n\r\n            let lookingForLeft = true;\r\n            let currIndex = 0;\r\n            let nextIndex;\r\n\r\n            nextIndex = text.indexOf(leftDelim);\r\n            if (nextIndex !== -1) {\r\n                currIndex = nextIndex;\r\n                if (currIndex > 0) {\r\n                    finalData.push({\r\n                        type: 'text',\r\n                        data: text.slice(0, currIndex),\r\n                    });\r\n                }\r\n                lookingForLeft = false;\r\n            }\r\n            let done = false;\r\n            while (!done) {\r\n                if (lookingForLeft) {\r\n                    nextIndex = text.indexOf(leftDelim, currIndex);\r\n                    if (nextIndex === -1) {\r\n                        done = true;\r\n                        break;\r\n                    }\r\n                    if (currIndex !== nextIndex) {\r\n                        finalData.push({\r\n                            type: 'text',\r\n                            data: text.slice(currIndex, nextIndex),\r\n                        });\r\n                    }\r\n\r\n                    currIndex = nextIndex;\r\n                } else {\r\n                    nextIndex = findEndOfMath(\r\n                        rightDelim,\r\n                        text,\r\n                        currIndex + leftDelim.length\r\n                    );\r\n                    if (nextIndex === -1) {\r\n                        done = true;\r\n                        break;\r\n                    }\r\n\r\n                    finalData.push({\r\n                        type: 'math',\r\n                        data: text.slice(\r\n                            currIndex + leftDelim.length,\r\n                            nextIndex\r\n                        ),\r\n                        rawData: text.slice(\r\n                            currIndex,\r\n                            nextIndex + rightDelim.length\r\n                        ),\r\n                        mathstyle: mathstyle,\r\n                    });\r\n\r\n                    currIndex = nextIndex + rightDelim.length;\r\n                }\r\n\r\n                lookingForLeft = !lookingForLeft;\r\n            }\r\n            if (currIndex < text.length) {\r\n                finalData.push({\r\n                    type: 'text',\r\n                    data: text.slice(currIndex),\r\n                });\r\n            }\r\n        } else {\r\n            finalData.push(startData[i]);\r\n        }\r\n    }\r\n\r\n    return finalData;\r\n}\r\n\r\nfunction splitWithDelimiters(\r\n    text: string,\r\n    delimiters\r\n): {\r\n    type: string;\r\n    data: string;\r\n    rawData?: string;\r\n    mathstyle?: string;\r\n}[] {\r\n    let data = [{ type: 'text', data: text }];\r\n    for (let i = 0; i < delimiters.inline.length; i++) {\r\n        const delimiter = delimiters.inline[i];\r\n        data = splitAtDelimiters(data, delimiter[0], delimiter[1], 'textstyle');\r\n    }\r\n    for (let i = 0; i < delimiters.display.length; i++) {\r\n        const delimiter = delimiters.display[i];\r\n        data = splitAtDelimiters(\r\n            data,\r\n            delimiter[0],\r\n            delimiter[1],\r\n            'displaystyle'\r\n        );\r\n    }\r\n\r\n    return data;\r\n}\r\n\r\nfunction createMathMLNode(\r\n    latex: string,\r\n    options: AutoRenderOptionsPrivate\r\n): HTMLElement {\r\n    // Create a node for AT (Assistive Technology, e.g. screen reader) to speak, etc.\r\n    // This node has a style that makes it be invisible to display but is seen by AT\r\n    const span = document.createElement('span');\r\n    try {\r\n        const html =\r\n            \"<math xmlns='http://www.w3.org/1998/Math/MathML'>\" +\r\n            options.renderToMathML(latex, options) +\r\n            '</math>';\r\n        span.innerHTML = options.createHTML ? options.createHTML(html) : html;\r\n    } catch (e) {\r\n        console.error(\"Could not convert'\" + latex + \"' to MathML with \", e);\r\n        span.textContent = latex;\r\n    }\r\n    span.className = 'ML__sr-only';\r\n    return span;\r\n}\r\n\r\nfunction createMarkupNode(\r\n    text: string,\r\n    options: AutoRenderOptionsPrivate,\r\n    mathstyle: 'displaystyle' | 'textstyle',\r\n    createNodeOnFailure: boolean\r\n): HTMLSpanElement | Text {\r\n    // Create a node for displaying math.\r\n    //   This is slightly ugly because in the case of failure to create the markup,\r\n    //   sometimes a text node is desired and sometimes not.\r\n    //   'createTextNodeOnFailure' controls this and null is returned when no node is created.\r\n    // This node is made invisible to AT (screen readers)\r\n    let span: HTMLSpanElement | Text = document.createElement('span');\r\n    span.setAttribute('aria-hidden', 'true');\r\n    if (options.preserveOriginalContent) {\r\n        span.setAttribute(\r\n            'data-' + options.namespace + 'original-content',\r\n            text\r\n        );\r\n        if (mathstyle) {\r\n            span.setAttribute(\r\n                'data-' + options.namespace + 'original-mathstyle',\r\n                mathstyle\r\n            );\r\n        }\r\n    }\r\n\r\n    try {\r\n        loadFonts(options.fontsDirectory);\r\n        injectStylesheet(null, coreStylesheet);\r\n        const html = options.renderToMarkup(text, {\r\n            mathstyle: mathstyle ?? 'displaystyle',\r\n            format: 'html',\r\n            macros: options.macros,\r\n        });\r\n        span.innerHTML = options.createHTML ? options.createHTML(html) : html;\r\n    } catch (e) {\r\n        console.error(\"Could not parse'\" + text + \"' with \", e);\r\n        if (createNodeOnFailure) {\r\n            span = document.createTextNode(text);\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n    return span;\r\n}\r\n\r\nfunction createAccessibleMarkupPair(\r\n    text: string,\r\n    mathstyle: 'displaystyle' | 'textstyle' | string,\r\n    options: AutoRenderOptionsPrivate,\r\n    createNodeOnFailure: boolean\r\n): Node {\r\n    // Create a math node (a span with an accessible component and a visual component)\r\n    // If there is an error in parsing the latex, 'createNodeOnFailure' controls whether\r\n    //   'null' is returned or an accessible node with the text used.\r\n    const markupNode = createMarkupNode(\r\n        text,\r\n        options,\r\n        mathstyle as 'displaystyle' | 'textstyle',\r\n        createNodeOnFailure\r\n    );\r\n\r\n    if (\r\n        markupNode &&\r\n        /\\b(mathml|speakable-text)\\b/i.test(options.renderAccessibleContent)\r\n    ) {\r\n        const fragment = document.createDocumentFragment();\r\n        if (\r\n            /\\bmathml\\b/i.test(options.renderAccessibleContent) &&\r\n            options.renderToMathML\r\n        ) {\r\n            fragment.appendChild(createMathMLNode(text, options));\r\n        }\r\n        if (\r\n            /\\bspeakable-text\\b/i.test(options.renderAccessibleContent) &&\r\n            options.renderToSpeakableText\r\n        ) {\r\n            const span = document.createElement('span');\r\n            const html = options.renderToSpeakableText(text, options);\r\n            span.innerHTML = options.createHTML\r\n                ? options.createHTML(html)\r\n                : html;\r\n            span.className = 'ML__sr-only';\r\n            fragment.appendChild(span);\r\n        }\r\n        fragment.appendChild(markupNode);\r\n        return fragment;\r\n    }\r\n\r\n    return markupNode;\r\n}\r\n\r\nfunction scanText(text: string, options: AutoRenderOptionsPrivate): Node {\r\n    // If the text starts with '\\begin'...\r\n    // (this is a MathJAX behavior)\r\n    let fragment: Node = null;\r\n    if (options.TeX.processEnvironments && /^\\s*\\\\begin/.test(text)) {\r\n        fragment = document.createDocumentFragment();\r\n        fragment.appendChild(\r\n            createAccessibleMarkupPair(text, undefined, options, true)\r\n        );\r\n    } else {\r\n        if (!text.trim()) return null;\r\n        const data = splitWithDelimiters(text, options.TeX.delimiters);\r\n        if (data.length === 1 && data[0].type === 'text') {\r\n            // This text contains no math. No need to continue processing\r\n            return null;\r\n        }\r\n        fragment = document.createDocumentFragment();\r\n\r\n        for (let i = 0; i < data.length; i++) {\r\n            if (data[i].type === 'text') {\r\n                fragment.appendChild(document.createTextNode(data[i].data));\r\n            } else {\r\n                fragment.appendChild(\r\n                    createAccessibleMarkupPair(\r\n                        data[i].data,\r\n                        data[i].mathstyle,\r\n                        options,\r\n                        true\r\n                    )\r\n                );\r\n            }\r\n        }\r\n    }\r\n    return fragment;\r\n}\r\n\r\nfunction scanElement(elem, options: AutoRenderOptionsPrivate): void {\r\n    const originalContent = elem.getAttribute(\r\n        'data-' + options.namespace + 'original-content'\r\n    );\r\n    if (originalContent) {\r\n        const mathstyle = elem.getAttribute(\r\n            'data-' + options.namespace + 'mathstyle'\r\n        );\r\n        const span = createAccessibleMarkupPair(\r\n            originalContent,\r\n            mathstyle,\r\n            options,\r\n            false\r\n        );\r\n        if (span != null) {\r\n            elem.textContent = '';\r\n            elem.appendChild(span);\r\n        }\r\n        return;\r\n    }\r\n\r\n    if (elem.childNodes.length === 1 && elem.childNodes[0].nodeType === 3) {\r\n        // This is a node with textual content only. Perhaps an opportunity\r\n        // to simplify and avoid creating extra nested elements...\r\n        const text = elem.childNodes[0].textContent;\r\n        if (options.TeX.processEnvironments && /^\\s*\\\\begin/.test(text)) {\r\n            elem.textContent = '';\r\n            elem.appendChild(\r\n                createAccessibleMarkupPair(text, undefined, options, true)\r\n            );\r\n            return;\r\n        }\r\n\r\n        const data = splitWithDelimiters(text, options.TeX.delimiters);\r\n        if (data.length === 1 && data[0].type === 'math') {\r\n            // The entire content is a math expression: we can replace the content\r\n            // with the latex markup without creating additional wrappers.\r\n            elem.textContent = '';\r\n            elem.appendChild(\r\n                createAccessibleMarkupPair(\r\n                    data[0].data,\r\n                    data[0].mathstyle,\r\n                    options,\r\n                    true\r\n                )\r\n            );\r\n            return;\r\n        } else if (data.length === 1 && data[0].type === 'text') {\r\n            // This element only contained text with no math. No need to\r\n            // do anything.\r\n            return;\r\n        }\r\n    }\r\n\r\n    for (let i = 0; i < elem.childNodes.length; i++) {\r\n        const childNode = elem.childNodes[i];\r\n        if (childNode.nodeType === 3) {\r\n            // A text node\r\n            // Look for math mode delimiters inside the text\r\n            const frag = scanText(childNode.textContent, options);\r\n            if (frag) {\r\n                i += frag.childNodes.length - 1;\r\n                elem.replaceChild(frag, childNode);\r\n            }\r\n        } else if (childNode.nodeType === 1) {\r\n            // An element node\r\n            const tag = childNode.nodeName.toLowerCase();\r\n            if (\r\n                tag === 'script' &&\r\n                options.processScriptTypePattern.test(childNode.type)\r\n            ) {\r\n                let style = 'displaystyle';\r\n                for (const l of childNode.type.split(';')) {\r\n                    const v = l.split('=');\r\n                    if (v[0].toLowerCase() === 'mode') {\r\n                        if (v[1].toLoweCase() === 'display') {\r\n                            style = 'displaystyle';\r\n                        } else {\r\n                            style = 'textstyle';\r\n                        }\r\n                    }\r\n                }\r\n\r\n                const span = createAccessibleMarkupPair(\r\n                    childNode.textContent,\r\n                    style,\r\n                    options,\r\n                    true\r\n                );\r\n                childNode.parentNode.replaceChild(span, childNode);\r\n            } else if (tag !== 'script') {\r\n                // Element node\r\n                // console.assert(childNode.className !== 'formula');\r\n                const shouldRender =\r\n                    options.processClassPattern.test(childNode.className) ||\r\n                    !(\r\n                        options.skipTags.includes(tag) ||\r\n                        options.ignoreClassPattern.test(childNode.className)\r\n                    );\r\n\r\n                if (shouldRender) {\r\n                    if (\r\n                        elem.childNodes.length === 1 &&\r\n                        elem.childNodes[0].nodeType === 3\r\n                    ) {\r\n                        const formula = elem.textContent;\r\n                        elem.textContent = '';\r\n                        elem.appendChild(\r\n                            createAccessibleMarkupPair(\r\n                                formula,\r\n                                'displaystyle',\r\n                                options,\r\n                                true\r\n                            )\r\n                        );\r\n                    } else {\r\n                        scanElement(childNode, options);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        // Otherwise, it's something else, and ignore it.\r\n    }\r\n}\r\n\r\nconst defaultOptions: AutoRenderOptions = {\r\n    // Optional namespace for the `data-` attributes.\r\n    namespace: '',\r\n\r\n    // Name of tags whose content will not be scanned for math delimiters\r\n    skipTags: [\r\n        'noscript',\r\n        'style',\r\n        'textarea',\r\n        'pre',\r\n        'code',\r\n        'annotation',\r\n        'annotation-xml',\r\n    ],\r\n\r\n    // <script> tags of the following types will be processed. Others, ignored.\r\n    processScriptType: 'math/tex',\r\n\r\n    // Regex pattern of the class name of elements whose contents should not\r\n    // be processed\r\n    ignoreClass: 'tex2jax_ignore',\r\n\r\n    // Regex pattern of the class name of elements whose contents should\r\n    // be processed when they appear inside ones that are ignored.\r\n    processClass: 'tex2jax_process',\r\n\r\n    // Indicate whether to preserve or discard the original content of the\r\n    // elements being rendered in a 'data-original-content' attribute.\r\n    preserveOriginalContent: true,\r\n\r\n    // Indicate the format to use to render accessible content\r\n    renderAccessibleContent: 'mathml',\r\n\r\n    TeX: {\r\n        processEnvironments: true,\r\n        delimiters: {\r\n            inline: [['\\\\(', '\\\\)']],\r\n            display: [\r\n                ['$$', '$$'],\r\n                ['\\\\[', '\\\\]'],\r\n            ],\r\n        },\r\n    },\r\n};\r\n\r\nfunction renderMathInElement(\r\n    elem: HTMLElement | string,\r\n    options: AutoRenderOptionsPrivate\r\n): void {\r\n    try {\r\n        options = { ...defaultOptions, ...options };\r\n        options.ignoreClassPattern = new RegExp(options.ignoreClass);\r\n        options.processClassPattern = new RegExp(options.processClass);\r\n        options.processScriptTypePattern = new RegExp(\r\n            options.processScriptType\r\n        );\r\n        options.macros = MACROS;\r\n\r\n        // Validate the namespace (used for `data-` attributes)\r\n        if (options.namespace) {\r\n            if (!/^[a-z]+[-]?$/.test(options.namespace)) {\r\n                throw Error(\r\n                    'options.namespace must be a string of lowercase characters only'\r\n                );\r\n            }\r\n            if (!/-$/.test(options.namespace)) {\r\n                options.namespace += '-';\r\n            }\r\n        }\r\n\r\n        scanElement(elem, options);\r\n    } catch (e) {\r\n        if (e instanceof Error) {\r\n            console.error('renderMathInElement(): ' + e.message);\r\n        } else {\r\n            console.error(\r\n                'renderMathInElement(): Could not render math for element ' +\r\n                    elem\r\n            );\r\n        }\r\n    }\r\n}\r\n\r\nexport default {\r\n    renderMathInElement,\r\n};\r\n","/**\r\n * This module contains utilities to debug mathlive internal data structures.\r\n *\r\n * It is also used by the automated test suite.\r\n */\r\n\r\nimport { ParseMode } from '../public/core';\r\nimport { parseString } from '../core/parser';\r\nimport type { Span } from '../core/span';\r\nimport {\r\n    MACROS,\r\n    FUNCTIONS,\r\n    MATH_SYMBOLS,\r\n    TEXT_SYMBOLS,\r\n    ENVIRONMENTS,\r\n} from '../core-definitions/definitions';\r\nimport { INLINE_SHORTCUTS } from '../editor/shortcuts';\r\nimport { DEFAULT_KEYBINDINGS } from '../editor/keybindings-definitions';\r\nimport { getKeybindingMarkup } from '../editor/keybindings';\r\n\r\nimport { atomToAsciiMath } from '../editor/atom-to-ascii-math';\r\nimport { parseMathString } from '../editor/parse-math-string';\r\n\r\nexport function latexToAsciiMath(\r\n    latex: string,\r\n    mode: ParseMode = 'math'\r\n): string {\r\n    const mathlist = parseString(latex, mode, null, null);\r\n\r\n    return atomToAsciiMath(mathlist);\r\n}\r\n\r\nexport function asciiMathToLatex(ascii: string): string {\r\n    const [, result] = parseMathString(ascii, { format: 'ASCIIMath' });\r\n    return result;\r\n}\r\n\r\n/**\r\n *\r\n * @param symbol specify which span to consider.\r\n * If a string, a span whose body match the string\r\n * If a number, the nth span in the list\r\n * If an array, each element in the array indicate the nth child to traverse\r\n */\r\nfunction getSymbol(spans: Span[], symbol: string | number | number[]): Span {\r\n    if (!spans) return null;\r\n    let childSymbol = null;\r\n\r\n    if (Array.isArray(symbol)) {\r\n        childSymbol = symbol.slice(); // Clone the array\r\n        symbol = childSymbol.shift(); // Get the first element and remove it from the array\r\n    }\r\n\r\n    let result = null;\r\n    if (typeof symbol === 'number' && symbol < spans.length) {\r\n        if (childSymbol && childSymbol.length > 0) {\r\n            return getSymbol(spans[symbol].children, childSymbol);\r\n        }\r\n        return spans[symbol];\r\n    } else if (typeof symbol === 'string') {\r\n        for (let i = 0; i < spans.length; i++) {\r\n            // Does this span match the symbol we're looking for?\r\n            if (spans[i].value === symbol) {\r\n                if (childSymbol && childSymbol.length > 0) {\r\n                    return getSymbol(spans[i].children, childSymbol);\r\n                }\r\n                return spans[i];\r\n            }\r\n            // If not, try its children\r\n            result = getSymbol(spans[i].children, symbol);\r\n            if (result) return result;\r\n        }\r\n        return result;\r\n    }\r\n    return null;\r\n}\r\n\r\nfunction getProp(\r\n    spans: Span[],\r\n    symbol: string | number | number[],\r\n    prop: string\r\n): Span {\r\n    const s = getSymbol(spans, symbol);\r\n    if (s) return s[prop];\r\n    return null;\r\n}\r\n\r\n/**\r\n * Return the type ('mbin', etc...) of a span\r\n */\r\nfunction getType(spans: Span[], symbol: string): string {\r\n    const s = getSymbol(spans, symbol);\r\n    if (s) return s.type;\r\n    return null;\r\n}\r\n\r\nfunction getStyle(spans: Span[], symbol: string, prop: string): string {\r\n    const s = getSymbol(spans, symbol);\r\n    if (s?.style) return s.style[prop];\r\n    return null;\r\n}\r\n\r\nfunction getClasses(spans: Span[], symbol: string): string {\r\n    const s = getSymbol(spans, symbol);\r\n    if (s) return s.classes ?? '';\r\n    return null;\r\n}\r\n\r\nfunction hasClass(spans: Span[], symbol: string, cls: string): boolean {\r\n    const classes = getClasses(spans, symbol);\r\n    if (!classes) return false;\r\n    const clsList = classes.split(' ');\r\n    for (let j = 0; j < clsList.length; j++) {\r\n        if (clsList[j] === cls) return true;\r\n    }\r\n    return false;\r\n}\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\n////////////////////////////////////////////////////////////////////////////////\r\n////////////////////////////////////////////////////////////////////////////////\r\n\r\nfunction spanToString(span: Span, indent = ''): string {\r\n    let result = '';\r\n    if (Array.isArray(span)) {\r\n        if (span.length === 0) {\r\n            result += '[]\\n';\r\n        } else {\r\n            result += '[\\n';\r\n            for (let i = 0; i < span.length; i++) {\r\n                result += spanToString(span[i], '\\t' + indent + i + ',');\r\n                result += i < span.length - 1 ? ',\\n' : '\\n';\r\n            }\r\n            result += indent + ']\\n';\r\n        }\r\n    } else {\r\n        result = indent + '{\\n';\r\n        if (span.type) {\r\n            result += indent + 'type:\"' + span.type + '\",\\n';\r\n        }\r\n        if (span.value && span.value.length > 0) {\r\n            result += indent + 'body:\"' + span.value + '\",\\n';\r\n        }\r\n        if (span.classes && span.classes.length > 0) {\r\n            result += indent + 'classes:\"' + span.classes + '\",\\n';\r\n        }\r\n        if (span.style) {\r\n            for (const s in span.style) {\r\n                if (Object.prototype.hasOwnProperty.call(span.style, s)) {\r\n                    result += indent + s + ':\"';\r\n                    result += span.style[s] + '\",\\n';\r\n                }\r\n            }\r\n        }\r\n        if (span.children && span.children.length > 0) {\r\n            result +=\r\n                indent +\r\n                'children:' +\r\n                span.children.map((x) => spanToString(x, indent)).join('; ');\r\n        }\r\n        result += indent + '}';\r\n    }\r\n    return result;\r\n}\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\n////////////////////////////////////////////////////////////////////////////////\r\n////////////////////////////////////////////////////////////////////////////////\r\n\r\nfunction spanToMarkup(span: Span, indent = ''): string {\r\n    // if (indent.length === 0) {\r\n    //     result += '<table>';\r\n    // }\r\n    let result = '';\r\n    if (Array.isArray(span)) {\r\n        for (let i = 0; i < span.length; i++) {\r\n            result += spanToMarkup(span[i], indent);\r\n        }\r\n    } else if (span) {\r\n        result = '<br>' + indent;\r\n        if (span.classes.includes('fontsize-ensurer')) {\r\n            result += 'FONTSIZE-ENSURER';\r\n        } else {\r\n            if (span.type) {\r\n                result += '<span class=\"type\">' + span.type + '</span>';\r\n            }\r\n            if (span.value && span.value.length > 0) {\r\n                result += '<span class=\"value\">' + span.value + '</span>';\r\n            }\r\n            if (span.classes && span.classes.length > 0) {\r\n                result +=\r\n                    '&nbsp;<span class=\"classes\">' + span.classes + '</span>';\r\n            }\r\n            if (span.isTight) {\r\n                result += '&nbsp;<span class=\"stylevalue\"> tight </span>';\r\n            }\r\n            if (span.caret) {\r\n                result += '&nbsp;<span class=\"stylevalue\"> caret </span>';\r\n            }\r\n\r\n            if (span.style) {\r\n                for (const s in span.style) {\r\n                    if (Object.prototype.hasOwnProperty.call(span.style, s)) {\r\n                        result +=\r\n                            '&nbsp;<span class=\"styleprop\">' + s + ':</span>';\r\n                        result +=\r\n                            '<span class=\"stylevalue\"> ' +\r\n                            span.style[s] +\r\n                            '</span>;&nbsp;';\r\n                    }\r\n                }\r\n            }\r\n            if (span.children) {\r\n                result += span.children\r\n                    .map((x) => spanToMarkup(x, indent + ''))\r\n                    .join('; ');\r\n            }\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\n// Export the public interface for this module\r\nexport default {\r\n    spanToMarkup,\r\n\r\n    spanToString,\r\n\r\n    hasClass,\r\n    getClasses,\r\n    getProp,\r\n    getStyle,\r\n    getType,\r\n\r\n    latexToAsciiMath,\r\n    asciiMathToLatex,\r\n    FUNCTIONS,\r\n    MATH_SYMBOLS,\r\n    TEXT_SYMBOLS,\r\n    ENVIRONMENTS,\r\n    MACROS,\r\n\r\n    INLINE_SHORTCUTS,\r\n    DEFAULT_KEYBINDINGS,\r\n\r\n    getKeybindingMarkup,\r\n};\r\n","import { render } from '../editor-mathfield/render';\r\nimport { MathfieldOptions } from '../public/options';\r\n\r\nfunction removeHighlight(element: Element): void {\r\n    element.classList.remove('ML__highlight');\r\n    if (element.children) {\r\n        for (const child of element.children) {\r\n            removeHighlight(child);\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * Highlights the span corresponding to the specified atomID.\r\n *\r\n * This is used for text-to-speech with synchronized highlighting (read aloud)\r\n *\r\n * @category Read Aloud\r\n * @param {string} atomID\r\n *\r\n */\r\nfunction highlightAtomID(element: Element, atomID?: string): void {\r\n    if (!atomID || element['dataset']?.atomId === atomID) {\r\n        element.classList.add('ML__highlight');\r\n        if (element.children && element.children.length > 0) {\r\n            Array.from(element.children).forEach((x) => {\r\n                highlightAtomID(x);\r\n            });\r\n        }\r\n    } else {\r\n        element.classList.remove('ML__highlight');\r\n        if (element.children && element.children.length > 0) {\r\n            Array.from(element.children).forEach((x) => {\r\n                highlightAtomID(x, atomID);\r\n            });\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * \"Read Aloud\" is an asynchronous operation that reads the\r\n * reading with synchronized highlighting\r\n *\r\n * @param element - The DOM element to highlight\r\n * @param text - The text to speak\r\n */\r\nexport function defaultReadAloudHook(\r\n    element: HTMLElement,\r\n    text: string,\r\n    config: Partial<MathfieldOptions>\r\n): void {\r\n    if (!window) {\r\n        return;\r\n    }\r\n    if (!config && window['mathlive']) {\r\n        config = window['mathlive'].config;\r\n    }\r\n\r\n    if (config.speechEngine !== 'amazon') {\r\n        console.warn('Use Amazon TTS Engine for synchronized highlighting');\r\n        if (config.speakHook) config.speakHook(text, config);\r\n        return;\r\n    }\r\n    if (!window['AWS']) {\r\n        console.warn(\r\n            'AWS SDK not loaded. See https://www.npmjs.com/package/aws-sdk'\r\n        );\r\n        return;\r\n    }\r\n    const polly = new window['AWS'].Polly({ apiVersion: '2016-06-10' });\r\n\r\n    const params = {\r\n        OutputFormat: 'json',\r\n        VoiceId: config.speechEngineVoice || 'Joanna',\r\n        Engine: 'standard', // The neural engine does not appear to support ssml marks\r\n        Text: text,\r\n        TextType: 'ssml',\r\n        SpeechMarkTypes: ['ssml'],\r\n    };\r\n\r\n    window['mathlive'] = window['mathlive'] ?? {};\r\n    window['mathlive'].readAloudElement = element;\r\n\r\n    const statusHook =\r\n        config.onReadAloudStatus || window['mathlive'].onReadAloudStatus;\r\n\r\n    // Request the mark points\r\n    polly.synthesizeSpeech(params, (err, data) => {\r\n        if (err) {\r\n            console.warn('polly.synthesizeSpeech() error:', err, err.stack);\r\n            return;\r\n        }\r\n        if (!data || !data.AudioStream) {\r\n            console.log('polly.synthesizeSpeech():' + data);\r\n            return;\r\n        }\r\n        const response = new TextDecoder('utf-8').decode(\r\n            new Uint8Array(data.AudioStream)\r\n        );\r\n        window['mathlive'].readAloudMarks = response\r\n            .split('\\n')\r\n            .map((x) => (x ? JSON.parse(x) : {}));\r\n        window['mathlive'].readAloudTokens = [];\r\n        for (const mark of window['mathlive'].readAloudMarks) {\r\n            if (mark.value) {\r\n                window['mathlive'].readAloudTokens.push(mark.value);\r\n            }\r\n        }\r\n        window['mathlive'].readAloudCurrentMark = '';\r\n\r\n        // Request the audio\r\n        params.OutputFormat = 'mp3';\r\n        params.SpeechMarkTypes = [];\r\n        polly.synthesizeSpeech(params, function (err, data) {\r\n            if (err) {\r\n                console.warn(\r\n                    'polly.synthesizeSpeech(',\r\n                    text,\r\n                    ') error:',\r\n                    err,\r\n                    err.stack\r\n                );\r\n                return;\r\n            }\r\n            if (!data || !data.AudioStream) {\r\n                return;\r\n            }\r\n            const uInt8Array = new Uint8Array(data.AudioStream);\r\n            const blob = new Blob([uInt8Array.buffer], {\r\n                type: 'audio/mpeg',\r\n            });\r\n            const url = URL.createObjectURL(blob);\r\n\r\n            if (!window['mathlive'].readAloudAudio) {\r\n                window['mathlive'].readAloudAudio = new Audio();\r\n                window['mathlive'].readAloudAudio.addEventListener(\r\n                    'ended',\r\n                    () => {\r\n                        const mathfield = window['mathlive'].readAloudMathField;\r\n                        if (statusHook) {\r\n                            statusHook(mathfield, 'ended');\r\n                        }\r\n                        if (mathfield) {\r\n                            render(mathfield);\r\n                            window['mathlive'].readAloudElement = null;\r\n                            window['mathlive'].readAloudMathField = null;\r\n                            window['mathlive'].readAloudTokens = [];\r\n                            window['mathlive'].readAloudMarks = [];\r\n                            window['mathlive'].readAloudCurrentMark = '';\r\n                        } else {\r\n                            removeHighlight(\r\n                                window['mathlive'].readAloudElement\r\n                            );\r\n                        }\r\n                    }\r\n                );\r\n                window['mathlive'].readAloudAudio.addEventListener(\r\n                    'timeupdate',\r\n                    () => {\r\n                        let value = '';\r\n                        // The target, the atom we're looking for, is the one matching the current audio\r\n                        // plus 100 ms. By anticipating it a little bit, it feels more natural, otherwise it\r\n                        // feels like the highlighting is trailing the audio.\r\n                        const target =\r\n                            window['mathlive'].readAloudAudio.currentTime *\r\n                                1000 +\r\n                            100;\r\n\r\n                        // Find the smallest element which is bigger than the target time\r\n                        for (const mark of window['mathlive'].readAloudMarks) {\r\n                            if (mark.time < target) {\r\n                                value = mark.value;\r\n                            }\r\n                        }\r\n                        if (window['mathlive'].readAloudCurrentMark !== value) {\r\n                            window['mathlive'].readAloudCurrentToken = value;\r\n                            if (\r\n                                value &&\r\n                                value === window['mathlive'].readAloudFinalToken\r\n                            ) {\r\n                                window['mathlive'].readAloudAudio.pause();\r\n                            } else {\r\n                                window['mathlive'].readAloudCurrentMark = value;\r\n                                highlightAtomID(\r\n                                    window['mathlive'].readAloudElement,\r\n                                    window['mathlive'].readAloudCurrentMark\r\n                                );\r\n                            }\r\n                        }\r\n                    }\r\n                );\r\n            } else {\r\n                window['mathlive'].readAloudAudio.pause();\r\n            }\r\n\r\n            window['mathlive'].readAloudAudio.src = url;\r\n            if (statusHook) {\r\n                statusHook(window['mathlive'].readAloudMathField, 'playing');\r\n            }\r\n            window['mathlive'].readAloudAudio.play();\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n * Returns the status of a Read Aloud operation (reading with synchronized\r\n * highlighting).\r\n *\r\n * Possible values are:\r\n * - `\"ready\"`\r\n * - `\"playing\"`\r\n * - `\"paused\"`\r\n * - `\"unavailable\"`\r\n *\r\n * **See** {@linkcode speak}\r\n * @category Read Aloud\r\n */\r\nexport function readAloudStatus():\r\n    | 'ready'\r\n    | 'playing'\r\n    | 'paused'\r\n    | 'unavailable' {\r\n    if (!window) return 'unavailable';\r\n    window['mathlive'] = window['mathlive'] ?? {};\r\n\r\n    if (!window['mathlive'].readAloudAudio) return 'ready';\r\n    if (window['mathlive'].readAloudAudio.paused) return 'paused';\r\n    if (!window['mathlive'].readAloudAudio.ended) return 'playing';\r\n\r\n    return 'ready';\r\n}\r\n\r\n/**\r\n * Pauses a read aloud operation if one is in progress.\r\n *\r\n * **See** {@linkcode speak}\r\n */\r\nexport function pauseReadAloud(): void {\r\n    if (!window) return;\r\n    window['mathlive'] = window['mathlive'] ?? {};\r\n    if (window['mathlive'].readAloudAudio) {\r\n        if (window['mathlive'].onReadAloudStatus) {\r\n            window['mathlive'].onReadAloudStatus(\r\n                window['mathlive'].readAloudMathField,\r\n                'paused'\r\n            );\r\n        }\r\n        window['mathlive'].readAloudAudio.pause();\r\n    }\r\n}\r\n\r\n/**\r\n * Resumes a read aloud operation if one was paused.\r\n *\r\n * **See** {@linkcode speak}\r\n */\r\nexport function resumeReadAloud(): void {\r\n    if (!window) return;\r\n    window['mathlive'] = window['mathlive'] ?? {};\r\n    if (window['mathlive'].readAloudAudio) {\r\n        if (window['mathlive'].onReadAloudStatus) {\r\n            window['mathlive'].onReadAloudStatus(\r\n                window['mathlive'].readAloudMathField,\r\n                'playing'\r\n            );\r\n        }\r\n        window['mathlive'].readAloudAudio.play();\r\n    }\r\n}\r\n\r\n/**\r\n * If a Read Aloud operation is in progress, read from a specified token\r\n *\r\n * **See** {@linkcode speak}\r\n *\r\n * @param count The number of tokens to read.\r\n */\r\nexport function playReadAloud(token: string, count: number): void {\r\n    if (!window) return;\r\n    window['mathlive'] = window['mathlive'] ?? {};\r\n    if (window['mathlive'].readAloudAudio) {\r\n        let timeIndex = 0;\r\n        window['mathlive'].readAloudFinalToken = null;\r\n        if (token) {\r\n            window['mathlive'].readAloudMarks =\r\n                window['mathlive'].readAloudMarks || [];\r\n            for (const mark of window['mathlive'].readAloudMarks) {\r\n                if (mark.value === token) {\r\n                    timeIndex = mark.time / 1000;\r\n                }\r\n            }\r\n            let tokenIndex = window['mathlive'].readAloudTokens.indexOf(token);\r\n            if (tokenIndex >= 0) {\r\n                tokenIndex += count;\r\n                if (tokenIndex < window['mathlive'].readAloudTokens.length) {\r\n                    window['mathlive'].readAloudFinalToken = tokenIndex;\r\n                }\r\n            }\r\n        }\r\n        window['mathlive'].readAloudAudio.currentTime = timeIndex;\r\n        if (window['mathlive'].onReadAloudStatus) {\r\n            window['mathlive'].onReadAloudStatus(\r\n                window['mathlive'].readAloudMathField,\r\n                'playing'\r\n            );\r\n        }\r\n        window['mathlive'].readAloudAudio.play();\r\n    }\r\n}\r\n","/// ^.*('\\\\.*').*\r\nimport { FUNCTIONS, MATH_SYMBOLS } from '../core-definitions/definitions';\r\n\r\n// Frequency of a symbol.\r\n// String constants corresponding to frequency values,\r\n// which are the number of results returned by latexsearch.com\r\n// When the precise number is known, it is provided. Otherwise,\r\n// the following constants are used to denote an estimate.\r\nexport const CRYPTIC = 0;\r\nexport const ARCANE = 200;\r\nexport const VERY_RARE = 'VERY_RARE';\r\nexport const RARE = 1200;\r\nexport const UNCOMMON = 2000;\r\nexport const COMMON = 3000;\r\nexport const SUPERCOMMON = 4000;\r\n\r\n/*\r\n * Set the metadata for the specified symbols\r\n *\r\n * metadata('Functions', ['\\\\sin', '\\\\cos'], COMMON, '$0{a}')\r\n *\r\n */\r\nfunction metadata(\r\n    category,\r\n    symbols,\r\n    frequency = COMMON,\r\n    template = '$0'\r\n): void {\r\n    symbols.forEach((symbol) => {\r\n        if (MATH_SYMBOLS[symbol]) {\r\n            MATH_SYMBOLS[symbol].frequency = frequency;\r\n            MATH_SYMBOLS[symbol].category = category;\r\n            MATH_SYMBOLS[symbol].template = template.replace(/\\$0/g, symbol);\r\n        }\r\n        if (FUNCTIONS[symbol]) {\r\n            // Make a copy of the entry, since it could be shared by multiple\r\n            // symbols\r\n            FUNCTIONS[symbol] = {\r\n                ...FUNCTIONS[symbol],\r\n                frequency: frequency,\r\n                category: category,\r\n                template: template.replace(/\\$0/g, symbol),\r\n            };\r\n        }\r\n    });\r\n}\r\n\r\nmetadata('Trigonometry', ['\\\\cos', '\\\\sin', '\\\\tan'], SUPERCOMMON);\r\n\r\nmetadata(\r\n    'Trigonometry',\r\n    [\r\n        '\\\\arcsin',\r\n        '\\\\arccos',\r\n        '\\\\arctan',\r\n        '\\\\arctg',\r\n        '\\\\arcctg',\r\n        '\\\\arcsec',\r\n        '\\\\arccsc',\r\n        '\\\\arsinh',\r\n        '\\\\arcosh',\r\n        '\\\\artanh',\r\n        '\\\\arcsech',\r\n        '\\\\arccsch',\r\n        '\\\\arg',\r\n        '\\\\ch',\r\n        '\\\\cosec',\r\n        '\\\\cosh',\r\n        '\\\\cot',\r\n        '\\\\cotg',\r\n        '\\\\coth',\r\n        '\\\\csc',\r\n        '\\\\ctg',\r\n        '\\\\cth',\r\n        '\\\\lg',\r\n        '\\\\lb',\r\n        '\\\\sec',\r\n        '\\\\sinh',\r\n        '\\\\sh',\r\n        '\\\\tanh',\r\n        '\\\\tg',\r\n        '\\\\th',\r\n    ],\r\n    UNCOMMON\r\n);\r\n\r\nmetadata('Functions', ['\\\\ln', '\\\\log', '\\\\exp', '\\\\lim'], SUPERCOMMON);\r\n\r\nmetadata(\r\n    'Functions',\r\n    ['\\\\dim', '\\\\ker', '\\\\deg', '\\\\det', '\\\\mod', '\\\\min', '\\\\max'],\r\n    COMMON\r\n);\r\nmetadata('Functions', ['\\\\hom'], RARE);\r\n\r\nmetadata('Decoration', ['\\\\rule'], ARCANE, '$0{2em}{1em}');\r\n\r\nmetadata(\r\n    'Decoration',\r\n    ['\\\\color', '\\\\textcolor'],\r\n    ARCANE,\r\n    '{$0{m0}A}{$0{m1}B}{$0{m2}C }{$0{m3}a}{$0{m4}b}{$0{m5}c}{$0{m6}8}'\r\n);\r\nmetadata(\r\n    'Decoration',\r\n    ['\\\\overline', '\\\\underline'],\r\n    COMMON,\r\n    '$0{\\\\placeholder{}}'\r\n);\r\nmetadata(\r\n    'Decoration',\r\n    ['\\\\enclose'],\r\n    RARE,\r\n    '\\\\enclose{updiagonalstrike,roundedbox}[1px solid red, mathbackground=\"#fbc0bd\"]{x=0}'\r\n);\r\nmetadata(\r\n    'Decoration',\r\n    ['\\\\fcolorbox'],\r\n    RARE,\r\n    '\\\\fcolorbox{#cd0030}{#ffd400}{\\\\unicode{\"2B1A}}'\r\n);\r\n\r\nmetadata(\r\n    'Decoration',\r\n    ['\\\\colorbox'],\r\n    RARE,\r\n    '\\\\colorbox{#fbc0bd}{\\\\unicode{\"2B1A}}'\r\n);\r\n\r\nmetadata(\r\n    'Decoration',\r\n    ['\\\\boxed', '\\\\cancel', '\\\\bcancel', '\\\\xcancel'],\r\n    RARE,\r\n    '$0{\\\\placeholder{}}'\r\n);\r\n\r\nmetadata(\r\n    'Decoration',\r\n    ['\\\\bbox'],\r\n    RARE,\r\n    '\\\\bbox[#ffd400, solid 2px #ffd400]{\\\\unicode{\"2B1A}}'\r\n);\r\n\r\nmetadata('Styling', ['\\\\mathbb'], SUPERCOMMON, '$0{Don Knuth}');\r\nmetadata(\r\n    'Styling',\r\n    [\r\n        '\\\\textbf',\r\n        '\\\\textup',\r\n        '\\\\textit',\r\n        '\\\\textrm',\r\n        '\\\\textsf',\r\n        '\\\\texttt',\r\n        '\\\\textnormal',\r\n        '\\\\textmd',\r\n        '\\\\textsl',\r\n        '\\\\textsc',\r\n\r\n        '\\\\mathsf',\r\n        '\\\\mathtt',\r\n        '\\\\mathrm',\r\n        '\\\\mathfrak',\r\n        '\\\\mathcal',\r\n        '\\\\mathscr',\r\n        '\\\\mathbf',\r\n        '\\\\mathmd',\r\n        '\\\\mathit',\r\n        '\\\\text',\r\n        '\\\\mbox',\r\n        '\\\\Bbb',\r\n        '\\\\bold',\r\n        '\\\\bm',\r\n        '\\\\boldsymbol',\r\n    ],\r\n    COMMON,\r\n    '$0{Don Knuth}'\r\n);\r\nmetadata(\r\n    'Styling',\r\n    [\r\n        '\\\\frak',\r\n        '\\\\tt',\r\n        '\\\\bf',\r\n        '\\\\it',\r\n        '\\\\rmfamily', // Note: In LaTeX, /rmfamily is a no-op in math mode\r\n        '\\\\sffamily',\r\n        '\\\\ttfamily',\r\n        '\\\\class',\r\n        '\\\\cssId',\r\n    ],\r\n    RARE,\r\n    '{$0 Don Knuth}'\r\n);\r\nmetadata(\r\n    'Styling',\r\n    ['\\\\bfseries', '\\\\mdseries', '\\\\upshape', '\\\\slshape', '\\\\scshape'],\r\n    RARE,\r\n    '\\\\text{$0 Don Knuth}'\r\n);\r\n\r\nmetadata(\r\n    'Styling',\r\n    ['\\\\class', '\\\\cssId'],\r\n    RARE,\r\n    '$0{testIdentifier}{Don Knuth}'\r\n);\r\n\r\n// Note: In LaTeX, \\fontseries, \\fontfamily, \\fontshape are applicable to\r\n// text mode only\r\nmetadata('Styling', ['\\\\fontseries'], RARE, '\\\\text{$0{b}Don Knuth}');\r\nmetadata('Styling', ['\\\\fontfamily'], RARE, '\\\\text{$0{cmtt}Don Knuth}');\r\nmetadata('Styling', ['\\\\fontshape'], RARE, '\\\\text{$0{sc}Don Knuth}');\r\nmetadata('Styling', ['\\\\selectfont'], RARE, '\\\\text{$0}'); // no-op, but only valid in text mode\r\n\r\nmetadata('Styling', ['\\\\emph'], RARE, 'Don$0{Knuth}');\r\nmetadata('Styling', ['\\\\em'], RARE, 'Don{$0 Knuth}');\r\n\r\nmetadata(\r\n    'Layout',\r\n    [\r\n        '\\\\mathop',\r\n        '\\\\mathbin',\r\n        '\\\\mathrel',\r\n        '\\\\mathopen',\r\n        '\\\\mathclose',\r\n        '\\\\mathpunct',\r\n        '\\\\mathord',\r\n        '\\\\mathinner',\r\n        '\\\\operatorname',\r\n        '\\\\operatorname*',\r\n    ],\r\n    RARE,\r\n    'x=$0{arg}=0'\r\n);\r\nmetadata('Layout', ['\\\\middle'], RARE, '\\\\left\\\\{x$0|x>0\\\\right\\\\}');\r\nmetadata(\r\n    'Layout',\r\n    ['\\\\overset', '\\\\underset', '\\\\stackrel', '\\\\stackbin'],\r\n    RARE,\r\n    '$0{arg}{x=0}'\r\n);\r\n\r\nmetadata('Layout', ['\\\\rlap', '\\\\mathrlap'], RARE, '$0{/}0');\r\nmetadata('Layout', ['\\\\llap', '\\\\mathllap'], RARE, 'o$0{/}');\r\n\r\nmetadata(\r\n    'Fractions',\r\n    ['\\\\frac'],\r\n    SUPERCOMMON,\r\n    '$0{\\\\placeholder{}}{\\\\placeholder{}}'\r\n);\r\nmetadata(\r\n    'Fractions',\r\n    [\r\n        '\\\\binom',\r\n        '\\\\dfrac',\r\n        '\\\\tfrac',\r\n        '\\\\dbinom',\r\n        '\\\\tbinom',\r\n        '\\\\pdiff',\r\n        '\\\\cfrac',\r\n    ],\r\n    RARE,\r\n    '$0{\\\\placeholder{}}{\\\\placeholder{}}'\r\n);\r\nmetadata(\r\n    'Fractions',\r\n    ['\\\\over', '\\\\atop', '\\\\choose'],\r\n    RARE,\r\n    '\\\\unicode{\"2B1A} $0 \\\\unicode{\"2B1A}'\r\n);\r\nmetadata(\r\n    'Fractions',\r\n    ['\\\\overwithdelims', '\\\\atopwithdelims'],\r\n    RARE,\r\n    '{\\\\unicode{\"2B1A} $0{\\\\lbrace}{\\\\rbrace} \\\\unicode{\"2B1A}}'\r\n);\r\n\r\nmetadata(\r\n    'Extensible Operators',\r\n    ['\\\\sum', '\\\\prod', '\\\\bigcap', '\\\\bigcup', '\\\\int'],\r\n    SUPERCOMMON\r\n);\r\nmetadata(\r\n    'Extensible Operators',\r\n    ['\\\\bigoplus', '\\\\smallint', '\\\\iint', '\\\\oint'],\r\n    COMMON\r\n);\r\nmetadata(\r\n    'Extensible Operators',\r\n    [\r\n        '\\\\bigwedge',\r\n        '\\\\bigvee',\r\n        '\\\\coprod',\r\n\r\n        '\\\\bigsqcup',\r\n        '\\\\bigotimes',\r\n        '\\\\bigodot',\r\n        '\\\\biguplus',\r\n\r\n        '\\\\intop',\r\n        '\\\\sqcup',\r\n        '\\\\sqcap',\r\n        '\\\\uplus',\r\n        '\\\\wr',\r\n        '\\\\Cap',\r\n        '\\\\Cup',\r\n        '\\\\doublecap',\r\n        '\\\\doublecup',\r\n        '\\\\amalg',\r\n\r\n        '\\\\iiint',\r\n        '\\\\oiint',\r\n        '\\\\oiiint',\r\n        '\\\\intclockwise',\r\n        '\\\\varointclockwise',\r\n        '\\\\ointctrclockwise',\r\n        '\\\\intctrclockwise',\r\n    ],\r\n    RARE\r\n);\r\n\r\nmetadata('Accents', ['\\\\vec'], SUPERCOMMON);\r\nmetadata(\r\n    'Accents',\r\n    ['\\\\bar', '\\\\ddot', '\\\\acute', '\\\\tilde', '\\\\check'],\r\n    COMMON,\r\n    '$0{\\\\placeholder{}}'\r\n);\r\nmetadata('Accents', ['\\\\^', '\\\\`', \"\\\\'\"], RARE, '$0{e}');\r\nmetadata('Accents', ['\\\\c'], RARE, '$0{c}');\r\nmetadata('Accents', ['\\\\~'], RARE, '$0{n}');\r\nmetadata(\r\n    'Accents',\r\n    ['\\\\mathring', '\\\\hat', '\\\\dot', '\\\\breve', '\\\\grave'],\r\n    RARE,\r\n    '$0{\\\\placeholder{}}'\r\n);\r\n\r\nmetadata(\r\n    'Extensible Symbols',\r\n    [\r\n        '\\\\overrightarrow',\r\n        '\\\\overleftarrow',\r\n        '\\\\Overrightarrow',\r\n        '\\\\overleftharpoon',\r\n        '\\\\overrightharpoon',\r\n        '\\\\overleftrightarrow',\r\n        '\\\\overbrace',\r\n        '\\\\overlinesegment',\r\n        '\\\\overgroup',\r\n        '\\\\widehat',\r\n        '\\\\widecheck',\r\n        '\\\\widetilde',\r\n    ],\r\n    COMMON,\r\n    '$0{ABC}'\r\n);\r\n\r\nmetadata(\r\n    'Extensible Symbols',\r\n    [\r\n        '\\\\underrightarrow',\r\n        '\\\\underleftarrow',\r\n        '\\\\underleftrightarrow',\r\n        '\\\\underbrace',\r\n        '\\\\underlinesegment',\r\n        '\\\\undergroup',\r\n        '\\\\utilde',\r\n    ],\r\n    COMMON,\r\n    '$0{ABC}'\r\n);\r\n\r\nmetadata(\r\n    'Sizing',\r\n    [\r\n        '\\\\tiny',\r\n        '\\\\scriptsize',\r\n        '\\\\footnotesize',\r\n        '\\\\small',\r\n        '\\\\normalsize',\r\n        '\\\\large',\r\n        '\\\\Large',\r\n        '\\\\LARGE',\r\n        '\\\\huge',\r\n        '\\\\Huge',\r\n    ],\r\n    RARE,\r\n    '$0{x=0}'\r\n);\r\n\r\nmetadata('Sizing', ['\\\\big', '\\\\Big', '\\\\bigg', '\\\\Bigg'], RARE, '$0($0)');\r\nmetadata('Sizing', ['\\\\bigl', '\\\\Bigl', '\\\\biggl', '\\\\Biggl'], RARE, '$0(');\r\nmetadata('Sizing', ['\\\\bigr', '\\\\Bigr', '\\\\biggr', '\\\\Biggr'], RARE, '$0)');\r\nmetadata('Sizing', ['\\\\bigm', '\\\\Bigm', '\\\\biggm', '\\\\Biggm'], RARE, '$0|');\r\n\r\nmetadata(\r\n    'Letterlike Symbols',\r\n    [\r\n        '\\\\nabla',\r\n        '\\\\partial',\r\n        '\\\\doubleStruckCapitalN',\r\n        '\\\\N',\r\n        '\\\\doubleStruckCapitalR',\r\n        '\\\\R',\r\n        '\\\\doubleStruckCapitalQ',\r\n        '\\\\Q',\r\n        '\\\\doubleStruckCapitalC',\r\n        '\\\\C',\r\n        '\\\\doubleStruckCapitalZ',\r\n        '\\\\Z',\r\n        '\\\\exponentialE',\r\n        '\\\\forall',\r\n        '\\\\exists',\r\n        '\\\\nexists',\r\n        '\\\\$',\r\n        '\\\\%',\r\n        '\\\\And',\r\n        '\\\\degree',\r\n    ],\r\n    SUPERCOMMON\r\n);\r\n\r\nmetadata(\r\n    'Letterlike Symbols',\r\n    [\r\n        '\\\\doubleStruckCapitalP',\r\n        '\\\\P',\r\n        '\\\\ell',\r\n        '\\\\hbar',\r\n        '\\\\hslash',\r\n        '\\\\imath',\r\n        '\\\\jmath',\r\n        '\\\\imaginaryI',\r\n        '\\\\imaginaryJ',\r\n        '\\\\differentialD',\r\n        '\\\\rd',\r\n        '\\\\capitalDifferentialD',\r\n        '\\\\rD',\r\n        '\\\\differencedelta',\r\n        '\\\\mid',\r\n        '@',\r\n        '\\\\Re',\r\n        '\\\\Im',\r\n    ],\r\n    COMMON\r\n);\r\nmetadata(\r\n    'Letterlike Symbols',\r\n    [\r\n        '\\\\top',\r\n        '\\\\bot',\r\n        '\\\\scriptCapitalE',\r\n        '\\\\scriptCapitalH',\r\n        '\\\\scriptCapitalL',\r\n        '\\\\gothicCapitalC',\r\n        '\\\\gothicCapitalH',\r\n        '\\\\gothicCapitalI',\r\n        '\\\\gothicCapitalR',\r\n        '\\\\Bbbk',\r\n        '\\\\Finv',\r\n        '\\\\Game',\r\n        '\\\\wp',\r\n        '\\\\eth',\r\n        '\\\\mho',\r\n        '\\\\pounds',\r\n        '\\\\yen',\r\n        '\\\\euro',\r\n    ],\r\n    RARE\r\n);\r\n\r\nmetadata('Crosses', ['\\\\dagger', '\\\\dag'], SUPERCOMMON);\r\n\r\nmetadata(\r\n    'Crosses',\r\n    ['\\\\ddag', '\\\\ddagger', '\\\\maltese', '\\\\textdagger', '\\\\textdaggerdbl'],\r\n    RARE\r\n);\r\n\r\nmetadata(\r\n    'Various',\r\n    [\r\n        '\\\\checkmark',\r\n\r\n        '\\\\diagup',\r\n        '\\\\diagdown',\r\n\r\n        '\\\\angle',\r\n        '\\\\measuredangle',\r\n        '\\\\sphericalangle',\r\n\r\n        '\\\\prime',\r\n        '\\\\doubleprime',\r\n        '\\\\backprime',\r\n        '\\\\backdoubleprime',\r\n        '\\\\sharp',\r\n        '\\\\flat',\r\n        '\\\\natural',\r\n        '\\\\&',\r\n        '\\\\#',\r\n        '\\\\clubsuit',\r\n        '\\\\spadesuit',\r\n        '\\\\diamondsuit',\r\n        '\\\\heartsuit',\r\n        '\\\\backslash',\r\n        '\\\\infty',\r\n        '/',\r\n        '\\\\_',\r\n        '\\\\/',\r\n        '|',\r\n        \"'\",\r\n    ],\r\n    RARE\r\n);\r\n\r\nmetadata('Various', ['\\\\unicode'], RARE, '$0{\"2B1A}');\r\n\r\nmetadata(\r\n    'Arrows',\r\n    ['\\\\longrightarrow', '\\\\rightarrow', '\\\\Longrightarrow', '\\\\Rightarrow'],\r\n    SUPERCOMMON\r\n);\r\nmetadata(\r\n    'Arrows',\r\n    [\r\n        '\\\\longmapsto',\r\n        '\\\\mapsto',\r\n        '\\\\Longleftrightarrow',\r\n        '\\\\rightleftarrows',\r\n        '\\\\leftarrow',\r\n        '\\\\curvearrowleft',\r\n        '\\\\uparrow',\r\n        '\\\\downarrow',\r\n        '\\\\hookrightarrow',\r\n        '\\\\rightharpoonup',\r\n        '\\\\rightleftharpoons',\r\n    ],\r\n    COMMON\r\n);\r\nmetadata(\r\n    'Arrows',\r\n    [\r\n        '\\\\Leftarrow',\r\n        '\\\\longleftrightarrow',\r\n        '\\\\longleftarrow',\r\n        '\\\\Longleftarrow',\r\n\r\n        '\\\\searrow',\r\n        '\\\\nearrow',\r\n        '\\\\swarrow',\r\n        '\\\\nwarrow',\r\n\r\n        '\\\\Uparrow',\r\n        '\\\\Downarrow',\r\n        '\\\\updownarrow',\r\n        '\\\\Updownarrow',\r\n\r\n        '\\\\hookleftarrow',\r\n        '\\\\leftharpoonup',\r\n        '\\\\leftharpoondown',\r\n        '\\\\rightharpoondown',\r\n\r\n        '\\\\leftrightarrows',\r\n\r\n        '\\\\dashrightarrow',\r\n        '\\\\dashleftarrow',\r\n        '\\\\leftleftarrows',\r\n        '\\\\Lleftarrow',\r\n        '\\\\twoheadleftarrow',\r\n        '\\\\leftarrowtail',\r\n        '\\\\looparrowleft',\r\n        '\\\\leftrightharpoons',\r\n        '\\\\circlearrowleft',\r\n        '\\\\Lsh',\r\n        '\\\\upuparrows',\r\n        '\\\\downharpoonleft',\r\n        '\\\\multimap',\r\n        '\\\\leftrightsquigarrow',\r\n        '\\\\twoheadrightarrow',\r\n        '\\\\rightarrowtail',\r\n        '\\\\looparrowright',\r\n        '\\\\curvearrowright',\r\n        '\\\\circlearrowright',\r\n        '\\\\Rsh',\r\n        '\\\\downdownarrows',\r\n        '\\\\upharpoonright',\r\n        '\\\\downharpoonright',\r\n        '\\\\rightsquigarrow',\r\n        '\\\\leadsto',\r\n        '\\\\Rrightarrow',\r\n        '\\\\restriction',\r\n    ],\r\n    RARE\r\n);\r\nmetadata('Arrows', ['\\\\upharpoonleft', '\\\\rightrightarrows'], CRYPTIC);\r\n\r\n// AMS Negated Arrows\r\nmetadata(\r\n    'Negated Arrows',\r\n    [\r\n        '\\\\nrightarrow',\r\n        '\\\\nRightarrow',\r\n        '\\\\nleftrightarrow',\r\n        '\\\\nLeftrightarrow',\r\n        '\\\\nleftarrow',\r\n        '\\\\nLeftarrow',\r\n    ],\r\n    RARE\r\n);\r\n\r\nmetadata(\r\n    'Extensible Symbols',\r\n    [\r\n        '\\\\xrightarrow',\r\n        '\\\\xleftarrow',\r\n        '\\\\xRightarrow',\r\n        '\\\\xLeftarrow',\r\n        '\\\\xleftharpoonup',\r\n        '\\\\xleftharpoondown',\r\n        '\\\\xrightharpoonup',\r\n        '\\\\xrightharpoondown',\r\n        '\\\\xlongequal',\r\n        '\\\\xtwoheadleftarrow',\r\n        '\\\\xtwoheadrightarrow',\r\n        '\\\\xleftrightarrow',\r\n        '\\\\xLeftrightarrow',\r\n        '\\\\xrightleftharpoons',\r\n        '\\\\xleftrightharpoons',\r\n        '\\\\xhookleftarrow',\r\n        '\\\\xhookrightarrow',\r\n        '\\\\xmapsto',\r\n        '\\\\xtofrom',\r\n        '\\\\xrightleftarrows', // From mhchem.sty package\r\n        '\\\\xrightequilibrium', // From mhchem.sty package\r\n        '\\\\xleftequilibrium',\r\n    ],\r\n    RARE,\r\n    '$0[below]{above}=0'\r\n);\r\n\r\n// AMS Negated Binary Relations\r\nmetadata(\r\n    'Negated Relations',\r\n    [\r\n        '\\\\nless',\r\n        '\\\\nleqslant',\r\n        '\\\\lneq',\r\n        '\\\\lneqq',\r\n        '\\\\nleqq',\r\n\r\n        '\\\\unlhd',\r\n        '\\\\unrhd',\r\n\r\n        '\\\\lvertneqq',\r\n        '\\\\lnsim',\r\n        '\\\\lnapprox',\r\n        '\\\\nprec',\r\n        '\\\\npreceq',\r\n        '\\\\precnsim',\r\n        '\\\\precnapprox',\r\n        '\\\\nsim',\r\n        '\\\\nshortmid',\r\n        '\\\\nmid',\r\n        '\\\\nvdash',\r\n        '\\\\nvDash',\r\n        '\\\\ngtr',\r\n        '\\\\ngeqslant',\r\n        '\\\\ngeqq',\r\n        '\\\\gneq',\r\n        '\\\\gneqq',\r\n        '\\\\gvertneqq',\r\n        '\\\\gnsim',\r\n        '\\\\nsucc',\r\n        '\\\\succnsim',\r\n        '\\\\ncong',\r\n        '\\\\nshortparallel',\r\n        '\\\\nparallel',\r\n        '\\\\nVDash',\r\n        '\\\\nVdash',\r\n        '\\\\precneqq',\r\n        '\\\\succneqq',\r\n        '\\\\gnapprox',\r\n        '\\\\succnapprox',\r\n        '\\\\nsucceq',\r\n    ],\r\n    RARE\r\n);\r\n\r\n// AMS Hebrew\r\nmetadata('Hebrew', ['\\\\aleph', '\\\\beth', '\\\\daleth', '\\\\gimel'], RARE);\r\n\r\nmetadata(\r\n    'Fences',\r\n    [\r\n        '\\\\lbrace',\r\n        '\\\\rbrace',\r\n        '\\\\vert',\r\n        '\\\\Vert',\r\n        '\\\\{',\r\n        '\\\\}',\r\n        '(',\r\n        ')',\r\n        '[',\r\n        ']',\r\n    ],\r\n    SUPERCOMMON\r\n);\r\nmetadata(\r\n    'Fences',\r\n    [\r\n        '\\\\langle',\r\n        '\\\\rangle',\r\n        '\\\\lfloor',\r\n        '\\\\rfloor',\r\n        '\\\\lceil',\r\n        '\\\\rceil',\r\n        '\\\\mvert',\r\n        '\\\\|',\r\n        '\\\\mVert',\r\n    ],\r\n    COMMON\r\n);\r\nmetadata(\r\n    'Fences',\r\n    [\r\n        '\\\\lvert',\r\n        '\\\\rvert',\r\n        '\\\\lVert',\r\n        '\\\\rVert',\r\n        '\\\\lbrack',\r\n        '\\\\rbrack',\r\n        '\\\\ulcorner',\r\n        '\\\\urcorner',\r\n        '\\\\llcorner',\r\n        '\\\\lrcorner',\r\n        '\\\\lgroup',\r\n        '\\\\rgroup',\r\n        '\\\\lmoustache',\r\n        '\\\\rmoustache',\r\n    ],\r\n    RARE\r\n);\r\n\r\nmetadata(\r\n    'Relations',\r\n    ['=', '\\\\ne', '\\\\neq', '<', '>', '\\\\leqslant', '\\\\geqslant', '\\\\approx'],\r\n    SUPERCOMMON\r\n);\r\nmetadata(\r\n    'Relations',\r\n    [\r\n        '\\\\lt',\r\n        '\\\\gt',\r\n        '\\\\le',\r\n        '\\\\ge',\r\n        '\\\\leq',\r\n        '\\\\geq',\r\n        '\\\\gg',\r\n        '\\\\cong',\r\n        '\\\\equiv',\r\n        '\\\\prec',\r\n        '\\\\preceq',\r\n        '\\\\succ',\r\n        '\\\\perp',\r\n        '\\\\parallel',\r\n        '\\\\propto',\r\n        '\\\\smile',\r\n        '\\\\frown',\r\n        '\\\\sim',\r\n        '\\\\gtrsim',\r\n    ],\r\n    COMMON\r\n);\r\nmetadata(\r\n    'Relations',\r\n    [\r\n        '\\\\coloneq',\r\n        '\\\\succeq',\r\n\r\n        '\\\\approxeq',\r\n        '\\\\thickapprox',\r\n        '\\\\lessapprox',\r\n        '\\\\gtrapprox',\r\n        '\\\\precapprox',\r\n        '\\\\succapprox',\r\n\r\n        '\\\\thicksim',\r\n        '\\\\succsim',\r\n        '\\\\precsim',\r\n        '\\\\backsim',\r\n        '\\\\eqsim',\r\n        '\\\\backsimeq',\r\n        '\\\\simeq',\r\n        '\\\\lesssim',\r\n\r\n        '\\\\nleq',\r\n        '\\\\ngeq',\r\n\r\n        '\\\\smallsmile',\r\n        '\\\\smallfrown',\r\n        '\\\\bowtie',\r\n\r\n        '\\\\asymp',\r\n\r\n        '\\\\leqq',\r\n        '\\\\eqslantless',\r\n\r\n        '\\\\ll',\r\n\r\n        '\\\\lll',\r\n        '\\\\lessgtr',\r\n        '\\\\lesseqgtr',\r\n        '\\\\lesseqqgtr',\r\n        '\\\\risingdotseq',\r\n        '\\\\fallingdotseq',\r\n        '\\\\preccurlyeq',\r\n        '\\\\curlyeqprec',\r\n        '\\\\vDash',\r\n        '\\\\Vvdash',\r\n        '\\\\bumpeq',\r\n        '\\\\Bumpeq',\r\n        '\\\\geqq',\r\n        '\\\\eqslantgtr',\r\n        '\\\\ggg',\r\n        '\\\\gtrless',\r\n        '\\\\gtreqless',\r\n        '\\\\gtreqqless',\r\n\r\n        '\\\\succcurlyeq',\r\n        '\\\\curlyeqsucc',\r\n        '\\\\Vdash',\r\n        '\\\\shortmid',\r\n        '\\\\shortparallel',\r\n        '\\\\between',\r\n        '\\\\pitchfork',\r\n        '\\\\varpropto',\r\n        '\\\\backepsilon',\r\n        '\\\\llless',\r\n        '\\\\gggtr',\r\n        '\\\\lhd',\r\n        '\\\\rhd',\r\n        '\\\\Join',\r\n\r\n        '\\\\doteq',\r\n        '\\\\doteqdot',\r\n        '\\\\Doteq',\r\n        '\\\\eqcirc',\r\n        '\\\\circeq',\r\n        '\\\\lessdot',\r\n        '\\\\gtrdot',\r\n        '\\\\measeq',\r\n        '\\\\eqdef',\r\n        '\\\\questeq',\r\n    ],\r\n    RARE\r\n);\r\n\r\nmetadata(\r\n    'Logic',\r\n    ['\\\\leftrightarrow', '\\\\Leftrightarrow', '\\\\to'],\r\n    SUPERCOMMON\r\n);\r\nmetadata('Logic', ['\\\\models', '\\\\vdash'], COMMON);\r\nmetadata(\r\n    'Logic',\r\n    [\r\n        '\\\\therefore',\r\n        '\\\\because',\r\n        '\\\\implies',\r\n        '\\\\gets',\r\n        '\\\\dashv',\r\n        '\\\\impliedby',\r\n        '\\\\biconditional',\r\n        '\\\\roundimplies',\r\n    ],\r\n    RARE\r\n);\r\n\r\nmetadata('Operators', ['+', '-', '*', '\\\\cdot'], SUPERCOMMON);\r\nmetadata('Operators', ['\\\\sqrt'], SUPERCOMMON, '$0{\\\\placeholder{}}');\r\n\r\nmetadata('Operators', ['\\\\pm', '\\\\mp', '\\\\times', '\\\\div', '\\\\surd'], COMMON);\r\n\r\nmetadata(\r\n    'Operators',\r\n    [\r\n        '\\\\ltimes',\r\n        '\\\\rtimes',\r\n        '\\\\leftthreetimes',\r\n        '\\\\rightthreetimes',\r\n        '\\\\intercal',\r\n        '\\\\dotplus',\r\n        '\\\\centerdot',\r\n        '\\\\doublebarwedge',\r\n        '\\\\divideontimes',\r\n        '\\\\divides',\r\n    ],\r\n    RARE\r\n);\r\n\r\nmetadata('Logic', ['\\\\wedge', '\\\\vee', '\\\\neg'], SUPERCOMMON);\r\nmetadata('Logic', ['\\\\lnot'], COMMON);\r\nmetadata(\r\n    'Logic',\r\n    [\r\n        '\\\\land',\r\n        '\\\\lor',\r\n        '\\\\barwedge',\r\n        '\\\\veebar',\r\n        '\\\\nor',\r\n        '\\\\curlywedge',\r\n        '\\\\curlyvee',\r\n    ],\r\n    RARE\r\n);\r\n\r\nmetadata(\r\n    'Greek',\r\n    [\r\n        '\\\\alpha',\r\n        '\\\\beta',\r\n        '\\\\gamma',\r\n        '\\\\delta',\r\n        '\\\\epsilon',\r\n        '\\\\varepsilon',\r\n        '\\\\zeta',\r\n        '\\\\eta',\r\n        '\\\\theta',\r\n        '\\\\vartheta',\r\n        '\\\\iota',\r\n        '\\\\kappa',\r\n        '\\\\varkappa',\r\n        '\\\\lambda',\r\n        '\\\\mu',\r\n        '\\\\nu',\r\n        '\\\\xi',\r\n        '\\\\pi',\r\n        '\\\\varpi',\r\n        '\\\\rho',\r\n        '\\\\varrho',\r\n        '\\\\sigma',\r\n        '\\\\varsigma',\r\n        '\\\\tau',\r\n        '\\\\phi',\r\n        '\\\\varphi',\r\n        '\\\\upsilon',\r\n        '\\\\chi',\r\n        '\\\\psi',\r\n        '\\\\omega',\r\n        '\\\\Gamma',\r\n        '\\\\Delta',\r\n        '\\\\Theta',\r\n        '\\\\Lambda',\r\n        '\\\\Xi',\r\n        '\\\\Pi',\r\n        '\\\\Sigma',\r\n        '\\\\Upsilon',\r\n        '\\\\Phi',\r\n        '\\\\Psi',\r\n        '\\\\Omega',\r\n        '\\\\digamma',\r\n        '\\\\omicron',\r\n    ],\r\n    COMMON\r\n);\r\n\r\nmetadata(\r\n    'Sets',\r\n    [\r\n        '\\\\emptyset',\r\n        '\\\\varnothing',\r\n        '\\\\cap',\r\n        '\\\\cup',\r\n        '\\\\in',\r\n        '\\\\notin',\r\n        '\\\\subset',\r\n        '\\\\supset',\r\n        '\\\\subseteq',\r\n        '\\\\supseteq',\r\n        '\\\\sqsubseteq',\r\n    ],\r\n    SUPERCOMMON\r\n);\r\nmetadata(\r\n    'Sets',\r\n    [\r\n        '\\\\setminus',\r\n        '\\\\not',\r\n        '\\\\ni',\r\n        '\\\\sqsupseteq',\r\n        '\\\\nsupseteqq',\r\n        '\\\\supsetneq',\r\n        '\\\\varsupsetneq',\r\n        '\\\\supsetneqq',\r\n        '\\\\varsupsetneqq',\r\n    ],\r\n    COMMON\r\n);\r\nmetadata(\r\n    'Sets',\r\n    [\r\n        '\\\\smallsetminus',\r\n        '\\\\complement',\r\n\r\n        '\\\\owns',\r\n        '\\\\subsetneq',\r\n        '\\\\varsubsetneq',\r\n        '\\\\subsetneqq',\r\n        '\\\\varsubsetneqq',\r\n        '\\\\nsubset',\r\n        '\\\\nsupset',\r\n        '\\\\nsubseteq',\r\n        '\\\\nsupseteq',\r\n        '\\\\nsubseteqq',\r\n        '\\\\subseteqq',\r\n        '\\\\Subset',\r\n        '\\\\sqsubset',\r\n        '\\\\supseteqq',\r\n        '\\\\Supset',\r\n        '\\\\sqsupset',\r\n    ],\r\n    RARE\r\n);\r\n\r\nmetadata(\r\n    'Spacing',\r\n    ['\\\\space, \\\\quad', '\\\\qquad'],\r\n    COMMON,\r\n    '\\\\unicode{\"203A}$0\\\\unicode{\"2039}'\r\n);\r\nmetadata(\r\n    'Spacing',\r\n    ['\\\\!', '\\\\,', '\\\\:', '\\\\;', '\\\\enskip', '\\\\enspace'],\r\n    RARE,\r\n    '\\\\unicode{\"203A}$0\\\\unicode{\"2039}'\r\n);\r\nmetadata(\r\n    'Spacing',\r\n    ['\\\\hspace', '\\\\hspace*'],\r\n    RARE,\r\n    '\\\\unicode{\"203A}$0{1em}\\\\unicode{\"2039}'\r\n);\r\nmetadata(\r\n    'Punctuation',\r\n    [\r\n        '\\\\colon',\r\n        '\\\\cdotp',\r\n        '\\\\ldots',\r\n        '\\\\cdots',\r\n        '\\\\ddots',\r\n        '\\\\vdots',\r\n        '?',\r\n        '!',\r\n        ':',\r\n        '\"',\r\n        ',',\r\n        '.',\r\n        ';',\r\n    ],\r\n    COMMON\r\n);\r\nmetadata('Punctuation', ['\\\\mathellipsis', '\\\\ldotp', '\\\\Colon'], RARE);\r\n\r\nmetadata('Boxes', ['\\\\square', '\\\\Box'], COMMON);\r\nmetadata(\r\n    'Boxes',\r\n    ['\\\\blacksquare', '\\\\boxminus', '\\\\boxplus', '\\\\boxtimes', '\\\\boxdot'],\r\n    RARE\r\n);\r\n\r\nmetadata(\r\n    'Circles',\r\n    ['\\\\circ', '\\\\bullet', '\\\\circleddash', '\\\\oplus', '\\\\otimes'],\r\n    COMMON\r\n);\r\nmetadata(\r\n    'Circles',\r\n    [\r\n        '\\\\bigcirc',\r\n        '\\\\circledast',\r\n        '\\\\ominus',\r\n        '\\\\circledcirc',\r\n        '\\\\oslash',\r\n        '\\\\circledS',\r\n        '\\\\circledR',\r\n        '\\\\odot',\r\n    ],\r\n    RARE\r\n);\r\n\r\nmetadata('Triangles', ['\\\\triangle', '\\\\triangleq'], COMMON);\r\nmetadata(\r\n    'Triangles',\r\n    [\r\n        '\\\\bigtriangleup',\r\n        '\\\\vartriangle',\r\n        '\\\\triangledown',\r\n        '\\\\bigtriangledown',\r\n        '\\\\triangleleft',\r\n        '\\\\vartriangleleft',\r\n        '\\\\trianglelefteq',\r\n        '\\\\ntriangleleft',\r\n        '\\\\ntrianglelefteq',\r\n        '\\\\triangleright',\r\n        '\\\\vartriangleright',\r\n        '\\\\trianglerighteq',\r\n        '\\\\ntriangleright',\r\n        '\\\\ntrianglerighteq',\r\n        '\\\\blacktriangle',\r\n        '\\\\blacktriangledown',\r\n        '\\\\blacktriangleleft',\r\n        '\\\\blacktriangleright',\r\n    ],\r\n    RARE\r\n);\r\n\r\nmetadata('Shapes', ['\\\\ast', '\\\\star'], COMMON);\r\nmetadata(\r\n    'Shapes',\r\n    ['\\\\diamond', '\\\\Diamond', '\\\\lozenge', '\\\\blacklozenge', '\\\\bigstar'],\r\n    RARE\r\n);\r\n","import { MathfieldOptions } from './options';\nimport { Selector } from './commands';\nimport {\n    Mathfield,\n    InsertOptions,\n    OutputFormat,\n    Offset,\n    Range,\n    Selection,\n} from './mathfield';\nimport { MathfieldErrorCode, ParseMode, ParserErrorCode, Style } from './core';\n\nimport {\n    get as getOptions,\n    getDefault as getDefaultOptions,\n    update as updateOptions,\n} from '../editor/options';\nimport { MathfieldPrivate } from '../editor-mathfield/mathfield-private';\nimport { isOffset, isRange, isSelection } from '../editor/model';\n\n//\n// Custom Events\n//\n\n/*\n    ## Event retargeting\n    Some events bubble up through the DOM tree, so that they are detectable by\n     any element on the page.\n\n    Bubbling events fired from within shadow DOM are retargeted so that, to any\n    listener external to your component, they appear to come from your component itself.\n\n    ## Custom Event Bubbling\n\n    By default, a bubbling custom event fired inside shadow DOM will stop\n    bubbling when it reaches the shadow root.\n\n    To make a custom event pass through shadow DOM boundaries, you must set\n    both the `composed` and `bubbles` flags to true.\n*/\n\n/**\n * The `math-error` custom event signals an error while parsing an expression.\n *\n * ```javascript\n * document.getElementById('mf').addEventListener('math-error', (ev) => {\n *  const err = ev.detail;\n *  console.warn(err.code + (err.arg ? ': ' + err.arg : '') +\n *         '\\n%c|  ' + err.before + '%c' + err.after +\n *         '\\n%c|  ' + String(' ').repeat(err.before.length) +\n *         '',\n *         'font-weight: bold',\n *         'font-weight: normal; color: rgba(160, 160, 160)',\n *         'font-weight: bold; color: hsl(4deg, 90%, 50%)'\n *     );\n * });\n * ```\n */\nexport type MathErrorEvent = {\n    code: ParserErrorCode | MathfieldErrorCode;\n    arg?: string;\n    latex?: string;\n    before?: string;\n    after?: string;\n};\n\n/**\n * The `keystroke` event is fired when a keystroke is about to be procesed.\n * The event is cancellable, which wills suprress further handling of the event.\n *\n */\nexport type KeystrokeEvent = {\n    /** A string descring the keystroke, for example `\"Alt-KeyU\". See [W3C UIEvents](https://www.w3.org/TR/uievents/#keys-keyvalues)\n     * for more information on the format of the descriptor.\n     *\n     */\n    keystroke: string;\n    /** The native keyboard event */\n    event?: KeyboardEvent;\n};\n\n/**\n * The `focus-out` event signals that the mathfield has lost focus through keyboard\n * navigation with arrow keys or the tab key.\n *\n * The event `detail.direction` property indicates the direction the cursor\n * was moving which can be useful to decide which element to focus next.\n *\n * The event is cancelable, which will prevent the field from losing focus.\n *\n * ```javascript\n * mfe.addEventListener('focus-out', (ev) => {\n *  console.log(\"Losing focus \", ev.detail.direction);\n * });\n * ```\n */\nexport type FocusOutEvent = {\n    direction: 'forward' | 'backward' | 'upward' | 'downward';\n};\n\ndeclare global {\n    /**\n     * Map the custom event names to types\n     * @internal\n     */\n    interface DocumentEventMap {\n        ['math-error']: CustomEvent<MathErrorEvent>;\n        ['keystroke']: CustomEvent<KeystrokeEvent>;\n        ['focus-out']: CustomEvent<FocusOutEvent>;\n    }\n}\n\nconst MATHFIELD_TEMPLATE = document.createElement('template');\nMATHFIELD_TEMPLATE.innerHTML = `<style>\n:host {\n    display: block;\n}\n:host([hidden]) {\n    display: none;\n}\n:host([disabled]) {\n    opacity:  .5;\n}\n:host(:focus), :host(:focus-within) {\n    outline: Highlight auto 1px;    /* For Firefox */\n    outline: -webkit-focus-ring-color auto 1px;\n}\n</style>\n<div></div><slot style=\"display:none\"></slot>`;\n\n//\n// Deferred State\n//\n// Methods such as `setOptions()` or `getOptions()` could be called before\n// the element has been connected (i.e. `mf = new MathfieldElement(); mf.setConfig()`...)\n// and therefore before the matfield instance has been created.\n// So we'll stash any deferred operations on options (and value) here, and\n// will apply them to the element when it gets connected to the DOM.\n//\nconst gDeferredState = new WeakMap<\n    MathfieldElement,\n    {\n        value: string;\n        selection: Selection;\n        options: Partial<MathfieldOptions>;\n    }\n>();\n\n/**\n * The `MathfieldElement` class provides special properties and\n * methods to control the display and behavior of `<math-field>`\n * elements.\n *\n * It inherits many useful properties and methods from [[`HTMLElement`]] such\n * as `style`, `tabIndex`, `addEventListener()`, `getAttribute()`,  etc...\n *\n * To create a new `MathfieldElement`:\n *\n * ```javascript\n * // 1. Create a new MathfieldElement\n * const mfe = new MathfieldElement();\n * // 2. Attach it to the DOM\n * document.body.appendChild(mfe);\n * ```\n *\n * The `MathfieldElement` constructor has an optional argument of\n * [[`MathfieldOptions`]] to configure the element. The options can also\n * be modified later:\n *\n * ```javascript\n * // Setting options during construction\n * const mfe = new MathfieldElement({smartFence: false});\n * // Modifying options after construction\n * mfe.setOptions({smartFence: true});\n * ```\n *\n * ### CSS Variables\n *\n * To customize the appearance of the mathfield, declare the following CSS\n * variables (custom properties) in a ruleset that applied to the mathfield.\n * ```css\n * math-field {\n *  --hue: 10       // Set the highlight color and caret to a reddish hue\n * }\n * ```\n *\n * | CSS Variable | Usage |\n * |:---|:---|\n * | `--hue` | Hue of the highlight color and the caret |\n * | `--highlight` | Color of the selection |\n * | `--highlight-inactive` | Color of the selection, when the mathfield is not focused |\n * | `--caret` | Color of the caret/insertion point |\n * | `--primary` | Primary accent color, used for example in the virtual keyboard |\n * | `--text-font-family` | The font stack used in text mode |\n * | `--keyboard-zindex` | The z-index attribute of the virtual keyboard panel |\n *\n * ### CSS Parts\n *\n * To style the virtual keyboard toggle, use the `virtual-keyboard-toggle` CSS\n * part. To use it, define a CSS rule with a `::part()` selector\n * for example:\n * ```css\n * math-field::part(virtual-keyboard-toggle) {\n *  color: red;\n * }\n * ```\n *\n *\n * ### Attributes\n *\n * An attribute is a key-value pair set as part of the tag:\n *\n * ```html\n * <math-field locale=\"fr\"></math-field>\n * ```\n *\n * The supported attributes are listed in the table below with their correspnding\n * property.\n *\n * The property can be changed either directly on the\n * `MathfieldElement` object, or using `setOptions()` if it is prefixed with\n * `options.`, for example\n * ```javascript\n *  getElementById('mf').value = '\\\\sin x';\n *  getElementById('mf').setOptions({horizontalSpacingScale: 1.1});\n * ```\n *\n * The values of attributes and properties are reflected, which means you can change one or the\n * other, for example:\n * ```javascript\n * getElementById('mf').setAttribute('virtual-keyboard-mode',  'manual');\n * console.log(getElementById('mf').getOption('virtualKeyboardMode'));\n * // Result: \"manual\"\n * getElementById('mf').setOptions({virtualKeyboardMode: 'onfocus');\n * console.log(getElementById('mf').getAttribute('virtual-keyboard-mode');\n * // Result: 'onfocus'\n * ```\n *\n * An exception is the `value` property, which is not reflected on the `value`\n * attribute: the `value` attribute remains at its initial value.\n *\n *\n * | Attribute | Property |\n * |:---|:---|\n * | `disabled` | `disabled` |\n * | `default-mode` | `options.defaultMode` |\n * | `fonts-directory` | `options.fontsDirectory` |\n * | `sounds-directory` | `options.soundsDirectory` |\n * | `horizontal-spacing-scale` | `options.horizontalSpacingScale` |\n * | `ignore-spacebar-in-math-mode` | `options.ignoreSpacbarInMathMode` |\n * | `inline-shortcut-timeout` | `options.inlineShortcutTimeout` |\n * | `keypress-vibration` | `options.keypressVibration` |\n * | `letter-shape-style` | `options.letterShapeStyle` |\n * | `locale` | `options.locale` |\n * | `read-only` | `options.readOnly` |\n * | `remove-extraneous-parentheses` | `options.removeExtraneousParentheses` |\n * | `smart-fence` | `options.smartFence` |\n * | `smart-mode` | `options.smartMode` |\n * | `smart-superscript` | `options.superscript` |\n * | `speech-engine` | `options.speechEngine` |\n * | `speech-engine-rate` | `options.speechEngineRate` |\n * | `speech-engine-voice` | `options.speechEngineVoice` |\n * | `text-to-speech-markup` | `options.textToSpeechMarkup` |\n * | `text-to-speech-rules` | `options.textToSpeechRules` |\n * | `value` | value |\n * | `virtual-keyboard-layout` | `options.keyboardLayout` |\n * | `virtual-keyboard-mode` | `options.keyboardMode` |\n * | `virtual-keyboard-theme` | `options.keyboardTheme` |\n * | `virtual-keyboards` | `options.keyboards` |\n *\n * See [[`MathfieldOptions`]] for more details about these options.\n *\n * In addition, the following [global attributes](https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes)\n * can also be used:\n * - `class`\n * - `data-*`\n * - `hidden`\n * - `id`\n * - `item*`\n * - `style`\n * - `tabindex`\n *\n *\n * ### Events\n *\n * Listen to these events by using `addEventListener()`. For events with additional\n * arguments, the arguments are availble in `event.detail`.\n *\n * | Event Name  | Description |\n * |:---|:---|\n * | `input` | The value of the mathfield has been modified. This happens on almost every keystroke in the mathfield.  |\n * | `change` | The user has commited the value of the mathfield. This happens when the user presses **Return** or leaves the mathfield. |\n * | `selection-change` | The selection (or caret position) in the mathfield has changed |\n * | `mode-change` | The mode (`math`, `text`) of the mathfield has changed |\n * | `undo-state-change` |  The state of the undo stack has changed |\n * | `read-aloud-status-change` | The status of a read aloud operation has changed |\n * | `virtual-keyboard-toggle` | The visibility of the virtual keyboard panel has changed |\n * | `blur` | The mathfield is losing focus |\n * | `focus` | The mathfield is gaining focus |\n * | `focus-out` | The user is navigating out of the mathfield, typically using the keyboard<br> `detail: {direction: 'forward' | 'backward' | 'upward' | 'downward'}` **cancellable**|\n * | `math-error` | A parsing or configuration error happened <br> `detail: ErrorListener<ParserErrorCode | MathfieldErrorCode>` |\n * | `keystroke` | The user typed a keystroke with a physical keyboard <br> `detail: {keystroke: string, event: KeyboardEvent}` |\n * | `mount` | The element has been attached to the DOM |\n * | `unmount` | The element is about to be removed from the DOM |\n *\n */\nexport class MathfieldElement extends HTMLElement implements Mathfield {\n    /**\n     * Private lifecycle hooks\n     * @internal\n     */\n    static get optionsAttributes(): {\n        [attribute: string]: 'number' | 'boolean' | 'string';\n    } {\n        return {\n            'default-mode': 'string',\n            'fonts-directory': 'string',\n            'horizontal-spacing-scale': 'number',\n            'ignore-spacebar-in-math-mode': 'boolean',\n            'inline-shortcut-timeout': 'number',\n            'keypress-vibration': 'boolean',\n            'letter-shape-style': 'string',\n            locale: 'string',\n            'read-only': 'boolean',\n            'remove-extraneous-parentheses': 'boolean',\n            'smart-fence': 'boolean',\n            'smart-mode': 'boolean',\n            'smart-superscript': 'boolean',\n            'speech-engine': 'string',\n            'speech-engine-rate': 'string',\n            'speech-engine-voice': 'string',\n            'text-to-speech-markup': 'string',\n            'text-to-speech-rules': 'string',\n            'virtual-keyboard-layout': 'string',\n            'virtual-keyboard-mode': 'string',\n            'virtual-keyboard-theme': 'string',\n            'virtual-keyboards': 'string',\n        };\n    }\n    /**\n     * Custom elements lifecycle hooks\n     * @internal\n     */\n    static get observedAttributes(): string[] {\n        return [...Object.keys(MathfieldElement.optionsAttributes), 'disabled'];\n    }\n\n    #mathfield: MathfieldPrivate;\n\n    /**\n     * To create programmatically a new mahfield use:\n     * ```javascript\n    let mfe = new MathfieldElement();\n    // Set initial value and options\n    mfe.value = \"\\\\frac{\\\\sin(x)}{\\\\cos(x)}\";\n    // Options can be set either as an attribute (for simple options)...\n    mfe.setAttribute('virtual-keyboard-layout', 'dvorak');\n    // ... or using `setOptions()`\n    mfe.setOptions({\n        virtualKeyboardMode: 'manual',\n    });\n    // Attach the element to the DOM\n    document.body.appendChild(mfe);\n    * ```\n    */\n    constructor(options?: Partial<MathfieldOptions>) {\n        super();\n\n        this.attachShadow({ mode: 'open' });\n        this.shadowRoot.appendChild(MATHFIELD_TEMPLATE.content.cloneNode(true));\n        const slot = this.shadowRoot.querySelector<HTMLSlotElement>(\n            'slot:not([name])'\n        );\n\n        // When the elements get focused (through tabbing for example)\n        // focus the mathfield\n        this.shadowRoot.host.addEventListener(\n            'focus',\n            (_event) => this.focus(),\n            true\n        );\n\n        // Inline options (as a JSON structure in the markup)\n        try {\n            const json = slot\n                .assignedElements()\n                .filter((x) => x['type'] !== 'application/json')\n                .map((x) => x.textContent)\n                .join('');\n            if (json) {\n                this.setOptions(JSON.parse(json));\n            }\n        } catch (e) {\n            console.log(e);\n        }\n\n        // Record the (optional) configuration options, as a deferred state\n        if (options) {\n            this.setOptions(options);\n        }\n\n        // Check if there is a `value` attribute and set the initial value\n        // of the mathfield from it\n        if (this.hasAttribute('value')) {\n            this.value = this.getAttribute('value');\n        } else {\n            this.value =\n                slot\n                    ?.assignedNodes()\n                    .map((x) => (x.nodeType === 3 ? x.textContent : ''))\n                    .join('')\n                    .trim() ?? '';\n        }\n\n        slot.addEventListener('slotchange', (e) => {\n            if (e.target !== slot) return;\n            const value = slot\n                .assignedNodes()\n                .map((x) => (x.nodeType === 3 ? x.textContent : ''))\n                .join('')\n                .trim();\n            if (!this.#mathfield) {\n                this.value = value;\n            } else {\n                // Don't suppress notification changes. We need to know\n                // if the value has changed indirectly through slot manipulation\n                this.#mathfield.setValue(value, {\n                    insertionMode: 'replaceAll',\n                });\n            }\n        });\n    }\n\n    get mode(): ParseMode {\n        return this.#mathfield?.mode;\n    }\n    set mode(value: ParseMode) {\n        if (!this.#mathfield) return;\n        this.#mathfield.mode = value;\n    }\n\n    /**\n     *  @category Options\n     */\n    getOptions<K extends keyof MathfieldOptions>(\n        keys: K[]\n    ): Pick<MathfieldOptions, K>;\n    getOptions(): MathfieldOptions;\n    getOptions(\n        keys?: keyof MathfieldOptions | (keyof MathfieldOptions)[]\n    ): any | Partial<MathfieldOptions> {\n        if (this.#mathfield) {\n            return getOptions(this.#mathfield.options, keys);\n        }\n        if (!gDeferredState.has(this)) return null;\n        return getOptions(\n            updateOptions(\n                getDefaultOptions(),\n                gDeferredState.get(this).options\n            ),\n            keys\n        );\n    }\n    /**\n     *  @category Options\n     */\n    getOption<K extends keyof MathfieldOptions>(key: K): MathfieldOptions[K] {\n        return (this.getOptions([key]) as unknown) as MathfieldOptions[K];\n    }\n\n    /**\n     *  @category Options\n     */\n    setOptions(options: Partial<MathfieldOptions>): void {\n        if (this.#mathfield) {\n            this.#mathfield.setOptions(options);\n        } else {\n            if (gDeferredState.has(this)) {\n                gDeferredState.set(this, {\n                    value: gDeferredState.get(this).value,\n                    selection: { ranges: [[0, -1]] },\n                    options: {\n                        ...gDeferredState.get(this).options,\n                        ...options,\n                    },\n                });\n            } else {\n                gDeferredState.set(this, {\n                    value: '',\n                    selection: { ranges: [[0, 0]] },\n                    options: options,\n                });\n            }\n        }\n\n        // Reflect options to attributes\n        reflectAttributes(this);\n    }\n    /**\n     * Execute a [[`Commands`|command]] defined by a selector.\n     * ```javascript\n     * mfe.executeCommand('add-column-after');\n     * mfe.executeCommand(['switch-mode', 'math']);\n     * ```\n     *\n     * @param command - A selector, or an array whose first element\n     * is a selector, and whose subsequent elements are arguments to the selector.\n     *\n     * Selectors can be passed either in camelCase or kebab-case.\n     *\n     * ```javascript\n     * // Both calls do the same thing\n     * mfe.executeCommand('selectAll');\n     * mfe.executeCommand('select-all');\n     * ```\n     */\n    executeCommand(command: Selector | [Selector, ...any[]]): boolean {\n        return this.#mathfield?.executeCommand(command) ?? false;\n    }\n\n    /**\n     *  @category Accessing and changing the content\n     */\n    getValue(): string;\n    getValue(format: OutputFormat): string;\n    getValue(start: Offset, end: Offset, format?: OutputFormat): string;\n    getValue(range: Range, format?: OutputFormat): string;\n    getValue(selection: Selection, format?: OutputFormat): string;\n    getValue(\n        arg1?: Offset | Range | Selection | OutputFormat,\n        arg2?: Offset | OutputFormat,\n        arg3?: OutputFormat\n    ): string {\n        if (this.#mathfield) {\n            return this.#mathfield.getValue(arg1 as any, arg2 as any, arg3);\n        }\n        if (gDeferredState.has(this)) {\n            let start: Offset;\n            let end: Offset;\n            let format: OutputFormat;\n            if (isSelection(arg1)) {\n                [start, end] = arg1.ranges[0];\n                format = arg2 as OutputFormat;\n            } else if (isRange(arg1)) {\n                [start, end] = arg1;\n                format = arg2 as OutputFormat;\n            } else if (isOffset(arg1) && isOffset(arg2)) {\n                start = arg1;\n                end = arg2;\n                format = arg3 as OutputFormat;\n            } else {\n                start = 0;\n                end = -1;\n                format = arg1 as OutputFormat;\n            }\n            if (format === 'latex' && start === 0 && end === -1) {\n                return gDeferredState.get(this).value;\n            }\n        }\n        return undefined;\n    }\n\n    /**\n     *  @category Accessing and changing the content\n     */\n    setValue(value?: string, options?: InsertOptions): void {\n        if (this.#mathfield) {\n            this.#mathfield.setValue(value, options);\n            return;\n        }\n        if (gDeferredState.has(this)) {\n            gDeferredState.set(this, {\n                value,\n                selection: { ranges: [[0, -1]], direction: 'forward' },\n                options: gDeferredState.get(this).options,\n            });\n            return;\n        }\n        gDeferredState.set(this, {\n            value,\n            selection: { ranges: [[0, -1]], direction: 'forward' },\n            options: getOptionsFromAttributes(this),\n        });\n    }\n\n    /**\n     * Return true if the mathfield is currently focused (responds to keyboard\n     * input).\n     *\n     * @category Focus\n     *\n     */\n    hasFocus(): boolean {\n        return this.#mathfield?.hasFocus() ?? false;\n    }\n    /**\n     * Sets the focus to the mathfield (will respond to keyboard input).\n     *\n     * @category Focus\n     *\n     */\n    focus(): void {\n        this.#mathfield?.focus();\n    }\n    /**\n     * Remove the focus from the mathfield (will no longer respond to keyboard\n     * input).\n     *\n     * @category Focus\n     *\n     */\n    blur(): void {\n        this.#mathfield?.blur();\n    }\n\n    /**\n     * Select the content of the mathfield.\n     * @category Selection\n     */\n    select(): void {\n        this.#mathfield?.select();\n    }\n    /**\n     * Inserts a block of text at the current insertion point.\n     *\n     * This method can be called explicitly or invoked as a selector with\n     * `executeCommand(\"insert\")`.\n     *\n     * After the insertion, the selection will be set according to the\n     * `options.selectionMode`.\n     *\n     *  @category Accessing and changing the content\n     */\n    insert(s: string, options?: InsertOptions): boolean {\n        return this.#mathfield?.insert(s, options) ?? false;\n    }\n    /**\n     * Updates the style (color, bold, italic, etc...) of the selection or sets\n     * the style to be applied to future input.\n     *\n     * If there is a selection, the style is applied to the selection\n     *\n     * If the selection already has this style, it is removed.\n     *\n     * If the selection has the style partially applied (i.e. only some\n     * sections), it is removed from those sections, and applied to the\n     * entire selection.\n     *\n     * If there is no selection, the style will apply to the next character typed.\n     *\n     * @category Accessing and changing the content\n     */\n    applyStyle(style: Style): void {\n        return this.#mathfield?.applyStyle(style);\n    }\n\n    /**\n     * The bottom location of the caret (insertion point) in viewport\n     * coordinates.\n     *\n     * See also [[`setCaretPoint`]]\n     * @category Selection\n     */\n    get caretPoint(): { x: number; y: number } {\n        return this.#mathfield?.getCaretPoint() ?? null;\n    }\n    set caretPoint(point: { x: number; y: number }) {\n        this.#mathfield?.setCaretPoint(point.x, point.y);\n    }\n    /**\n     * `x` and `y` are in viewport coordinates.\n     *\n     * Return true if the location of the point is a valid caret location.\n     *\n     * See also [[`caretPoint`]]\n     * @category Selection\n     */\n    setCaretPoint(x: number, y: number): boolean {\n        return this.#mathfield?.setCaretPoint(x, y) ?? false;\n    }\n\n    /**\n     *  Return an array of ranges matching the argument.\n     *\n     * An array is always returned, but it has no element if there are no\n     * matching items.\n     */\n    find(value: string | RegExp): Range[] {\n        return this.#mathfield?.find(value) ?? [];\n    }\n    /**\n     * Custom elements lifecycle hooks\n     * @internal\n     */\n    connectedCallback(): void {\n        if (!this.hasAttribute('role')) this.setAttribute('role', 'textbox');\n        // this.setAttribute('aria-multiline', 'false');\n        if (!this.hasAttribute('tabindex')) this.setAttribute('tabindex', '0');\n\n        this.#mathfield = new MathfieldPrivate(\n            this.shadowRoot.querySelector(':host > div'),\n            {\n                onBlur: () => {\n                    this.dispatchEvent(\n                        new Event('blur', {\n                            cancelable: false,\n                            bubbles: false, // 'focus' and 'blur' don't bubble\n                        })\n                    );\n                },\n                onContentDidChange: () => {\n                    this.dispatchEvent(\n                        new Event('input', {\n                            cancelable: false,\n                            bubbles: true,\n                        })\n                    );\n                },\n                onError: (err: {\n                    code: ParserErrorCode | MathfieldErrorCode;\n                    arg?: string;\n                    latex?: string;\n                    before?: string;\n                    after?: string;\n                }) => {\n                    this.dispatchEvent(\n                        new CustomEvent<MathErrorEvent>('math-error', {\n                            detail: {\n                                code: err.code,\n                                arg: err.arg,\n                                latex: err.latex,\n                                before: err.before,\n                                after: err.after,\n                            },\n                            cancelable: false,\n                            bubbles: true,\n                        })\n                    );\n                },\n                onFocus: () => {\n                    this.dispatchEvent(\n                        new Event('focus', {\n                            cancelable: false,\n                            bubbles: false, // 'focus' and 'blur' don't bubble\n                        })\n                    );\n                },\n                onKeystroke: (\n                    _sender: Mathfield,\n                    keystroke: string,\n                    ev: KeyboardEvent\n                ): boolean => {\n                    return this.dispatchEvent(\n                        new CustomEvent<KeystrokeEvent>('keystroke', {\n                            detail: {\n                                keystroke,\n                                event: ev,\n                            },\n                            cancelable: true,\n                            bubbles: true,\n                        })\n                    );\n                },\n                onModeChange: (_sender: Mathfield, _mode: ParseMode) => {\n                    this.dispatchEvent(\n                        new Event('mode-change', {\n                            cancelable: false,\n                            bubbles: true,\n                        })\n                    );\n                },\n                onCommit: (_sender: Mathfield) => {\n                    // Match the DOM event sent by `<input>`, `<textarea>`, etc...\n                    // Sent when the [Return] or [Enter] key is pressed, or on\n                    // focus loss if the content has changed.\n                    this.dispatchEvent(\n                        new Event('change', {\n                            cancelable: false,\n                            bubbles: true,\n                        })\n                    );\n                },\n                onMoveOutOf: (\n                    _sender: Mathfield,\n                    direction: 'forward' | 'backward' | 'upward' | 'downward'\n                ): boolean => {\n                    return this.dispatchEvent(\n                        new CustomEvent<FocusOutEvent>('focus-out', {\n                            detail: { direction },\n                            cancelable: true,\n                            bubbles: true,\n                        })\n                    );\n                },\n                onTabOutOf: (\n                    _sender: Mathfield,\n                    direction: 'forward' | 'backward'\n                ): boolean => {\n                    return this.dispatchEvent(\n                        new CustomEvent<FocusOutEvent>('focus-out', {\n                            detail: { direction },\n                            cancelable: true,\n                            bubbles: true,\n                        })\n                    );\n                },\n                onReadAloudStatus: () => {\n                    this.dispatchEvent(\n                        new Event('read-aloud-status-change', {\n                            cancelable: false,\n                            bubbles: true,\n                        })\n                    );\n                },\n                onSelectionDidChange: () => {\n                    this.dispatchEvent(\n                        new Event('selection-change', {\n                            cancelable: false,\n                            bubbles: true,\n                        })\n                    );\n                },\n                onUndoStateDidChange: () => {\n                    this.dispatchEvent(\n                        new Event('undo-state-change', {\n                            cancelable: false,\n                            bubbles: true,\n                        })\n                    );\n                },\n                onVirtualKeyboardToggle: (\n                    _sender: Mathfield,\n                    _visible: boolean,\n                    _keyboardElement: HTMLElement\n                ) => {\n                    this.dispatchEvent(\n                        new Event('virtual-keyboard-toggle', {\n                            bubbles: true,\n                            cancelable: false,\n                        })\n                    );\n                },\n                ...getOptionsFromAttributes(this),\n                ...(gDeferredState.has(this)\n                    ? gDeferredState.get(this).options\n                    : {}),\n            }\n        );\n\n        this.upgradeProperty('disabled');\n\n        // The mathfield creation could have failed\n        if (!this.#mathfield || !this.#mathfield.model) {\n            this.#mathfield = null;\n            return;\n        }\n\n        this.#mathfield.field.parentElement.addEventListener(\n            'focus',\n            (_event) => {\n                this.focus();\n            },\n            true\n        );\n\n        if (gDeferredState.has(this)) {\n            this.#mathfield.model.deferNotifications(\n                { content: false, selection: false },\n                () => {\n                    this.#mathfield.setValue(gDeferredState.get(this).value);\n                    this.#mathfield.selection = gDeferredState.get(\n                        this\n                    ).selection;\n                    gDeferredState.delete(this);\n                }\n            );\n        }\n\n        // Notify listeners that we're mounted and ready\n        this.dispatchEvent(\n            new Event('mount', {\n                cancelable: false,\n                bubbles: true,\n            })\n        );\n    }\n\n    /**\n     * Custom elements lifecycle hooks\n     * @internal\n     */\n    disconnectedCallback(): void {\n        // Notify listeners that we're about to be unmounted\n        this.dispatchEvent(\n            new Event('unmount', {\n                cancelable: false,\n                bubbles: true,\n            })\n        );\n\n        if (!this.#mathfield) return;\n\n        // Save the state (in case the elements get reconnected later)\n        const options = {};\n        Object.keys(MathfieldElement.optionsAttributes).forEach((x) => {\n            options[toCamelCase(x)] = this.#mathfield.getConfig(\n                toCamelCase(x) as any\n            );\n        });\n        gDeferredState.set(this, {\n            value: this.#mathfield.getValue(),\n            selection: this.#mathfield.selection,\n            options,\n        });\n\n        // Dispose of the mathfield\n        this.#mathfield.dispose();\n        this.#mathfield = null;\n    }\n\n    /**\n     * Private lifecycle hooks\n     * @internal\n     */\n    upgradeProperty(prop: string): void {\n        if (this.hasOwnProperty(prop)) {\n            const value: unknown = this[prop];\n            // A property may have already been set on the object, before\n            // the element was connected: delete the property (after saving its value)\n            // and use the setter to (re-)set its value.\n            delete this[prop];\n            this[prop] = value;\n        }\n    }\n\n    /**\n     * Custom elements lifecycle hooks\n     * @internal\n     */\n    attributeChangedCallback(\n        name: string,\n        oldValue: unknown,\n        newValue: unknown\n    ): void {\n        if (oldValue === newValue) return;\n        const hasValue: boolean = newValue !== null;\n        switch (name) {\n            case 'disabled':\n                this.disabled = hasValue;\n                break;\n        }\n    }\n\n    set disabled(value: boolean) {\n        const isDisabled = Boolean(value);\n        if (isDisabled) this.setAttribute('disabled', '');\n        else this.removeAttribute('disabled');\n\n        this.setAttribute('aria-disabled', isDisabled ? 'true' : 'false');\n        this.setOptions({ readOnly: isDisabled });\n    }\n\n    get disabled(): boolean {\n        return this.hasAttribute('disabled');\n    }\n\n    /**\n     *  @category Accessing and changing the content\n     */\n    set value(value: string) {\n        this.setValue(value);\n    }\n\n    /**\n     * The content of the mathfield as a Latex expression.\n     * ```\n     * document.querySelector('mf').value = '\\\\frac{1}{\\\\pi}'\n     * ```\n     *  @category Accessing and changing the content\n     */\n    get value(): string {\n        return this.getValue();\n    }\n\n    /**\n     * An array of ranges representing the selection.\n     *\n     * It is guaranteed there will be at least one element. If a discontinuous\n     * selection is present, the result will include more than one element.\n     *\n     * @category Selection\n     *\n     */\n    get selection(): Selection {\n        if (this.#mathfield) {\n            return this.#mathfield.selection;\n        }\n        if (gDeferredState.has(this)) {\n            return gDeferredState.get(this).selection;\n        }\n        return { ranges: [[0, 0]], direction: 'forward' };\n    }\n\n    /**\n     *\n     * @category Selection\n     */\n    set selection(value: Selection) {\n        if (this.#mathfield) {\n            this.#mathfield.selection = value;\n        }\n        if (gDeferredState.has(this)) {\n            gDeferredState.set(this, {\n                value: gDeferredState.get(this).value,\n                selection: value,\n                options: gDeferredState.get(this).options,\n            });\n            return;\n        }\n        gDeferredState.set(this, {\n            value: '',\n            selection: value,\n            options: getOptionsFromAttributes(this),\n        });\n    }\n\n    /**\n     * The position of the caret/insertion point, from 0 to `lastOffset`.\n     *\n     * @category Selection\n     *\n     */\n    get position(): Offset {\n        return this.#mathfield.model.position;\n    }\n\n    /**\n     * @category Selection\n     */\n    set position(offset: Offset) {\n        this.#mathfield.model.position = offset;\n    }\n\n    /**\n     * The last valid offset.\n     * @category Selection\n     */\n    get lastOffset(): Offset {\n        return this.#mathfield?.lastOffset ?? -1;\n    }\n}\n\nfunction toCamelCase(s: string): string {\n    return s\n        .toLowerCase()\n        .replace(/[^a-zA-Z0-9]+(.)/g, (m, c) => c.toUpperCase());\n}\n\nfunction reflectAttributes(el: MathfieldElement) {\n    const defaultOptions = getDefaultOptions();\n    const options = el.getOptions();\n    Object.keys(MathfieldElement.optionsAttributes).forEach((x) => {\n        const prop = toCamelCase(x);\n        if (defaultOptions[prop] !== options[prop]) {\n            if (MathfieldElement.optionsAttributes[x] === 'boolean') {\n                if (options[prop]) {\n                    // add attribute\n                    el.setAttribute(x, '');\n                } else {\n                    // remove attribute\n                    el.removeAttribute(x);\n                }\n            } else {\n                // set attribute (as string)\n                el.setAttribute(x, options[prop].toString());\n            }\n        }\n    });\n}\n\n// function toKebabCase(s: string): string {\n//     return s\n//         .match(\n//             /[A-Z]{2,}(?=[A-Z][a-z]+[0-9]*|\\b)|[A-Z]?[a-z]+[0-9]*|[A-Z]|[0-9]+/g\n//         )\n//         .map((x: string) => x.toLowerCase())\n//         .join('-');\n// }\n\nfunction getOptionsFromAttributes(\n    mfe: MathfieldElement\n): Partial<MathfieldOptions> {\n    const result = {};\n    const attribs = MathfieldElement.optionsAttributes;\n    Object.keys(attribs).forEach((x) => {\n        if (mfe.hasAttribute(x)) {\n            const value = mfe.getAttribute(x);\n            if (attribs[x] === 'boolean') {\n                const lcValue = value.toLowerCase();\n                if (\n                    lcValue === 'true' ||\n                    lcValue === 'yes' ||\n                    lcValue === 'on'\n                ) {\n                    result[toCamelCase(x)] = true;\n                } else {\n                    result[toCamelCase(x)] = false;\n                }\n            } else if (attribs[x] === 'number') {\n                result[toCamelCase(x)] = parseFloat(value);\n            } else {\n                result[toCamelCase(x)] = value;\n            }\n        }\n    });\n    return result;\n}\n\nexport default MathfieldElement;\n\ndeclare global {\n    /** @internal */\n    interface Window {\n        MathfieldElement: typeof MathfieldElement;\n    }\n}\n\nif (!window.customElements.get('math-field')) {\n    window.MathfieldElement = MathfieldElement;\n    window.customElements.define('math-field', MathfieldElement);\n}\n","import type { Mathfield } from './public/mathfield';\r\nimport type { MathfieldOptions, TextToSpeechOptions } from './public/options';\r\nimport type {\r\n    ErrorListener,\r\n    ParserErrorCode,\r\n    MathfieldErrorCode,\r\n} from './public/core';\r\n\r\nimport { Atom } from './core/atom-class';\r\nimport { parseString } from './core/parser';\r\nimport { coalesce, makeSpan, makeStruts } from './core/span';\r\nimport { MACROS, MacroDictionary } from './core-definitions/definitions';\r\nimport { MathfieldPrivate } from './editor-mathfield/mathfield-private';\r\nimport AutoRender from './addons/auto-render';\r\nimport {\r\n    MathJsonLatexOptions,\r\n    MathJson,\r\n    atomtoMathJson,\r\n    jsonToLatex,\r\n} from './addons/math-json';\r\nimport MathLiveDebug from './addons/debug';\r\nimport { MATHSTYLES } from './core/mathstyle';\r\nimport { defaultSpeakHook } from './editor/speech';\r\nimport {\r\n    defaultReadAloudHook,\r\n    readAloudStatus,\r\n    pauseReadAloud,\r\n    resumeReadAloud,\r\n    playReadAloud,\r\n} from './editor/speech-read-aloud';\r\nimport { atomToSpeakableText } from './editor/atom-to-speakable-text';\r\nimport { atomsToMathML } from './addons/math-ml';\r\n\r\nimport './addons/definitions-metadata';\r\nimport { AutoRenderOptionsPrivate } from './addons/auto-render';\r\n\r\nexport { MathfieldElement } from './public/mathfield-element';\r\n\r\nexport function makeMathField(\r\n    element: HTMLElement,\r\n    options: Partial<MathfieldOptions> = {}\r\n): Mathfield {\r\n    options.speakHook = options.speakHook ?? defaultSpeakHook;\r\n    options.readAloudHook = options.readAloudHook ?? defaultReadAloudHook;\r\n    return new MathfieldPrivate(getElement(element), options);\r\n}\r\n\r\n/** @deprecated */\r\nfunction latexToMarkup(\r\n    text: string,\r\n    options?: {\r\n        mathstyle?: 'displaystyle' | 'textstyle';\r\n        letterShapeStyle?: 'tex' | 'french' | 'iso' | 'upright' | 'auto';\r\n        macros?: MacroDictionary;\r\n        onError?: ErrorListener<ParserErrorCode>;\r\n        format?: string;\r\n    }\r\n): string {\r\n    return convertLatexToMarkup(text, options);\r\n}\r\n\r\nexport function convertLatexToMarkup(\r\n    text: string,\r\n    options?: {\r\n        mathstyle?: 'displaystyle' | 'textstyle';\r\n        letterShapeStyle?: 'tex' | 'french' | 'iso' | 'upright' | 'auto';\r\n        macros?: MacroDictionary;\r\n        onError?: ErrorListener<ParserErrorCode>;\r\n        format?: string;\r\n    }\r\n): string {\r\n    options = options ?? {};\r\n    options.mathstyle = options.mathstyle || 'displaystyle';\r\n    options.letterShapeStyle = options.letterShapeStyle || 'auto';\r\n    options.macros = { ...MACROS, ...(options.macros ?? {}) };\r\n\r\n    //\r\n    // 1. Parse the formula and return a tree of atoms, e.g. 'genfrac'.\r\n    //\r\n\r\n    const atoms = parseString(\r\n        text,\r\n        'math',\r\n        null,\r\n        options.macros,\r\n        false,\r\n        options.onError\r\n    );\r\n\r\n    //\r\n    // 2. Transform the math atoms into elementary spans\r\n    //    for example from genfrac to vlist.\r\n    //\r\n    let spans = Atom.render(\r\n        {\r\n            mathstyle: MATHSTYLES[options.mathstyle],\r\n            letterShapeStyle: options.letterShapeStyle,\r\n        },\r\n        atoms\r\n    );\r\n\r\n    //\r\n    // 3. Simplify by coalescing adjacent nodes\r\n    //    for example, from <span>1</span><span>2</span>\r\n    //    to <span>12</span>\r\n    //\r\n    spans = coalesce(spans);\r\n\r\n    //\r\n    // 4. Wrap the expression with struts\r\n    //\r\n    const wrapper = makeStruts(makeSpan(spans, 'ML__base'), 'ML__mathlive');\r\n\r\n    //\r\n    // 5. Generate markup\r\n    //\r\n\r\n    return wrapper.toMarkup({ hscale: 1.0 });\r\n}\r\n\r\nexport function convertLatexToMathMl(\r\n    latex: string,\r\n    options: Partial<{\r\n        macros: MacroDictionary;\r\n        onError: ErrorListener<ParserErrorCode>;\r\n        generateID: boolean;\r\n    }> = {}\r\n): string {\r\n    options.macros = { ...MACROS, ...(options.macros ?? {}) };\r\n\r\n    return atomsToMathML(\r\n        parseString(latex, 'math', [], options.macros, false, options.onError),\r\n        options\r\n    );\r\n}\r\n\r\n/** @deprecated */\r\nfunction latexToMathML(\r\n    latex: string,\r\n    options?: Partial<{\r\n        macros: MacroDictionary;\r\n        onError: ErrorListener<ParserErrorCode>;\r\n        generateID: boolean;\r\n    }>\r\n): string {\r\n    return convertLatexToMathMl(latex, options);\r\n}\r\n\r\n/** @deprecated Use MathJSON */\r\nfunction latexToAST(\r\n    latex: string,\r\n    options?: MathJsonLatexOptions & {\r\n        macros?: MacroDictionary;\r\n        onError?: ErrorListener<ParserErrorCode | string>;\r\n    }\r\n): MathJson {\r\n    options = options ?? {};\r\n    options.macros = { ...MACROS, ...(options.macros ?? {}) };\r\n\r\n    // return parseLatex(latex, options);\r\n\r\n    return atomtoMathJson(\r\n        parseString(\r\n            latex,\r\n            'math',\r\n            null,\r\n            options.macros,\r\n            false,\r\n            options.onError\r\n        ),\r\n        options\r\n    );\r\n}\r\n\r\n/** @deprecated Use MathJSON */\r\nexport function astToLatex(\r\n    expr: MathJson,\r\n    options: MathJsonLatexOptions\r\n): string {\r\n    return jsonToLatex(\r\n        typeof expr === 'string' ? JSON.parse(expr) : expr,\r\n        options\r\n    );\r\n    // return emitLatex(expr, options);\r\n}\r\n\r\nexport function convertLatexToSpeakableText(\r\n    latex: string,\r\n    options: Partial<\r\n        TextToSpeechOptions & {\r\n            macros?: MacroDictionary;\r\n            onError?: ErrorListener<ParserErrorCode | MathfieldErrorCode>;\r\n        }\r\n    > = {}\r\n): string {\r\n    options.macros = options.macros ?? {};\r\n    Object.assign(options.macros, MACROS);\r\n\r\n    const mathlist = parseString(\r\n        latex,\r\n        'math',\r\n        null,\r\n        options.macros,\r\n        false,\r\n        options.onError\r\n    );\r\n\r\n    return atomToSpeakableText(\r\n        mathlist,\r\n        options as Required<TextToSpeechOptions>\r\n    );\r\n}\r\n/** @deprecated */\r\nfunction latexToSpeakableText(\r\n    latex: string,\r\n    options?: Partial<\r\n        TextToSpeechOptions & {\r\n            macros?: MacroDictionary;\r\n            onError?: ErrorListener<ParserErrorCode | MathfieldErrorCode>;\r\n        }\r\n    >\r\n): string {\r\n    return convertLatexToSpeakableText(latex, options);\r\n}\r\n\r\nexport function renderMathInDocument(options: AutoRenderOptionsPrivate): void {\r\n    renderMathInElement(document.body, options);\r\n}\r\n\r\nfunction getElement(element: string | HTMLElement): HTMLElement {\r\n    if (typeof element === 'string') {\r\n        const result: HTMLElement = document.getElementById(element);\r\n        if (result === null) {\r\n            throw Error(`The element with ID \"${element}\" could not be found.`);\r\n        }\r\n        return result;\r\n    }\r\n    return element;\r\n}\r\n\r\nexport function renderMathInElement(\r\n    element: HTMLElement,\r\n    options: AutoRenderOptionsPrivate\r\n): void {\r\n    options = options ?? {};\r\n    options.renderToMarkup = options.renderToMarkup ?? convertLatexToMarkup;\r\n    options.renderToMathML = options.renderToMathML ?? convertLatexToMathMl;\r\n    options.renderToSpeakableText =\r\n        options.renderToSpeakableText ?? convertLatexToSpeakableText;\r\n    options.macros = options.macros ?? MACROS;\r\n    AutoRender.renderMathInElement(getElement(element), options);\r\n}\r\n\r\nfunction validateNamespace(options): void {\r\n    if (typeof options.namespace === 'string') {\r\n        if (!/^[a-z]+[-]?$/.test(options.namespace)) {\r\n            throw Error(\r\n                'options.namespace must be a string of lowercase characters only'\r\n            );\r\n        }\r\n        if (!/-$/.test(options.namespace)) {\r\n            options.namespace += '-';\r\n        }\r\n    }\r\n}\r\n\r\n/** @deprecated */\r\nfunction revertToOriginalContent(\r\n    element: string | HTMLElement,\r\n    options: AutoRenderOptionsPrivate\r\n): void {\r\n    deprecated('revertToOriginalContent');\r\n    //  if (element instanceof MathfieldPrivate) {\r\n    //      element.$revertToOriginalContent();\r\n    //    } else {\r\n    // element is a pair: accessible span, math -- set it to the math part\r\n    element = getElement(element).children[1] as HTMLElement;\r\n    options = options ?? {};\r\n    validateNamespace(options);\r\n    const html = element.getAttribute(\r\n        'data-' + (options.namespace ?? '') + 'original-content'\r\n    );\r\n    element.innerHTML =\r\n        typeof options.createHTML === 'function'\r\n            ? options.createHTML(html)\r\n            : html;\r\n    //  }\r\n}\r\n\r\n/** @deprecated */\r\nfunction getOriginalContent(\r\n    element: string | HTMLElement,\r\n    options: AutoRenderOptionsPrivate\r\n): string {\r\n    deprecated('getOriginalContent');\r\n    if (element instanceof MathfieldPrivate) {\r\n        return element.originalContent;\r\n    }\r\n    // element is a pair: accessible span, math -- set it to the math part\r\n    element = getElement(element).children[1] as HTMLElement;\r\n    options = options ?? {};\r\n    validateNamespace(options);\r\n    return element.getAttribute(\r\n        'data-' + (options.namespace ?? '') + 'original-content'\r\n    );\r\n}\r\n\r\n// This SDK_VERSION variable will be replaced during the build process.\r\nconst version = '{{SDK_VERSION}}';\r\n\r\nfunction deprecated(method: string) {\r\n    console.warn(`Function \"${method}\" is deprecated`);\r\n}\r\nexport const debug = {\r\n    getStyle: MathLiveDebug.getStyle,\r\n    getType: MathLiveDebug.getType,\r\n    spanToString: MathLiveDebug.spanToString,\r\n    hasClass: MathLiveDebug.hasClass,\r\n    latexToAsciiMath: MathLiveDebug.latexToAsciiMath,\r\n    asciiMathToLatex: MathLiveDebug.asciiMathToLatex,\r\n    FUNCTIONS: MathLiveDebug.FUNCTIONS,\r\n    MATH_SYMBOLS: MathLiveDebug.MATH_SYMBOLS,\r\n    TEXT_SYMBOLS: MathLiveDebug.TEXT_SYMBOLS,\r\n    ENVIRONMENTS: MathLiveDebug.ENVIRONMENTS,\r\n    MACROS: MathLiveDebug.MACROS,\r\n    DEFAULT_KEYBINDINGS: MathLiveDebug.DEFAULT_KEYBINDINGS,\r\n    getKeybindingMarkup: MathLiveDebug.getKeybindingMarkup,\r\n};\r\n\r\nexport default {\r\n    version: (): string => {\r\n        deprecated('export default version');\r\n        return version;\r\n    },\r\n    latexToMarkup: (\r\n        text: string,\r\n        options?: {\r\n            mathstyle?: 'displaystyle' | 'textstyle';\r\n            letterShapeStyle?: 'tex' | 'french' | 'iso' | 'upright' | 'auto';\r\n            macros?: MacroDictionary;\r\n            onError?: ErrorListener<ParserErrorCode>;\r\n            format?: string;\r\n        }\r\n    ): string => {\r\n        deprecated('export default latexToMarkup');\r\n        return latexToMarkup(text, options);\r\n    },\r\n    latexToMathML: (\r\n        latex: string,\r\n        options?: Partial<{\r\n            macros: MacroDictionary;\r\n            onError: ErrorListener<ParserErrorCode>;\r\n            generateID: boolean;\r\n        }>\r\n    ): string => {\r\n        deprecated('export default latexToMathML');\r\n        return latexToMathML(latex, options);\r\n    },\r\n    latexToSpeakableText: (\r\n        latex: string,\r\n        options: Partial<\r\n            TextToSpeechOptions & {\r\n                macros?: MacroDictionary;\r\n                onError?: ErrorListener<ParserErrorCode | MathfieldErrorCode>;\r\n            }\r\n        >\r\n    ): string => {\r\n        deprecated('export default latexToSpeakableText');\r\n        return latexToSpeakableText(latex, options);\r\n    },\r\n    latexToAST: (\r\n        latex: string,\r\n        options?: MathJsonLatexOptions & {\r\n            macros?: MacroDictionary;\r\n            onError?: ErrorListener<ParserErrorCode | string>;\r\n        }\r\n    ): string => {\r\n        deprecated('export default latexToAST: use MathJSON');\r\n        return latexToAST(latex, options);\r\n    },\r\n    astToLatex: (expr: MathJson, options: MathJsonLatexOptions): string => {\r\n        deprecated('export default astToLatex: use MathJSON');\r\n        return astToLatex(expr, options);\r\n    },\r\n    makeMathField: (\r\n        element: HTMLElement,\r\n        options: Partial<MathfieldOptions>\r\n    ): Mathfield => {\r\n        deprecated('export default makeMathField');\r\n        return makeMathField(element, options);\r\n    },\r\n    renderMathInDocument: (options?: AutoRenderOptionsPrivate): void => {\r\n        deprecated('export default renderMathInDocument');\r\n        renderMathInDocument(options);\r\n    },\r\n    renderMathInElement: (\r\n        el: HTMLElement,\r\n        options: AutoRenderOptionsPrivate\r\n    ): void => {\r\n        deprecated('export default renderMathInElement');\r\n        renderMathInElement(el, options);\r\n    },\r\n    revertToOriginalContent: (\r\n        el: string | HTMLElement,\r\n        options: AutoRenderOptionsPrivate\r\n    ): void => {\r\n        deprecated('export default revertToOriginalContent');\r\n        revertToOriginalContent(el, options);\r\n    },\r\n    getOriginalContent: (\r\n        el: string | HTMLElement,\r\n        options: AutoRenderOptionsPrivate\r\n    ): void => {\r\n        deprecated('export default getOriginalContent');\r\n        getOriginalContent(el, options);\r\n    },\r\n\r\n    readAloud: (\r\n        element: HTMLElement,\r\n        text: string,\r\n        config: Partial<MathfieldOptions>\r\n    ): void => {\r\n        deprecated('export default readAloud');\r\n        return defaultReadAloudHook(element, text, config);\r\n    },\r\n    readAloudStatus: (): string => {\r\n        deprecated('export default readAloudStatus');\r\n        return readAloudStatus();\r\n    },\r\n    pauseReadAloud: (): void => {\r\n        deprecated('export default pauseReadAloud');\r\n        pauseReadAloud();\r\n    },\r\n    resumeReadAloud: (): void => {\r\n        deprecated('export default resumeReadAloud');\r\n        resumeReadAloud();\r\n    },\r\n    playReadAloud: (token: string, count: number): void => {\r\n        deprecated('export default playReadAloud');\r\n        playReadAloud(token, count);\r\n    },\r\n};\r\n"],"names":["applyStyleForMode","spanHeight","spanDepth","FONTMETRICS","spanItalic","skew","spanSkew","height","depth","makeID","toString","SPECIAL_OPERATORS","applyStyle","parse","platform","register","registerCommand","isNumber","applyStyleToModel","latexToMarkup","l10n","injectStylesheet","virtualKeyboardStylesheet","coreStylesheet","updateOptions","getDefaultOptions","mathfieldStylesheet","popoverStylesheet","keystrokeCaptionStylesheet","getOptions","scanText","renderMathInElement","deprecated"],"mappings":"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E,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,MAAM,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC;QAC7B,MAAM,EAAE,CAAC,MAAM,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC;QAC7B,MAAM,EAAE,CAAC,MAAM,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC;QAC7B,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,MAAM,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC;QAC7B,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,CAAC,KAAK,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC;QAC7B,MAAM,EAAE,CAAC,CAAC,KAAK,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC;QAC7B,MAAM,EAAE,CAAC,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,MAAM,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC;QAC7B,MAAM,EAAE,CAAC,MAAM,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC;QAC7B,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,MAAM,EAAE,CAAC,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,MAAM,EAAE,CAAC,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,MAAM,EAAE,CAAC,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,MAAM,EAAE,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,MAAM,EAAE,CAAC,MAAM,EAAE,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,MAAM,EAAE,CAAC,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,OAAO,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC3B,OAAO,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC3B,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;KACpC;IACD,qBAAqB,EAAE;QACnB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,OAAO,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC;QACpC,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC;QACpC,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC;QACpC,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC;QACpC,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC;QACpC,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,MAAM,EAAE,OAAO,CAAC;QACzC,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC;QACpC,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC;QAC1C,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC;QACpC,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,OAAO,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,OAAO,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC;QACpC,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC;QACpC,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC;QACpC,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,OAAO,CAAC;QACpC,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,OAAO,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,OAAO,CAAC;QAClC,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC;QACpC,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC;QACpC,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC;QACpC,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC;QAC1C,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC;KACvC;IACD,iBAAiB,EAAE;QACf,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,OAAO,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC3B,OAAO,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC3B,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC3B,OAAO,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC3B,OAAO,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;KAC9B;IACD,WAAW,EAAE;QACT,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,OAAO,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QAC3B,IAAI,EAAE,CAAC,OAAO,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QAC3B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QACrB,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,IAAI,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACjC,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,IAAI,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC5B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,OAAO,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QAC7B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACtC,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACjC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QACvB,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CA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AE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACrC,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,CAAC,CAAC;QAC7B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,CAAC,CAAC;QAC7B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,MAAM,EAAE,CAAC,CAAC;QAC9B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;KACnC;IACD,aAAa,EAAE;QACX,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACpC,IAAI,EAAE,CAAC,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC;QACjC,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC;QAC3B,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACpC,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACpC,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACpC,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC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,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACrC,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,MAAM,EAAE,CAAC,CAAC;QAC9B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACrC,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,IAAI,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAClC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACrC,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,OAAO,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,OAAO,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,MAAM,EAAE,CAAC,CAAC;QAC9B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,MAAM,EAAE,CAAC,CAAC;QAC/B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;KAC7B;IACD,cAAc,EAAE;QACZ,IAAI,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QAClB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,OAAO,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QAC3B,IAAI,EAAE,CAAC,OAAO,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QAC3B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QACrB,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,MAAM,EAAE,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC;QAC5B,IAAI,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,IAAI,EAAE,CAAC,MAAM,EAAE,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC;QAC5B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,CAAC,CAAC;QAC5B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,IAAI,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACjC,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,IAAI,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC5B,KAAK,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QACnB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAA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AAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,MAAM,EAAE,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,MAAM,EAAE,CAAC,MAAM,EAAE,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,MAAM,EAAE,CAAC,MAAM,EAAE,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,MAAM,EAAE,CAAC,MAAM,EAAE,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,MAAM,EAAE,CAAC,MAAM,EAAE,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,MAAM,EAAE,CAAC,MAAM,EAAE,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,E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AAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACrC,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,MAAM,EAAE,CAAC,CAAC;QACpC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,MAAM,EAAE,CAAC,CAAC;QAC9B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACrC,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACrC,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAA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,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,OAAO,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,OAAO,CAAC;QACrC,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC;QAC3C,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,OAAO,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,OAAO,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,OAAO,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,OAAO,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC;QAC3C,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,OAAO,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,OAAO,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE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E,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,OAAO,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QAC3B,IAAI,EAAE,CAAC,OAAO,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QAC3B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QACrB,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,MAAM,EAAE,CAAC,CAAC;QAC7B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,IAAI,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACjC,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,IAAI,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC5B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,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O,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAClC,IAAI,EAAE,CAAC,CAAC,IAAI,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAA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AC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,KAAK,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC5B,IAAI,EAAE,CAAC,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,KAAK,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC5B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,CAAC,CAAC;QAC5B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,IAAI,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACjC,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACrC,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,IAAI,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC5B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QAChC,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO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EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,IAAI,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,IAAI,EAAE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACxB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QACnB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,KAAK,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QACzB,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;QAC1B,MAAM,EAAE,CAAC,CAAC,EAAE,OA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,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN,CAAC,EAAE,GAAG;IACN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,CAAC;YAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;YAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;YAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;YAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;YAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;YAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;YAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;YAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;YAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;YAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;YAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;YAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;YAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;YAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;YAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;YAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;YAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;YAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;YAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;YAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG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AAE,GAAG,EAAE,GAAG,CAAC;gBAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAC1B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAC5B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAC5B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAC5B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAC5B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAC5B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAC5B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAC5B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAC5B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAC5B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAA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G,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC5B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC5B,MAAM,EAAE,CAAC,GAA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AE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC5B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC5B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC5B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAA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EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE,CAAC;QACzB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,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,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,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AC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC5B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC5B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAA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EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QAC1B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE,CAAC;QAC3B,MAAM,EAAE,CAAC,GAAG,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AE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE,CAAC;QACzB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE,CAAC;QACzB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QACxB,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QAC1B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE,CAAC;QAC3B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE,CAAC;QAC3B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QAC1B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC;QAC1B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAA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AG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC1B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC5B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC5B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC5B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC5B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC5B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC5B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,CAAC;QAC7B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC5B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC5B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC5B,KAAK,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC3B,KAAK,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC3B,KAAK,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC3B,WAAW,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QACjC,YAAY,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAClC,SAAS,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC/B,SAAS,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC/B,KAAK,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC3B,SAAS,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC/B,KAAK,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC3B,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC5B,KAAK,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC3B,YAAY,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAClC,cAAc,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QACpC,cAAc,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QACpC,SAAS,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QAC/B,aAAa,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QACnC,aAAa,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QACnC,WAAW,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;KACpC;CACJ,CAAC;;ACxnCK,MAAM,mBAAmB,GAAiB;IAC7C,EAAE,GAAG,EAAE,YAAY,EAAE,OAAO,EAAE,CAAC,QAAQ,EAAE,mBAAmB,CAAC,EAAE;IAC/D,EAAE,GAAG,EAAE,WAAW,EAAE,OAAO,EAAE,CAAC,QAAQ,EAAE,mBAAmB,CAAC,EAAE;IAC9D,EAAE,GAAG,EAAE,YAAY,EAAE,OAAO,EAAE,CAAC,QAAQ,EAAE,oBAAoB,CAAC,EAAE;IAChE,EAAE,GAAG,EAAE,YAAY,EAAE,OAAO,EAAE,CAAC,QAAQ,EAAE,oBAAoB,CAAC,EAAE;IAChE;QACI,GAAG,EAAE,kBAAkB;QACvB,OAAO,EAAE,CAAC,QAAQ,EAAE,0BAA0B,CAAC;KAClD;;IAGD,EAAE,GAAG,EAAE,MAAM,EAAE,OAAO,EAAE,oBAAoB,EAAE;IAC9C,EAAE,GAAG,EAAE,OAAO,EAAE,OAAO,EAAE,gBAAgB,EAAE;IAC3C,EAAE,GAAG,EAAE,IAAI,EAAE,OAAO,EAAE,QAAQ,EAAE;IAChC,EAAE,GAAG,EAAE,MAAM,EAAE,OAAO,EAAE,UAAU,EAAE;IAEpC,EAAE,GAAG,EAAE,mBAAmB,EAAE,OAAO,EAAE,yBAAyB,EAAE;IAChE,EAAE,GAAG,EAAE,oBAAoB,EAAE,OAAO,EAAE,wBAAwB,EAAE;IAChE,EAAE,GAAG,EAAE,iBAAiB,EAAE,OAAO,EAAE,uBAAuB,EAAE;IAC5D,EAAE,GAAG,EAAE,mBAAmB,EAAE,OAAO,EAAE,yBAAyB,EAAE;IAEhE,EAAE,GAAG,EAAE,aAAa,EAAE,OAAO,EAAE,gBAAgB,EAAE;IACjD,EAAE,GAAG,EAAE,cAAc,EAAE,OAAO,EAAE,gBAAgB,EAAE;IAElD,EAAE,GAAG,EAAE,UAAU,EAAE,OAAO,EAAE,eAAe,EAAE;IAC7C,EAAE,GAAG,EAAE,iBAAiB,EAAE,OAAO,EAAE,eAAe,EAAE;IAEpD,EAAE,GAAG,EAAE,iBAAiB,EAAE,OAAO,EAAE,oBAAoB,EAAE;IACzD,EAAE,GAAG,EAAE,kBAAkB,EAAE,OAAO,EAAE,gBAAgB,EAAE;IAEtD,EAAE,GAAG,EAAE,uBAAuB,EAAE,OAAO,EAAE,sBAAsB,EAAE;IACjE,EAAE,GAAG,EAAE,wBAAwB,EAAE,OAAO,EAAE,kBAAkB,EAAE;IAE9D,EAAE,GAAG,EAAE,kBAAkB,EAAE,OAAO,EAAE,kBAAkB,EAAE;IACxD,EAAE,GAAG,EAAE,mBAAmB,EAAE,OAAO,EAAE,gBAAgB,EAAE;IAEvD,EAAE,GAAG,EAAE,wBAAwB,EAAE,OAAO,EAAE,oBAAoB,EAAE;IAChE,EAAE,GAAG,EAAE,yBAAyB,EAAE,OAAO,EAAE,kBAAkB,EAAE;IAE/D,EAAE,GAAG,EAAE,SAAS,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,iBAAiB,EAAE;IAC9D,EAAE,GAAG,EAAE,eAAe,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,kBAAkB,EAAE;IAErE,EAAE,GAAG,EAAE,QAAQ,EAAE,OAAO,EAAE,sBAAsB,EAAE;IAClD,EAAE,GAAG,EAAE,iBAAiB,EAAE,OAAO,EAAE,sBAAsB,EAAE;IAC3D,EAAE,GAAG,EAAE,cAAc,EAAE,OAAO,EAAE,wBAAwB,EAAE;IAC1D,EAAE,GAAG,EAAE,uBAAuB,EAAE,OAAO,EAAE,wBAAwB,EAAE;IAEnE,EAAE,GAAG,EAAE,OAAO,EAAE,OAAO,EAAE,oBAAoB,EAAE;IAC/C,EAAE,GAAG,EAAE,kBAAkB,EAAE,OAAO,EAAE,oBAAoB,EAAE;IAC1D,EAAE,GAAG,EAAE,aAAa,EAAE,OAAO,EAAE,sBAAsB,EAAE;IACvD,EAAE,GAAG,EAAE,wBAAwB,EAAE,OAAO,EAAE,sBAAsB,EAAE;IAElE,EAAE,GAAG,EAAE,UAAU,EAAE,OAAO,EAAE,kBAAkB,EAAE;IAChD,EAAE,GAAG,EAAE,YAAY,EAAE,OAAO,EAAE,gBAAgB,EAAE;IAEhD,EAAE,GAAG,EAAE,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,uBAAuB,EAAE;IAClE;QACI,GAAG,EAAE,aAAa;QAClB,MAAM,EAAE,MAAM;QACd,OAAO,EAAE,2BAA2B;KACvC;IAED,EAAE,GAAG,EAAE,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,uBAAuB,EAAE;IAClE;QACI,GAAG,EAAE,aAAa;QAClB,MAAM,EAAE,MAAM;QACd,OAAO,EAAE,2BAA2B;KACvC;IAED,EAAE,GAAG,EAAE,UAAU,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,YAAY,EAAE,SAAS,CAAC,EAAE;IACvE,EAAE,GAAG,EAAE,IAAI,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,YAAY,EAAE,SAAS,CAAC,EAAE;IAEjE;QACI,GAAG,EAAE,aAAa;QAClB,MAAM,EAAE,MAAM;QACd,OAAO,EAAE,CAAC,YAAY,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;KAC5C;IACD;QACI,GAAG,EAAE,aAAa;QAClB,MAAM,EAAE,MAAM;QACd,OAAO,EAAE,CAAC,YAAY,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;KAC5C;IAED;QACI,GAAG,EAAE,UAAU;QACf,MAAM,EAAE,SAAS;QACjB,OAAO,EAAE,CAAC,UAAU,EAAE,QAAQ,CAAC;KAClC;IACD;QACI,GAAG,EAAE,OAAO;QACZ,MAAM,EAAE,SAAS;QACjB,OAAO,EAAE,CAAC,UAAU,EAAE,wBAAwB,CAAC;KAClD;IACD,EAAE,GAAG,EAAE,UAAU,EAAE,MAAM,EAAE,SAAS,EAAE,OAAO,EAAE,UAAU,EAAE;IAC3D,EAAE,GAAG,EAAE,SAAS,EAAE,MAAM,EAAE,SAAS,EAAE,OAAO,EAAE,UAAU,EAAE;IAC1D;QACI,GAAG,EAAE,gBAAgB;QACrB,MAAM,EAAE,SAAS;QACjB,OAAO,EAAE,CAAC,UAAU,EAAE,QAAQ,CAAC;KAClC;;IAED,EAAE,GAAG,EAAE,aAAa,EAAE,MAAM,EAAE,SAAS,EAAE,OAAO,EAAE,gBAAgB,EAAE;;IAEpE,EAAE,GAAG,EAAE,WAAW,EAAE,MAAM,EAAE,SAAS,EAAE,OAAO,EAAE,oBAAoB,EAAE;IAEtE,EAAE,GAAG,EAAE,QAAQ,EAAE,UAAU,EAAE,QAAQ,EAAE,OAAO,EAAE,WAAW,EAAE;IAC7D,EAAE,GAAG,EAAE,OAAO,EAAE,OAAO,EAAE,WAAW,EAAE;;IAGtC,EAAE,GAAG,EAAE,OAAO,EAAE,OAAO,EAAE,gBAAgB,EAAE;IAC3C,EAAE,GAAG,EAAE,QAAQ,EAAE,OAAO,EAAE,iBAAiB,EAAE;IAC7C,EAAE,GAAG,EAAE,SAAS,EAAE,OAAO,EAAE,oBAAoB,EAAE;IACjD,EAAE,GAAG,EAAE,SAAS,EAAE,OAAO,EAAE,gBAAgB,EAAE;IAE7C,EAAE,GAAG,EAAE,QAAQ,EAAE,UAAU,EAAE,QAAQ,EAAE,OAAO,EAAE,MAAM,EAAE;IACxD,EAAE,GAAG,EAAE,OAAO,EAAE,OAAO,EAAE,MAAM,EAAE;IACjC,EAAE,GAAG,EAAE,QAAQ,EAAE,OAAO,EAAE,MAAM,EAAE;IAClC,EAAE,GAAG,EAAE,QAAQ,EAAE,UAAU,EAAE,QAAQ,EAAE,OAAO,EAAE,MAAM,EAAE;IACxD,EAAE,GAAG,EAAE,aAAa,EAAE,OAAO,EAAE,MAAM,EAAE;IACvC,EAAE,GAAG,EAAE,cAAc,EAAE,UAAU,EAAE,QAAQ,EAAE,OAAO,EAAE,MAAM,EAAE;IAC9D,EAAE,GAAG,EAAE,aAAa,EAAE,OAAO,EAAE,MAAM,EAAE;IACvC,EAAE,GAAG,EAAE,QAAQ,EAAE,OAAO,EAAE,MAAM,EAAE;IAElC,EAAE,GAAG,EAAE,YAAY,EAAE,OAAO,EAAE,kBAAkB,EAAE;;IAGlD,EAAE,GAAG,EAAE,QAAQ,EAAE,UAAU,EAAE,OAAO,EAAE,OAAO,EAAE,oBAAoB,EAAE;IACrE,EAAE,GAAG,EAAE,QAAQ,EAAE,UAAU,EAAE,OAAO,EAAE,OAAO,EAAE,gBAAgB,EAAE;IACjE,EAAE,GAAG,EAAE,QAAQ,EAAE,UAAU,EAAE,OAAO,EAAE,OAAO,EAAE,QAAQ,EAAE;IACzD,EAAE,GAAG,EAAE,QAAQ,EAAE,UAAU,EAAE,OAAO,EAAE,OAAO,EAAE,UAAU,EAAE;IAC3D,EAAE,GAAG,EAAE,QAAQ,EAAE,UAAU,EAAE,OAAO,EAAE,OAAO,EAAE,sBAAsB,EAAE;IACvE,EAAE,GAAG,EAAE,QAAQ,EAAE,UAAU,EAAE,OAAO,EAAE,OAAO,EAAE,oBAAoB,EAAE;IACrE;QACI,GAAG,EAAE,cAAc;QACnB,UAAU,EAAE,OAAO;QACnB,OAAO,EAAE,yBAAyB;KACrC;IACD;QACI,GAAG,EAAE,cAAc;QACnB,UAAU,EAAE,OAAO;QACnB,OAAO,EAAE,wBAAwB;KACpC;IACD;QACI,GAAG,EAAE,cAAc;QACnB,UAAU,EAAE,OAAO;QACnB,OAAO,EAAE,uBAAuB;KACnC;IACD;QACI,GAAG,EAAE,cAAc;QACnB,UAAU,EAAE,OAAO;QACnB,OAAO,EAAE,yBAAyB;KACrC;IACD;QACI,GAAG,EAAE,cAAc;QACnB,UAAU,EAAE,OAAO;QACnB,OAAO,EAAE,wBAAwB;KACpC;IACD;QACI,GAAG,EAAE,cAAc;QACnB,UAAU,EAAE,OAAO;QACnB,OAAO,EAAE,sBAAsB;KAClC;IACD,EAAE,GAAG,EAAE,YAAY,EAAE,UAAU,EAAE,OAAO,EAAE,OAAO,EAAE,oBAAoB,EAAE;IACzE,EAAE,GAAG,EAAE,YAAY,EAAE,UAAU,EAAE,OAAO,EAAE,OAAO,EAAE,gBAAgB,EAAE;IACrE;QACI,GAAG,EAAE,kBAAkB;QACvB,UAAU,EAAE,OAAO;QACnB,OAAO,EAAE,sBAAsB;KAClC;IACD;QACI,GAAG,EAAE,kBAAkB;QACvB,UAAU,EAAE,OAAO;QACnB,OAAO,EAAE,kBAAkB;KAC9B;IAED,EAAE,GAAG,EAAE,QAAQ,EAAE,UAAU,EAAE,OAAO,EAAE,OAAO,EAAE,gBAAgB,EAAE;IACjE,EAAE,GAAG,EAAE,QAAQ,EAAE,UAAU,EAAE,OAAO,EAAE,OAAO,EAAE,eAAe,EAAE;IAChE,EAAE,GAAG,EAAE,QAAQ,EAAE,UAAU,EAAE,OAAO,EAAE,OAAO,EAAE,gBAAgB,EAAE;;IAGjE;QACI,GAAG,EAAE,eAAe;QACpB,MAAM,EAAE,MAAM;QACd,OAAO,EAAE,CAAC,YAAY,EAAE,MAAM,EAAE,EAAE,EAAE,GAAG,CAAC;KAC3C;IACD;QACI,GAAG,EAAE,eAAe;QACpB,MAAM,EAAE,MAAM;QACd,OAAO,EAAE,CAAC,YAAY,EAAE,MAAM,EAAE,GAAG,EAAE,EAAE,CAAC;KAC3C;;IAGD;QACI,GAAG,EAAE,eAAe;QACpB,MAAM,EAAE,MAAM;QACd,OAAO,EAAE,CAAC,QAAQ,EAAE,gBAAgB,CAAC;KACxC;IACD,EAAE,GAAG,EAAE,eAAe,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,gBAAgB,EAAE;IACnE,EAAE,GAAG,EAAE,eAAe,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,mBAAmB,EAAE;IACtE,EAAE,GAAG,EAAE,cAAc,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,iBAAiB,EAAE;IACnE;QACI,GAAG,EAAE,mBAAmB;QACxB,MAAM,EAAE,MAAM;QACd,OAAO,EAAE,CAAC,QAAQ,EAAE,uCAAuC,CAAC;KAC/D;IACD;QACI,GAAG,EAAE,yBAAyB;QAC9B,MAAM,EAAE,MAAM;QACd,OAAO,EAAE,CAAC,QAAQ,EAAE,uCAAuC,CAAC;KAC/D;IAED,EAAE,GAAG,EAAE,eAAe,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,aAAa,EAAE;IAChE,EAAE,GAAG,EAAE,cAAc,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,aAAa,EAAE;IAC/D,EAAE,GAAG,EAAE,cAAc,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,aAAa,EAAE;IAC/D,EAAE,GAAG,EAAE,aAAa,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,aAAa,EAAE;IAC9D,EAAE,GAAG,EAAE,QAAQ,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,aAAa,EAAE;IACzD,EAAE,GAAG,EAAE,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,aAAa,EAAE;IACxD,EAAE,GAAG,EAAE,cAAc,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,cAAc,EAAE;IAChE,EAAE,GAAG,EAAE,aAAa,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,cAAc,EAAE;IAE/D,EAAE,GAAG,EAAE,cAAc,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,gBAAgB,EAAE;IAClE,EAAE,GAAG,EAAE,aAAa,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,gBAAgB,EAAE;IACjE,EAAE,GAAG,EAAE,oBAAoB,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,gBAAgB,EAAE;IACxE,EAAE,GAAG,EAAE,mBAAmB,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,gBAAgB,EAAE;;;;;;;IASvE,EAAE,GAAG,EAAE,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,QAAQ,EAAE,UAAU,CAAC,EAAE;IACjE,EAAE,GAAG,EAAE,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,QAAQ,EAAE,gBAAgB,CAAC,EAAE;IACvE;QACI,GAAG,EAAE,OAAO;QACZ,MAAM,EAAE,MAAM;QACd,OAAO,EAAE,CAAC,QAAQ,EAAE,uBAAuB,CAAC;KAC/C;;IAED,EAAE,GAAG,EAAE,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,QAAQ,EAAE,WAAW,CAAC,EAAE;IAClE,EAAE,GAAG,EAAE,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,QAAQ,EAAE,WAAW,CAAC,EAAE;IAClE,EAAE,GAAG,EAAE,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,QAAQ,EAAE,gBAAgB,CAAC,EAAE;IACvE;QACI,GAAG,EAAE,OAAO;QACZ,MAAM,EAAE,MAAM;QACd,OAAO,EAAE,CAAC,QAAQ,EAAE,qBAAqB,CAAC;KAC7C;IACD;QACI,GAAG,EAAE,aAAa;QAClB,MAAM,EAAE,MAAM;QACd,OAAO,EAAE,CAAC,QAAQ,EAAE,kBAAkB,CAAC;KAC1C;IACD;QACI,GAAG,EAAE,aAAa;QAClB,MAAM,EAAE,MAAM;QACd,OAAO,EAAE,CAAC,QAAQ,EAAE,eAAe,CAAC;KACvC;IACD;QACI,GAAG,EAAE,aAAa;QAClB,MAAM,EAAE,MAAM;QACd,OAAO,EAAE,CAAC,QAAQ,EAAE,wBAAwB,CAAC;KAChD;IACD,EAAE,GAAG,EAAE,aAAa,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,QAAQ,EAAE,cAAc,CAAC,EAAE;IAC3E,EAAE,GAAG,EAAE,aAAa,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,QAAQ,EAAE,cAAc,CAAC,EAAE;IAC3E,EAAE,GAAG,EAAE,aAAa,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,QAAQ,EAAE,cAAc,CAAC,EAAE;IAC3E,EAAE,GAAG,EAAE,aAAa,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,QAAQ,EAAE,cAAc,CAAC,EAAE;IAC3E,EAAE,GAAG,EAAE,cAAc,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,QAAQ,EAAE,YAAY,CAAC,EAAE;IAC1E,EAAE,GAAG,EAAE,cAAc,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,QAAQ,EAAE,aAAa,CAAC,EAAE;IAC3E;QACI,GAAG,EAAE,oBAAoB;QACzB,MAAM,EAAE,MAAM;QACd,OAAO,EAAE,CAAC,QAAQ,EAAE,WAAW,CAAC;KACnC;IACD,EAAE,GAAG,EAAE,cAAc,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,QAAQ,EAAE,GAAG,CAAC,EAAE;IACjE,EAAE,GAAG,EAAE,cAAc,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,QAAQ,EAAE,GAAG,CAAC,EAAE;IACjE,EAAE,GAAG,EAAE,uBAAuB,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,QAAQ,EAAE,GAAG,CAAC,EAAE;IAC1E;QACI,GAAG,EAAE,iBAAiB;QACtB,MAAM,EAAE,MAAM;QACd,OAAO,EAAE,CAAC,QAAQ,EAAE,iBAAiB,CAAC;KACzC;IACD;QACI,GAAG,EAAE,GAAG;QACR,MAAM,EAAE,MAAM;QACd,OAAO,EAAE,CAAC,QAAQ,EAAE,oBAAoB,CAAC;KAC5C;IACD;QACI,GAAG,EAAE,OAAO;QACZ,MAAM,EAAE,MAAM;QACd,OAAO,EAAE,CAAC,QAAQ,EAAE,SAAS,CAAC;KACjC;IACD;QACI,GAAG,EAAE,gBAAgB;QACrB,MAAM,EAAE,MAAM;QACd,OAAO,EAAE,CAAC,QAAQ,EAAE,oBAAoB,CAAC;KAC5C;IACD;QACI,GAAG,EAAE,oBAAoB;QACzB,MAAM,EAAE,MAAM;QACd,OAAO,EAAE,CAAC,QAAQ,EAAE,gBAAgB,CAAC;KACxC;IACD;QACI,GAAG,EAAE,mBAAmB;QACxB,MAAM,EAAE,MAAM;QACd,OAAO,EAAE,CAAC,QAAQ,EAAE,SAAS,CAAC;KACjC;;IAGD,EAAE,GAAG,EAAE,aAAa,EAAE,OAAO,EAAE,wBAAwB,EAAE;IACzD,EAAE,GAAG,EAAE,aAAa,EAAE,OAAO,EAAE,uBAAuB,EAAE;;;;;;;;;;;;IAaxD;QACI,GAAG,EAAE,oBAAoB;QACzB,OAAO,EAAE,CAAC,OAAO,EAAE,QAAQ,EAAE,EAAE,gBAAgB,EAAE,KAAK,EAAE,CAAC;KAC5D;IACD;QACI,GAAG,EAAE,sBAAsB;QAC3B,OAAO,EAAE,CAAC,OAAO,EAAE,KAAK,EAAE,EAAE,gBAAgB,EAAE,KAAK,EAAE,CAAC;KACzD;CACJ,CAAC;AAEF;;;;;;;;AAQO,MAAM,mBAAmB,GAAG;IAC/B,SAAS,EAAE,OAAO;IAClB,QAAQ,EAAE,CAAC,OAAO,EAAE,eAAe,CAAC;IACpC,MAAM,EAAE,OAAO;IACf,QAAQ,EAAE,aAAa;IACvB,OAAO,EAAE,OAAO;IAChB,OAAO,EAAE,OAAO;IAChB,OAAO,EAAE,OAAO;IAChB,OAAO,EAAE,OAAO;IAChB,UAAU,EAAE,aAAa;IACzB,UAAU,EAAE,aAAa;IACzB,UAAU,EAAE,aAAa;IACzB,UAAU,EAAE,aAAa;IACzB,SAAS,EAAE,cAAc;IACzB,SAAS,EAAE,cAAc;IACzB,OAAO,EAAE,oBAAoB;IAC7B,iBAAiB,EAAE,OAAO;IAC1B,WAAW,EAAE,aAAa;IAC1B,QAAQ,EAAE,OAAO;IACjB,YAAY,EAAE,OAAO;IACrB,cAAc,EAAE,aAAa;IAC7B,KAAK,EAAE,GAAG;CACb;;AC5VD;;;AAGA,SAAS,aAAa,CAAC,CAAS;IAC5B,IAAI,CAAA,SAAS,aAAT,SAAS,uBAAT,SAAS,CAAE,QAAQ,MAAI,SAAS,aAAT,SAAS,uBAAT,SAAS,CAAE,SAAS,CAAA,EAAE;QAC7C,IAAI,IAAwB,CAAC;QAC7B,IAAI,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,EAAE;YACpC,IAAI,GAAG,OAAO,CAAC;SAClB;aAAM,IAAI,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,EAAE;YAC3C,IAAI,GAAG,SAAS,CAAC;SACpB;aAAM,IAAI,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,EAAE;YAC/C,IAAI,GAAG,SAAS,CAAC;SACpB;aAAM,IACH,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC;YACrC,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC;YACnC,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,EACrC;YACE,IAAI,GAAG,KAAK,CAAC;SAChB;aAAM,IAAI,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,EAAE;YAC9C,IAAI,GAAG,UAAU,CAAC;SACrB;QACD,IAAI,CAAC,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC;YAAE,OAAO,IAAI,CAAC;QACxD,IAAI,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC;YAAE,OAAO,IAAI,CAAC;KACrC;IAED,OAAO,KAAK,CAAC;AACjB,CAAC;AAED;;;;;;SAMgB,uBAAuB,CACnC,WAAyB,EACzB,IAAe,EACf,SAAiB;IAEjB,IAAI,WAAW,CAAC,MAAM,KAAK,CAAC;QAAE,OAAO,EAAE,CAAC;;IAGxC,KAAK,IAAI,CAAC,GAAG,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,EAAE;QAC9C,IAAI,WAAW,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,SAAS,EAAE;YAClC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,MAAM,IAAI,WAAW,CAAC,CAAC,CAAC,CAAC,MAAM,KAAK,IAAI,EAAE;gBAC1D,OAAO,WAAW,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC;aACjC;SACJ;KACJ;IACD,OAAO,EAAE,CAAC;AACd,CAAC;AAED,SAAS,eAAe,CAAC,OAAqC;IAC1D,IAAI,MAAM,GAAsB,OAAO,CAAC;IAExC,IAAI,OAAO,CAAC,MAAM,CAAC,EAAE;QACjB,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;YACnB,MAAM,GAAG,MAAM,CAAC,CAAC,CAAC,GAAG,GAAG,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC;SAC7D;aAAM;YACH,MAAM,GAAG,EAAE,CAAC;SACf;KACJ;IAED,OAAO,MAAM,CAAC;AAClB,CAAC;SAEe,wBAAwB,CACpC,WAAyB,EACzB,OAAe;IAEf,IAAI,MAAM,GAAG,EAAE,CAAC;IAEhB,IAAI,OAAO,OAAO,KAAK,QAAQ,EAAE;QAC7B,MAAM,SAAS,GAAG,mBAAmB,CAAC,OAAO,CAAC,CAAC;QAC/C,IAAI,OAAO,CAAC,SAAS,CAAC,EAAE;YACpB,MAAM,GAAG,SAAS,CAAC,KAAK,EAAE,CAAC;SAC9B;aAAM,IAAI,SAAS,EAAE;YAClB,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SAC1B;KACJ;;;IAID,MAAM,iBAAiB,GAAG,eAAe,CAAC,OAAO,CAAC,CAAC;IAEnD,MAAM,KAAK,GAAG,IAAI,MAAM,CACpB,GAAG;QACC,iBAAiB;aACZ,OAAO,CAAC,IAAI,EAAE,MAAM,CAAC;aACrB,OAAO,CAAC,GAAG,EAAE,KAAK,CAAC;aACnB,OAAO,CAAC,GAAG,EAAE,KAAK,CAAC;aACnB,OAAO,CAAC,GAAG,EAAE,KAAK,CAAC;aACnB,OAAO,CAAC,GAAG,EAAE,KAAK,CAAC;QACxB,gBAAgB,CACvB,CAAC;IACF,WAAW,CAAC,OAAO,CAAC,CAAC,UAAU;QAC3B,IAAI,KAAK,CAAC,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,EAAE;YACjD,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;SAC3B;KACJ,CAAC,CAAC;IAEH,OAAO,MAAM,CAAC,GAAG,CAAC,mBAAmB,CAAC,CAAC;AAC3C,CAAC;AAED;;;;SAIgB,mBAAmB,CAAC,SAAiB;;IACjD,MAAM,SAAS,GAAG,aAAa,CAAC,OAAO,CAAC,IAAI,aAAa,CAAC,KAAK,CAAC,CAAC;IACjE,MAAM,QAAQ,GAAG,SAAS,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IACtC,IAAI,MAAM,GAAG,EAAE,CAAC;IAChB,KAAK,MAAM,OAAO,IAAI,QAAQ,EAAE;QAC5B,IAAI,CAAC,SAAS,IAAI,MAAM,EAAE;YACtB,MAAM,IAAI,0CAA0C,CAAC;SACxD;QACD,IAAI,OAAO,CAAC,UAAU,CAAC,KAAK,CAAC,EAAE;YAC3B,MAAM,IAAI,OAAO,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;SAClC;aAAM,IAAI,OAAO,CAAC,UAAU,CAAC,OAAO,CAAC,EAAE;YACpC,MAAM,IAAI,OAAO,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;SAClC;aAAM;YACH,MAAM,UACF;gBACI,GAAG,EAAE,QAAQ;gBACb,IAAI,EAAE,SAAS,GAAG,QAAQ,GAAG,SAAS;gBACtC,KAAK,EAAE,SAAS,GAAG,QAAQ,GAAG,OAAO;gBACrC,GAAG,EAAE,SAAS,GAAG,QAAQ,GAAG,KAAK;gBACjC,IAAI,EAAE,SAAS,GAAG,QAAQ,GAAG,SAAS;gBACtC,IAAI,EAAE,SAAS,GAAG,QAAQ,GAAG,QAAQ;gBACrC,UAAU,EAAE,SAAS,GAAG,QAAQ,GAAG,QAAQ;gBAC3C,SAAS,EAAE,SAAS,GAAG,QAAQ,GAAG,OAAO;gBACzC,OAAO,EAAE,SAAS,GAAG,QAAQ,GAAG,KAAK;;gBAErC,UAAU,EAAE,KAAK;gBAEjB,aAAa,EAAE,SAAS,GAAG,QAAQ,GAAG,WAAW;gBACjD,UAAU,EAAE,SAAS,GAAG,QAAQ,GAAG,KAAK;gBACxC,UAAU,EAAE,SAAS,GAAG,QAAQ,GAAG,SAAS;gBAC5C,YAAY,EAAE,SAAS,GAAG,QAAQ,GAAG,WAAW;gBAChD,QAAQ,EAAE,SAAS,GAAG,QAAQ,GAAG,MAAM;gBACvC,OAAO,EAAE,SAAS,GAAG,QAAQ,GAAG,KAAK;gBACrC,SAAS,EAAE,OAAO;gBAClB,SAAS,EAAE,GAAG;gBACd,SAAS,EAAE,GAAG;gBACd,SAAS,EAAE,GAAG;gBACd,aAAa,EAAE,IAAI;gBACnB,eAAe,EAAE,GAAG;gBACpB,gBAAgB,EAAE,GAAG;gBACrB,SAAS,EAAE,GAAG;gBACd,MAAM,EAAE,GAAG;gBACX,KAAK,EAAE,GAAG;gBACV,KAAK,EAAE,GAAG;gBACV,KAAK,EAAE,GAAG;gBACV,KAAK,EAAE,GAAG;gBACV,WAAW,EAAE,GAAG;gBAChB,YAAY,EAAE,GAAG;gBACjB,SAAS,EAAE,IAAI;gBACf,aAAa,EAAE,IAAI;gBACnB,SAAS,EAAE,GAAG;gBACd,KAAK,EAAE,GAAG;gBACV,cAAc,EAAE,aAAa;gBAC7B,YAAY,EAAE,aAAa;gBAC3B,cAAc,EAAE,aAAa;gBAC7B,SAAS,EAAE,aAAa;gBACxB,aAAa,EAAE,aAAa;gBAC5B,WAAW,EAAE,aAAa;gBAC1B,IAAI,EAAE,MAAM;gBACZ,IAAI,EAAE,QAAQ;gBACd,EAAE,EAAE,QAAQ;gBACZ,KAAK,EAAE,QAAQ;gBACf,IAAI,EAAE,QAAQ;gBACd,aAAa,EAAE,QAAQ;gBACvB,WAAW,EAAE,QAAQ;gBACrB,cAAc,EAAE,QAAQ;gBACxB,aAAa,EAAE,QAAQ;gBACvB,UAAU,EAAE,GAAG;gBACf,UAAU,EAAE,GAAG;gBACf,UAAU,EAAE,GAAG;gBACf,UAAU,EAAE,GAAG;gBACf,UAAU,EAAE,GAAG;gBACf,UAAU,EAAE,GAAG;gBACf,UAAU,EAAE,GAAG;gBACf,UAAU,EAAE,GAAG;gBACf,UAAU,EAAE,GAAG;gBACf,UAAU,EAAE,GAAG;aAClB,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC,mCAAI,OAAO,CAAC,WAAW,EAAE,CAAC;SACzD;KACJ;IACD,OAAO,MAAM,CAAC;AAClB,CAAC;AAED,SAAS,mBAAmB,CAAC,UAAsB;IAC/C,IACI,UAAU,CAAC,UAAU;QACrB,CAAC,gDAAgD,CAAC,IAAI,CAClD,UAAU,CAAC,UAAU,CACxB,EACH;QACE,MAAM,IAAI,KAAK,CACX,wBAAwB,UAAU,CAAC,UAAU,oBAAoB,UAAU,CAAC,GAAG,EAAE,CACpF,CAAC;KACL;IACD,IAAI,QAAQ,GAAG,UAAU,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IACzC,MAAM,GAAG,GAAG,QAAQ,CAAC,GAAG,EAAE,CAAC;IAC3B,IAAI,QAAQ,GAAG,UAAU,CAAC,UAAU,CAAC;IAErC,QAAQ,GAAG,QAAQ,CAAC,GAAG,CAAC,CAAC,OAAO;QAC5B,MAAM,CAAC,GAAG,OAAO,CAAC,WAAW,EAAE,CAAC;QAChC,IAAI,CAAC,KAAK,KAAK,EAAE;YACb,IAAI,QAAQ,IAAI,QAAQ,KAAK,OAAO,IAAI,QAAQ,KAAK,KAAK,EAAE;gBACxD,MAAM,IAAI,KAAK,CACX,2CAA2C,GAAG,QAAQ,GAAG,GAAG,CAC/D,CAAC;aACL;YACD,IAAI,CAAC,QAAQ,EAAE;gBACX,QAAQ,GAAG,aAAa,CAAC,KAAK,CAAC,GAAG,KAAK,GAAG,OAAO,CAAC;aACrD;YAED,OAAO,MAAM,CAAC;SACjB;aAAM,IAAI,CAAC,KAAK,KAAK,EAAE;YACpB,IAAI,QAAQ,IAAI,QAAQ,KAAK,SAAS,EAAE;gBACpC,MAAM,IAAI,KAAK,CACX,2CAA2C,GAAG,QAAQ,GAAG,GAAG,CAC/D,CAAC;aACL;YACD,QAAQ,GAAG,SAAS,CAAC;YACrB,OAAO,MAAM,CAAC;SACjB;QACD,OAAO,CAAC,CAAC;KACZ,CAAC,CAAC;IAEH,IAAI,QAAQ,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC;QAAE,OAAO,SAAS,CAAC;IAE3D,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE;;;QAGzB,MAAM,IAAI,GAAG,aAAa,CAAC,GAAG,CAAC,CAAC;QAChC,IAAI,CAAC,IAAI,EAAE;YACP,MAAM,IAAI,KAAK,CAAC,0BAA0B,GAAG,UAAU,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC;SACtE;QACD,QAAQ,GAAG,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;KAC/C;SAAM;QACH,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;KACtB;IAED,OAAO,EAAE,GAAG,UAAU,EAAE,UAAU,EAAE,QAAQ,EAAE,GAAG,EAAE,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC;AAC5E,CAAC;AAED;;;;;SAKgB,oBAAoB,CAChC,WAAyB,EACzB,OAAyB;IAEzB,MAAM,MAAM,GAAG,EAAE,CAAC;IAClB,MAAM,MAAM,GAAG,EAAE,CAAC;IAClB,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC;QAClB,IAAI;YACA,MAAM,UAAU,GAAG,mBAAmB,CAAC,CAAC,CAAC,CAAC;YAC1C,IAAI,UAAU,EAAE;gBACZ,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;aAC3B;SACJ;QAAC,OAAO,CAAC,EAAE;YACR,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC;SAC1B;KACJ,CAAC,CAAC;IACH,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;QACnB,OAAO,CAAC,MAAM,CAAC,CAAC;KACnB;IACD,OAAO,MAAM,CAAC;AAClB;;SCvRgB,EAAE,CACd,EAAe,EACf,WAAmB,EACnB,QAA4C,EAC5C,OAAiC;IAEjC,MAAM,SAAS,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IACzC,KAAK,MAAM,GAAG,IAAI,SAAS,EAAE;QACzB,MAAM,CAAC,GAAG,GAAG,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC;QACjC,IAAI,CAAC,EAAE;YACH,MAAM,QAAQ,GAAG,OAAO,aAAP,OAAO,cAAP,OAAO,GAAI,EAAE,CAAC;YAC/B,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,QAAQ,EAAE;gBACnB,QAAQ,CAAC,OAAO,GAAG,KAAK,CAAC;aAC5B;iBAAM;gBACH,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC;aACzB;YACD,EAAE,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC;SACjD;aAAM;YACH,EAAE,CAAC,gBAAgB,CAAC,GAAG,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC;SAC/C;KACJ;AACL,CAAC;SAEe,GAAG,CACf,EAAe,EACf,WAAmB,EACnB,QAA4C,EAC5C,OAAiC;IAEjC,MAAM,SAAS,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IACzC,KAAK,MAAM,GAAG,IAAI,SAAS,EAAE;QACzB,MAAM,CAAC,GAAG,GAAG,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC;QACjC,IAAI,CAAC,EAAE;YACH,MAAM,QAAQ,GAAG,OAAO,aAAP,OAAO,cAAP,OAAO,GAAI,EAAE,CAAC;YAC/B,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,QAAQ,EAAE;gBACnB,QAAQ,CAAC,OAAO,GAAG,KAAK,CAAC;aAC5B;iBAAM;gBACH,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC;aACzB;YACD,EAAE,CAAC,mBAAmB,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC;SACpD;aAAM;YACH,EAAE,CAAC,mBAAmB,CAAC,GAAG,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC;SAClD;KACJ;AACL,CAAC;SAEe,gBAAgB,CAAC,EAAU,EAAE,GAAW;IACpD,IAAI,MAAM,GAAG,QAAQ,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC;IACzC,IAAI,MAAM,EAAE;QACR,MAAM,CAAC,YAAY,CACf,eAAe,EACf,MAAM,CACF,QAAQ,CAAC,MAAM,CAAC,YAAY,CAAC,eAAe,CAAC,CAAC,GAAG,CAAC,CACrD,CAAC,QAAQ,EAAE,CACf,CAAC;KACL;SAAM;QACH,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QACvC,MAAM,CAAC,YAAY,CAAC,aAAa,EAAE,MAAM,CAAC,CAAC;QAC3C,MAAM,CAAC,YAAY,CAAC,eAAe,EAAE,GAAG,CAAC,CAAC;QAC1C,MAAM,CAAC,SAAS,GAAG,GAAG,CAAC;QACvB,MAAM,CAAC,EAAE,GAAG,EAAE,CAAC;QACf,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;KACrC;IACD,OAAO,MAAM,CAAC;AAClB,CAAC;AAED;SACgB,oBAAoB,CAAC,EAAe;IAChD,IAAI,CAAC,EAAE;QAAE,OAAO;IAChB,MAAM,QAAQ,GAAG,QAAQ,CAAC,EAAE,CAAC,YAAY,CAAC,eAAe,CAAC,CAAC,CAAC;IAC5D,IAAI,QAAQ,IAAI,CAAC,EAAE;QACf,EAAE,CAAC,MAAM,EAAE,CAAC;KACf;SAAM;QACH,EAAE,CAAC,YAAY,CAAC,eAAe,EAAE,MAAM,CAAC,QAAQ,GAAG,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;KACrE;AACL,CAAC;AAED;;;;;;;SAOgB,gBAAgB,CAAC,EAAoB;IACjD,OAAO,EAAE,CAAC,OAAO,IAAI,EAAE,CAAC,OAAO,CAAC,WAAW,CAAC,KAAK,EAAE,CAAC;AACxD,CAAC;AAED;;;AAGA,SAAS,oBAAoB,CAAC,EAAW;;IACrC,oBACI,EAAE,CAAC,aAAa,CAAC,YAAY,CAAC,mCAC9B,EAAE,CAAC,aAAa,CAAC,iBAAiB,CAAC,mCACnC,EAAE,CAAC,aAAa,CAAC,oBAAoB,CAAC,EACxC;AACN,CAAC;AAED;;;SAGgB,aAAa,CACzB,EAAW;IAEX,MAAM,KAAK,GAAG,oBAAoB,CAAC,EAAE,CAAC,CAAC;IACvC,IAAI,CAAC,KAAK;QAAE,OAAO,IAAI,CAAC;IACxB,MAAM,MAAM,GAAG,KAAK,CAAC,qBAAqB,EAAE,CAAC;IAC7C,OAAO;QACH,CAAC,EAAE,MAAM,CAAC,KAAK;QACf,CAAC,EAAE,MAAM,CAAC,MAAM;QAChB,MAAM,EAAE,MAAM,CAAC,MAAM;KACxB,CAAC;AACN,CAAC;AAED,SAAS,QAAQ,CAAC,IAAU;IACxB,IAAI,MAAM,GAAG,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,EAAE,GAAG,MAAM,CAAC;IACnD,IAAI,OAAO,IAAI,CAAC,UAAU,KAAK,QAAQ,EAAE;QACrC,MAAM,IAAI,GAAG,GAAG,IAAI,CAAC,UAAU,CAAC;KACnC;SAAM;QACH,MAAM,IAAI,IAAI,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,EAAE,CAAC;KAC5D;IACD,OAAO,MAAM,CAAC;AAClB,CAAC;AAED,SAAS,kBAAkB,CACvB,SAA2B,EAC3B,IAAiB;IAEjB,IAAI,CAAC,IAAI;QAAE,OAAO,IAAI,CAAC;IACvB,MAAM,SAAS,GAAG,SAAS,CAAC,KAAK,CAAC,qBAAqB,EAAE,CAAC;IAC1D,MAAM,CAAC,GAAG,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC;IACjC,MAAM,CAAC,GAAG,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC;IACjC,MAAM,IAAI,GAAG,IAAI,CAAC,IAAI,CAClB,IAAI,CAAC,IAAI,GAAG,SAAS,CAAC,IAAI,GAAG,SAAS,CAAC,KAAK,CAAC,UAAU,CAC1D,CAAC;IACF,MAAM,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,SAAS,CAAC,GAAG,CAAC,CAAC;IAChD,OAAO;QACH,IAAI,EAAE,IAAI;QACV,KAAK,EAAE,IAAI,GAAG,CAAC;QACf,GAAG,EAAE,GAAG;QACR,MAAM,EAAE,GAAG,GAAG,CAAC;KAClB,CAAC;AACN,CAAC;AAED,SAAS,aAAa,CAAC,IAAa;IAChC,MAAM,MAAM,GAAG,IAAI,CAAC,qBAAqB,EAAE,CAAC;IAC5C,MAAM,MAAM,GAAS;QACjB,GAAG,EAAE,MAAM,CAAC,GAAG;QACf,MAAM,EAAE,MAAM,CAAC,MAAM;QACrB,IAAI,EAAE,MAAM,CAAC,IAAI;QACjB,KAAK,EAAE,MAAM,CAAC,KAAK;KACtB,CAAC;IACF,IAAI,IAAI,CAAC,OAAO,KAAK,KAAK,EAAE;QACxB,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;YAChC,IAAI,CAAC,CAAC,QAAQ,KAAK,CAAC,EAAE;gBAClB,MAAM,CAAC,GAAS,aAAa,CAAC,CAAC,CAAC,CAAC;gBACjC,MAAM,CAAC,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC;gBAC5C,MAAM,CAAC,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC;gBAC/C,MAAM,CAAC,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,GAAG,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC;gBACzC,MAAM,CAAC,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC;aACrD;SACJ,CAAC,CAAC;KACN;IACD,OAAO,MAAM,CAAC;AAClB,CAAC;SAEe,aAAa,CACzB,SAA2B,EAC3B,IAAU;IAEV,MAAM,IAAI,GAAG,SAAS,CAAC,KAAK,CAAC,aAAa,CAAC,kBAAkB,IAAI,CAAC,EAAE,IAAI,CAAC,CAAC;IAC1E,IAAI,CAAC,IAAI;QAAE,OAAO,IAAI,CAAC;IACvB,OAAO,aAAa,CAAC,IAAI,CAAC,CAAC;AAC/B,CAAC;AAED;;;;SAIgB,cAAc,CAC1B,SAA2B,EAC3B,KAAY;;IAGZ,MAAM,KAAK,GAAG,IAAI,GAAG,EAAgB,CAAC;IAEtC,SAAS,CAAC,KAAK;SACV,QAAQ,CAAC,KAAK,EAAE,EAAE,eAAe,EAAE,IAAI,EAAE,CAAC;SAC1C,OAAO,CAAC,CAAC,CAAO;QACb,MAAM,MAAM,GAAG,kBAAkB,CAC7B,SAAS,EACT,aAAa,CAAC,SAAS,EAAE,CAAC,CAAC,CAC9B,CAAC;QACF,IAAI,MAAM,EAAE;YACR,MAAM,EAAE,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC;YACvB,IAAI,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE;gBACf,MAAM,CAAC,GAAG,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;gBACxB,KAAK,CAAC,GAAG,CAAC,EAAE,EAAE;oBACV,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,MAAM,CAAC,GAAG,CAAC;oBAChC,MAAM,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,MAAM,EAAE,MAAM,CAAC,MAAM,CAAC;oBACzC,IAAI,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,EAAE,MAAM,CAAC,IAAI,CAAC;oBACnC,KAAK,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,KAAK,EAAE,MAAM,CAAC,KAAK,CAAC;iBACzC,CAAC,CAAC;aACN;iBAAM;gBACH,KAAK,CAAC,GAAG,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC;aACzB;SACJ;KACJ,CAAC,CAAC;IAEP,OAAO,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC;AACtC,CAAC;SAEe,kBAAkB,CAAC,SAA2B;IAC1D,OAAO,SAAS,CAAC,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,MAAM,CAC1C,CAAC,GAAG,EAAE,CAAC,KAAK,GAAG,CAAC,MAAM,CAAC,GAAG,cAAc,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC,EACvD,EAAE,CACL,CAAC;AACN;;AClOA;;;;;;;;;;;;;;;;;;;;;;;;;SAyBgB,oBAAoB,CAChC,SAA2B,EAC3B,EAAW,EACX,OAUO;IAEP,IAAI,OAAO,OAAO,KAAK,QAAQ,KAAK,OAAO,CAAC,OAAO,IAAI,OAAO,CAAC,OAAO,CAAC,EAAE;;QAErE,IAAI,OAAO,CAAC,OAAO,EAAE;YACjB,EAAE,CAAC,YAAY,CACX,OAAO,GAAG,SAAS,CAAC,OAAO,CAAC,SAAS,GAAG,SAAS,EACjD,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,OAAO,CAAC,CAClC,CAAC;SACL;QACD,IAAI,OAAO,CAAC,GAAG,EAAE;YACb,EAAE,CAAC,YAAY,CACX,OAAO,GAAG,SAAS,CAAC,OAAO,CAAC,SAAS,GAAG,aAAa,EACrD,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,GAAG,CAAC,CAC9B,CAAC;SACL;QACD,IAAI,OAAO,CAAC,QAAQ,EAAE;YAClB,EAAE,CAAC,YAAY,CACX,OAAO,GAAG,SAAS,CAAC,OAAO,CAAC,SAAS,GAAG,kBAAkB,EAC1D,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,QAAQ,CAAC,CACnC,CAAC;SACL;QACD,IAAI,OAAO,CAAC,KAAK,EAAE;YACf,EAAE,CAAC,YAAY,CACX,OAAO,GAAG,SAAS,CAAC,OAAO,CAAC,SAAS,GAAG,eAAe,EACvD,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,KAAK,CAAC,CAChC,CAAC;SACL;;;;QAID,IAAI,OAAO,CAAC,OAAO,EAAE;YACjB,EAAE,CAAC,YAAY,CACX,OAAO,GAAG,SAAS,CAAC,OAAO,CAAC,SAAS,GAAG,iBAAiB,EACzD,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,OAAO,CAAC,CAClC,CAAC;SACL;QACD,IAAI,OAAO,CAAC,iBAAiB,EAAE;YAC3B,EAAE,CAAC,YAAY,CACX,OAAO;gBACH,SAAS,CAAC,OAAO,CAAC,SAAS;gBAC3B,2BAA2B,EAC/B,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAC5C,CAAC;SACL;QACD,IAAI,OAAO,CAAC,eAAe,EAAE;YACzB,EAAE,CAAC,YAAY,CACX,OAAO;gBACH,SAAS,CAAC,OAAO,CAAC,SAAS;gBAC3B,yBAAyB,EAC7B,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,eAAe,CAAC,CAC1C,CAAC;SACL;KACJ;SAAM;;;;QAIH,EAAE,CAAC,YAAY,CACX,OAAO,GAAG,SAAS,CAAC,OAAO,CAAC,SAAS,GAAG,SAAS,EACjD,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAC1B,CAAC;KACL;IACD,IAAI,cAAc,CAAC;IACnB,IAAI,gBAAgB,CAAC;IACrB,IAAI,OAAO,CAAC;IACZ,IAAI,eAAe,CAAC;IACpB,IAAI,iBAAiB,CAAC;IACtB,EAAE,CACE,EAAE,EACF,8BAA8B,EAC9B,CAAC,EAA0C;QACvC,IAAI,EAAE,CAAC,IAAI,KAAK,WAAW,IAAI,EAAE,CAAC,OAAO,KAAK,CAAC,EAAE;;YAE7C,EAAE,CAAC,eAAe,EAAE,CAAC;;YAErB,IAAI,EAAE,CAAC,IAAI,KAAK,YAAY,EAAE;gBAC1B,EAAE,CAAC,cAAc,EAAE,CAAC;aACvB;YACD,EAAE,CAAC,SAAS,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;YAC5B,cAAc,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;;YAE5B,IAAI,EAAE,CAAC,IAAI,KAAK,YAAY,EAAE;gBAC1B,OAAO,GAAG,EAAE,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC;aAC7C;;;YAGD,MAAM,OAAO,GAAG,EAAE,CAAC,YAAY,CAC3B,OAAO,GAAG,SAAS,CAAC,OAAO,CAAC,SAAS,GAAG,iBAAiB,CAC5D,CAAC;YACF,IAAI,OAAO,EAAE;gBACT,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC;aACjD;;;YAGD,MAAM,wBAAwB,GAAG,EAAE,CAAC,YAAY,CAC5C,OAAO;gBACH,SAAS,CAAC,OAAO,CAAC,SAAS;gBAC3B,2BAA2B,CAClC,CAAC;YACF,IAAI,wBAAwB,EAAE;gBAC1B,gBAAgB,GAAG,EAAE,CAAC;gBACtB,IAAI,iBAAiB,EAAE;oBACnB,YAAY,CAAC,iBAAiB,CAAC,CAAC;iBACnC;gBACD,iBAAiB,GAAG,MAAM,CAAC,UAAU,CAAC;oBAClC,IAAI,EAAE,CAAC,SAAS,CAAC,QAAQ,CAAC,SAAS,CAAC,EAAE;wBAClC,SAAS,CAAC,cAAc,CACpB,IAAI,CAAC,KAAK,CAAC,wBAAwB,CAAC,CACvC,CAAC;qBACL;iBACJ,EAAE,GAAG,CAAC,CAAC;aACX;SACJ;KACJ,CACJ,CAAC;IACF,EAAE,CAAC,EAAE,EAAE,wBAAwB,EAAE;QAC7B,EAAE,CAAC,SAAS,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;;;;;;;KAOlC,CAAC,CAAC;IACH,EAAE,CACE,EAAE,EACF,mBAAmB,EACnB,CAAC,EAA0C;;;;;;QAMvC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,cAAc,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YAC/C,IAAI,EAAE,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,UAAU,KAAK,OAAO,EAAE;;gBAE7C,MAAM,MAAM,GAAG,QAAQ,CAAC,gBAAgB,CACpC,EAAE,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,OAAO,EAC5B,EAAE,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,OAAO,CAC/B,CAAC;gBACF,IAAI,MAAM,KAAK,eAAe,IAAI,eAAe,EAAE;oBAC/C,eAAe,CAAC,aAAa,CACzB,IAAI,UAAU,CAAC,YAAY,CAAC,EAC5B,EAAE,OAAO,EAAE,IAAI,EAAE,CACpB,CAAC;oBACF,eAAe,GAAG,IAAI,CAAC;iBAC1B;gBACD,IAAI,MAAM,EAAE;oBACR,eAAe,GAAG,MAAM,CAAC;oBACzB,MAAM,CAAC,aAAa,CAChB,IAAI,UAAU,CAAC,YAAY,EAAE;wBACzB,OAAO,EAAE,IAAI;wBACb,OAAO,EAAE,CAAC;qBACb,CAAC,CACL,CAAC;iBACL;aACJ;SACJ;KACJ,CACJ,CAAC;IACF,EAAE,CAAC,EAAE,EAAE,YAAY,EAAE,CAAC,EAA0C;QAC5D,IAAI,EAAE,CAAC,OAAO,KAAK,CAAC,EAAE;YAClB,EAAE,CAAC,SAAS,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;SAC/B;KACJ,CAAC,CAAC;IACH,EAAE,CACE,EAAE,EACF,wBAAwB,EACxB,CAAC,EAA0C;QACvC,IAAI,eAAe,EAAE;YACjB,EAAE,CAAC,eAAe,EAAE,CAAC;YACrB,EAAE,CAAC,cAAc,EAAE,CAAC;YACpB,MAAM,MAAM,GAAG,eAAe,CAAC;YAC/B,eAAe,GAAG,IAAI,CAAC;YACvB,MAAM,CAAC,aAAa,CAChB,IAAI,UAAU,CAAC,SAAS,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAC/C,CAAC;YACF,OAAO;SACV;QACD,EAAE,CAAC,SAAS,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;QAC/B,EAAE,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;QAC3B,IAAI,EAAE,CAAC,IAAI,KAAK,OAAO,IAAI,EAAE,CAAC,MAAM,KAAK,CAAC,EAAE;;;;YAIxC,EAAE,CAAC,eAAe,EAAE,CAAC;YACrB,EAAE,CAAC,cAAc,EAAE,CAAC;YACpB,OAAO;SACV;;;QAGD,MAAM,CAAC,UAAU,CAAC;YACd,EAAE,CAAC,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;SACjC,EAAE,GAAG,CAAC,CAAC;QACR,IAAI,OAAO,GAAG,EAAE,CAAC,YAAY,CACzB,OAAO;YACH,SAAS,CAAC,OAAO,CAAC,SAAS;YAC3B,yBAAyB,CAChC,CAAC;QACF,MAAM,GAAG,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;;;;QAIvB,IAAI,EAAE,KAAK,gBAAgB,IAAI,GAAG,GAAG,cAAc,GAAG,GAAG,EAAE;YACvD,OAAO,GAAG,SAAS,CAAC;SACvB;QACD,IAAI,CAAC,OAAO,IAAI,EAAE,CAAC,MAAM,IAAI,EAAE,CAAC,QAAQ,EAAE;YACtC,OAAO,GAAG,EAAE,CAAC,YAAY,CACrB,OAAO,GAAG,SAAS,CAAC,OAAO,CAAC,SAAS,GAAG,kBAAkB,CAC7D,CAAC;SACL;QACD,IAAI,CAAC,OAAO,IAAI,EAAE,CAAC,MAAM,EAAE;YACvB,OAAO,GAAG,EAAE,CAAC,YAAY,CACrB,OAAO,GAAG,SAAS,CAAC,OAAO,CAAC,SAAS,GAAG,aAAa,CACxD,CAAC;SACL;QACD,IAAI,CAAC,OAAO,IAAI,EAAE,CAAC,QAAQ,EAAE;YACzB,OAAO,GAAG,EAAE,CAAC,YAAY,CACrB,OAAO,GAAG,SAAS,CAAC,OAAO,CAAC,SAAS,GAAG,eAAe,CAC1D,CAAC;SACL;QACD,IAAI,CAAC,OAAO,EAAE;YACV,OAAO,GAAG,EAAE,CAAC,YAAY,CACrB,OAAO,GAAG,SAAS,CAAC,OAAO,CAAC,SAAS,GAAG,SAAS,CACpD,CAAC;SACL;QACD,IAAI,OAAO,EAAE;;;YAGT,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC;SACjD;QACD,EAAE,CAAC,eAAe,EAAE,CAAC;QACrB,EAAE,CAAC,cAAc,EAAE,CAAC;KACvB,CACJ,CAAC;AACN;;ACpQA;AACA;AACA;AACA;AACA;AACO,MAAM,KAAK,GAAG;IACjB,QAAQ,EAAE,YAAY;IACtB,UAAU,EAAE,YAAY;IACxB,cAAc,EAAE,YAAY;IAC5B,UAAU,EAAE,aAAa;IACzB,UAAU,EAAE,WAAW;IACvB,UAAU,EAAE,iBAAiB;IAC7B,UAAU,EAAE,iBAAiB;IAC7B,UAAU,EAAE,CAAC,OAAO,EAAE,WAAW,CAAC;IAClC,UAAU,EAAE,MAAM;IAClB,MAAM,EAAE,MAAM;IACd,QAAQ,EAAE,MAAM;IAChB,UAAU,EAAE,QAAQ;IACpB,UAAU,EAAE,YAAY;IACxB,WAAW,EAAE,QAAQ;IACrB,UAAU,EAAE,CAAC,YAAY,EAAE,cAAc,CAAC;IAC1C,UAAU,EAAE,YAAY;IACxB,WAAW,EAAE,aAAa;IAC1B,QAAQ,EAAE,CAAC,SAAS,EAAE,UAAU,CAAC;IACjC,YAAY,EAAE,CAAC,SAAS,EAAE,UAAU,CAAC;IAErC,aAAa,EAAE,YAAY;IAC3B,SAAS,EAAE,OAAO;IAElB,UAAU,EAAE,SAAS;IACrB,UAAU,EAAE,cAAc;IAC1B,WAAW,EAAE,sBAAsB;IACnC,QAAQ,EAAE,UAAU;IACpB,SAAS,EAAE,kBAAkB;IAC7B,SAAS,EAAE,qBAAqB;IAChC,SAAS,EAAE,eAAe;IAC1B,SAAS,EAAE,sBAAsB;IACjC,UAAU,EAAE,8BAA8B;IAC1C,UAAU,EAAE,2BAA2B;IACvC,SAAS,EAAE,sBAAsB;IAEjC,OAAO,EAAE,QAAQ;IACjB,SAAS,EAAE,OAAO;IAClB,SAAS,EAAE,OAAO;IAClB,SAAS,EAAE,OAAO;IAClB,SAAS,EAAE,OAAO;IAClB,OAAO,EAAE,KAAK;IACd,OAAO,EAAE,CAAC,KAAK,EAAE,YAAY,CAAC;IAC9B,QAAQ,EAAE,YAAY;IACtB,OAAO,EAAE,KAAK;IAEd,SAAS,EAAE,OAAO;IAClB,eAAe,EAAE,cAAc;IAC/B,cAAc,EAAE,WAAW;IAC3B,YAAY,EAAE,WAAW;IACzB,YAAY,EAAE,2BAA2B;IACzC,YAAY,EAAE,6BAA6B;IAC3C,UAAU,EAAE,aAAa;IACzB,UAAU,EAAE,WAAW;IACvB,WAAW,EAAE,oBAAoB;IACjC,UAAU,EAAE,OAAO;IACnB,UAAU,EAAE,cAAc;IAC1B,UAAU,EAAE,wBAAwB;IACpC,SAAS,EAAE,mBAAmB;IAC9B,MAAM,EAAE,CAAC,YAAY,EAAE,aAAa,CAAC;IACrC,SAAS,EAAE,UAAU;IACrB,QAAQ,EAAE,aAAa;IACvB,QAAQ,EAAE,aAAa;IACvB,QAAQ,EAAE,SAAS;IACnB,OAAO,EAAE,WAAW;IACpB,SAAS,EAAE,CAAC,cAAc,EAAE,WAAW,EAAE,cAAc,EAAE,gBAAgB,CAAC;IAC1E,OAAO,EAAE,YAAY;IACrB,OAAO,EAAE,mBAAmB;IAC5B,OAAO,EAAE,UAAU;IACnB,QAAQ,EAAE,kBAAkB;IAC5B,QAAQ,EAAE,gBAAgB;IAC1B,SAAS,EAAE,iBAAiB;IAC5B,OAAO,EAAE,gBAAgB;IACzB,MAAM,EAAE,mBAAmB;IAC3B,cAAc,EAAE,MAAM;IACtB,YAAY,EAAE,iBAAiB;IAC/B,YAAY,EAAE,4BAA4B;IAC1C,YAAY,EAAE,4BAA4B;IAC1C,YAAY,EAAE,8BAA8B;IAC5C,WAAW,EAAE,8BAA8B;IAC3C,UAAU,EAAE,CAAC,OAAO,EAAE,iBAAiB,CAAC;IACxC,UAAU,EAAE,gCAAgC;IAC5C,UAAU,EAAE,iBAAiB;IAC7B,SAAS,EAAE,eAAe;IAE1B,KAAK,EAAE,CAAC,qBAAqB,EAAE,SAAS,CAAC;IACzC,KAAK,EAAE,CAAC,OAAO,EAAE,QAAQ,CAAC;IAC1B,KAAK,EAAE,CAAC,YAAY,EAAE,QAAQ,CAAC;IAC/B,KAAK,EAAE,CAAC,cAAc,EAAE,QAAQ,CAAC;IACjC,KAAK,EAAE,CAAC,aAAa,EAAE,QAAQ,CAAC;IAChC,QAAQ,EAAE,CAAC,YAAY,EAAE,SAAS,CAAC;IACnC,SAAS,EAAE,CAAC,YAAY,EAAE,SAAS,CAAC;IACpC,UAAU,EAAE,CAAC,iBAAiB,EAAE,QAAQ,CAAC;IAEzC,MAAM,EAAE,eAAe;IACvB,MAAM,EAAE,eAAe;IACvB,MAAM,EAAE,mBAAmB;IAC3B,MAAM,EAAE,cAAc;IACtB,kBAAkB,EAAE,cAAc;IAClC,kBAAkB,EAAE,wBAAwB;IAC5C,iBAAiB,EAAE,gBAAgB;IACnC,SAAS,EAAE;QACP,OAAO;QACP,mBAAmB;QACnB,2GAA2G;KAC9G;IACD,QAAQ,EAAE;QACN,MAAM;QACN,aAAa;QACb,uGAAuG;KAC1G;IACD,SAAS,EAAE;QACP,OAAO;QACP,gBAAgB;QAChB,0GAA0G;KAC7G;IAED,KAAK,EAAE,WAAW;IAClB,KAAK,EAAE,4BAA4B;IACnC,KAAK,EAAE,qBAAqB;IAC5B,KAAK,EAAE,6BAA6B;IACpC,KAAK,EAAE,4BAA4B;IACnC,KAAK,EAAE,yBAAyB;IAChC,KAAK,EAAE,0BAA0B;IAEjC,cAAc,EAAE,yCAAyC;IACzD,YAAY,EAAE,wCAAwC;IACtD,YAAY,EAAE,uCAAuC;IAErD,KAAK,EAAE,WAAW;IAClB,KAAK,EAAE,WAAW;IAClB,QAAQ,EAAE,cAAc;IACxB,cAAc,EAAE,gBAAgB;IAChC,cAAc,EAAE,iBAAiB;IACjC,SAAS,EAAE,CAAC,OAAO,EAAE,KAAK,EAAE,8BAA8B,CAAC;IAE3D,UAAU,EAAE;QACR,QAAQ;QACR,qBAAqB;QACrB,iHAAiH;KACpH;IACD,eAAe,EAAE;QACb,cAAc;QACd,cAAc;QACd,WAAW;QACX,eAAe;KAClB;IACD,OAAO,EAAE,cAAc;IACvB,SAAS,EAAE,CAAC,WAAW,EAAE,OAAO,CAAC;IACjC,WAAW,EAAE,CAAC,eAAe,EAAE,aAAa,CAAC;IAC7C,SAAS,EAAE,CAAC,eAAe,EAAE,IAAI,CAAC;IAClC,KAAK,EAAE,CAAC,UAAU,EAAE,YAAY,CAAC;IACjC,MAAM,EAAE,gBAAgB;IACxB,MAAM,EAAE,mBAAmB;IAC3B,SAAS,EAAE,wBAAwB;IACnC,SAAS,EAAE,wBAAwB;IACnC,YAAY,EAAE,wBAAwB;IACtC,QAAQ,EAAE,CAAC,gBAAgB,EAAE,4BAA4B,CAAC;IAC1D,OAAO,EAAE,CAAC,gBAAgB,EAAE,eAAe,CAAC;IAC5C,WAAW,EAAE,2BAA2B;IACxC,UAAU,EAAE;QACR,gBAAgB;QAChB,eAAe;QACf,mBAAmB;QACnB,eAAe;KAClB;IACD,SAAS,EAAE,CAAC,YAAY,EAAE,cAAc,CAAC;IACzC,MAAM,EAAE,kBAAkB;IAC1B,MAAM,EAAE,mBAAmB;IAC3B,MAAM,EAAE;QACJ,eAAe;QACf,8HAA8H;KACjI;IACD,MAAM,EAAE;QACJ,gBAAgB;QAChB,0GAA0G;KAC7G;IACD,OAAO,EAAE,CAAC,WAAW,EAAE,mCAAmC,CAAC;IAC3D,OAAO,EAAE,CAAC,eAAe,EAAE,gCAAgC,CAAC;IAC5D,OAAO,EAAE,CAAC,aAAa,EAAE,oBAAoB,CAAC;IAC9C,OAAO,EAAE;QACL,SAAS;QACT,mCAAmC;QACnC,0GAA0G;KAC7G;IAED,kBAAkB,EAAE,SAAS;IAC7B,sBAAsB,EAAE,kBAAkB;IAE1C,QAAQ,EAAE,UAAU;IACpB,UAAU,EAAE,yBAAyB;IACrC,QAAQ,EAAE,WAAW;IACrB,UAAU,EAAE,0BAA0B;IACtC,QAAQ,EAAE,CAAC,qBAAqB,EAAE,mBAAmB,CAAC;IAEtD,UAAU,EAAE;QACR,SAAS;QACT,0BAA0B;QAC1B,8BAA8B;QAC9B,4GAA4G;KAC/G;IACD,SAAS,EAAE;QACP,WAAW;QACX,2BAA2B;QAC3B,qBAAqB;QACrB,8GAA8G;KACjH;IAED,WAAW,EAAE,CAAC,SAAS,EAAE,qBAAqB,CAAC;IAC/C,aAAa,EAAE,CAAC,YAAY,EAAE,qBAAqB,CAAC;IAEpD,QAAQ,EAAE,CAAC,MAAM,EAAE,SAAS,EAAE,WAAW,CAAC;IAC1C,UAAU,EAAE;QACR,qBAAqB;QACrB,8GAA8G;KACjH;IACD,UAAU,EAAE;QACR,qBAAqB;QACrB,8GAA8G;KACjH;IACD,kBAAkB,EAAE;QAChB,qBAAqB;QACrB,8GAA8G;KACjH;IACD,mBAAmB,EAAE;QACjB,qBAAqB;QACrB,8GAA8G;KACjH;IACD,iBAAiB,EAAE,CAAC,iBAAiB,CAAC;IACtC,cAAc,EAAE,KAAK;IACrB,YAAY,EAAE,MAAM;IAEpB,SAAS,EAAE,0BAA0B;IACrC,mBAAmB,EAAE,CAAC,yBAAyB,EAAE,qBAAqB,CAAC;IAEvE,QAAQ,EAAE,CAAC,QAAQ,EAAE,MAAM,EAAE,sBAAsB,CAAC;IAEpD,QAAQ,EAAE,CAAC,eAAe,EAAE,YAAY,CAAC;IACzC,QAAQ,EAAE,CAAC,cAAc,EAAE,YAAY,CAAC;IACxC,YAAY,EAAE,CAAC,WAAW,EAAE,0BAA0B,CAAC;IACvD,OAAO,EAAE,CAAC,UAAU,EAAE,sCAAsC,CAAC;IAC7D,UAAU,EAAE,QAAQ;IAEpB,OAAO,EAAE,OAAO;CACnB,CAAC;AAEF,SAAS,OAAO,CAAC,MAAM;IACnB,IAAI,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC;IACjC,IAAI,OAAO,CAAC,MAAM,CAAC,EAAE;QACjB,MAAM,GAAG,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;KAChC;IAED,OAAO,MAAM,CAAC;AAClB,CAAC;AAED,SAAS,aAAa,CAAC,KAAa,EAAE,EAAoB;IACtD,MAAM,KAAK,GAAG,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;IAClE,MAAM,KAAK,GAAG,IAAI,CAAC,MAAM,CACrB;QACI,SAAS,EAAE,UAAU,CAAC,YAAY;QAClC,MAAM,EAAE,EAAE,CAAC,OAAO,CAAC,MAAM;KAC5B,EACD,KAAK,CACR,CAAC;IAEF,MAAM,OAAO,GAAG,UAAU,CAAC,QAAQ,CAAC,KAAK,EAAE,UAAU,CAAC,EAAE,cAAc,CAAC,CAAC;IAExE,OAAO,OAAO,CAAC,QAAQ,EAAE,CAAC;AAC9B,CAAC;SAEe,oBAAoB,CAChC,EAAoB,EACpB,KAAa,EACb,aAAsB;IAEtB,IAAI,CAAC,KAAK,IAAI,KAAK,CAAC,MAAM,KAAK,CAAC,EAAE;QAC9B,WAAW,CAAC,EAAE,CAAC,CAAC;QAChB,OAAO;KACV;IAED,MAAM,OAAO,GAAG,KAAK,CAAC;IACtB,MAAM,aAAa,GAAG,aAAa,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;IAC/C,MAAM,WAAW,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC;IACrC,MAAM,UAAU,GAAG,wBAAwB,CAAC,EAAE,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC,IAAI,CACrE,MAAM,CACT,CAAC;IAEF,IAAI,QAAQ,GAAG,aAAa;UACtB,iIAAiI;UACjI,EAAE,CAAC;IACT,QAAQ,IAAI,mDAAmD,CAAC;IAChE,QAAQ,IAAI,oCAAoC,GAAG,aAAa,GAAG,QAAQ,CAAC;IAC5E,IAAI,WAAW,EAAE;QACb,QAAQ,IAAI,iCAAiC,GAAG,WAAW,GAAG,QAAQ,CAAC;KAC1E;IACD,IAAI,UAAU,EAAE;QACZ,QAAQ;YACJ,qCAAqC,GAAG,UAAU,GAAG,QAAQ,CAAC;KACrE;IACD,QAAQ,IAAI,SAAS,CAAC;IACtB,QAAQ,IAAI,aAAa;UACnB,6HAA6H;UAC7H,EAAE,CAAC;IACT,WAAW,CAAC,EAAE,EAAE,QAAQ,CAAC,CAAC;IAE1B,IAAI,EAAE,GAAG,EAAE,CAAC,OAAO,CAAC,sBAAsB,CAAC,sBAAsB,CAAC,CAAC;IACnE,IAAI,EAAE,IAAI,EAAE,CAAC,MAAM,GAAG,CAAC,EAAE;QACrB,oBAAoB,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE;YAC5B,OAAO,EAAE,CAAC,UAAU,EAAE,wBAAwB,CAAC;SAClD,CAAC,CAAC;KACN;IAED,EAAE,GAAG,EAAE,CAAC,OAAO,CAAC,sBAAsB,CAAC,4BAA4B,CAAC,CAAC;IACrE,IAAI,EAAE,IAAI,EAAE,CAAC,MAAM,GAAG,CAAC,EAAE;QACrB,oBAAoB,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,oBAAoB,CAAC,CAAC;KACzD;IAED,EAAE,GAAG,EAAE,CAAC,OAAO,CAAC,sBAAsB,CAAC,4BAA4B,CAAC,CAAC;IACrE,IAAI,EAAE,IAAI,EAAE,CAAC,MAAM,GAAG,CAAC,EAAE;QACrB,oBAAoB,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,gBAAgB,CAAC,CAAC;KACrD;AACL,CAAC;SAEe,qBAAqB,CACjC,EAAoB,EACpB,OAA+B;;;;;IAK/B,IAAI,CAAC,EAAE,CAAC,OAAO,IAAI,EAAE,CAAC,OAAO,CAAC,WAAW,CAAC,KAAK,EAAE;QAAE,OAAO;;IAG1D,IAAI,CAAC,EAAE,CAAC,OAAO,CAAC,SAAS,CAAC,QAAQ,CAAC,YAAY,CAAC;QAAE,OAAO;IACzD,IAAI,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,QAAQ,EAAE;;;;QAInB,MAAM,CAAC,UAAU,CAAC,MAAM,qBAAqB,CAAC,EAAE,CAAC,EAAE,GAAG,CAAC,CAAC;QACxD,OAAO;KACV;IACD,IAAI,OAAA,EAAE,CAAC,KAAK,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,0CAAE,IAAI,MAAK,SAAS,EAAE;QACpD,WAAW,CAAC,EAAE,CAAC,CAAC;KACnB;SAAM;;QAEH,MAAM,UAAU,GAAG,aAAa,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;QAC3C,IAAI,UAAU;YAAE,kBAAkB,CAAC,EAAE,EAAE,UAAU,CAAC,CAAC;KACtD;AACL,CAAC;SAEe,WAAW,CAAC,EAAoB,EAAE,MAAc;IAC5D,EAAE,CAAC,OAAO,CAAC,SAAS,GAAG,EAAE,CAAC,OAAO,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;IAErD,MAAM,UAAU,GAAG,aAAa,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;IAC3C,IAAI,UAAU;QAAE,kBAAkB,CAAC,EAAE,EAAE,UAAU,CAAC,CAAC;IAEnD,EAAE,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;AAC3C,CAAC;AAED,SAAS,kBAAkB,CACvB,EAAoB,EACpB,QAAkD;;IAGlD,MAAM,YAAY,GACd,MAAM,CAAC,WAAW;QAClB,QAAQ,CAAC,eAAe,CAAC,YAAY;QACrC,QAAQ,CAAC,IAAI,CAAC,YAAY,CAAC;IAC/B,MAAM,WAAW,GACb,MAAM,CAAC,UAAU;QACjB,QAAQ,CAAC,eAAe,CAAC,WAAW;QACpC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC;;IAG9B,MAAM,cAAc,GAChB,MAAM,CAAC,UAAU,GAAG,QAAQ,CAAC,eAAe,CAAC,WAAW,CAAC;IAC7D,MAAM,eAAe,GACjB,MAAM,CAAC,WAAW,GAAG,QAAQ,CAAC,eAAe,CAAC,YAAY,CAAC;IAC/D,MAAM,qBAAqB,GAAG,EAAE,CAAC,sBAAsB;UACjD,EAAE,CAAC,eAAe,CAAC,YAAY;UAC/B,CAAC,CAAC;;IAER,IACI,QAAQ,CAAC,CAAC,GAAG,EAAE,CAAC,OAAO,CAAC,WAAW,GAAG,CAAC;QACvC,WAAW,GAAG,cAAc,EAC9B;QACE,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI;YACjB,WAAW,GAAG,EAAE,CAAC,OAAO,CAAC,WAAW,GAAG,cAAc,GAAG,IAAI,CAAC;KACpE;SAAM,IAAI,QAAQ,CAAC,CAAC,GAAG,EAAE,CAAC,OAAO,CAAC,WAAW,GAAG,CAAC,GAAG,CAAC,EAAE;QACpD,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,GAAG,GAAG,CAAC;KAC/B;SAAM;QACH,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,GAAG,QAAQ,CAAC,CAAC,GAAG,EAAE,CAAC,OAAO,CAAC,WAAW,GAAG,CAAC,GAAG,IAAI,CAAC;KAC1E;;IAGD,IACI,QAAQ,CAAC,CAAC,GAAG,EAAE,CAAC,OAAO,CAAC,YAAY,GAAG,CAAC;QACxC,YAAY,GAAG,eAAe,GAAG,qBAAqB,EACxD;QACE,EAAE,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,gCAAgC,CAAC,CAAC;QAC3D,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG;YAChB,QAAQ,CAAC,CAAC,GAAG,QAAQ,CAAC,MAAM,GAAG,EAAE,CAAC,OAAO,CAAC,YAAY,GAAG,CAAC,GAAG,IAAI,CAAC;KACzE;SAAM;QACH,EAAE,CAAC,OAAO,CAAC,SAAS,CAAC,MAAM,CAAC,gCAAgC,CAAC,CAAC;QAC9D,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,GAAG,QAAQ,CAAC,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC;KAChD;AACL,CAAC;SAEe,WAAW,CAAC,EAAoB;IAC5C,EAAE,CAAC,OAAO,CAAC,SAAS,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;AAC9C;;MC1aa,WAAY,SAAQ,IAAI;IAGjC,YACI,KAAa,EACb,OAEC;QAED,KAAK,CAAC,SAAS,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,SAAS,EAAE,CAAC,CAAC;QAC7C,IAAI,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,YAAY,EAAE;YACvB,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;SAC5B;KACJ;IACD,IAAI,aAAa;QACb,OAAO,EAAE,CAAC;KACb;IACD,MAAM,CAAC,OAAgB;QACnB,MAAM,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;QAClD,MAAM,CAAC,OAAO,GAAG,EAAE,CAAC;QACpB,IAAI,IAAI,CAAC,YAAY,EAAE;YACnB,MAAM,CAAC,OAAO,GAAG,iBAAiB,CAAC;SACtC;aAAM,IAAI,IAAI,CAAC,OAAO,EAAE;YACrB,MAAM,CAAC,OAAO,GAAG,YAAY,CAAC;SACjC;QACD,IAAI,IAAI,CAAC,KAAK;YAAE,MAAM,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;QAC1C,OAAO,CAAC,MAAM,CAAC,CAAC;KACnB;;;AC5BL;;;;;;SAMgB,eAAe,CAAC,KAAmB;IAC/C,IAAI,KAAK,GAAG,CAAC,CAAC;IACd,IAAI,KAAK,GAAG,KAAK,CAAC;IAClB,OAAO,KAAK,IAAI,KAAK,CAAC,UAAU,IAAI,CAAC,KAAK,EAAE;QACxC,KAAK,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,YAAY,WAAW,CAAC;QAC/C,IAAI,CAAC,KAAK;YAAE,KAAK,EAAE,CAAC;KACvB;IACD,IAAI,CAAC,KAAK;QAAE,OAAO,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;IAE1C,IAAI,GAAG,GAAG,KAAK,CAAC;IAChB,IAAI,IAAI,GAAG,KAAK,CAAC;IACjB,OAAO,GAAG,IAAI,KAAK,CAAC,UAAU,IAAI,CAAC,IAAI,EAAE;QACrC,IAAI,GAAG,EAAE,KAAK,CAAC,EAAE,CAAC,GAAG,CAAC,YAAY,WAAW,CAAC,CAAC;QAC/C,GAAG,EAAE,CAAC;KACT;IACD,OAAO,CAAC,KAAK,GAAG,CAAC,EAAE,GAAG,GAAG,CAAC,CAAC,CAAC;AAChC,CAAC;SAEe,yBAAyB,CAAC,KAAmB;IACzD,IAAI,KAAK,GAAG,CAAC,CAAC;IACd,IAAI,KAAK,GAAG,KAAK,CAAC;IAClB,OAAO,KAAK,IAAI,KAAK,CAAC,UAAU,IAAI,CAAC,KAAK,EAAE;QACxC,MAAM,IAAI,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;QAC7B,KAAK,GAAG,IAAI,YAAY,WAAW,IAAI,IAAI,CAAC,YAAY,CAAC;QACzD,IAAI,CAAC,KAAK;YAAE,KAAK,EAAE,CAAC;KACvB;IACD,IAAI,CAAC,KAAK;QAAE,OAAO,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;IAE1C,IAAI,GAAG,GAAG,KAAK,CAAC;IAChB,IAAI,IAAI,GAAG,KAAK,CAAC;IACjB,OAAO,GAAG,IAAI,KAAK,CAAC,UAAU,IAAI,CAAC,IAAI,EAAE;QACrC,MAAM,IAAI,GAAG,KAAK,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC;QAC3B,IAAI,GAAG,EAAE,IAAI,YAAY,WAAW,IAAI,IAAI,CAAC,YAAY,CAAC,CAAC;QAC3D,GAAG,EAAE,CAAC;KACT;IACD,OAAO,CAAC,KAAK,GAAG,CAAC,EAAE,GAAG,GAAG,CAAC,CAAC,CAAC;AAChC,CAAC;SAEe,eAAe,CAAC,KAAmB;IAC/C,OAAO,KAAK,CAAC,QAAQ,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC,CAAC;AAClD,CAAC;SAEe,gBAAgB,CAC5B,KAAmB,EACnB,OAAqC;;IAErC,MAAM,YAAY,GAAG,eAAe,CAAC,KAAK,CAAC,CAAC;IAC5C,UAAI,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,cAAc,mCAAI,KAAK,EAAE;QAClC,OAAO,YAAY,CAAC,GAAG,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;KACpD;IACD,OAAO,YAAY;SACd,MAAM,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,YAAY,CAAC;SAC9B,GAAG,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC;SACnB,IAAI,CAAC,EAAE,CAAC,CAAC;AAClB;;ACvDA;;;;AAIA,SAAS,IAAI,CAAC,KAAa;IACvB,IAAI,MAAM,GAAG,CAAC,CAAC;IACf,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;QACnC,MAAM,GAAG,MAAM,GAAG,EAAE,GAAG,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;QAC3C,MAAM,GAAG,MAAM,GAAG,CAAC,CAAC;KACvB;IACD,OAAO,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;AAC5B,CAAC;SAEe,aAAa,CAAC,SAA2B;IACrD,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE;QAClB,SAAS,CAAC,KAAK,GAAG,IAAI,CAAC;QACvB,qBAAqB,CAAC;YAClB,IAAI,gBAAgB,CAAC,SAAS,CAAC,IAAI,SAAS,CAAC,KAAK,EAAE;gBAChD,MAAM,CAAC,SAAS,CAAC,CAAC;aACrB;SACJ,CAAC,CAAC;KACN;AACL,CAAC;AAED;;;;;;;;SAQgB,MAAM,CAClB,SAA2B,EAC3B,aAA6C;IAE7C,aAAa,GAAG,aAAa,aAAb,aAAa,cAAb,aAAa,GAAI,EAAE,CAAC;IACpC,SAAS,CAAC,KAAK,GAAG,KAAK,CAAC;IACxB,MAAM,KAAK,GAAG,SAAS,CAAC,KAAK,CAAC;;;;IAK9B,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE;QACrB,MAAM,CAAC,UAAU,CAAC,GAAG,EAAE,CAAC;KAC3B;;;;IAID,KAAK,CAAC,IAAI,CAAC,KAAK,GAAG,SAAS,CAAC;IAC7B,KAAK,CAAC,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;IAC9B,KAAK,CAAC,IAAI,CAAC,aAAa,GAAG,KAAK,CAAC;IACjC,KAAK,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC;QAClB,CAAC,CAAC,KAAK,GAAG,SAAS,CAAC;QACpB,CAAC,CAAC,UAAU,GAAG,KAAK,CAAC;QACrB,CAAC,CAAC,aAAa,GAAG,KAAK,CAAC;KAC3B,CAAC,CAAC;IACH,MAAM,QAAQ,GAAG,SAAS,CAAC,QAAQ,EAAE,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,QAAQ,CAAC;IACrE,IAAI,KAAK,CAAC,oBAAoB,EAAE;QAC5B,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,KAAK,GAAG,QAAQ,GAAG,SAAS,CAAC,IAAI,GAAG,EAAE,CAAC;KACnE;SAAM;QACH,KAAK;aACA,QAAQ,CAAC,KAAK,CAAC,SAAS,EAAE,EAAE,eAAe,EAAE,IAAI,EAAE,CAAC;aACpD,OAAO,CAAC,CAAC,CAAC;YACP,CAAC,CAAC,UAAU,GAAG,IAAI,CAAC;SACvB,CAAC,CAAC;KACV;IAED,IAAI,QAAQ,EAAE;QACV,IAAI,QAAQ,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC;QAC/C,IAAI,IAAI,GAAG,KAAK,CAAC;QACjB,OAAO,QAAQ,IAAI,CAAC,IAAI,EAAE;;;;YAItB,IAAI,QAAQ,CAAC,IAAI,KAAK,MAAM,IAAI,QAAQ,CAAC,IAAI,KAAK,WAAW,EAAE;gBAC3D,QAAQ,CAAC,aAAa,GAAG,IAAI,CAAC;gBAC9B,IAAI,GAAG,IAAI,CAAC;aACf;YACD,QAAQ,GAAG,QAAQ,CAAC,MAAM,CAAC;SAC9B;KACJ;;;;IAID,MAAM,KAAK,GAAG,KAAK,CAAC,IAAI,CAAC,MAAM,CAC3B,IAAI,OAAO,CAAC;QACR,SAAS,EAAE,UAAU,CAAC,YAAY;QAClC,gBAAgB,EAAE,SAAS,CAAC,OAAO,CAAC,gBAAgB;QACpD,eAAe,EAAE;;;YAGb,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,EAAE,EAAE,WAAW,EAAE,KAAK,EAAE,CAAC,CAAC;;;;YAI5D,YAAY,EAAE,aAAa,CAAC,eAAe;SAC9C;QACD,UAAU,EAAE,SAAS,CAAC,OAAO,CAAC,UAAU;QACxC,MAAM,EAAE,SAAS,CAAC,OAAO,CAAC,MAAM;KACnC,CAAC,CACL,CAAC;;;;IAKF,MAAM,IAAI,GAAG,QAAQ,CAAC,KAAK,EAAE,UAAU,CAAC,CAAC;IACzC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC;IACtC,MAAM,OAAO,GAAG,UAAU,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;IACjD,OAAO,CAAC,UAAU,GAAG;;;QAGjB,SAAS,EAAE,IAAI;;;QAGf,aAAa,EAAE,MAAM;KACxB,CAAC;;;;IAKF,MAAM,SAAS,GAAG,SAAS,CAAC,KAAK,CAAC,SAAS,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC;IACpE,IAAI,SAAS,IAAI,CAAC,QAAQ,EAAE;QACxB,SAAS,CAAC,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC;KACnD;SAAM,IAAI,CAAC,SAAS,IAAI,QAAQ,EAAE;QAC/B,SAAS,CAAC,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;KAChD;IACD,SAAS,CAAC,KAAK,CAAC,SAAS,GAAG,SAAS,CAAC,OAAO,CAAC,UAAU,CACpD,OAAO,CAAC,QAAQ,CAAC;QACb,KAAK,EAAE,CAAC;QACR,MAAM,EAAE,SAAS,CAAC,OAAO,CAAC,sBAAsB;KACnD,CAAC,CACL,CAAC;IACF,SAAS,CAAC,YAAY,GAAG,SAAS,CAAC,KAAK,CAAC,aAAa,CAAC,eAAe,CAAC,CAAC;IAExE,SAAS,CAAC,cAAc,CAAC,SAAS,GAAG,SAAS,CAAC,OAAO,CAAC,UAAU,CAC7D,mDAAmD;QAC/C,aAAa,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,OAAO,CAAC;QAC5C,SAAS,CAChB,CAAC;;;;IAKF,IAAI,CAAC,KAAK,CAAC,oBAAoB,EAAE;QAC7B,eAAe,CAAC,SAAS,CAAC,CAAC;;;QAG3B,UAAU,CAAC,MAAM,eAAe,CAAC,SAAS,CAAC,EAAE,EAAE,CAAC,CAAC;KACpD;AACL,CAAC;AAED,SAAS,eAAe,CAAC,SAA2B;IAChD,SAAS,CAAC,KAAK,CAAC,gBAAgB,CAAC,gBAAgB,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;QACzD,CAAC,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;KAClC,CAAC,CAAC;IACH,MAAM,cAAc,GAAW,kBAAkB,CAAC,SAAS,CAAC,CAAC;IAC7D,cAAc,CAAC,OAAO,CAAC,CAAC,CAAC;QACrB,MAAM,gBAAgB,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QACvD,gBAAgB,CAAC,SAAS,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC;QAChD,gBAAgB,CAAC,KAAK,CAAC,QAAQ,GAAG,UAAU,CAAC;QAC7C,gBAAgB,CAAC,KAAK,CAAC,IAAI,GAAG,GAAG,CAAC,CAAC,IAAI,IAAI,CAAC;QAC5C,gBAAgB,CAAC,KAAK,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC;QAC1C,gBAAgB,CAAC,KAAK,CAAC,KAAK,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC;QAClE,gBAAgB,CAAC,KAAK,CAAC,MAAM,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,IAAI,CAAC;QACvE,SAAS,CAAC,KAAK,CAAC,YAAY,CACxB,gBAAgB,EAChB,SAAS,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC,CAChC,CAAC;KACL,CAAC,CAAC;AACP;;ACzKA;AACO,MAAM,wBAAwB,GAAG,CAAC,CAAC;AAsB1C,MAAM,QAAQ,GAA4C,EAAE,CAAC;SAE7CA,UAAQ,CACpB,QAA6D,EAC7D,OAAgC;IAEhC,OAAO,GAAG,OAAO,aAAP,OAAO,cAAP,OAAO,GAAI,EAAE,MAAM,EAAE,WAAW,EAAE,OAAO,EAAE,KAAK,EAAE,CAAC;IAE7D,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,CAAC,QAAQ;QACnC,OAAO,CAAC,MAAM,CACV,CAAC,QAAQ,CAAC,QAAQ,CAAC,EACnB,4BAA4B,EAC5B,QAAQ,CACX,CAAC;QACF,QAAQ,CAAC,QAAQ,CAAC,GAAG,EAAE,GAAG,OAAO,EAAE,EAAE,EAAE,QAAQ,CAAC,QAAQ,CAAC,EAAE,CAAC;KAC/D,CAAC,CAAC;AACP,CAAC;SAEe,OAAO,CACnB,SAA2B,EAC3B,OAAsD;;IAEtD,IAAI,CAAC,OAAO,EAAE;QACV,OAAO,KAAK,CAAC;KAChB;IAED,IAAI,QAAyB,CAAC;IAC9B,IAAI,IAAI,GAAa,EAAE,CAAC;IACxB,IAAI,OAAO,GAAG,KAAK,CAAC;IACpB,IAAI,KAAK,GAAG,KAAK,CAAC;IAElB,IAAI,OAAO,CAAC,OAAO,CAAC,EAAE;QAClB,QAAQ,GAAG,OAAO,CAAC,CAAC,CAAoB,CAAC;QACzC,IAAI,GAAG,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;KAC3B;SAAM;QACH,QAAQ,GAAG,OAAO,CAAC;KACtB;;IAGD,QAAQ,GAAG,QAAQ,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,CAAC,KAClC,CAAC,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,CACF,CAAC;IACrB,IAAI,OAAA,QAAQ,CAAC,QAAQ,CAAC,0CAAE,MAAM,MAAK,OAAO,EAAE;QACxC,IAAI,yBAAyB,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE;YAC1C,IAAI,QAAQ,KAAK,gBAAgB,EAAE;gBAC/B,SAAS,CAAC,oBAAoB,EAAE,CAAC;aACpC;SACJ;QACD,IACI,yBAAyB,CAAC,IAAI,CAAC,QAAQ,CAAC;YACxC,SAAS,CAAC,IAAI,KAAK,SAAS,EAC9B;;YAEE,SAAS,CAAC,YAAY,EAAE,CAAC;YACzB,SAAS,CAAC,QAAQ,EAAE,CAAC;SACxB;QACD,QAAQ,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,SAAS,CAAC,KAAK,EAAE,GAAG,IAAI,CAAC,CAAC;QAChD,IACI,yBAAyB,CAAC,IAAI,CAAC,QAAQ,CAAC;YACxC,SAAS,CAAC,IAAI,KAAK,SAAS,EAC9B;YACE,SAAS,CAAC,QAAQ,EAAE,CAAC;SACxB;QACD,IAAI,WAAW,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,SAAS,CAAC,IAAI,KAAK,SAAS,EAAE;YAC5D,MAAM,OAAO,GAAG,gBAAgB,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;YAClD,MAAM,WAAW,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC;YACrC,IAAI,WAAW,CAAC,MAAM,KAAK,CAAC,EAAE;gBAC1B,WAAW,CAAC,SAAS,CAAC,CAAC;aAC1B;iBAAM;gBACH,oBAAoB,CAChB,SAAS,EACT,WAAW,CAAC,CAAC,CAAC,CAAC,KAAK,EACpB,WAAW,CAAC,MAAM,GAAG,CAAC,CACzB,CAAC;aACL;SACJ;QACD,KAAK,GAAG,IAAI,CAAC;QACb,OAAO,GAAG,IAAI,CAAC;KAClB;SAAM,IAAI,QAAQ,CAAC,QAAQ,CAAC,EAAE;QAC3B,KAAK,GAAG,QAAQ,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,SAAS,EAAE,GAAG,IAAI,CAAC,CAAC;QAClD,OAAO,GAAG,IAAI,CAAC;KAClB;SAAM;QACH,MAAM,KAAK,CAAC,mBAAmB,GAAG,QAAQ,GAAG,GAAG,CAAC,CAAC;KACrD;;;;IAID,IACI,CAAC,SAAS,CAAC,KAAK,CAAC,oBAAoB;QACrC,8EAA8E,CAAC,IAAI,CAC/E,QAAQ,CACX,EACH;QACE,SAAS,CAAC,oBAAoB,EAAE,CAAC;QACjC,SAAS,CAAC,KAAK,GAAG,EAAE,CAAC;KACxB;;IAED,IAAI,KAAK,EAAE;QACP,aAAa,CAAC,SAAS,CAAC,CAAC;KAC5B;IACD,OAAO,OAAO,CAAC;AACnB,CAAC;AAED;;;;;;;SAQgB,mBAAmB,CAC/B,SAA2B,EAC3B,QAAyB;;;IAGzB,SAAS,CAAC,KAAK,EAAE,CAAC;IAClB,IAAI,SAAS,CAAC,OAAO,CAAC,iBAAiB,KAAI,SAAS,aAAT,SAAS,uBAAT,SAAS,CAAE,OAAO,CAAA,EAAE;QAC3D,SAAS,CAAC,OAAO,CAAC,wBAAwB,CAAC,CAAC;KAC/C;;IAED,QAAQ,GAAG,QAAQ,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,CAAC,KAClC,CAAC,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,CACF,CAAC;IACrB,IACI,QAAQ,KAAK,uBAAuB;QACpC,QAAQ,KAAK,2BAA2B;QACxC,QAAQ,KAAK,UAAU,EACzB;QACE,MAAA,SAAS,CAAC,mBAAmB,0CAAE,IAAI,GAAG,KAAK,CAAC,OAAO,CAAC,IAAI,EAAE;KAC7D;SAAM,IACH,QAAQ,KAAK,gBAAgB;QAC7B,QAAQ,KAAK,eAAe;QAC5B,QAAQ,KAAK,oBAAoB;QACjC,QAAQ,KAAK,gBAAgB;QAC7B,QAAQ,KAAK,oBAAoB;QACjC,QAAQ,KAAK,kBAAkB;QAC/B,QAAQ,KAAK,wBAAwB;QACrC,QAAQ,KAAK,sBAAsB,EACrC;QACE,MAAA,SAAS,CAAC,mBAAmB,0CAAE,IAAI,GAAG,KAAK,CAAC,OAAO,CAAC,IAAI,EAAE;KAC7D;SAAM;QACH,MAAA,SAAS,CAAC,aAAa,0CAAE,IAAI,GAAG,KAAK,CAAC,OAAO,CAAC,IAAI,EAAE;KACvD;IACD,OAAO,SAAS,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC;AAC9C,CAAC;AAEDA,UAAQ,CAAC;IACL,mBAAmB,EAAE,CACjB,SAA2B,EAC3B,OAAwB,KACd,mBAAmB,CAAC,SAAS,EAAE,OAAO,CAAC;CACxD,CAAC;;ACzLF;SAsKgB,WAAW,CAAC,KAAmB;IAG3C,gBAAgB,CAAC,KAAK,CAAC,CAAC;IACxB,OAAO,IAAI,CAAC;AAChB,CAAC;SAEe,YAAY,CAAC,KAAmB;IAG5C,gBAAgB,CAAC,KAAK,CAAC,CAAC;IACxB,OAAO,IAAI,CAAC;AAChB,CAAC;SACe,cAAc,CAAC,KAAmB;IAG9C,gBAAgB,CAAC,KAAK,CAAC,CAAC;IACxB,OAAO,IAAI,CAAC;AAChB,CAAC;SAEe,eAAe,CAAC,KAAmB;IAG/C,gBAAgB,CAAC,KAAK,CAAC,CAAC;IACxB,OAAO,IAAI,CAAC;AAChB,CAAC;AAEDC,UAAe,CACX;IACI,WAAW,EAAE,WAAW;IACxB,cAAc,EAAE,cAAc;IAC9B,YAAY,EAAE,YAAY;IAC1B,eAAe,EAAE,eAAe;CACnC,EACD,EAAE,MAAM,EAAE,OAAO,EAAE,QAAQ,EAAE,YAAY,EAAE,CAC9C;;ACnMD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;;;;;;;;;;;;AAeA,SAAS,QAAQ,CACb,KAAmB,EACnB,SAAiC,EACjC,IAAU,EACV,MAAe;;IAEf,MAAM,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;IAC3B,IAAI,IAAI,YAAY,aAAa,EAAE;;;;QAI/B,MAAM,OAAO,GACT,CAAC,CAAC,MAAM,IAAI,SAAS,KAAK,SAAS;aAClC,MAAM,KAAK,MAAM,IAAI,SAAS,KAAK,UAAU,CAAC,CAAC;QACpD,MAAM,GAAG,GAAG,OAAO;cACb,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC;cACxB,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QACrC,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,SAAS,KAAK,GAAG,IAAI,IAAI,CAAC,SAAS,KAAK,GAAG,EAAE;;YAE9D,MAAM,CAAC,cAAc,CACjB,IAAI,IAAI,CAAC,OAAO,EAAE,EAAE,KAAK,EAAE,IAAI,CAAC,SAAS,EAAE,CAAC,EAC5C,IAAI,CACP,CAAC;SACL;aAAM,IACH,OAAO;YACP,IAAI,CAAC,UAAU,KAAK,GAAG;YACvB,IAAI,CAAC,UAAU,KAAK,GAAG,EACzB;;YAEE,MAAM,CAAC,aAAa,CAChB,IAAI,IAAI,CAAC,QAAQ,EAAE,EAAE,KAAK,EAAE,IAAI,CAAC,UAAU,EAAE,CAAC,EAC9C,IAAI,CACP,CAAC;SACL;;QAED,MAAM,CAAC,gBAAgB,CAAC,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,EAAE,IAAI,CAAC,CAAC;QACzD,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;QACzB,KAAK,CAAC,QAAQ,GAAG,GAAG,CAAC;QACrB,OAAO,IAAI,CAAC;KACf;SAAM,IAAI,IAAI,CAAC,IAAI,KAAK,MAAM,EAAE;;;;QAI7B,IACI,CAAC,SAAS,KAAK,SAAS,IAAI,CAAC,MAAM;aAClC,SAAS,KAAK,UAAU,IAAI,MAAM,KAAK,MAAM,CAAC,EACjD;;YAEE,MAAM,GAAG,GAAG,IAAI,CAAC,WAAW,CAAC;YAC7B,MAAM,CAAC,gBAAgB,CAAC,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,EAAE,IAAI,CAAC,CAAC;YACzD,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;YACzB,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;SACxC;aAAM,IAAI,SAAS,KAAK,SAAS,IAAI,MAAM,KAAK,MAAM,EAAE;;YAErD,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;SACzC;aAAM,IAAI,CAAC,MAAM,IAAI,SAAS,KAAK,UAAU,EAAE;;YAE5C,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACnD;aAAM,IAAI,MAAM,KAAK,OAAO,EAAE;YAC3B,IAAI,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,EAAE;gBAC9B,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;aAC9B;YACD,IAAI,SAAS,KAAK,UAAU,EAAE;;gBAE1B,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;aACrD;iBAAM;;gBAEH,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;aACjD;SACJ;QACD,OAAO,IAAI,CAAC;KACf;SAAM,IAAI,IAAI,CAAC,IAAI,KAAK,KAAK,IAAI,IAAI,CAAC,IAAI,KAAK,SAAS,EAAE;;;;QAIvD,MAAM,GAAG,GACL,CAAC,MAAM,IAAI,SAAS,KAAK,UAAU;aAClC,CAAC,MAAM,IAAI,SAAS,KAAK,SAAS,CAAC;cAC9B,IAAI,CAAC,WAAW;cAChB,IAAI,CAAC,SAAS,CAAC;QACzB,MAAM,CAAC,gBAAgB,CAAC,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,EAAE,IAAI,CAAC,CAAC;QACzD,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;QACzB,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;QACrC,OAAO,IAAI,CAAC;KACf;SAAM,IAAI,IAAI,CAAC,IAAI,KAAK,SAAS,IAAI,IAAI,CAAC,IAAI,KAAK,WAAW,EAAE;;;;QAI7D,IAAI,CAAC,MAAM,EAAE;;YAET,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAC3B,SAAS,KAAK,SAAS,GAAG,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,SAAS,CAC7D,CAAC;YACF,OAAO,IAAI,CAAC;SACf;QACD,IACI,CAAC,SAAS,KAAK,SAAS,IAAI,MAAM,KAAK,OAAO;aAC7C,SAAS,KAAK,UAAU,IAAI,MAAM,KAAK,OAAO,CAAC,EAClD;;YAEE,MAAM,GAAG,GAAG,IAAI,CAAC,WAAW,CAAC;YAC7B,MAAM,CAAC,gBAAgB,CAAC,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,EAAE,IAAI,CAAC,CAAC;YAC1D,MAAM,CAAC,gBAAgB,CAAC,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,EAAE,IAAI,CAAC,CAAC;YAC1D,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;YAEzB,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;YACrC,OAAO,IAAI,CAAC;SACf;QAED,IAAI,SAAS,KAAK,UAAU,EAAE;;YAE1B,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;YAClD,OAAO,IAAI,CAAC;SACf;;QAED,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;QACtC,OAAO,IAAI,CAAC;KACf;SAAM,IACH,CAAC,IAAI,YAAY,YAAY,IAAI,IAAI,CAAC,kBAAkB;QACxD,IAAI,CAAC,IAAI,KAAK,SAAS,EACzB;;;;;QAKE,IAAI,CAAC,MAAM,IAAI,SAAS,KAAK,SAAS;YAAE,OAAO,KAAK,CAAC;QACrD,IAAI,CAAC,MAAM,EAAE;YACT,IAAI,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,WAAW,EAAE;gBACpC,IAAI,GAAS,CAAC;gBACd,IAAI,SAAS,KAAK,SAAS,EAAE;;oBAEzB,GAAG,eAAG,IAAI,CAAC,WAAW,0CAAG,CAAC,0CAAK,IAAI,CAAC,SAAS,0CAAG,CAAC,CAAC,CAAC;iBACtD;qBAAM;;oBAEH,GAAG,eACC,IAAI,CAAC,SAAS,0CAAG,CAAC,EAAE,WAAW,yCAC/B,IAAI,CAAC,WAAW,0CAAG,CAAC,EAAE,WAAW,CAAC;iBACzC;gBACD,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;gBACrC,OAAO,IAAI,CAAC;aACf;YAED,OAAO,KAAK,CAAC;SAChB;QACD,IAAI,MAAM,IAAI,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE;YACvC,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC;SAC7B;QAED,IAAI,MAAM,KAAK,aAAa,EAAE;YAC1B,IAAI,SAAS,KAAK,UAAU,EAAE;gBAC1B,MAAM,GAAG,GAAG,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;gBAChD,OAAO,CAAC,MAAM,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC;gBACzB,KAAK,CAAC,QAAQ,GAAG,GAAG,CAAC;aACxB;iBAAM,IAAI,IAAI,CAAC,SAAS,EAAE;gBACvB,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;aACtD;iBAAM;gBACH,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;aACzC;SACJ;aAAM,IAAI,MAAM,KAAK,WAAW,EAAE;YAC/B,IAAI,SAAS,KAAK,UAAU,IAAI,IAAI,CAAC,WAAW,EAAE;;gBAE9C,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAC3B,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,WAAW,CAClC,CAAC;aACL;iBAAM,IAAI,SAAS,KAAK,UAAU,EAAE;;gBAEjC,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;aACxD;iBAAM;;gBAEH,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;aACzC;SACJ;QACD,OAAO,IAAI,CAAC;KACf;IAED,OAAO,KAAK,CAAC;AACjB,CAAC;AAED;;;SAGgB,cAAc,CAAC,KAAmB;IAC9C,IAAI,CAAC,KAAK,CAAC,oBAAoB,EAAE;QAC7B,OAAO,WAAW,CAAC,KAAK,EAAE,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC;KACrD;IAED,IAAI,MAAM,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;IAEtC,IAAI,MAAM,IAAI,QAAQ,CAAC,KAAK,EAAE,UAAU,EAAE,MAAM,CAAC;QAAE,OAAO,IAAI,CAAC;IAE/D,IAAI,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAE,cAAc,EAAE;QACxB,IAAI,QAAQ,CAAC,KAAK,EAAE,UAAU,EAAE,MAAM,CAAC,MAAM,EAAE,MAAM,CAAC,UAAU,CAAC,EAAE;YAC/D,OAAO,IAAI,CAAC;SACf;QACD,MAAM,GAAG,IAAI,CAAC;KACjB;;IAGD,IAAI,CAAC,MAAM,EAAE;QACT,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;QACxB,OAAO,KAAK,CAAC;KAChB;IAED,OAAO,KAAK,CAAC,kBAAkB,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,EAAE;QAChE,MAAM,MAAM,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC;QAClD,MAAM,CAAC,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;QAClC,KAAK,CAAC,QAAQ,CAAC,SAAS,EAAE,IAAI,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC;QAC1C,KAAK,CAAC,QAAQ,GAAG,MAAM,CAAC;KAC3B,CAAC,CAAC;AACP,CAAC;AAED;;;;SAIgB,aAAa,CAAC,KAAmB;IAC7C,IAAI,CAAC,KAAK,CAAC,oBAAoB,EAAE;QAC7B,OAAO,WAAW,CAAC,KAAK,EAAE,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC;KACrD;IAED,IAAI,MAAM,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,YAAY,CAAC;IAEnD,IAAI,MAAM,IAAI,QAAQ,CAAC,KAAK,EAAE,SAAS,EAAE,MAAM,CAAC;QAAE,OAAO,IAAI,CAAC;IAE9D,IAAI,CAAC,MAAM,EAAE;QACT,MAAM,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;QAClC,IACI,MAAM,CAAC,aAAa;YACpB,QAAQ,CAAC,KAAK,EAAE,SAAS,EAAE,MAAM,CAAC,MAAM,EAAE,MAAM,CAAC,UAAU,CAAC,EAC9D;YACE,OAAO,IAAI,CAAC;SACf;QACD,MAAM,GAAG,IAAI,CAAC;KACjB;SAAM,IACH,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,aAAa;QACtC,QAAQ,CAAC,KAAK,EAAE,SAAS,EAAE,MAAM,CAAC,MAAM,EAAE,MAAM,CAAC,UAAU,CAAC,EAC9D;QACE,OAAO,IAAI,CAAC;KACf;IAED,IAAI,KAAK,CAAC,QAAQ,KAAK,KAAK,CAAC,UAAU,IAAI,CAAC,MAAM,EAAE;QAChD,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;QACxB,OAAO,KAAK,CAAC;KAChB;IAED,OAAO,KAAK,CAAC,kBAAkB,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,EAAE;;QAChE,MAAM,CAAC,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;QAClC,IAAI,OAAO,SAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,0CAAE,YAAY,CAAC;QACrD,OAAO,CAAA,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,IAAI,MAAK,SAAS,EAAE;YAChC,OAAO,CAAC,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;YACpC,OAAO,SAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,0CAAE,YAAY,CAAC;SACpD;QACD,KAAK,CAAC,QAAQ,CAAC,SAAS,EAAE,IAAI,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC;KAC7C,CAAC,CAAC;AACP,CAAC;AAED;;;;;;;;SASgB,WAAW,CAAC,KAAmB,EAAE,KAAY;IACzD,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;IACzB,OAAO,IAAI,CAAC;AAChB;;ACnWA;;;;AAIO,MAAM,gBAAgB,GAEzB;;IAEA,IAAI,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,kBAAkB,EAAE;;IAGjD,KAAK,EAAE,SAAS;IAChB,KAAK,EAAE,SAAS;IAChB,KAAK,EAAE,SAAS;IAChB,EAAE,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE;IACnC,KAAK,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE;IACvC,EAAE,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE;IACnC,KAAK,EAAE,SAAS;IAChB,KAAK,EAAE,SAAS;;IAGhB,EAAE,EAAE;QACA,KAAK,EACD,0FAA0F;QAC9F,KAAK,EAAE,cAAc;KACxB;IACD,EAAE,EAAE;QACA,KAAK,EACD,0FAA0F;QAC9F,KAAK,EAAE,cAAc;KACxB;IACD,EAAE,EAAE;QACA,IAAI,EAAE,MAAM;QACZ,KAAK,EACD,0FAA0F;QAC9F,KAAK,EAAE,gBAAgB;KAC1B;IAED,KAAK,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,SAAS,EAAE;IACzC,IAAI,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,SAAS,EAAE;IACxC,GAAG,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,WAAW,EAAE;IAEzC,QAAQ,EAAE,SAAS;;;IAGnB,EAAE,EAAE;QACA,IAAI,EAAE,MAAM;QACZ,KAAK,EACD,4EAA4E;QAChF,KAAK,EAAE,SAAS;KACnB;;IAGD,GAAG,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE;IACrC,GAAG,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,iBAAiB,EAAE;IAC/C,IAAI,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,kBAAkB,EAAE;IACjD,IAAI,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,YAAY,EAAE;;IAE3C,GAAG,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,iBAAiB,EAAE;IAC/C,GAAG,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,iBAAiB,EAAE;;IAG/C,MAAM,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,UAAU,EAAE;IAC3C,MAAM,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,UAAU,EAAE;IAC3C,MAAM,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,UAAU,EAAE;IAC3C,GAAG,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE;IACrC,IAAI,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE;IACvC,GAAG,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE;IACrC,IAAI,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE;IACvC,GAAG,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE;IACrC,IAAI,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE;IACvC,GAAG,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE;IACrC,GAAG,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE;IACrC,GAAG,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE;IAErC,GAAG,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE;IACrC,EAAE,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE;IACnC,GAAG,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE;IACrC,GAAG,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,YAAY,EAAE;;;IAI1C,EAAE,EAAE;QACA,IAAI,EAAE,MAAM;QACZ,KAAK,EACD,0FAA0F;QAC9F,KAAK,EAAE,mBAAmB;KAC7B;IACD,EAAE,EAAE;QACA,IAAI,EAAE,MAAM;QACZ,KAAK,EACD,0FAA0F;QAC9F,KAAK,EAAE,mBAAmB;KAC7B;IACD,EAAE,EAAE;QACA,IAAI,EAAE,MAAM;QACZ,KAAK,EACD,0FAA0F;QAC9F,KAAK,EAAE,mBAAmB;KAC7B;;IAGD,EAAE,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,UAAU,EAAE;IACvC,EAAE,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,UAAU,EAAE;IACvC,KAAK,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,WAAW,EAAE;IAC3C,IAAI,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE;;IAEvC,GAAG,EAAE;QACD,IAAI,EAAE,MAAM;QACZ,KAAK,EAAE,0CAA0C;QACjD,KAAK,EAAE,QAAQ;KAClB;IACD,EAAE,EAAE;QACA,IAAI,EAAE,MAAM;QACZ,KAAK,EAAE,2BAA2B;QAClC,KAAK,EAAE,MAAM;KAChB;IACD,KAAK,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,SAAS,EAAE;;IAGzC,EAAE,EAAE,KAAK;IACT,EAAE,EAAE,KAAK;IACT,EAAE,EAAE,KAAK;IACT,EAAE,EAAE,KAAK;IACT,EAAE,EAAE,KAAK;IACT,EAAE,EAAE,KAAK;;IAGT,EAAE,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,SAAS,EAAE;IACtC,IAAI,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE;;IAGrC,IAAI,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE;IACrC,IAAI,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE;IACrC,IAAI,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE;IACrC,IAAI,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE;IACrC,IAAI,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE;IACrC,IAAI,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,UAAU,EAAE;;IAGzC,GAAG,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,UAAU,EAAE;IACxC,IAAI,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,WAAW,EAAE;IAC1C,GAAG,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE;IACrC,GAAG,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE;IACrC,IAAI,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,WAAW,EAAE;IAC1C,IAAI,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,SAAS,EAAE;;IAGxC,IAAI,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,UAAU,EAAE;IACzC,IAAI,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,UAAU,EAAE;;IAGzC,IAAI,EAAE,QAAQ;IACd,GAAG,EAAE,OAAO;IACZ,OAAO,EAAE,WAAW;IACpB,UAAU,EAAE,cAAc;IAC1B,GAAG,EAAE;QACD,IAAI,EAAE,MAAM;QACZ,KAAK,EACD,0FAA0F;QAC9F,KAAK,EAAE,OAAO;KACjB;IACD,MAAM,EAAE;QACJ,IAAI,EAAE,MAAM;QACZ,KAAK,EACD,0FAA0F;QAC9F,KAAK,EAAE,QAAQ;KAClB;IACD,KAAK,EAAE,SAAS;IAChB,KAAK,EAAE,SAAS;IAChB,IAAI,EAAE,QAAQ;IACd,KAAK,EAAE,SAAS;IAChB,MAAM,EAAE,UAAU;IAClB,MAAM,EAAE,UAAU;IAClB,EAAE,EAAE;QACA,IAAI,EAAE,MAAM;QACZ,KAAK,EACD,0FAA0F;QAC9F,KAAK,EAAE,MAAM;KAChB;IACD,KAAK,EAAE;QACH,IAAI,EAAE,MAAM;QACZ,KAAK,EACD,0FAA0F;QAC9F,KAAK,EAAE,OAAO;KACjB;IACD,EAAE,EAAE;QACA,IAAI,EAAE,MAAM;QACZ,KAAK,EACD,0FAA0F;QAC9F,KAAK,EAAE,MAAM;KAChB;IACD,KAAK,EAAE;QACH,IAAI,EAAE,MAAM;QACZ,KAAK,EACD,0FAA0F;QAC9F,KAAK,EAAE,OAAO;KACjB;IACD,CAAC,EAAE,MAAM;IACT,GAAG,EAAE;QACD,KAAK,EACD,0FAA0F;QAC9F,KAAK,EAAE,OAAO;KACjB;IACD,GAAG,EAAE;QACD,KAAK,EACD,0FAA0F;QAC9F,KAAK,EAAE,OAAO;KACjB;IACD,MAAM,EAAE,UAAU;IAClB,GAAG,EAAE;QACD,KAAK,EACD,0FAA0F;QAC9F,KAAK,EAAE,OAAO;KACjB;IACD,GAAG,EAAE;QACD,KAAK,EACD,0FAA0F;QAC9F,KAAK,EAAE,OAAO;KACjB;IACD,GAAG,EAAE;QACD,KAAK,EACD,0FAA0F;QAC9F,KAAK,EAAE,OAAO;KACjB;IACD,KAAK,EAAE,SAAS;IAChB,KAAK,EAAE,SAAS;IAChB,GAAG,EAAE;QACD,KAAK,EACD,0FAA0F;QAC9F,KAAK,EAAE,OAAO;KACjB;IACD,QAAQ,EAAE,YAAY;IACtB,OAAO,EAAE,WAAW;IACpB,EAAE,EAAE;QACA,KAAK,EACD,0FAA0F;QAC9F,KAAK,EAAE,MAAM;KAChB;IACD,EAAE,EAAE;QACA,KAAK,EACD,0FAA0F;QAC9F,KAAK,EAAE,MAAM;KAChB;IACD,IAAI,EAAE,QAAQ;IACd,KAAK,EAAE,SAAS;IAChB,KAAK,EAAE,SAAS;IAChB,CAAC,EAAE,SAAS;;IAGZ,MAAM,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,UAAU,EAAE;IAC3C,MAAM,EAAE;QACJ,IAAI,EAAE,MAAM;QACZ,KAAK,EAAE,UAAU;KACpB;IACD,SAAS,EAAE;QACP,IAAI,EAAE,MAAM;QACZ,KAAK,EAAE,WAAW;KACrB;IACD,IAAI,EAAE;QACF,IAAI,EAAE,MAAM;QACZ,KAAK,EAAE,aAAa;KACvB;;;IAID,MAAM,EAAE,+BAA+B;IACvC,MAAM,EAAE,+BAA+B;IACvC,MAAM,EAAE,+BAA+B;IACvC,MAAM,EAAE,+BAA+B;IACvC,GAAG,EAAE,OAAO;IACZ,GAAG,EAAE;QACD,IAAI,EAAE,MAAM;QACZ,KAAK,EAAE,OAAO;KACjB;IACD,GAAG,EAAE;QACD,IAAI,EAAE,MAAM;QACZ,KAAK,EAAE,OAAO;KACjB;IACD,GAAG,EAAE;QACD,IAAI,EAAE,MAAM;QACZ,KAAK,EAAE,OAAO;KACjB;IACD,GAAG,EAAE,qBAAqB;IAC1B,IAAI,EAAE,sBAAsB;IAC5B,MAAM,EAAE;QACJ,IAAI,EAAE,MAAM;QACZ,KAAK,EAAE,wBAAwB;KAClC;IACD,IAAI,EAAE;QACF,IAAI,EAAE,MAAM;QACZ,KAAK,EAAE,sBAAsB;KAChC;IACD,MAAM,EAAE;QACJ,IAAI,EAAE,MAAM;QACZ,KAAK,EAAE,wBAAwB;KAClC;IACD,GAAG,EAAE;QACD,IAAI,EAAE,MAAM;QACZ,KAAK,EAAE,qBAAqB;KAC/B;IACD,GAAG,EAAE;QACD,IAAI,EAAE,MAAM;QACZ,KAAK,EAAE,qBAAqB;KAC/B;IACD,GAAG,EAAE;QACD,IAAI,EAAE,MAAM;QACZ,KAAK,EAAE,qBAAqB;KAC/B;IACD,UAAU,EAAE,4BAA4B;IACxC,aAAa,EAAE,+BAA+B;IAC9C,EAAE,EAAE;QACA,IAAI,EAAE,MAAM;QACZ,KAAK,EAAE,oBAAoB;KAC9B;IACD,EAAE,EAAE;QACA,IAAI,EAAE,MAAM;QACZ,KAAK,EAAE,oBAAoB;KAC9B;;IAGD,EAAE,EAAE;QACA,IAAI,EAAE,MAAM;QACZ,KAAK,EAAE,eAAe;QACtB,KAAK,EAAE,oBAAoB;KAC9B;IACD,EAAE,EAAE;QACA,IAAI,EAAE,MAAM;QACZ,KAAK,EAAE,eAAe;QACtB,KAAK,EAAE,oBAAoB;KAC9B;IACD,EAAE,EAAE;QACA,IAAI,EAAE,MAAM;QACZ,KAAK,EAAE,eAAe;QACtB,KAAK,EAAE,oBAAoB;KAC9B;IACD,EAAE,EAAE;QACA,IAAI,EAAE,MAAM;QACZ,KAAK,EAAE,eAAe;QACtB,KAAK,EAAE,oBAAoB;KAC9B;;IAGD,KAAK,EAAE,SAAS;IAChB,MAAM,EAAE,UAAU;IAClB,MAAM,EAAE,UAAU;IAClB,OAAO,EAAE,aAAa;IAEtB,IAAI,EAAE,MAAM;IACZ,KAAK,EAAE,UAAU;IACjB,KAAK,EAAE,kBAAkB;;IAEzB,KAAK,EAAE,iBAAiB;IACxB,IAAI,EAAE,cAAc;IACpB,KAAK,EAAE,kBAAkB;;IAEzB,KAAK,EAAE,kBAAkB;IACzB,KAAK,EAAE,kBAAkB;IAEzB,KAAK,EAAE,QAAQ;IACf,KAAK,EAAE,SAAS;IAChB,KAAK,EAAE,UAAU;IACjB,KAAK,EAAE,UAAU;IACjB,KAAK,EAAE,UAAU;;IAGjB,IAAI,EAAE,QAAQ;IACd,GAAG,EAAE,KAAK;IACV,GAAG,EAAE,KAAK;IAEV,GAAG,EAAE,QAAQ;CAkFhB;;AC5bD;;;SAGgB,8BAA8B,CAC1C,CAAS,EACT,MAA+B;IAE/B,MAAM,MAAM,GAAG,EAAE,CAAC;IAElB,MAAM,oBAAoB,GAAG,MAAM,CAAC,8BAA8B,CAAC;IAEnE,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;QACpC,MAAM,EAAE,GAAG,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;QAC1B,IAAI,CAAC,oBAAoB,EAAE;YACvB,MAAM,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC,OAAO,CAAC,CAAC,GAAG;gBACtC,IAAI,GAAG,CAAC,UAAU,CAAC,EAAE,CAAC,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;oBAC7C,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;iBACpB;aACJ,CAAC,CAAC;SACN;QAED,MAAM,qBAAqB,GAAG,CAAA,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAE,eAAe,IAC/C,MAAM,CAAC,eAAe;cACtB,IAAI,CAAC;QACX,IAAI,qBAAqB,EAAE;YACvB,MAAM,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC,OAAO,CAAC,CAAC,GAAG;gBAC3C,IAAI,GAAG,CAAC,UAAU,CAAC,EAAE,CAAC,EAAE;oBACpB,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;iBACpB;aACJ,CAAC,CAAC;SACN;KACJ;IACD,OAAO,MAAM,CAAC;AAClB,CAAC;AAED;;;;AAIA,SAAS,gBAAgB,CACrB,QAAgB,EAChB,QAAkC;IAElC,IAAI,CAAC,QAAQ;QAAE,OAAO,EAAE,CAAC;;IAGzB,IAAI,OAAO,QAAQ,KAAK,QAAQ;QAAE,OAAO,QAAQ,CAAC;;IAGlD,IAAI,CAAC,QAAQ;QAAE,OAAO,QAAQ,CAAC,KAAK,CAAC;IAErC,IAAI,OAAO,GAAG,KAAK,CAAC;IACpB,IAAI,MAAM,GAAG,KAAK,CAAC;IACnB,IAAI,KAAK,GAAG,KAAK,CAAC;IAClB,IAAI,UAAU,GAAG,KAAK,CAAC;IACvB,IAAI,IAAI,GAAG,KAAK,CAAC;IACjB,IAAI,IAAI,GAAG,KAAK,CAAC;IACjB,IAAI,KAAK,GAAG,KAAK,CAAC;IAClB,IAAI,KAAK,GAAG,KAAK,CAAC;IAClB,IAAI,KAAK,GAAG,KAAK,CAAC;IAClB,IAAI,KAAK,GAAG,KAAK,CAAC;IAClB,IAAI,SAAS,GAAG,KAAK,CAAC;IACtB,IAAI,UAAU,GAAG,KAAK,CAAC;IACvB,IAAI,IAAI,GAAG,KAAK,CAAC;IACjB,IAAI,KAAK,GAAG,KAAK,CAAC;IAClB,IAAI,OAAO,GAAG,QAAQ,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;IAC5C,IAAI,KAAK,GAAG,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC;IAChC,OAAO,OAAO,IAAI,qBAAqB,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;QACxD,KAAK,IAAI,CAAC,CAAC;QACX,OAAO,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC;KAC7B;IACD,OAAO,GAAG,CAAC,OAAO,IAAI,OAAO,CAAC,IAAI,KAAK,OAAO,CAAC;IAC/C,IAAI,OAAO,EAAE;QACT,IACI,OAAO,QAAQ,CAAC,IAAI,KAAK,WAAW;YACpC,OAAO,CAAC,IAAI,KAAK,QAAQ,CAAC,IAAI,EAChC;YACE,OAAO,EAAE,CAAC;SACb;QACD,IAAI,GAAG,OAAO,CAAC,IAAI,KAAK,MAAM,CAAC;QAC/B,MAAM,GAAG,CAAC,IAAI,IAAI,OAAO,CAAC,IAAI,KAAK,MAAM,IAAI,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;QACxE,KAAK;YACD,CAAC,IAAI,IAAI,OAAO,CAAC,IAAI,KAAK,MAAM,IAAI,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;QACtE,UAAU,GAAG,CAAC,IAAI,IAAI,OAAO,CAAC,UAAU,CAAC;QACzC,IAAI,GAAG,OAAO,CAAC,IAAI,KAAK,SAAS,CAAC;QAClC,IAAI,GAAG,OAAO,CAAC,IAAI,KAAK,MAAM,CAAC;QAC/B,KAAK,GAAG,OAAO,CAAC,IAAI,KAAK,MAAM,CAAC;QAChC,KAAK,GAAG,OAAO,CAAC,IAAI,KAAK,MAAM,CAAC;QAChC,KAAK,GAAG,OAAO,CAAC,IAAI,KAAK,QAAQ,IAAI,OAAO,CAAC,IAAI,KAAK,QAAQ,CAAC;QAC/D,KAAK,GAAG,OAAO,CAAC,IAAI,KAAK,OAAO,CAAC;QACjC,SAAS,GAAG,OAAO,CAAC,IAAI,KAAK,OAAO,CAAC;QACrC,UAAU,GAAG,OAAO,CAAC,IAAI,KAAK,QAAQ,IAAI,OAAO,CAAC,IAAI,KAAK,WAAW,CAAC;QACvE,KAAK,GAAG,OAAO,CAAC,IAAI,KAAK,OAAO,CAAC;KACpC;IAED,IAAI,OAAO,QAAQ,CAAC,KAAK,KAAK,WAAW,EAAE;;QAEvC,IACI,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,OAAO;aACzC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,MAAM,CAAC;aACxC,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,KAAK,CAAC;aACtC,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,UAAU,CAAC;aAC9C,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,IAAI,CAAC;aACpC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,IAAI,CAAC;aACpC,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,KAAK,CAAC;aACtC,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,KAAK,CAAC;aACtC,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,KAAK,CAAC;aACtC,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,KAAK,CAAC;aACtC,WAAW,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,SAAS,CAAC;aAC9C,YAAY,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,UAAU,CAAC;aAChD,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,IAAI,CAAC;aACpC,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,KAAK,CAAC,EACzC;YACE,OAAO,QAAQ,CAAC,KAAK,CAAC;SACzB;QACD,OAAO,EAAE,CAAC;KACb;IAED,OAAO,QAAQ,CAAC,KAAK,CAAC;AAC1B,CAAC;AAED;;;;;;;;SAQgB,iBAAiB,CAC7B,OAAe,EACf,CAAS,EACT,SAAuD;;IAEvD,OAAO,gBAAgB,CAAC,OAAO,QAAE,SAAS,aAAT,SAAS,uBAAT,SAAS,CAAG,CAAC,oCAAK,gBAAgB,CAAC,CAAC,CAAC,CAAC,CAAC;AAC5E;;AC9IA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;SAgCgB,eAAe,CAC3B,CAAS,EACT,OAGC;;IAED,IAAI,CAAC,CAAC;QAAE,OAAO,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC;;IAG7B,IAAI,CAAC,CAAC,MAAM,IAAI,CAAC;QAAE,OAAO,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC;IAEvC,IAAI,CAAC,OAAO,IAAI,OAAO,CAAC,MAAM,KAAK,WAAW,EAAE;;;QAI5C,MAAM,YAAY,GAAG,CAAC,CAAC,IAAI,EAAE,CAAC;QAC9B,IACI,CAAC,YAAY,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,YAAY,CAAC,QAAQ,CAAC,IAAI,CAAC;aAC5D,YAAY,CAAC,UAAU,CAAC,KAAK,CAAC,IAAI,YAAY,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;aAC/D,YAAY,CAAC,UAAU,CAAC,KAAK,CAAC,IAAI,YAAY,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,EAClE;YACE,OAAO;gBACH,OAAO;gBACP,YAAY,CAAC,SAAS,CAAC,CAAC,EAAE,YAAY,CAAC,MAAM,GAAG,CAAC,CAAC;aACrD,CAAC;SACL;QAED,IAAI,YAAY,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;YAC5D,OAAO;gBACH,OAAO;gBACP,YAAY,CAAC,SAAS,CAAC,CAAC,EAAE,YAAY,CAAC,MAAM,GAAG,CAAC,CAAC;aACrD,CAAC;SACL;;QAGD,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,gBAAgB,EAAE,MAAM,CAAC,CAAC;QAExC,IAAI,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE;;;;;;YAMd,OAAO,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC;SACvB;KACJ;IAED,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,UAAU,EAAE,EAAE,CAAC,CAAC;IAC9B,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC;IAC/B,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC;IAE/B,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,cAAc,EAAE,WAAW,CAAC,CAAC;IAC3C,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,cAAc,EAAE,YAAY,CAAC,CAAC;IAC5C,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC;IAE9B,OAAO;cACH,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,MAAM,mCAAI,WAAW;QAC9B,mBAAmB,CAAC,CAAC,EAAE,OAAO,aAAP,OAAO,cAAP,OAAO,GAAI,EAAE,CAAC;KACxC,CAAC;AACN,CAAC;AAED,SAAS,mBAAmB,CACxB,CAAS,EACT,OAGC;;IAED,IAAI,CAAC,CAAC;QAAE,OAAO,EAAE,CAAC;IAClB,IAAI,IAAI,GAAG,KAAK,CAAC;IACjB,IAAI,CAAC,CAAC;IAEN,IAAI,CAAC,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,CAAC,EAAE;;QAEzC,CAAC,GAAG,iBAAiB,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE;YAC/B,eAAe,QAAE,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,eAAe,mCAAI,EAAE;YAC/C,MAAM,EAAE,IAAI;SACf,CAAC,CAAC;QACH,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC,KAAK,GAAG,GAAG,CAAC;QAC/B,CAAC,IAAI,mBAAmB,CAAC,CAAC,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;QAC1C,IAAI,GAAG,IAAI,CAAC;KACf;IAED,IAAI,CAAC,IAAI,EAAE;QACP,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,oBAAoB,CAAC,CAAC;QAClC,IAAI,CAAC,EAAE;;YAEH,CAAC,GAAG,iBAAiB,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;gBACxB,eAAe,QAAE,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,eAAe,mCAAI,EAAE;gBAC/C,MAAM,EAAE,IAAI;aACf,CAAC,CAAC;YACH,MAAM,YAAY,SAAG,CAAC,CAAC,KAAK,mCAAI,iBAAiB,CAAC;YAClD,CAAC,GAAG,SAAS,GAAG,YAAY,GAAG,GAAG,CAAC;YACnC,CAAC,IAAI,mBAAmB,CAAC,CAAC,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;YAC1C,IAAI,GAAG,IAAI,CAAC;SACf;KACJ;IAED,IAAI,CAAC,IAAI,EAAE;QACP,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,sBAAsB,CAAC,CAAC;QACpC,IAAI,CAAC,EAAE;;YAEH,CAAC,GAAG,iBAAiB,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;gBACxB,eAAe,QAAE,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,eAAe,mCAAI,EAAE;gBAC/C,MAAM,EAAE,IAAI;aACf,CAAC,CAAC;YACH,MAAM,YAAY,SAAG,CAAC,CAAC,KAAK,mCAAI,iBAAiB,CAAC;YAClD,CAAC,GAAG,YAAY,GAAG,YAAY,GAAG,GAAG,CAAC;YACtC,CAAC,IAAI,mBAAmB,CAAC,CAAC,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;YAC1C,IAAI,GAAG,IAAI,CAAC;SACf;KACJ;IAED,IAAI,CAAC,IAAI,EAAE;QACP,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;QACxB,IAAI,CAAC,EAAE;;YAEH,CAAC,GAAG,iBAAiB,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;gBACxB,eAAe,QAAE,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,eAAe,mCAAI,EAAE;gBAC/C,MAAM,EAAE,IAAI;aACf,CAAC,CAAC;YACH,CAAC,GAAG,SAAS,GAAG,CAAC,CAAC,KAAK,GAAG,UAAU,CAAC;YACrC,CAAC,IAAI,mBAAmB,CAAC,CAAC,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;YAC1C,IAAI,GAAG,IAAI,CAAC;SACf;KACJ;IAED,IAAI,CAAC,IAAI,EAAE;QACP,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,sBAAsB,CAAC,CAAC;QACpC,IAAI,CAAC,EAAE;;YAEH,CAAC,GAAG,SAAS,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC;YAC3B,CAAC,IAAI,mBAAmB,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC;YACxC,IAAI,GAAG,IAAI,CAAC;SACf;KACJ;IAED,IAAI,CAAC,IAAI,EAAE;QACP,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,6BAA6B,CAAC,CAAC;;;QAG3C,IAAI,CAAC,EAAE;YACH,CAAC,GAAG,cAAc,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC;YAClC,CAAC,IAAI,mBAAmB,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC;YACxC,IAAI,GAAG,IAAI,CAAC;SACf;KACJ;IAED,IAAI,CAAC,IAAI,IAAI,mBAAmB,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE;;QAEtC,CAAC,GAAG,iBAAiB,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE;YAClC,eAAe,QAAE,OAAO,CAAC,eAAe,mCAAI,EAAE;YAC9C,MAAM,EAAE,IAAI;SACf,CAAC,CAAC;QACH,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,EAAE;YACd,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,UAAU,GAAG,CAAC,CAAC,KAAK,GAAG,WAAW,CAAC;SACjD;aAAM;YACH,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC;SACtB;QACD,CAAC,IAAI,mBAAmB,CAAC,CAAC,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;QAC1C,IAAI,GAAG,IAAI,CAAC;KACf;IAED,IAAI,CAAC,IAAI,EAAE;QACP,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,kBAAkB,CAAC,CAAC;QAChC,IAAI,CAAC,EAAE;;;YAGH,CAAC,GAAG,cAAc,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC;YAClC,CAAC,IAAI,mBAAmB,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC;YACxC,IAAI,GAAG,IAAI,CAAC;SACf;KACJ;IAED,IAAI,CAAC,IAAI,EAAE;QACP,CAAC,GAAG,iBAAiB,CAAC,CAAC,EAAE;YACrB,eAAe,QAAE,OAAO,CAAC,eAAe,mCAAI,EAAE;YAC9C,MAAM,EAAE,IAAI;SACf,CAAC,CAAC;QACH,IAAI,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,GAAG,EAAE;;YAE9B,MAAM,EAAE,GAAG,iBAAiB,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE;gBAC3C,eAAe,QAAE,OAAO,CAAC,eAAe,mCAAI,EAAE;gBAC9C,MAAM,EAAE,IAAI;aACf,CAAC,CAAC;YACH,IAAI,EAAE,CAAC,KAAK,EAAE;gBACV,CAAC;oBACG,SAAS;wBACT,CAAC,CAAC,KAAK;wBACP,IAAI;wBACJ,EAAE,CAAC,KAAK;wBACR,GAAG;wBACH,mBAAmB,CAAC,EAAE,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;aAC7C;YACD,IAAI,GAAG,IAAI,CAAC;SACf;aAAM,IAAI,CAAC,CAAC,KAAK,EAAE;YAChB,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,EAAE;gBACd,CAAC;oBACG,SAAS;wBACT,CAAC,CAAC,KAAK;wBACP,UAAU;wBACV,mBAAmB,CAAC,CAAC,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;aAC5C;iBAAM;gBACH,CAAC,GAAG,CAAC,CAAC,KAAK,GAAG,mBAAmB,CAAC,CAAC,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;aACtD;YACD,IAAI,GAAG,IAAI,CAAC;SACf;KACJ;IAED,IAAI,CAAC,IAAI,EAAE;QACP,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC;;QAE3B,IAAI,CAAC,EAAE;YACH,CAAC,GAAG,GAAG,GAAG,mBAAmB,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC;YAC7C,IAAI,GAAG,IAAI,CAAC;SACf;KACJ;IAED,OAAO,CAAC,CAAC;AACb,CAAC;AAED;;;;;;;;;;;AAWA,SAAS,iBAAiB,CACtB,CAAS,EACT,OAIC;IAED,IAAI,KAAK,GAAG,EAAE,CAAC;IACf,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,CAAC;IACb,IAAI,IAAI,GAAG,CAAC,CAAC;IACb,IAAI,MAAM,GAAG,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;IACzB,IAAI,MAAM,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,MAAM,CAAC,CAAC;IACtD,IAAI,MAAM,EAAE;;QAER,IAAI,KAAK,GAAG,CAAC,CAAC;QACd,IAAI,CAAC,GAAG,CAAC,CAAC;QACV,OAAO,CAAC,GAAG,CAAC,CAAC,MAAM,IAAI,KAAK,GAAG,CAAC,EAAE;YAC9B,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,MAAM;gBAAE,KAAK,EAAE,CAAC;YAC7B,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,MAAM;gBAAE,KAAK,EAAE,CAAC;YAC7B,CAAC,EAAE,CAAC;SACP;QACD,IAAI,KAAK,KAAK,CAAC,EAAE;;YAEb,IAAI,OAAO,CAAC,MAAM,IAAI,MAAM,KAAK,GAAG,EAAE;gBAClC,KAAK,GAAG,mBAAmB,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC;aAC/D;iBAAM;gBACH,IAAI,MAAM,KAAK,GAAG,IAAI,MAAM,KAAK,GAAG,EAAE;oBAClC,MAAM,GAAG,KAAK,CAAC;oBACf,MAAM,GAAG,KAAK,CAAC;iBAClB;gBACD,KAAK;oBACD,QAAQ;wBACR,MAAM;wBACN,mBAAmB,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,EAAE,OAAO,CAAC;wBACnD,SAAS;wBACT,MAAM,CAAC;aACd;YACD,IAAI,GAAG,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;SACzB;aAAM;;YAEH,KAAK,GAAG,CAAC,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YAC1B,IAAI,GAAG,EAAE,CAAC;SACb;KACJ;SAAM;QACH,IAAI,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,cAAc,CAAC,CAAC;QAChC,IAAI,CAAC,EAAE;;YAEH,IAAI,QAAQ,GAAG,iBAAiB,CAAC,IAAI,EAAE,CAAC,EAAE,OAAO,CAAC,eAAe,CAAC,CAAC;YACnE,IAAI,QAAQ,EAAE;gBACV,QAAQ,GAAG,QAAQ,CAAC,OAAO,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC;gBACzC,QAAQ,GAAG,QAAQ,CAAC,OAAO,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC;gBACzC,OAAO,EAAE,KAAK,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC,CAAC,SAAS,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,CAAC;aAClE;SACJ;QAED,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC;QAC3B,IAAI,CAAC,EAAE;;YAEH,OAAO,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,CAAC;SAChD;QAED,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,kBAAkB,CAAC,CAAC;QAChC,IAAI,CAAC,EAAE;;YAEH,OAAO,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,EAAE,CAAC;SAC1D;QAED,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE;;YAE5B,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,gBAAgB,CAAC,CAAC;YAC9B,IAAI,CAAC,EAAE;gBACH,IAAI,GAAG,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC;gBAChC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;aAChB;SACJ;KACJ;IAED,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC;AACxC,CAAC;AAED,SAAS,cAAc,CAAC,CAAS,EAAE,OAA4B;IAC3D,IAAI,MAAM,GAAG,iBAAiB,CAAC,IAAI,EAAE,CAAC,EAAE,OAAO,CAAC,CAAC;IACjD,IAAI,MAAM,EAAE;QACR,MAAM,GAAG,MAAM,CAAC,OAAO,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC;QACrC,MAAM,GAAG,MAAM,CAAC,OAAO,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC;QACrC,MAAM,IAAI,GAAG,CAAC;KACjB;SAAM;QACH,MAAM,GAAG,CAAC,CAAC;KACd;IACD,OAAO,MAAM,CAAC;AAClB;;SCjWgB,yBAAyB,CACrC,IAAmB,EACnB,KAAY;IAEZ,IAAI,CAAC,IAAI,IAAI,CAAC,KAAK;QAAE,OAAO;IAC5B,IAAI,WAAW,CAAC,IAAI,CAAC,EAAE;;QAEnB,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,KAAK,yBAAyB,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC;KAC5D;SAAM,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE;QACjC,IACI,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK;YACjB,CAAC,IAAI,CAAC,KAAK,CAAC,eAAe;YAC3B,CAAC,IAAI,CAAC,KAAK,CAAC,UAAU;YACtB,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS;YACrB,CAAC,IAAI,CAAC,KAAK,CAAC,UAAU;YACtB,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,EACtB;YACE,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;YACvB,yBAAyB,CAAC,IAAI,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;YAC5C,yBAAyB,CAAC,IAAI,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;YAC7C,yBAAyB,CAAC,IAAI,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;YAC7C,yBAAyB,CAAC,IAAI,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;YACjD,yBAAyB,CAAC,IAAI,CAAC,WAAW,EAAE,KAAK,CAAC,CAAC;SACtD;KACJ;AACL,CAAC;AAED;;;;;;;SAQgBJ,YAAU,CACtB,KAAmB,EACnB,KAAY,EACZ,KAAY;AACZ;;IAEA,SAAS,UAAU,CAAC,QAAQ,EAAE,KAAK;QAC/B,IAAI,MAAM,GAAG,IAAI,CAAC;QAClB,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;YACtC,MAAM,GAAG,MAAM,IAAI,CAAC,CAAC,QAAQ,CAAC,KAAK,KAAK,CAAC;SAC5C,CAAC,CAAC;QACH,OAAO,MAAM,CAAC;KACjB;IAED,KAAK,GAAG,KAAK,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;IACpC,IAAI,KAAK,CAAC,CAAC,CAAC,KAAK,KAAK,CAAC,CAAC,CAAC;QAAE,OAAO,KAAK,CAAC;IAExC,IAAI,KAAK,CAAC,KAAK,IAAI,UAAU,CAAC,OAAO,EAAE,KAAK,CAAC,KAAK,CAAC,EAAE;;QAEjD,KAAK,CAAC,KAAK,GAAG,MAAM,CAAC;KACxB;IAED,IACI,KAAK,CAAC,eAAe;QACrB,UAAU,CAAC,iBAAiB,EAAE,KAAK,CAAC,eAAe,CAAC,EACtD;;QAEE,KAAK,CAAC,eAAe,GAAG,MAAM,CAAC;KAClC;IAED,IAAI,KAAK,CAAC,UAAU,IAAI,UAAU,CAAC,YAAY,EAAE,KAAK,CAAC,UAAU,CAAC,EAAE;;QAEhE,KAAK,CAAC,UAAU,GAAG,MAAM,CAAC;KAC7B;;IAGD,IAAI,KAAK,CAAC,UAAU,IAAI,UAAU,CAAC,YAAY,EAAE,KAAK,CAAC,UAAU,CAAC,EAAE;;QAEhE,KAAK,CAAC,UAAU,GAAG,MAAM,CAAC;KAC7B;;IAGD,IAAI,KAAK,CAAC,SAAS,IAAI,UAAU,CAAC,WAAW,EAAE,KAAK,CAAC,SAAS,CAAC,EAAE;;QAE7D,KAAK,CAAC,SAAS,GAAG,MAAM,CAAC;KAC5B;;IAGD,IAAI,KAAK,CAAC,QAAQ,IAAI,UAAU,CAAC,UAAU,EAAE,KAAK,CAAC,QAAQ,CAAC,EAAE;;QAE1D,KAAK,CAAC,QAAQ,GAAG,OAAO,CAAC;KAC5B;IAED,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,CAAC;IAE1D,gBAAgB,CAAC,KAAK,CAAC,CAAC;IAExB,OAAO,IAAI,CAAC;AAChB;;AClFA;;;;AAIA,SAASK,UAAQ,CAAC,IAAU;IACxB,IAAI,CAAC,IAAI;QAAE,OAAO,KAAK,CAAC;IACxB,QACI,CAAC,IAAI,CAAC,IAAI,KAAK,MAAM,IAAI,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC;SACjD,IAAI,CAAC,IAAI,KAAK,QAAQ,IAAI,IAAI,CAAC,KAAK,KAAK,GAAG,CAAC,EAChD;AACN,CAAC;SAEe,OAAO,CAAC,KAAmB,EAAE,MAAc;IACvD,MAAM,IAAI,GAAG,KAAK,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC;IAC9B,IAAI,MAAiB,CAAC;IACtB,IAAI,IAAI,EAAE;QACN,MAAM,GAAG,IAAI,CAAC,IAAiB,CAAC;QAChC,IAAI,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC;QAC3B,OAAO,CAAC,MAAM,IAAI,QAAQ,EAAE;YACxB,IAAI,QAAQ;gBAAE,MAAM,GAAG,QAAQ,CAAC,IAAiB,CAAC;YAClD,QAAQ,GAAG,QAAQ,CAAC,MAAM,CAAC;SAC9B;KACJ;IACD,OAAO,MAAM,CAAC;AAClB,CAAC;AAED;;;;SAIgB,IAAI,CAChB,KAAmB,EACnB,GAA2B,EAC3B,SAAS,GAAG,IAAI;;IAEhB,MAAM,IAAI,GAAG,GAAG,KAAK,SAAS,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;IACxC,IAAI,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,IAAI,KAAK,aAAa,EAAE;;;QAG/C,IAAI,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;KACpB;;;;IAID,MAAM,KAAK,GAAG,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC,QAAQ,GAAG,IAAI,CAAC,CAAC;IACvD,IAAI,GAAG,KAAK,UAAU;QAAE,KAAK,CAAC,OAAO,EAAE,CAAC;IACxC,MAAM,YAAY,GAAG,KAAK,CAAC,MAAM,CAC7B,CAAC,IAAI,KACD,IAAI,CAAC,IAAI,KAAK,aAAa;SAC1B,IAAI,CAAC,SAAS,GAAG,CAAC,IAAI,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC,aAAa,CAAC,CACxE,CAAC;;;IAIF,IAAI,YAAY,CAAC,MAAM,KAAK,CAAC,EAAE;QAC3B,MAAM,OAAO,GAAG,CAAC,SAAS,IAAI,QAAC,MAAA,KAAK,CAAC,KAAK,EAAC,MAAM,mDAAG,KAAK,EAAE,GAAG,EAAC,CAAC;QAChE,IAAI,OAAO;YAAE,OAAO,KAAK,CAAC;QAC1B,MAAM,QAAQ,GAAG,mBAAmB,EAAE,CAAC;QACvC,IAAI,CAAC,QAAQ,CAAC,aAAa,IAAI,QAAQ,CAAC,MAAM,KAAK,CAAC,EAAE;YAClD,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;YACxB,OAAO,KAAK,CAAC;SAChB;QACD,IAAI,KAAK,GACL,QAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC,aAA4B,CAAC,GAAG,IAAI,CAAC;QACnE,IAAI,KAAK,GAAG,CAAC;YAAE,KAAK,GAAG,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC;QAC3C,IAAI,KAAK,IAAI,QAAQ,CAAC,MAAM;YAAE,KAAK,GAAG,CAAC,CAAC;QACxC,QAAQ,CAAC,KAAK,CAAC,CAAC,KAAK,EAAE,CAAC;QAExB,OAAO,KAAK,CAAC;KAChB;;IAGD,MAAM,gBAAgB,GAAG,KAAK,CAAC,QAAQ,CAAC;IACxC,MAAM,WAAW,GAAG,KAAK,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC;IACpD,IAAI,YAAY,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,aAAa,EAAE;QACxC,KAAK,CAAC,YAAY,CAAC,WAAW,GAAG,CAAC,EAAE,WAAW,CAAC,CAAC;KACpD;SAAM;QACH,KAAK,CAAC,QAAQ,GAAG,WAAW,CAAC;KAChC;IACD,KAAK,CAAC,QAAQ,CAAC,MAAM,EAAE,gBAAgB,CAAC,CAAC;IACzC,OAAO,IAAI,CAAC;AAChB,CAAC;AAED;;;;;;AAMA,SAAS,mBAAmB;;;;;;;;;;;;;;;;;;;IAqBxB,SAAS,QAAQ,CAAC,EAAe;QAC7B,MAAM,gBAAgB,GAAG,EAAE,CAAC;QAC5B,MAAM,gBAAgB,GAAG,EAAE,CAAC;QAE5B,MAAM,UAAU,GAAG,KAAK,CAAC,IAAI,CACzB,EAAE,CAAC,gBAAgB,CAEjB;;0EAE4D,CAAC,CAClE,CAAC,MAAM,CAAC,8BAA8B,CAAC,CAAC;QAEzC,UAAU,CAAC,OAAO,CAAC,CAAC,SAAS,EAAE,CAAC;YAC5B,MAAM,iBAAiB,GAAG,WAAW,CAAC,SAAS,CAAC,CAAC;YACjD,IAAI,iBAAiB,KAAK,CAAC,EAAE;gBACzB,gBAAgB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;aACpC;iBAAM;gBACH,gBAAgB,CAAC,IAAI,CAAC;oBAClB,aAAa,EAAE,CAAC;oBAChB,QAAQ,EAAE,iBAAiB;oBAC3B,IAAI,EAAE,SAAS;iBAClB,CAAC,CAAC;aACN;SACJ,CAAC,CAAC;QAEH,OAAO,gBAAgB;aAClB,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,KACP,CAAC,CAAC,QAAQ,KAAK,CAAC,CAAC,QAAQ;cACnB,CAAC,CAAC,aAAa,GAAG,CAAC,CAAC,aAAa;cACjC,CAAC,CAAC,QAAQ,GAAG,CAAC,CAAC,QAAQ,CAChC;aACA,GAAG,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC;aAClB,MAAM,CAAC,gBAAgB,CAAC,CAAC;KACjC;IAED,SAAS,8BAA8B,CAAC,EAAe;QACnD,IACI,CAAC,+BAA+B,CAAC,EAAE,CAAC;YACpC,kBAAkB,CAAC,EAAE,CAAC;YACtB,WAAW,CAAC,EAAE,CAAC,GAAG,CAAC,EACrB;YACE,OAAO,KAAK,CAAC;SAChB;QACD,OAAO,IAAI,CAAC;KACf;IAED,SAAS,+BAA+B,CAAC,IAAI;QACzC,IACI,IAAI,CAAC,QAAQ;aACZ,IAAI,CAAC,OAAO,KAAK,OAAO,IAAI,IAAI,CAAC,IAAI,KAAK,QAAQ,CAAC;YACpD,QAAQ,CAAC,IAAI,CAAC,EAChB;YACE,OAAO,KAAK,CAAC;SAChB;QACD,OAAO,IAAI,CAAC;KACf;IAED,SAAS,WAAW,CAAC,IAAiB;QAClC,MAAM,YAAY,GAAG,QAAQ,CAAC,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,EAAE,EAAE,CAAC,CAAC;QAEjE,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,EAAE;YACtB,OAAO,YAAY,CAAC;SACvB;;;QAID,IAAI,IAAI,CAAC,eAAe,KAAK,MAAM,EAAE;YACjC,OAAO,CAAC,CAAC;SACZ;;;;;;QAOD,IACI,CAAC,IAAI,CAAC,QAAQ,KAAK,OAAO,IAAI,IAAI,CAAC,QAAQ,KAAK,OAAO;YACvD,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,KAAK,IAAI,EACxC;YACE,OAAO,CAAC,CAAC;SACZ;QAED,OAAO,IAAI,CAAC,QAAQ,CAAC;KACxB;IAED,SAAS,kBAAkB,CAAC,IAAiB;QACzC,QACI,IAAI,CAAC,OAAO,KAAK,OAAO;YACvB,IAAyB,CAAC,IAAI,KAAK,OAAO;YAC3C,CAAC,eAAe,CAAC,IAAwB,CAAC,EAC5C;KACL;IAED,SAAS,eAAe,CAAC,KAAK,EAAE,IAAI;QAChC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACnC,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC,OAAO,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,IAAI,EAAE;gBAC5C,OAAO,KAAK,CAAC,CAAC,CAAC,CAAC;aACnB;SACJ;QACD,OAAO,IAAI,CAAC;KACf;IAED,SAAS,eAAe,CAAC,IAAsB;QAC3C,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE;YACZ,OAAO,IAAI,CAAC;SACf;QACD,MAAM,UAAU,GAAG,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,aAAa,CAAC;QACnD,MAAM,QAAQ,GAAG,UAAU,CAAC,gBAAgB,CACxC,4BAA4B,GAAG,IAAI,CAAC,IAAI,GAAG,IAAI,CAClD,CAAC;QACF,MAAM,OAAO,GAAG,eAAe,CAAC,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;QACrD,OAAO,CAAC,OAAO,IAAI,OAAO,KAAK,IAAI,CAAC;KACvC;IAED,SAAS,QAAQ,CAAC,EAAe;QAC7B,IACI,EAAE,KAAK,QAAQ,CAAC,aAAa;YAC7B,EAAE,CAAC,QAAQ,CAAC,QAAQ,CAAC,aAAa,CAAC,EACrC;YACE,OAAO,KAAK,CAAC;SAChB;QAED,IAAI,gBAAgB,CAAC,EAAE,CAAC,CAAC,UAAU,KAAK,QAAQ;YAAE,OAAO,IAAI,CAAC;;;;QAK9D,MAAM,MAAM,GAAG,EAAE,CAAC,qBAAqB,EAAE,CAAC;QAC1C,IAAI,MAAM,CAAC,KAAK,KAAK,CAAC,IAAI,MAAM,CAAC,MAAM,KAAK,CAAC;YAAE,OAAO,IAAI,CAAC;QAE3D,OAAO,EAAE,EAAE;YACP,IAAI,gBAAgB,CAAC,EAAE,CAAC,CAAC,OAAO,KAAK,MAAM;gBAAE,OAAO,IAAI,CAAC;YACzD,EAAE,GAAG,EAAE,CAAC,aAAa,CAAC;SACzB;QAED,OAAO,KAAK,CAAC;KAChB;IACD,OAAO,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;AACnC,CAAC;AAED;;;SAGgB,IAAI,CAChB,KAAmB,EACnB,SAAyD,EACzD,OAA6B;;IAE7B,OAAO,GAAG,OAAO,aAAP,OAAO,cAAP,OAAO,GAAI,EAAE,MAAM,EAAE,KAAK,EAAE,CAAC;IAEvC,WAAW,CAAC,KAAK,EAAE,yBAAyB,CAAC,KAAK,CAAC,CAAC,CAAC;IAErD,IAAI,SAAS,KAAK,QAAQ;QAAE,OAAO,UAAU,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;IAC9D,IAAI,SAAS,KAAK,UAAU;QAAE,OAAO,YAAY,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;IAElE,MAAM,gBAAgB,GAAG,KAAK,CAAC,QAAQ,CAAC;IAExC,IAAI,OAAO,CAAC,MAAM,EAAE;QAChB,OAAO,KAAK,CAAC,eAAe,CAAC,SAAS,CAAC,CAAC;KAC3C;IACD,IAAI,KAAK,CAAC,sBAAsB,EAAE;QAC9B,KAAK,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;QACnC,OAAO,IAAI,CAAC,KAAK,EAAE,SAAS,CAAC,CAAC;KACjC;IACD,IAAI,CAAC,KAAK,CAAC,iBAAiB,CAAC,SAAS,CAAC,EAAE;QACrC,IAAI,GAAG,GAAG,KAAK,CAAC,QAAQ,IAAI,SAAS,KAAK,SAAS,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;;;;QAK/D,IAAI,SAAS,KAAK,SAAS,EAAE;YACzB,MAAM,IAAI,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,GAAG,CAAC,CAAC,CAAC;YAC1C,UAAI,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,MAAM,0CAAE,gBAAgB,EAAE;;;gBAGhC,GAAG,GAAG,KAAK,CAAC,QAAQ,CAAC,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,MAAM,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;aACpD;iBAAM,IAAI,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,YAAY,EAAE;;gBAE3B,GAAG,IAAI,CAAC,CAAC;aACZ;SACJ;aAAM,IAAI,SAAS,KAAK,UAAU,EAAE;YACjC,MAAM,IAAI,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,GAAG,CAAC,CAAC,CAAC;YAC1C,UAAI,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,MAAM,0CAAE,gBAAgB,EAAE;;;gBAGhC,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,KAAK,CAAC,QAAQ,CAAC,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,MAAM,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC;aAClE;iBAAM,IAAI,CAAA,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,cAAc,YAAI,IAAI,CAAC,MAAM,0CAAE,YAAY,CAAA,EAAE;;;gBAG1D,GAAG,IAAI,CAAC,CAAC;aACZ;SACJ;;;;QAKD,IAAI,GAAG,GAAG,CAAC,IAAI,GAAG,GAAG,KAAK,CAAC,UAAU,EAAE;;YAEnC,IAAI,MAAM,GAAG,IAAI,CAAC;YAClB,IAAI,CAAC,KAAK,CAAC,2BAA2B,EAAE;gBACpC,MAAM,SAAG,KAAK,CAAC,KAAK,0CAAE,OAAO,CAAC,KAAK,EAAE,SAAS,CAAC,CAAC;aACnD;YACD,IAAI,MAAM;gBAAE,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;YACpC,OAAO,MAAM,CAAC;SACjB;;;;QAKD,IAAI,OAAA,KAAK,CAAC,EAAE,CAAC,GAAG,CAAC,0CAAE,IAAI,MAAK,aAAa,EAAE;;YAEvC,KAAK,CAAC,YAAY,CAAC,GAAG,GAAG,CAAC,EAAE,GAAG,CAAC,CAAC;SACpC;aAAM,IAAI,aAAA,KAAK,CAAC,EAAE,CAAC,GAAG,CAAC,0CAAE,YAAY,0CAAE,IAAI,MAAK,aAAa,EAAE;;YAE5D,KAAK,CAAC,YAAY,CAAC,GAAG,EAAE,GAAG,GAAG,CAAC,CAAC,CAAC;SACpC;aAAM;YACH,KAAK,CAAC,QAAQ,GAAG,GAAG,CAAC;SACxB;KACJ;IAED,KAAK,CAAC,QAAQ,CAAC,MAAM,EAAE,gBAAgB,CAAC,CAAC;IACzC,OAAO,IAAI,CAAC;AAChB,CAAC;AAED,SAAS,UAAU,CACf,KAAmB,EACnB,OAA6B;;IAE7B,MAAM,MAAM,SAAG,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,MAAM,mCAAI,KAAK,CAAC;IAExC,KAAK,CAAC,iBAAiB,CAAC,UAAU,CAAC,CAAC;;;;;IAKpC,IAAI,IAAI,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;IACpC,OAAO,IAAI,IAAI,IAAI,CAAC,UAAU,KAAK,OAAO,EAAE;QACxC,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC;KACtB;IAED,IAAI,IAAI,EAAE;QACN,IAAI,MAAM,EAAE;YACR,KAAK,CAAC,YAAY,CACd,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,EACvC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,CAC9B,CAAC;SACL;aAAM;;YAEH,MAAM,MAAM,SACR,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,mCAC3B,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;;YAGtC,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;SAC9D;QACD,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;;;;;;;;;;;;;KAc5B;SAAM;QACH,IAAI,QAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,MAAM,0CAAE,MAAM,CAAA,EAAE;YAC1C,IAAI,MAAM,GAAG,IAAI,CAAC;YAClB,IAAI,CAAC,KAAK,CAAC,2BAA2B,EAAE;gBACpC,MAAM,SAAG,KAAK,CAAC,KAAK,0CAAE,OAAO,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;aAClD;YACD,KAAK,CAAC,QAAQ,CAAC,MAAM,GAAG,OAAO,GAAG,MAAM,CAAC,CAAC;YAC1C,OAAO,MAAM,CAAC;SACjB;KACJ;IACD,OAAO,IAAI,CAAC;AAChB,CAAC;AAED,SAAS,YAAY,CACjB,KAAmB,EACnB,OAA6B;;IAE7B,MAAM,MAAM,SAAG,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,MAAM,mCAAI,KAAK,CAAC;IAExC,KAAK,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;IACnC,IAAI,IAAI,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;IACpC,OAAO,IAAI,IAAI,IAAI,CAAC,UAAU,KAAK,OAAO,EAAE;QACxC,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC;KACtB;IAED,IAAI,IAAI,EAAE;QACN,IAAI,MAAM,EAAE;YACR,KAAK,CAAC,YAAY,CACd,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,EACvC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,CAC9B,CAAC;SACL;aAAM;;YAEH,MAAM,MAAM,SACR,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,mCAC3B,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;;YAGtC,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;SAC9D;QACD,KAAK,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;;;;;;;;;;;;;KAa9B;SAAM;QACH,IAAI,QAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,MAAM,0CAAE,MAAM,CAAA,EAAE;YAC1C,IAAI,MAAM,GAAG,IAAI,CAAC;YAClB,IAAI,CAAC,KAAK,CAAC,2BAA2B,EAAE;gBACpC,MAAM,SAAG,KAAK,CAAC,KAAK,0CAAE,OAAO,CAAC,KAAK,EAAE,UAAU,CAAC,CAAC;aACpD;YACD,KAAK,CAAC,QAAQ,CAAC,MAAM,GAAG,OAAO,GAAG,MAAM,CAAC,CAAC;YAC1C,OAAO,MAAM,CAAC;SACjB;KACJ;IAED,OAAO,IAAI,CAAC;AAChB,CAAC;AAED;;;;;;;;;;SAUgB,IAAI,CAChB,KAAmB,EACnB,SAAiC,EACjC,OAA6B;;IAE7B,MAAM,gBAAgB,GAAG,KAAK,CAAC,QAAQ,CAAC;IAExC,IAAI,QAAE,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,MAAM,mCAAI,KAAK,CAAC,EAAE;QAC7B,KAAK,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;KACtC;IACD,IAAI,IAAI,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;IACpC,IAAI,SAAS,KAAK,SAAS,EAAE;QACzB,IAAI,IAAI,CAAC,IAAI,KAAK,SAAS,EAAE;YACzB,IAAI,GAAG,IAAI,CAAC,YAAY,CAAC;YACzB,IAAI,CAAC,IAAI,EAAE;gBACP,IAAI,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,GAAG,CAAC,CAAC,CAAC;aACvC;SACJ;aAAM;YACH,IAAI,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,GAAG,CAAC,CAAC,CAAC;SACvC;KACJ;IACD,IAAI,CAAC,IAAI;QAAE,OAAO,KAAK,CAAC;IACxB,IAAI,MAAM,GAAG,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;IAElC,IAAI,IAAI,CAAC,IAAI,KAAK,MAAM,EAAE;;;;QAItB,MAAM,GAAG,kBAAkB,CAAC,KAAK,EAAE,MAAM,EAAE,SAAS,CAAC,CAAC;KACzD;SAAM,IAAI,SAAS,KAAK,SAAS,IAAI,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE;;;;QAIzD,IAAI,KAAK,GAAG,CAAC,CAAC;QACd,GAAG;YACC,IAAI,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE;gBACvB,KAAK,IAAI,CAAC,CAAC;aACd;iBAAM,IAAI,IAAI,CAAC,IAAI,KAAK,QAAQ,EAAE;gBAC/B,KAAK,IAAI,CAAC,CAAC;aACd;YACD,IAAI,GAAG,IAAI,CAAC,YAAY,CAAC;SAC5B,QAAQ,CAAC,IAAI,CAAC,aAAa,IAAI,KAAK,KAAK,CAAC,EAAE;QAC7C,MAAM,GAAG,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;KAC7C;SAAM,IAAI,SAAS,KAAK,UAAU,IAAI,IAAI,CAAC,IAAI,KAAK,QAAQ,EAAE;;;;QAI3D,IAAI,KAAK,GAAG,CAAC,CAAC;QACd,GAAG;YACC,IAAI,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE;gBACvB,KAAK,IAAI,CAAC,CAAC;aACd;iBAAM,IAAI,IAAI,CAAC,IAAI,KAAK,QAAQ,EAAE;gBAC/B,KAAK,IAAI,CAAC,CAAC;aACd;YACD,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC;SAC3B,QAAQ,CAAC,IAAI,CAAC,cAAc,IAAI,KAAK,KAAK,CAAC,EAAE;QAC9C,MAAM,GAAG,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;KACjC;SAAM;;;;QAIH,IAAI,SAAS,KAAK,UAAU,EAAE;YAC1B,IAAI,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE;gBACvB,OAAO,MAAM,GAAG,CAAC,IAAI,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE;oBACxC,MAAM,IAAI,CAAC,CAAC;oBACZ,IAAI,GAAG,KAAK,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC;iBAC3B;aACJ;iBAAM;gBACH,MAAM,IAAI,GACN,IAAI,YAAY,UAAU,GAAG,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC;gBAC3D,IAAI,IAAI,CAAC,IAAI,KAAK,SAAS,EAAE;;;oBAGzB,MAAM,GAAG,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,WAAW,CAAC,CAAC;iBACzD;gBACD,MAAM,IAAI,CAAC,CAAC;gBACZ,IAAI,QAAQ,SAAG,KAAK,CAAC,EAAE,CAAC,MAAM,CAAC,0CAAE,IAAI,CAAC;;;;gBAItC,OAAO,MAAM,IAAI,CAAC,IAAI,QAAQ,KAAK,IAAI,EAAE;oBACrC,IAAI,OAAA,KAAK,CAAC,EAAE,CAAC,MAAM,CAAC,0CAAE,IAAI,MAAK,SAAS,EAAE;wBACtC,MAAM,GAAG,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,WAAW,CAAC,CAAC;qBACzD;yBAAM;wBACH,MAAM,IAAI,CAAC,CAAC;qBACf;oBACD,QAAQ,GAAG,KAAK,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC;iBACpC;aACJ;SACJ;aAAM;YACH,MAAM,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;;;;YAIvB,IAAI,QAAQ,SAAG,KAAK,CAAC,EAAE,CAAC,MAAM,CAAC,0CAAE,IAAI,CAAC;YACtC,MAAM,UAAU,GAAG,KAAK,CAAC,UAAU,CAAC;YACpC,OACI,MAAM,IAAI,UAAU;iBACnB,QAAQ,KAAK,IAAI,IAAI,QAAQ,KAAK,SAAS,CAAC,EAC/C;gBACE,OAAO,OAAA,KAAK,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,YAAY,0CAAE,IAAI,MAAK,SAAS,EAAE;oBACtD,MAAM,GAAG,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,YAAY,CAAC,CAAC;iBAC1D;gBACD,MAAM,IAAI,CAAC,CAAC;gBACZ,QAAQ,SAAG,KAAK,CAAC,EAAE,CAAC,MAAM,CAAC,0CAAE,IAAI,CAAC;aACrC;YACD,MAAM,IAAI,CAAC,CAAC;SACf;KACJ;IAED,UAAI,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,MAAM,mCAAI,KAAK,EAAE;QAC1B,KAAK,CAAC,YAAY,CAAC,KAAK,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;KAC5C;SAAM;QACH,KAAK,CAAC,QAAQ,GAAG,MAAM,CAAC;KAC3B;IACD,KAAK,CAAC,QAAQ,CAAC,MAAM,EAAE,gBAAgB,CAAC,CAAC;IACzC,OAAO,IAAI,CAAC;AAChB,CAAC;AAED;;;;;;SAMgB,WAAW,CAAC,KAAmB;IAC3C,IAAI,OAAO,CAAC,KAAK,EAAE,KAAK,CAAC,QAAQ,CAAC,KAAK,MAAM,EAAE;QAC3C,IAAI,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,MAAM,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAC;QACnD,IAAI,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,MAAM,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAC;;QAEjD,IAAI,IAAI,GAAG,KAAK,CAAC;QACjB,OAAO,CAAC,IAAI,IAAI,KAAK,GAAG,CAAC,EAAE;YACvB,MAAM,IAAI,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;YAC7B,IAAI,IAAI,CAAC,IAAI,KAAK,MAAM,IAAI,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE;gBAC5D,KAAK,IAAI,CAAC,CAAC;aACd;iBAAM;gBACH,IAAI,GAAG,IAAI,CAAC;aACf;SACJ;QACD,IAAI,GAAG,KAAK,CAAC;QACb,OAAO,CAAC,IAAI,IAAI,GAAG,IAAI,KAAK,CAAC,UAAU,EAAE;YACrC,MAAM,IAAI,GAAG,KAAK,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC;YAC3B,IAAI,IAAI,CAAC,IAAI,KAAK,MAAM,IAAI,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE;gBAC5D,GAAG,IAAI,CAAC,CAAC;aACZ;iBAAM;gBACH,IAAI,GAAG,IAAI,CAAC;aACf;SACJ;QACD,IAAI,IAAI,EAAE;YACN,GAAG,IAAI,CAAC,CAAC;SACZ;QACD,IAAI,KAAK,IAAI,GAAG,EAAE;;YAEd,KAAK,CAAC,YAAY,CAAC,GAAG,GAAG,CAAC,EAAE,GAAG,CAAC,CAAC;YACjC,OAAO,IAAI,CAAC;SACf;QAED,KAAK,CAAC,YAAY,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;KAClC;SAAM;QACH,MAAM,IAAI,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;;QAEtC,IAAIA,UAAQ,CAAC,IAAI,CAAC,EAAE;;YAEhB,IAAI,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,MAAM,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAC;YACnD,IAAI,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,MAAM,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAC;;YAEjD,OAAOA,UAAQ,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;gBAAE,KAAK,IAAI,CAAC,CAAC;YAC7C,OAAOA,UAAQ,CAAC,KAAK,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC;gBAAE,GAAG,IAAI,CAAC,CAAC;YACzC,KAAK,CAAC,YAAY,CAAC,KAAK,EAAE,GAAG,GAAG,CAAC,CAAC,CAAC;SACtC;aAAM;YACH,KAAK,CAAC,YAAY,CACd,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,YAAY,CAAC,EACjC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,CACnC,CAAC;SACL;KACJ;IACD,OAAO,IAAI,CAAC;AAChB,CAAC;SAEe,eAAe,CAAC,KAAmB;IAC/C,MAAM,gBAAgB,GAAG,KAAK,CAAC,QAAQ,CAAC;IACxC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,gBAAgB,CAAC,CAAC,MAAM,EAAE;QACpC,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;QACxB,OAAO,KAAK,CAAC;KAChB;IACD,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,CAAC;IACjE,KAAK,CAAC,QAAQ,CAAC,MAAM,EAAE,gBAAgB,CAAC,CAAC;IACzC,OAAO,IAAI,CAAC;AAChB,CAAC;AAED;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;SA8BgB,kBAAkB,CAC9B,KAAmB,EACnB,MAAc,EACd,SAAiC;IAEjC,IAAI,KAAK,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,IAAI,KAAK,MAAM;QAAE,OAAO,MAAM,CAAC;IACpD,MAAM,GAAG,GAAG,SAAS,KAAK,UAAU,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;IAC/C,IAAI,MAAM,CAAC;IACX,IAAI,iBAAiB,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,EAAE;;QAEhD,IAAI,CAAC,GAAG,MAAM,CAAC;QACf,IAAI,KAAK,CAAC;QACV,GAAG;YACC,KAAK;gBACD,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,MAAM;oBAC3B,iBAAiB,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;YAC9C,CAAC,IAAI,GAAG,CAAC;SACZ,QAAQ,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,KAAK,EAAE;QAC/B,MAAM,GAAG,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC;KAChD;SAAM,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,EAAE;;;QAI1C,IAAI,CAAC,GAAG,MAAM,CAAC;QACf,OACI,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC;YACX,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,MAAM;YAC3B,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,EAC9B;YACE,CAAC,IAAI,GAAG,CAAC;SACZ;QACD,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE;;YAEd,MAAM,GAAG,CAAC,GAAG,GAAG,CAAC;SACpB;aAAM;YACH,IAAI,KAAK,GAAG,IAAI,CAAC;YACjB,GAAG;gBACC,KAAK;oBACD,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,MAAM;wBAC3B,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;gBAClC,CAAC,IAAI,GAAG,CAAC;aACZ,QAAQ,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,KAAK,EAAE;YAC/B,MAAM,GAAG,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC;SAChD;KACJ;SAAM;;QAEH,IAAI,CAAC,GAAG,MAAM,CAAC;;QAEf,OACI,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC;YACX,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,MAAM;YAC3B,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,EAC/B;YACE,CAAC,IAAI,GAAG,CAAC;SACZ;QACD,MAAM,GAAG,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC;QACnC,IAAI,KAAK,GAAG,IAAI,CAAC;QACjB,OAAO,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,KAAK,EAAE;YACzB,KAAK,GAAG,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,MAAM,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;YACpE,IAAI,KAAK;gBAAE,MAAM,GAAG,CAAC,CAAC;YACtB,CAAC,IAAI,GAAG,CAAC;SACZ;QACD,MAAM,GAAG,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC;KAChD;IAED,OAAO,MAAM,IAAI,GAAG,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;AACtC;;MClvBa,eAAgB,SAAQ,IAAI;IACrC,YAAY,KAAa,EAAE,OAA6B;;QACpD,KAAK,CAAC,aAAa,EAAE,EAAE,IAAI,QAAE,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,IAAI,mCAAI,MAAM,EAAE,KAAK,EAAE,CAAC,CAAC;KAClE;IACD,IAAI,aAAa;QACb,OAAO,EAAE,CAAC;KACb;IACD,MAAM,CAAC,OAAgB;;;;QAInB,MAAM,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;QAClD,MAAM,CAAC,OAAO,GAAG,iBAAiB,CAAC;QACnC,IAAI,IAAI,CAAC,KAAK;YAAE,MAAM,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;QAC1C,OAAO,CAAC,MAAM,CAAC,CAAC;KACnB;IACD,OAAO,CAAC,QAAwB;QAC5B,OAAO,EAAE,CAAC;KACb;;;ACFL,SAAS,oBAAoB,CACzB,KAAmB,EACnB,CAAS,EACT,IAAc,EACd,OAAsB;;IAEtB,MAAM,IAAI,SAAG,OAAO,CAAC,IAAI,mCAAI,OAAO,CAAC,KAAK,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAC;IAE5D,IAAI,MAAM,GAAG,EAAE,CAAC;IAChB,IAAI,IAAI,KAAK,MAAM,IAAI,OAAO,CAAC,MAAM,KAAK,WAAW,EAAE;QACnD,GAAG,CAAC,CAAC,GAAG,eAAe,CAAC,CAAC,EAAE,EAAE,MAAM,EAAE,WAAW,EAAE,CAAC,CAAC;QACpD,MAAM,GAAG,WAAW,CAChB,CAAC,EACD,MAAM,EACN,IAAI,EACJ,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,MAAM,EACf,KAAK,EACL,KAAK,CAAC,SAAS,CAAC,OAAO,CAC1B,CAAC;;QAGF,IAAI,KAAK,CAAC,OAAO,CAAC,2BAA2B,EAAE;YAC3C,aAAa,CAAC,MAAM,CAAC,CAAC;SACzB;KACJ;SAAM,IACH,IAAI,KAAK,MAAM;SACd,OAAO,CAAC,MAAM,KAAK,MAAM,IAAI,OAAO,CAAC,MAAM,KAAK,OAAO,CAAC,EAC3D;QACE,IAAI,IAAI,KAAK,SAAS,EAAE;;YAEpB,MAAM,GAAG,EAAE,CAAC;YACZ,KAAK,MAAM,CAAC,IAAI,CAAC,EAAE;gBACf,IAAI,uBAAuB,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE;oBACjC,MAAM,CAAC,IAAI,CAAC,IAAI,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC;iBACnC;aACJ;SACJ;aAAM,IAAI,IAAI,KAAK,MAAM,EAAE;YACxB,IAAI,OAAO,CAAC,MAAM,KAAK,MAAM,EAAE;gBAC3B,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,CAAC,GAAG,eAAe,CAAC,CAAC,CAAC,CAAC;aAC5C;;YAGD,IAAI,gBAAgB,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE;gBAC1B,CAAC,GAAG,CAAC,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;aACpC;YAED,MAAM,GAAG,WAAW,CAChB,CAAC,EACD,IAAI,EACJ,IAAI,EACJ,OAAO,CAAC,MAAM,QACd,OAAO,CAAC,UAAU,mCAAI,KAAK,EAC3B,KAAK,CAAC,SAAS,CAAC,OAAO,CAC1B,CAAC;;YAGF,IACI,OAAO,CAAC,MAAM,KAAK,OAAO;gBAC1B,KAAK,CAAC,OAAO,CAAC,2BAA2B,EAC3C;gBACE,aAAa,CAAC,MAAM,CAAC,CAAC;aACzB;SACJ;KACJ;SAAM,IAAI,IAAI,KAAK,MAAM,EAAE;;;QAGxB,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,KAAK,EAAE,kBAAkB,CAAC,CAAC;QAEzC,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;QAC3B,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;QAC5B,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;QAC3B,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;;;;QAI3B,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;QAC3B,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,IAAI,EAAE,kBAAkB,CAAC,CAAC;QACxC,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,IAAI,EAAE,mBAAmB,CAAC,CAAC;QACzC,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,KAAK,EAAE,oBAAoB,CAAC,CAAC;QAC3C,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,IAAI,EAAE,mBAAmB,CAAC,CAAC;QACzC,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,IAAI,EAAE,iBAAiB,CAAC,CAAC;QAEvC,MAAM,GAAG,WAAW,CAChB,CAAC,EACD,MAAM,EACN,IAAI,EACJ,OAAO,CAAC,MAAM,EACd,KAAK,EACL,KAAK,CAAC,SAAS,CAAC,OAAO,CAC1B,CAAC;KACL;;;;;IAMD,yBAAyB,CAAC,MAAM,EAAE,OAAO,CAAC,KAAK,CAAC,CAAC;IAEjD,OAAO,MAAM,CAAC;AAClB,CAAC;SAEe,MAAM,CAClB,KAAmB,EACnB,CAAS,EACT,OAAsB;;IAEtB,IAAI,CAAC,OAAO,CAAC,aAAa;QAAE,OAAO,CAAC,aAAa,GAAG,kBAAkB,CAAC;IACvE,IAAI,CAAC,OAAO,CAAC,aAAa;QAAE,OAAO,CAAC,aAAa,GAAG,aAAa,CAAC;IAClE,IAAI,CAAC,OAAO,CAAC,MAAM;QAAE,OAAO,CAAC,MAAM,GAAG,MAAM,CAAC;IAC7C,OAAO,CAAC,MAAM,SAAG,OAAO,CAAC,MAAM,mCAAI,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC;;;;IAKxD,IAAI,QAAE,OAAO,CAAC,UAAU,mCAAI,KAAK,CAAC,EAAE;;;QAGhC,MAAM,MAAM,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC;QAC/C,IACI,MAAM,YAAY,aAAa;YAC/B,MAAM,CAAC,UAAU,KAAK,GAAG;YACzB,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,aAAa;YACtC,WAAW,CAAC,IAAI,CAAC,CAAC,CAAC,EACrB;YACE,MAAM,CAAC,UAAU,GAAG,CAAC,CAAC;YACtB,KAAK,CAAC,QAAQ,IAAI,CAAC,CAAC;YACpB,kBAAkB,CAAC,KAAK,CAAC,CAAC;YAC1B,gBAAgB,CAAC,KAAK,CAAC,CAAC;YACxB,OAAO,IAAI,CAAC;SACf;KACJ;SAAM,IACH,KAAK,CAAC,oBAAoB;QAC1B,gBAAgB,CAAC,KAAK,EAAE,CAAC,EAAE,OAAO,CAAC,KAAK,CAAC,EAC3C;QACE,OAAO,IAAI,CAAC;KACf;IAED,MAAM,2BAA2B,GAAG,KAAK,CAAC,2BAA2B,CAAC;IACtE,IAAI,OAAO,CAAC,2BAA2B,EAAE;QACrC,KAAK,CAAC,2BAA2B,GAAG,IAAI,CAAC;KAC5C;IACD,MAAM,kBAAkB,GAAG,KAAK,CAAC,2BAA2B,CAAC;IAC7D,KAAK,CAAC,2BAA2B,GAAG,IAAI,CAAC;;;;IAKzC,MAAM,IAAI,GAAa,EAAE,CAAC;IAC1B,IAAI,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;IAC1C,IAAI,CAAC,GAAG,CAAC,SAAG,OAAO,CAAC,WAAW,mCAAI,iBAAiB,CAAC;IACrD,IAAI,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC;;;;IAKtB,IACI,OAAO,CAAC,aAAa,KAAK,kBAAkB;QAC5C,CAAC,KAAK,CAAC,oBAAoB,EAC7B;QACE,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC;KAC7C;SAAM,IAAI,OAAO,CAAC,aAAa,KAAK,YAAY,EAAE;QAC/C,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC;QACnC,KAAK,CAAC,QAAQ,GAAG,CAAC,CAAC;KACtB;SAAM,IAAI,OAAO,CAAC,aAAa,KAAK,cAAc,EAAE;QACjD,KAAK,CAAC,iBAAiB,CAAC,UAAU,CAAC,CAAC;KACvC;SAAM,IAAI,OAAO,CAAC,aAAa,KAAK,aAAa,EAAE;QAChD,KAAK,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;KACtC;;;;IAKD,IACI,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,aAAa;QACvC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,GAAG,CAAC,CAAC,CAAC,IAAI,KAAK,aAAa,EACrD;;QAEE,KAAK,CAAC,WAAW,CAAC,CAAC,KAAK,CAAC,QAAQ,EAAE,KAAK,CAAC,QAAQ,GAAG,CAAC,CAAC,CAAC,CAAC;KAC3D;SAAM,IAAI,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,IAAI,KAAK,aAAa,EAAE;;QAExD,KAAK,CAAC,WAAW,CAAC,CAAC,KAAK,CAAC,QAAQ,GAAG,CAAC,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC;KAC3D;;;;IAKD,MAAM,IAAI,SAAG,OAAO,CAAC,IAAI,mCAAI,OAAO,CAAC,KAAK,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAC;IAC5D,IAAI,IAAI,KAAK,MAAM,EAAE;QACjB,IAAI,IAAI,CAAC,CAAC,CAAC,EAAE;;YAET,IAAI,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;SACvB;aAAM,IAAI,aAAa,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE;;YAE9B,MAAM,MAAM,GAAG,oBAAoB,CAAC,KAAK,CAAC,CAAC;YAC3C,IAAI,MAAM,IAAI,CAAC,EAAE;gBACb,IAAI,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAC;gBACnD,KAAK,CAAC,WAAW,CAAC,CAAC,MAAM,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC;aAC/C;SACJ;QACD,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;YAAE,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC;KACrC;IAED,MAAM,QAAQ,GAAG,oBAAoB,CAAC,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC;IAC/D,IAAI,CAAC,QAAQ;QAAE,OAAO,KAAK,CAAC;;;;IAK5B,MAAM,MAAM,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC;;IAE/C,IACI,OAAO,CAAC,MAAM,KAAK,OAAO;QAC1B,KAAK,CAAC,OAAO,CAAC,2BAA2B;QACzC,MAAM,YAAY,aAAa;QAC/B,MAAM,CAAC,SAAS,KAAK,GAAG;QACxB,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC;QAC7B,QAAQ,CAAC,MAAM,KAAK,CAAC;QACrB,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,SAAS,EAChC;;;QAGE,MAAM,SAAS,GAAG,MAAM,CAAC,MAAM,CAAC;QAChC,MAAM,MAAM,GAAG,MAAM,CAAC,UAAU,CAAC;QACjC,SAAS,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;QAC9B,SAAS,CAAC,WAAW,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;KAC3C;SAAM;QACH,IAAI,OAAO,CAAC,MAAM,KAAK,OAAO,IAAI,IAAI,CAAC,MAAM,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE;;;;;;YAM7D,IAAI,MAAM,CAAC,IAAI,KAAK,MAAM,IAAI,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE;gBACzD,MAAM,CAAC,KAAK,GAAG,CAAC,CAAC;aACpB;SACJ;QACD,MAAM,MAAM,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;QACxC,MAAM,CAAC,MAAM,CAAC,gBAAgB,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;KACpD;;;IAID,KAAK,CAAC,2BAA2B,GAAG,kBAAkB,CAAC;IAEvD,MAAM,WAAW,GAAG,QAAQ,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;;IAElD,IAAI,OAAO,CAAC,aAAa,KAAK,aAAa,EAAE;;QAEzC,MAAM,eAAe,GAAG,QAAQ,CAAC,MAAM,CACnC,CAAC,GAAG,EAAE,IAAI,KAAK;YACX,GAAG,GAAG;YACN,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,IAAI,KAAK,aAAa,CAAC;SAC3D,EACD,EAAE,CACL,CAAC;QAEF,IAAI,eAAe,CAAC,MAAM,GAAG,CAAC,EAAE;YAC5B,MAAM,iBAAiB,GAAG,KAAK,CAAC,QAAQ,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC,CAAC;YAC7D,KAAK,CAAC,YAAY,CAAC,iBAAiB,GAAG,CAAC,EAAE,iBAAiB,CAAC,CAAC;YAC7D,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;SAC1B;aAAM,IAAI,WAAW,EAAE;;YAEpB,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;SAChD;KACJ;SAAM,IAAI,OAAO,CAAC,aAAa,KAAK,QAAQ,EAAE,CAE9C;SAAM,IAAI,OAAO,CAAC,aAAa,KAAK,OAAO,EAAE;QAC1C,IAAI,WAAW,EAAE;YACb,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;SAChD;KACJ;SAAM,IAAI,OAAO,CAAC,aAAa,KAAK,MAAM,EAAE;QACzC,KAAK,CAAC,YAAY,CAAC,KAAK,CAAC,MAAM,EAAE,KAAK,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,CAAC;KACjE;IAED,gBAAgB,CAAC,KAAK,CAAC,CAAC;IAExB,KAAK,CAAC,2BAA2B,GAAG,2BAA2B,CAAC;IAEhE,OAAO,IAAI,CAAC;AAChB,CAAC;AAED;;;SAGgB,iBAAiB,CAAC,KAAmB,EAAE,CAAS;IAC5D,MAAM,MAAM,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;;IAGxC,IAAI,MAAM,CAAC,IAAI,KAAK,aAAa,EAAE;;QAE/B,MAAM,CAAC,KAAK,GAAG,CAAC,CAAC;KACpB;SAAM;;;QAIH,MAAM,KAAK,GAAG,MAAM,CAAC,KAAK,CAAC;QAC3B,MAAM,CAAC,KAAK,GAAG,EAAE,CAAC;;QAGlB,MAAM,IAAI,GAAG,IAAI,eAAe,CAAC,CAAC,EAAE,EAAE,IAAI,EAAE,MAAM,CAAC,IAAI,EAAE,CAAC,CAAC;QAC3D,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACnB,MAAM,CAAC,MAAM,CAAC,aAAa,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;;QAG1C,KAAK,CAAC,QAAQ,IAAI,CAAC,CAAC;KACvB;AACL,CAAC;AAED;;;SAGgB,iBAAiB,CAAC,KAAmB;IACjD,MAAM,MAAM,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;IACxC,IAAI,MAAM,CAAC,IAAI,KAAK,aAAa,EAAE;QAC/B,MAAM,CAAC,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;QAClC,KAAK,CAAC,QAAQ,IAAI,CAAC,CAAC;KACvB;AACL,CAAC;AAED,SAAS,WAAW,CAAC,KAAa;IAC9B,IAAI,CAAC,KAAK;QAAE,OAAO,IAAI,CAAC;IAExB,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,OAAO,CAAC,CAAC;IAC1C,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC;QAAE,OAAO,IAAI,CAAC;IAElC,MAAM,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;IACtB,IACI,IAAI,YAAY,aAAa;QAC7B,IAAI,CAAC,SAAS,KAAK,GAAG;QACtB,IAAI,CAAC,UAAU,KAAK,GAAG,EACzB;QACE,OAAO,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC;KACpC;IACD,OAAO,IAAI,CAAC;AAChB,CAAC;AAED;;;;;;AAMA,SAAS,aAAa,CAAC,KAAa;IAChC,IAAI,CAAC,KAAK;QAAE,OAAO;IACnB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE;QAC3B,MAAM,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;QACtB,IAAI,IAAI,YAAY,aAAa,IAAI,IAAI,CAAC,SAAS,KAAK,GAAG,EAAE;YACzD,IAAI,YAAY,GAAG,CAAC,CAAC;YACrB,IAAI,YAAY,GAAG,CAAC,CAAC;YACrB,IAAI,eAAe,GAAG,CAAC,CAAC;YACxB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE;gBAC/B,IAAI,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,SAAS,EAAE;oBACjC,YAAY,EAAE,CAAC;oBACf,YAAY,GAAG,CAAC,CAAC;iBACpB;gBACD,eAAe,EAAE,CAAC;aACrB;YACD,IAAI,eAAe,KAAK,CAAC,IAAI,YAAY,KAAK,CAAC,EAAE;;gBAE7C,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;aACtC;SACJ;KACJ;IAED,KAAK,CAAC,OAAO,CAAC,CAAC,IAAI;QACf,cAAc,CAAC,OAAO,CAAC,CAAC,MAAkB;YACtC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE;gBAC9B,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC;gBACnC,MAAM,WAAW,GAAG,WAAW,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC;gBACrD,IAAI,WAAW;oBAAE,IAAI,CAAC,WAAW,CAAC,WAAW,EAAE,MAAM,CAAC,CAAC;aAC1D;SACJ,CAAC,CAAC;QAEH,IAAI,IAAI,YAAY,SAAS,EAAE;YAC3B,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,KAAK,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC;SAC/C;KACJ,CAAC,CAAC;AACP,CAAC;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;SAIgB,gBAAgB,CAC5B,KAAmB,EACnB,KAAa,EACb,KAAY;IAEZ,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,oBAAoB,CAAC,CAAC;IAC3C,MAAM,IAAI,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;IACtC,MAAM,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;IAC3B,IAAI,MAAM,GACN,MAAM,YAAY,aAAa;UACzB,MAAM,CAAC,SAAS,GAAG,MAAM,CAAC,UAAU;UACpC,EAAE,CAAC;IACb,IAAI,MAAM,KAAK,kBAAkB;QAAE,MAAM,GAAG,IAAI,CAAC;IACjD,IAAI,MAAM,KAAK,QAAQ;QAAE,MAAM,GAAG,IAAI,CAAC;;;;;IAMvC,IAAI,MAAM,KAAK,IAAI,IAAI,gCAAgC,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE;QACjE,MAAM,CAAC,KAAK,EAAE,aAAa,GAAG,KAAK,GAAG,MAAM,EAAE;YAC1C,IAAI,EAAE,MAAM;YACZ,MAAM,EAAE,OAAO;YACf,KAAK,EAAE,KAAK;SACf,CAAC,CAAC;QACH,OAAO,IAAI,CAAC;KACf;;;;IAID,IAAI,KAAK,KAAK,GAAG,IAAI,KAAK,KAAK,KAAK;QAAE,KAAK,GAAG,UAAU,CAAC;IACzD,IAAI,KAAK,KAAK,GAAG,IAAI,KAAK,KAAK,KAAK;QAAE,KAAK,GAAG,UAAU,CAAC;IACzD,IAAI,KAAK,KAAK,GAAG;QAAE,KAAK,GAAG,UAAU,CAAC;IACtC,IAAI,KAAK,KAAK,GAAG;QAAE,KAAK,GAAG,UAAU,CAAC;;;;IAKtC,MAAM,MAAM,GAAG,WAAW,CAAC,KAAK,CAAC,CAAC;IAClC,IACI,MAAM;QACN,EAAE,MAAM,YAAY,aAAa,IAAI,MAAM,CAAC,SAAS,KAAK,GAAG,CAAC,EAChE;;QAEE,IAAI,CAAC,GAAG,EAAE,CAAC;QAEX,IAAI,IAAI,CAAC,UAAU,EAAE;;;;YAIjB,CAAC,GAAG,SAAS,GAAG,KAAK,GAAG,UAAU,GAAG,MAAM,CAAC;SAC/C;aAAM;YACH,CAAC,GAAG,QAAQ,GAAG,KAAK,GAAG,UAAU,CAAC;SACrC;QAED,MAAM,iBAAiB,GAAG,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;QAC3D,MAAM,OAAO,GAAG,KAAK,CAAC,YAAY,CAAC,CAAC,KAAK,CAAC,QAAQ,EAAE,iBAAiB,CAAC,CAAC,CAAC;QACxE,MAAM,CAAC,KAAK,EAAE,CAAC,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC;;QAElE,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,IAAI,GAAG,OAAO,CAAC;QACxC,KAAK,CAAC,QAAQ,IAAI,CAAC,CAAC;QACpB,OAAO,IAAI,CAAC;KACf;;;;IAKD,IAAI,MAAc,CAAC;IACnB,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,OAAO,CAAC,CAAC,KAAK;QACnC,IAAI,KAAK,KAAK,WAAW,CAAC,KAAK,CAAC;YAAE,MAAM,GAAG,KAAK,CAAC;KACpD,CAAC,CAAC;IACH,IAAI,MAAM,EAAE;;;;;QAMR,IAAI,MAAM,YAAY,aAAa,IAAI,IAAI,CAAC,aAAa,EAAE;YACvD,MAAM,CAAC,UAAU,GAAG,KAAK,CAAC;YAC1B,KAAK,CAAC,QAAQ,IAAI,CAAC,CAAC;YACpB,gBAAgB,CAAC,KAAK,CAAC,CAAC;YACxB,OAAO,IAAI,CAAC;SACf;;;;QAID,MAAM,YAAY,GAAG,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;QACvD,IAAI,CAAS,CAAC;QACd,KAAK,CAAC,GAAG,KAAK,CAAC,QAAQ,EAAE,CAAC,IAAI,YAAY,EAAE,CAAC,EAAE,EAAE;YAC7C,MAAM,IAAI,GAAG,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;YACzB,IAAI,IAAI,YAAY,aAAa,IAAI,IAAI,CAAC,UAAU,KAAK,GAAG,EAAE;gBAC1D,MAAM;aACT;SACJ;QACD,MAAM,KAAK,GAAG,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QAC1B,IAAI,CAAC,IAAI,YAAY,IAAI,KAAK,YAAY,aAAa,EAAE;YACrD,KAAK,CAAC,UAAU,GAAG,KAAK,CAAC;YACzB,KAAK,CAAC,WAAW,CACb,KAAK,CAAC,YAAY,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAC,EACvC,IAAI,CAAC,UAAU,CAClB,CAAC;YACF,gBAAgB,CAAC,KAAK,CAAC,CAAC;YACxB,OAAO,IAAI,CAAC;SACf;;;;QAKD,IAAI,MAAM,YAAY,aAAa,IAAI,MAAM,CAAC,UAAU,KAAK,GAAG,EAAE;YAC9D,MAAM,CAAC,UAAU,GAAG,KAAK,CAAC;YAE1B,MAAM,CAAC,MAAM,CAAC,WAAW,CACrB,KAAK,CAAC,YAAY,CAAC;gBACf,KAAK,CAAC,QAAQ;gBACd,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC;aACnC,CAAC,EACF,MAAM,CAAC,UAAU,CACpB,CAAC;YACF,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;YACxC,gBAAgB,CAAC,KAAK,CAAC,CAAC;YAExB,OAAO,IAAI,CAAC;SACf;;;;QAKD,MAAM,WAAW,GAAG,MAAM,CAAC,MAAM,CAAC;QAClC,IACI,WAAW,YAAY,aAAa;YACpC,WAAW,CAAC,UAAU,KAAK,GAAG;YAC9B,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,aAAa,EACxC;YACE,IAAI,CAAC,KAAK,EAAE,SAAS,CAAC,CAAC;YACvB,OAAO,gBAAgB,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC;SAChD;;;QAID,OAAO,KAAK,CAAC;KAChB;IAED,OAAO,KAAK,CAAC;AACjB,CAAC;AAED;;;;;;;;AAQA,SAAS,oBAAoB,CAAC,KAAmB;IAC7C,IAAI,IAAI,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;IACpC,IAAI,IAAI,CAAC,IAAI,KAAK,MAAM,EAAE;QACtB,OAAO,CAAC,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC,IAAI,KAAK,MAAM,EAAE;YACjD,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC;SAC3B;QACD,OAAO,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;KAC/B;IACD,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,EAAE;QACtB,OAAO,CAAC,CAAC,CAAC;KACb;;;IAGD,OAAO,CAAC,IAAI,CAAC,cAAc,IAAI,aAAa,CAAC,IAAI,CAAC,EAAE;QAChD,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC;KAC3B;IAED,OAAO,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;AAChC,CAAC;AAED;;;;;;;;AAQA,SAAS,aAAa,CAAC,IAAU;IAC7B,IAAI,qCAAqC,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;;QAEvD,IAAI,IAAI,CAAC,kBAAkB;YAAE,OAAO,KAAK,CAAC;QAC1C,OAAO,IAAI,CAAC;KACf;IACD,OAAO,KAAK,CAAC;AACjB;;AC1kBA;;;;SAIgB,iBAAiB,CAAC,KAAmB;;IACjD,KAAK,CAAC,iBAAiB,EAAE,CAAC;IAC1B,IAAI,gBAAgB,CAAC,KAAK,CAAC,IAAI,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC,CAAC,EAAE;QACnE,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;QACxB,OAAO,KAAK,CAAC;KAChB;IACD,IAAI,MAAM,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;IAEtC,IAAI,MAAM,CAAC,MAAM,KAAK,QAAQ,IAAI,MAAM,CAAC,MAAM,KAAK,MAAM,EAAE;;;QAGxD,IAAI,OAAA,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,GAAG,CAAC,CAAC,0CAAE,IAAI,MAAK,SAAS,EAAE;YAClD,MAAM,CAAC,MAAM,CAAC,aAAa,CACvB,IAAI,UAAU,CAAC;gBACX,QAAQ,EAAE,MAAM,CAAC,IAAI;gBACrB,KAAK,EAAE,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,aAAa;aAChD,CAAC,EACF,MAAM,CACT,CAAC;SACL;QACD,MAAM,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,GAAG,CAAC,CAAC,CAAC;KACzC;;IAED,MAAM,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC;IACnC,KAAK,CAAC,YAAY,CACd,KAAK,CAAC,gBAAgB,CAAC,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC,CAChE,CAAC;IAEF,OAAO,IAAI,CAAC;AAChB,CAAC;AAED;;;;SAIgB,eAAe,CAAC,KAAmB;;IAC/C,KAAK,CAAC,iBAAiB,EAAE,CAAC;IAC1B,IAAI,cAAc,CAAC,KAAK,CAAC,IAAI,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC,CAAC,EAAE;QACjE,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;QACxB,OAAO,KAAK,CAAC;KAChB;IACD,IAAI,MAAM,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;IAEtC,IAAI,MAAM,CAAC,MAAM,KAAK,QAAQ,IAAI,MAAM,CAAC,MAAM,KAAK,MAAM,EAAE;;;QAGxD,IAAI,OAAA,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,GAAG,CAAC,CAAC,0CAAE,IAAI,MAAK,SAAS,EAAE;YAClD,MAAM,CAAC,MAAM,CAAC,aAAa,CACvB,IAAI,IAAI,CAAC,SAAS,EAAE;gBAChB,IAAI,EAAE,MAAM,CAAC,IAAI;gBACjB,KAAK,EAAE,QAAQ;gBACf,KAAK,EAAE,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,aAAa;aAChD,CAAC,EACF,MAAM,CACT,CAAC;SACL;QACD,MAAM,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,GAAG,CAAC,CAAC,CAAC;KACzC;;IAED,MAAM,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC;IACjC,KAAK,CAAC,YAAY,CACd,KAAK,CAAC,gBAAgB,CAAC,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAC9D,CAAC;IACF,OAAO,IAAI,CAAC;AAChB,CAAC;AAED;;;;;;;;AAQAF,UAAQ,CACJ;IACI,cAAc,EAAE,CAAC,KAAmB;QAChC,MAAM,kBAAkB,GAAG;YACvB,WAAW,EAAE,WAAW;YACxB,SAAS,EAAE,aAAa;YACxB,KAAK,EAAE,OAAO;YACd,KAAK,EAAE,OAAO;SACjB,CAAC;QACF,MAAM,MAAM,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;QACxC,MAAM,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC;QAC7B,IAAI,CAAC,MAAM;YAAE,OAAO,KAAK,CAAC;QAC1B,MAAM,QAAQ,GAAG,MAAM,CAAC,UAAU,CAAC;QACnC,IAAI,gBAA4B,CAAC;QACjC,IAAI,OAAO,QAAQ,KAAK,QAAQ,EAAE;YAC9B,gBAAgB,GAAG,kBAAkB,CAAC,QAAQ,CAAC,CAAC;SACnD;QACD,IAAI,CAAC,gBAAgB,EAAE;YACnB,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE;gBAChB,OAAO,iBAAiB,CAAC,KAAK,CAAC,CAAC;aACnC;YACD,OAAO,eAAe,CAAC,KAAK,CAAC,CAAC;SACjC;QAED,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,gBAAgB,CAAC,EAAE;;;YAGlC,MAAM,CAAC,YAAY,CAAC,gBAAgB,CAAC,CAAC;SACzC;QAED,OAAO,KAAK,CAAC,YAAY,CACrB,KAAK,CAAC,cAAc,CAAC,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,gBAAgB,CAAC,CACjE,CAAC;KACL;IACD,gBAAgB,EAAE,CAAC,KAAmB;QAClC,MAAM,MAAM,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC;QAC/C,IAAI,CAAC,MAAM,EAAE;YACT,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;YACxB,OAAO,KAAK,CAAC;SAChB;QACD,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;QACxC,OAAO,IAAI,CAAC;KACf;IACD,eAAe,EAAE,CAAC,KAAmB,KACjC,eAAe,CAAC,KAAK,CAAC;IAE1B,qBAAqB,EAAE,CAAC,KAAmB,KACvC,IAAI,CAAC,KAAK,EAAE,SAAS,CAAC;IAC1B,yBAAyB,EAAE,CAAC,KAAmB,KAC3C,IAAI,CAAC,KAAK,EAAE,UAAU,CAAC;IAC3B,cAAc,EAAE,CAAC,KAAmB,KAChC,IAAI,CAAC,KAAK,EAAE,SAAS,CAAC;IAC1B,kBAAkB,EAAE,CAAC,KAAmB,KACpC,IAAI,CAAC,KAAK,EAAE,UAAU,CAAC;IAC3B,MAAM,EAAE,CAAC,KAAmB,KAAc,IAAI,CAAC,KAAK,EAAE,QAAQ,CAAC;IAC/D,QAAQ,EAAE,CAAC,KAAmB,KAAc,IAAI,CAAC,KAAK,EAAE,UAAU,CAAC;IACnE,cAAc,EAAE,CAAC,KAAmB,KAChC,IAAI,CAAC,KAAK,EAAE,SAAS,CAAC;IAC1B,kBAAkB,EAAE,CAAC,KAAmB,KACpC,IAAI,CAAC,KAAK,EAAE,UAAU,CAAC;IAC3B,gBAAgB,EAAE,CAAC,KAAmB;QAClC,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAC3B,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,YAAY,CACxC,CAAC;QACF,OAAO,IAAI,CAAC;KACf;IACD,cAAc,EAAE,CAAC,KAAmB;QAChC,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAC3B,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,WAAW,CACvC,CAAC;QACF,OAAO,IAAI,CAAC;KACf;IACD,oBAAoB,EAAE,CAAC,KAAmB;QACtC,KAAK,CAAC,QAAQ,GAAG,CAAC,CAAC;QACnB,OAAO,IAAI,CAAC;KACf;IACD,kBAAkB,EAAE,CAAC,KAAmB;QACpC,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,UAAU,CAAC;QAClC,OAAO,IAAI,CAAC;KACf;IACD,iBAAiB,EAAE,CAAC,KAAmB,KACnC,iBAAiB,CAAC,KAAK,CAAC;IAC5B,eAAe,EAAE,CAAC,KAAmB,KACjC,eAAe,CAAC,KAAK,CAAC;CAC7B,EACD,EAAE,MAAM,EAAE,OAAO,EAAE,QAAQ,EAAE,kBAAkB,EAAE,CACpD,CAAC;AAEFA,UAAQ,CACJ;IACI,WAAW,EAAE,CAAC,KAAmB,KAAc,WAAW,CAAC,KAAK,CAAC;IAEjE,SAAS,EAAE,CAAC,KAAmB,KAC3B,KAAK,CAAC,YAAY,CAAC,CAAC,EAAE,KAAK,CAAC,UAAU,CAAC;IAC3C,sBAAsB,EAAE,CAAC,KAAmB,KACxC,KAAK,CAAC,eAAe,CAAC,SAAS,CAAC;IACpC,uBAAuB,EAAE,CAAC,KAAmB,KACzC,KAAK,CAAC,eAAe,CAAC,UAAU,CAAC;IACrC,gBAAgB,EAAE,CAAC,KAAmB,KAClC,IAAI,CAAC,KAAK,EAAE,SAAS,EAAE,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC;IAC5C,oBAAoB,EAAE,CAAC,KAAmB,KACtC,IAAI,CAAC,KAAK,EAAE,UAAU,EAAE,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC;IAC7C,qBAAqB,EAAE,CAAC,KAAmB,KACvC,IAAI,CAAC,KAAK,EAAE,QAAQ,EAAE,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC;IAC3C,uBAAuB,EAAE,CAAC,KAAmB,KACzC,IAAI,CAAC,KAAK,EAAE,UAAU,EAAE,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC;;;;;;;;IAQ7C,oBAAoB,EAAE,CAAC,KAAmB,KACtC,IAAI,CAAC,KAAK,EAAE,SAAS,EAAE,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC;;;;;;;;IAQ5C,wBAAwB,EAAE,CAAC,KAAmB,KAC1C,IAAI,CAAC,KAAK,EAAE,UAAU,EAAE,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC;IAC7C,kBAAkB,EAAE,CAAC,KAAmB,KACpC,KAAK,CAAC,YAAY,CACd,KAAK,CAAC,MAAM,EACZ,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,YAAY,CAAC,CACxD;IACL,gBAAgB,EAAE,CAAC,KAAmB,KAClC,KAAK,CAAC,YAAY,CACd,KAAK,CAAC,MAAM,EACZ,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,WAAW,CAAC,CACvD;IACL,sBAAsB,EAAE,CAAC,KAAmB,KACxC,KAAK,CAAC,YAAY,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC;IACvC,oBAAoB,EAAE,CAAC,KAAmB,KACtC,KAAK,CAAC,YAAY,CAAC,KAAK,CAAC,MAAM,EAAE,KAAK,CAAC,UAAU,CAAC;CACzD,EACD,EAAE,MAAM,EAAE,OAAO,EAAE,QAAQ,EAAE,kBAAkB,EAAE,CACpD,CAAC;AAEF,SAAS,gBAAgB,CAAC,KAAmB;IACzC,IAAI,MAAM,GAAG,CAAC,CAAC;IACf,IAAI,IAAI,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;IACpC,IAAI,cAAc,GAAG,KAAK,CAAC;IAC3B,OAAO,IAAI,EAAE;QACT,IACI,CAAC,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC;YACnC,CAAC,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,EACnC;YACE,MAAM,IAAI,CAAC,CAAC;SACf;QACD,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,EAAE;YACrC,cAAc,GAAG,IAAI,CAAC;SACzB;aAAM,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,EAAE;YAC1C,cAAc,GAAG,KAAK,CAAC;SAC1B;QACD,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC;KACtB;IACD,OAAO,cAAc,GAAG,MAAM,GAAG,CAAC,CAAC;AACvC,CAAC;AACD,SAAS,cAAc,CAAC,KAAmB;IACvC,IAAI,MAAM,GAAG,CAAC,CAAC;IACf,IAAI,IAAI,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;IACpC,IAAI,YAAY,GAAG,KAAK,CAAC;IACzB,OAAO,IAAI,EAAE;QACT,IACI,CAAC,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC;YACnC,CAAC,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,EACnC;YACE,MAAM,IAAI,CAAC,CAAC;SACf;QACD,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,EAAE;YACrC,YAAY,GAAG,KAAK,CAAC;SACxB;aAAM,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,EAAE;YAC1C,YAAY,GAAG,IAAI,CAAC;SACvB;QACD,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC;KACtB;IACD,OAAO,YAAY,GAAG,MAAM,GAAG,CAAC,CAAC;AACrC,CAAC;AAEDA,UAAQ,CACJ;IACI,SAAS,EAAE,CAAC,KAAmB;QAC3B,OAAO,WAAW,CAAC,KAAK,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;KACtC;IACD,aAAa,EAAE,CAAC,KAAmB,KAAc,aAAa,CAAC,KAAK,CAAC;IACrE,cAAc,EAAE,CAAC,KAAmB,KAAc,cAAc,CAAC,KAAK,CAAC;IACvE,cAAc,EAAE,CAAC,KAAmB,KAChC,WAAW,CAAC,KAAK,EAAE;QACf,KAAK,CAAC,MAAM;QACZ,kBAAkB,CAAC,KAAK,EAAE,KAAK,CAAC,QAAQ,EAAE,SAAS,CAAC;KACvD,CAAC;IACN,kBAAkB,EAAE,CAAC,KAAmB,KACpC,WAAW,CAAC,KAAK,EAAE;QACf,KAAK,CAAC,MAAM;QACZ,kBAAkB,CAAC,KAAK,EAAE,KAAK,CAAC,QAAQ,EAAE,UAAU,CAAC;KACxD,CAAC;IACN,kBAAkB,EAAE,CAAC,KAAmB,KACpC,WAAW,CAAC,KAAK,EAAE;QACf,KAAK,CAAC,MAAM;QACZ,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,YAAY,CAAC;KACxD,CAAC;IACN,gBAAgB,EAAE,CAAC,KAAmB,KAClC,WAAW,CAAC,KAAK,EAAE;QACf,KAAK,CAAC,MAAM;QACZ,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,WAAW,CAAC;KACvD,CAAC;IACN,sBAAsB,EAAE,CAAC,KAAmB,KACxC,WAAW,CAAC,KAAK,EAAE,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;IACzC,oBAAoB,EAAE,CAAC,KAAmB,KACtC,WAAW,CAAC,KAAK,EAAE,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,CAAC;CAC7C,EACD,EAAE,MAAM,EAAE,OAAO,EAAE,QAAQ,EAAE,QAAQ,EAAE,CAC1C;;ACpTD;;;;;;;;;;;;;;;;;;;;;;;;;AA4BA,MAAM,iBAAiB,GAAG;IACtB,WAAW;IACX,QAAQ;IACR,QAAQ;IACR,QAAQ;IACR,QAAQ;IACR,QAAQ;IACR,QAAQ;IACR,QAAQ;IACR,QAAQ;IACR,QAAQ;IACR,QAAQ;IACR,OAAO;IACP,OAAO;IACP,SAAS;IAET,MAAM;IACN,MAAM;IACN,MAAM;IACN,MAAM;IACN,MAAM;IACN,MAAM;IACN,MAAM;IACN,MAAM;IACN,MAAM;IACN,MAAM;IACN,aAAa;IACb,cAAc;IACd,WAAW;IACX,MAAM;IACN,MAAM;IACN,MAAM;IACN,MAAM;IACN,MAAM;IACN,MAAM;IACN,MAAM;IACN,MAAM;IACN,MAAM;IACN,WAAW;IACX,OAAO;IACP,eAAe;IACf,MAAM;IACN,MAAM;IACN,MAAM;IACN,MAAM;IACN,MAAM;IACN,MAAM;IACN,MAAM;IACN,OAAO;IACP,QAAQ;IACR,OAAO;IACP,QAAQ;IAER,OAAO;IAEP,SAAS;IACT,SAAS;IACT,SAAS;IACT,SAAS;IACT,SAAS;IACT,SAAS;IACT,SAAS;IACT,SAAS;IACT,SAAS;IACT,SAAS;IACT,WAAW;IACX,aAAa;IACb,eAAe;IACf,cAAc;IACd,aAAa;IACb,YAAY;IACZ,gBAAgB;IAChB,iBAAiB;IACjB,kBAAkB;IAClB,YAAY;IACZ,iBAAiB;CACpB,CAAC;SAEc,8BAA8B,CAAC,GAAkB;IAC7D,IAAI,GAAG,CAAC,OAAO,IAAI,GAAG,CAAC,OAAO,EAAE;;QAE5B,OAAO,KAAK,CAAC;KAChB;;IAGD,IAAI,GAAG,CAAC,GAAG,KAAK,MAAM;QAAE,OAAO,KAAK,CAAC;;IAGrC,IAAI,GAAG,CAAC,IAAI,KAAK,EAAE;QAAE,OAAO,IAAI,CAAC;IAEjC,OAAO,iBAAiB,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AACpD,CAAC;AAED;;;;;;;;;AASA,SAAS,qBAAqB,CAAC,GAAkB;IAC7C,GAAG,GAAG,sBAAsB,CAAC,GAAG,CAAC,CAAC;IAElC,MAAM,SAAS,GAAG,EAAE,CAAC;IAErB,IAAI,GAAG,CAAC,OAAO;QAAE,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IACxC,IAAI,GAAG,CAAC,OAAO;QAAE,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IACxC,IAAI,GAAG,CAAC,MAAM;QAAE,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IACtC,IAAI,GAAG,CAAC,QAAQ;QAAE,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;;IAG1C,IAAI,SAAS,CAAC,MAAM,KAAK,CAAC;QAAE,OAAO,GAAG,GAAG,GAAG,CAAC,IAAI,GAAG,GAAG,CAAC;IAExD,SAAS,CAAC,IAAI,CAAC,GAAG,GAAG,GAAG,CAAC,IAAI,GAAG,GAAG,CAAC,CAAC;IAErC,OAAO,SAAS,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;AAC/B,CAAC;AAYD;;;;;;;;;;;;;;;;;;;;;;;;SAwBgB,sBAAsB,CAClC,QAA6B,EAC7B,QAWC;IAED,IAAI,YAAY,GAAG,IAAI,CAAC;IACxB,IAAI,aAAa,GAAG,IAAI,CAAC;IACzB,IAAI,qBAAqB,GAAG,KAAK,CAAC;IAClC,IAAI,eAAe,GAAG,KAAK,CAAC;IAC5B,IAAI,cAAc,GAAG,KAAK,CAAC;;;IAI3B,IAAI,iBAAyB,CAAC;IAC9B,SAAS,KAAK,CAAC,EAAc;QACzB,YAAY,CAAC,iBAAiB,CAAC,CAAC;QAChC,iBAAiB,GAAG,UAAU,CAAC;YAC3B,YAAY,CAAC,iBAAiB,CAAC,CAAC;YAChC,EAAE,EAAE,CAAC;SACR,CAAC,CAAC;KACN;IAED,SAAS,eAAe;;;;QAIpB,IAAI,QAAQ,CAAC,cAAc,KAAK,QAAQ,CAAC,YAAY;YAAE,OAAO;QAE9D,MAAM,IAAI,GAAG,QAAQ,CAAC,KAAK,CAAC;QAC5B,QAAQ,CAAC,KAAK,GAAG,EAAE,CAAC;QACpB,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC;YAAE,QAAQ,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;KACjD;IAED,MAAM,MAAM,GAAG,QAAQ,CAAC;IAExB,MAAM,CAAC,gBAAgB,CACnB,SAAS,EACT,CAAC,CAAgB;;;QAGb,IACI,qBAAqB;YACrB,CAAC,CAAC,GAAG,KAAK,SAAS;YACnB,CAAC,CAAC,IAAI,KAAK,UAAU;YACrB,sCAAsC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,EACrD;YACE,YAAY,GAAG,IAAI,CAAC;YACpB,OAAO;SACV;QAED,YAAY,GAAG,CAAC,CAAC;QACjB,aAAa,GAAG,IAAI,CAAC;QACrB,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,qBAAqB,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE;YAClD,YAAY,GAAG,IAAI,CAAC;YACpB,QAAQ,CAAC,KAAK,GAAG,EAAE,CAAC;SACvB;KACJ,EACD,IAAI,CACP,CAAC;IACF,MAAM,CAAC,gBAAgB,CACnB,UAAU,EACV,CAAC,CAAC;QACE,IAAI,qBAAqB;YAAE,OAAO;;;QAGlC,IAAI,CAAC,qBAAqB,EAAE;YACxB,IAAI,YAAY,IAAI,aAAa,EAAE;gBAC/B,QAAQ,CAAC,SAAS,CACd,qBAAqB,CAAC,YAAY,CAAC,EACnC,YAAY,CACf,CAAC;aACL;YAED,aAAa,GAAG,CAAC,CAAC;YAClB,KAAK,CAAC,eAAe,CAAC,CAAC;SAC1B;KACJ,EACD,IAAI,CACP,CAAC;IACF,MAAM,CAAC,gBAAgB,CACnB,OAAO,EACP;QACI,IAAI,qBAAqB;YAAE,OAAO;;;QAGlC,IAAI,YAAY,IAAI,CAAC,aAAa,EAAE;YAChC,eAAe,EAAE,CAAC;SACrB;KACJ,EACD,IAAI,CACP,CAAC;IACF,MAAM,CAAC,gBAAgB,CACnB,OAAO,EACP,CAAC,EAAkB;;;QAGf,QAAQ,CAAC,KAAK,EAAE,CAAC;QACjB,QAAQ,CAAC,KAAK,GAAG,EAAE,CAAC;QACpB,QAAQ,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC;KACtB,EACD,IAAI,CACP,CAAC;IACF,MAAM,CAAC,gBAAgB,CACnB,KAAK,EACL;QACI,QAAQ,CAAC,GAAG,EAAE,CAAC;KAClB,EACD,IAAI,CACP,CAAC;IACF,MAAM,CAAC,gBAAgB,CACnB,MAAM,EACN,CAAC,EAAE;QACC,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;KACrB,EACD,IAAI,CACP,CAAC;IACF,MAAM,CAAC,gBAAgB,CACnB,MAAM,EACN,CAAC,EAAE;;;QAGC,IACI,EAAE,CAAC,aAAa;YACb,EAAE,CAAC,MAAsB,CAAC,WAAW,EAAyB;iBAC5D,IAAI,EACX;YACE,EAAE,CAAC,cAAc,EAAE,CAAC;YACpB,EAAE,CAAC,eAAe,EAAE,CAAC;YACrB,OAAO;SACV;QACD,IAAI,cAAc,IAAI,eAAe;YAAE,OAAO;QAE9C,cAAc,GAAG,IAAI,CAAC;QACtB,YAAY,GAAG,IAAI,CAAC;QACpB,aAAa,GAAG,IAAI,CAAC;QACrB,IAAI,QAAQ,CAAC,IAAI;YAAE,QAAQ,CAAC,IAAI,EAAE,CAAC;QACnC,cAAc,GAAG,KAAK,CAAC;KAC1B,EACD,IAAI,CACP,CAAC;IACF,MAAM,CAAC,gBAAgB,CACnB,OAAO,EACP,CAAC,GAAG;QACA,IAAI,cAAc,IAAI,eAAe;YAAE,OAAO;QAE9C,eAAe,GAAG,IAAI,CAAC;QACvB,IAAI,QAAQ,CAAC,KAAK;YAAE,QAAQ,CAAC,KAAK,EAAE,CAAC;QACrC,eAAe,GAAG,KAAK,CAAC;KAC3B,EACD,IAAI,CACP,CAAC;IACF,MAAM,CAAC,gBAAgB,CACnB,kBAAkB,EAClB,CAAC,EAAoB;QACjB,qBAAqB,GAAG,IAAI,CAAC;QAC7B,QAAQ,CAAC,KAAK,GAAG,EAAE,CAAC;QAEpB,IAAI,QAAQ,CAAC,gBAAgB;YAAE,QAAQ,CAAC,gBAAgB,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC;KACrE,EACD,IAAI,CACP,CAAC;IACF,MAAM,CAAC,gBAAgB,CACnB,mBAAmB,EACnB,CAAC,EAAoB;QACjB,IAAI,CAAC,qBAAqB;YAAE,OAAO;QACnC,IAAI,QAAQ,CAAC,iBAAiB;YAAE,QAAQ,CAAC,iBAAiB,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC;KACvE,EACD,IAAI,CACP,CAAC;IACF,MAAM,CAAC,gBAAgB,CACnB,gBAAgB,EAChB,CAAC,EAAoB;QACjB,QAAQ,CAAC,KAAK,GAAG,EAAE,CAAC;QACpB,IAAI,CAAC,qBAAqB;YAAE,OAAO;QACnC,qBAAqB,GAAG,KAAK,CAAC;QAC9B,IAAI,QAAQ,CAAC,cAAc;YAAE,QAAQ,CAAC,cAAc,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC;KACjE,EACD,IAAI,CACP,CAAC;;;;IAKF,MAAM,CAAC,gBAAgB,CAAC,OAAO,EAAE,CAAC,EAAc;QAC5C,IAAI,qBAAqB;YAAE,OAAO;;;;;QAKlC,IAAI,EAAE,CAAC,SAAS,KAAK,uBAAuB;YAAE,OAAO;;QAGrD,IAAI,EAAE,CAAC,SAAS,KAAK,iBAAiB,EAAE;YACpC,EAAE,CAAC,cAAc,EAAE,CAAC;YACpB,EAAE,CAAC,eAAe,EAAE,CAAC;YACrB,OAAO;SACV;QAED,KAAK,CAAC,eAAe,CAAC,CAAC;KAC1B,CAAC,CAAC;IAEH,OAAO;QACH,iBAAiB,EAAE;YACf,MAAM,SAAS,GAAG,QAAQ,CAAC,IAAI,CAAC;YAChC,MAAM,UAAU,GAAG,QAAQ,CAAC,KAAK,CAAC;YAClC,QAAQ,CAAC,IAAI,GAAG,IAAI,CAAC;YACrB,QAAQ,CAAC,KAAK,GAAG,IAAI,CAAC;YACtB,QAAQ,CAAC,IAAI,EAAE,CAAC;YAChB,QAAQ,CAAC,KAAK,EAAE,CAAC;YACjB,QAAQ,CAAC,IAAI,GAAG,SAAS,CAAC;YAC1B,QAAQ,CAAC,KAAK,GAAG,UAAU,CAAC;SAC/B;QACD,IAAI,EAAE;YACF,IAAI,OAAO,QAAQ,CAAC,IAAI,KAAK,UAAU,EAAE;gBACrC,QAAQ,CAAC,IAAI,EAAE,CAAC;aACnB;SACJ;QACD,KAAK,EAAE;YACH,IAAI,OAAO,QAAQ,CAAC,KAAK,KAAK,UAAU,EAAE;gBACtC,QAAQ,CAAC,KAAK,EAAE,CAAC;aACpB;SACJ;QACD,QAAQ,EAAE;YACN,OAAO,iBAAiB,EAAE,KAAK,QAAQ,CAAC;SAC3C;QACD,QAAQ,EAAE,CAAC,KAAa;YACpB,IAAI,KAAK,EAAE;gBACP,QAAQ,CAAC,KAAK,GAAG,KAAK,CAAC;;;gBAGvB,IAAI,iBAAiB,EAAE,KAAK,QAAQ,IAAI,QAAQ,CAAC,MAAM,EAAE;oBACrD,QAAQ,CAAC,MAAM,EAAE,CAAC;iBACrB;aACJ;iBAAM;gBACH,QAAQ,CAAC,KAAK,GAAG,EAAE,CAAC;gBACpB,QAAQ,CAAC,YAAY,CAAC,YAAY,EAAE,EAAE,CAAC,CAAC;aAC3C;SACJ;QACD,YAAY,EAAE,CAAC,KAAa;YACxB,QAAQ,CAAC,YAAY,CAAC,YAAY,EAAE,SAAS,GAAG,KAAK,CAAC,CAAC;SAC1D;QACD,MAAM,EAAE,CAAC,CAAS,EAAE,CAAS;YACzB,QAAQ,CAAC,KAAK,CAAC,GAAG,GAAG,CAAC,GAAG,IAAI,CAAC;YAC9B,QAAQ,CAAC,KAAK,CAAC,IAAI,GAAG,CAAC,GAAG,IAAI,CAAC;SAClC;KACJ,CAAC;AACN,CAAC;AAED,SAAS,iBAAiB;IACtB,IAAI,CAAC,GAAG,QAAQ,CAAC,aAAa,CAAC;IAC/B,OAAO,CAAC,IAAI,CAAC,CAAC,UAAU,IAAI,CAAC,CAAC,UAAU,CAAC,aAAa,EAAE;QACpD,CAAC,GAAG,CAAC,CAAC,UAAU,CAAC,aAAa,CAAC;KAClC;IACD,OAAO,CAAC,CAAC;AACb,CAAC;SAEe,WAAW,CAAC,GAAkB;;IAC1C,IAAI,CAAC,GAAG;QAAE,OAAO,EAAE,CAAC;IACpB,IAAI,MAAc,CAAC;IACnB,IAAI,GAAG,CAAC,GAAG,KAAK,cAAc,EAAE;;;QAG5B,IAAI,GAAG,CAAC,MAAM,EAAE;YACZ,MAAM,GAAG,GAAG,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;SAChC;KACJ;IACD,MAAM,SAAG,MAAM,aAAN,MAAM,cAAN,MAAM,GAAI,GAAG,CAAC,GAAG,mCAAI,GAAG,CAAC,IAAI,CAAC;IACvC,IACI,8GAA8G,CAAC,IAAI,CAC/G,MAAM,CACT,EACH;QACE,MAAM,GAAG,EAAE,CAAC;KACf;IACD,OAAO,MAAM,CAAC;AAClB;;MClca,WAAW;IAQpB,YAAY,KAAmB;QANvB,iBAAY,GAAG,IAAI,CAAC;QACpB,WAAM,GAAG,KAAK,CAAC;QACf,gBAAW,GAAG,KAAK,CAAC;QAKxB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACnB,IAAI,CAAC,KAAK,EAAE,CAAC;KAChB;IAED,KAAK;QACD,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC;QAChB,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC;KACnB;IAED,cAAc;QACV,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;KACtB;IAED,OAAO;QACH,OAAO,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC;KACzB;IAED,OAAO;QACH,OAAO,IAAI,CAAC,KAAK,KAAK,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC;KAC/C;IAED,IAAI,CAAC,OAAoB;QACrB,IAAI,IAAI,CAAC,OAAO,EAAE,EAAE;YAChB,IAAI,QAAO,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,qBAAqB,CAAA,KAAK,UAAU,EAAE;gBACtD,OAAO,CAAC,qBAAqB,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;aAC/D;YACD,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC;YAClD,IAAI,CAAC,KAAK,IAAI,CAAC,CAAC;YAChB,IAAI,OAAO,IAAI,OAAO,OAAO,CAAC,oBAAoB,KAAK,UAAU,EAAE;gBAC/D,OAAO,CAAC,oBAAoB,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;aAC9D;YACD,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;SAC5B;KACJ;IACD,IAAI,CAAC,OAAoB;QACrB,IAAI,IAAI,CAAC,OAAO,EAAE,EAAE;YAChB,IAAI,QAAO,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,qBAAqB,CAAA,KAAK,UAAU,EAAE;gBACtD,OAAO,CAAC,qBAAqB,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;aAC/D;YACD,IAAI,CAAC,KAAK,IAAI,CAAC,CAAC;YAChB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,OAAO,CAAC,CAAC;YAC9C,IAAI,OAAO,IAAI,OAAO,OAAO,CAAC,oBAAoB,KAAK,UAAU,EAAE;gBAC/D,OAAO,CAAC,oBAAoB,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;aAC9D;YACD,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;SAC5B;KACJ;IACD,GAAG;QACC,IAAI,IAAI,CAAC,OAAO,EAAE,EAAE;YAChB,IAAI,CAAC,KAAK,IAAI,CAAC,CAAC;YAChB,IAAI,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC;SACpB;KACJ;;;;;IAKD,QAAQ,CAAC,OAAoB;QACzB,IAAI,CAAC,IAAI,CAAC,MAAM;YAAE,OAAO;QAEzB,IAAI,QAAO,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,qBAAqB,CAAA,KAAK,UAAU,EAAE;YACtD,OAAO,CAAC,qBAAqB,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,EAAE,UAAU,CAAC,CAAC;SACnE;;QAED,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,GAAG,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC;;QAEtE,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC;YACZ,KAAK,EAAE,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,EAAE,WAAW,EAAE,KAAK,EAAE,CAAC;YAC5D,SAAS,EAAE,IAAI,CAAC,KAAK,CAAC,SAAS;SAClC,CAAC,CAAC;QAEH,IAAI,CAAC,KAAK,EAAE,CAAC;;;QAGb,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,IAAI,CAAC,YAAY,EAAE;YACvC,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC;SACtB;QACD,IAAI,OAAO,IAAI,OAAO,OAAO,CAAC,oBAAoB,KAAK,UAAU,EAAE;YAC/D,OAAO,CAAC,oBAAoB,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,EAAE,UAAU,CAAC,CAAC;SAClE;QACD,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;KAC5B;IAED,mBAAmB,CAAC,OAAoB;QACpC,IAAI,IAAI,CAAC,WAAW,EAAE;YAClB,IAAI,CAAC,GAAG,EAAE,CAAC;SACd;QACD,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;QACvB,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;KAC3B;;;;;;IAOD,IAAI;QACA,OAAO;YACH,KAAK,EAAE,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,EAAE,WAAW,EAAE,KAAK,EAAE,CAAC;YAC5D,SAAS,EAAE,IAAI,CAAC,KAAK,CAAC,SAAS;SAClC,CAAC;KACL;;;;;;IAMD,OAAO,CAAC,KAAiB,EAAE,OAAoB;QAC3C,MAAM,cAAc,GAAG,IAAI,CAAC,KAAK,CAAC,2BAA2B,CAAC;QAC9D,IAAI,OAAO,OAAO,CAAC,2BAA2B,KAAK,WAAW,EAAE;YAC5D,IAAI,CAAC,KAAK,CAAC,2BAA2B;gBAClC,OAAO,CAAC,2BAA2B,CAAC;SAC3C;;QAGD,MAAM,CAAC,IAAI,CAAC,KAAK,EAAE,KAAK,GAAG,KAAK,CAAC,KAAK,GAAG,EAAE,EAAE;YACzC,GAAG,OAAO;YACV,MAAM,EAAE,OAAO;YACf,IAAI,EAAE,MAAM;YACZ,aAAa,EAAE,YAAY;YAC3B,aAAa,EAAE,OAAO;YACtB,UAAU,EAAE,KAAK;SACpB,CAAC,CAAC;;QAGH,IAAI,CAAC,KAAK,CAAC,SAAS,GAAG,KAAK,GAAG,KAAK,CAAC,SAAS,GAAG,EAAE,MAAM,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC;QAEtE,IAAI,CAAC,KAAK,CAAC,2BAA2B,GAAG,cAAc,CAAC;KAC3D;;;AC1JE,MAAM,OAAO,GAAG;IACnB,EAAE,EAAE;QACA,4BAA4B,EAAE,WAAW;QACzC,0BAA0B,EAAE,SAAS;QACrC,wBAAwB,EAAE,eAAe;QACzC,0BAA0B,EAAE,oBAAoB;QAChD,0BAA0B,EAAE,SAAS;QACrC,wBAAwB,EAAE,eAAe;QACzC,2BAA2B,EAAE,mBAAmB;QAChD,cAAc,EAAE,MAAM;QACtB,iCAAiC,EAAE,yBAAyB;QAC5D,cAAc,EAAE,MAAM;KACzB;IACD,EAAE,EAAE;QACA,4BAA4B,EAAE,MAAM;QACpC,0BAA0B,EAAE,YAAY;QACxC,wBAAwB,EAAE,cAAc;QACxC,0BAA0B,EAAE,0BAA0B;QACtD,0BAA0B,EAAE,SAAS;QACrC,wBAAwB,EAAE,uBAAuB;QACjD,2BAA2B,EAAE,iBAAiB;QAC9C,cAAc,EAAE,SAAS;QACzB,iCAAiC,EAAE,gCAAgC;QACnE,cAAc,EAAE,OAAO;KAC1B;IACD,EAAE,EAAE;QACA,4BAA4B,EAAE,YAAY;QAC1C,0BAA0B,EAAE,SAAS;QACrC,wBAAwB,EAAE,wBAAwB;QAClD,0BAA0B,EAAE,oBAAoB;QAChD,0BAA0B,EAAE,WAAW;QACvC,wBAAwB,EAAE,qBAAqB;QAC/C,2BAA2B,EAAE,gCAAgC;QAC7D,cAAc,EAAE,aAAa;QAC7B,iCAAiC,EAAE,+BAA+B;QAClE,cAAc,EAAE,YAAY;KAC/B;IACD,EAAE,EAAE;QACA,4BAA4B,EAAE,aAAa;QAC3C,0BAA0B,EAAE,SAAS;QACrC,wBAAwB,EAAE,mBAAmB;QAC7C,0BAA0B,EAAE,0BAA0B;QACtD,0BAA0B,EAAE,aAAa;QACzC,wBAAwB,EAAE,kBAAkB;QAC5C,2BAA2B,EAAE,wBAAwB;QACrD,cAAc,EAAE,UAAU;QAC1B,iCAAiC,EAAE,kCAAkC;QACrE,cAAc,EAAE,QAAQ;KAC3B;IACD,EAAE,EAAE;QACA,4BAA4B,EAAE,WAAW;QACzC,0BAA0B,EAAE,UAAU;QACtC,wBAAwB,EAAE,gBAAgB;QAC1C,0BAA0B,EAAE,oBAAoB;QAChD,0BAA0B,EAAE,UAAU;QACtC,wBAAwB,EAAE,gBAAgB;QAC1C,2BAA2B,EAAE,wBAAwB;QACrD,cAAc,EAAE,SAAS;QACzB,iCAAiC,EAAE,0BAA0B;QAC7D,cAAc,EAAE,UAAU;KAC7B;IACD,EAAE,EAAE;QACA,4BAA4B,EAAE,OAAO;QACrC,0BAA0B,EAAE,QAAQ;QACpC,wBAAwB,EAAE,aAAa;QACvC,0BAA0B,EAAE,iBAAiB;QAC7C,0BAA0B,EAAE,MAAM;QAClC,wBAAwB,EAAE,WAAW;QACrC,2BAA2B,EAAE,iBAAiB;QAC9C,cAAc,EAAE,eAAe;QAC/B,iCAAiC,EAAE,0BAA0B;QAC7D,cAAc,EAAE,eAAe;KAClC;IACD,EAAE,EAAE;QACA,4BAA4B,EAAE,WAAW;QACzC,0BAA0B,EAAE,UAAU;QACtC,wBAAwB,EAAE,kBAAkB;QAC5C,0BAA0B,EAAE,yBAAyB;QACrD,0BAA0B,EAAE,WAAW;QACvC,wBAAwB,EAAE,kBAAkB;QAC5C,2BAA2B,EAAE,+BAA+B;QAC5D,cAAc,EAAE,UAAU;QAC1B,iCAAiC,EAC7B,qCAAqC;QACzC,cAAc,EAAE,SAAS;KAC5B;IACD,EAAE,EAAE;QACA,4BAA4B,EAAE,UAAU;QACxC,0BAA0B,EAAE,SAAS;QACrC,wBAAwB,EAAE,gBAAgB;QAC1C,0BAA0B,EAAE,2BAA2B;QACvD,0BAA0B,EAAE,UAAU;QACtC,wBAAwB,EAAE,gBAAgB;QAC1C,2BAA2B,EAAE,qBAAqB;QAClD,cAAc,EAAE,QAAQ;QACxB,iCAAiC,EAC7B,yCAAyC;QAC7C,cAAc,EAAE,SAAS;KAC5B;IACD,EAAE,EAAE;QACA,4BAA4B,EAAE,IAAI;QAClC,0BAA0B,EAAE,MAAM;QAClC,wBAAwB,EAAE,QAAQ;QAClC,0BAA0B,EAAE,cAAc;QAC1C,0BAA0B,EAAE,IAAI;QAChC,wBAAwB,EAAE,MAAM;QAChC,2BAA2B,EAAE,aAAa;QAC1C,cAAc,EAAE,MAAM;QACtB,iCAAiC,EAAE,cAAc;QACjD,cAAc,EAAE,MAAM;KACzB;IACD,EAAE,EAAE;QACA,4BAA4B,EAAE,SAAS;QACvC,0BAA0B,EAAE,WAAW;QACvC,wBAAwB,EAAE,gBAAgB;QAC1C,0BAA0B,EAAE,oBAAoB;QAChD,0BAA0B,EAAE,YAAY;QACxC,wBAAwB,EAAE,iBAAiB;QAC3C,2BAA2B,EAAE,mBAAmB;QAChD,cAAc,EAAE,UAAU;QAC1B,iCAAiC,EAAE,+BAA+B;QAClE,cAAc,EAAE,QAAQ;KAC3B;IACD,EAAE,EAAE;QACA,4BAA4B,EAAE,SAAS;QACvC,0BAA0B,EAAE,SAAS;QACrC,wBAAwB,EAAE,iBAAiB;QAC3C,0BAA0B,EAAE,8BAA8B;QAC1D,0BAA0B,EAAE,UAAU;QACtC,wBAAwB,EAAE,iBAAiB;QAC3C,2BAA2B,EAAE,4BAA4B;QACzD,cAAc,EAAE,cAAc;QAC9B,iCAAiC,EAAE,oCAAoC;QACvE,cAAc,EAAE,cAAc;KACjC;CACJ;;ACvID;AAGO,MAAM,IAAI,GAmBb,EAAE,CAAC;AAEP,IAAI,CAAC,MAAM,GAAG,UAAU,KAAa,EAAE,CAAS,EAAE,OAAO;;IACrD,OAAO,GAAG,OAAO,aAAP,OAAO,cAAP,OAAO,GAAI,EAAE,CAAC;IACxB,OAAO,CAAC,IAAI,SAAG,OAAO,CAAC,IAAI,mCAAI,UAAU,CAAC;IAC1C,MAAM,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;IAC7C,MAAM,KAAK,GAAG,OAAO,CAAC,IAAI,KAAK,SAAS,GAAG,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,SAAS,CAAC;IAC1E,IAAI,IAAI,GACJ,OAAO,CAAC,IAAI,KAAK,SAAS;UACpB,IAAI,CAAC,wBAAwB,CAAC,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;UAC1D,IAAI,CAAC,yBAAyB,CAAC,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;IAEtE,IAAI,MAAM,CAAC;IACX,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC;QAAE,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;IACrE,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC;QAAE,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;IAC1E,IAAI,CAAC,MAAM,EAAE;QACT,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;QAC/B,IAAI,CAAC,MAAM;YAAE,MAAM,GAAG,CAAC,CAAC;QACxB,IAAI,OAAO,CAAC,IAAI,KAAK,SAAS,EAAE;YAC5B,IAAI,GAAG,IAAI,CAAC,wBAAwB,CAAC,OAAO,CACxC,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,KAAK,CAAC,CACrC,CAAC;SACL;aAAM;YACH,IAAI,GAAG,IAAI,CAAC,yBAAyB,CAAC,OAAO,CACzC,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,KAAK,CAAC,CACtC,CAAC;SACL;KACJ;IACD,OAAO,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,IAAI,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;AAC3D,CAAC,CAAC;AAEF;;;;;;;;AAQA,IAAI,CAAC,KAAK,GAAG,UACT,MAAkE,EAClE,OAAmC;IAEnC,IAAI,MAAM,IAAI,OAAO,EAAE;QACnB,MAAM,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC;QACjC,IAAI,CAAC,MAAM,GAAG,MAAgB,CAAC;QAE/B,IAAI,CAAC,OAAO,CAAC,MAAgB,CAAC,GAAG;YAC7B,GAAG,IAAI,CAAC,OAAO,CAAC,MAAgB,CAAC;YACjC,GAAG,OAAO;SACb,CAAC;QACF,IAAI,CAAC,MAAM,GAAG,WAAW,CAAC;KAC7B;SAAM,IAAI,MAAM,IAAI,CAAC,OAAO,EAAE;QAC3B,MAAM,CAAC,IAAI,CACP,MAA2D,CAC9D,CAAC,OAAO,CAAC,CAAC,CAAC,KAAK,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;KAC9C;AACL,CAAC,CAAC;AAEF;AACA,MAAM,CAAC,cAAc,CAAC,IAAI,EAAE,QAAQ,EAAE;IAClC,GAAG,CAAC,MAAM;QACN,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;QACtB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;QACrB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;KACzB;IACD,GAAG;;;;QAGC,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE;;YAEf,IAAI,CAAC,OAAO,SAAG,SAAS,aAAT,SAAS,uBAAT,SAAS,CAAE,QAAQ,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,oCAAK,IAAI,CAAC;SAC1D;QACD,OAAO,IAAI,CAAC,OAAO,CAAC;KACvB;CACJ,CAAC,CAAC;AAEH,MAAM,CAAC,cAAc,CAAC,IAAI,EAAE,SAAS,EAAE;IACnC,GAAG;QACC,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;YAChB,IAAI,CAAC,eAAe,GAAG,IAAI,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE;gBAC9C,IAAI,EAAE,SAAS;aAClB,CAAC,CAAC;YACH,IAAI,CAAC,+BAA+B,GAAG,IAAI,CAAC,eAAe,CAAC,eAAe,EAAE,CAAC,gBAAgB,CAAC;YAC/F,IAAI,CAAC,QAAQ,GAAG,IAAI,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,MAAM,EAAE;gBAC9C,IAAI,EAAE,SAAS;aAClB,CAAC,CAAC;YACH,IAAI,CAAC,wBAAwB,GAAG,IAAI,CAAC,QAAQ,CAAC,eAAe,EAAE,CAAC,gBAAgB,CAAC;;SAEpF;QACD,OAAO,IAAI,CAAC,QAAQ,CAAC;KACxB;CACJ,CAAC,CAAC;AAEH,MAAM,CAAC,cAAc,CAAC,IAAI,EAAE,UAAU,EAAE;IACpC,GAAG;QACC,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;YACjB,IAAI,CAAC,gBAAgB,GAAG,IAAI,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE;gBAC/C,IAAI,EAAE,UAAU;aACnB,CAAC,CAAC;YACH,IAAI,CAAC,gCAAgC,GAAG,IAAI,CAAC,gBAAgB,CAAC,eAAe,EAAE,CAAC,gBAAgB,CAAC;YACjG,IAAI,CAAC,SAAS,GAAG,IAAI,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,MAAM,EAAE;gBAC/C,IAAI,EAAE,UAAU;aACnB,CAAC,CAAC;YACH,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC,QAAQ,CAAC,eAAe,EAAE,CAAC,gBAAgB,CAAC;SACrF;QACD,OAAO,IAAI,CAAC,SAAS,CAAC;KACzB;CACJ,CAAC,CAAC;AAEH,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;SAEP,QAAQ,CAAC,CAAS;IAC9B,MAAM,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;IAE7C,IAAI,MAAM,GAAG,EAAE,CAAC;;IAGhB,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC;QAAE,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;;IAErE,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC;QAAE,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;;IAE1E,IAAI,CAAC,MAAM;QAAE,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;;IAE5C,IAAI,CAAC,MAAM;QAAE,MAAM,GAAG,CAAC,CAAC;IAExB,OAAO,MAAM,CAAC;AAClB;;AClJA;;;SAGgB,IAAI,CAAC,KAAmB,EAAE,KAAsB;IAC5D,IAAI,OAAO,KAAK,KAAK,QAAQ;QAAE,OAAO,EAAE,CAAC;IAEzC,MAAM,MAAM,GAAG,EAAE,CAAC;IAClB,MAAM,UAAU,GAAG,KAAK,CAAC,UAAU,CAAC;IAEpC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,EAAE,CAAC,EAAE,EAAE;QACjC,MAAM,KAAK,GAAG,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC;;;;;;;;;;QAUpC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,EAAE,CAAC,EAAE,EAAE;YACjC,IAAI,QAAQ,GAAG,EAAE,CAAC;YAClB,KAAK,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,EAAE;gBAC7B,IAAI,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,SAAS,KAAK,KAAK,EAAE;oBACjC,QAAQ,IAAI,KAAK,CAAC,YAAY,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC;oBACrD,OAAO,CAAC,GAAG,CACP,YACI,CAAC,GAAG,CACR,KAAK,CAAC,QAAQ,QAAQ,QAAQ,KAAK,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,CACxD,CAAC;iBACL;aACJ;YACD,IACI,CAAC,OAAO,KAAK,KAAK,QAAQ,IAAI,KAAK,KAAK,QAAQ;iBAC/C,OAAO,KAAK,KAAK,QAAQ,IAAI,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,EACrD;gBACE,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;aAC7C;SACJ;KACJ;IACD,OAAO,MAAM,CAAC;AAClB;;SCtBgB,uBAAuB,CAAC,KAAmB;IACvD,KAAK;SACA,QAAQ,CAAC,yBAAyB,CAAC,KAAK,CAAC,CAAC;SAC1C,OAAO,CAAC,CAAC,CAAc;QACpB,CAAC,CAAC,YAAY,GAAG,KAAK,CAAC;KAC1B,CAAC,CAAC;AACX,CAAC;SAEe,gBAAgB,CAAC,KAAmB,EAAE,CAAS;;IAE3D,KAAK,CAAC,WAAW,CAAC,yBAAyB,CAAC,KAAK,CAAC,CAAC,CAAC;IAEpD,MAAM,KAAK,GAAG,EAAE,CAAC;IACjB,KAAK,MAAM,CAAC,IAAI,CAAC,EAAE;QACf,KAAK,CAAC,IAAI,CAAC,IAAI,WAAW,CAAC,CAAC,EAAE,EAAE,YAAY,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC;KAC1D;IAED,MAAM,MAAM,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;IACxC,MAAM,CAAC,MAAM,CAAC,gBAAgB,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;AAClD,CAAC;AAED;;;;;;;;SAQgB,QAAQ,CACpB,SAA2B,EAC3B,UAA0D,EAC1D,OAA6B;;IAE7B,WAAW,CAAC,SAAS,CAAC,CAAC;IAEvB,IAAI,UAAU,KAAK,QAAQ,EAAE;QACzB,SAAS,CAAC,KAAK,CAAC,WAAW,CAAC,eAAe,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC;QAC9D,SAAS,CAAC,UAAU,OAAC,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,IAAI,mCAAI,MAAM,CAAC,CAAC;QAC9C,OAAO,IAAI,CAAC;KACf;IACD,MAAM,OAAO,GAAG,gBAAgB,CAAC,SAAS,CAAC,KAAK,EAAE;QAC9C,cAAc,EAAE,UAAU,KAAK,wBAAwB;KAC1D,CAAC,CAAC;IACH,IAAI,CAAC,OAAO;QAAE,OAAO,KAAK,CAAC;IAE3B,IAAI,OAAO,KAAK,KAAK,IAAI,OAAO,KAAK,KAAK,EAAE;QACxC,SAAS,CAAC,KAAK,CAAC,WAAW,CAAC,eAAe,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC;QAC9D,MAAM,CAAC,SAAS,CAAC,KAAK,EAAE,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE;YACtC,IAAI,EAAE,SAAS,CAAC,IAAI;SACvB,CAAC,CAAC;KACN;SAAM;;;QAGH,SAAS,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;;QAE7B,MAAM,KAAK,GAAG,WAAW,CACrB,OAAO,EACP,MAAM,EACN,IAAI,EACJ,SAAS,CAAC,OAAO,CAAC,MAAM,CAC3B,CAAC;QACF,IAAI,KAAK,EAAE;YACP,aAAa,CAAC,SAAS,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;SACzC;aAAM;YACH,eAAe,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;gBACvC,CAAC,CAAC,OAAO,GAAG,IAAI,CAAC;aACpB,CAAC,CAAC;SACN;KACJ;IACD,SAAS,CAAC,QAAQ,EAAE,CAAC;IACrB,SAAS,CAAC,KAAK,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC;IACxC,OAAO,IAAI,CAAC;AAChB,CAAC;AAED,SAAS,gBAAgB,CAAC,SAA2B;IACjD,MAAM,KAAK,GAAG,SAAS,CAAC,KAAK,CAAC;IAC9B,KAAK,CAAC,WAAW,CAAC,yBAAyB,CAAC,KAAK,CAAC,CAAC,CAAC;IACpD,MAAM,OAAO,GAAG,gBAAgB,CAAC,KAAK,CAAC,CAAC;IACxC,MAAM,WAAW,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC;IACrC,IAAI,WAAW,CAAC,MAAM,KAAK,CAAC,EAAE;QAC1B,WAAW,CAAC,SAAS,CAAC,CAAC;QACvB,eAAe,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;YACvC,CAAC,CAAC,OAAO,GAAG,IAAI,CAAC;SACpB,CAAC,CAAC;KACN;SAAM;QACH,MAAM,KAAK,GAAG,SAAS,CAAC,eAAe,GAAG,WAAW,CAAC,MAAM,CAAC;QAC7D,MAAM,CAAC,GAAG,OAAO,CAAC,MAAM,GAAG,WAAW,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC;QAC3D,IAAI,CAAC,KAAK,CAAC,EAAE;YACT,gBAAgB,CACZ,SAAS,CAAC,KAAK,EACf,WAAW,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,CACrC,CAAC;SACL;QACD,oBAAoB,CAChB,SAAS,EACT,WAAW,CAAC,KAAK,CAAC,CAAC,KAAK,EACxB,WAAW,CAAC,MAAM,GAAG,CAAC,CACzB,CAAC;KACL;IACD,aAAa,CAAC,SAAS,CAAC,CAAC;IACzB,OAAO,IAAI,CAAC;AAChB,CAAC;AAED,SAAS,cAAc,CAAC,SAA2B;IAC/C,SAAS,CAAC,eAAe,IAAI,CAAC,CAAC;;;IAG/B,gBAAgB,CAAC,SAAS,CAAC,CAAC;IAC5B,OAAO,KAAK,CAAC;AACjB,CAAC;AAED,SAAS,kBAAkB,CAAC,SAA2B;IACnD,SAAS,CAAC,eAAe,IAAI,CAAC,CAAC;IAC/B,IAAI,SAAS,CAAC,eAAe,GAAG,CAAC,EAAE;;;;QAI/B,SAAS,CAAC,KAAK,CAAC,WAAW,CAAC,yBAAyB,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC;QACxE,MAAM,WAAW,GAAG,OAAO,CAAC,gBAAgB,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC;QAC/D,SAAS,CAAC,eAAe,GAAG,WAAW,CAAC,MAAM,GAAG,CAAC,CAAC;KACtD;IACD,gBAAgB,CAAC,SAAS,CAAC,CAAC;IAC5B,OAAO,KAAK,CAAC;AACjB,CAAC;AAED,SAAS,aAAa,CAAC,KAAmB,EAAE,KAAa;IACrD,IAAI,SAAS,GAAG,KAAK,CAAC,WAAW,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC,CAAC;IAE1D,IAAI,KAAK,EAAE;;QAEP,MAAM,YAAY,GAAG,EAAE,CAAC;QACxB,KAAK,CAAC,OAAO,CAAC,CAAC,IAAI,KACf,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC;YACpB,IAAI,CAAC,CAAC,IAAI,KAAK,aAAa;gBAAE,YAAY,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;SACtD,CAAC,CACL,CAAC;;QAGF,MAAM,MAAM,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;QACxC,MAAM,CAAC,MAAM,CAAC,gBAAgB,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;QAC9C,SAAS,GAAG,IAAI,CAAC;;QAGjB,IAAI,YAAY,CAAC,MAAM,GAAG,CAAC,EAAE;YACzB,MAAM,MAAM,GAAG,KAAK,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC;YAC/C,OAAO,CAAC,MAAM,CAAC,MAAM,IAAI,CAAC,CAAC,CAAC;YAC5B,KAAK,CAAC,YAAY,CAAC,MAAM,GAAG,CAAC,EAAE,MAAM,CAAC,CAAC;SAC1C;aAAM;;YAEH,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;SAC5D;KACJ;IAED,IAAI,SAAS,EAAE;;QAEX,gBAAgB,CAAC,KAAK,CAAC,CAAC;KAC3B;AACL,CAAC;AAEDC,UAAe,CACX;IACI,QAAQ,EAAE,QAAQ;IAClB,cAAc,EAAE,cAAc;IAC9B,kBAAkB,EAAE,kBAAkB;CACzC,EACD,EAAE,MAAM,EAAE,WAAW,EAAE,QAAQ,EAAE,cAAc,EAAE,CACpD;;SClLe,aAAa,CACzB,aAA4C,EAC5C,MAAc,EACd,KAAoB;IAEpB,MAAM,OAAO,GAAwB;QACjC,GAAG,aAAa;QAChB,kBAAkB,EAAE,EAAE;QACtB,wBAAwB,EAAE;YACtB,GAAG,aAAa,CAAC,wBAAwB;YACzC,MAAM,EAAE,MAAM;SACjB;KACJ,CAAC;IACF,OAAO,MAAM,GAAG,mBAAmB,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;AACxD,CAAC;AAED;;;;;;;AAQA;AACAA,UAAe,CACX;IACI,KAAK,EAAE,CACH,SAA2B,EAC3B,KAAkB,EAClB,OAAsC;QAEtC,OAAO,KAAK,CAAC,SAAS,EAAE,KAAK,EAAE,OAAO,CAAC,CAAC;KAC3C;CACJ,EACD,EAAE,MAAM,EAAE,WAAW,EAAE,QAAQ,EAAE,QAAQ,EAAE,CAC9C,CAAC;AAEF,SAAS,KAAK,CACV,SAA2B,EAC3B,KAAkB,EAClB,YAA2C;IAE3C,YAAY,GAAG,YAAY,aAAZ,YAAY,cAAZ,YAAY,GAAI,EAAE,gBAAgB,EAAE,KAAK,EAAE,CAAC;IAC3D,MAAM,KAAK,GAAG,SAAS,CAAC,KAAK,CAAC;IAC9B,SAAS,QAAQ,CAAC,SAA2B,EAAE,KAAkB;QAC7D,IAAI,MAAM,GAAG,IAAI,CAAC;QAClB,QAAQ,KAAK;YACT,KAAK,KAAK;gBACN,MAAM,GAAG,KAAK,CAAC,IAAI,CAAC;gBACpB,MAAM;YACV,KAAK,WAAW;gBACZ,MAAM,GAAG,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;gBACzC,MAAM;YACV,KAAK,MAAM,EAAE;gBACT,MAAM,GAAG,KAAK,CAAC,QAAQ,CACnB,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,YAAY,CAAC,EACrD,KAAK,CAAC,QAAQ,CACjB,CAAC;gBACF,MAAM;aACT;YACD,KAAK,OAAO,EAAE;gBACV,MAAM,GAAG,KAAK,CAAC,QAAQ,CACnB,KAAK,CAAC,QAAQ,EACd,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,WAAW,CAAC,CACvD,CAAC;gBACF,MAAM;aACT;YACD,KAAK,OAAO;gBACR,MAAM,GAAG,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,gBAAgB,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC;gBAChE,MAAM;YACV,KAAK,QAAQ,EAAE;gBACX,MAAM,MAAM,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC;gBAC/C,IAAI,MAAM,IAAI,MAAM,CAAC,IAAI,KAAK,MAAM,EAAE;oBAClC,MAAM,GAAG,MAAM,CAAC;iBACnB;gBACD,MAAM;aACT;SAOJ;QACD,OAAO,MAAM,CAAC;KACjB;IACD,SAAS,eAAe,CAAC,KAAa;QAClC,IAAI,MAAM,GAAG,EAAE,CAAC;QAChB,QAAQ,KAAK;YACT,KAAK,KAAK;gBACN,OAAO,CAAC,GAAG,CAAC,oCAAoC,CAAC,CAAC;gBAClD,MAAM;YACV,KAAK,WAAW;gBACZ,MAAM,GAAG,cAAc,CAAC;gBACxB,MAAM;YACV,KAAK,MAAM;gBACP,MAAM,GAAG,UAAU,CAAC;gBACpB,MAAM;YACV,KAAK,OAAO;gBACR,MAAM,GAAG,QAAQ,CAAC;gBAClB,MAAM;YACV,KAAK,OAAO;gBACR,OAAO,CAAC,GAAG,CAAC,sCAAsC,CAAC,CAAC;gBACpD,MAAM;YACV,KAAK,QAAQ;gBACT,MAAM,GAAG,WAAW,CAAC;gBACrB,MAAM;YACV;gBACI,OAAO,CAAC,GAAG,CAAC,+BAA+B,GAAG,KAAK,GAAG,GAAG,CAAC,CAAC;gBAC3D,MAAM;SACb;QACD,OAAO,MAAM,CAAC;KACjB;IACD,MAAM,KAAK,GAAG,QAAQ,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;IACzC,IAAI,KAAK,KAAK,IAAI,EAAE;QAChB,SAAS,CAAC,OAAO,CAAC,SAAS,CAAC,eAAe,CAAC,KAAK,CAAC,EAAE,SAAS,CAAC,OAAO,CAAC,CAAC;QACvE,OAAO,KAAK,CAAC;KAChB;IACD,MAAM,OAAO,GAAG,EAAE,GAAG,SAAS,CAAC,OAAO,EAAE,CAAC;IACzC,IAAI,YAAY,CAAC,gBAAgB,IAAI,OAAO,CAAC,YAAY,KAAK,QAAQ,EAAE;QACpE,OAAO,CAAC,kBAAkB;YACtB,MAAM,CAAC,KAAK,CAAC,IAAI,OAAO,CAAC,iBAAiB,KAAK,KAAK;kBAC9C,WAAW;kBACX,MAAM,CAAC;KACpB;IACD,MAAM,IAAI,GAAG,mBAAmB,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;IACjD,IAAI,YAAY,CAAC,gBAAgB,EAAE;QAC/B,MAAM,CAAC,UAAU,CAAC,CAAC,kBAAkB,GAAG,SAAS,CAAC;QAClD,MAAM,CAAC,SAAS,EAAE,EAAE,eAAe,EAAE,IAAI,EAAE,CAAC,CAAC;QAC7C,IAAI,SAAS,CAAC,OAAO,CAAC,aAAa,EAAE;YACjC,SAAS,CAAC,OAAO,CAAC,aAAa,CAC3B,SAAS,CAAC,KAAK,EACf,IAAI,EACJ,SAAS,CAAC,OAAO,CACpB,CAAC;SACL;KACJ;SAAM;QACH,IAAI,SAAS,CAAC,OAAO,CAAC,SAAS,EAAE;YAC7B,SAAS,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;SAC9C;KACJ;IAED,OAAO,KAAK,CAAC;AACjB,CAAC;SAEe,gBAAgB,CAC5B,IAAY,EACZ,MAAkC;IAElC,IAAI,CAAC,MAAM,IAAI,MAAM,IAAI,MAAM,CAAC,UAAU,CAAC,EAAE;QACzC,MAAM,GAAG,MAAM,CAAC,UAAU,CAAC,CAAC,MAAM,CAAC;KACtC;IACD,MAAM,GAAG,MAAM,aAAN,MAAM,cAAN,MAAM,GAAI,EAAE,CAAC;IAEtB,IAAI,CAAC,MAAM,CAAC,YAAY,IAAI,MAAM,CAAC,YAAY,KAAK,OAAO,EAAE;;;QAGzD,MAAM,SAAS,GAAG,IAAI,wBAAwB,CAAC,IAAI,CAAC,CAAC;QACrD,IAAI,MAAM,EAAE;YACR,MAAM,CAAC,eAAe,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;SAC3C;aAAM;YACH,OAAO,CAAC,GAAG,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;SAChC;KACJ;SAAM,IAAI,MAAM,CAAC,YAAY,KAAK,QAAQ,EAAE;QACzC,IAAI,CAAC,MAAM,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,EAAE;YAC3B,OAAO,CAAC,IAAI,CACR,+DAA+D,CAClE,CAAC;SACL;aAAM;YACH,MAAM,KAAK,GAAG,IAAI,MAAM,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,EAAE,UAAU,EAAE,YAAY,EAAE,CAAC,CAAC;YACpE,MAAM,MAAM,GAAG;gBACX,YAAY,EAAE,KAAK;gBACnB,OAAO,EAAE,MAAM,CAAC,iBAAiB;gBACjC,MAAM,EAAE;oBACJ,KAAK;oBACL,MAAM;oBACN,OAAO;oBACP,KAAK;oBACL,QAAQ;oBACR,QAAQ;oBACR,UAAU;oBACV,OAAO;oBACP,MAAM;oBACN,QAAQ;oBACR,SAAS;iBACZ,CAAC,QAAQ,CAAC,MAAM,CAAC,iBAAiB,CAAC;sBAC9B,QAAQ;sBACR,UAAU;;gBAEhB,IAAI,EAAE,IAAI;gBACV,QAAQ,EAAE,MAAM;aAEnB,CAAC;;YAEF,KAAK,CAAC,gBAAgB,CAAC,MAAM,EAAE,UAAU,GAAG,EAAE,IAAI;gBAC9C,IAAI,GAAG,EAAE;oBACL,OAAO,CAAC,IAAI,CACR,iCAAiC,EACjC,GAAG,EACH,GAAG,CAAC,KAAK,CACZ,CAAC;;iBAEL;qBAAM,IAAI,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,WAAW,EAAE;oBAC1B,MAAM,UAAU,GAAG,IAAI,UAAU,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;oBACpD,MAAM,IAAI,GAAG,IAAI,IAAI,CAAC,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE;wBACvC,IAAI,EAAE,YAAY;qBACrB,CAAC,CAAC;oBACH,MAAM,GAAG,GAAG,GAAG,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;oBAEtC,MAAM,YAAY,GAAG,IAAI,KAAK,CAAC,GAAG,CAAC,CAAC;oBACpC,YAAY,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,CAAC,GAAG,KAAK,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;iBACxD;qBAAM;oBACH,OAAO,CAAC,GAAG,CAAC,2BAA2B,GAAG,IAAI,CAAC,CAAC;iBACnD;aACJ,CAAC,CAAC;;SAGN;KACJ;SAAM,IAAI,MAAM,CAAC,YAAY,KAAK,QAAQ,EAAE;QACzC,OAAO,CAAC,IAAI,CACR,mEAAmE,CACtE,CAAC;;;;;;;;;;;;;;;;;;;;;KAsBL;AACL;;ACvPA;;;;AAIA,SAAS,YAAY,CAAC,IAAU;IAC5B,IAAI,MAAc,CAAC;IACnB,IAAI,IAAI,CAAC,UAAU,KAAK,MAAM,EAAE;QAC5B,MAAM,GAAG;YACL,OAAO,EAAE,WAAW;YACpB,SAAS,EAAE,OAAO;YAClB,IAAI,EAAE,aAAa;YACnB,IAAI,EAAE,YAAY;YAClB,GAAG,EAAE,UAAU;SAClB,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;KACvB;SAAM,IAAI,IAAI,CAAC,MAAM,CAAC,IAAI,KAAK,SAAS,EAAE;QACvC,IAAI,IAAI,CAAC,UAAU,KAAK,OAAO,EAAE;YAC7B,OAAO,WAAW,CAAC;SACtB;aAAM,IAAI,IAAI,CAAC,UAAU,KAAK,OAAO,EAAE;YACpC,OAAO,aAAa,CAAC;SACxB;KACJ;SAAM,IAAI,IAAI,CAAC,MAAM,CAAC,IAAI,KAAK,MAAM,EAAE;QACpC,IAAI,IAAI,CAAC,UAAU,KAAK,OAAO,EAAE;YAC7B,MAAM,GAAG,OAAO,CAAC;SACpB;KACJ;SAAM,IAAI,IAAI,CAAC,UAAU,KAAK,aAAa,EAAE;QAC1C,MAAM,GAAG,aAAa,CAAC;KAC1B;SAAM,IAAI,IAAI,CAAC,UAAU,KAAK,WAAW,EAAE;QACxC,MAAM,GAAG,WAAW,CAAC;KACxB;IAED,IAAI,CAAC,MAAM,EAAE;QACT,OAAO,CAAC,GAAG,CAAC,sBAAsB,CAAC,CAAC;KACvC;IACD,OAAO,MAAM,aAAN,MAAM,cAAN,MAAM,GAAI,QAAQ,CAAC;AAC9B,CAAC;AAED;;;;;;SAMgB,mBAAmB,CAC/B,SAA2B,EAC3B,MAAc,EACd,gBAAwB,EACxB,KAAa;;;IAGb,IAAI,QAAQ,GAAG,EAAE,CAAC;;IAGlB,IAAI,MAAM,KAAK,OAAO,EAAE;;;QAGpB,MAAA,SAAS,CAAC,UAAU,0CAAE,IAAI,GAAG,KAAK,CAAC,CAAC,GAAG,KAAK,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE;;QAE/D,SAAS,CAAC,oBAAoB,EAAE,CAAC;KACpC;SAAM,IAAI,MAAM,KAAK,QAAQ,EAAE;QAC5B,QAAQ,GAAG,aAAa,CAAC,SAAS,CAAC,OAAO,EAAE,WAAW,EAAE,KAAK,CAAC,CAAC;;KAEnE;SAAM,IAAI,MAAM,KAAK,OAAO,IAAI,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE;;QAElD,QAAQ;YACJ,2BAA2B,CAAC,SAAS,CAAC,KAAK,EAAE,gBAAgB,CAAC;iBAC7D,SAAS,CAAC,KAAK,CAAC,oBAAoB,GAAG,EAAE,GAAG,YAAY,CAAC;gBAC1D,uBAAuB,CAAC,SAAS,CAAC,KAAK,EAAE,SAAS,CAAC,OAAO,CAAC,CAAC;KACnE;SAAM,IAAI,MAAM,KAAK,aAAa,EAAE;;QAEjC,QAAQ,GAAG,aAAa,CACpB,SAAS,CAAC,OAAO,EACjB,EAAE,EACF,SAAS,CAAC,KAAK,CAAC,EAAE,CAAC,SAAS,CAAC,KAAK,CAAC,QAAQ,CAAC,CAC/C,CAAC;KACL;SAAM,IAAI,MAAM,KAAK,MAAM,EAAE;;QAE1B,SAAS,CAAC,cAAc,CAAC,SAAS,GAAG,SAAS,CAAC,OAAO,CAAC,UAAU,CAC7D,mDAAmD;YAC/C,aAAa,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,OAAO,CAAC;YACtD,SAAS,CAChB,CAAC;QAEF,QAAQ,GAAG,aAAa,CAAC,SAAS,CAAC,OAAO,EAAE,EAAE,EAAE,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;QACtE,SAAS,CAAC,gBAAgB,CAAC,YAAY,CAAC,SAAS,GAAG,QAAQ,CAAC,CAAC;;;;;;;;KASjE;SAAM;QACH,QAAQ,GAAG,KAAK;cACV,aAAa,CAAC,SAAS,CAAC,OAAO,EAAE,MAAM,GAAG,GAAG,EAAE,KAAK,CAAC;cACrD,MAAM,CAAC;KAChB;;;IAGD,MAAM,kBAAkB,GAAG,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,WAAW,CAAC;UACtE,UAAU;UACV,UAAU,CAAC;IACjB,SAAS,CAAC,YAAY,CAAC,WAAW,GAAG,QAAQ,GAAG,kBAAkB,CAAC;IACnE,OAAO,CAAC,IAAI,CAAC,cAAc,EAAE,QAAQ,CAAC,CAAC;;AAE3C,CAAC;AAED,SAAS,2BAA2B,CAChC,KAAmB,EACnB,cAAuB;IAEvB,IAAI,KAAK,CAAC,cAAc,CAAC;QAAE,OAAO,EAAE,CAAC;IACrC,MAAM,QAAQ,GAAG,KAAK,CAAC,EAAE,CAAC,cAAc,CAAC,CAAC;IAC1C,IAAI,QAAQ,CAAC,SAAS,IAAI,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,SAAS,EAAE;QAC1D,OAAO,EAAE,CAAC;KACb;IACD,IAAI,MAAM,GAAG,EAAE,CAAC;IAChB,IAAI,QAAQ,GAAG,QAAQ,CAAC,MAAM,CAAC;IAC/B,MAAM,SAAS,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC;IAClD,OAAO,QAAQ,KAAK,KAAK,CAAC,IAAI,IAAI,QAAQ,KAAK,SAAS,EAAE;QACtD,MAAM,IAAI,UAAU,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAC;QAC9C,QAAQ,GAAG,QAAQ,CAAC,MAAM,CAAC;KAC9B;IAED,OAAO,MAAM,CAAC;AAClB,CAAC;AAED;;;;;;AAMA,SAAS,uBAAuB,CAC5B,KAAmB,EACnB,OAA4B;IAE5B,IAAI,CAAC,KAAK,CAAC,oBAAoB,EAAE;QAC7B,OAAO,aAAa,CAAC,OAAO,EAAE,EAAE,EAAE,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC;KACtE;IACD,IAAI,MAAM,GAAG,EAAE,CAAC;;IAGhB,MAAM,MAAM,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;IACxC,MAAM,QAAQ,GAAG,YAAY,CAAC,MAAM,CAAC,CAAC;IACtC,IAAI,MAAM,CAAC,cAAc,EAAE;QACvB,MAAM,GAAG,CAAC,QAAQ,GAAG,WAAW,GAAG,QAAQ,GAAG,SAAS,IAAI,IAAI,CAAC;KACnE;IACD,IAAI,MAAM,CAAC,aAAa,EAAE;;QAEtB,IAAI,CAAC,MAAM,CAAC,cAAc,EAAE;YACxB,MAAM,IAAI,QAAQ,GAAG,SAAS,GAAG,QAAQ,GAAG,SAAS,CAAC;SACzD;KACJ;SAAM;QACH,MAAM,IAAI,aAAa,CAAC,OAAO,EAAE,EAAE,EAAE,MAAM,CAAC,CAAC;KAChD;IACD,OAAO,MAAM,CAAC;AAClB;;ACxJA,MAAM,qBAAqB,GAAG,GAAG,CAAC;AAElC,MAAM,cAAc,GAAG;IACnB,OAAO;AACX,CAAC,CAAC;AAWF,SAAS,SAAS,CACd,cAAsB,EACtB,KAAgC;IAEhC,IAAI,KAAK,YAAY,gBAAgB,EAAE;QACnC,KAAK,CAAC,IAAI,EAAE,CAAC;QACb,OAAO,KAAK,CAAC;KAChB;IAED,MAAM,GAAG,GAAG,IAAI,GAAG,CACf,CAAC,cAAc,aAAd,cAAc,cAAd,cAAc,GAAI,UAAU,IAAI,GAAG,GAAG,KAAK,EAC5C,UAAU,CACb,CAAC,QAAQ,EAAE,CAAC;IAEb,MAAM,MAAM,GAAqB,IAAI,KAAK,EAAE,CAAC;IAC7C,MAAM,CAAC,OAAO,GAAG,MAAM,CAAC;IACxB,MAAM,CAAC,GAAG,GAAG,GAAG,CAAC;IACjB,MAAM,CAAC,MAAM,GAAG,qBAAqB,CAAC;IACtC,MAAM,CAAC,IAAI,EAAE,CAAC;IACd,OAAO,MAAM,CAAC;AAClB,CAAC;AAED,SAAS,WAAW,CAChB,KAGkD;IAElD,IAAI,KAAK,YAAY,gBAAgB,EAAE;QACnC,KAAK,CAAC,KAAK,EAAE,CAAC;QACd,KAAK,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;;;QAG7B,KAAK,CAAC,IAAI,EAAE,CAAC;KAChB;AACL,CAAC;SAEe,MAAM,CAClB,OAA0C,EAC1C,OAAyC;;IAEzC,MAAM,eAAe,eACjB,OAAO,CAAC,eAAe,mCAAI,OAAO,CAAC,eAAe,mCAAI,UAAU,CAAC;IACrE,MAAM,MAAM,GAAsC,GAAG,CACjD,OAAO,EACP,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CACc,CAAC;IACvC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,CAAC,GAAG;;QAC7B,QAAQ,GAAG;YACP,KAAK,aAAa;gBACd,IAAI,OAAO,CAAC,OAAO,CAAC,WAAW,CAAC,EAAE;oBAC9B,MAAM,CAAC,WAAW,GAAG;wBACjB,OAAO,CAAC,WAAW,CAAC,CAAC,CAAC;wBACtB,OAAO,CAAC,WAAW,CAAC,CAAC,CAAC;qBACzB,CAAC;iBACL;qBAAM,IAAI,OAAO,OAAO,CAAC,WAAW,KAAK,QAAQ,EAAE;oBAChD,MAAM,CAAC,WAAW,GAAG;wBACjB,OAAO,CAAC,WAAW;wBACnB,OAAO,CAAC,WAAW;qBACtB,CAAC;iBACL;qBAAM;oBACH,MAAM,KAAK,CAAC,kCAAkC,CAAC,CAAC;iBACnD;gBACD,MAAM;YACV,KAAK,WAAW;;gBAEZ,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,EAAE;oBACzC,MAAM,KAAK,CACP,yDAAyD,CAC5D,CAAC;iBACL;gBACD,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,EAAE;oBAC/B,MAAM,CAAC,SAAS,GAAG,OAAO,CAAC,SAAS,GAAG,GAAG,CAAC;iBAC9C;qBAAM;oBACH,MAAM,CAAC,SAAS,GAAG,OAAO,CAAC,SAAS,CAAC;iBACxC;gBACD,MAAM;YACV,KAAK,QAAQ;gBACT,MAAM,CAAC,MAAM;oBACT,OAAO,CAAC,MAAM,KAAK,MAAM;gCACnB,SAAS,aAAT,SAAS,uBAAT,SAAS,CAAE,QAAQ,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,oCAAK,IAAI,GACvC,OAAO,CAAC,MAAM,CAAC;gBACzB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC;gBAC5B,MAAM;YACV,KAAK,SAAS;gBACV,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;gBAC5B,MAAM,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;gBAC9B,MAAM;YACV,KAAK,uBAAuB;gBACxB,IAAI,OAAO,CAAC,qBAAqB,KAAK,MAAM,EAAE;oBAC1C,MAAM,CAAC,qBAAqB,SACxB;wBACI,EAAE,EAAE,QAAQ;wBACZ,EAAE,EAAE,QAAQ;wBACZ,EAAE,EAAE,QAAQ;wBACZ,EAAE,EAAE,QAAQ;wBACZ,EAAE,EAAE,QAAQ;wBACZ,EAAE,EAAE,QAAQ;wBACZ,EAAE,EAAE,QAAQ;wBACZ,EAAE,EAAE,QAAQ;wBACZ,EAAE,EAAE,QAAQ;qBACf,CAAC,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,mCAAI,QAAQ,CAAC;iBAClD;qBAAM;oBACH,MAAM,CAAC,qBAAqB;wBACxB,OAAO,CAAC,qBAAqB,CAAC;iBACrC;gBACD,MAAM;YACV,KAAK,qBAAqB;gBACtB;oBACI,MAAM,aAAa,SAAG,MAAM,CAAC,UAAU,+CAAjB,MAAM,EACxB,uBAAuB,EACzB,OAAO,CAAC;oBACV,IAAI,OAAO,CAAC,mBAAmB,KAAK,MAAM,EAAE;wBACxC,MAAM,CAAC,mBAAmB,GAAG,aAAa;8BACpC,SAAS;8BACT,KAAK,CAAC;qBACf;yBAAM;wBACH,MAAM,CAAC,mBAAmB;4BACtB,OAAO,CAAC,mBAAmB,CAAC;qBACnC;iBACJ;gBACD,MAAM;YAEV,KAAK,kBAAkB;gBACnB,IAAI,OAAO,CAAC,gBAAgB,KAAK,MAAM,EAAE;;oBAErC,IAAI,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,KAAK,IAAI,EAAE;wBACtC,MAAM,CAAC,gBAAgB,GAAG,QAAQ,CAAC;qBACtC;yBAAM;wBACH,MAAM,CAAC,gBAAgB,GAAG,KAAK,CAAC;qBACnC;iBACJ;qBAAM;oBACH,MAAM,CAAC,gBAAgB,GAAG,OAAO,CAAC,gBAAgB,CAAC;iBACtD;gBACD,MAAM;YACV,KAAK,YAAY;gBACb,WAAW,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;gBAC/B,MAAM,CAAC,UAAU,GAAG,SAAS,CACzB,eAAe,EACf,OAAO,CAAC,UAAU,CACrB,CAAC;gBACF,MAAM;YACV,KAAK,eAAe;gBAChB,WAAW,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC;gBAClC,IAAI,OAAO,OAAO,CAAC,aAAa,KAAK,QAAQ,EAAE;oBAC3C,MAAM,KAAK,GAAG,SAAS,CACnB,eAAe,EACf,OAAO,CAAC,aAAa,CACxB,CAAC;oBACF,MAAM,CAAC,aAAa,GAAG;wBACnB,MAAM,EAAE,KAAK;wBACb,MAAM,EAAE,KAAK;wBACb,QAAQ,EAAE,KAAK;wBACf,OAAO,EAAE,KAAK;qBACjB,CAAC;iBACL;qBAAM,IAAI,OAAO,CAAC,aAAa,YAAY,gBAAgB,EAAE;oBAC1D,MAAM,CAAC,aAAa,GAAG;wBACnB,MAAM,EAAE,OAAO,CAAC,aAAa;wBAC7B,MAAM,EAAE,OAAO,CAAC,aAAa;wBAC7B,QAAQ,EAAE,OAAO,CAAC,aAAa;wBAC/B,OAAO,EAAE,OAAO,CAAC,aAAa;qBACjC,CAAC;iBACL;qBAAM;oBACH,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,OAAO,EAAE;wBAChC,MAAM,KAAK,CAAC,+BAA+B,CAAC,CAAC;qBAChD;oBACD,MAAM,CAAC,aAAa,GAAG,EAAE,GAAG,OAAO,CAAC,aAAa,EAAE,CAAC;oBACpD,MAAM,CAAC,aAAa,CAAC,OAAO,GAAG,SAAS,CACpC,eAAe,EACf,MAAM,CAAC,aAAa,CAAC,OAAO,CAC/B,CAAC;oBACF,MAAM,CAAC,aAAa,CAAC,MAAM,SACvB,SAAS,CACL,eAAe,EACf,MAAM,CAAC,aAAa,CAAC,MAAM,CAC9B,mCAAI,OAAO,CAAC,aAAa,CAAC,OAAO,CAAC;oBACvC,MAAM,CAAC,aAAa,CAAC,MAAM,SACvB,SAAS,CACL,eAAe,EACf,MAAM,CAAC,aAAa,CAAC,MAAM,CAC9B,mCAAI,OAAO,CAAC,aAAa,CAAC,OAAO,CAAC;oBACvC,MAAM,CAAC,aAAa,CAAC,QAAQ,SACzB,SAAS,CACL,eAAe,EACf,MAAM,CAAC,aAAa,CAAC,QAAQ,CAChC,mCAAI,OAAO,CAAC,aAAa,CAAC,OAAO,CAAC;iBAC1C;gBACD,MAAM;YACV,KAAK,QAAQ,CAAC;YACd,KAAK,SAAS,CAAC;YACf,KAAK,qBAAqB,CAAC;YAC3B,KAAK,oBAAoB,CAAC;YAC1B,KAAK,uBAAuB,CAAC;YAC7B,KAAK,sBAAsB,CAAC;YAC5B,KAAK,uBAAuB,CAAC;YAC7B,KAAK,sBAAsB,CAAC;YAC5B,KAAK,cAAc,CAAC;YACpB,KAAK,UAAU,CAAC;YAChB,KAAK,yBAAyB,CAAC;YAC/B,KAAK,mBAAmB,CAAC;YACzB,KAAK,SAAS;gBACV,IAAI,OAAO,CAAC,GAAG,CAAC,KAAK,IAAI,EAAE;oBACvB,MAAM,CAAC,GAAG,CAAC,GAAG,cAAc,CAAC;iBAChC;qBAAM,IAAI,OAAO,OAAO,CAAC,GAAG,CAAC,KAAK,UAAU,EAAE;oBAC3C,MAAM,KAAK,CAAC,GAAG,GAAG,6BAA6B,CAAC,CAAC;iBACpD;gBACD,MAAM,CAAC,GAAG,CAAC,GAAG,OAAO,CAAC,GAAG,CAAQ,CAAC;gBAClC,MAAM;YACV;gBACI,IAAI,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,EAAE;oBACvB,MAAM,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC;iBACnC;qBAAM,IAAI,OAAO,OAAO,CAAC,GAAG,CAAC,KAAK,QAAQ,EAAE;oBACzC,MAAM,CAAC,GAAG,CAAC,GAAG,EAAE,GAAG,OAAO,CAAC,GAAG,CAAC,EAAE,CAAC;iBACrC;qBAAM;oBACH,MAAM,CAAC,GAAG,CAAC,GAAG,OAAO,CAAC,GAAG,CAAC,CAAC;iBAC9B;SACR;KACJ,CAAC,CAAC;;;IAIH,IAAI,OAAO,OAAO,CAAC,8BAA8B,KAAK,WAAW,EAAE;QAC/D,IAAI,OAAO,CAAC,8BAA8B,EAAE;YACxC,MAAM,CAAC,eAAe,GAAG,OAAO,CAAC,eAAe,CAAC;SACpD;aAAM;YACH,MAAM,CAAC,eAAe,GAAG;gBACrB,GAAG,gBAAgB;gBACnB,GAAG,OAAO,CAAC,eAAe;aAC7B,CAAC;SACL;KACJ;IACD,OAAO,MAAM,CAAC;AAClB,CAAC;SAEe,GAAG,CACf,MAAyC,EACzC,IAA+C;IAE/C,IAAI,YAAsB,CAAC;IAC3B,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE;QAC1B,YAAY,GAAG,CAAC,IAAI,CAAC,CAAC;KACzB;SAAM,IAAI,OAAO,IAAI,KAAK,WAAW,EAAE;QACpC,YAAY,GAAG,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;KACtC;SAAM;QACH,YAAY,GAAG,IAAI,CAAC;KACvB;IACD,MAAM,MAAM,GAAqC,EAAE,CAAC;IACpD,YAAY,CAAC,OAAO,CAAC,CAAC,CAAC;QACnB,IAAI,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,EAAE;YACpB,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;SAC9B;aAAM,IAAI,OAAO,MAAM,CAAC,CAAC,CAAC,KAAK,QAAQ,EAAE;YACtC,MAAM,CAAC,CAAC,CAAC,GAAG,EAAE,GAAG,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC;SAChC;aAAM;YACH,MAAM,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;SACzB;KACJ,CAAC,CAAC;;IAEH,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE;QAC1B,OAAO,MAAM,CAAC,IAAI,CAAC,CAAC;KACvB;IACD,OAAO,MAAM,CAAC;AAClB,CAAC;SAEe,UAAU;IACtB,OAAO;QACH,SAAS,EAAE,EAAE;QACb,kBAAkB,EAAE,SAAS;QAC7B,QAAQ,EAAE,KAAK;QACf,UAAU,EAAE,CAAC,CAAS,KAAU,CAAC;QACjC,cAAc,EAAE,SAAS;QACzB,eAAe,EAAE,UAAU;QAE3B,WAAW,EAAE,MAAM;QACnB,MAAM,EAAE,MAAM;QACd,sBAAsB,EAAE,GAAG;QAC3B,gBAAgB,EAAE,MAAM;QAExB,SAAS,EAAE,KAAK;QAChB,UAAU,EAAE,IAAI;QAChB,gBAAgB,EAAE,IAAI;QACtB,WAAW,EAAE,CAAC,QAAQ,EAAE,QAAQ,CAAC;QACjC,2BAA2B,EAAE,IAAI;QACjC,wBAAwB,EAAE,IAAI;QAE9B,MAAM,EAAE,IAAI,CAAC,MAAM;QACnB,OAAO,EAAE,IAAI,CAAC,OAAO;QAErB,WAAW,EAAE,mBAAmB;QAEhC,8BAA8B,EAAE,KAAK;QACrC,eAAe,EAAE,EAAE;QACnB,qBAAqB,EAAE,CAAC;QAExB,0BAA0B,EAAE,ksDAAksD;QAC9tD,mBAAmB,EAAE,MAAM;QAC3B,gBAAgB,EAAE,KAAK;QACvB,qBAAqB,EAAE,MAAM;QAC7B,2BAA2B,EAAE,EAAE;QAC/B,sBAAsB,EAAE,EAAE;QAC1B,oBAAoB,EAAE,eAAe,CAAC,IAAI,CAAC,SAAS,aAAT,SAAS,uBAAT,SAAS,CAAE,SAAS,CAAC;cAC1D,UAAU;cACV,OAAO;QACb,iBAAiB,EAAE,IAAI;QACvB,aAAa,EAAE,IAAI;QACnB,UAAU,EAAE,IAAI;QAEhB,iBAAiB,EAAE,UAAU;QAC7B,kBAAkB,EAAE,EAAE;QACtB,wBAAwB,EAAE,EAAE;QAC5B,YAAY,EAAE,OAAO;QACrB,iBAAiB,EAAE,QAAQ;QAC3B,gBAAgB,EAAE,MAAM;QACxB,SAAS,EAAE,cAAc;QACzB,aAAa,EAAE,cAAc;QAE7B,UAAU,EAAE,mBAAmB;QAC/B,WAAW,EAAE,MAAe,IAAI;QAChC,WAAW,EAAE,MAAe,IAAI;QAChC,UAAU,EAAE,MAAe,IAAI;QAE/B,MAAM,EAAE,cAAc;QACtB,OAAO,EAAE,cAAc;QACvB,mBAAmB,EAAE,cAAc;QACnC,kBAAkB,EAAE,cAAc;QAClC,qBAAqB,EAAE,cAAc;QACrC,oBAAoB,EAAE,cAAc;QACpC,qBAAqB,EAAE,cAAc;QACrC,oBAAoB,EAAE,cAAc;QACpC,YAAY,EAAE,cAAc;QAC5B,uBAAuB,EAAE,cAAc;QACvC,iBAAiB,EAAE,cAAc;QACjC,QAAQ,EAAE,cAAc;QAExB,OAAO,EAAE;YACL,OAAO;SACV;KACJ,CAAC;AACN;;ACtWA;;;;;;AAMA,SAAS,sBAAsB,CAC3B,KAAmB,EACnB,KAAuC,EACvC,KAA4B;IAE5B,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE;QAC3B,KAAK,GAAG,KAAK,CAAC;QACd,KAAK,GAAG,QAAQ,CAAC;KACpB;IACD,IAAI,OAAO,KAAK,KAAK,WAAW,EAAE;QAC9B,KAAK,GAAG,QAAQ,CAAC;KACpB;IACD,IAAI,CAAC,GAAG,KAAK,CAAC,QAAQ,CAAC;IACvB,IAAI,IAAI,GAAG,KAAK,CAAC;IACjB,OAAO,CAAC,IAAI,EAAE;QACV,MAAM,IAAI,GAAG,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QACzB,IAAI;YACA,KAAK,KAAK,CAAC;gBACX,CAAC,IAAI;gBACL,IAAI,CAAC,IAAI,KAAK,MAAM;gBACpB,EACI,qBAAqB,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC;qBACpC,IAAI,CAAC,IAAI,KAAK,KAAK,IAAI,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CACxD;gBACD,CAAC,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC;gBACnC,CAAC,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC;iBAChC,KAAK,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC;QAC5B,IAAI,CAAC,IAAI,EAAE;YACP,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC;YACnB,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC;YAC1B,IAAI,CAAC,KAAK,GAAG,SAAS,CAAC;SAC1B;QACD,CAAC,IAAI,CAAC,CAAC;QACP,KAAK,IAAI,CAAC,CAAC;KACd;IACD,gBAAgB,CAAC,KAAK,CAAC,CAAC;AAC5B,CAAC;AACD;;;;;;AAMA,SAAS,sBAAsB,CAC3B,KAAmB,EACnB,KAAc,EACd,KAAM;IAEN,IAAI,OAAO,KAAK,KAAK,UAAU,EAAE;QAC7B,KAAK,GAAG,KAAK,CAAC;QACd,KAAK,GAAG,QAAQ,CAAC;KACpB;IACD,IAAI,OAAO,KAAK,KAAK,WAAW,EAAE;QAC9B,KAAK,GAAG,QAAQ,CAAC;KACpB;IACD,IAAI,CAAC,GAAG,KAAK,CAAC,QAAQ,CAAC;IACvB,IAAI,IAAI,GAAG,KAAK,CAAC;IACjB,OAAO,CAAC,IAAI,EAAE;QACV,MAAM,IAAI,GAAG,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QACzB,IAAI;YACA,KAAK,KAAK,CAAC;gBACX,CAAC,IAAI;gBACL,IAAI,CAAC,cAAc;gBACnB,IAAI,CAAC,IAAI,KAAK,MAAM;gBACpB,IAAI,CAAC,KAAK,KAAK,GAAG;iBACjB,KAAK,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC;QAC5B,IAAI,CAAC,IAAI,EAAE;YACP,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC;SACtB;QACD,CAAC,IAAI,CAAC,CAAC;QACP,KAAK,IAAI,CAAC,CAAC;KACd;IACD,mBAAmB,CAAC,KAAK,CAAC,CAAC;IAC3B,gBAAgB,CAAC,KAAK,CAAC,CAAC;AAC5B,CAAC;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;;SAKgB,mBAAmB,CAAC,KAAmB;;IACnD,IAAI,CAAC,GAAG,KAAK,CAAC,QAAQ,GAAG,CAAC,CAAC;IAC3B,OAAO,CAAC,IAAI,CAAC,IAAI,OAAA,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,0CAAE,IAAI,MAAK,MAAM,EAAE;QAC3C,CAAC,IAAI,CAAC,CAAC;KACV;IACD,IAAI,CAAC,GAAG,CAAC;QAAE,OAAO;;;;IAIlB,IACI,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,MAAM;QAC3B,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,KAAK,KAAK,GAAG;QACzB,KAAK,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,KAAK,MAAM,EACjC;QACE,KAAK,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;QACpD,gBAAgB,CAAC,KAAK,CAAC,CAAC;;;;QAIxB,MAAM,IAAI,GAAG,KAAK,CAAC,2BAA2B,CAAC;QAC/C,KAAK,CAAC,2BAA2B,GAAG,IAAI,CAAC;QACzC,KAAK,CAAC,QAAQ,IAAI,CAAC,CAAC;QACpB,KAAK,CAAC,2BAA2B,GAAG,IAAI,CAAC;KAC5C;AACL,CAAC;AACD;;;;;AAKA,SAAS,qBAAqB,CAAC,KAAmB;;IAE9C,IAAI,MAAM,GAAG,EAAE,CAAC;IAChB,IAAI,CAAC,GAAG,KAAK,CAAC,QAAQ,CAAC;IACvB,IAAI,IAAI,GAAG,KAAK,CAAC;IACjB,OAAO,CAAC,IAAI,EAAE;QACV,MAAM,IAAI,GAAG,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QACzB,IAAI,GAAG,EACH,IAAI;aACH,IAAI,CAAC,IAAI,KAAK,MAAM;iBAChB,IAAI,CAAC,IAAI,KAAK,MAAM,IAAI,qBAAqB,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CACvE,CAAC;QACF,IAAI,CAAC,IAAI,EAAE;YACP,MAAM,GAAG,IAAI,CAAC,KAAK,GAAG,MAAM,CAAC;SAChC;QACD,CAAC,IAAI,CAAC,CAAC;KACV;IACD,OAAO,MAAM,CAAC;AAClB,CAAC;AACD;;;;;;;;SASgB,SAAS,CACrB,SAA2B,EAC3B,SAAiB,EACjB,GAAkB;IAElB,IAAI,SAAS,CAAC,mBAAmB,EAAE;QAC/B,OAAO,KAAK,CAAC;KAChB;IACD,MAAM,KAAK,GAAG,SAAS,CAAC,KAAK,CAAC;;IAE9B,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,aAAa,EAAE;QACzC,OAAO,KAAK,CAAC;KAChB;;;IAGD,IAAI,CAAC,GAAG,IAAI,CAAC,8BAA8B,CAAC,GAAG,CAAC,EAAE;QAC9C,OAAO,KAAK,CAAC;KAChB;IACD,MAAM,CAAC,GAAG,WAAW,CAAC,GAAG,CAAC,CAAC;IAC3B,IAAI,CAAC,KAAK,CAAC,oBAAoB,EAAE;;QAE7B,IAAI,SAAS,CAAC,IAAI,KAAK,MAAM,EAAE;;YAE3B,IAAI,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE;gBACjB,OAAO,IAAI,CAAC;aACf;SACJ;QACD,OAAO,KAAK,CAAC;KAChB;IACD,MAAM,OAAO,GAAG,qBAAqB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IACjD,IAAI,SAAS,CAAC,IAAI,KAAK,MAAM,EAAE;;QAE3B,IAAI,SAAS,KAAK,KAAK,IAAI,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE;;;;YAIxC,OAAO,IAAI,CAAC;SACf;QACD,IAAI,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE;;;YAGjB,IAAI,qBAAqB,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE;;;gBAGrC,sBAAsB,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;aACpC;YACD,OAAO,IAAI,CAAC;SACf;;;QAGD,MAAM,MAAM,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC;QACnD,MAAM,MAAM,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC;QAC/C,IACI,MAAM;YACN,MAAM,YAAY,aAAa;YAC/B,MAAM,CAAC,SAAS,KAAK,MAAM,EAC7B;YACE,OAAO,IAAI,CAAC;SACf;QACD,IAAI,wBAAwB,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE;;;YAGxC,OAAO,KAAK,CAAC;SAChB;QACD,IAAI,oBAAoB,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE;;;YAG9B,OAAO,IAAI,CAAC;SACf;QACD,IAAI,6BAA6B,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE;;;YAG7C,sBAAsB,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;YACjC,OAAO,KAAK,CAAC;SAChB;QACD,IAAI,mBAAmB,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE;;;;;YAKnC,sBAAsB,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;YACjC,MAAM,IAAI,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;YACtC,IAAI,CAAC,KAAK,GAAG,GAAG,CAAC;YACjB,IAAI,CAAC,KAAK,CAAC,OAAO,GAAG,QAAQ,CAAC;YAC9B,IAAI,CAAC,OAAO,GAAG,QAAQ,CAAC;YACxB,IAAI,CAAC,KAAK,GAAG,SAAS,CAAC;YACvB,gBAAgB,CAAC,KAAK,CAAC,CAAC;YACxB,OAAO,IAAI,CAAC;SACf;QACD,IAAI,0BAA0B,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE;;YAE1C,sBAAsB,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;YACjC,OAAO,IAAI,CAAC;SACf;QACD,IAAI,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE;;;;;YAK1B,sBAAsB,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;YACjC,OAAO,IAAI,CAAC;SACf;QACD,IAAI,eAAe,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE;;;YAG/B,sBAAsB,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;YACjC,OAAO,IAAI,CAAC;SACf;QACD,IAAI,eAAe,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE;;;YAG/B,sBAAsB,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;YACjC,OAAO,IAAI,CAAC;SACf;;;QAGD,IAAI,gBAAgB,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE;;;;;;YAM1B,mBAAmB,CAAC,KAAK,CAAC,CAAC;YAC3B,OAAO,IAAI,CAAC;SACf;KACJ;SAAM;;QAEH,IAAI,SAAS,KAAK,SAAS,EAAE;YACzB,sBAAsB,CAAC,KAAK,EAAE,SAAS,EAAE,CAAC,CAAC,KACvC,cAAc,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,CAC/B,CAAC;YACF,OAAO,IAAI,CAAC;SACf;QACD,IACI,eAAe,CAAC,IAAI,CAAC,OAAO,CAAC;YAC7B,CAAC,oBAAoB,CAAC,IAAI,CAAC,OAAO,CAAC,EACrC;;;;YAIE,sBAAsB,CAAC,KAAK,EAAE,SAAS,EAAE,CAAC,CAAC,KACvC,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,CAC3B,CAAC;YACF,OAAO,IAAI,CAAC;SACf;QACD,IAAI,iBAAiB,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE;;YAEjC,sBAAsB,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;YACjC,OAAO,IAAI,CAAC;SACf;QACD,IACI,yIAAyI,CAAC,IAAI,CAC1I,OAAO,CACV;YACD,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,EACzB;;;;YAIE,sBAAsB,CAAC,KAAK,EAAE,SAAS,EAAE,CAAC,CAAC,KACvC,4IAA4I,CAAC,IAAI,CAC7I,CAAC,CAAC,KAAK,CACV,CACJ,CAAC;YACF,OAAO,IAAI,CAAC;SACf;QACD,IAAI,CAAC,KAAK,GAAG,EAAE;;;YAGX,OAAO,IAAI,CAAC;SACf;QACD,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE;;YAE1C,OAAO,IAAI,CAAC;SACf;KACJ;IACD,OAAO,KAAK,CAAC;AACjB;;SCjWgB,aAAa,CACzB,SAA2B,EAC3B,SAAiB;IAEjB,MAAM,EAAE,GAAG,SAAS,CAAC,gBAAgB,CAAC;IACtC,IAAI,EAAE,IAAI,SAAS,CAAC,uBAAuB,EAAE;QACzC,MAAM,MAAM,GAAG,SAAS,CAAC,OAAO,CAAC,qBAAqB,EAAE,CAAC;QACzD,EAAE,CAAC,KAAK,CAAC,IAAI,GAAG,MAAM,CAAC,IAAI,GAAG,IAAI,CAAC;QACnC,EAAE,CAAC,KAAK,CAAC,GAAG,GAAG,MAAM,CAAC,GAAG,GAAG,EAAE,GAAG,IAAI,CAAC;QACtC,EAAE,CAAC,SAAS,GAAG,SAAS,CAAC,OAAO,CAAC,UAAU,CACvC,QAAQ;aACH,mBAAmB,CAAC,SAAS,CAAC,IAAI,SAAS,CAAC;YAC7C,SAAS;YACT,EAAE,CAAC,SAAS,CACnB,CAAC;QACF,EAAE,CAAC,KAAK,CAAC,UAAU,GAAG,SAAS,CAAC;QAChC,UAAU,CAAC;YACP,IAAI,EAAE,CAAC,UAAU,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC1B,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,UAAU,CAAC,EAAE,CAAC,UAAU,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;aAC3D;YACD,IAAI,EAAE,CAAC,UAAU,CAAC,MAAM,KAAK,CAAC,EAAE;gBAC5B,EAAE,CAAC,KAAK,CAAC,UAAU,GAAG,QAAQ,CAAC;aAClC;SACJ,EAAE,IAAI,CAAC,CAAC;KACZ;AACL,CAAC;AAED;;;SAGgB,WAAW,CACvB,SAA2B,EAC3B,SAAiB,EACjB,GAAkB;IAElB,MAAM,KAAK,GAAG,SAAS,CAAC,KAAK,CAAC;;;IAK9B,sBAAsB,CAAC,GAAG,CAAC,CAAC;IAE5B,MAAM,YAAY,GAAG,uBAAuB,EAAE,CAAC;IAC/C,IAAI,SAAS,CAAC,cAAc,KAAK,YAAY,CAAC,EAAE,EAAE;;QAE9C,SAAS,CAAC,cAAc,GAAG,YAAY,CAAC,EAAE,CAAC;QAC3C,SAAS,CAAC,WAAW,GAAG,oBAAoB,CACxC,SAAS,CAAC,OAAO,CAAC,WAAW,EAC7B,CAAC,CAAC;YACE,IAAI,OAAO,SAAS,CAAC,OAAO,CAAC,OAAO,KAAK,UAAU,EAAE;gBACjD,SAAS,CAAC,OAAO,CAAC,OAAO,CAAC;oBACtB,IAAI,EAAE,oBAAoB;oBAC1B,GAAG,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC;iBACpB,CAAC,CAAC;aACN;YACD,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;SAC7B,CACJ,CAAC;KACL;;IAGD,aAAa,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;;IAGpC,YAAY,CAAC,SAAS,CAAC,yBAAyB,CAAC,CAAC;;IAGlD,IACI,SAAS,CAAC,OAAO,CAAC,WAAW;QAC7B,CAAC,SAAS,CAAC,OAAO,CAAC,WAAW,CAAC,SAAS,EAAE,SAAS,EAAE,GAAG,CAAC,EAC3D;QACE,IAAI,GAAG,aAAH,GAAG,uBAAH,GAAG,CAAE,cAAc,EAAE;YACrB,GAAG,CAAC,cAAc,EAAE,CAAC;YACrB,GAAG,CAAC,eAAe,EAAE,CAAC;SACzB;QACD,OAAO,KAAK,CAAC;KAChB;;IAGD,IAAI,QAAgB,CAAC;IACrB,IAAI,UAAkB,CAAC;IACvB,IAAI,QAA8C,CAAC;IACnD,IAAI,oBAAoB,GAAG,KAAK,CAAC;;;;;IAKjC,IACI,SAAS,CAAC,IAAI,KAAK,SAAS;SAC3B,CAAC,GAAG,KAAK,CAAC,GAAG,CAAC,OAAO,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,EAC1C;QACE,IAAI,SAAS,KAAK,aAAa,EAAE;;YAE7B,SAAS,CAAC,eAAe,GAAG,SAAS,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;YACnE,SAAS,CAAC,qBAAqB,CAAC,GAAG,EAAE,CAAC;YACtC,SAAS,CAAC,oBAAoB,CAAC,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;SACnD;aAAM,IAAI,CAAC,8BAA8B,CAAC,GAAG,CAAC,EAAE;;YAE7C,SAAS,CAAC,oBAAoB,EAAE,CAAC;SACpC;aAAM;YACH,MAAM,CAAC,GAAG,WAAW,CAAC,GAAG,CAAC,CAAC;;YAE3B,MAAM,SAAS,GAAG,SAAS,CAAC,eAAe,GAAG,CAAC,CAAC;YAChD,IAAI,CAAC,GAAG,CAAC,CAAC;YACV,OAAO,CAAC,QAAQ,IAAI,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE;gBACtC,IAAI,OAAe,CAAC;gBACpB,IAAI,SAAS,CAAC,qBAAqB,CAAC,CAAC,CAAC,EAAE;oBACpC,MAAM,IAAI,GAAG,IAAI,IAAI,CAAC,MAAM,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC,CAAC;oBAChD,OAAO,GAAG,WAAW,CACjB,SAAS,CAAC,qBAAqB,CAAC,CAAC,CAAC,CAAC,KAAK,EACxC,SAAS,CAAC,OAAO,CAAC,WAAW,EAC7B,IAAI,EACJ,SAAS,CAAC,OAAO,CAAC,MAAM,CAC3B,CAAC;oBACF,IAAI,CAAC,IAAI,GAAG,OAAO,CAAC;iBACvB;qBAAM;;oBAEH,OAAO,GAAG,KAAK,CAAC,QAAQ,CACpB,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,YAAY,CAAC,EACrD,KAAK,CAAC,QAAQ,CACjB,CAAC;iBACL;gBACD,QAAQ,GAAG,iBAAiB,CACxB,OAAO,EACP,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC,EAClB,SAAS,CAAC,OAAO,CAAC,eAAe,CACpC,CAAC;gBACF,CAAC,IAAI,CAAC,CAAC;aACV;YAED,UAAU;gBACN,SAAS,CAAC,qBAAqB,CAAC,MAAM,IAAI,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;YACpE,SAAS,CAAC,eAAe,IAAI,CAAC,CAAC;YAC/B,SAAS,CAAC,qBAAqB,CAAC,IAAI,CAAC,SAAS,CAAC,aAAa,EAAE,CAAC,CAAC;YAChE,IACI,8BAA8B,CAAC,SAAS,EAAE,SAAS,CAAC,OAAO,CAAC;iBACvD,MAAM,IAAI,CAAC,EAClB;gBACE,oBAAoB,GAAG,IAAI,CAAC;aAC/B;iBAAM;gBACH,SAAS,CAAC,oBAAoB,CAAC,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;aACnD;SACJ;KACJ;;;;;IAKD,IAAI,SAAS,CAAC,OAAO,CAAC,SAAS,EAAE;QAC7B,MAAM,YAAY,GAAG,SAAS,CAAC,IAAI,CAAC;QACpC,IAAI,QAAQ,EAAE;;;YAGV,SAAS,CAAC,IAAI,GAAG,MAAM,CAAC;SAC3B;aAAM,IAAI,SAAS,CAAC,SAAS,EAAE,SAAS,EAAE,GAAG,CAAC,EAAE;YAC7C,SAAS,CAAC,IAAI,GAAG,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;YAChE,QAAQ,GAAG,EAAE,CAAC;SACjB;;QAED,IACI,SAAS,CAAC,IAAI,KAAK,YAAY;YAC/B,OAAO,SAAS,CAAC,OAAO,CAAC,YAAY,KAAK,UAAU,EACtD;YACE,SAAS,CAAC,OAAO,CAAC,YAAY,CAAC,SAAS,EAAE,SAAS,CAAC,IAAI,CAAC,CAAC;SAC7D;KACJ;;;;;IAKD,IAAI,CAAC,QAAQ,IAAI,CAAC,QAAQ,EAAE;QACxB,QAAQ,GAAG,uBAAuB,CAC9B,SAAS,CAAC,WAAW,EACrB,SAAS,CAAC,IAAI,EACd,SAAS,CACZ,CAAC;KACL;IACD,IACI,CAAC,QAAQ;QACT,CAAC,QAAQ;SACR,SAAS,KAAK,SAAS,IAAI,SAAS,KAAK,UAAU,CAAC,EACvD;;QAEE,IAAI,OAAO,SAAS,CAAC,OAAO,CAAC,QAAQ,KAAK,UAAU,EAAE;YAClD,SAAS,CAAC,OAAO,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;YACtC,IAAI,GAAG,aAAH,GAAG,uBAAH,GAAG,CAAE,cAAc,EAAE;gBACrB,GAAG,CAAC,cAAc,EAAE,CAAC;gBACrB,GAAG,CAAC,eAAe,EAAE,CAAC;aACzB;YACD,OAAO,KAAK,CAAC;SAChB;KACJ;;IAGD,IAAI,CAAC,QAAQ,IAAI,CAAC,QAAQ,EAAE;QACxB,OAAO,IAAI,CAAC;KACf;IACD,IAAI,SAAS,CAAC,OAAO,CAAC,QAAQ,IAAI,QAAQ,CAAC,CAAC,CAAC,KAAK,QAAQ,EAAE;QACxD,OAAO,IAAI,CAAC;KACf;;;;;;;;IAUD,eAAe,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;QAC7B,CAAC,CAAC,OAAO,GAAG,KAAK,CAAC;KACrB,CAAC,CAAC;;;;;;IAOH,MAAM,KAAK,GAAG,KAAK,CAAC,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,QAAQ,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC;IAC/D,MAAM,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;IAC5B,IACI,QAAQ,KAAK,iBAAiB;QAC9B,MAAM;QACN,MAAM,CAAC,IAAI,KAAK,WAAW;QAC3B,KAAK,CAAC,aAAa;QACnB,SAAS,CAAC,OAAO,CAAC,UAAU;QAC5B,gBAAgB,CAAC,KAAK,EAAE,GAAG,EAAE,SAAS,CAAC,KAAK,CAAC,EAC/C;;;QAGE,QAAQ,GAAG,EAAE,CAAC;QACd,aAAa,CAAC,SAAS,CAAC,CAAC;KAC5B;;;;;IAKD,IAAI,SAAS,CAAC,IAAI,KAAK,MAAM,IAAI,SAAS,KAAK,YAAY,IAAI,CAAC,QAAQ,EAAE;QACtE,MAAM,WAAW,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,GAAG,CAAC,CAAC,CAAC;QACjD,MAAM,eAAe,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,GAAG,CAAC,CAAC,CAAC;QACrD,IACI,CAAC,WAAW,IAAI,WAAW,CAAC,IAAI,KAAK,MAAM;aAC1C,eAAe,IAAI,eAAe,CAAC,IAAI,KAAK,MAAM,CAAC,EACtD;YACE,MAAM,CAAC,KAAK,EAAE,GAAG,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC,CAAC;SACxC;KACJ;;;;IAID,IAAI,QAAQ,EAAE;QACV,SAAS,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC;KACtC;SAAM,IAAI,QAAQ,EAAE;;;;;;;;QASjB,SAAS,CAAC,gBAAgB,CAAC,iBAAiB,EAAE,CAAC;;;;;;;QAQ/C,MAAM,KAAK,GAAG;YACV,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,aAAa;YACzC,GAAG,SAAS,CAAC,KAAK;SACrB,CAAC;QACF,IACI,CAAC,yDAAyD,CAAC,IAAI,CAC3D,QAAQ,CACX,EACH;;;YAGE,MAAM,QAAQ,GAAG,SAAS,CAAC,IAAI,CAAC;YAChC,MAAM,CAAC,KAAK,EAAE,WAAW,CAAC,GAAG,CAAC,EAAE;gBAC5B,2BAA2B,EAAE,IAAI;gBACjC,IAAI,EAAE,SAAS,CAAC,IAAI;gBACpB,KAAK,EAAE,KAAK;aACf,CAAC,CAAC;;YAEH,SAAS,CAAC,mBAAmB,EAAE,CAAC;;;YAGhC,SAAS,CAAC,mBAAmB,CACzB,SAAS,CAAC,qBAAqB,CAAC,UAAU,CAAC,CAC9C,CAAC;YACF,SAAS,CAAC,IAAI,GAAG,QAAQ,CAAC;SAC7B;QACD,KAAK,CAAC,kBAAkB,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,EAAE;;YAEzD,MAAM,CAAC,KAAK,EAAE,QAAQ,EAAE;gBACpB,MAAM,EAAE,OAAO;gBACf,IAAI,EAAE,SAAS,CAAC,IAAI;gBACpB,KAAK,EAAE,KAAK;gBACZ,UAAU,EAAE,IAAI;aACnB,CAAC,CAAC;;;YAGH,mBAAmB,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;;YAErC,IAAI,QAAQ,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;gBACxB,SAAS,CAAC,IAAI,GAAG,MAAM,CAAC;gBACxB,MAAM,CAAC,KAAK,EAAE,GAAG,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC;aACtD;SACJ,CAAC,CAAC;QACH,SAAS,CAAC,QAAQ,EAAE,CAAC;QACrB,SAAS,CAAC,KAAK,GAAG,IAAI,CAAC;QACvB,KAAK,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC;;QAE9B,IAAI,oBAAoB,EAAE;YACtB,SAAS,CAAC,oBAAoB,EAAE,CAAC;SACpC;KACJ;;;;IAKD,SAAS,CAAC,cAAc,EAAE,CAAC;;;;;IAM3B,IAAI,GAAG,aAAH,GAAG,uBAAH,GAAG,CAAE,cAAc,EAAE;QACrB,GAAG,CAAC,cAAc,EAAE,CAAC;QACrB,GAAG,CAAC,eAAe,EAAE,CAAC;KACzB;IACD,OAAO,KAAK,CAAC;AACjB,CAAC;AAED;;;;;;;;;;;SAWgB,WAAW,CACvB,SAA2B,EAC3B,IAAY,EACZ,OAKC;;IAED,MAAM,KAAK,GAAG,SAAS,CAAC,KAAK,CAAC;IAC9B,IAAI,SAAS,CAAC,OAAO,CAAC,QAAQ,EAAE;QAC5B,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;QACxB,OAAO;KACV;IACD,OAAO,GAAG,OAAO,aAAP,OAAO,cAAP,OAAO,GAAI,EAAE,CAAC;;;;IAKxB,IAAI,OAAO,CAAC,KAAK,EAAE;QACf,SAAS,CAAC,KAAK,EAAE,CAAC;KACrB;IACD,IAAI,OAAO,CAAC,QAAQ,EAAE;QAClB,IAAI,SAAS,CAAC,OAAO,CAAC,iBAAiB,KAAI,SAAS,aAAT,SAAS,uBAAT,SAAS,CAAE,OAAO,CAAA,EAAE;YAC3D,SAAS,CAAC,OAAO,CAAC,wBAAwB,CAAC,CAAC;SAC/C;QACD,MAAA,SAAS,CAAC,aAAa,0CAAE,IAAI,GAAG,KAAK,CAAC,OAAO,CAAC,IAAI,EAAE;KACvD;;;;IAID,IAAI,OAAO,OAAO,CAAC,IAAI,KAAK,QAAQ,IAAI,SAAS,CAAC,IAAI,KAAK,OAAO,CAAC,IAAI,EAAE;QACrE,SAAS,CAAC,UAAU,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;KACtC;;;;IAKD,IAAI,OAAO,CAAC,iBAAiB,EAAE;;QAE3B,MAAM,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;QACzB,MAAM,EAAE,GAAG,IAAI,aAAa,CAAC,UAAU,EAAE,EAAE,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;QACrD,IAAI,CAAC,WAAW,CAAC,SAAS,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE;YAChC,OAAO;SACV;;KAEJ;;;;;IAMD,IAAI,WAAW,GAAG,EAAE,CAAC;IACrB,IAAI,aAAa,GAAG,KAAK,CAAC;IAE1B,MAAM,KAAK,GAAG;QACV,GAAG,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,aAAa;QACzC,GAAG,SAAS,CAAC,KAAK;KACrB,CAAC;;;;;;;;IAQF,MAAM,SAAS,GAAG,cAAc,CAAC,IAAI,CAAC,CAAC;IACvC,IAAI,SAAS,CAAC,IAAI,KAAK,SAAS,EAAE;QAC9B,KAAK,MAAM,CAAC,IAAI,SAAS,EAAE;;;YAGvB,eAAe,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;gBAC7B,CAAC,CAAC,OAAO,GAAG,KAAK,CAAC;aACrB,CAAC,CAAC;YACH,KAAK,CAAC,WAAW,CAAC,yBAAyB,CAAC,KAAK,CAAC,CAAC,CAAC;YACpD,SAAS,CAAC,eAAe,GAAG,CAAC,CAAC;YAC9B,MAAM,OAAO,GAAG,gBAAgB,CAAC,KAAK,CAAC,CAAC;YACxC,MAAM,CAAC,KAAK,EAAE,CAAC,EAAE,EAAE,IAAI,EAAE,SAAS,EAAE,CAAC,CAAC;YACtC,MAAM,WAAW,GAAG,OAAO,CAAC,OAAO,GAAG,CAAC,CAAC,CAAC;YACzC,IAAI,WAAW,CAAC,MAAM,KAAK,CAAC,EAAE;gBAC1B,IAAI,kBAAkB,CAAC,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC,EAAE;;oBAEtC,eAAe,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;wBAC7B,CAAC,CAAC,OAAO,GAAG,IAAI,CAAC;qBACpB,CAAC,CAAC;iBACN;aACJ;iBAAM;gBACH,IAAI,WAAW,CAAC,CAAC,CAAC,CAAC,KAAK,KAAK,OAAO,GAAG,CAAC,EAAE;oBACtC,gBAAgB,CACZ,KAAK,EACL,WAAW,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,MAAM,CACvB,OAAO,CAAC,MAAM,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CACnD,CACJ,CAAC;iBACL;gBACD,WAAW,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;gBACnC,aAAa,GAAG,WAAW,CAAC,MAAM,GAAG,CAAC,CAAC;aAC1C;SACJ;KACJ;SAAM,IAAI,SAAS,CAAC,IAAI,KAAK,MAAM,EAAE;QAClC,KAAK,MAAM,CAAC,IAAI,SAAS,EAAE;YACvB,MAAM,CAAC,KAAK,EAAE,CAAC,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC;SACpD;KACJ;SAAM,IAAI,SAAS,CAAC,IAAI,KAAK,MAAM,EAAE;QAClC,KAAK,MAAM,CAAC,IAAI,SAAS,EAAE;;;;;YAKvB,MAAM,QAAQ,GAAG;gBACb,GAAG,EAAE,mBAAmB;gBACxB,CAAC,EAAE,iBAAiB;gBACpB,GAAG,EAAE,iBAAiB;aACzB,CAAC,CAAC,CAAC,CAAC;YACL,IAAI,QAAQ,EAAE;gBACV,SAAS,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC;aACtC;iBAAM,IACH,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC;gBACf,SAAS,CAAC,OAAO,CAAC,gBAAgB;gBAClC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,UAAU,KAAK,aAAa;gBACrD,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,aAAa,EACxC;;;;gBAIE,MAAM,CAAC,KAAK,EAAE,CAAC,EAAE;oBACb,IAAI,EAAE,MAAM;oBACZ,KAAK,EAAE,KAAK;iBACf,CAAC,CAAC;gBACH,eAAe,CAAC,KAAK,CAAC,CAAC;aAC1B;iBAAM;gBACH,MAAM,CAAC,KAAK,EAAE,CAAC,EAAE;oBACb,IAAI,EAAE,MAAM;oBACZ,KAAK,EAAE,KAAK;oBACZ,UAAU,EAAE,SAAS,CAAC,OAAO,CAAC,UAAU;iBAC3C,CAAC,CAAC;aACN;SACJ;KACJ;;;;IAKD,IAAI,SAAS,CAAC,IAAI,KAAK,SAAS,EAAE;QAC9B,SAAS,CAAC,mBAAmB,EAAE,CAAC;KACnC;;;;IAKD,SAAS,CAAC,KAAK,GAAG,IAAI,CAAC;;IAGvB,SAAS,CAAC,cAAc,EAAE,CAAC;;;;;;;IAQ3B,oBAAoB,CAAC,SAAS,EAAE,WAAW,EAAE,aAAa,CAAC,CAAC;AAChE;;ACliBAA,UAAe,CAAC;IACZ,IAAI,EAAE,CAAC,SAA2B;QAC9B,QAAQ,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC;;QAE9B,SAAS,CAAC,IAAI,EAAE,CAAC;QACjB,OAAO,IAAI,CAAC;KACf;IACD,IAAI,EAAE,CAAC,SAA2B;QAC9B,QAAQ,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC;QAC9B,SAAS,CAAC,IAAI,EAAE,CAAC;QACjB,OAAO,IAAI,CAAC;KACf;IACD,cAAc,EAAE,CAAC,SAA2B;QACxC,SAAS,CAAC,cAAc,EAAE,CAAC;QAC3B,OAAO,IAAI,CAAC;KACf;IACD,aAAa,EAAE,CAAC,SAA2B;QACvC,SAAS,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;QAC7B,OAAO,IAAI,CAAC;KACf;IACD,WAAW,EAAE,CAAC,SAA2B;QACrC,MAAM,WAAW,GAAG,SAAS,CAAC,KAAK,CAAC,qBAAqB,EAAE,CAAC;QAC5D,SAAS,CAAC,KAAK,CAAC,MAAM,CAAC,WAAW,CAAC,IAAI,GAAG,MAAM,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC;QAC7D,OAAO,IAAI,CAAC;KACf;IACD,gBAAgB,EAAE,CAAC,SAA2B;QAC1C,SAAS,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC;QAChC,OAAO,IAAI,CAAC;KACf;IACD,sBAAsB,EAAE,CAAC,SAA2B;QAChD,SAAS,CAAC,uBAAuB,GAAG,CAAC,SAAS,CAAC,uBAAuB,CAAC;QACvE,SAAS,CAAC,gBAAgB,CAAC,SAAS,GAAG,EAAE,CAAC;QAC1C,IAAI,CAAC,SAAS,CAAC,uBAAuB,EAAE;YACpC,SAAS,CAAC,gBAAgB,CAAC,KAAK,CAAC,UAAU,GAAG,QAAQ,CAAC;SAC1D;QACD,OAAO,KAAK,CAAC;KAChB;IACD,UAAU,EAAE,CAAC,SAA2B,EAAE,IAAe;QACrD,SAAS,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;QAC3B,OAAO,IAAI,CAAC;KACf;IACD,MAAM,EAAE,CAAC,SAA2B,EAAE,CAAS,EAAE,OAAO,KACpD,SAAS,CAAC,MAAM,CAAC,CAAC,EAAE,OAAO,CAAC;IAChC,SAAS,EAAE,CAAC,SAA2B,EAAE,IAAY,EAAE,OAAO;QAC1D,WAAW,CAAC,SAAS,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC;QACtC,OAAO,IAAI,CAAC;KACf;IACD,MAAM,EAAE,CAAC,SAA2B;QAChC,IAAI,OAAO,SAAS,CAAC,OAAO,CAAC,QAAQ,KAAK,UAAU,EAAE;YAClD,SAAS,CAAC,OAAO,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;SACzC;QACD,OAAO,IAAI,CAAC;KACf;CACJ,CAAC;;SCtDcJ,YAAU,CACtB,SAA2B,EAC3B,OAAc;IAEd,MAAM,KAAK,GAAG,aAAa,CAAC,OAAO,CAAC,CAAC;IACrC,SAAS,CAAC,oBAAoB,EAAE,CAAC;IACjC,MAAM,KAAK,GAAG,SAAS,CAAC,KAAK,CAAC;IAC9B,IAAI,KAAK,CAAC,oBAAoB,EAAE;;QAE5B,IACI,SAAS,CAAC,KAAK,CAAC,UAAU;YAC1B,KAAK,CAAC,UAAU,KAAK,SAAS,CAAC,KAAK,CAAC,UAAU,EACjD;YACE,KAAK,CAAC,UAAU,GAAG,MAAM,CAAC;SAC7B;QACD,IAAI,KAAK,CAAC,SAAS,IAAI,KAAK,CAAC,SAAS,KAAK,SAAS,CAAC,KAAK,CAAC,SAAS,EAAE;YAClE,KAAK,CAAC,SAAS,GAAG,MAAM,CAAC;SAC5B;QACD,IAAI,KAAK,CAAC,KAAK,IAAI,KAAK,CAAC,KAAK,KAAK,SAAS,CAAC,KAAK,CAAC,KAAK,EAAE;YACtD,KAAK,CAAC,KAAK,GAAG,MAAM,CAAC;SACxB;QACD,IACI,KAAK,CAAC,eAAe;YACrB,KAAK,CAAC,eAAe,KAAK,SAAS,CAAC,KAAK,CAAC,eAAe,EAC3D;YACE,KAAK,CAAC,eAAe,GAAG,MAAM,CAAC;SAClC;QACD,IAAI,KAAK,CAAC,QAAQ,IAAI,KAAK,CAAC,QAAQ,KAAK,SAAS,CAAC,KAAK,CAAC,QAAQ,EAAE;YAC/D,KAAK,CAAC,QAAQ,GAAG,MAAM,CAAC;SAC3B;;QAED,SAAS,CAAC,KAAK,GAAG,EAAE,GAAG,SAAS,CAAC,KAAK,EAAE,GAAG,KAAK,EAAE,CAAC;KACtD;SAAM;;QAEH,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,KAAK,KACjCM,YAAiB,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC,CACzC,CAAC;QACF,SAAS,CAAC,QAAQ,EAAE,CAAC;KACxB;IACD,OAAO,IAAI,CAAC;AAChB,CAAC;AAEDF,UAAe,CAAC,cAAEJ,YAAU,EAAE,EAAE,EAAE,MAAM,EAAE,WAAW,EAAE,CAAC,CAAC;AAEzD;;;AAGA,SAAS,aAAa,CAAC,KAA6B;IAChD,MAAM,MAAM,GAAU,EAAE,CAAC;IAEzB,IAAI,OAAO,KAAK,CAAC,KAAK,KAAK,QAAQ,EAAE;QACjC,MAAM,CAAC,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC;KAC9B;IAED,IAAI,OAAO,KAAK,CAAC,eAAe,KAAK,QAAQ,EAAE;QAC3C,MAAM,CAAC,eAAe,GAAG,KAAK,CAAC,eAAe,CAAC;KAClD;IAED,IAAI,OAAO,KAAK,CAAC,UAAU,KAAK,QAAQ,EAAE;QACtC,MAAM,CAAC,UAAU,GAAG,KAAK,CAAC,UAAU,CAAC;KACxC;IAED,IAAI,OAAO,KAAK,CAAC,MAAM,KAAK,QAAQ,EAAE;QAClC,MAAM,CAAC,UAAU,GAAG,KAAK,CAAC,MAAoB,CAAC;KAClD;IACD,IAAI,OAAO,KAAK,CAAC,UAAU,KAAK,QAAQ,EAAE;QACtC,MAAM,CAAC,UAAU,GAAG,KAAK,CAAC,UAAU,CAAC,WAAW,EAAgB,CAAC;KACpE;IACD,IAAI,MAAM,CAAC,UAAU,EAAE;QACnB,MAAM,CAAC,UAAU;YACb;gBACI,IAAI,EAAE,GAAG;gBACT,MAAM,EAAE,GAAG;gBACX,MAAM,EAAE,GAAG;aACd,CAAC,MAAM,CAAC,UAAU,CAAC,IAAI,MAAM,CAAC,UAAU,CAAC;KACjD;IAED,IAAI,OAAO,KAAK,CAAC,KAAK,KAAK,QAAQ,EAAE;QACjC,MAAM,CAAC,SAAS,GAAG,KAAK,CAAC,KAAkB,CAAC;KAC/C;IACD,IAAI,OAAO,KAAK,CAAC,SAAS,KAAK,QAAQ,EAAE;QACrC,MAAM,CAAC,SAAS,GAAG,KAAK,CAAC,SAAS,CAAC,WAAW,EAAe,CAAC;KACjE;IACD,IAAI,MAAM,CAAC,SAAS,EAAE;QAClB,MAAM,CAAC,SAAS;YACZ;gBACI,MAAM,EAAE,IAAI;gBACZ,EAAE,EAAE,GAAG;gBACP,OAAO,EAAE,GAAG;gBACZ,MAAM,EAAE,GAAG;aACd,CAAC,MAAM,CAAC,SAAS,CAAC,IAAI,MAAM,CAAC,SAAS,CAAC;KAC/C;IAED,IAAI,OAAO,KAAK,CAAC,IAAI,KAAK,QAAQ,EAAE;QAChC,MAAM,CAAC,QAAQ,GAAG,KAAK,CAAC,IAAI,CAAC;KAChC;SAAM,IAAI,OAAO,KAAK,CAAC,IAAI,KAAK,QAAQ,EAAE;QACvC,MAAM,CAAC,QAAQ,GAAG,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC;KACpE;IACD,IAAI,OAAO,KAAK,CAAC,QAAQ,KAAK,QAAQ,EAAE;QACpC,MAAM,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC;KAClD;IACD,IAAI,MAAM,CAAC,QAAQ,EAAE;QACjB,MAAM,CAAC,QAAQ;YACX;gBACI,IAAI,EAAE,OAAO;gBACb,UAAU,EAAE,OAAO;gBACnB,YAAY,EAAE,OAAO;gBACrB,KAAK,EAAE,OAAO;gBACd,MAAM,EAAE,OAAO;gBACf,UAAU,EAAE,OAAO;gBACnB,KAAK,EAAE,OAAO;gBACd,KAAK,EAAE,OAAO;gBACd,KAAK,EAAE,OAAO;gBACd,IAAI,EAAE,OAAO;gBACb,IAAI,EAAE,QAAQ;aACjB,CAAC,MAAM,CAAC,QAAQ,CAAC,IAAI,MAAM,CAAC,QAAQ,CAAC;KAC7C;IAED,OAAO,MAAM,CAAC;AAClB;;SCtHgB,OAAO,CACnB,SAA2B,EAC3B,EAAkB;IAElB,IAAI,IAAI,GAAG,EAAE,CAAC;;IAGd,MAAM,IAAI,GAAG,EAAE,CAAC,aAAa,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC;IAC1D,IAAI,IAAI,EAAE;QACN,IAAI;YACA,IAAI,GAAG,WAAW,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,EAAE,CAAC,CAAC;SAC5C;QAAC,OAAO,CAAC,EAAE;YACR,IAAI,GAAG,EAAE,CAAC;SACb;KACJ;;IAED,IAAI,CAAC,IAAI,EAAE;QACP,IAAI,GAAG,EAAE,CAAC,aAAa,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC;KACjD;IAED,IAAI,IAAI,EAAE;QACN,IACI,MAAM,CAAC,SAAS,CAAC,KAAK,EAAE,IAAI,EAAE;YAC1B,UAAU,EAAE,SAAS,CAAC,OAAO,CAAC,UAAU;YACxC,IAAI,EAAE,MAAM;SACf,CAAC,EACJ;YACE,aAAa,CAAC,SAAS,CAAC,CAAC;SAC5B;QACD,EAAE,CAAC,cAAc,EAAE,CAAC;QACpB,EAAE,CAAC,eAAe,EAAE,CAAC;KACxB;IACD,OAAO,IAAI,CAAC;AAChB,CAAC;SACe,KAAK,CAAC,SAA2B;;;;;IAK7C,UAAU,CACN;QACI,SAAS,CAAC,eAAe,EAAE,CAAC;QAC5B,aAAa,CAAC,SAAS,CAAC,CAAC;KAC5B,CAAC,IAAI,CAAC,SAAS,CAAC,EACjB,CAAC,CACJ,CAAC;IACF,OAAO,IAAI,CAAC;AAChB,CAAC;SACe,MAAM,CAAC,SAA2B,EAAE,CAAiB;IACjE,IAAI,SAAS,CAAC,KAAK,CAAC,oBAAoB,EAAE;QACtC,CAAC,CAAC,aAAa,CAAC,OAAO,CACnB,YAAY,EACZ,IAAI,GAAG,SAAS,CAAC,QAAQ,CAAC,gBAAgB,CAAC,GAAG,IAAI,CACrD,CAAC;QACF,CAAC,CAAC,aAAa,CAAC,OAAO,CAAC,kBAAkB,EAAE,SAAS,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC;QACxE,CAAC,CAAC,aAAa,CAAC,OAAO,CACnB,iBAAiB,EACjB,SAAS,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAC/B,CAAC;KACL;SAAM;QACH,CAAC,CAAC,aAAa,CAAC,OAAO,CACnB,YAAY,EACZ,IAAI;YACA,SAAS,CAAC,QAAQ,CAAC,SAAS,CAAC,SAAS,EAAE,gBAAgB,CAAC;YACzD,IAAI,CACX,CAAC;QACF,CAAC,CAAC,aAAa,CAAC,OAAO,CACnB,kBAAkB,EAClB,SAAS,CAAC,QAAQ,CAAC,SAAS,CAAC,SAAS,EAAE,MAAM,CAAC,CAClD,CAAC;QACF,CAAC,CAAC,aAAa,CAAC,OAAO,CACnB,iBAAiB,EACjB,SAAS,CAAC,QAAQ,CAAC,SAAS,CAAC,SAAS,EAAE,QAAQ,CAAC,CACpD,CAAC;KACL;;IAED,CAAC,CAAC,cAAc,EAAE,CAAC;AACvB,CAAC;AAEDI,UAAe,CACX;IACI,eAAe,EAAE,CAAC,SAA2B;QACzC,SAAS,CAAC,KAAK,EAAE,CAAC;;;QAGlB,IAAI,SAAS,CAAC,KAAK,CAAC,oBAAoB,EAAE;YACtC,SAAS,CAAC,MAAM,EAAE,CAAC;SACtB;QACD,QAAQ,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;QAC7B,OAAO,KAAK,CAAC;KAChB;IAED,cAAc,EAAE,CAAC,SAA2B;QACxC,SAAS,CAAC,KAAK,EAAE,CAAC;QAClB,QAAQ,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;QAC5B,OAAO,IAAI,CAAC;KACf;IAED,kBAAkB,EAAE,CAAC,SAA2B;QAC5C,SAAS,CAAC,KAAK,EAAE,CAAC;QAClB,QAAQ,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;QAC9B,OAAO,IAAI,CAAC;KACf;CACJ,EACD,EAAE,MAAM,EAAE,WAAW,EAAE,QAAQ,EAAE,WAAW,EAAE,CACjD;;ACxGD,IAAI,QAAgD,CAAC;AACrD,IAAI,SAAS,GAAG,CAAC,CAAC;SAEF,aAAa,CACzB,SAA2B,EAC3B,GAAiB;;IAEjB,MAAM,IAAI,GAAG,SAAS,CAAC;IACvB,IAAI,MAAc,CAAC;IACnB,IAAI,eAAe,GAAG,KAAK,CAAC;IAE5B,IAAI,KAAK,GAAG,KAAK,CAAC;;;;;;IAOlB,IAAI,GAAG,CAAC,OAAO,KAAK,CAAC,IAAI,GAAG,CAAC,OAAO,KAAK,CAAC,EAAE;QACxC,OAAO;KACV;IACD,IAAI,UAAU,GAAG,KAAK,CAAC;IACvB,IAAI,WAAW,GAAG,KAAK,CAAC;;IAExB,MAAM,OAAO,GAAG,GAAG,CAAC,SAAS,CAAC,GAAG,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,GAAG,GAAG,CAAC,OAAO,CAAC;IACzE,MAAM,OAAO,GAAG,GAAG,CAAC,SAAS,CAAC,GAAG,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,GAAG,GAAG,CAAC,OAAO,CAAC;IACzE,MAAM,UAAU,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;IAC9B,MAAM,cAAc,GAAG,WAAW,CAAC;QAC/B,IAAI,UAAU,EAAE;YACZ,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,UAAU,GAAG,EAAE,EAAE,CAAC,CAAC;SACnE;aAAM,IAAI,WAAW,EAAE;YACpB,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,UAAU,GAAG,EAAE,EAAE,CAAC,CAAC;SACnE;KACJ,EAAE,EAAE,CAAC,CAAC;IACP,SAAS,kBAAkB,CAAC,GAAkB;QAC1C,IAAI,MAAM,CAAC,YAAY,EAAE;YACrB,GAAG,CAAC,IAAI,CAAC,KAAK,EAAE,aAAa,EAAE,aAAa,CAAC,CAAC;YAC9C,GAAG,CAAC,IAAI,CAAC,KAAK,EAAE,yBAAyB,EAAE,kBAAkB,CAAC,CAAC;;;YAG/D,IAAI,GAAG;gBAAE,IAAI,CAAC,KAAK,CAAC,qBAAqB,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;SAC5D;aAAM;YACH,GAAG,CAAC,IAAI,CAAC,KAAK,EAAE,WAAW,EAAE,aAAa,CAAC,CAAC;YAC5C,GAAG,CAAC,IAAI,CAAC,KAAK,EAAE,sBAAsB,EAAE,kBAAkB,CAAC,CAAC;YAC5D,GAAG,CAAC,MAAM,EAAE,WAAW,EAAE,aAAa,CAAC,CAAC;YACxC,GAAG,CAAC,MAAM,EAAE,cAAc,EAAE,kBAAkB,CAAC,CAAC;SACnD;QACD,eAAe,GAAG,KAAK,CAAC;QACxB,aAAa,CAAC,cAAc,CAAC,CAAC;QAC9B,SAAS,CAAC,OAAO,CAAC,SAAS,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;QAC/C,IAAI,GAAG,EAAE;YACL,GAAG,CAAC,cAAc,EAAE,CAAC;YACrB,GAAG,CAAC,eAAe,EAAE,CAAC;SACzB;KACJ;IAED,SAAS,aAAa,CAAC,GAAiB;;QAEpC,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,EAAE;YAClB,kBAAkB,EAAE,CAAC;YACrB,OAAO;SACV;QACD,MAAM,CAAC,GAAG,GAAG,CAAC,SAAS,CAAC,GAAG,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,GAAG,GAAG,CAAC,OAAO,CAAC;QACnE,MAAM,CAAC,GAAG,GAAG,CAAC,SAAS,CAAC,GAAG,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,GAAG,GAAG,CAAC,OAAO,CAAC;;;QAGnE,MAAM,UAAU,GAAG,GAAG,CAAC,WAAW,KAAK,OAAO,GAAG,EAAE,GAAG,CAAC,CAAC;QACxD,IACI,IAAI,CAAC,GAAG,EAAE,GAAG,UAAU,GAAG,GAAG;YAC7B,IAAI,CAAC,GAAG,CAAC,OAAO,GAAG,CAAC,CAAC,GAAG,UAAU;YAClC,IAAI,CAAC,GAAG,CAAC,OAAO,GAAG,CAAC,CAAC,GAAG,UAAU,EACpC;YACE,GAAG,CAAC,cAAc,EAAE,CAAC;YACrB,GAAG,CAAC,eAAe,EAAE,CAAC;YACtB,OAAO;SACV;QACD,MAAM,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,qBAAqB,EAAE,CAAC;QACvD,WAAW,GAAG,CAAC,GAAG,WAAW,CAAC,KAAK,CAAC;QACpC,UAAU,GAAG,CAAC,GAAG,WAAW,CAAC,IAAI,CAAC;QAClC,IAAI,YAAY,GAAW,MAAM,CAAC;QAClC,IAAI,MAAM,CAAC,YAAY,EAAE;YACrB,IAAI,CAAC,GAAG,CAAC,SAAS,EAAE;gBAChB,YAAY,GAAG,eAAe,CAAC,IAAI,EAAE,GAAG,CAAC,OAAO,EAAE,GAAG,CAAC,OAAO,EAAE;oBAC3D,IAAI,EAAE,CAAC;iBACV,CAAC,CAAC;aACN;SACJ;aAAM;YACH,IAAI,GAAG,CAAC,SAAS,CAAC,IAAI,GAAG,CAAC,SAAS,CAAC,CAAC,MAAM,KAAK,CAAC,EAAE;gBAC/C,YAAY,GAAG,eAAe,CAC1B,IAAI,EACJ,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,EACzB,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,EACzB,EAAE,IAAI,EAAE,CAAC,EAAE,CACd,CAAC;aACL;SACJ;QACD,MAAM,KAAK,GAAG,eAAe,CAAC,IAAI,EAAE,CAAC,EAAE,CAAC,EAAE;YACtC,IAAI,EAAE,CAAC,IAAI,OAAO,IAAI,CAAC,KAAK,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC;SACrD,CAAC,CAAC;QAIH,IAAI,YAAY,IAAI,CAAC,IAAI,KAAK,IAAI,CAAC,EAAE;YACjC,IAAI,CAAC,KAAK,CAAC,iBAAiB,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;YAClD,aAAa,CAAC,SAAS,CAAC,CAAC;SAC5B;;QAED,GAAG,CAAC,cAAc,EAAE,CAAC;QACrB,GAAG,CAAC,eAAe,EAAE,CAAC;KACzB;;IAGD,IACI,QAAQ;QACR,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,GAAG,OAAO,CAAC,GAAG,CAAC;QAClC,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,GAAG,OAAO,CAAC,GAAG,CAAC;QAClC,IAAI,CAAC,GAAG,EAAE,GAAG,QAAQ,CAAC,IAAI,GAAG,GAAG,EAClC;QACE,SAAS,IAAI,CAAC,CAAC;QACf,QAAQ,CAAC,IAAI,GAAG,UAAU,CAAC;KAC9B;SAAM;QACH,QAAQ,GAAG;YACP,CAAC,EAAE,OAAO;YACV,CAAC,EAAE,OAAO;YACV,IAAI,EAAE,UAAU;SACnB,CAAC;QACF,SAAS,GAAG,CAAC,CAAC;KACjB;IACD,MAAM,MAAM,GAAG,SAAS,CAAC,KAAK,CAAC,qBAAqB,EAAE,CAAC;IACvD,IACI,OAAO,IAAI,MAAM,CAAC,IAAI;QACtB,OAAO,IAAI,MAAM,CAAC,KAAK;QACvB,OAAO,IAAI,MAAM,CAAC,GAAG;QACrB,OAAO,IAAI,MAAM,CAAC,MAAM,EAC1B;;QAEE,IAAI,CAAC,SAAS,CAAC,QAAQ,EAAE,EAAE;YACvB,KAAK,GAAG,IAAI,CAAC;YACb,SAAS,CAAC,gBAAgB,CAAC,KAAK,EAAE,CAAC;SACtC;;;QAID,SAAS,CAAC,oBAAoB,EAAE,CAAC;QACjC,SAAS,CAAC,mBAAmB,GAAG,KAAK,CAAC;QAEtC,MAAM,GAAG,eAAe,CAAC,SAAS,EAAE,OAAO,EAAE,OAAO,EAAE;YAClD,IAAI,EAAE,CAAC;SACV,CAAC,CAAC;QACH,IAAI,MAAM,IAAI,CAAC,EAAE;;;YAGb,SAAS,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;YAE5C,IAAI,GAAG,CAAC,QAAQ,EAAE;;;gBAGd,SAAS,CAAC,KAAK,CAAC,iBAAiB,CAC7B,SAAS,CAAC,KAAK,CAAC,MAAM,EACtB,MAAM,CACT,CAAC;aACL;iBAAM;gBACH,IAAI,SAAS,CAAC,KAAK,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,IAAI,KAAK,aAAa,EAAE;oBACnD,SAAS,CAAC,KAAK,CAAC,YAAY,CAAC,MAAM,GAAG,CAAC,EAAE,MAAM,CAAC,CAAC;iBACpD;qBAAM,IACH,OAAA,SAAS,CAAC,KAAK,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,YAAY,0CAAE,IAAI;oBAC7C,aAAa,EACf;oBACE,SAAS,CAAC,KAAK,CAAC,YAAY,CAAC,MAAM,EAAE,MAAM,GAAG,CAAC,CAAC,CAAC;iBACpD;qBAAM;oBACH,SAAS,CAAC,KAAK,CAAC,QAAQ,GAAG,MAAM,CAAC;iBACrC;aACJ;;YAGD,KAAK,GAAG,IAAI,CAAC;;YAGb,SAAS,CAAC,KAAK,GAAG,EAAE,CAAC;;;;YAIrB,IAAI,GAAG,CAAC,MAAM,KAAK,CAAC,IAAI,SAAS,GAAG,CAAC,EAAE;gBACnC,kBAAkB,CAAC,GAAG,CAAC,CAAC;gBACxB,IAAI,GAAG,CAAC,MAAM,KAAK,CAAC,IAAI,SAAS,KAAK,CAAC,EAAE;;oBAErC,SAAS,CAAC,KAAK,CAAC,SAAS,GAAG;wBACxB,MAAM,EAAE,CAAC,CAAC,CAAC,EAAE,SAAS,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;qBAC5C,CAAC;iBACL;aACJ;iBAAM,IAAI,CAAC,eAAe,EAAE;gBACzB,eAAe,GAAG,IAAI,CAAC;gBACvB,IAAI,MAAM,CAAC,YAAY,EAAE;oBACrB,EAAE,CAAC,IAAI,CAAC,KAAK,EAAE,aAAa,EAAE,aAAa,CAAC,CAAC;oBAC7C,EAAE,CACE,IAAI,CAAC,KAAK,EACV,yBAAyB,EACzB,kBAAkB,CACrB,CAAC;oBACF,IAAI,CAAC,KAAK,CAAC,iBAAiB,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;iBAC/C;qBAAM;oBACH,EAAE,CAAC,MAAM,EAAE,MAAM,EAAE,kBAAkB,CAAC,CAAC;oBACvC,IAAI,GAAG,CAAC,SAAS,CAAC,EAAE;;;;;wBAKhB,EAAE,CAAC,GAAG,CAAC,MAAM,EAAE,WAAW,EAAE,aAAa,CAAC,CAAC;wBAC3C,EAAE,CACE,GAAG,CAAC,MAAM,EACV,sBAAsB,EACtB,kBAAkB,CACrB,CAAC;qBACL;yBAAM;wBACH,EAAE,CAAC,MAAM,EAAE,WAAW,EAAE,aAAa,CAAC,CAAC;wBACvC,EAAE,CAAC,MAAM,EAAE,SAAS,EAAE,kBAAkB,CAAC,CAAC;qBAC7C;iBACJ;gBACD,IAAI,GAAG,CAAC,MAAM,KAAK,CAAC,IAAI,SAAS,KAAK,CAAC,EAAE;oBAGrC,WAAW,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;iBAChC;aACJ;SACJ;KACJ;SAAM;QACH,QAAQ,GAAG,IAAI,CAAC;KACnB;IACD,IAAI,KAAK,EAAE;QACP,aAAa,CAAC,SAAS,CAAC,CAAC;KAC5B;;;IAGD,GAAG,CAAC,cAAc,EAAE,CAAC;AACzB,CAAC;AAED,SAAS,QAAQ,CAAC,CAAS,EAAE,CAAS,EAAE,CAAO;IAC3C,MAAM,EAAE,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,GAAG,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC;IACtC,MAAM,EAAE,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,MAAM,IAAI,CAAC,CAAC;IACtC,OAAO,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC;AAC7B,CAAC;AAED,SAAS,6BAA6B,CAClC,SAA2B,EAC3B,IAAU,EACV,CAAS,EACT,CAAS;IAET,IAAI,MAAM,GAAG,EAAE,QAAQ,EAAE,QAAQ,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC;IAEhD,IAAI,IAAI,CAAC,IAAI,KAAK,WAAW,EAAE;QAC3B,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;KACxB;IACD,MAAM,MAAM,GAAG,aAAa,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;IAC9C,IAAI,CAAC,MAAM;QAAE,OAAO,MAAM,CAAC;;;;IAK3B,IACI,CAAC,IAAI,CAAC,gBAAgB;QACtB,CAAC,IAAI,MAAM,CAAC,IAAI;QAChB,CAAC,IAAI,MAAM,CAAC,KAAK;QACjB,IAAI,CAAC,WAAW,EAClB;QACE,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,IAAI;YACvB,MAAM,CAAC,GAAG,6BAA6B,CAAC,SAAS,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;YAC/D,IAAI,CAAC,CAAC,QAAQ,GAAG,MAAM,CAAC,QAAQ,EAAE;gBAC9B,MAAM,GAAG,CAAC,CAAC;aACd;SACJ,CAAC,CAAC;KACN;;;;IAKD,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE;QACd,MAAM,CAAC,IAAI,GAAG,IAAI,CAAC;QACnB,MAAM,CAAC,QAAQ,GAAG,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,MAAM,CAAC,CAAC;KAC5C;IAED,OAAO,MAAM,CAAC;AAClB,CAAC;AAED,SAAS,oBAAoB,CACzB,SAA2B,EAC3B,CAAS,EACT,CAAS;IAET,OAAO,6BAA6B,CAAC,SAAS,EAAE,SAAS,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;SACtE,IAAI,CAAC;AACd,CAAC;AACD;;;;;SAKgB,eAAe,CAC3B,SAA2B,EAC3B,CAAS,EACT,CAAS,EACT,OAA2B;;IAE3B,MAAM,MAAM,GAAG,SAAS,CAAC,YAAY,CAAC,qBAAqB,EAAE,CAAC;IAC9D,IAAI,CAAC,GAAG,MAAM,CAAC,KAAK,IAAI,CAAC,GAAG,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;QAC3C,OAAO,SAAS,CAAC,KAAK,CAAC,UAAU,CAAC;KACrC;IACD,IAAI,CAAC,GAAG,MAAM,CAAC,IAAI,IAAI,CAAC,GAAG,MAAM,CAAC,GAAG,GAAG,CAAC,EAAE;QACvC,OAAO,CAAC,CAAC;KACZ;IAED,OAAO,GAAG,OAAO,aAAP,OAAO,cAAP,OAAO,GAAI,EAAE,CAAC;IACxB,OAAO,CAAC,IAAI,SAAG,OAAO,CAAC,IAAI,mCAAI,CAAC,CAAC;;;IAIjC,MAAM,IAAI,GAAG,oBAAoB,CAAC,SAAS,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IACnD,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;IAClB,IAAI,MAAM,GAAG,SAAS,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;IAE5C,IAAI,MAAM,GAAG,CAAC;QAAE,OAAO,CAAC,CAAC,CAAC;;IAG1B,IAAI,OAAO,CAAC,IAAI,KAAK,CAAC,EAAE;;;;QAIpB,MAAM,MAAM,GAAG,aAAa,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;QAC9C,IACI,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,GAAG,MAAM,CAAC,KAAK,IAAI,CAAC;YACpC,IAAI,CAAC,IAAI,KAAK,aAAa,EAC7B;YACE,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,KAAK,CAAC,UAAU,EAAE,MAAM,GAAG,CAAC,CAAC,CAAC;SAC7D;KACJ;SAAM,IAAI,OAAO,CAAC,IAAI,GAAG,CAAC,EAAE;QACzB,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,MAAM,GAAG,CAAC,CAAC,CAAC;KACpC;IACD,OAAO,MAAM,CAAC;AAClB;;;;;;ACtUA,MAAM,SAAS,GAAG;IACd,OAAO,EAAE;QACL,OAAO,EAAE,0BAA0B;QACnC,KAAK,EAAE,MAAM;QACb,KAAK,EAAE,KAAK;QACZ,MAAM,EAAE,CAAC,MAAM,CAAC;KACnB;IACD,KAAK,EAAE;QACH,OAAO,EAAE,wBAAwB;QACjC,KAAK,EAAE,aAAa;QACpB,KAAK,EAAE,KAAK;QACZ,MAAM,EAAE,CAAC,aAAa,EAAE,aAAa,CAAC;KACzC;IACD,KAAK,EAAE;QACH,OAAO,EAAE,wBAAwB;QACjC,KAAK,EAAE,aAAa;QACpB,KAAK,EAAE,sBAAsB;QAC7B,OAAO,EAAE,UAAU;QACnB,MAAM,EAAE,CAAC,aAAa,EAAE,aAAa,CAAC;KACzC;IACD,SAAS,EAAE;QACP,OAAO,EAAE,4BAA4B;QACrC,KAAK,EAAE,WAAW;QAClB,KAAK,EAAE,oBAAoB;QAC3B,OAAO,EAAE,KAAK;QACd,MAAM,EAAE,CAAC,WAAW,CAAC;KACxB;IACD,OAAO,EAAE;QACL,OAAO,EAAE,0BAA0B;QACnC,KAAK,EAAE,SAAS;QAChB,KAAK,EAAE,WAAW;QAClB,OAAO,EAAE,KAAK;QACd,MAAM,EAAE,CAAC,SAAS,CAAC;KACtB;IACD,OAAO,EAAE;QACL,OAAO,EAAE,0BAA0B;;;;QAInC,OAAO,EAAE,kBAAkB;QAC3B,KAAK,EAAE,8CAA8C;QACrD,MAAM,EAAE,CAAC,eAAe,EAAE,eAAe,EAAE,iBAAiB,CAAC;KAChE;IACD,KAAK,EAAE;QACH,OAAO,EAAE,wBAAwB;QACjC,KAAK,EAAE,OAAO;QACd,KAAK,EAAE,oBAAoB;KAC9B;CACJ,CAAC;AAEF,MAAM,YAAY,GAAG;IACjB,WAAW,EAAE,CAAC,OAAO,EAAE,QAAQ,CAAC;IAChC,aAAa,EAAE,CAAC,SAAS,EAAE,UAAU,CAAC;IACtC,YAAY,EAAE,CAAC,UAAU,EAAE,eAAe,CAAC;IAC3C,QAAQ,EAAE,CAAC,QAAQ,EAAE,cAAc,CAAC;IACpC,QAAQ,EAAE,CAAC,SAAS,EAAE,cAAc,CAAC;IACrC,YAAY,EAAE,CAAC,WAAW,EAAE,YAAY,CAAC;IACzC,UAAU,EAAE,CAAC,SAAS,EAAE,UAAU,CAAC;IACnC,SAAS,EAAE,CAAC,QAAQ,EAAE,cAAc,CAAC;IACrC,YAAY,EAAE,CAAC,UAAU,EAAE,cAAc,CAAC;IAC1C,OAAO,EAAE,CAAC,MAAM,EAAE,OAAO,CAAC;IAC1B,UAAU,EAAE,CAAC,SAAS,EAAE,cAAc,CAAC;IACvC,UAAU,EAAE,CAAC,SAAS,EAAE,UAAU,CAAC;IACnC,UAAU,EAAE,CAAC,SAAS,EAAE,UAAU,CAAC;IACnC,QAAQ,EAAE,CAAC,UAAU,EAAE,QAAQ,CAAC;IAChC,UAAU,EAAE,CAAC,SAAS,EAAE,UAAU,CAAC;IACnC,QAAQ,EAAE,CAAC,OAAO,EAAE,cAAc,CAAC;IACnC,OAAO,EAAE,CAAC,MAAM,EAAE,OAAO,CAAC;IAC1B,UAAU,EAAE,CAAC,SAAS,EAAE,cAAc,CAAC;IACvC,WAAW,EAAE,CAAC,UAAU,EAAE,WAAW,CAAC;IACtC,SAAS,EAAE,CAAC,QAAQ,EAAE,cAAc,CAAC;IACrC,QAAQ,EAAE,CAAC,OAAO,EAAE,cAAc,CAAC;IACnC,QAAQ,EAAE,CAAC,OAAO,EAAE,QAAQ,CAAC;IAC7B,UAAU,EAAE,CAAC,SAAS,EAAE,UAAU,CAAC;IACnC,SAAS,EAAE,CAAC,QAAQ,EAAE,cAAc,CAAC;IACrC,OAAO,EAAE,CAAC,MAAM,EAAE,cAAc,CAAC;IACjC,OAAO,EAAE,CAAC,MAAM,EAAE,cAAc,CAAC;CACpC,CAAC;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,MAAM,aAAa,GAAG;IAClB,GAAG,EAAE;QACD,YAAY;QACZ,cAAc;QACd,SAAS;QACT,EAAE,KAAK,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE;QACjC,QAAQ;QACR,WAAW;QACX,UAAU;KACb;IACD,GAAG,EAAE,CAAC,cAAc,EAAE,EAAE,KAAK,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,CAAC;IACxD,GAAG,EAAE,CAAC,cAAc,EAAE,EAAE,KAAK,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,CAAC;IACxD,GAAG,EAAE;QACD,GAAG;QACH,GAAG;QACH,SAAS;QACT,EAAE,KAAK,EAAE,GAAG,EAAE,KAAK,EAAE,OAAO,EAAE;QAC9B,EAAE,KAAK,EAAE,SAAS,EAAE,KAAK,EAAE,YAAY,EAAE,OAAO,EAAE,KAAK,EAAE;QACzD,EAAE,KAAK,EAAE,SAAS,EAAE,KAAK,EAAE,iBAAiB,EAAE,OAAO,EAAE,KAAK,EAAE;QAC9D,EAAE,KAAK,EAAE,SAAS,EAAE,KAAK,EAAE,SAAS,EAAE,OAAO,EAAE,KAAK,EAAE;QACtD,EAAE,KAAK,EAAE,SAAS,EAAE,KAAK,EAAE,cAAc,EAAE,OAAO,EAAE,KAAK,EAAE;QAC3D,EAAE,KAAK,EAAE,SAAS,EAAE,KAAK,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE;QAC/C,EAAE,KAAK,EAAE,SAAS,EAAE,KAAK,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE;QAC/C,QAAQ;QACR,UAAU;QACV,eAAe;KAClB;IAED,GAAG,EAAE;QACD,QAAQ;QACR,OAAO;QACP,QAAQ;QACR,WAAW;QACX,UAAU;QACV,UAAU;QACV,mBAAmB;QACnB,kBAAkB;QAClB,YAAY;QACZ,QAAQ;QACR,EAAE,KAAK,EAAE,gCAAgC,EAAE,OAAO,EAAE,OAAO,EAAE;KAChE;IAED,GAAG,EAAE;QACD,MAAM;QACN,MAAM;QACN,OAAO;QACP,EAAE,KAAK,EAAE,+BAA+B,EAAE,OAAO,EAAE,OAAO,EAAE;QAC5D,WAAW;QACX,SAAS;KACZ;IACD,GAAG,EAAE,CAAC,MAAM,EAAE,MAAM,EAAE,UAAU,EAAE,mBAAmB,CAAC;IAEtD,GAAG,EAAE,CAAC,iBAAiB,EAAE,GAAG,EAAE,OAAO,CAAC;IAEtC,GAAG,EAAE;QACD,oBAAoB;QACpB,oBAAoB;QACpB,wBAAwB;QACxB,kCAAkC;QAClC,UAAU;QACV,YAAY;QACZ,GAAG;QACH,UAAU;QACV,SAAS;QACT,SAAS;QACT,UAAU;QACV,UAAU;QACV,SAAS;QACT,YAAY;QACZ,cAAc;QACd,UAAU;KACb;IAED,GAAG,EAAE;QACD,UAAU;QACV,YAAY;QACZ,GAAG;QACH,UAAU;QACV,SAAS;QACT,SAAS;QACT,UAAU;QACV,UAAU;QACV,SAAS;QACT,YAAY;QACZ,cAAc;QACd,UAAU;KACb;IAED,GAAG,EAAE;QACD,QAAQ;QACR,SAAS;QACT,SAAS;QACT,mBAAmB;QACnB,aAAa;QACb,eAAe;QACf,YAAY;QACZ,YAAY;QACZ,WAAW;QACX,SAAS;QACT,SAAS;QACT,UAAU;QACV,UAAU;QACV,SAAS;QACT,SAAS;QACT,iBAAiB;QACjB,gBAAgB;QAChB,WAAW;QACX,UAAU;QACV,UAAU;QACV,aAAa;QACb,WAAW;KACd;IAED,IAAI,EAAE,CAAC,OAAO,EAAE,SAAS,EAAE,EAAE,EAAE,QAAQ,CAAC;IAExC,GAAG,EAAE;QACD,OAAO;QACP,QAAQ;QACR,SAAS;QACT,MAAM;QACN,SAAS;QACT,QAAQ;QACR,WAAW;QACX,WAAW;QACX,WAAW;QACX,QAAQ;QACR,eAAe;QACf,WAAW;QACX,SAAS;KACZ;IAED,GAAG,EAAE;QACD,OAAO;QACP,QAAQ;QACR,SAAS;QACT,MAAM;QACN,QAAQ;QACR,QAAQ;QACR,WAAW;QACX,UAAU;QACV,WAAW;QACX,QAAQ;QACR,eAAe;QACf,UAAU;QACV,SAAS;KACZ;IAED,GAAG,EAAE,CAAC,MAAM,EAAE,QAAQ,EAAE,UAAU,EAAE,WAAW,EAAE,UAAU,EAAE,WAAW,CAAC;IAEzE,MAAM,EAAE,CAAC,SAAS,EAAE,eAAe,CAAC;IAEpC,MAAM,EAAE,EAAE;IACV,MAAM,EAAE,EAAE;IAEV,QAAQ,EAAE,CAAC,WAAW,EAAE,WAAW,EAAE,SAAS,EAAE,eAAe,CAAC;IAEhE,YAAY,EAAE,CAAC,QAAQ,EAAE,SAAS,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC;IAEvE,EAAE,EAAE,CAAC,iBAAiB,EAAE,MAAM,EAAE,WAAW,EAAE,OAAO,CAAC;IAErD,GAAG,EAAE,CAAC,OAAO,CAAC;;IAGd,GAAG,EAAE;QACD,EAAE,KAAK,EAAE,iBAAiB,EAAE,OAAO,EAAE,OAAO,EAAE;QAC9C,EAAE,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE;QACpC,EAAE,KAAK,EAAE,YAAY,EAAE,OAAO,EAAE,OAAO,EAAE;QACzC,EAAE,KAAK,EAAE,QAAQ,EAAE,OAAO,EAAE,OAAO,EAAE;QACrC,EAAE,KAAK,EAAE,SAAS,EAAE,OAAO,EAAE,OAAO,EAAE;QACtC,EAAE,KAAK,EAAE,QAAQ,EAAE,OAAO,EAAE,OAAO,EAAE;QACrC,EAAE,KAAK,EAAE,uBAAuB,EAAE,OAAO,EAAE,OAAO,EAAE;QACpD,EAAE,KAAK,EAAE,gCAAgC,EAAE,OAAO,EAAE,OAAO,EAAE;QAE7D,wBAAwB;QACxB,MAAM;QACN,WAAW;KACd;IAED,KAAK,EAAE,CAAC,gBAAgB,EAAE,eAAe,EAAE,aAAa,CAAC;IAEzD,GAAG,EAAE,CAAC,IAAI,EAAE,SAAS,EAAE,MAAM,CAAC;IAC9B,OAAO,EAAE;QACL,WAAW;QACX,WAAW;QACX,WAAW;QACX,aAAa;QACb,WAAW;QACX,YAAY;QACZ,gBAAgB;QAChB,aAAa;QACb,aAAa;QACb,aAAa;QACb,aAAa;KAChB;;;;;;;IAQD,CAAC,EAAE;QACC,EAAE,KAAK,EAAE,SAAS,EAAE,KAAK,EAAE,OAAO,EAAE;QACpC,EAAE,KAAK,EAAE,UAAU,EAAE,KAAK,EAAE,SAAS,EAAE;KAC1C;IACD,CAAC,EAAE;QACC,EAAE,KAAK,EAAE,SAAS,EAAE,KAAK,EAAE,OAAO,EAAE;QACpC,EAAE,KAAK,EAAE,UAAU,EAAE,KAAK,EAAE,SAAS,EAAE;KAC1C;IACD,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,QAAQ,EAAE,KAAK,EAAE,MAAM,EAAE,CAAC;IACvC,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,QAAQ,EAAE,KAAK,EAAE,MAAM,EAAE,CAAC;IACvC,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,wBAAwB,EAAE,CAAC;IACtD,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,UAAU,EAAE,KAAK,EAAE,QAAQ,EAAE,CAAC;IAC3C,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,UAAU,EAAE,KAAK,EAAE,QAAQ,EAAE,CAAC;IAC3C,CAAC,EAAE;QACC,EAAE,KAAK,EAAE,gBAAgB,EAAE,KAAK,EAAE,eAAe,EAAE;QACnD,EAAE,KAAK,EAAE,UAAU,EAAE,KAAK,EAAE,UAAU,EAAE;QACxC,EAAE,KAAK,EAAE,WAAW,EAAE,KAAK,EAAE,aAAa,EAAE;KAC/C;IACD,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,SAAS,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC;IACzC,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,SAAS,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC;IACzC,CAAC,EAAE;QACC,EAAE,KAAK,EAAE,QAAQ,EAAE,KAAK,EAAE,OAAO,EAAE;QACnC,EAAE,KAAK,EAAE,UAAU,EAAE,KAAK,EAAE,SAAS,EAAE;KAC1C;IACD,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,cAAc,EAAE,KAAK,EAAE,aAAa,EAAE,CAAC;IACpD,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,cAAc,EAAE,KAAK,EAAE,aAAa,EAAE,CAAC;IACpD,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC;IACrC,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,wBAAwB,EAAE,CAAC;IACtD,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,eAAe,EAAE,CAAC;IAC7C,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,yBAAyB,EAAE,CAAC;IACvD,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,qBAAqB,EAAE,CAAC;IACnD,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,iBAAiB,EAAE,CAAC;IAE/C,OAAO,EAAE;QACL,GAAG;QACH,GAAG;QACH,GAAG;QACH,GAAG;QACH,EAAE,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE;QACpC,EAAE,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE;QACpC,KAAK;QACL,KAAK;QACL,KAAK;QACL,SAAS;QACT,KAAK;QACL,SAAS;KACZ;IACD,OAAO,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;IACvC,EAAE,EAAE,CAAC,MAAM,EAAE,MAAM,EAAE,cAAc,EAAE,kBAAkB,CAAC;IAExD,KAAK,EAAE;QACH,EAAE,KAAK,EAAE,UAAU,EAAE,KAAK,EAAE,UAAU,EAAE;QACxC,EAAE,KAAK,EAAE,WAAW,EAAE,KAAK,EAAE,aAAa,EAAE;QAE5C,EAAE,KAAK,EAAE,MAAM,EAAE,KAAK,EAAE,WAAW,EAAE;QACrC,EAAE,KAAK,EAAE,SAAS,EAAE,KAAK,EAAE,WAAW,EAAE;QAExC,EAAE,KAAK,EAAE,WAAW,EAAE,KAAK,EAAE,SAAS,EAAE;QACxC,EAAE,KAAK,EAAE,aAAa,EAAE,KAAK,EAAE,YAAY,EAAE;QAE7C,EAAE,KAAK,EAAE,OAAO,EAAE,KAAK,EAAE,gBAAgB,EAAE;QAE3C,EAAE,KAAK,EAAE,QAAQ,EAAE,KAAK,EAAE,KAAK,EAAE;QACjC,EAAE,KAAK,EAAE,OAAO,EAAE,KAAK,EAAE,IAAI,EAAE;QAC/B,EAAE,KAAK,EAAE,SAAS,EAAE,KAAK,EAAE,KAAK,EAAE;QAClC,EAAE,KAAK,EAAE,QAAQ,EAAE,KAAK,EAAE,KAAK,EAAE;QAEjC,EAAE,KAAK,EAAE,aAAa,EAAE,KAAK,EAAE,KAAK,EAAE;QACtC,EAAE,KAAK,EAAE,WAAW,EAAE,KAAK,EAAE,MAAM,EAAE;QAErC,EAAE,KAAK,EAAE,cAAc,EAAE,KAAK,EAAE,KAAK,EAAE;QACvC,EAAE,KAAK,EAAE,mBAAmB,EAAE,KAAK,EAAE,MAAM,EAAE;;;;QAM7C,EAAE,KAAK,EAAE,aAAa,EAAE,KAAK,EAAE,WAAW,EAAE;QAC5C,EAAE,KAAK,EAAE,WAAW,EAAE,KAAK,EAAE,SAAS,EAAE;QAExC,EAAE,KAAK,EAAE,kBAAkB,EAAE,KAAK,EAAE,eAAe,EAAE;QAErD,kBAAkB;QAClB,kBAAkB;QAClB,MAAM;QACN,UAAU;QACV,SAAS;QACT,QAAQ;QACR,SAAS;QACT,gBAAgB;KACnB;IAED,eAAe,EAAE;QACb,OAAO;QACP,OAAO;QACP,YAAY;QACZ,iBAAiB;QACjB,cAAc;KACjB;IAED,eAAe,EAAE;QACb,MAAM;QACN,SAAS;QACT,MAAM;QACN,QAAQ;QACR,UAAU;QACV,UAAU;QACV,YAAY;QACZ,YAAY;QACZ,aAAa;QACb,aAAa;QACb,gBAAgB;QAChB,cAAc;QACd,WAAW;QACX,WAAW;QACX,aAAa;QACb,aAAa;KAChB;IAED,KAAK,EAAE;QACH;YACI,KAAK,EAAE,2BAA2B;YAClC,MAAM,EAAE,KAAK;YACb,KAAK,EAAE,iCAAiC;SAC3C;QACD;YACI,KAAK,EAAE,qCAAqC;YAC5C,MAAM,EAAE,KAAK;YACb,KAAK,EAAE,uBAAuB;SACjC;QACD;YACI,KAAK,EAAE,qCAAqC;YAC5C,MAAM,EAAE,KAAK;YACb,KAAK,EAAE,yBAAyB;SACnC;QACD;YACI,KAAK,EAAE,qCAAqC;YAC5C,MAAM,EAAE,KAAK;YACb,KAAK,EAAE,wBAAwB;SAClC;QACD;YACI,KAAK,EAAE,qCAAqC;YAC5C,MAAM,EAAE,KAAK;YACb,KAAK,EAAE,MAAM;SAChB;QACD;YACI,KAAK,EAAE,2CAA2C;YAClD,MAAM,EAAE,WAAW;YACnB,KAAK,EAAE,MAAM;SAChB;QACD;YACI,KAAK,EAAE,wCAAwC;YAC/C,MAAM,EAAE,QAAQ;YAChB,KAAK,EAAE,MAAM;SAChB;QACD;YACI,KAAK,EAAE,yCAAyC;YAChD,MAAM,EAAE,SAAS;YACjB,KAAK,EAAE,MAAM;SAChB;KACJ;;IAGD,MAAM,EAAE;QACJ;YACI,KAAK,EACD,yEAAyE;YAC7E,OAAO,EAAE,aAAa;SACzB;KACJ;;IAGD,KAAK,EAAE,EAAE;CACZ,CAAC;AACF,IAAI,QAAQ,GAAG,EAAE,CAAC;AAElB,MAAM,MAAM,GAAG;IACX,IAAI,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;KAyCL;IACD,aAAa,EAAE;;;;;;;;;;;;;;;;;;;;;eAqBJ;IACX,aAAa,EAAE;;;;;;;;;;;;;;;;;;;;;eAqBJ;IACX,OAAO,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eA2DE;IACX,aAAa,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eA+CJ;IACX,aAAa,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eAoCJ;IACX,eAAe,EAAE;;;;;;;;;;;;;;eAcN;IACX,eAAe,EAAE;;;;;;;;;;;;;;eAcN;IACX,iBAAiB,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eA8BR;IACX,SAAS,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eA0CA;IACX,KAAK,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eAsCI;CACd,CAAC;AAEF,SAASG,eAAa,CAAC,KAAa,EAAE,GAAG,EAAE,EAAoB;;IAE3D,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,cAAc,EAAE,MAAM,CAAC,CAAC;IAE9C,OAAO,UAAU,CACb,QAAQ,CACJ,IAAI,CAAC,MAAM,CACP;QACI,SAAS,EAAE,UAAU,CAAC,YAAY;QAClC,MAAM,EAAE,EAAE,CAAC,OAAO,CAAC,MAAM;KAC5B,EACD,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,GAAG,EAAE,EAAE,CAAC,OAAO,CAAC,MAAM,CAAC,CACrD,EACD,UAAU,CACb,EACD,cAAc,CACjB,CAAC,QAAQ,EAAE,CAAC;AACjB,CAAC;AAED;;;AAGA,SAAS,mBAAmB,CACxB,EAAoB,EACpB,WAAW,EACX,eAAe;;;IAGf,IAAI,MAAM,GAAG,oBAAoB,CAAC;IAClC,MAAM,YAAY,GAAG,WAAW,CAAC,OAAO,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IACjE,IAAI,YAAY,CAAC,MAAM,GAAG,CAAC,EAAE;QACzB,MAAM,SAAS,GAAG;YACd,GAAG,SAAS;YACZ,UAAI,EAAE,CAAC,OAAO,CAAC,sBAAsB,mCAAI,EAAE,CAAC;SAC/C,CAAC;QACF,KAAK,MAAM,QAAQ,IAAI,YAAY,EAAE;YACjC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,EAAE;gBACtB,OAAO,CAAC,KAAK,CAAC,4BAA4B,GAAG,QAAQ,GAAG,GAAG,CAAC,CAAC;gBAC7D,MAAM;aACT;YACD,MAAM,IAAI,cAAc,CAAC;YACzB,IAAI,QAAQ,KAAK,eAAe,EAAE;gBAC9B,MAAM,IAAI,WAAW,CAAC;aACzB;iBAAM;gBACH,IAAI,SAAS,CAAC,QAAQ,CAAC,CAAC,OAAO,EAAE;oBAC7B,MAAM,IAAI,SAAS,CAAC;iBACvB;qBAAM;oBACH,MAAM,IAAI,eAAe,CAAC;iBAC7B;aACJ;YAED,MAAM,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,OAAO,IAAI,EAAE,IAAI,GAAG,CAAC;YAEpD,IAAI,SAAS,CAAC,QAAQ,CAAC,CAAC,OAAO,EAAE;gBAC7B,MAAM;oBACF,oBAAoB;wBACpBC,QAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC;wBACjC,IAAI,CAAC;gBACT,MAAM,IAAI,sCAAsC,CAAC;aACpD;YAED,IAAI,QAAQ,KAAK,eAAe,EAAE;gBAC9B,IAAI,SAAS,CAAC,QAAQ,CAAC,CAAC,OAAO,EAAE;oBAC7B,MAAM;wBACF,kBAAkB;4BAClB,SAAS,CAAC,QAAQ,CAAC,CAAC,OAAO;4BAC3B,KAAK,CAAC;iBACb;gBAED,IAAI,SAAS,CAAC,QAAQ,CAAC,CAAC,KAAK,EAAE;oBAC3B,MAAM,IAAI,cAAc,GAAG,SAAS,CAAC,QAAQ,CAAC,CAAC,KAAK,GAAG,GAAG,CAAC;iBAC9D;aACJ;YACD,MAAM,IAAI,GAAG,GAAG,SAAS,CAAC,QAAQ,CAAC,CAAC,KAAK,GAAG,QAAQ,CAAC;SACxD;KACJ;IACD,MAAM,IAAI,QAAQ,CAAC;;IAGnB,MAAM,IAAI;;;;oCAIsBA,QAAI,CACpB,2BAA2B,CAC9B;;;;;oCAKmBA,QAAI,CACpB,cAAc,CACjB;;;;;oCAKmBA,QAAI,CACpB,cAAc,CACjB;;;;KAIZ,CAAC;IAEF,OAAO,+CAA+C,GAAG,MAAM,GAAG,QAAQ,CAAC;AAC/E,CAAC;SAEe,UAAU,CACtB,EAAoB,EACpB,MAAqB,EACrB,cAA+B;;IAE/B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;QACpC,MAAM,EAAE,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;QACrB,IAAI,IAAY,CAAC;;QAEjB,IAAI,EAAE,CAAC,YAAY,CAAC,YAAY,CAAC,EAAE;YAC/B,IAAI,GAAGD,eAAa,CAChB,EAAE,CAAC,YAAY,CAAC,YAAY,CAAC,CAAC,OAAO,CAAC,SAAS,EAAE,GAAG,CAAC,EACrD,EAAE,GAAG,EAAE,4CAA4C,EAAE,EACrD,EAAE,CACL,CAAC;SACL;aAAM,IAAI,EAAE,CAAC,YAAY,CAAC,aAAa,CAAC,IAAI,EAAE,CAAC,SAAS,KAAK,EAAE,EAAE;YAC9D,IAAI,GAAGA,eAAa,CAChB,EAAE,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,OAAO,CAAC,SAAS,EAAE,GAAG,CAAC,EACtD,EAAE,GAAG,EAAE,4CAA4C,EAAE,EACrD,EAAE,CACL,CAAC;SACL;aAAM,IAAI,EAAE,CAAC,YAAY,CAAC,cAAc,CAAC,EAAE;YACxC,IAAI,GAAG,EAAE,CAAC,YAAY,CAAC,cAAc,CAAC,CAAC,OAAO,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC;SAClE;QAED,IAAI,EAAE,CAAC,YAAY,CAAC,YAAY,CAAC,EAAE;YAC/B,IAAI;gBACA,CAAC,IAAI,aAAJ,IAAI,cAAJ,IAAI,GAAI,EAAE;oBACX,SAAS;oBACT,EAAE,CAAC,YAAY,CAAC,YAAY,CAAC,CAAC,OAAO,CAAC,SAAS,EAAE,GAAG,CAAC;oBACrD,UAAU,CAAC;SAClB;QACD,IAAI,OAAO,IAAI,KAAK,WAAW,EAAE;YAC7B,EAAE,CAAC,SAAS,GAAG,EAAE,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;SAC9C;QACD,IAAI,EAAE,CAAC,YAAY,CAAC,cAAc,CAAC,EAAE;YACjC,EAAE,CAAC,SAAS,CAAC,GAAG,CAAC,EAAE,CAAC,YAAY,CAAC,cAAc,CAAC,CAAC,CAAC;SACrD;QAED,MAAM,GAAG,SAAG,EAAE,CAAC,YAAY,CAAC,aAAa,CAAC,0CAAE,OAAO,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC;QACpE,IAAI,GAAG,IAAI,YAAY,CAAC,GAAG,CAAC,EAAE;YAC1B,EAAE,CAAC,YAAY,CAAC,cAAc,EAAE,YAAY,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACtD,EAAE,CAAC,YAAY,CACX,sBAAsB,EACtB,IAAI,CAAC,SAAS,CAAC;gBACX,+BAA+B;gBAC/B,YAAY,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;aACvB,CAAC,CACL,CAAC;SACL;;QAGD,IAAI,QAAQ,CAAC;QACb,IAAI,EAAE,CAAC,YAAY,CAAC,cAAc,CAAC,EAAE;YACjC,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,YAAY,CAAC,cAAc,CAAC,CAAC,CAAC;SAC1D;aAAM,IAAI,EAAE,CAAC,YAAY,CAAC,aAAa,CAAC,EAAE;YACvC,QAAQ,GAAG;gBACP,QAAQ;gBACR,EAAE,CAAC,YAAY,CAAC,aAAa,CAAC;gBAC9B;oBACI,KAAK,EAAE,IAAI;oBACX,QAAQ,EAAE,IAAI;oBACd,IAAI,EAAE,MAAM;oBACZ,MAAM,EAAE,OAAO;oBACf,UAAU,EAAE,IAAI;iBACnB;aACJ,CAAC;SACL;aAAM,IAAI,EAAE,CAAC,YAAY,CAAC,YAAY,CAAC,EAAE;YACtC,QAAQ,GAAG;gBACP,QAAQ;gBACR,EAAE,CAAC,YAAY,CAAC,YAAY,CAAC;gBAC7B;oBACI,KAAK,EAAE,IAAI;oBACX,QAAQ,EAAE,IAAI;oBACd,IAAI,EAAE,MAAM;oBACZ,MAAM,EAAE,OAAO;oBACf,UAAU,EAAE,IAAI;iBACnB;aACJ,CAAC;SACL;aAAM;YACH,QAAQ,GAAG;gBACP,WAAW;gBACX,EAAE,CAAC,YAAY,CAAC,UAAU,CAAC,IAAI,EAAE,CAAC,WAAW;gBAC7C,EAAE,KAAK,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,iBAAiB,EAAE,IAAI,EAAE;aAC3D,CAAC;SACL;QACD,IAAI,cAAc,EAAE;YAChB,QAAQ,GAAG,CAAC,cAAc,EAAE,QAAQ,CAAC,CAAC;SACzC;QACD,IAAI,EAAE,CAAC,YAAY,CAAC,eAAe,CAAC,EAAE;YAClC,MAAM,OAAO,GAAG,QAAQ,CAAC,EAAE,CAAC,YAAY,CAAC,eAAe,CAAC,CAAC,CAAC;YAC3D,IAAI,OAAO,EAAE;gBACT,QAAQ,GAAG;oBACP,OAAO,EAAE,QAAQ;oBACjB,iBAAiB,EAAE;wBACf,mBAAmB;wBACnB,EAAE,CAAC,YAAY,CAAC,eAAe,CAAC;wBAChC,OAAO;qBACV;oBACD,eAAe,EAAE,mBAAmB;iBACvC,CAAC;aACL;iBAAM;gBACH,OAAO,CAAC,IAAI,CACR,wBAAwB,GAAG,EAAE,CAAC,YAAY,CAAC,eAAe,CAAC,CAC9D,CAAC;aACL;SACJ;QAED,oBAAoB,CAAC,EAAE,EAAE,EAAE,EAAE,QAAQ,CAAC,CAAC;KAC1C;AACL,CAAC;AAED;;;AAGA,SAAS,iBAAiB,CAAC,EAAoB,EAAE,KAAK;IAClD,MAAM,IAAI,GAAG;;;;;;QAMT,MAAM,EAAE;YACJ,SAAS,EAAE,YAAY;YACvB,SAAS,EAAE,aAAa;YACxB,SAAS,EAAE,WAAW;YACtB,SAAS,EAAE,YAAY;YACvB,SAAS,EAAE,aAAa;YACxB,SAAS,EAAE,WAAW;YACtB,UAAU,EAAE,MAAM;YAClB,UAAU,EAAE,MAAM;YAClB,UAAU,EAAE,MAAM;YAClB,UAAU,EAAE,MAAM;SACrB;QACD,MAAM,EAAE;YACJ,SAAS,EAAE,YAAY;YACvB,SAAS,EAAE,YAAY;YACvB,SAAS,EAAE,YAAY;YACvB,SAAS,EAAE,YAAY;YACvB,SAAS,EAAE,YAAY;YACvB,SAAS,EAAE,YAAY;SAC1B;QACD,MAAM,EAAE;YACJ,SAAS,EAAE,YAAY;YACvB,SAAS,EAAE,aAAa;YACxB,SAAS,EAAE,WAAW;YACtB,SAAS,EAAE,YAAY;YACvB,SAAS,EAAE,YAAY;YACvB,SAAS,EAAE,WAAW;SACzB;QACD,MAAM,EAAE;YACJ,SAAS,EAAE,aAAa;YACxB,SAAS,EAAE,YAAY;YACvB,SAAS,EAAE,YAAY;YACvB,SAAS,EAAE,aAAa;YACxB,SAAS,EAAE,YAAY;YACvB,SAAS,EAAE,YAAY;SAC1B;QACD,OAAO,EAAE;YACL,SAAS,EAAE,aAAa;YACxB,SAAS,EAAE,YAAY;YACvB,SAAS,EAAE,WAAW;YACtB,SAAS,EAAE,aAAa;YACxB,SAAS,EAAE,YAAY;YACvB,SAAS,EAAE,WAAW;SACzB;KACJ,CAAC;IACF,MAAM,MAAM,GAAG,IAAI,CAAC,EAAE,CAAC,OAAO,CAAC,qBAAqB,CAAC;UAC/C,IAAI,CAAC,EAAE,CAAC,OAAO,CAAC,qBAAqB,CAAC;UACtC,IAAI,CAAC,QAAQ,CAAC,CAAC;IAErB,IAAI,MAAM,GAAG,KAAK,CAAC;IACnB,IAAI,GAAG,CAAC;IAER,MAAM,GAAG,MAAM,CAAC,OAAO,CACnB,aAAa,EACb;;;;;;;;;;;;sDAY8C,CACjD,CAAC;IAEF,IAAI,CAAC,GAAG,MAAM,CAAC,KAAK,CAAC,+BAA+B,CAAC,CAAC;IACtD,OAAO,CAAC,EAAE;QACN,GAAG,GAAG,EAAE,CAAC;QACT,MAAM,eAAe,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAC9B,sCAAsC,CACzC,CAAC;QACF,MAAM,UAAU,GAAG,EAAE,CAAC;QACtB,KAAK,MAAM,SAAS,IAAI,eAAe,EAAE;YACrC,MAAM,EAAE,GAAG,SAAS,CAAC,KAAK,CAAC,uCAAuC,CAAC,CAAC;YACpE,UAAU,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC;SAC7B;QAED,IAAI,IAAI,GAAG,MAAM,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC;QACtC,IAAI,CAAC,IAAI;YAAE,IAAI,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC;QACrD,IAAI,CAAC,IAAI,EAAE;YACP,OAAO,CAAC,IAAI,CAAC,8BAA8B,GAAG,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC;SACrE;aAAM;YACH,KAAK,MAAM,CAAC,IAAI,IAAI,EAAE;gBAClB,IAAI,GAAG,GAAG,UAAU,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC;gBACpC,IAAI,GAAG;oBAAE,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC;gBACzB,IAAI,CAAC,KAAK,GAAG,EAAE;oBACX,GAAG,IAAI,4CAA4C,CAAC;oBACpD,GAAG;wBACC,IAAI,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,GAAG,CAAC,KAAK,EAAE;8BAClD,KAAK;8BACL,KAAK,CAAC;oBAChB,GAAG,IAAI;;;uCAGY,CAAC;iBACvB;qBAAM,IAAI,CAAC,KAAK,GAAG,EAAE;;oBAElB,GAAG,IAAI,gCAAgC,CAAC;iBAC3C;qBAAM,IAAI,CAAC,KAAK,GAAG,EAAE;;oBAElB,GAAG;wBACC,iFAAiF;4BACjF,UAAU,CAAC,aAAa,CAAC;4BACzB,iBAAiB,CAAC;iBACzB;qBAAM,IAAI,CAAC,KAAK,GAAG,EAAE;oBAClB,GAAG;wBACC,mBAAmB;4BACnB,GAAG;4BACH,gEAAgE,CAAC;iBACxE;qBAAM,IAAI,CAAC,KAAK,GAAG,EAAE;oBAClB,GAAG;wBACC,mBAAmB;4BACnB,GAAG;4BACH,yDAAyD,CAAC;iBACjE;qBAAM,IAAI,CAAC,KAAK,GAAG,EAAE;oBAClB,GAAG;wBACC,mBAAmB;4BACnB,GAAG;4BACH,kEAAkE,CAAC;iBAC1E;qBAAM,IAAI,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE;oBACvB,GAAG;wBACC,mBAAmB;4BACnB,GAAG;4BACH,mBAAmB;4BACnB,CAAC;4BACD,GAAG;4BACH,+BAA+B;4BAC/B,CAAC;4BACD,uDAAuD;4BACvD,GAAG;4BACH,CAAC;4BACD,OAAO,CAAC;iBACf;qBAAM;oBACH,GAAG;wBACC,mBAAmB;4BACnB,GAAG;4BACH,mBAAmB;4BACnB,CAAC;4BACD,IAAI;4BACJ,CAAC;4BACD,OAAO,CAAC;iBACf;aACJ;SACJ;QACD,MAAM,GAAG,MAAM,CAAC,OAAO,CAAC,IAAI,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC;QAE7D,CAAC,GAAG,MAAM,CAAC,KAAK,CAAC,+BAA+B,CAAC,CAAC;KACrD;IAED,OAAO,MAAM,CAAC;AAClB,CAAC;AAED;;;;SAIgB,YAAY,CACxB,EAAoB,EACpB,KAAgC;;IAEhC,MAAM,QAAQ,GAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;SAkCZ,CAAC;;;;;;;;;;;;;IAcN,IAAI,MAAM,GAAG,QAAQ,CAAC;IAEtBE,MAAgB,CAAC,IAAI,EAAEC,QAAyB,CAAC,CAAC;IAClDD,MAAgB,CAAC,IAAI,EAAEE,UAAc,CAAC,CAAC;;IAGvC,aAAa,CAAC,kBAAkB,CAAC,GAAG,EAAE,CAAC;IACvC,KAAK,MAAM,KAAK,IAAI,WAAW,EAAE;QAC7B,aAAa,CAAC,kBAAkB,CAAC,CAAC,IAAI,CAAC;YACnC,OAAO,EAAE,cAAc;YACvB,OAAO,EACH,mGAAmG;gBACnG,KAAK;gBACL,WAAW;YACf,OAAO,EAAE,0BAA0B,GAAG,KAAK,GAAG,KAAK;SACtD,CAAC,CAAC;KACN;IACD,aAAa,CAAC,kBAAkB,CAAC,GAAG,EAAE,CAAC;IACvC,KAAK,MAAM,KAAK,IAAI,WAAW,EAAE;QAC7B,aAAa,CAAC,kBAAkB,CAAC,CAAC,IAAI,CAAC;YACnC,OAAO,EAAE,cAAc;YACvB,OAAO,EACH,oEAAoE;gBACpE,KAAK;gBACL,WAAW;YACf,OAAO,EAAE,oCAAoC,GAAG,KAAK,GAAG,KAAK;SAChE,CAAC,CAAC;KACN;IAED,QAAQ,GAAG,EAAE,GAAG,aAAa,EAAE,CAAC;IAChC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,CAAC,GAAG;QAC9B,QAAQ,CAAC,GAAG,CAAC,GAAG,QAAQ,CAAC,GAAG,CAAC,CAAC,KAAK,EAAE,CAAC;KACzC,CAAC,CAAC;IAEH,MAAM,WAAW,GAAG,4BAA4B,CAAC;IACjD,MAAM,WAAW,GAAG,4BAA4B,CAAC;IACjD,MAAM,MAAM,GAAG,YAAY,CAAC;;IAE5B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,EAAE,EAAE;QACzB,MAAM,GAAG,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC;QAC3B,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC;YAAE,QAAQ,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC;QACvC,QAAQ,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC;YAClB,KAAK,EAAE,WAAW,GAAG,GAAG,GAAG,GAAG;YAC9B,KAAK,EAAE,YAAY;YACnB,MAAM,EAAE,WAAW,GAAG,GAAG,GAAG,GAAG;SAClC,CAAC,CAAC;QACH,QAAQ,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC;YAClB,KAAK,EAAE,WAAW,GAAG,GAAG,GAAG,GAAG;YAC9B,KAAK,EAAE,MAAM;YACb,MAAM,EAAE,WAAW,GAAG,GAAG,GAAG,GAAG;SAClC,CAAC,CAAC;QACH,QAAQ,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC;YAClB,KAAK,EAAE,WAAW,GAAG,GAAG,GAAG,GAAG;YAC9B,KAAK,EAAE,MAAM;YACb,MAAM,EAAE,WAAW,GAAG,GAAG,GAAG,GAAG;SAClC,CAAC,CAAC;QACH,QAAQ,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC;YAClB,KAAK,EAAE,WAAW,GAAG,GAAG,GAAG,GAAG;YAC9B,KAAK,EAAE,WAAW;YAClB,MAAM,EAAE,WAAW,GAAG,GAAG,GAAG,GAAG;SAClC,CAAC,CAAC;QACH,QAAQ,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC;YAClB,KAAK,EAAE,YAAY,GAAG,GAAG,GAAG,GAAG;YAC/B,KAAK,EAAE,aAAa;YACpB,MAAM,EAAE,YAAY,GAAG,GAAG,GAAG,GAAG;SACnC,CAAC,CAAC;QACH,QAAQ,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC;YAClB,KAAK,EAAE,aAAa,GAAG,GAAG,GAAG,GAAG;YAChC,KAAK,EAAE,SAAS;YAChB,MAAM,EAAE,aAAa,GAAG,GAAG,GAAG,GAAG;SACpC,CAAC,CAAC;KACN;;IAED,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,EAAE,EAAE,CAAC,EAAE,EAAE;QAC1B,MAAM,GAAG,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC;QAC3B,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC;YAAE,QAAQ,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC;QACvC,QAAQ,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC;YAClB,KAAK,EAAE,WAAW,GAAG,GAAG,GAAG,GAAG;YAC9B,KAAK,EAAE,MAAM;YACb,MAAM,EAAE,WAAW,GAAG,GAAG,GAAG,GAAG;SAClC,CAAC,CAAC;QACH,QAAQ,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC;YAClB,KAAK,EAAE,WAAW,GAAG,GAAG,GAAG,GAAG;YAC9B,KAAK,EAAE,MAAM;YACb,MAAM,EAAE,WAAW,GAAG,GAAG,GAAG,GAAG;SAClC,CAAC,CAAC;QACH,QAAQ,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC;YAClB,KAAK,EAAE,WAAW,GAAG,GAAG,GAAG,GAAG;YAC9B,KAAK,EAAE,WAAW;YAClB,MAAM,EAAE,WAAW,GAAG,GAAG,GAAG,GAAG;SAClC,CAAC,CAAC;QACH,QAAQ,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC;YAClB,KAAK,EAAE,aAAa,GAAG,GAAG,GAAG,GAAG;YAChC,KAAK,EAAE,SAAS;YAChB,MAAM,EAAE,aAAa,GAAG,GAAG,GAAG,GAAG;SACpC,CAAC,CAAC;KACN;IACD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,EAAE,EAAE;QACzB,MAAM,GAAG,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;QACtB,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC;YAAE,QAAQ,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC;;;;;;QAMvC,QAAQ,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC;YAClB,KAAK,EAAE,WAAW,GAAG,GAAG,GAAG,GAAG;YAC9B,KAAK,EAAE,MAAM;YACb,MAAM,EAAE,WAAW,GAAG,GAAG,GAAG,GAAG;SAClC,CAAC,CAAC;QACH,QAAQ,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC;YAClB,KAAK,EAAE,WAAW,GAAG,GAAG,GAAG,GAAG;YAC9B,KAAK,EAAE,MAAM;YACb,MAAM,EAAE,WAAW,GAAG,GAAG,GAAG,GAAG;SAClC,CAAC,CAAC;QACH,QAAQ,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC;YAClB,KAAK,EAAE,WAAW,GAAG,GAAG,GAAG,GAAG;YAC9B,KAAK,EAAE,WAAW;YAClB,MAAM,EAAE,WAAW,GAAG,GAAG,GAAG,GAAG;SAClC,CAAC,CAAC;QACH,QAAQ,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC;YAClB,KAAK,EAAE,YAAY,GAAG,GAAG,GAAG,GAAG;YAC/B,KAAK,EAAE,QAAQ;YACf,MAAM,EAAE,YAAY,GAAG,GAAG,GAAG,GAAG;SACnC,CAAC,CAAC;QACH,QAAQ,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC;YAClB,KAAK,EAAE,aAAa,GAAG,GAAG,GAAG,GAAG;YAChC,KAAK,EAAE,SAAS;YAChB,MAAM,EAAE,aAAa,GAAG,GAAG,GAAG,GAAG;SACpC,CAAC,CAAC;KACN;IAED,IAAI,WAAW,GAAG,EAAE,CAAC,OAAO,CAAC,gBAAgB,CAAC;IAC9C,IAAI,CAAC,WAAW,EAAE;QACd,WAAW,GAAG,KAAK,CAAC;KACvB;IACD,WAAW,GAAG,WAAW,CAAC,OAAO,CAC7B,UAAU,EACV,wCAAwC,CAC3C,CAAC;IAEF,MAAM,MAAM,GAER;QACA,GAAG,MAAM;QACT,UAAI,EAAE,CAAC,OAAO,CAAC,2BAA2B,mCAAI,EAAE,CAAC;KACpD,CAAC;IACF,MAAM,SAAS,GAAG;QACd,GAAG,SAAS;QACZ,UAAI,EAAE,CAAC,OAAO,CAAC,sBAAsB,mCAAI,EAAE,CAAC;KAC/C,CAAC;IAEF,MAAM,YAAY,GAAG,WAAW,CAAC,OAAO,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IACjE,KAAK,MAAM,QAAQ,IAAI,YAAY,EAAE;QACjC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,EAAE;YACtB,OAAO,CAAC,KAAK,CAAC,4BAA4B,GAAG,QAAQ,GAAG,GAAG,CAAC,CAAC;YAC7D,MAAM;SACT;;;QAGD,IAAI,cAAc,GAAG,SAAS,CAAC,QAAQ,CAAC,CAAC,MAAM,IAAI,EAAE,CAAC;QACtD,IAAI,SAAS,CAAC,QAAQ,CAAC,CAAC,KAAK,EAAE;YAC3B,cAAc,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,KAAK,CAAC,CAAC;SAClD;QACD,cAAc,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,GAAG,CAAC,cAAc,CAAC,CAAC,CAAC;QAErD,KAAK,MAAM,SAAS,IAAI,cAAc,EAAE;YACpC,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,EAAE;gBACpB,OAAO,CAAC,KAAK,CACT,mCAAmC,GAAG,SAAS,GAAG,GAAG,CACxD,CAAC;gBACF,MAAM;aACT;YAED,IAAI,OAAO,MAAM,CAAC,SAAS,CAAC,KAAK,QAAQ,EAAE;gBACvC,MAAM,KAAK,GAAG,MAAM,CAAC,SAAS,CAAyB,CAAC;;gBAGxD,IAAI,SAAS,GAAG,EAAE,CAAC;gBACnB,IAAI,KAAK,CAAC,MAAM,EAAE;oBACd,SAAS,IAAI,UAAU,KAAK,CAAC,MAAM,UAAU,CAAC;iBACjD;gBAED,IAAI,KAAK,CAAC,QAAQ,EAAE;oBAChB,SAAS,IAAI,eAAe,KAAK,CAAC,QAAQ,IAAI,CAAC;iBAClD;gBAED,IAAI,KAAK,CAAC,SAAS,EAAE;oBACjB,SAAS,IAAI,eAAe,KAAK,CAAC,SAAS,IAAI,CAAC;iBACnD;gBAED,IAAI,KAAK,CAAC,IAAI,EAAE;oBACZ,SAAS,IAAI,oBAAoB,CAAC;oBAClC,KAAK,MAAM,GAAG,IAAI,KAAK,CAAC,IAAI,EAAE;wBAC1B,SAAS,IAAI,MAAM,CAAC;wBACpB,KAAK,MAAM,MAAM,IAAI,GAAG,EAAE;4BACtB,SAAS,IAAI,KAAK,CAAC;4BACnB,IAAI,MAAM,CAAC,KAAK,EAAE;gCACd,SAAS,IAAI,WAAW,MAAM,CAAC,KAAK,GAAG,CAAC;6BAC3C;4BACD,IAAI,MAAM,CAAC,GAAG,EAAE;gCACZ,SAAS,IAAI,cAAc,MAAM,CAAC,GAAG,GAAG,CAAC;6BAC5C;4BAED,IAAI,MAAM,CAAC,OAAO,EAAE;gCAChB,IAAI,OAAO,MAAM,CAAC,OAAO,KAAK,QAAQ,EAAE;oCACpC,SAAS,IAAI,mBAAmB,MAAM,CAAC,OAAO,IAAI,CAAC;iCACtD;qCAAM;oCACH,SAAS,IAAI,iBAAiB,CAAC;oCAC/B,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;oCAC5C,SAAS,IAAI,GAAG,CAAC;iCACpB;6BACJ;4BACD,IAAI,MAAM,CAAC,MAAM,EAAE;gCACf,SAAS,IAAI,iBAAiB,MAAM,CAAC,MAAM,GAAG,CAAC;6BAClD;4BAED,IAAI,MAAM,CAAC,KAAK,EAAE;gCACd,SAAS,IAAI,gBAAgB,MAAM,CAAC,KAAK,GAAG,CAAC;6BAChD;4BAED,IAAI,MAAM,CAAC,KAAK,EAAE;gCACd,SAAS,IAAI,gBAAgB,MAAM,CAAC,KAAK,GAAG,CAAC;6BAChD;4BAED,IAAI,MAAM,CAAC,OAAO,EAAE;gCAChB,SAAS,IAAI,mBAAmB,MAAM,CAAC,OAAO,GAAG,CAAC;6BACrD;4BAED,IAAI,MAAM,CAAC,OAAO,EAAE;gCAChB,SAAS,IAAI,kBAAkB,MAAM,CAAC,OAAO,GAAG,CAAC;6BACpD;4BAED,IAAI,MAAM,CAAC,cAAc,EAAE;gCACvB,SAAS,IAAI,0BAA0B,MAAM,CAAC,cAAc,GAAG,CAAC;6BACnE;4BAED,SAAS,IAAI,IACT,MAAM,CAAC,KAAK,GAAG,MAAM,CAAC,KAAK,GAAG,EAClC,OAAO,CAAC;yBACX;wBACD,SAAS,IAAI,OAAO,CAAC;qBACxB;oBACD,SAAS,IAAI,QAAQ,CAAC;iBACzB;gBAED,IAAI,KAAK,CAAC,SAAS,EAAE;oBACjB,SAAS,IAAI,QAAQ,CAAC;iBACzB;gBAED,IAAI,KAAK,CAAC,QAAQ,EAAE;oBAChB,SAAS,IAAI,QAAQ,CAAC;iBACzB;gBAED,MAAM,CAAC,SAAS,CAAC,GAAG,SAAS,CAAC;aACjC;YAED,MAAM;gBACF,wDAAwD;oBACxD,SAAS;oBACT,IAAI,CAAC;YACT,MAAM,IAAI,mBAAmB,CAAC,EAAE,EAAE,WAAW,EAAE,QAAQ,CAAC,CAAC;YACzD,MAAM,WAAW,GAAG,MAAM,CAAC,SAAS,CAAC,CAAC;;;YAGtC,MAAM,IAAI,iBAAiB,CAAC,EAAE,EAAE,WAAW,CAAC,CAAC;YAC7C,MAAM,IAAI,QAAQ,CAAC;SACtB;KACJ;IAED,MAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;IAC7C,MAAM,CAAC,SAAS,GAAG,cAAc,CAAC;IAClC,IAAI,KAAK,EAAE;QACP,MAAM,CAAC,SAAS,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;KAC/B;SAAM,IAAI,EAAE,CAAC,OAAO,CAAC,oBAAoB,EAAE;QACxC,MAAM,CAAC,SAAS,CAAC,GAAG,CAAC,EAAE,CAAC,OAAO,CAAC,oBAAoB,CAAC,CAAC;KACzD;IACD,MAAM,CAAC,SAAS,GAAG,EAAE,CAAC,OAAO,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;;IAGjD,UAAU,CACN,EAAE,EACF,EAAE,CAAC,KAAK,CAAC,IAAI,CACT,MAAM,CAAC,gBAAgB,CACnB,2CAA2C,CAC9C,CACJ,CACJ,CAAC;IAEF,MAAM,MAAM,GAAG,MAAM,CAAC,sBAAsB,CAAC,cAAc,CAAC,CAAC;IAC7D,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;QACpC,IAAI,MAAM,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE;;YAEvC,oBAAoB,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC,CAAC,EAAE;;;gBAGhC,OAAO,EAAE,CAAC,oBAAoB,EAAE,OAAO,CAAC;;gBAGxC,OAAO,EAAE;oBACL,qBAAqB;oBACrB,MAAM,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,YAAY,CAAC;iBACvC;;;gBAID,eAAe,EAAE,sBAAsB;aAC1C,CAAC,CAAC;SACN;aAAM;;YAEH,oBAAoB,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC,CAAC,EAAE;gBAChC,OAAO,EAAE;oBACL,qBAAqB;oBACrB,MAAM,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,YAAY,CAAC;iBACvC;aACJ,CAAC,CAAC;SACN;KACJ;;IAGD,MAAM,aAAa,GAAG,MAAM,CAAC,sBAAsB,CAAC,gBAAgB,CAAC,CAAC;IACtE,KAAK,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;QAChC,CAAC,CAAC,gBAAgB,CAAC,WAAW,EAAE,CAAC,GAAG;YAChC,GAAG,CAAC,cAAc,EAAE,CAAC;YACrB,GAAG,CAAC,eAAe,EAAE,CAAC;SACzB,CAAC,CAAC;QACH,CAAC,CAAC,gBAAgB,CACd,YAAY,EACZ,CAAC,GAAG;YACA,GAAG,CAAC,cAAc,EAAE,CAAC;YACrB,GAAG,CAAC,eAAe,EAAE,CAAC;SACzB,EACD,EAAE,OAAO,EAAE,KAAK,EAAE,CACrB,CAAC;KACL,CAAC,CAAC;IACH,aAAa,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;;;;;;IAO7C,MAAM,CAAC,gBAAgB,CAAC,SAAS,EAAE;QAC/B,iBAAiB,CAAG,CAAC,CAAC;QACtB,oBAAoB,CAAC,EAAE,CAAC,CAAC;KAC5B,CAAC,CAAC;IACH,MAAM,CAAC,gBAAgB,CAAC,MAAM,EAAE;QAC5B,iBAAiB,CAAG,CAAC,CAAC;QACtB,oBAAoB,CAAC,EAAE,CAAC,CAAC;KAC5B,CAAC,CAAC;IACH,MAAM,CAAC,gBAAgB,CAAC,UAAU,EAAE;QAChC,iBAAiB,CAAG,CAAC,CAAC;QACtB,oBAAoB,CAAC,EAAE,CAAC,CAAC;KAC5B,CAAC,CAAC;IACH,MAAM,CAAC,gBAAgB,CAAC,aAAa,EAAE;QACnC,iBAAiB,CAAG,CAAC,CAAC;QACtB,oBAAoB,CAAC,EAAE,CAAC,CAAC;KAC5B,CAAC,CAAC;IAEH,OAAO,MAAM,CAAC;AAClB,CAAC;SAEe,iBAAiB,CAAC,UAA4B;IAC1D,MAAM,YAAY,GAAG,QAAQ,CAAC,cAAc,CACxC,+BAA+B,CAClC,CAAC;IACF,IAAI,YAAY,EAAE;QACd,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;QAC5C,YAAY,CAAC,SAAS,GAAG,EAAE,CAAC;QAC5B,oBAAoB,CAAC,YAAY,CAAC,CAAC;KACtC;IACD,OAAO,KAAK,CAAC;AACjB,CAAC;AACD;;;;;SAKgB,oBAAoB,CAAC,SAA2B;IAC5D,MAAM,OAAO,GAAG,SAAS,CAAC,eAAe,CAAC,gBAAgB,CACtD,0FAA0F,CAC7F,CAAC;IACF,IAAI,OAAO,EAAE;QACT,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACrC,MAAM,MAAM,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC;YAC1B,MAAM,OAAO,GAAG,MAAM,CAAC,YAAY,CAAC,wBAAwB,CAAC,CAAC;YAC9D,IAAI,OAAO,EAAE;gBACT,MAAM,CAAC,SAAS,GAAG,SAAS,CAAC,OAAO,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;aAC5D;YACD,MAAM,OAAO,GAAG,MAAM,CAAC,YAAY,CAAC,wBAAwB,CAAC,CAAC;YAC9D,IAAI,OAAO,EAAE;gBACT,MAAM,CAAC,YAAY,CACf,OAAO,GAAG,SAAS,CAAC,OAAO,CAAC,SAAS,GAAG,SAAS,EACjD,OAAO,CACV,CAAC;aACL;SACJ;KACJ;IACD,OAAO,KAAK,CAAC;AACjB,CAAC;SAEe,qBAAqB,CAAC,SAA2B;;IAC7D,MAAM,sBAAsB,SAAG,SAAS,CAAC,eAAe,0CAAE,aAAa,CACnE,mBAAmB,CACtB,CAAC;IACF,IAAI,sBAAsB,EAAE;QACxB,MAAM,UAAU,GAAG,sBAAsB,CAAC,aAAa,CACnD,2BAA2B,CAC9B,CAAC;QACF,MAAM,UAAU,GAAG,sBAAsB,CAAC,aAAa,CACnD,2BAA2B,CAC9B,CAAC;QACF,IAAI,SAAS,CAAC,OAAO,EAAE,EAAE;YACrB,UAAU,CAAC,SAAS,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;SAC3C;aAAM;YACH,UAAU,CAAC,SAAS,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;SACxC;QACD,IAAI,SAAS,CAAC,OAAO,EAAE,EAAE;YACrB,UAAU,CAAC,SAAS,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;SAC3C;aAAM;YACH,UAAU,CAAC,SAAS,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;SACxC;KACJ;AACL;;AC9qDA;;;;;AAKAP,UAAe,CACX;IACI,iBAAiB,EAAE,CAAC,SAA2B,EAAE,MAAM,EAAE,OAAO;QAC5D,MAAM,YAAY,GAAG,gBAAgB,CACjC,+BAA+B,EAC/B,6BAA6B,CAChC,CAAC;QACF,IAAI,SAAS,CAAC,eAAe,CAAC,SAAS,CAAC,QAAQ,CAAC,UAAU,CAAC,EAAE;YAC1D,YAAY,CAAC,SAAS,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;SAC1C;QACD,IAAI,OAAO,CAAC,MAAM,IAAI,CAAC,EAAE;;YAErB,YAAY,CAAC,KAAK,CAAC,KAAK,GAAG,OAAO,CAAC;SACtC;aAAM,IAAI,OAAO,CAAC,MAAM,KAAK,CAAC,IAAI,OAAO,CAAC,MAAM,KAAK,CAAC,EAAE;;YAErD,YAAY,CAAC,KAAK,CAAC,KAAK,GAAG,OAAO,CAAC;SACtC;aAAM,IAAI,OAAO,CAAC,MAAM,KAAK,CAAC,EAAE;;YAE7B,YAAY,CAAC,KAAK,CAAC,KAAK,GAAG,MAAM,CAAC;SACrC;aAAM;;YAEH,YAAY,CAAC,KAAK,CAAC,KAAK,GAAG,OAAO,CAAC;SACtC;;QAED,YAAY,CAAC,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC;QACnC,IAAI,MAAM,GAAG,EAAE,CAAC;QAChB,KAAK,MAAM,MAAM,IAAI,OAAO,EAAE;YAC1B,MAAM,IAAI,KAAK,CAAC;YAChB,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;gBAC5B,MAAM;oBACF,eAAe,GAAG,MAAM,CAAC,OAAO,CAAC,IAAI,EAAE,QAAQ,CAAC,GAAG,GAAG,CAAC;aAC9D;iBAAM;gBACH,IAAI,MAAM,CAAC,KAAK,EAAE;oBACd,MAAM;wBACF,eAAe;4BACf,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,EAAE,QAAQ,CAAC;4BACpC,GAAG,CAAC;iBACX;gBACD,IAAI,MAAM,CAAC,OAAO,EAAE;oBAChB,MAAM;wBACF,iBAAiB;4BACjB,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,EAAE,QAAQ,CAAC;4BACtC,GAAG,CAAC;iBACX;gBACD,IAAI,MAAM,CAAC,MAAM,EAAE;oBACf,MAAM;wBACF,gBAAgB;4BAChB,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,EAAE,QAAQ,CAAC;4BACrC,GAAG,CAAC;iBACX;gBACD,IAAI,MAAM,CAAC,OAAO,EAAE;oBAChB,MAAM;wBACF,iBAAiB;4BACjB,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,EAAE,QAAQ,CAAC;4BACtC,GAAG,CAAC;iBACX;gBACD,IAAI,MAAM,CAAC,KAAK,EAAE;oBACd,MAAM;wBACF,eAAe;4BACf,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,EAAE,QAAQ,CAAC;4BACpC,GAAG,CAAC;iBACX;gBACD,IAAI,MAAM,CAAC,OAAO,EAAE;oBAChB,MAAM,IAAI,iBAAiB,GAAG,MAAM,CAAC,OAAO,GAAG,GAAG,CAAC;iBACtD;aACJ;YACD,MAAM,IAAI,GAAG,CAAC;YACd,MAAM,IAAI,MAAM,CAAC,KAAK,IAAI,EAAE,CAAC;YAC7B,MAAM,IAAI,OAAO,CAAC;SACrB;QACD,MAAM,GAAG,MAAM,GAAG,MAAM,GAAG,OAAO,CAAC;QACnC,YAAY,CAAC,SAAS,GAAG,SAAS,CAAC,OAAO,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;QAC9D,UAAU,CACN,SAAS,EACT,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,YAAY,CAAC,oBAAoB,CAAC,IAAI,CAAC,CAAC,EACtD,sBAAsB,CACzB,CAAC;QACF,MAAM,QAAQ,GAAG,SAAS,CAAC,eAAe,CAAC,aAAa,CACpD,8DAA8D;YAC1D,MAAM;YACN,IAAI,CACX,CAAC;QACF,MAAM,QAAQ,GAAG,QAAQ,CAAC,qBAAqB,EAAE,CAAC;QAClD,IAAI,QAAQ,EAAE;YACV,IAAI,QAAQ,CAAC,GAAG,GAAG,YAAY,CAAC,YAAY,GAAG,CAAC,EAAE;;gBAE9C,YAAY,CAAC,KAAK,CAAC,KAAK,GAAG,MAAM,CAAC;gBAClC,IAAI,OAAO,CAAC,MAAM,IAAI,CAAC,EAAE;oBACrB,YAAY,CAAC,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC;iBACtC;qBAAM,IAAI,OAAO,CAAC,MAAM,IAAI,EAAE,EAAE;oBAC7B,YAAY,CAAC,KAAK,CAAC,MAAM,GAAG,OAAO,CAAC;iBACvC;qBAAM;oBACH,YAAY,CAAC,KAAK,CAAC,MAAM,GAAG,OAAO,CAAC;iBACvC;aACJ;YACD,MAAM,GAAG,GACL,CAAC,QAAQ,CAAC,GAAG,GAAG,YAAY,CAAC,YAAY,GAAG,CAAC,EAAE,QAAQ,EAAE;gBACzD,IAAI,CAAC;YACT,MAAM,IAAI,GACN,IAAI,CAAC,GAAG,CACJ,CAAC,EACD,IAAI,CAAC,GAAG,CACJ,MAAM,CAAC,UAAU,GAAG,YAAY,CAAC,WAAW,EAC5C,CAAC,QAAQ,CAAC,IAAI;gBACV,QAAQ,CAAC,KAAK;gBACd,YAAY,CAAC,WAAW;gBACxB,CAAC,CACR,CACJ,GAAG,IAAI,CAAC;YACb,YAAY,CAAC,KAAK,CAAC,SAAS;gBACxB,YAAY,GAAG,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC;YAC1C,YAAY,CAAC,SAAS,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;SAC5C;QACD,OAAO,KAAK,CAAC;KAChB;CACJ,EACD,EAAE,MAAM,EAAE,kBAAkB,EAAE,CACjC,CAAC;SAEc,mBAAmB,CAC/B,SAA2B,EAC3B,KAAa;IAEb,IAAI,SAAS,CAAC,OAAO,CAAC,mBAAmB,KAAK,KAAK,EAAE;QACjD,IACI,KAAK,KAAK,eAAe;YACzB,KAAK,KAAK,eAAe;YACzB,KAAK,KAAK,iBAAiB,EAC7B;;YAEE,QAAQ,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC;SACjC;QACD,mBAAmB,CAAC,SAAS,CAAC,CAAC;;QAE/B,iBAAiB,CAAU,CAAC,CAAC;;;QAG7B,oBAAoB,CAAC,SAAS,CAAC,CAAC;QAChC,MAAM,MAAM,GAAG,SAAS,CAAC,eAAe,CAAC,sBAAsB,CAC3D,gBAAgB,CACnB,CAAC;;QAEF,IAAI,KAAK,GAAG,KAAK,CAAC;QAClB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACpC,IAAK,MAAM,CAAC,CAAC,CAAiB,CAAC,OAAO,CAAC,KAAK,KAAK,KAAK,EAAE;gBACpD,KAAK,GAAG,IAAI,CAAC;gBACb,MAAM;aACT;SACJ;;;QAGD,IAAI,KAAK,EAAE;YACP,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACpC,IAAK,MAAM,CAAC,CAAC,CAAiB,CAAC,OAAO,CAAC,KAAK,KAAK,KAAK,EAAE;oBACpD,MAAM,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;iBACzC;qBAAM;oBACH,MAAM,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;iBAC5C;aACJ;SACJ;QACD,SAAS,CAAC,KAAK,EAAE,CAAC;KACrB;IACD,OAAO,IAAI,CAAC;AAChB,CAAC;AAED;;;;AAIAA,UAAe,CACX;IACI,kBAAkB,EAAE,CAAC,SAA2B;QAC5C,MAAM,OAAO,GAAG,SAAS,CAAC,eAAe,CAAC,gBAAgB,CACtD,0FAA0F,CAC7F,CAAC;QACF,IAAI,OAAO,EAAE;YACT,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACrC,MAAM,MAAM,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC;gBAC1B,IAAI,cAAc,GAAG,MAAM,CAAC,YAAY,CAAC,cAAc,CAAC,CAAC;gBACzD,IAAI,cAAc,IAAI,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,EAAE;oBACpD,MAAM,CAAC,YAAY,CACf,wBAAwB,EACxB,MAAM,CAAC,SAAS,CACnB,CAAC;oBACF,IAAI,CAAC,cAAc,EAAE;wBACjB,cAAc,GAAG,MAAM,CAAC,SAAS,CAAC,WAAW,EAAE,CAAC;qBACnD;oBACD,MAAM,CAAC,SAAS,GAAG,SAAS,CAAC,OAAO,CAAC,UAAU,CAC3C,cAAc,CACjB,CAAC;oBACF,MAAM,OAAO,GAAG,MAAM,CAAC,YAAY,CAC/B,OAAO,GAAG,SAAS,CAAC,OAAO,CAAC,SAAS,GAAG,SAAS,CACpD,CAAC;oBACF,IAAI,OAAO,EAAE;wBACT,MAAM,CAAC,YAAY,CACf,wBAAwB,EACxB,OAAO,CACV,CAAC;wBACF,MAAM,aAAa,GAAG,MAAM,CAAC,YAAY,CACrC,sBAAsB,CACzB,CAAC;wBACF,IAAI,aAAa,EAAE;4BACf,MAAM,CAAC,YAAY,CACf,OAAO;gCACH,SAAS,CAAC,OAAO,CAAC,SAAS;gCAC3B,SAAS,EACb,aAAa,CAChB,CAAC;yBACL;6BAAM;4BACH,MAAM,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;4BACvC,IAAI,OAAO,CAAC,UAAU,CAAC,EAAE;gCACrB,UAAU,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,CAAC;6BAC/C;4BACD,MAAM,CAAC,YAAY,CACf,OAAO;gCACH,SAAS,CAAC,OAAO,CAAC,SAAS;gCAC3B,SAAS,EACb,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,CAC7B,CAAC;yBACL;qBACJ;iBACJ;aACJ;SACJ;QACD,OAAO,KAAK,CAAC;KAChB;CACJ,EACD,EAAE,MAAM,EAAE,kBAAkB,EAAE,CACjC,CAAC;AAEFA,UAAe,CACX;IACI,iBAAiB,EAAE,CAAC,SAA2B,KAC3C,iBAAiB,CAAU,CAAC;;;;;;IAOhC,oBAAoB,EAAE,CAAC,SAA2B,EAAE,OAAO;QACvD,iBAAiB,CAAU,CAAC,CAAC;QAC7B,OAAO,SAAS,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC;KAC5C;IACD,mBAAmB,EAAE,CAAC,SAA2B,EAAE,KAAK,KACpD,mBAAmB,CAAC,SAAS,EAAE,KAAK,CAAC;IACzC,oBAAoB,EAAE,CAAC,SAA2B,KAC9C,oBAAoB,CAAC,SAAS,CAAC;IAEnC,6BAA6B,EAAE,CAAC,SAA2B,EAAE,CAAC;QAC1D,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;QACpB,oBAAoB,CAAC,SAAS,CAAC,CAAC;QAChC,OAAO,IAAI,CAAC;KACf;CACJ,EACD,EAAE,MAAM,EAAE,kBAAkB,EAAE,CACjC,CAAC;AAEFA,UAAe,CACX;;IAEI,wBAAwB,EAAE,CAAC,SAA2B;QAClD,IAAI,WAAW,GAAG,KAAK,CAAC;QACxB,IAAI,SAAS,CAAC,eAAe,EAAE;YAC3B,WAAW,GAAG,SAAS,CAAC,eAAe,CAAC,SAAS,CAAC,QAAQ,CACtD,UAAU,CACb,CAAC;YACF,SAAS,CAAC,eAAe,CAAC,MAAM,EAAE,CAAC;YACnC,OAAO,SAAS,CAAC,eAAe,CAAC;YACjC,SAAS,CAAC,eAAe,GAAG,IAAI,CAAC;SACpC;QACD,mBAAmB,CAAC,SAAS,EAAE,WAAW,GAAG,EAAE,GAAG,UAAU,CAAC,CAAC;QAC9D,OAAO,KAAK,CAAC;KAChB;;IAED,0BAA0B,EAAE,CAAC,SAA2B;;QACpD,SAAS,CAAC,OAAO,CAAC,qBAAqB,GAAG;YACtC,MAAM,EAAE,QAAQ;YAEhB,MAAM,EAAE,QAAQ;YAChB,MAAM,EAAE,QAAQ;YAChB,MAAM,EAAE,SAAS;YACjB,OAAO,EAAE,QAAQ;SACpB,CAAC,SAAS,CAAC,OAAO,CAAC,qBAAqB,CAAC,CAAC;QAC3C,MAAM,KAAK,eACP,SAAS,CAAC,eAAe,0CAAE,aAAa,CACpC,+BAA+B,EACjC,EAAE,mCAAI,EAAE,CAAC;QACf,IAAI,SAAS,CAAC,eAAe,EAAE;YAC3B,SAAS,CAAC,eAAe,CAAC,MAAM,EAAE,CAAC;YACnC,OAAO,SAAS,CAAC,eAAe,CAAC;YACjC,SAAS,CAAC,eAAe,GAAG,IAAI,CAAC;SACpC;QACD,mBAAmB,CAAC,SAAS,CAAC,CAAC;QAC/B,IAAI,KAAK,EAAE;YACP,mBAAmB,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;SACzC;QACD,OAAO,KAAK,CAAC;KAChB;CACJ,EACD,EAAE,MAAM,EAAE,kBAAkB,EAAE,CACjC,CAAC;SAEc,mBAAmB,CAC/B,SAA2B,EAC3B,QAAmC,EAAE;IAErC,SAAS,CAAC,sBAAsB,GAAG,KAAK,CAAC;IACzC,qBAAqB,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;IACxC,OAAO,KAAK,CAAC;AACjB,CAAC;SAEe,mBAAmB,CAAC,SAA2B;IAC3D,SAAS,CAAC,sBAAsB,GAAG,IAAI,CAAC;IACxC,qBAAqB,CAAC,SAAS,CAAC,CAAC;IACjC,OAAO,KAAK,CAAC;AACjB,CAAC;AAED,SAAS,qBAAqB,CAC1B,SAA2B,EAC3B,KAAiC;IAEjC,SAAS,CAAC,sBAAsB,GAAG,CAAC,SAAS,CAAC,sBAAsB,CAAC;IACrE,IAAI,SAAS,CAAC,sBAAsB,EAAE;QAClC,SAAS,CAAC,KAAK,EAAE,CAAC;QAClB,IAAI,SAAS,CAAC,eAAe,EAAE;YAC3B,SAAS,CAAC,eAAe,CAAC,SAAS,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;SACzD;aAAM;;YAEH,SAAS,CAAC,eAAe,GAAG,YAAY,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;;YAE3D,EAAE,CACE,SAAS,CAAC,eAAe,EACzB,8BAA8B,EAC9B;gBACI,SAAS,CAAC,KAAK,EAAE,CAAC;aACrB,CACJ,CAAC;YACF,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,eAAe,CAAC,CAAC;SACxD;;;QAGD,MAAM,CAAC,UAAU,CAAC;YACd,SAAS,CAAC,eAAe,CAAC,SAAS,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;SACzD,EAAE,CAAC,CAAC,CAAC;KACT;SAAM,IAAI,SAAS,CAAC,eAAe,EAAE;QAClC,SAAS,CAAC,eAAe,CAAC,SAAS,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;KAC5D;IACD,IAAI,OAAO,SAAS,CAAC,OAAO,CAAC,uBAAuB,KAAK,UAAU,EAAE;QACjE,SAAS,CAAC,OAAO,CAAC,uBAAuB,CACrC,SAAS,EACT,SAAS,CAAC,sBAAsB,EAChC,SAAS,CAAC,eAAe,CAC5B,CAAC;KACL;IACD,OAAO,KAAK,CAAC;AACjB,CAAC;AAEDA,UAAe,CACX;IACI,qBAAqB,EAAE,CAAC,SAA2B,EAAE,KAAK,KACtD,qBAAqB,CAAC,SAAS,EAAE,KAAK,CAAC;IAC3C,mBAAmB,EAAE,CAAC,SAA2B,KAC7C,mBAAmB,CAAC,SAAS,CAAC;IAClC,mBAAmB,EAAE,CAAC,SAA2B,EAAE,KAAK,KACpD,mBAAmB,CAAC,SAAS,EAAE,KAAK,CAAC;CAC5C,EACD,EAAE,MAAM,EAAE,kBAAkB,EAAE,CACjC;;;;;;;;MCrSY,gBAAgB;;;;;;;;;IA+DzB,YACI,OAAoB,EACpB,OAAyC;;QA9CrC,gBAAW,GAAiB,EAAE,CAAC;QA4B/B,4BAAuB,GAAG,EAAE,CAAC;;QAqBjC,IAAI,CAAC,OAAO,GAAGQ,MAAa,CAACC,UAAiB,EAAE,EAAE;YAC9C,UAAU,EAAE,WAAW;YACvB,aAAa,EAAE;gBACX,QAAQ,EAAE,uBAAuB;gBACjC,MAAM,EAAE,qBAAqB;gBAC7B,MAAM,EAAE,qBAAqB;gBAC7B,OAAO,EAAE,uBAAuB;aACnC;YACD,GAAG,OAAO;SACb,CAAC,CAAC;QAEH,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,OAAO,CAAC,UAA8B,CAAC;QAC9D,IACI,OAAO,IAAI,CAAC,OAAO,CAAC,aAAa,KAAK,QAAQ;YAC9C,EAAE,IAAI,CAAC,OAAO,CAAC,aAAa,YAAY,gBAAgB,CAAC,EAC3D;YACE,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,OAAO,CAAC,aAAa;iBAC1C,OAA2B,CAAC;YACjC,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC,OAAO,CAAC,aAAa;iBAClD,QAA4B,CAAC;YAClC,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,OAAO,CAAC,aAAa;iBAChD,MAA0B,CAAC;YAChC,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,OAAO,CAAC,aAAa;iBAChD,MAA0B,CAAC;SACnC;QAED,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;QACvB,OAAO,CAAC,WAAW,CAAC,GAAG,IAAI,CAAC;;QAG5B,IAAI,CAAC,eAAe,GAAG,OAAO,CAAC,SAAS,CAAC;QACzC,IAAI,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC;QAC3C,IAAI,WAAW,EAAE;YACb,WAAW,GAAG,WAAW,CAAC,IAAI,EAAE,CAAC;SACpC;;QAGD,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,cAAc,EAAE,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;QAC7D,IAAI,CAAC,WAAW,CAAC,IAAI,CAACJ,MAAgB,CAAC,OAAO,EAAEE,UAAc,CAAC,CAAC,CAAC;QACjE,IAAI,CAAC,WAAW,CAAC,IAAI,CAACF,MAAgB,CAAC,OAAO,EAAEK,UAAmB,CAAC,CAAC,CAAC;;;;;;;;;;;;QAatE,IAAI,MAAM,GAAG,EAAE,CAAC;QAChB,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,kBAAkB,EAAE;YAClC,IAAI,2BAA2B,CAAC,IAAI,CAAC,SAAS,aAAT,SAAS,uBAAT,SAAS,CAAE,SAAS,CAAC,EAAE;;;gBAGxD,MAAM,IAAI;;;;;oBAKN,CAAC;aACR;iBAAM;gBACH,MAAM;oBACF,6BAA6B;wBAC7B,mFAAmF;wBACnF,qEACI,MAAA,OAAO,CAAC,QAAQ,mCAAI,CACxB,IAAI;wBACJ,aAAa;wBACb,SAAS,CAAC;aACjB;SACJ;aAAM;YACH,IAAI,OAAO,IAAI,CAAC,OAAO,CAAC,kBAAkB,KAAK,QAAQ,EAAE;gBACrD,MAAM,IAAI,IAAI,CAAC,OAAO,CAAC,kBAAkB,CAAC;aAC7C;iBAAM;;;;gBAIH,MAAM,IAAI,eAAe,CAAC;aAC7B;SACJ;QACD,MAAM;YACF,mCAAmC;gBACnC,iDAAiD,CAAC;;;QAItD,IAAI,IAAI,CAAC,OAAO,CAAC,mBAAmB,KAAK,QAAQ,EAAE;YAC/C,MAAM,IAAI,2GAA2GN,QAAI,CACrH,iCAAiC,CACpC,IAAI,CAAC;;YAEN,IAAI,IAAI,CAAC,OAAO,CAAC,0BAA0B,EAAE;gBACzC,MAAM,IAAI,IAAI,CAAC,OAAO,CAAC,0BAA0B,CAAC;aACrD;iBAAM;gBACH,MAAM,IAAI,ksDAAksD,CAAC;aAChtD;YACD,MAAM,IAAI,QAAQ,CAAC;SACtB;aAAM;YACH,MAAM,IAAI,gBAAgB,CAAC;SAC9B;QACD,MAAM,IAAI,SAAS,CAAC;QACpB,MAAM,IAAI;;;;;KAKb,CAAC;QAEE,IAAI,CAAC,OAAO,CAAC,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;QACzD,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE;YACxB,OAAO,CAAC,KAAK,CACT,8EAA8E;gBAC1E,8DAA8D;gBAC9D,kDAAkD;gBAClD,0DAA0D;gBAC1D,0CAA0C,EAE9C,mEAAmE,EACnE,4EAA4E,CAC/E,CAAC;YACF,OAAO,IAAI,CAAC;SACf;QAED,IAAI,MAAM,GAAG,CAAC,CAAC;QACf,IAAI,QAAqB,CAAC;QAC1B,IAAI,OAAO,IAAI,CAAC,OAAO,CAAC,kBAAkB,KAAK,UAAU,EAAE;YACvD,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,kBAAkB,EAAE,CAAC;SAChD;aAAM;YACH,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC;iBACrC,iBAAgC,CAAC;SACzC;QACD,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAgB,CAAC;;QAEtE,IAAI,CAAC,KAAK,CAAC,gBAAgB,CACvB,OAAO,EACP,CAAC,EAAE;YACC,EAAE,CAAC,cAAc,EAAE,CAAC;YACpB,EAAE,CAAC,eAAe,EAAE,CAAC;YACrB,MAAM,UAAU,GACZ,OAAO,EAAE,CAAC,MAAM,KAAK,WAAW,GAAG,EAAE,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,MAAM,CAAC;YAC9D,IAAI,QAAQ,CAAC,UAAU,CAAC,EAAE;gBACtB,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC;oBACd,GAAG,EAAE,CAAC;oBACN,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,UAAU,GAAG,UAAU,GAAG,CAAC;iBAC/C,CAAC,CAAC;aACN;SACJ,EACD,EAAE,OAAO,EAAE,KAAK,EAAE,CACrB,CAAC;;;QAIF,QAAQ,CAAC,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC;YACtB,MAAM,CAAC,IAAI,CAAC,CAAC;SAChB,CAAC,CAAC;QAEH,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC;aACvD,QAAQ,CAAC,CAAC,CAAgB,CAAC;QAChC,oBAAoB,CAAC,IAAI,EAAE,IAAI,CAAC,qBAAqB,EAAE;YACnD,OAAO,EAAE,uBAAuB;YAChC,GAAG,EAAE,0BAA0B;YAC/B,KAAK,EAAE,4BAA4B;SACtC,CAAC,CAAC;QACH,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,MAAM,CAAC;aAC5C,QAAQ,CAAC,CAAC,CAAgB,CAAC;QAChC,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC;aAChD,QAAQ,CAAC,CAAC,CAAgB,CAAC;;;QAGhC,IAAI,CAAC,OAAO,GAAG,gBAAgB,CAC3B,wBAAwB,EACxB,aAAa,CAChB,CAAC;QACF,IAAI,CAAC,WAAW,CAAC,IAAI,CAACC,MAAgB,CAAC,IAAI,EAAEM,UAAiB,CAAC,CAAC,CAAC;QACjE,IAAI,CAAC,gBAAgB,GAAG,gBAAgB,CACpC,kCAAkC,EAClC,uBAAuB,CAC1B,CAAC;QACF,IAAI,CAAC,WAAW,CAAC,IAAI,CACjBN,MAAgB,CAAC,IAAI,EAAEO,UAA0B,CAAC,CACrD,CAAC;;;QAGF,IAAI,CAAC,uBAAuB,GAAG,KAAK,CAAC;QACrC,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;QACpC,IAAI,CAAC,eAAe,GAAG,EAAE,CAAC;QAC1B,IAAI,CAAC,qBAAqB,GAAG,EAAE,CAAC;QAChC,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC;;;QAGtC,IAAI,CAAC,eAAe,GAAG,CAAC,CAAC;;;;;;;;QAQzB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC;QACrC,IAAI,CAAC,mBAAmB,GAAG,KAAK,CAAC;;;QAGjC,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC;;QAEhB,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;QACpB,EAAE,CAAC,IAAI,CAAC,OAAO,EAAE,OAAO,EAAE,IAAI,CAAC,CAAC;QAChC,EAAE,CAAC,IAAI,CAAC,OAAO,EAAE,MAAM,EAAE,IAAI,CAAC,CAAC;;;QAG/B,IAAI,CAAC,gBAAgB,GAAG,sBAAsB,CAC1C,QAA+B,EAC/B;YACI,SAAS,EAAE,CAAC,IAAY,KAAW,WAAW,CAAC,IAAI,EAAE,IAAI,CAAC;YAC1D,GAAG,EAAE,MAAM,KAAK,CAAC,IAAI,CAAC;YACtB,IAAI,EAAE,CAAC,EAAE,KAAK,MAAM,CAAC,IAAI,EAAE,EAAE,CAAC;YAC9B,KAAK,EAAE,CAAC,EAAE,KAAK,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC;YAChC,SAAS,EAAE,CAAC,SAAS,EAAE,CAAC,KAAK,WAAW,CAAC,IAAI,EAAE,SAAS,EAAE,CAAC,CAAC;YAC5D,KAAK,EAAE,MAAM,IAAI,CAAC,OAAO,EAAE;YAC3B,IAAI,EAAE,MAAM,IAAI,CAAC,MAAM,EAAE;YACzB,gBAAgB,EAAE,CAAC,WAAmB,KAClC,IAAI,CAAC,kBAAkB,CAAC,WAAW,CAAC;YACxC,iBAAiB,EAAE,CAAC,WAAmB,KACnC,IAAI,CAAC,mBAAmB,CAAC,WAAW,CAAC;YACzC,cAAc,EAAE,CAAC,WAAmB,KAChC,IAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC;SACzC,CACJ,CAAC;;QAGF,IAAI,MAAM,CAAC,YAAY,EAAE;;YAErB,EAAE,CAAC,IAAI,CAAC,KAAK,EAAE,aAAa,EAAE,IAAI,CAAC,CAAC;SACvC;aAAM;YACH,EAAE,CAAC,IAAI,CAAC,KAAK,EAAE,6BAA6B,EAAE,IAAI,CAAC,CAAC;SACvD;;;;QAKD,EAAE,CAAC,MAAM,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC;;QAG3B,IAAI,CAAC,KAAK,GAAG,IAAI,YAAY,CACzB;YACI,IAAI,EAAE,IAAI,CAAC,OAAO,CAAC,WAAW;YAC9B,MAAM,EAAE,IAAI,CAAC,OAAO,CAAC,MAAM;YAC3B,2BAA2B,EAAE,IAAI,CAAC,OAAO;iBACpC,2BAA2B;SACnC,EACD;YACI,kBAAkB,EAAE,CAAC,OAAqB,KACtC,IAAI,CAAC,OAAO,CAAC,kBAAkB,CAAC,IAAI,CAAC;YACzC,oBAAoB,EAAE,CAAC,OAAqB,KACxC,IAAI,CAAC,qBAAqB,EAAE;YAChC,mBAAmB,EAAE,MACjB,IAAI,CAAC,OAAO,CAAC,mBAAmB,CAAC,IAAI,CAAC;YAC1C,qBAAqB,EAAE,MACnB,IAAI,CAAC,OAAO,CAAC,qBAAqB,CAAC,IAAI,CAAC;YAC5C,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,OAAO;SAChC,EACD;YACI,QAAQ,EAAE,CACN,OAAkB,EAClB,OAAe,EACf,gBAAwB,EACxB,KAAa,gCAEb,MAAA,IAAI,CAAC,OAAO,EAAC,UAAU,mDACnB,IAAI,EACJ,OAAO,EACP,gBAAgB,EAChB,KAAK,IACR;YACL,OAAO,EAAE,CAAC,OAAO,EAAE,SAAS,KACxB,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,EAAE,SAAS,CAAC;YAC7C,MAAM,EAAE,CAAC,OAAO,EAAE,SAAS,KACvB,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,EAAE,SAAS,CAAC;SAC/C,EACD,IAAI,CACP,CAAC;;QAGF,IAAI,CAAC,WAAW,GAAG,IAAI,WAAW,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;;QAG/C,IAAI,WAAW,EAAE;YACb,MAAM,CAAC,IAAI,CAAC,KAAK,EAAE,WAAW,EAAE;gBAC5B,aAAa,EAAE,YAAY;gBAC3B,aAAa,EAAE,OAAO;gBACtB,MAAM,EAAE,OAAO;gBACf,IAAI,EAAE,MAAM;gBACZ,2BAA2B,EAAE,IAAI;gBACjC,MAAM,EAAE,IAAI,CAAC,OAAO,CAAC,MAAM;aAC9B,CAAC,CAAC;SACN;;QAGD,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,CAAC;QAClC,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QAExC,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC;YACpB,kBAAkB,EAAE,CAAC,OAAqB,KACtC,IAAI,CAAC,OAAO,CAAC,kBAAkB,CAAC,IAAI,CAAC;YACzC,oBAAoB,EAAE,CAAC,OAAqB,KACxC,IAAI,CAAC,qBAAqB,EAAE;YAChC,mBAAmB,EAAE,MAAM,IAAI,CAAC,OAAO,CAAC,mBAAmB,CAAC,IAAI,CAAC;YACjE,qBAAqB,EAAE,MACnB,IAAI,CAAC,OAAO,CAAC,qBAAqB,CAAC,IAAI,CAAC;YAC5C,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,OAAO;SAChC,CAAC,CAAC;QACH,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC;YAChB,QAAQ,EAAE,CAAC,OAAkB,EAAE,OAAO,EAAE,gBAAgB,EAAE,KAAK,gCAC3D,MAAA,IAAI,CAAC,OAAO,EAAC,UAAU,mDACnB,IAAI,EACJ,OAAO,EACP,gBAAgB,EAChB,KAAK,IACR;YACL,OAAO,EAAE,CAAC,OAAO,EAAE,SAAS,KACxB,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,EAAE,SAAS,CAAC;YAC7C,MAAM,EAAE,CAAC,OAAO,EAAE,SAAS,KACvB,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,EAAE,SAAS,CAAC;SAC/C,CAAC,CAAC;QAEH,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,UAAU,CAAC,uBAAuB,EAAE,CAAC,MAAM,CAAC,EAAE;YACnE,uBAAuB,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;SAChD;QACD,IAAI,CAAC,WAAW,GAAG,oBAAoB,CACnC,IAAI,CAAC,OAAO,CAAC,WAAW,EACxB,CAAC,CAAC;YACE,IAAI,OAAO,IAAI,CAAC,OAAO,CAAC,OAAO,KAAK,UAAU,EAAE;gBAC5C,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC;oBACjB,IAAI,EAAE,oBAAoB;oBAC1B,GAAG,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC;iBACpB,CAAC,CAAC;aACN;YACD,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;SAC7B,CACJ,CAAC;QACF,aAAa,CAAC,IAAI,CAAC,CAAC;KACvB;;IAGD,UAAU,CAAC,MAAwC;QAC/C,UAAU,CAAC,YAAY,CAAC,CAAC;QACzB,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;KAC3B;IACD,UAAU,CAAC,MAAwC;QAC/C,IAAI,CAAC,OAAO,GAAGJ,MAAa,CAAC,IAAI,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;QACnD,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC;YACpB,kBAAkB,EAAE,CAAC,OAAqB,KACtC,IAAI,CAAC,OAAO,CAAC,kBAAkB,CAAC,IAAI,CAAC;YACzC,oBAAoB,EAAE,CAAC,OAAqB,KACxC,IAAI,CAAC,qBAAqB,EAAE;YAChC,mBAAmB,EAAE,MAAM,IAAI,CAAC,OAAO,CAAC,mBAAmB,CAAC,IAAI,CAAC;YACjE,qBAAqB,EAAE,MACnB,IAAI,CAAC,OAAO,CAAC,qBAAqB,CAAC,IAAI,CAAC;YAC5C,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,OAAO;SAChC,CAAC,CAAC;QACH,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC;YAChB,QAAQ,EAAE,CAAC,OAAkB,EAAE,OAAO,EAAE,gBAAgB,EAAE,KAAK,gCAC3D,MAAA,IAAI,CAAC,OAAO,EAAC,UAAU,mDACnB,IAAI,EACJ,OAAO,EACP,gBAAgB,EAChB,KAAK,IACR;YACL,OAAO,EAAE,CAAC,OAAO,EAAE,SAAS,KACxB,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,EAAE,SAAS,CAAC;YAC7C,MAAM,EAAE,CAAC,OAAO,EAAE,SAAS,KACvB,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,EAAE,SAAS,CAAC;SAC/C,CAAC,CAAC;QAEH,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,UAAU,CAAC,uBAAuB,EAAE,CAAC,MAAM,CAAC,EAAE;YACnE,uBAAuB,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;SAChD;QACD,IAAI,CAAC,WAAW,GAAG,oBAAoB,CACnC,IAAI,CAAC,OAAO,CAAC,WAAW,EACxB,CAAC,CAAC;YACE,IAAI,OAAO,IAAI,CAAC,OAAO,CAAC,OAAO,KAAK,UAAU,EAAE;gBAC5C,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC;oBACjB,IAAI,EAAE,oBAAoB;oBAC1B,GAAG,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC;iBACpB,CAAC,CAAC;aACN;YACD,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;SAC7B,CACJ,CAAC;QAEF,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,OAAO,CAAC,UAA8B,CAAC;QAC9D,IACI,OAAO,IAAI,CAAC,OAAO,CAAC,aAAa,KAAK,QAAQ;YAC9C,EAAE,IAAI,CAAC,OAAO,CAAC,aAAa,YAAY,gBAAgB,CAAC,EAC3D;YACE,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,OAAO,CAAC,aAAa;iBAC1C,OAA2B,CAAC;YACjC,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC,OAAO,CAAC,aAAa;iBAClD,QAA4B,CAAC;YAClC,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,OAAO,CAAC,aAAa;iBAChD,MAA0B,CAAC;YAChC,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,OAAO,CAAC,aAAa;iBAChD,MAA0B,CAAC;SACnC;QAED,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE;YACxB,IAAI,CAAC,MAAM,EAAE,CAAC;SACjB;;;QAGD,MAAM,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,EAAE,WAAW,EAAE,KAAK,EAAE,CAAC,CAAC;QACtE,MAAM,CAAC,IAAI,CAAC,KAAK,EAAE,OAAO,EAAE;YACxB,aAAa,EAAE,YAAY;YAC3B,aAAa,EAAE,OAAO;YACtB,MAAM,EAAE,OAAO;YACf,IAAI,EAAE,MAAM;YACZ,2BAA2B,EAAE,IAAI;YACjC,MAAM,EAAE,IAAI,CAAC,OAAO,CAAC,MAAM;SAC9B,CAAC,CAAC;QACH,aAAa,CAAC,IAAI,CAAC,CAAC;KACvB;;IAaD,SAAS,CACL,IAAwE;QAExE,UAAU,CAAC,WAAW,CAAC,CAAC;QACxB,OAAOK,GAAU,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;KACzC;IAMD,UAAU,CACN,IAAwE;QAExE,OAAOA,GAAU,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;KACzC;IACD,SAAS,CACL,GAAM;QAEN,OAAOA,GAAU,CAAC,IAAI,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC;KACxC;;;;;;;;;;IAWD,WAAW,CAAC,GAAU;QAClB,QAAQ,GAAG,CAAC,IAAI;YACZ,KAAK,OAAO;gBACR,IAAI,CAAC,IAAI,CAAC,uBAAuB,EAAE;oBAC/B,IAAI,CAAC,uBAAuB,GAAG,OAAO,CAAC;oBACvC,IAAI,CAAC,OAAO,EAAE,CAAC;oBACf,IAAI,CAAC,uBAAuB,GAAG,EAAE,CAAC;iBACrC;gBACD,MAAM;YACV,KAAK,MAAM;gBACP,IAAI,CAAC,IAAI,CAAC,uBAAuB,EAAE;oBAC/B,IAAI,CAAC,uBAAuB,GAAG,MAAM,CAAC;oBACtC,IAAI,CAAC,MAAM,EAAE,CAAC;oBACd,IAAI,CAAC,uBAAuB,GAAG,EAAE,CAAC;iBACrC;gBACD,MAAM;YACV,KAAK,YAAY,CAAC;YAClB,KAAK,WAAW;;gBAEZ,aAAa,CAAC,IAAI,EAAE,GAAmB,CAAC,CAAC;gBACzC,MAAM;YACV,KAAK,aAAa;gBACd,aAAa,CAAC,IAAI,EAAE,GAAmB,CAAC,CAAC;gBACzC,MAAM;YACV,KAAK,QAAQ,EAAE;gBACX,IAAI,IAAI,CAAC,WAAW,EAAE;oBAClB,MAAM,CAAC,oBAAoB,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;iBACjD;gBACD,IAAI,CAAC,WAAW,GAAG,MAAM,CAAC,qBAAqB,CAC3C,MAAM,gBAAgB,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,QAAQ,EAAE,CAClD,CAAC;gBACF,MAAM;aACT;YACD;gBACI,OAAO,CAAC,IAAI,CAAC,uBAAuB,EAAE,GAAG,CAAC,IAAI,CAAC,CAAC;SACvD;KACJ;;IAED,wBAAwB;QACpB,UAAU,CAAC,0BAA0B,CAAC,CAAC;QACvC,IAAI,CAAC,OAAO,EAAE,CAAC;QACf,IAAI,CAAC,OAAO,CAAC,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;KAC1E;IACD,OAAO;QACH,IAAI,CAAC,OAAO,CAAC,SAAS,GAAG,IAAI,GAAG,IAAI,CAAC,QAAQ,EAAE,GAAG,IAAI,CAAC;QACvD,OAAO,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;QACjC,OAAO,IAAI,CAAC,cAAc,CAAC;QAC3B,OAAO,IAAI,CAAC,YAAY,CAAC;QACzB,OAAO,IAAI,CAAC,KAAK,CAAC;QAClB,OAAO,IAAI,CAAC,YAAY,CAAC;QACzB,OAAO,IAAI,CAAC,gBAAgB,CAAC;QAC7B,IAAI,CAAC,qBAAqB,CAAC,MAAM,EAAE,CAAC;QACpC,OAAO,IAAI,CAAC,qBAAqB,CAAC;QAClC,oBAAoB,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QACnC,OAAO,IAAI,CAAC,OAAO,CAAC;QACpB,oBAAoB,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;QAC5C,OAAO,IAAI,CAAC,gBAAgB,CAAC;QAC7B,oBAAoB,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;QAC3C,OAAO,IAAI,CAAC,eAAe,CAAC;QAC5B,oBAAoB,CAChB,QAAQ,CAAC,cAAc,CAAC,+BAA+B,CAAC,CAC3D,CAAC;QACF,GAAG,CAAC,IAAI,CAAC,OAAO,EAAE,aAAa,EAAE,IAAI,CAAC,CAAC;QACvC,GAAG,CAAC,IAAI,CAAC,OAAO,EAAE,6BAA6B,EAAE,IAAI,CAAC,CAAC;QACvD,GAAG,CAAC,IAAI,CAAC,OAAO,EAAE,OAAO,EAAE,IAAI,CAAC,CAAC;QACjC,GAAG,CAAC,IAAI,CAAC,OAAO,EAAE,MAAM,EAAE,IAAI,CAAC,CAAC;QAChC,GAAG,CAAC,MAAM,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC;QAC5B,OAAO,IAAI,CAAC,OAAO,CAAC;QACpB,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,OAAO,EAAE,CAAC,CAAC;KAChD;IAED,oBAAoB,CAAC,OAA4B;QAC7C,OAAO,GAAG,OAAO,aAAP,OAAO,cAAP,OAAO,GAAI,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC;QACtC,IAAI,OAAO,CAAC,KAAK,EAAE;YACf,IAAI,IAAI,CAAC,OAAO,CAAC,qBAAqB,EAAE;;gBAEpC,IAAI,CAAC,yBAAyB,GAAG,UAAU,CAAC;oBACxC,IAAI,CAAC,oBAAoB,EAAE,CAAC;iBAC/B,EAAE,IAAI,CAAC,OAAO,CAAC,qBAAqB,CAAC,CAAC;aAC1C;YACD,OAAO;SACV;QACD,IAAI,CAAC,eAAe,GAAG,EAAE,CAAC;QAC1B,IAAI,CAAC,qBAAqB,GAAG,EAAE,CAAC;QAChC,YAAY,CAAC,IAAI,CAAC,yBAAyB,CAAC,CAAC;KAChD;IAEO,qBAAqB;;QAEzB,uBAAuB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;;;QAGpC,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAC1B,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,EAAE,gBAAgB,CAAC,CACxD,CAAC;;QAGF;YACI,MAAM,OAAO,GACT,OAAO,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC;gBACxC,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC;YAC7B,IAAI,IAAI,CAAC,IAAI,KAAK,SAAS,IAAI,OAAO,KAAK,SAAS,EAAE;gBAClD,QAAQ,CAAC,IAAI,EAAE,QAAQ,EAAE,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC;aAC/C;iBAAM;gBACH,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;aAC5B;SACJ;;;QAGD,qBAAqB,CAAC,IAAI,EAAE,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC,CAAC;;QAGhD,IAAI,OAAO,IAAI,CAAC,OAAO,CAAC,oBAAoB,KAAK,UAAU,EAAE;YACzD,IAAI,CAAC,OAAO,CAAC,oBAAoB,CAAC,IAAI,CAAC,CAAC;SAC3C;KACJ;IAEO,OAAO;QACX,IAAI,IAAI,CAAC,OAAO,CAAC,QAAQ;YAAE,OAAO;QAClC,IAAI,IAAI,CAAC,OAAO,EAAE;YACd,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;YACrB,IAAI,CAAC,gBAAgB,CAAC,KAAK,EAAE,CAAC;YAC9B,IAAI,IAAI,CAAC,OAAO,CAAC,mBAAmB,KAAK,SAAS,EAAE;gBAChD,mBAAmB,CAAC,IAAI,CAAC,CAAC;aAC7B;YACD,qBAAqB,CAAC,IAAI,CAAC,CAAC;YAC5B,IAAI,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE;gBACtB,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;aAC9B;;;;;YAKD,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;YACpC,aAAa,CAAC,IAAI,CAAC,CAAC;SACvB;KACJ;IACO,MAAM;QACV,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE;YACf,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;YACpB,IAAI,CAAC,YAAY,CAAC,WAAW,GAAG,EAAE,CAAC;YACnC,IAAI,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,mBAAmB,CAAC,EAAE;gBACzD,mBAAmB,CAAC,IAAI,CAAC,CAAC;aAC7B;YACD,QAAQ,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;YACzB,aAAa,CAAC,IAAI,CAAC,CAAC;YACpB,IAAI,OAAO,IAAI,CAAC,OAAO,CAAC,MAAM,KAAK,UAAU,EAAE;gBAC3C,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;aAC7B;YACD,IACI,OAAO,IAAI,CAAC,OAAO,CAAC,QAAQ,KAAK,UAAU;gBAC3C,IAAI,CAAC,QAAQ,EAAE,KAAK,IAAI,CAAC,YAAY,EACvC;gBACE,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;aAC/B;SACJ;KACJ;IACO,kBAAkB,CAAC,YAAoB;;QAE3C,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC;QACpD,qBAAqB,CAAC;YAClB,MAAM,CAAC,IAAI,CAAC,CAAC;;;YAGb,MAAM,UAAU,GAAG,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YAC7C,IAAI,CAAC,UAAU;gBAAE,OAAO;YACxB,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC,EAAE,UAAU,CAAC,CAAC,CAAC,CAAC;SAC5D,CAAC,CAAC;KACN;IACO,mBAAmB,CAAC,WAAmB;QAC3C,iBAAiB,CAAC,IAAI,CAAC,KAAK,EAAE,WAAW,CAAC,CAAC;QAC3C,aAAa,CAAC,IAAI,CAAC,CAAC;KACvB;IACO,gBAAgB,CAAC,WAAmB;QACxC,iBAAiB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAC9B,WAAW,CAAC,IAAI,EAAE,WAAW,EAAE;YAC3B,iBAAiB,EAAE,IAAI;SAC1B,CAAC,CAAC;KACN;IACO,QAAQ;QACZ,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,MAAM,CACzB,mBAAmB,EACnB,iBAAiB,EACjB,qBAAqB,CACxB,CAAC;QACF,IAAI,MAAM,CAAC,UAAU,IAAI,IAAI,EAAE;YAC3B,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,qBAAqB,CAAC,CAAC;SACrD;aAAM,IAAI,MAAM,CAAC,UAAU,IAAI,GAAG,EAAE;YACjC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,iBAAiB,CAAC,CAAC;SACjD;aAAM;YACH,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,mBAAmB,CAAC,CAAC;SACnD;QACD,qBAAqB,CAAC,IAAI,CAAC,CAAC;KAC/B;;IAGD,QAAQ,CAAC,OAAsD;QAC3D,UAAU,CAAC,UAAU,CAAC,CAAC;QACvB,OAAO,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC;KACvC;IAED,cAAc,CACV,OAAsD;QAEtD,OAAO,OAAO,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;KACjC;IAED,IAAI,UAAU;QACV,OAAO,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC;KAChC;IACD,IAAI,SAAS;QACT,OAAO,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC;KAC/B;IACD,IAAI,SAAS,CAAC,KAAgB;QAC1B,IAAI,CAAC,KAAK,CAAC,SAAS,GAAG,KAAK,CAAC;KAChC;;IAGD,KAAK,CAAC,MAAoB;QACtB,OAAO,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;KAChC;IAOD,QAAQ,CACJ,IAAgD,EAChD,IAA4B,EAC5B,IAAmB;QAEnB,OAAO,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;KAChD;IAED,QAAQ,CAAC,KAAa,EAAE,OAAuB;QAC3C,OAAO,GAAG,OAAO,aAAP,OAAO,cAAP,OAAO,GAAI,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;QACtC,IAAI,OAAO,OAAO,CAAC,aAAa,KAAK,WAAW,EAAE;YAC9C,OAAO,CAAC,aAAa,GAAG,YAAY,CAAC;SACxC;QACD,IACI,OAAO,OAAO,CAAC,MAAM,KAAK,WAAW;YACrC,OAAO,CAAC,MAAM,KAAK,MAAM,EAC3B;YACE,OAAO,CAAC,MAAM,GAAG,OAAO,CAAC;SAC5B;QACD,IAAI,MAAM,CAAC,IAAI,CAAC,KAAK,EAAE,KAAK,EAAE,OAAO,CAAC,EAAE;YACpC,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YACxC,aAAa,CAAC,IAAI,CAAC,CAAC;SACvB;KACJ;;;;IAKD,IAAI,CAAC,KAAsB;QACvB,OAAO,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;KAClC;;IAGD,aAAa,CAAC,MAAoB;QAC9B,UAAU,CAAC,eAAe,CAAC,CAAC;QAE5B,OAAO,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;KACtD;;IAGD,qBAAqB;QACjB,UAAU,CAAC,uBAAuB,CAAC,CAAC;QACpC,OAAO,IAAI,CAAC,KAAK,CAAC,oBAAoB,CAAC;KAC1C;;IAED,eAAe;QACX,UAAU,CAAC,iBAAiB,CAAC,CAAC;QAC9B,OAAO,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,SAAS,CAAC;KACvD;;;;;;IAOD,iBAAiB;QACb,UAAU,CAAC,mBAAmB,CAAC,CAAC;QAChC,OAAO,KAAK,CAAC;KAChB;;IAED,eAAe;QACX,UAAU,CAAC,iBAAiB,CAAC,CAAC;QAC9B,OAAO,KAAK,CAAC;KAChB;;IAGD,MAAM,CAAC,IAAa,EAAE,OAAuB;QACzC,UAAU,CAAC,QAAQ,CAAC,CAAC;QACrB,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE;YAC1B,MAAM,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE;gBAC3C,WAAW,EAAE,KAAK;aACrB,CAAC,CAAC;YACH,IAAI,IAAI,KAAK,QAAQ,EAAE;gBACnB,OAAO,GAAG,OAAO,aAAP,OAAO,cAAP,OAAO,GAAI,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;gBACtC,MAAM,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,EAAE;oBACrB,aAAa,EAAE,YAAY;oBAC3B,aAAa,EAAE,OAAO;oBACtB,MAAM,EAAE,OAAO;oBACf,IAAI,EAAE,MAAM;oBACZ,2BAA2B,EACvB,OAAO,CAAC,2BAA2B;oBACvC,MAAM,EAAE,IAAI,CAAC,OAAO,CAAC,MAAM;iBAC9B,CAAC,CAAC;gBACH,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;gBACxC,aAAa,CAAC,IAAI,CAAC,CAAC;aACvB;YACD,OAAO,IAAI,CAAC;SACf;;QAED,OAAO,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,EAAE,WAAW,EAAE,KAAK,EAAE,CAAC,CAAC;KAChE;;IAED,GAAG;QACC,UAAU,CAAC,KAAK,CAAC,CAAC;QAClB,OAAO,IAAI,CAAC,OAAO,CAAC;KACvB;IACD,cAAc;;;;QAGV,IAAI,IAAI,CAAC,KAAK,EAAE;YACZ,MAAM,CAAC,IAAI,CAAC,CAAC;SAChB;QACD,MAAM,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,qBAAqB,EAAE,CAAC;QACvD,IAAI,UAAkB,CAAC;QACvB,IAAI,IAAI,CAAC,KAAK,CAAC,oBAAoB,EAAE;YACjC,UAAU,SAAG,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC,0CAAE,CAAC,CAAC;SAC7C;aAAM;YACH,MAAM,eAAe,GAAG,kBAAkB,CAAC,IAAI,CAAC,CAAC;YACjD,IAAI,eAAe,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC5B,UAAU;oBACN,eAAe,CAAC,CAAC,CAAC,CAAC,KAAK;wBACxB,WAAW,CAAC,IAAI;wBAChB,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC;aAC7B;SACJ;QACD,IAAI,OAAO,UAAU,KAAK,WAAW,EAAE;YACnC,MAAM,CAAC,GAAG,UAAU,GAAG,MAAM,CAAC,OAAO,CAAC;YACtC,IAAI,CAAC,GAAG,WAAW,CAAC,IAAI,EAAE;gBACtB,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC;oBACd,GAAG,EAAE,CAAC;oBACN,IAAI,EAAE,CAAC,GAAG,WAAW,CAAC,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,UAAU,GAAG,EAAE;oBACvD,QAAQ,EAAE,QAAQ;iBACrB,CAAC,CAAC;aACN;iBAAM,IAAI,CAAC,GAAG,WAAW,CAAC,KAAK,EAAE;gBAC9B,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC;oBACd,GAAG,EAAE,CAAC;oBACN,IAAI,EAAE,CAAC,GAAG,WAAW,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,UAAU,GAAG,EAAE;oBACxD,QAAQ,EAAE,QAAQ;iBACrB,CAAC,CAAC;aACN;SACJ;KACJ;;IAED,OAAO,CAAC,CAAS,EAAE,OAAuB;QACtC,UAAU,CAAC,SAAS,CAAC,CAAC;QACtB,OAAO,IAAI,CAAC,MAAM,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC;KAClC;IACD,MAAM,CAAC,CAAS,EAAE,OAAuB;;QACrC,IAAI,OAAO,CAAC,KAAK,QAAQ,IAAI,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;YACvC,OAAO,GAAG,OAAO,aAAP,OAAO,cAAP,OAAO,GAAI,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;YACtC,IAAI,OAAO,CAAC,KAAK,EAAE;gBACf,IAAI,CAAC,KAAK,EAAE,CAAC;aAChB;YACD,IAAI,OAAO,CAAC,QAAQ,EAAE;gBAClB,IAAI,IAAI,CAAC,OAAO,CAAC,iBAAiB,KAAI,SAAS,aAAT,SAAS,uBAAT,SAAS,CAAE,OAAO,CAAA,EAAE;oBACtD,SAAS,CAAC,OAAO,CAAC,wBAAwB,CAAC,CAAC;iBAC/C;gBACD,MAAA,IAAI,CAAC,aAAa,0CAAE,IAAI,GAAG;aAC9B;YACD,IAAI,CAAC,KAAK,MAAM,EAAE;;gBAEd,WAAW,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;aAC3B;iBAAM,IAAI,CAAC,KAAK,GAAG,EAAE;gBAClB,cAAc,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;aAC9B;iBAAM;gBACH,MAAM,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC;gBAC9B,MAAM,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC,EAAE;oBAClB,IAAI,EAAE,IAAI,CAAC,IAAI;oBACf,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,aAAa;oBACvD,GAAG,OAAO;iBACb,CAAC,CAAC;gBACH,IAAI,OAAO,CAAC,UAAU,EAAE;oBACpB,IAAI,CAAC,KAAK,GAAG,UAAU,CAAC;iBAC3B;aACJ;YACD,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YACxC,aAAa,CAAC,IAAI,CAAC,CAAC;YACpB,OAAO,IAAI,CAAC;SACf;QACD,OAAO,KAAK,CAAC;KAChB;IACD,UAAU,CAAC,IAAe,EAAE,MAAM,GAAG,EAAE,EAAE,MAAM,GAAG,EAAE;QAChD,IAAI,IAAI,CAAC,IAAI,KAAK,IAAI;YAAE,OAAO;QAC/B,IAAI,CAAC,KAAK,CAAC,kBAAkB,CACzB,EAAE,OAAO,EAAE,CAAC,CAAC,MAAM,IAAI,CAAC,CAAC,MAAM,EAAE,SAAS,EAAE,IAAI,EAAE,EAClD;YACI,IAAI,CAAC,oBAAoB,EAAE,CAAC;;;YAG5B,IAAI,CAAC,mBAAmB;gBACpB,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAC1D,IAAI,MAAM,EAAE;gBACR,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE;oBAChB,MAAM,EAAE,OAAO;oBACf,IAAI,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC,IAAI,CAAC;iBAC7C,CAAC,CAAC;aACN;YAED,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;YAEjB,IAAI,IAAI,KAAK,SAAS,EAAE;gBACpB,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,eAAe,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC;gBACpD,WAAW,CAAC,IAAI,CAAC,CAAC;gBAClB,IAAI,CAAC,eAAe,GAAG,CAAC,CAAC;;gBAEzB,IAAI,IAAI,CAAC,sBAAsB,EAAE;oBAC7B,mBAAmB,CAAC,IAAI,EAAE,eAAe,CAAC,CAAC;iBAC9C;;gBAGD,MAAM,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;gBAClD,MAAM,CAAC,MAAM,CAAC,gBAAgB,CAC1B,CAAC,IAAI,WAAW,CAAC,IAAI,CAAC,CAAC,EACvB,MAAM,CACT,CAAC;gBACF,IAAI,CAAC,KAAK,CAAC,QAAQ,IAAI,CAAC,CAAC;aAC5B;iBAAM;;gBAEH,eAAe,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;oBAClC,CAAC,CAAC,OAAO,GAAG,KAAK,CAAC;iBACrB,CAAC,CAAC;aACN;YACD,IAAI,MAAM,EAAE;gBACR,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE;oBAChB,MAAM,EAAE,OAAO;oBACf,IAAI,EAAE,IAAI;iBACb,CAAC,CAAC;aACN;;YAED,IAAI,OAAO,IAAI,CAAC,OAAO,CAAC,YAAY,KAAK,UAAU,EAAE;gBACjD,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;aAC9C;YACD,aAAa,CAAC,IAAI,CAAC,CAAC;SACvB,CACJ,CAAC;KACL;;IAGD,SAAS;QACL,UAAU,CAAC,WAAW,CAAC,CAAC;QACxB,OAAO,IAAI,CAAC,QAAQ,EAAE,CAAC;KAC1B;IACD,QAAQ;QACJ,OAAO,QAAQ,CAAC,QAAQ,EAAE,IAAI,IAAI,CAAC,gBAAgB,CAAC,QAAQ,EAAE,CAAC;KAClE;IACD,KAAK;QACD,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,EAAE;YAClB,IAAI,CAAC,gBAAgB,CAAC,KAAK,EAAE,CAAC;YAC9B,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;SAC/B;KACJ;IACD,IAAI;QACA,IAAI,IAAI,CAAC,QAAQ,EAAE,EAAE;YACjB,IAAI,CAAC,gBAAgB,CAAC,IAAI,EAAE,CAAC;SAChC;KACJ;;IAED,MAAM;QACF,UAAU,CAAC,QAAQ,CAAC,CAAC;QACrB,OAAO,IAAI,CAAC,KAAK,EAAE,CAAC;KACvB;;IAED,KAAK;QACD,UAAU,CAAC,OAAO,CAAC,CAAC;QACpB,OAAO,IAAI,CAAC,IAAI,EAAE,CAAC;KACtB;;IAED,OAAO;QACH,IAAI,CAAC,MAAM,EAAE,CAAC;KACjB;IACD,MAAM;QACF,IAAI,CAAC,KAAK,CAAC,SAAS,GAAG,EAAE,MAAM,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,EAAE,CAAC;KACnE;;IAED,eAAe;QACX,UAAU,CAAC,iBAAiB,CAAC,CAAC;QAC9B,WAAW,CAAC,IAAI,CAAC,KAAK,EAAE,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC;KACxD;IAED,UAAU,CAAC,KAAY,EAAE,KAAa;QAClC,IAAI,OAAO,KAAK,KAAK,WAAW,EAAE;YAC9B,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,KAAK,KACtCjB,YAAU,CAAC,IAAI,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC,CACvC,CAAC;SACL;aAAM;YACHA,YAAU,CAAC,IAAI,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC;SACxC;KACJ;;IAGD,WAAW,CAAC,KAAY;QACpB,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,KAAK,KACtCA,YAAU,CAAC,IAAI,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC,CACvC,CAAC;KACL;;IAGD,UAAU,CAAC,IAAY,EAAE,GAAmB;QACxC,UAAU,CAAC,YAAY,CAAC,CAAC;QACzB,OAAO,WAAW,CAAC,IAAI,EAAE,IAAI,EAAE,GAAG,CAAC,CAAC;KACvC;;IAED,UAAU,CAAC,IAAY;QACnB,UAAU,CAAC,YAAY,CAAC,CAAC;QACzB,WAAW,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;KAC3B;IAED,aAAa;QACT,MAAM,WAAW,GAAG,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAC9C,OAAO,WAAW,GAAG,EAAE,CAAC,EAAE,WAAW,CAAC,CAAC,EAAE,CAAC,EAAE,WAAW,CAAC,CAAC,EAAE,GAAG,IAAI,CAAC;KACtE;IACD,aAAa,CAAC,CAAS,EAAE,CAAS;QAC9B,MAAM,WAAW,GAAG,eAAe,CAAC,IAAI,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QAC7D,IAAI,WAAW,GAAG,CAAC;YAAE,OAAO,KAAK,CAAC;QAClC,MAAM,gBAAgB,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC;QAC7C,IAAI,CAAC,KAAK,CAAC,QAAQ,GAAG,WAAW,CAAC;QAClC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,MAAM,EAAE,gBAAgB,CAAC,CAAC;QAC9C,aAAa,CAAC,IAAI,CAAC,CAAC;QACpB,OAAO,IAAI,CAAC;KACf;IAED,OAAO;QACH,OAAO,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC;KACrC;IACD,OAAO;QACH,OAAO,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC;KACrC;IACD,YAAY;QACR,IAAI,CAAC,WAAW,CAAC,GAAG,EAAE,CAAC;KAC1B;IACD,QAAQ;QACJ,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC;YACtB,GAAG,IAAI,CAAC,OAAO;YACf,oBAAoB,EAAE,CAAC,EAAE,EAAE,MAAM;gBAC7B,qBAAqB,CAAC,IAAI,CAAC,CAAC;gBAC5B,IAAI,CAAC,OAAO,CAAC,oBAAoB,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC;aACjD;SACJ,CAAC,CAAC;KACN;IACD,mBAAmB;QACf,IAAI,CAAC,WAAW,CAAC,mBAAmB,CAAC;YACjC,GAAG,IAAI,CAAC,OAAO;YACf,oBAAoB,EAAE,CAAC,EAAE,EAAE,MAAM;gBAC7B,qBAAqB,CAAC,IAAI,CAAC,CAAC;gBAC5B,IAAI,CAAC,OAAO,CAAC,oBAAoB,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC;aACjD;SACJ,CAAC,CAAC;KACN;IACD,aAAa;QACT,OAAO,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC;KAClC;IACD,mBAAmB,CAAC,CAAa;QAC7B,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC,EAAE;YACxB,GAAG,IAAI,CAAC,OAAO;YACf,2BAA2B,EAAE,IAAI;SACpC,CAAC,CAAC;KACN;IACD,IAAI;QACA,OAAO,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC;YACzB,GAAG,IAAI,CAAC,OAAO;YACf,oBAAoB,EAAE,CAAC,EAAE,EAAE,MAAM;gBAC7B,qBAAqB,CAAC,IAAI,CAAC,CAAC;gBAC5B,IAAI,CAAC,OAAO,CAAC,oBAAoB,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC;aACjD;SACJ,CAAC,CAAC;KACN;IACD,IAAI;QACA,OAAO,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC;YACzB,GAAG,IAAI,CAAC,OAAO;YACf,oBAAoB,EAAE,CAAC,EAAE,EAAE,MAAM;gBAC7B,qBAAqB,CAAC,IAAI,CAAC,CAAC;gBAC5B,IAAI,CAAC,OAAO,CAAC,oBAAoB,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC;aACjD;SACJ,CAAC,CAAC;KACN;CACJ;AAED,SAAS,UAAU,CAAC,MAAc;IAC9B,OAAO,CAAC,IAAI,CAAC,WAAW,MAAM,iBAAiB,CAAC,CAAC;AACrD;;ACvsCA;AAwDA,SAAS,aAAa,CAAC,SAAS,EAAE,IAAI,EAAE,UAAU;;;IAG9C,IAAI,KAAK,GAAG,UAAU,CAAC;IACvB,IAAI,UAAU,GAAG,CAAC,CAAC;IAEnB,MAAM,WAAW,GAAG,SAAS,CAAC,MAAM,CAAC;IAErC,OAAO,KAAK,GAAG,IAAI,CAAC,MAAM,EAAE;QACxB,MAAM,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC;QAE9B,IACI,UAAU,IAAI,CAAC;YACf,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,KAAK,GAAG,WAAW,CAAC,KAAK,SAAS,EACtD;YACE,OAAO,KAAK,CAAC;SAChB;aAAM,IAAI,SAAS,KAAK,IAAI,EAAE;YAC3B,KAAK,EAAE,CAAC;SACX;aAAM,IAAI,SAAS,KAAK,GAAG,EAAE;YAC1B,UAAU,EAAE,CAAC;SAChB;aAAM,IAAI,SAAS,KAAK,GAAG,EAAE;YAC1B,UAAU,EAAE,CAAC;SAChB;QAED,KAAK,EAAE,CAAC;KACX;IAED,OAAO,CAAC,CAAC,CAAC;AACd,CAAC;AAED,SAAS,iBAAiB,CACtB,SAAS,EACT,SAAS,EACT,UAAU,EACV,SAAS;IAOT,MAAM,SAAS,GAAG,EAAE,CAAC;IAErB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;QACvC,IAAI,SAAS,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,MAAM,EAAE;YAC9B,MAAM,IAAI,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;YAE/B,IAAI,cAAc,GAAG,IAAI,CAAC;YAC1B,IAAI,SAAS,GAAG,CAAC,CAAC;YAClB,IAAI,SAAS,CAAC;YAEd,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;YACpC,IAAI,SAAS,KAAK,CAAC,CAAC,EAAE;gBAClB,SAAS,GAAG,SAAS,CAAC;gBACtB,IAAI,SAAS,GAAG,CAAC,EAAE;oBACf,SAAS,CAAC,IAAI,CAAC;wBACX,IAAI,EAAE,MAAM;wBACZ,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,SAAS,CAAC;qBACjC,CAAC,CAAC;iBACN;gBACD,cAAc,GAAG,KAAK,CAAC;aAC1B;YACD,IAAI,IAAI,GAAG,KAAK,CAAC;YACjB,OAAO,CAAC,IAAI,EAAE;gBACV,IAAI,cAAc,EAAE;oBAChB,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;oBAC/C,IAAI,SAAS,KAAK,CAAC,CAAC,EAAE;wBAClB,IAAI,GAAG,IAAI,CAAC;wBACZ,MAAM;qBACT;oBACD,IAAI,SAAS,KAAK,SAAS,EAAE;wBACzB,SAAS,CAAC,IAAI,CAAC;4BACX,IAAI,EAAE,MAAM;4BACZ,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,SAAS,EAAE,SAAS,CAAC;yBACzC,CAAC,CAAC;qBACN;oBAED,SAAS,GAAG,SAAS,CAAC;iBACzB;qBAAM;oBACH,SAAS,GAAG,aAAa,CACrB,UAAU,EACV,IAAI,EACJ,SAAS,GAAG,SAAS,CAAC,MAAM,CAC/B,CAAC;oBACF,IAAI,SAAS,KAAK,CAAC,CAAC,EAAE;wBAClB,IAAI,GAAG,IAAI,CAAC;wBACZ,MAAM;qBACT;oBAED,SAAS,CAAC,IAAI,CAAC;wBACX,IAAI,EAAE,MAAM;wBACZ,IAAI,EAAE,IAAI,CAAC,KAAK,CACZ,SAAS,GAAG,SAAS,CAAC,MAAM,EAC5B,SAAS,CACZ;wBACD,OAAO,EAAE,IAAI,CAAC,KAAK,CACf,SAAS,EACT,SAAS,GAAG,UAAU,CAAC,MAAM,CAChC;wBACD,SAAS,EAAE,SAAS;qBACvB,CAAC,CAAC;oBAEH,SAAS,GAAG,SAAS,GAAG,UAAU,CAAC,MAAM,CAAC;iBAC7C;gBAED,cAAc,GAAG,CAAC,cAAc,CAAC;aACpC;YACD,IAAI,SAAS,GAAG,IAAI,CAAC,MAAM,EAAE;gBACzB,SAAS,CAAC,IAAI,CAAC;oBACX,IAAI,EAAE,MAAM;oBACZ,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC;iBAC9B,CAAC,CAAC;aACN;SACJ;aAAM;YACH,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;SAChC;KACJ;IAED,OAAO,SAAS,CAAC;AACrB,CAAC;AAED,SAAS,mBAAmB,CACxB,IAAY,EACZ,UAAU;IAOV,IAAI,IAAI,GAAG,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC;IAC1C,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;QAC/C,MAAM,SAAS,GAAG,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;QACvC,IAAI,GAAG,iBAAiB,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC,CAAC,EAAE,SAAS,CAAC,CAAC,CAAC,EAAE,WAAW,CAAC,CAAC;KAC3E;IACD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;QAChD,MAAM,SAAS,GAAG,UAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;QACxC,IAAI,GAAG,iBAAiB,CACpB,IAAI,EACJ,SAAS,CAAC,CAAC,CAAC,EACZ,SAAS,CAAC,CAAC,CAAC,EACZ,cAAc,CACjB,CAAC;KACL;IAED,OAAO,IAAI,CAAC;AAChB,CAAC;AAED,SAAS,gBAAgB,CACrB,KAAa,EACb,OAAiC;;;IAIjC,MAAM,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;IAC5C,IAAI;QACA,MAAM,IAAI,GACN,mDAAmD;YACnD,OAAO,CAAC,cAAc,CAAC,KAAK,EAAE,OAAO,CAAC;YACtC,SAAS,CAAC;QACd,IAAI,CAAC,SAAS,GAAG,OAAO,CAAC,UAAU,GAAG,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC;KACzE;IAAC,OAAO,CAAC,EAAE;QACR,OAAO,CAAC,KAAK,CAAC,oBAAoB,GAAG,KAAK,GAAG,mBAAmB,EAAE,CAAC,CAAC,CAAC;QACrE,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;KAC5B;IACD,IAAI,CAAC,SAAS,GAAG,aAAa,CAAC;IAC/B,OAAO,IAAI,CAAC;AAChB,CAAC;AAED,SAAS,gBAAgB,CACrB,IAAY,EACZ,OAAiC,EACjC,SAAuC,EACvC,mBAA4B;;;;;;IAO5B,IAAI,IAAI,GAA2B,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;IAClE,IAAI,CAAC,YAAY,CAAC,aAAa,EAAE,MAAM,CAAC,CAAC;IACzC,IAAI,OAAO,CAAC,uBAAuB,EAAE;QACjC,IAAI,CAAC,YAAY,CACb,OAAO,GAAG,OAAO,CAAC,SAAS,GAAG,kBAAkB,EAChD,IAAI,CACP,CAAC;QACF,IAAI,SAAS,EAAE;YACX,IAAI,CAAC,YAAY,CACb,OAAO,GAAG,OAAO,CAAC,SAAS,GAAG,oBAAoB,EAClD,SAAS,CACZ,CAAC;SACL;KACJ;IAED,IAAI;QACA,SAAS,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC;QAClCS,MAAgB,CAAC,IAAI,EAAEE,UAAc,CAAC,CAAC;QACvC,MAAM,IAAI,GAAG,OAAO,CAAC,cAAc,CAAC,IAAI,EAAE;YACtC,SAAS,EAAE,SAAS,aAAT,SAAS,cAAT,SAAS,GAAI,cAAc;YACtC,MAAM,EAAE,MAAM;YACd,MAAM,EAAE,OAAO,CAAC,MAAM;SACzB,CAAC,CAAC;QACH,IAAI,CAAC,SAAS,GAAG,OAAO,CAAC,UAAU,GAAG,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC;KACzE;IAAC,OAAO,CAAC,EAAE;QACR,OAAO,CAAC,KAAK,CAAC,kBAAkB,GAAG,IAAI,GAAG,SAAS,EAAE,CAAC,CAAC,CAAC;QACxD,IAAI,mBAAmB,EAAE;YACrB,IAAI,GAAG,QAAQ,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;SACxC;aAAM;YACH,OAAO,IAAI,CAAC;SACf;KACJ;IACD,OAAO,IAAI,CAAC;AAChB,CAAC;AAED,SAAS,0BAA0B,CAC/B,IAAY,EACZ,SAAgD,EAChD,OAAiC,EACjC,mBAA4B;;;;IAK5B,MAAM,UAAU,GAAG,gBAAgB,CAC/B,IAAI,EACJ,OAAO,EACP,SAAyC,EACzC,mBAAmB,CACtB,CAAC;IAEF,IACI,UAAU;QACV,8BAA8B,CAAC,IAAI,CAAC,OAAO,CAAC,uBAAuB,CAAC,EACtE;QACE,MAAM,QAAQ,GAAG,QAAQ,CAAC,sBAAsB,EAAE,CAAC;QACnD,IACI,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,uBAAuB,CAAC;YACnD,OAAO,CAAC,cAAc,EACxB;YACE,QAAQ,CAAC,WAAW,CAAC,gBAAgB,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC,CAAC;SACzD;QACD,IACI,qBAAqB,CAAC,IAAI,CAAC,OAAO,CAAC,uBAAuB,CAAC;YAC3D,OAAO,CAAC,qBAAqB,EAC/B;YACE,MAAM,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;YAC5C,MAAM,IAAI,GAAG,OAAO,CAAC,qBAAqB,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;YAC1D,IAAI,CAAC,SAAS,GAAG,OAAO,CAAC,UAAU;kBAC7B,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC;kBACxB,IAAI,CAAC;YACX,IAAI,CAAC,SAAS,GAAG,aAAa,CAAC;YAC/B,QAAQ,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;SAC9B;QACD,QAAQ,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;QACjC,OAAO,QAAQ,CAAC;KACnB;IAED,OAAO,UAAU,CAAC;AACtB,CAAC;AAED,SAASO,UAAQ,CAAC,IAAY,EAAE,OAAiC;;;IAG7D,IAAI,QAAQ,GAAS,IAAI,CAAC;IAC1B,IAAI,OAAO,CAAC,GAAG,CAAC,mBAAmB,IAAI,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;QAC7D,QAAQ,GAAG,QAAQ,CAAC,sBAAsB,EAAE,CAAC;QAC7C,QAAQ,CAAC,WAAW,CAChB,0BAA0B,CAAC,IAAI,EAAE,SAAS,EAAE,OAAO,EAAE,IAAI,CAAC,CAC7D,CAAC;KACL;SAAM;QACH,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE;YAAE,OAAO,IAAI,CAAC;QAC9B,MAAM,IAAI,GAAG,mBAAmB,CAAC,IAAI,EAAE,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;QAC/D,IAAI,IAAI,CAAC,MAAM,KAAK,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,MAAM,EAAE;;YAE9C,OAAO,IAAI,CAAC;SACf;QACD,QAAQ,GAAG,QAAQ,CAAC,sBAAsB,EAAE,CAAC;QAE7C,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YAClC,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,MAAM,EAAE;gBACzB,QAAQ,CAAC,WAAW,CAAC,QAAQ,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;aAC/D;iBAAM;gBACH,QAAQ,CAAC,WAAW,CAChB,0BAA0B,CACtB,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,EACZ,IAAI,CAAC,CAAC,CAAC,CAAC,SAAS,EACjB,OAAO,EACP,IAAI,CACP,CACJ,CAAC;aACL;SACJ;KACJ;IACD,OAAO,QAAQ,CAAC;AACpB,CAAC;AAED,SAAS,WAAW,CAAC,IAAI,EAAE,OAAiC;IACxD,MAAM,eAAe,GAAG,IAAI,CAAC,YAAY,CACrC,OAAO,GAAG,OAAO,CAAC,SAAS,GAAG,kBAAkB,CACnD,CAAC;IACF,IAAI,eAAe,EAAE;QACjB,MAAM,SAAS,GAAG,IAAI,CAAC,YAAY,CAC/B,OAAO,GAAG,OAAO,CAAC,SAAS,GAAG,WAAW,CAC5C,CAAC;QACF,MAAM,IAAI,GAAG,0BAA0B,CACnC,eAAe,EACf,SAAS,EACT,OAAO,EACP,KAAK,CACR,CAAC;QACF,IAAI,IAAI,IAAI,IAAI,EAAE;YACd,IAAI,CAAC,WAAW,GAAG,EAAE,CAAC;YACtB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;SAC1B;QACD,OAAO;KACV;IAED,IAAI,IAAI,CAAC,UAAU,CAAC,MAAM,KAAK,CAAC,IAAI,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,QAAQ,KAAK,CAAC,EAAE;;;QAGnE,MAAM,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC;QAC5C,IAAI,OAAO,CAAC,GAAG,CAAC,mBAAmB,IAAI,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;YAC7D,IAAI,CAAC,WAAW,GAAG,EAAE,CAAC;YACtB,IAAI,CAAC,WAAW,CACZ,0BAA0B,CAAC,IAAI,EAAE,SAAS,EAAE,OAAO,EAAE,IAAI,CAAC,CAC7D,CAAC;YACF,OAAO;SACV;QAED,MAAM,IAAI,GAAG,mBAAmB,CAAC,IAAI,EAAE,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;QAC/D,IAAI,IAAI,CAAC,MAAM,KAAK,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,MAAM,EAAE;;;YAG9C,IAAI,CAAC,WAAW,GAAG,EAAE,CAAC;YACtB,IAAI,CAAC,WAAW,CACZ,0BAA0B,CACtB,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,EACZ,IAAI,CAAC,CAAC,CAAC,CAAC,SAAS,EACjB,OAAO,EACP,IAAI,CACP,CACJ,CAAC;YACF,OAAO;SACV;aAAM,IAAI,IAAI,CAAC,MAAM,KAAK,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,MAAM,EAAE;;;YAGrD,OAAO;SACV;KACJ;IAED,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,UAAU,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;QAC7C,MAAM,SAAS,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;QACrC,IAAI,SAAS,CAAC,QAAQ,KAAK,CAAC,EAAE;;;YAG1B,MAAM,IAAI,GAAGA,UAAQ,CAAC,SAAS,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC;YACtD,IAAI,IAAI,EAAE;gBACN,CAAC,IAAI,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,CAAC,CAAC;gBAChC,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;aACtC;SACJ;aAAM,IAAI,SAAS,CAAC,QAAQ,KAAK,CAAC,EAAE;;YAEjC,MAAM,GAAG,GAAG,SAAS,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC;YAC7C,IACI,GAAG,KAAK,QAAQ;gBAChB,OAAO,CAAC,wBAAwB,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,EACvD;gBACE,IAAI,KAAK,GAAG,cAAc,CAAC;gBAC3B,KAAK,MAAM,CAAC,IAAI,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,EAAE;oBACvC,MAAM,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;oBACvB,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,KAAK,MAAM,EAAE;wBAC/B,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,UAAU,EAAE,KAAK,SAAS,EAAE;4BACjC,KAAK,GAAG,cAAc,CAAC;yBAC1B;6BAAM;4BACH,KAAK,GAAG,WAAW,CAAC;yBACvB;qBACJ;iBACJ;gBAED,MAAM,IAAI,GAAG,0BAA0B,CACnC,SAAS,CAAC,WAAW,EACrB,KAAK,EACL,OAAO,EACP,IAAI,CACP,CAAC;gBACF,SAAS,CAAC,UAAU,CAAC,YAAY,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;aACtD;iBAAM,IAAI,GAAG,KAAK,QAAQ,EAAE;;;gBAGzB,MAAM,YAAY,GACd,OAAO,CAAC,mBAAmB,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC;oBACrD,EACI,OAAO,CAAC,QAAQ,CAAC,QAAQ,CAAC,GAAG,CAAC;wBAC9B,OAAO,CAAC,kBAAkB,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,CACvD,CAAC;gBAEN,IAAI,YAAY,EAAE;oBACd,IACI,IAAI,CAAC,UAAU,CAAC,MAAM,KAAK,CAAC;wBAC5B,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,QAAQ,KAAK,CAAC,EACnC;wBACE,MAAM,OAAO,GAAG,IAAI,CAAC,WAAW,CAAC;wBACjC,IAAI,CAAC,WAAW,GAAG,EAAE,CAAC;wBACtB,IAAI,CAAC,WAAW,CACZ,0BAA0B,CACtB,OAAO,EACP,cAAc,EACd,OAAO,EACP,IAAI,CACP,CACJ,CAAC;qBACL;yBAAM;wBACH,WAAW,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;qBACnC;iBACJ;aACJ;SACJ;;KAEJ;AACL,CAAC;AAED,MAAM,cAAc,GAAsB;;IAEtC,SAAS,EAAE,EAAE;;IAGb,QAAQ,EAAE;QACN,UAAU;QACV,OAAO;QACP,UAAU;QACV,KAAK;QACL,MAAM;QACN,YAAY;QACZ,gBAAgB;KACnB;;IAGD,iBAAiB,EAAE,UAAU;;;IAI7B,WAAW,EAAE,gBAAgB;;;IAI7B,YAAY,EAAE,iBAAiB;;;IAI/B,uBAAuB,EAAE,IAAI;;IAG7B,uBAAuB,EAAE,QAAQ;IAEjC,GAAG,EAAE;QACD,mBAAmB,EAAE,IAAI;QACzB,UAAU,EAAE;YACR,MAAM,EAAE,CAAC,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;YACxB,OAAO,EAAE;gBACL,CAAC,IAAI,EAAE,IAAI,CAAC;gBACZ,CAAC,KAAK,EAAE,KAAK,CAAC;aACjB;SACJ;KACJ;CACJ,CAAC;AAEF,SAAS,mBAAmB,CACxB,IAA0B,EAC1B,OAAiC;IAEjC,IAAI;QACA,OAAO,GAAG,EAAE,GAAG,cAAc,EAAE,GAAG,OAAO,EAAE,CAAC;QAC5C,OAAO,CAAC,kBAAkB,GAAG,IAAI,MAAM,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;QAC7D,OAAO,CAAC,mBAAmB,GAAG,IAAI,MAAM,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC;QAC/D,OAAO,CAAC,wBAAwB,GAAG,IAAI,MAAM,CACzC,OAAO,CAAC,iBAAiB,CAC5B,CAAC;QACF,OAAO,CAAC,MAAM,GAAG,MAAM,CAAC;;QAGxB,IAAI,OAAO,CAAC,SAAS,EAAE;YACnB,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,EAAE;gBACzC,MAAM,KAAK,CACP,iEAAiE,CACpE,CAAC;aACL;YACD,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,EAAE;gBAC/B,OAAO,CAAC,SAAS,IAAI,GAAG,CAAC;aAC5B;SACJ;QAED,WAAW,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;KAC9B;IAAC,OAAO,CAAC,EAAE;QACR,IAAI,CAAC,YAAY,KAAK,EAAE;YACpB,OAAO,CAAC,KAAK,CAAC,yBAAyB,GAAG,CAAC,CAAC,OAAO,CAAC,CAAC;SACxD;aAAM;YACH,OAAO,CAAC,KAAK,CACT,2DAA2D;gBACvD,IAAI,CACX,CAAC;SACL;KACJ;AACL,CAAC;AAED,iBAAe;IACX,mBAAmB;CACtB;;ACnjBD;;;;;SAuBgB,gBAAgB,CAC5B,KAAa,EACb,OAAkB,MAAM;IAExB,MAAM,QAAQ,GAAG,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;IAEtD,OAAO,eAAe,CAAC,QAAQ,CAAC,CAAC;AACrC,CAAC;SAEe,gBAAgB,CAAC,KAAa;IAC1C,MAAM,GAAG,MAAM,CAAC,GAAG,eAAe,CAAC,KAAK,EAAE,EAAE,MAAM,EAAE,WAAW,EAAE,CAAC,CAAC;IACnE,OAAO,MAAM,CAAC;AAClB,CAAC;AAED;;;;;;;AAOA,SAAS,SAAS,CAAC,KAAa,EAAE,MAAkC;IAChE,IAAI,CAAC,KAAK;QAAE,OAAO,IAAI,CAAC;IACxB,IAAI,WAAW,GAAG,IAAI,CAAC;IAEvB,IAAI,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE;QACvB,WAAW,GAAG,MAAM,CAAC,KAAK,EAAE,CAAC;QAC7B,MAAM,GAAG,WAAW,CAAC,KAAK,EAAE,CAAC;KAChC;IAED,IAAI,MAAM,GAAG,IAAI,CAAC;IAClB,IAAI,OAAO,MAAM,KAAK,QAAQ,IAAI,MAAM,GAAG,KAAK,CAAC,MAAM,EAAE;QACrD,IAAI,WAAW,IAAI,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE;YACvC,OAAO,SAAS,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,QAAQ,EAAE,WAAW,CAAC,CAAC;SACzD;QACD,OAAO,KAAK,CAAC,MAAM,CAAC,CAAC;KACxB;SAAM,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;QACnC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;;YAEnC,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,KAAK,MAAM,EAAE;gBAC3B,IAAI,WAAW,IAAI,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE;oBACvC,OAAO,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE,WAAW,CAAC,CAAC;iBACpD;gBACD,OAAO,KAAK,CAAC,CAAC,CAAC,CAAC;aACnB;;YAED,MAAM,GAAG,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;YAC9C,IAAI,MAAM;gBAAE,OAAO,MAAM,CAAC;SAC7B;QACD,OAAO,MAAM,CAAC;KACjB;IACD,OAAO,IAAI,CAAC;AAChB,CAAC;AAED,SAAS,OAAO,CACZ,KAAa,EACb,MAAkC,EAClC,IAAY;IAEZ,MAAM,CAAC,GAAG,SAAS,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;IACnC,IAAI,CAAC;QAAE,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC;IACtB,OAAO,IAAI,CAAC;AAChB,CAAC;AAED;;;AAGA,SAAS,OAAO,CAAC,KAAa,EAAE,MAAc;IAC1C,MAAM,CAAC,GAAG,SAAS,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;IACnC,IAAI,CAAC;QAAE,OAAO,CAAC,CAAC,IAAI,CAAC;IACrB,OAAO,IAAI,CAAC;AAChB,CAAC;AAED,SAAS,QAAQ,CAAC,KAAa,EAAE,MAAc,EAAE,IAAY;IACzD,MAAM,CAAC,GAAG,SAAS,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;IACnC,IAAI,CAAC,aAAD,CAAC,uBAAD,CAAC,CAAE,KAAK;QAAE,OAAO,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;IACnC,OAAO,IAAI,CAAC;AAChB,CAAC;AAED,SAAS,UAAU,CAAC,KAAa,EAAE,MAAc;;IAC7C,MAAM,CAAC,GAAG,SAAS,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;IACnC,IAAI,CAAC;QAAE,aAAO,CAAC,CAAC,OAAO,mCAAI,EAAE,CAAC;IAC9B,OAAO,IAAI,CAAC;AAChB,CAAC;AAED,SAAS,QAAQ,CAAC,KAAa,EAAE,MAAc,EAAE,GAAW;IACxD,MAAM,OAAO,GAAG,UAAU,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;IAC1C,IAAI,CAAC,OAAO;QAAE,OAAO,KAAK,CAAC;IAC3B,MAAM,OAAO,GAAG,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IACnC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;QACrC,IAAI,OAAO,CAAC,CAAC,CAAC,KAAK,GAAG;YAAE,OAAO,IAAI,CAAC;KACvC;IACD,OAAO,KAAK,CAAC;AACjB,CAAC;AAED;AACA;AACA;AAEA,SAAS,YAAY,CAAC,IAAU,EAAE,MAAM,GAAG,EAAE;IACzC,IAAI,MAAM,GAAG,EAAE,CAAC;IAChB,IAAI,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;QACrB,IAAI,IAAI,CAAC,MAAM,KAAK,CAAC,EAAE;YACnB,MAAM,IAAI,MAAM,CAAC;SACpB;aAAM;YACH,MAAM,IAAI,KAAK,CAAC;YAChB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBAClC,MAAM,IAAI,YAAY,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,IAAI,GAAG,MAAM,GAAG,CAAC,GAAG,GAAG,CAAC,CAAC;gBACzD,MAAM,IAAI,CAAC,GAAG,IAAI,CAAC,MAAM,GAAG,CAAC,GAAG,KAAK,GAAG,IAAI,CAAC;aAChD;YACD,MAAM,IAAI,MAAM,GAAG,KAAK,CAAC;SAC5B;KACJ;SAAM;QACH,MAAM,GAAG,MAAM,GAAG,KAAK,CAAC;QACxB,IAAI,IAAI,CAAC,IAAI,EAAE;YACX,MAAM,IAAI,MAAM,GAAG,QAAQ,GAAG,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC;SACpD;QACD,IAAI,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;YACrC,MAAM,IAAI,MAAM,GAAG,QAAQ,GAAG,IAAI,CAAC,KAAK,GAAG,MAAM,CAAC;SACrD;QACD,IAAI,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;YACzC,MAAM,IAAI,MAAM,GAAG,WAAW,GAAG,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;SAC1D;QACD,IAAI,IAAI,CAAC,KAAK,EAAE;YACZ,KAAK,MAAM,CAAC,IAAI,IAAI,CAAC,KAAK,EAAE;gBACxB,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC,CAAC,EAAE;oBACrD,MAAM,IAAI,MAAM,GAAG,CAAC,GAAG,IAAI,CAAC;oBAC5B,MAAM,IAAI,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC;iBACpC;aACJ;SACJ;QACD,IAAI,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;YAC3C,MAAM;gBACF,MAAM;oBACN,WAAW;oBACX,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC,KAAK,YAAY,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SACpE;QACD,MAAM,IAAI,MAAM,GAAG,GAAG,CAAC;KAC1B;IACD,OAAO,MAAM,CAAC;AAClB,CAAC;AAED;AACA;AACA;AAEA,SAAS,YAAY,CAAC,IAAU,EAAE,MAAM,GAAG,EAAE;;;;IAIzC,IAAI,MAAM,GAAG,EAAE,CAAC;IAChB,IAAI,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;QACrB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YAClC,MAAM,IAAI,YAAY,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC;SAC3C;KACJ;SAAM,IAAI,IAAI,EAAE;QACb,MAAM,GAAG,MAAM,GAAG,MAAM,CAAC;QACzB,IAAI,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,kBAAkB,CAAC,EAAE;YAC3C,MAAM,IAAI,kBAAkB,CAAC;SAChC;aAAM;YACH,IAAI,IAAI,CAAC,IAAI,EAAE;gBACX,MAAM,IAAI,qBAAqB,GAAG,IAAI,CAAC,IAAI,GAAG,SAAS,CAAC;aAC3D;YACD,IAAI,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;gBACrC,MAAM,IAAI,sBAAsB,GAAG,IAAI,CAAC,KAAK,GAAG,SAAS,CAAC;aAC7D;YACD,IAAI,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;gBACzC,MAAM;oBACF,8BAA8B,GAAG,IAAI,CAAC,OAAO,GAAG,SAAS,CAAC;aACjE;YACD,IAAI,IAAI,CAAC,OAAO,EAAE;gBACd,MAAM,IAAI,+CAA+C,CAAC;aAC7D;YACD,IAAI,IAAI,CAAC,KAAK,EAAE;gBACZ,MAAM,IAAI,+CAA+C,CAAC;aAC7D;YAED,IAAI,IAAI,CAAC,KAAK,EAAE;gBACZ,KAAK,MAAM,CAAC,IAAI,IAAI,CAAC,KAAK,EAAE;oBACxB,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC,CAAC,EAAE;wBACrD,MAAM;4BACF,gCAAgC,GAAG,CAAC,GAAG,UAAU,CAAC;wBACtD,MAAM;4BACF,4BAA4B;gCAC5B,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC;gCACb,gBAAgB,CAAC;qBACxB;iBACJ;aACJ;YACD,IAAI,IAAI,CAAC,QAAQ,EAAE;gBACf,MAAM,IAAI,IAAI,CAAC,QAAQ;qBAClB,GAAG,CAAC,CAAC,CAAC,KAAK,YAAY,CAAC,CAAC,EAAE,MAAM,GAAG,GAAG,CAAC,CAAC;qBACzC,IAAI,CAAC,IAAI,CAAC,CAAC;aACnB;SACJ;KACJ;IACD,OAAO,MAAM,CAAC;AAClB,CAAC;AAED;AACA,oBAAe;IACX,YAAY;IAEZ,YAAY;IAEZ,QAAQ;IACR,UAAU;IACV,OAAO;IACP,QAAQ;IACR,OAAO;IAEP,gBAAgB;IAChB,gBAAgB;IAChB,SAAS;IACT,YAAY;IACZ,YAAY;IACZ,YAAY;IACZ,MAAM;IAEN,gBAAgB;IAChB,mBAAmB;IAEnB,mBAAmB;CACtB;;ACnPD,SAAS,eAAe,CAAC,OAAgB;IACrC,OAAO,CAAC,SAAS,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;IAC1C,IAAI,OAAO,CAAC,QAAQ,EAAE;QAClB,KAAK,MAAM,KAAK,IAAI,OAAO,CAAC,QAAQ,EAAE;YAClC,eAAe,CAAC,KAAK,CAAC,CAAC;SAC1B;KACJ;AACL,CAAC;AAED;;;;;;;;;AASA,SAAS,eAAe,CAAC,OAAgB,EAAE,MAAe;;IACtD,IAAI,CAAC,MAAM,IAAI,OAAA,OAAO,CAAC,SAAS,CAAC,0CAAE,MAAM,MAAK,MAAM,EAAE;QAClD,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC;QACvC,IAAI,OAAO,CAAC,QAAQ,IAAI,OAAO,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;YACjD,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;gBACnC,eAAe,CAAC,CAAC,CAAC,CAAC;aACtB,CAAC,CAAC;SACN;KACJ;SAAM;QACH,OAAO,CAAC,SAAS,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;QAC1C,IAAI,OAAO,CAAC,QAAQ,IAAI,OAAO,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;YACjD,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;gBACnC,eAAe,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC;aAC9B,CAAC,CAAC;SACN;KACJ;AACL,CAAC;AAED;;;;;;;SAOgB,oBAAoB,CAChC,OAAoB,EACpB,IAAY,EACZ,MAAiC;;IAEjC,IAAI,CAAC,MAAM,EAAE;QACT,OAAO;KACV;IACD,IAAI,CAAC,MAAM,IAAI,MAAM,CAAC,UAAU,CAAC,EAAE;QAC/B,MAAM,GAAG,MAAM,CAAC,UAAU,CAAC,CAAC,MAAM,CAAC;KACtC;IAED,IAAI,MAAM,CAAC,YAAY,KAAK,QAAQ,EAAE;QAClC,OAAO,CAAC,IAAI,CAAC,qDAAqD,CAAC,CAAC;QACpE,IAAI,MAAM,CAAC,SAAS;YAAE,MAAM,CAAC,SAAS,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;QACrD,OAAO;KACV;IACD,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,EAAE;QAChB,OAAO,CAAC,IAAI,CACR,+DAA+D,CAClE,CAAC;QACF,OAAO;KACV;IACD,MAAM,KAAK,GAAG,IAAI,MAAM,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,EAAE,UAAU,EAAE,YAAY,EAAE,CAAC,CAAC;IAEpE,MAAM,MAAM,GAAG;QACX,YAAY,EAAE,MAAM;QACpB,OAAO,EAAE,MAAM,CAAC,iBAAiB,IAAI,QAAQ;QAC7C,MAAM,EAAE,UAAU;QAClB,IAAI,EAAE,IAAI;QACV,QAAQ,EAAE,MAAM;QAChB,eAAe,EAAE,CAAC,MAAM,CAAC;KAC5B,CAAC;IAEF,MAAM,CAAC,UAAU,CAAC,SAAG,MAAM,CAAC,UAAU,CAAC,mCAAI,EAAE,CAAC;IAC9C,MAAM,CAAC,UAAU,CAAC,CAAC,gBAAgB,GAAG,OAAO,CAAC;IAE9C,MAAM,UAAU,GACZ,MAAM,CAAC,iBAAiB,IAAI,MAAM,CAAC,UAAU,CAAC,CAAC,iBAAiB,CAAC;;IAGrE,KAAK,CAAC,gBAAgB,CAAC,MAAM,EAAE,CAAC,GAAG,EAAE,IAAI;QACrC,IAAI,GAAG,EAAE;YACL,OAAO,CAAC,IAAI,CAAC,iCAAiC,EAAE,GAAG,EAAE,GAAG,CAAC,KAAK,CAAC,CAAC;YAChE,OAAO;SACV;QACD,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;YAC5B,OAAO,CAAC,GAAG,CAAC,2BAA2B,GAAG,IAAI,CAAC,CAAC;YAChD,OAAO;SACV;QACD,MAAM,QAAQ,GAAG,IAAI,WAAW,CAAC,OAAO,CAAC,CAAC,MAAM,CAC5C,IAAI,UAAU,CAAC,IAAI,CAAC,WAAW,CAAC,CACnC,CAAC;QACF,MAAM,CAAC,UAAU,CAAC,CAAC,cAAc,GAAG,QAAQ;aACvC,KAAK,CAAC,IAAI,CAAC;aACX,GAAG,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;QAC1C,MAAM,CAAC,UAAU,CAAC,CAAC,eAAe,GAAG,EAAE,CAAC;QACxC,KAAK,MAAM,IAAI,IAAI,MAAM,CAAC,UAAU,CAAC,CAAC,cAAc,EAAE;YAClD,IAAI,IAAI,CAAC,KAAK,EAAE;gBACZ,MAAM,CAAC,UAAU,CAAC,CAAC,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;aACvD;SACJ;QACD,MAAM,CAAC,UAAU,CAAC,CAAC,oBAAoB,GAAG,EAAE,CAAC;;QAG7C,MAAM,CAAC,YAAY,GAAG,KAAK,CAAC;QAC5B,MAAM,CAAC,eAAe,GAAG,EAAE,CAAC;QAC5B,KAAK,CAAC,gBAAgB,CAAC,MAAM,EAAE,UAAU,GAAG,EAAE,IAAI;YAC9C,IAAI,GAAG,EAAE;gBACL,OAAO,CAAC,IAAI,CACR,yBAAyB,EACzB,IAAI,EACJ,UAAU,EACV,GAAG,EACH,GAAG,CAAC,KAAK,CACZ,CAAC;gBACF,OAAO;aACV;YACD,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;gBAC5B,OAAO;aACV;YACD,MAAM,UAAU,GAAG,IAAI,UAAU,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;YACpD,MAAM,IAAI,GAAG,IAAI,IAAI,CAAC,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE;gBACvC,IAAI,EAAE,YAAY;aACrB,CAAC,CAAC;YACH,MAAM,GAAG,GAAG,GAAG,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;YAEtC,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC,cAAc,EAAE;gBACpC,MAAM,CAAC,UAAU,CAAC,CAAC,cAAc,GAAG,IAAI,KAAK,EAAE,CAAC;gBAChD,MAAM,CAAC,UAAU,CAAC,CAAC,cAAc,CAAC,gBAAgB,CAC9C,OAAO,EACP;oBACI,MAAM,SAAS,GAAG,MAAM,CAAC,UAAU,CAAC,CAAC,kBAAkB,CAAC;oBACxD,IAAI,UAAU,EAAE;wBACZ,UAAU,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;qBAClC;oBACD,IAAI,SAAS,EAAE;wBACX,MAAM,CAAC,SAAS,CAAC,CAAC;wBAClB,MAAM,CAAC,UAAU,CAAC,CAAC,gBAAgB,GAAG,IAAI,CAAC;wBAC3C,MAAM,CAAC,UAAU,CAAC,CAAC,kBAAkB,GAAG,IAAI,CAAC;wBAC7C,MAAM,CAAC,UAAU,CAAC,CAAC,eAAe,GAAG,EAAE,CAAC;wBACxC,MAAM,CAAC,UAAU,CAAC,CAAC,cAAc,GAAG,EAAE,CAAC;wBACvC,MAAM,CAAC,UAAU,CAAC,CAAC,oBAAoB,GAAG,EAAE,CAAC;qBAChD;yBAAM;wBACH,eAAe,CACX,MAAM,CAAC,UAAU,CAAC,CAAC,gBAAgB,CACtC,CAAC;qBACL;iBACJ,CACJ,CAAC;gBACF,MAAM,CAAC,UAAU,CAAC,CAAC,cAAc,CAAC,gBAAgB,CAC9C,YAAY,EACZ;oBACI,IAAI,KAAK,GAAG,EAAE,CAAC;;;;oBAIf,MAAM,MAAM,GACR,MAAM,CAAC,UAAU,CAAC,CAAC,cAAc,CAAC,WAAW;wBACzC,IAAI;wBACR,GAAG,CAAC;;oBAGR,KAAK,MAAM,IAAI,IAAI,MAAM,CAAC,UAAU,CAAC,CAAC,cAAc,EAAE;wBAClD,IAAI,IAAI,CAAC,IAAI,GAAG,MAAM,EAAE;4BACpB,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;yBACtB;qBACJ;oBACD,IAAI,MAAM,CAAC,UAAU,CAAC,CAAC,oBAAoB,KAAK,KAAK,EAAE;wBACnD,MAAM,CAAC,UAAU,CAAC,CAAC,qBAAqB,GAAG,KAAK,CAAC;wBACjD,IACI,KAAK;4BACL,KAAK,KAAK,MAAM,CAAC,UAAU,CAAC,CAAC,mBAAmB,EAClD;4BACE,MAAM,CAAC,UAAU,CAAC,CAAC,cAAc,CAAC,KAAK,EAAE,CAAC;yBAC7C;6BAAM;4BACH,MAAM,CAAC,UAAU,CAAC,CAAC,oBAAoB,GAAG,KAAK,CAAC;4BAChD,eAAe,CACX,MAAM,CAAC,UAAU,CAAC,CAAC,gBAAgB,EACnC,MAAM,CAAC,UAAU,CAAC,CAAC,oBAAoB,CAC1C,CAAC;yBACL;qBACJ;iBACJ,CACJ,CAAC;aACL;iBAAM;gBACH,MAAM,CAAC,UAAU,CAAC,CAAC,cAAc,CAAC,KAAK,EAAE,CAAC;aAC7C;YAED,MAAM,CAAC,UAAU,CAAC,CAAC,cAAc,CAAC,GAAG,GAAG,GAAG,CAAC;YAC5C,IAAI,UAAU,EAAE;gBACZ,UAAU,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC,kBAAkB,EAAE,SAAS,CAAC,CAAC;aAChE;YACD,MAAM,CAAC,UAAU,CAAC,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;SAC5C,CAAC,CAAC;KACN,CAAC,CAAC;AACP,CAAC;AAED;;;;;;;;;;;;;SAagB,eAAe;;IAK3B,IAAI,CAAC,MAAM;QAAE,OAAO,aAAa,CAAC;IAClC,MAAM,CAAC,UAAU,CAAC,SAAG,MAAM,CAAC,UAAU,CAAC,mCAAI,EAAE,CAAC;IAE9C,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC,cAAc;QAAE,OAAO,OAAO,CAAC;IACvD,IAAI,MAAM,CAAC,UAAU,CAAC,CAAC,cAAc,CAAC,MAAM;QAAE,OAAO,QAAQ,CAAC;IAC9D,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC,cAAc,CAAC,KAAK;QAAE,OAAO,SAAS,CAAC;IAE/D,OAAO,OAAO,CAAC;AACnB,CAAC;AAED;;;;;SAKgB,cAAc;;IAC1B,IAAI,CAAC,MAAM;QAAE,OAAO;IACpB,MAAM,CAAC,UAAU,CAAC,SAAG,MAAM,CAAC,UAAU,CAAC,mCAAI,EAAE,CAAC;IAC9C,IAAI,MAAM,CAAC,UAAU,CAAC,CAAC,cAAc,EAAE;QACnC,IAAI,MAAM,CAAC,UAAU,CAAC,CAAC,iBAAiB,EAAE;YACtC,MAAM,CAAC,UAAU,CAAC,CAAC,iBAAiB,CAChC,MAAM,CAAC,UAAU,CAAC,CAAC,kBAAkB,EACrC,QAAQ,CACX,CAAC;SACL;QACD,MAAM,CAAC,UAAU,CAAC,CAAC,cAAc,CAAC,KAAK,EAAE,CAAC;KAC7C;AACL,CAAC;AAED;;;;;SAKgB,eAAe;;IAC3B,IAAI,CAAC,MAAM;QAAE,OAAO;IACpB,MAAM,CAAC,UAAU,CAAC,SAAG,MAAM,CAAC,UAAU,CAAC,mCAAI,EAAE,CAAC;IAC9C,IAAI,MAAM,CAAC,UAAU,CAAC,CAAC,cAAc,EAAE;QACnC,IAAI,MAAM,CAAC,UAAU,CAAC,CAAC,iBAAiB,EAAE;YACtC,MAAM,CAAC,UAAU,CAAC,CAAC,iBAAiB,CAChC,MAAM,CAAC,UAAU,CAAC,CAAC,kBAAkB,EACrC,SAAS,CACZ,CAAC;SACL;QACD,MAAM,CAAC,UAAU,CAAC,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;KAC5C;AACL,CAAC;AAED;;;;;;;SAOgB,aAAa,CAAC,KAAa,EAAE,KAAa;;IACtD,IAAI,CAAC,MAAM;QAAE,OAAO;IACpB,MAAM,CAAC,UAAU,CAAC,SAAG,MAAM,CAAC,UAAU,CAAC,mCAAI,EAAE,CAAC;IAC9C,IAAI,MAAM,CAAC,UAAU,CAAC,CAAC,cAAc,EAAE;QACnC,IAAI,SAAS,GAAG,CAAC,CAAC;QAClB,MAAM,CAAC,UAAU,CAAC,CAAC,mBAAmB,GAAG,IAAI,CAAC;QAC9C,IAAI,KAAK,EAAE;YACP,MAAM,CAAC,UAAU,CAAC,CAAC,cAAc;gBAC7B,MAAM,CAAC,UAAU,CAAC,CAAC,cAAc,IAAI,EAAE,CAAC;YAC5C,KAAK,MAAM,IAAI,IAAI,MAAM,CAAC,UAAU,CAAC,CAAC,cAAc,EAAE;gBAClD,IAAI,IAAI,CAAC,KAAK,KAAK,KAAK,EAAE;oBACtB,SAAS,GAAG,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;iBAChC;aACJ;YACD,IAAI,UAAU,GAAG,MAAM,CAAC,UAAU,CAAC,CAAC,eAAe,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;YACnE,IAAI,UAAU,IAAI,CAAC,EAAE;gBACjB,UAAU,IAAI,KAAK,CAAC;gBACpB,IAAI,UAAU,GAAG,MAAM,CAAC,UAAU,CAAC,CAAC,eAAe,CAAC,MAAM,EAAE;oBACxD,MAAM,CAAC,UAAU,CAAC,CAAC,mBAAmB,GAAG,UAAU,CAAC;iBACvD;aACJ;SACJ;QACD,MAAM,CAAC,UAAU,CAAC,CAAC,cAAc,CAAC,WAAW,GAAG,SAAS,CAAC;QAC1D,IAAI,MAAM,CAAC,UAAU,CAAC,CAAC,iBAAiB,EAAE;YACtC,MAAM,CAAC,UAAU,CAAC,CAAC,iBAAiB,CAChC,MAAM,CAAC,UAAU,CAAC,CAAC,kBAAkB,EACrC,SAAS,CACZ,CAAC;SACL;QACD,MAAM,CAAC,UAAU,CAAC,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;KAC5C;AACL;;ACpTA;AAGA;AACA;AACA;AACA;AACA;AACO,MAAM,OAAO,GAAG,CAAC,CAAC;AAClB,MAAM,MAAM,GAAG,GAAG,CAAC;AAEnB,MAAM,IAAI,GAAG,IAAI,CAAC;AAClB,MAAM,QAAQ,GAAG,IAAI,CAAC;AACtB,MAAM,MAAM,GAAG,IAAI,CAAC;AACpB,MAAM,WAAW,GAAG,IAAI,CAAC;AAEhC;;;;;;AAMA,SAAS,QAAQ,CACb,QAAQ,EACR,OAAO,EACP,SAAS,GAAG,MAAM,EAClB,QAAQ,GAAG,IAAI;IAEf,OAAO,CAAC,OAAO,CAAC,CAAC,MAAM;QACnB,IAAI,YAAY,CAAC,MAAM,CAAC,EAAE;YACtB,YAAY,CAAC,MAAM,CAAC,CAAC,SAAS,GAAG,SAAS,CAAC;YAC3C,YAAY,CAAC,MAAM,CAAC,CAAC,QAAQ,GAAG,QAAQ,CAAC;YACzC,YAAY,CAAC,MAAM,CAAC,CAAC,QAAQ,GAAG,QAAQ,CAAC,OAAO,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;SACpE;QACD,IAAI,SAAS,CAAC,MAAM,CAAC,EAAE;;;YAGnB,SAAS,CAAC,MAAM,CAAC,GAAG;gBAChB,GAAG,SAAS,CAAC,MAAM,CAAC;gBACpB,SAAS,EAAE,SAAS;gBACpB,QAAQ,EAAE,QAAQ;gBAClB,QAAQ,EAAE,QAAQ,CAAC,OAAO,CAAC,MAAM,EAAE,MAAM,CAAC;aAC7C,CAAC;SACL;KACJ,CAAC,CAAC;AACP,CAAC;AAED,QAAQ,CAAC,cAAc,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC,EAAE,WAAW,CAAC,CAAC;AAEnE,QAAQ,CACJ,cAAc,EACd;IACI,UAAU;IACV,UAAU;IACV,UAAU;IACV,SAAS;IACT,UAAU;IACV,UAAU;IACV,UAAU;IACV,UAAU;IACV,UAAU;IACV,UAAU;IACV,WAAW;IACX,WAAW;IACX,OAAO;IACP,MAAM;IACN,SAAS;IACT,QAAQ;IACR,OAAO;IACP,QAAQ;IACR,QAAQ;IACR,OAAO;IACP,OAAO;IACP,OAAO;IACP,MAAM;IACN,MAAM;IACN,OAAO;IACP,QAAQ;IACR,MAAM;IACN,QAAQ;IACR,MAAM;IACN,MAAM;CACT,EACD,QAAQ,CACX,CAAC;AAEF,QAAQ,CAAC,WAAW,EAAE,CAAC,MAAM,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC,EAAE,WAAW,CAAC,CAAC;AAExE,QAAQ,CACJ,WAAW,EACX,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC,EAC/D,MAAM,CACT,CAAC;AACF,QAAQ,CAAC,WAAW,EAAE,CAAC,OAAO,CAAC,EAAE,IAAI,CAAC,CAAC;AAEvC,QAAQ,CAAC,YAAY,EAAE,CAAC,QAAQ,CAAC,EAAE,MAAM,EAAE,cAAc,CAAC,CAAC;AAE3D,QAAQ,CACJ,YAAY,EACZ,CAAC,SAAS,EAAE,aAAa,CAAC,EAC1B,MAAM,EACN,kEAAkE,CACrE,CAAC;AACF,QAAQ,CACJ,YAAY,EACZ,CAAC,YAAY,EAAE,aAAa,CAAC,EAC7B,MAAM,EACN,qBAAqB,CACxB,CAAC;AACF,QAAQ,CACJ,YAAY,EACZ,CAAC,WAAW,CAAC,EACb,IAAI,EACJ,sFAAsF,CACzF,CAAC;AACF,QAAQ,CACJ,YAAY,EACZ,CAAC,aAAa,CAAC,EACf,IAAI,EACJ,iDAAiD,CACpD,CAAC;AAEF,QAAQ,CACJ,YAAY,EACZ,CAAC,YAAY,CAAC,EACd,IAAI,EACJ,uCAAuC,CAC1C,CAAC;AAEF,QAAQ,CACJ,YAAY,EACZ,CAAC,SAAS,EAAE,UAAU,EAAE,WAAW,EAAE,WAAW,CAAC,EACjD,IAAI,EACJ,qBAAqB,CACxB,CAAC;AAEF,QAAQ,CACJ,YAAY,EACZ,CAAC,QAAQ,CAAC,EACV,IAAI,EACJ,sDAAsD,CACzD,CAAC;AAEF,QAAQ,CAAC,SAAS,EAAE,CAAC,UAAU,CAAC,EAAE,WAAW,EAAE,eAAe,CAAC,CAAC;AAChE,QAAQ,CACJ,SAAS,EACT;IACI,UAAU;IACV,UAAU;IACV,UAAU;IACV,UAAU;IACV,UAAU;IACV,UAAU;IACV,cAAc;IACd,UAAU;IACV,UAAU;IACV,UAAU;IAEV,UAAU;IACV,UAAU;IACV,UAAU;IACV,YAAY;IACZ,WAAW;IACX,WAAW;IACX,UAAU;IACV,UAAU;IACV,UAAU;IACV,QAAQ;IACR,QAAQ;IACR,OAAO;IACP,QAAQ;IACR,MAAM;IACN,cAAc;CACjB,EACD,MAAM,EACN,eAAe,CAClB,CAAC;AACF,QAAQ,CACJ,SAAS,EACT;IACI,QAAQ;IACR,MAAM;IACN,MAAM;IACN,MAAM;IACN,YAAY;IACZ,YAAY;IACZ,YAAY;IACZ,SAAS;IACT,SAAS;CACZ,EACD,IAAI,EACJ,gBAAgB,CACnB,CAAC;AACF,QAAQ,CACJ,SAAS,EACT,CAAC,YAAY,EAAE,YAAY,EAAE,WAAW,EAAE,WAAW,EAAE,WAAW,CAAC,EACnE,IAAI,EACJ,sBAAsB,CACzB,CAAC;AAEF,QAAQ,CACJ,SAAS,EACT,CAAC,SAAS,EAAE,SAAS,CAAC,EACtB,IAAI,EACJ,+BAA+B,CAClC,CAAC;AAEF;AACA;AACA,QAAQ,CAAC,SAAS,EAAE,CAAC,cAAc,CAAC,EAAE,IAAI,EAAE,wBAAwB,CAAC,CAAC;AACtE,QAAQ,CAAC,SAAS,EAAE,CAAC,cAAc,CAAC,EAAE,IAAI,EAAE,2BAA2B,CAAC,CAAC;AACzE,QAAQ,CAAC,SAAS,EAAE,CAAC,aAAa,CAAC,EAAE,IAAI,EAAE,yBAAyB,CAAC,CAAC;AACtE,QAAQ,CAAC,SAAS,EAAE,CAAC,cAAc,CAAC,EAAE,IAAI,EAAE,YAAY,CAAC,CAAC;AAE1D,QAAQ,CAAC,SAAS,EAAE,CAAC,QAAQ,CAAC,EAAE,IAAI,EAAE,cAAc,CAAC,CAAC;AACtD,QAAQ,CAAC,SAAS,EAAE,CAAC,MAAM,CAAC,EAAE,IAAI,EAAE,eAAe,CAAC,CAAC;AAErD,QAAQ,CACJ,QAAQ,EACR;IACI,UAAU;IACV,WAAW;IACX,WAAW;IACX,YAAY;IACZ,aAAa;IACb,aAAa;IACb,WAAW;IACX,aAAa;IACb,gBAAgB;IAChB,iBAAiB;CACpB,EACD,IAAI,EACJ,aAAa,CAChB,CAAC;AACF,QAAQ,CAAC,QAAQ,EAAE,CAAC,UAAU,CAAC,EAAE,IAAI,EAAE,4BAA4B,CAAC,CAAC;AACrE,QAAQ,CACJ,QAAQ,EACR,CAAC,WAAW,EAAE,YAAY,EAAE,YAAY,EAAE,YAAY,CAAC,EACvD,IAAI,EACJ,cAAc,CACjB,CAAC;AAEF,QAAQ,CAAC,QAAQ,EAAE,CAAC,QAAQ,EAAE,YAAY,CAAC,EAAE,IAAI,EAAE,QAAQ,CAAC,CAAC;AAC7D,QAAQ,CAAC,QAAQ,EAAE,CAAC,QAAQ,EAAE,YAAY,CAAC,EAAE,IAAI,EAAE,QAAQ,CAAC,CAAC;AAE7D,QAAQ,CACJ,WAAW,EACX,CAAC,QAAQ,CAAC,EACV,WAAW,EACX,sCAAsC,CACzC,CAAC;AACF,QAAQ,CACJ,WAAW,EACX;IACI,SAAS;IACT,SAAS;IACT,SAAS;IACT,UAAU;IACV,UAAU;IACV,SAAS;IACT,SAAS;CACZ,EACD,IAAI,EACJ,sCAAsC,CACzC,CAAC;AACF,QAAQ,CACJ,WAAW,EACX,CAAC,QAAQ,EAAE,QAAQ,EAAE,UAAU,CAAC,EAChC,IAAI,EACJ,sCAAsC,CACzC,CAAC;AACF,QAAQ,CACJ,WAAW,EACX,CAAC,kBAAkB,EAAE,kBAAkB,CAAC,EACxC,IAAI,EACJ,4DAA4D,CAC/D,CAAC;AAEF,QAAQ,CACJ,sBAAsB,EACtB,CAAC,OAAO,EAAE,QAAQ,EAAE,UAAU,EAAE,UAAU,EAAE,OAAO,CAAC,EACpD,WAAW,CACd,CAAC;AACF,QAAQ,CACJ,sBAAsB,EACtB,CAAC,YAAY,EAAE,YAAY,EAAE,QAAQ,EAAE,QAAQ,CAAC,EAChD,MAAM,CACT,CAAC;AACF,QAAQ,CACJ,sBAAsB,EACtB;IACI,YAAY;IACZ,UAAU;IACV,UAAU;IAEV,YAAY;IACZ,aAAa;IACb,WAAW;IACX,YAAY;IAEZ,SAAS;IACT,SAAS;IACT,SAAS;IACT,SAAS;IACT,MAAM;IACN,OAAO;IACP,OAAO;IACP,aAAa;IACb,aAAa;IACb,SAAS;IAET,SAAS;IACT,SAAS;IACT,UAAU;IACV,gBAAgB;IAChB,oBAAoB;IACpB,oBAAoB;IACpB,mBAAmB;CACtB,EACD,IAAI,CACP,CAAC;AAEF,QAAQ,CAAC,SAAS,EAAE,CAAC,OAAO,CAAC,EAAE,WAAW,CAAC,CAAC;AAC5C,QAAQ,CACJ,SAAS,EACT,CAAC,OAAO,EAAE,QAAQ,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,CAAC,EACpD,MAAM,EACN,qBAAqB,CACxB,CAAC;AACF,QAAQ,CAAC,SAAS,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC;AAC1D,QAAQ,CAAC,SAAS,EAAE,CAAC,KAAK,CAAC,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC;AAC5C,QAAQ,CAAC,SAAS,EAAE,CAAC,KAAK,CAAC,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC;AAC5C,QAAQ,CACJ,SAAS,EACT,CAAC,YAAY,EAAE,OAAO,EAAE,OAAO,EAAE,SAAS,EAAE,SAAS,CAAC,EACtD,IAAI,EACJ,qBAAqB,CACxB,CAAC;AAEF,QAAQ,CACJ,oBAAoB,EACpB;IACI,kBAAkB;IAClB,iBAAiB;IACjB,kBAAkB;IAClB,mBAAmB;IACnB,oBAAoB;IACpB,sBAAsB;IACtB,aAAa;IACb,mBAAmB;IACnB,aAAa;IACb,WAAW;IACX,aAAa;IACb,aAAa;CAChB,EACD,MAAM,EACN,SAAS,CACZ,CAAC;AAEF,QAAQ,CACJ,oBAAoB,EACpB;IACI,mBAAmB;IACnB,kBAAkB;IAClB,uBAAuB;IACvB,cAAc;IACd,oBAAoB;IACpB,cAAc;IACd,UAAU;CACb,EACD,MAAM,EACN,SAAS,CACZ,CAAC;AAEF,QAAQ,CACJ,QAAQ,EACR;IACI,QAAQ;IACR,cAAc;IACd,gBAAgB;IAChB,SAAS;IACT,cAAc;IACd,SAAS;IACT,SAAS;IACT,SAAS;IACT,QAAQ;IACR,QAAQ;CACX,EACD,IAAI,EACJ,SAAS,CACZ,CAAC;AAEF,QAAQ,CAAC,QAAQ,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,QAAQ,EAAE,QAAQ,CAAC,EAAE,IAAI,EAAE,QAAQ,CAAC,CAAC;AAC3E,QAAQ,CAAC,QAAQ,EAAE,CAAC,QAAQ,EAAE,QAAQ,EAAE,SAAS,EAAE,SAAS,CAAC,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC;AAC5E,QAAQ,CAAC,QAAQ,EAAE,CAAC,QAAQ,EAAE,QAAQ,EAAE,SAAS,EAAE,SAAS,CAAC,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC;AAC5E,QAAQ,CAAC,QAAQ,EAAE,CAAC,QAAQ,EAAE,QAAQ,EAAE,SAAS,EAAE,SAAS,CAAC,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC;AAE5E,QAAQ,CACJ,oBAAoB,EACpB;IACI,SAAS;IACT,WAAW;IACX,wBAAwB;IACxB,KAAK;IACL,wBAAwB;IACxB,KAAK;IACL,wBAAwB;IACxB,KAAK;IACL,wBAAwB;IACxB,KAAK;IACL,wBAAwB;IACxB,KAAK;IACL,gBAAgB;IAChB,UAAU;IACV,UAAU;IACV,WAAW;IACX,KAAK;IACL,KAAK;IACL,OAAO;IACP,UAAU;CACb,EACD,WAAW,CACd,CAAC;AAEF,QAAQ,CACJ,oBAAoB,EACpB;IACI,wBAAwB;IACxB,KAAK;IACL,OAAO;IACP,QAAQ;IACR,UAAU;IACV,SAAS;IACT,SAAS;IACT,cAAc;IACd,cAAc;IACd,iBAAiB;IACjB,MAAM;IACN,wBAAwB;IACxB,MAAM;IACN,mBAAmB;IACnB,OAAO;IACP,GAAG;IACH,MAAM;IACN,MAAM;CACT,EACD,MAAM,CACT,CAAC;AACF,QAAQ,CACJ,oBAAoB,EACpB;IACI,OAAO;IACP,OAAO;IACP,kBAAkB;IAClB,kBAAkB;IAClB,kBAAkB;IAClB,kBAAkB;IAClB,kBAAkB;IAClB,kBAAkB;IAClB,kBAAkB;IAClB,QAAQ;IACR,QAAQ;IACR,QAAQ;IACR,MAAM;IACN,OAAO;IACP,OAAO;IACP,UAAU;IACV,OAAO;IACP,QAAQ;CACX,EACD,IAAI,CACP,CAAC;AAEF,QAAQ,CAAC,SAAS,EAAE,CAAC,UAAU,EAAE,OAAO,CAAC,EAAE,WAAW,CAAC,CAAC;AAExD,QAAQ,CACJ,SAAS,EACT,CAAC,QAAQ,EAAE,WAAW,EAAE,WAAW,EAAE,cAAc,EAAE,iBAAiB,CAAC,EACvE,IAAI,CACP,CAAC;AAEF,QAAQ,CACJ,SAAS,EACT;IACI,aAAa;IAEb,UAAU;IACV,YAAY;IAEZ,SAAS;IACT,iBAAiB;IACjB,kBAAkB;IAElB,SAAS;IACT,eAAe;IACf,aAAa;IACb,mBAAmB;IACnB,SAAS;IACT,QAAQ;IACR,WAAW;IACX,KAAK;IACL,KAAK;IACL,YAAY;IACZ,aAAa;IACb,eAAe;IACf,aAAa;IACb,aAAa;IACb,SAAS;IACT,GAAG;IACH,KAAK;IACL,KAAK;IACL,GAAG;IACH,GAAG;CACN,EACD,IAAI,CACP,CAAC;AAEF,QAAQ,CAAC,SAAS,EAAE,CAAC,WAAW,CAAC,EAAE,IAAI,EAAE,WAAW,CAAC,CAAC;AAEtD,QAAQ,CACJ,QAAQ,EACR,CAAC,kBAAkB,EAAE,cAAc,EAAE,kBAAkB,EAAE,cAAc,CAAC,EACxE,WAAW,CACd,CAAC;AACF,QAAQ,CACJ,QAAQ,EACR;IACI,cAAc;IACd,UAAU;IACV,sBAAsB;IACtB,mBAAmB;IACnB,aAAa;IACb,kBAAkB;IAClB,WAAW;IACX,aAAa;IACb,kBAAkB;IAClB,kBAAkB;IAClB,qBAAqB;CACxB,EACD,MAAM,CACT,CAAC;AACF,QAAQ,CACJ,QAAQ,EACR;IACI,aAAa;IACb,sBAAsB;IACtB,iBAAiB;IACjB,iBAAiB;IAEjB,WAAW;IACX,WAAW;IACX,WAAW;IACX,WAAW;IAEX,WAAW;IACX,aAAa;IACb,eAAe;IACf,eAAe;IAEf,iBAAiB;IACjB,iBAAiB;IACjB,mBAAmB;IACnB,oBAAoB;IAEpB,mBAAmB;IAEnB,kBAAkB;IAClB,iBAAiB;IACjB,kBAAkB;IAClB,cAAc;IACd,oBAAoB;IACpB,iBAAiB;IACjB,iBAAiB;IACjB,qBAAqB;IACrB,mBAAmB;IACnB,OAAO;IACP,cAAc;IACd,mBAAmB;IACnB,YAAY;IACZ,uBAAuB;IACvB,qBAAqB;IACrB,kBAAkB;IAClB,kBAAkB;IAClB,mBAAmB;IACnB,oBAAoB;IACpB,OAAO;IACP,kBAAkB;IAClB,kBAAkB;IAClB,oBAAoB;IACpB,mBAAmB;IACnB,WAAW;IACX,eAAe;IACf,eAAe;CAClB,EACD,IAAI,CACP,CAAC;AACF,QAAQ,CAAC,QAAQ,EAAE,CAAC,iBAAiB,EAAE,oBAAoB,CAAC,EAAE,OAAO,CAAC,CAAC;AAEvE;AACA,QAAQ,CACJ,gBAAgB,EAChB;IACI,eAAe;IACf,eAAe;IACf,mBAAmB;IACnB,mBAAmB;IACnB,cAAc;IACd,cAAc;CACjB,EACD,IAAI,CACP,CAAC;AAEF,QAAQ,CACJ,oBAAoB,EACpB;IACI,eAAe;IACf,cAAc;IACd,eAAe;IACf,cAAc;IACd,kBAAkB;IAClB,oBAAoB;IACpB,mBAAmB;IACnB,qBAAqB;IACrB,cAAc;IACd,qBAAqB;IACrB,sBAAsB;IACtB,mBAAmB;IACnB,mBAAmB;IACnB,sBAAsB;IACtB,sBAAsB;IACtB,kBAAkB;IAClB,mBAAmB;IACnB,WAAW;IACX,WAAW;IACX,oBAAoB;IACpB,qBAAqB;IACrB,oBAAoB;CACvB,EACD,IAAI,EACJ,oBAAoB,CACvB,CAAC;AAEF;AACA,QAAQ,CACJ,mBAAmB,EACnB;IACI,SAAS;IACT,aAAa;IACb,QAAQ;IACR,SAAS;IACT,SAAS;IAET,SAAS;IACT,SAAS;IAET,aAAa;IACb,SAAS;IACT,YAAY;IACZ,SAAS;IACT,WAAW;IACX,YAAY;IACZ,eAAe;IACf,QAAQ;IACR,aAAa;IACb,QAAQ;IACR,UAAU;IACV,UAAU;IACV,QAAQ;IACR,aAAa;IACb,SAAS;IACT,QAAQ;IACR,SAAS;IACT,aAAa;IACb,SAAS;IACT,SAAS;IACT,YAAY;IACZ,SAAS;IACT,kBAAkB;IAClB,aAAa;IACb,UAAU;IACV,UAAU;IACV,YAAY;IACZ,YAAY;IACZ,YAAY;IACZ,eAAe;IACf,WAAW;CACd,EACD,IAAI,CACP,CAAC;AAEF;AACA,QAAQ,CAAC,QAAQ,EAAE,CAAC,SAAS,EAAE,QAAQ,EAAE,UAAU,EAAE,SAAS,CAAC,EAAE,IAAI,CAAC,CAAC;AAEvE,QAAQ,CACJ,QAAQ,EACR;IACI,UAAU;IACV,UAAU;IACV,QAAQ;IACR,QAAQ;IACR,KAAK;IACL,KAAK;IACL,GAAG;IACH,GAAG;IACH,GAAG;IACH,GAAG;CACN,EACD,WAAW,CACd,CAAC;AACF,QAAQ,CACJ,QAAQ,EACR;IACI,UAAU;IACV,UAAU;IACV,UAAU;IACV,UAAU;IACV,SAAS;IACT,SAAS;IACT,SAAS;IACT,KAAK;IACL,SAAS;CACZ,EACD,MAAM,CACT,CAAC;AACF,QAAQ,CACJ,QAAQ,EACR;IACI,SAAS;IACT,SAAS;IACT,SAAS;IACT,SAAS;IACT,UAAU;IACV,UAAU;IACV,YAAY;IACZ,YAAY;IACZ,YAAY;IACZ,YAAY;IACZ,UAAU;IACV,UAAU;IACV,cAAc;IACd,cAAc;CACjB,EACD,IAAI,CACP,CAAC;AAEF,QAAQ,CACJ,WAAW,EACX,CAAC,GAAG,EAAE,MAAM,EAAE,OAAO,EAAE,GAAG,EAAE,GAAG,EAAE,YAAY,EAAE,YAAY,EAAE,UAAU,CAAC,EACxE,WAAW,CACd,CAAC;AACF,QAAQ,CACJ,WAAW,EACX;IACI,MAAM;IACN,MAAM;IACN,MAAM;IACN,MAAM;IACN,OAAO;IACP,OAAO;IACP,MAAM;IACN,QAAQ;IACR,SAAS;IACT,QAAQ;IACR,UAAU;IACV,QAAQ;IACR,QAAQ;IACR,YAAY;IACZ,UAAU;IACV,SAAS;IACT,SAAS;IACT,OAAO;IACP,UAAU;CACb,EACD,MAAM,CACT,CAAC;AACF,QAAQ,CACJ,WAAW,EACX;IACI,WAAW;IACX,UAAU;IAEV,YAAY;IACZ,eAAe;IACf,cAAc;IACd,aAAa;IACb,cAAc;IACd,cAAc;IAEd,YAAY;IACZ,WAAW;IACX,WAAW;IACX,WAAW;IACX,SAAS;IACT,aAAa;IACb,SAAS;IACT,WAAW;IAEX,QAAQ;IACR,QAAQ;IAER,cAAc;IACd,cAAc;IACd,UAAU;IAEV,SAAS;IAET,QAAQ;IACR,eAAe;IAEf,MAAM;IAEN,OAAO;IACP,WAAW;IACX,aAAa;IACb,cAAc;IACd,gBAAgB;IAChB,iBAAiB;IACjB,eAAe;IACf,eAAe;IACf,SAAS;IACT,UAAU;IACV,UAAU;IACV,UAAU;IACV,QAAQ;IACR,cAAc;IACd,OAAO;IACP,WAAW;IACX,aAAa;IACb,cAAc;IAEd,eAAe;IACf,eAAe;IACf,SAAS;IACT,YAAY;IACZ,iBAAiB;IACjB,WAAW;IACX,aAAa;IACb,aAAa;IACb,eAAe;IACf,UAAU;IACV,SAAS;IACT,OAAO;IACP,OAAO;IACP,QAAQ;IAER,SAAS;IACT,YAAY;IACZ,SAAS;IACT,UAAU;IACV,UAAU;IACV,WAAW;IACX,UAAU;IACV,UAAU;IACV,SAAS;IACT,WAAW;CACd,EACD,IAAI,CACP,CAAC;AAEF,QAAQ,CACJ,OAAO,EACP,CAAC,kBAAkB,EAAE,kBAAkB,EAAE,MAAM,CAAC,EAChD,WAAW,CACd,CAAC;AACF,QAAQ,CAAC,OAAO,EAAE,CAAC,UAAU,EAAE,SAAS,CAAC,EAAE,MAAM,CAAC,CAAC;AACnD,QAAQ,CACJ,OAAO,EACP;IACI,aAAa;IACb,WAAW;IACX,WAAW;IACX,QAAQ;IACR,SAAS;IACT,aAAa;IACb,iBAAiB;IACjB,gBAAgB;CACnB,EACD,IAAI,CACP,CAAC;AAEF,QAAQ,CAAC,WAAW,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,QAAQ,CAAC,EAAE,WAAW,CAAC,CAAC;AAC9D,QAAQ,CAAC,WAAW,EAAE,CAAC,QAAQ,CAAC,EAAE,WAAW,EAAE,qBAAqB,CAAC,CAAC;AAEtE,QAAQ,CAAC,WAAW,EAAE,CAAC,MAAM,EAAE,MAAM,EAAE,SAAS,EAAE,OAAO,EAAE,QAAQ,CAAC,EAAE,MAAM,CAAC,CAAC;AAE9E,QAAQ,CACJ,WAAW,EACX;IACI,UAAU;IACV,UAAU;IACV,kBAAkB;IAClB,mBAAmB;IACnB,YAAY;IACZ,WAAW;IACX,aAAa;IACb,kBAAkB;IAClB,iBAAiB;IACjB,WAAW;CACd,EACD,IAAI,CACP,CAAC;AAEF,QAAQ,CAAC,OAAO,EAAE,CAAC,SAAS,EAAE,OAAO,EAAE,OAAO,CAAC,EAAE,WAAW,CAAC,CAAC;AAC9D,QAAQ,CAAC,OAAO,EAAE,CAAC,QAAQ,CAAC,EAAE,MAAM,CAAC,CAAC;AACtC,QAAQ,CACJ,OAAO,EACP;IACI,QAAQ;IACR,OAAO;IACP,YAAY;IACZ,UAAU;IACV,OAAO;IACP,cAAc;IACd,YAAY;CACf,EACD,IAAI,CACP,CAAC;AAEF,QAAQ,CACJ,OAAO,EACP;IACI,SAAS;IACT,QAAQ;IACR,SAAS;IACT,SAAS;IACT,WAAW;IACX,cAAc;IACd,QAAQ;IACR,OAAO;IACP,SAAS;IACT,YAAY;IACZ,QAAQ;IACR,SAAS;IACT,YAAY;IACZ,UAAU;IACV,MAAM;IACN,MAAM;IACN,MAAM;IACN,MAAM;IACN,SAAS;IACT,OAAO;IACP,UAAU;IACV,SAAS;IACT,YAAY;IACZ,OAAO;IACP,OAAO;IACP,UAAU;IACV,WAAW;IACX,OAAO;IACP,OAAO;IACP,SAAS;IACT,SAAS;IACT,SAAS;IACT,SAAS;IACT,UAAU;IACV,MAAM;IACN,MAAM;IACN,SAAS;IACT,WAAW;IACX,OAAO;IACP,OAAO;IACP,SAAS;IACT,WAAW;IACX,WAAW;CACd,EACD,MAAM,CACT,CAAC;AAEF,QAAQ,CACJ,MAAM,EACN;IACI,YAAY;IACZ,cAAc;IACd,OAAO;IACP,OAAO;IACP,MAAM;IACN,SAAS;IACT,UAAU;IACV,UAAU;IACV,YAAY;IACZ,YAAY;IACZ,cAAc;CACjB,EACD,WAAW,CACd,CAAC;AACF,QAAQ,CACJ,MAAM,EACN;IACI,YAAY;IACZ,OAAO;IACP,MAAM;IACN,cAAc;IACd,cAAc;IACd,aAAa;IACb,gBAAgB;IAChB,cAAc;IACd,iBAAiB;CACpB,EACD,MAAM,CACT,CAAC;AACF,QAAQ,CACJ,MAAM,EACN;IACI,iBAAiB;IACjB,cAAc;IAEd,QAAQ;IACR,aAAa;IACb,gBAAgB;IAChB,cAAc;IACd,iBAAiB;IACjB,WAAW;IACX,WAAW;IACX,aAAa;IACb,aAAa;IACb,cAAc;IACd,aAAa;IACb,UAAU;IACV,YAAY;IACZ,aAAa;IACb,UAAU;IACV,YAAY;CACf,EACD,IAAI,CACP,CAAC;AAEF,QAAQ,CACJ,SAAS,EACT,CAAC,iBAAiB,EAAE,SAAS,CAAC,EAC9B,MAAM,EACN,oCAAoC,CACvC,CAAC;AACF,QAAQ,CACJ,SAAS,EACT,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,UAAU,EAAE,WAAW,CAAC,EACrD,IAAI,EACJ,oCAAoC,CACvC,CAAC;AACF,QAAQ,CACJ,SAAS,EACT,CAAC,UAAU,EAAE,WAAW,CAAC,EACzB,IAAI,EACJ,yCAAyC,CAC5C,CAAC;AACF,QAAQ,CACJ,aAAa,EACb;IACI,SAAS;IACT,SAAS;IACT,SAAS;IACT,SAAS;IACT,SAAS;IACT,SAAS;IACT,GAAG;IACH,GAAG;IACH,GAAG;IACH,GAAG;IACH,GAAG;IACH,GAAG;IACH,GAAG;CACN,EACD,MAAM,CACT,CAAC;AACF,QAAQ,CAAC,aAAa,EAAE,CAAC,gBAAgB,EAAE,SAAS,EAAE,SAAS,CAAC,EAAE,IAAI,CAAC,CAAC;AAExE,QAAQ,CAAC,OAAO,EAAE,CAAC,UAAU,EAAE,OAAO,CAAC,EAAE,MAAM,CAAC,CAAC;AACjD,QAAQ,CACJ,OAAO,EACP,CAAC,eAAe,EAAE,YAAY,EAAE,WAAW,EAAE,YAAY,EAAE,UAAU,CAAC,EACtE,IAAI,CACP,CAAC;AAEF,QAAQ,CACJ,SAAS,EACT,CAAC,QAAQ,EAAE,UAAU,EAAE,eAAe,EAAE,SAAS,EAAE,UAAU,CAAC,EAC9D,MAAM,CACT,CAAC;AACF,QAAQ,CACJ,SAAS,EACT;IACI,WAAW;IACX,cAAc;IACd,UAAU;IACV,eAAe;IACf,UAAU;IACV,YAAY;IACZ,YAAY;IACZ,QAAQ;CACX,EACD,IAAI,CACP,CAAC;AAEF,QAAQ,CAAC,WAAW,EAAE,CAAC,YAAY,EAAE,aAAa,CAAC,EAAE,MAAM,CAAC,CAAC;AAC7D,QAAQ,CACJ,WAAW,EACX;IACI,iBAAiB;IACjB,eAAe;IACf,gBAAgB;IAChB,mBAAmB;IACnB,gBAAgB;IAChB,mBAAmB;IACnB,kBAAkB;IAClB,iBAAiB;IACjB,mBAAmB;IACnB,iBAAiB;IACjB,oBAAoB;IACpB,mBAAmB;IACnB,kBAAkB;IAClB,oBAAoB;IACpB,iBAAiB;IACjB,qBAAqB;IACrB,qBAAqB;IACrB,sBAAsB;CACzB,EACD,IAAI,CACP,CAAC;AAEF,QAAQ,CAAC,QAAQ,EAAE,CAAC,OAAO,EAAE,QAAQ,CAAC,EAAE,MAAM,CAAC,CAAC;AAChD,QAAQ,CACJ,QAAQ,EACR,CAAC,WAAW,EAAE,WAAW,EAAE,WAAW,EAAE,gBAAgB,EAAE,WAAW,CAAC,EACtE,IAAI,CACP;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACn/BD,MAAM,kBAAkB,GAAG,QAAQ,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC;AAC9D,kBAAkB,CAAC,SAAS,GAAG;;;;;;;;;;;;;;;8CAee,CAAC;AAE/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM,cAAc,GAAG,IAAI,OAAO,EAO/B,CAAC;AAEJ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MA8Ja,gBAAiB,SAAQ,WAAW;;;;;;;;;;;;;;;;;IA2D7C,YAAY,OAAmC;;QAC3C,KAAK,EAAE,CAAC;QAnBZ,6BAA6B;QAqBzB,IAAI,CAAC,YAAY,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC,CAAC;QACpC,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,kBAAkB,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC;QACxE,MAAM,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,aAAa,CACtC,kBAAkB,CACrB,CAAC;;;QAIF,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,gBAAgB,CACjC,OAAO,EACP,CAAC,MAAM,KAAK,IAAI,CAAC,KAAK,EAAE,EACxB,IAAI,CACP,CAAC;;QAGF,IAAI;YACA,MAAM,IAAI,GAAG,IAAI;iBACZ,gBAAgB,EAAE;iBAClB,MAAM,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,KAAK,kBAAkB,CAAC;iBAC/C,GAAG,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,WAAW,CAAC;iBACzB,IAAI,CAAC,EAAE,CAAC,CAAC;YACd,IAAI,IAAI,EAAE;gBACN,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC;aACrC;SACJ;QAAC,OAAO,CAAC,EAAE;YACR,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;SAClB;;QAGD,IAAI,OAAO,EAAE;YACT,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;SAC5B;;;QAID,IAAI,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,EAAE;YAC5B,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;SAC3C;aAAM;YACH,IAAI,CAAC,KAAK,SACN,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CACE,aAAa,GACd,GAAG,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,QAAQ,KAAK,CAAC,GAAG,CAAC,CAAC,WAAW,GAAG,EAAE,CAAC,EAClD,IAAI,CAAC,EAAE,EACP,IAAI,qCAAM,EAAE,CAAC;SACzB;QAED,IAAI,CAAC,gBAAgB,CAAC,YAAY,EAAE,CAAC,CAAC;YAClC,IAAI,CAAC,CAAC,MAAM,KAAK,IAAI;gBAAE,OAAO;YAC9B,MAAM,KAAK,GAAG,IAAI;iBACb,aAAa,EAAE;iBACf,GAAG,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,QAAQ,KAAK,CAAC,GAAG,CAAC,CAAC,WAAW,GAAG,EAAE,CAAC,CAAC;iBACnD,IAAI,CAAC,EAAE,CAAC;iBACR,IAAI,EAAE,CAAC;YACZ,IAAI,yCAAgB,EAAE;gBAClB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;aACtB;iBAAM;;;gBAGH,yCAAgB,QAAQ,CAAC,KAAK,EAAE;oBAC5B,aAAa,EAAE,YAAY;iBAC9B,CAAC,CAAC;aACN;SACJ,CAAC,CAAC;KACN;;;;;IAxHD,WAAW,iBAAiB;QAGxB,OAAO;YACH,cAAc,EAAE,QAAQ;YACxB,iBAAiB,EAAE,QAAQ;YAC3B,0BAA0B,EAAE,QAAQ;YACpC,8BAA8B,EAAE,SAAS;YACzC,yBAAyB,EAAE,QAAQ;YACnC,oBAAoB,EAAE,SAAS;YAC/B,oBAAoB,EAAE,QAAQ;YAC9B,MAAM,EAAE,QAAQ;YAChB,WAAW,EAAE,SAAS;YACtB,+BAA+B,EAAE,SAAS;YAC1C,aAAa,EAAE,SAAS;YACxB,YAAY,EAAE,SAAS;YACvB,mBAAmB,EAAE,SAAS;YAC9B,eAAe,EAAE,QAAQ;YACzB,oBAAoB,EAAE,QAAQ;YAC9B,qBAAqB,EAAE,QAAQ;YAC/B,uBAAuB,EAAE,QAAQ;YACjC,sBAAsB,EAAE,QAAQ;YAChC,yBAAyB,EAAE,QAAQ;YACnC,uBAAuB,EAAE,QAAQ;YACjC,wBAAwB,EAAE,QAAQ;YAClC,mBAAmB,EAAE,QAAQ;SAChC,CAAC;KACL;;;;;IAKD,WAAW,kBAAkB;QACzB,OAAO,CAAC,GAAG,MAAM,CAAC,IAAI,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,EAAE,UAAU,CAAC,CAAC;KAC3E;IAwFD,IAAI,IAAI;;QACJ,+FAAwB,IAAI,CAAC;KAChC;IACD,IAAI,IAAI,CAAC,KAAgB;QACrB,IAAI,yCAAgB;YAAE,OAAO;QAC7B,yCAAgB,IAAI,GAAG,KAAK,CAAC;KAChC;IASD,UAAU,CACN,IAA0D;QAE1D,8CAAqB;YACjB,OAAOD,GAAU,CAAC,yCAAgB,OAAO,EAAE,IAAI,CAAC,CAAC;SACpD;QACD,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,IAAI,CAAC;YAAE,OAAO,IAAI,CAAC;QAC3C,OAAOA,GAAU,CACbL,MAAa,CACTC,UAAiB,EAAE,EACnB,cAAc,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,OAAO,CACnC,EACD,IAAI,CACP,CAAC;KACL;;;;IAID,SAAS,CAAmC,GAAM;QAC9C,OAAQ,IAAI,CAAC,UAAU,CAAC,CAAC,GAAG,CAAC,CAAoC,CAAC;KACrE;;;;IAKD,UAAU,CAAC,OAAkC;QACzC,8CAAqB;YACjB,yCAAgB,UAAU,CAAC,OAAO,CAAC,CAAC;SACvC;aAAM;YACH,IAAI,cAAc,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;gBAC1B,cAAc,CAAC,GAAG,CAAC,IAAI,EAAE;oBACrB,KAAK,EAAE,cAAc,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,KAAK;oBACrC,SAAS,EAAE,EAAE,MAAM,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE;oBAChC,OAAO,EAAE;wBACL,GAAG,cAAc,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,OAAO;wBACnC,GAAG,OAAO;qBACb;iBACJ,CAAC,CAAC;aACN;iBAAM;gBACH,cAAc,CAAC,GAAG,CAAC,IAAI,EAAE;oBACrB,KAAK,EAAE,EAAE;oBACT,SAAS,EAAE,EAAE,MAAM,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE;oBAC/B,OAAO,EAAE,OAAO;iBACnB,CAAC,CAAC;aACN;SACJ;;QAGD,iBAAiB,CAAC,IAAI,CAAC,CAAC;KAC3B;;;;;;;;;;;;;;;;;;;IAmBD,cAAc,CAAC,OAAwC;;QACnD,qGAAwB,cAAc,CAAC,OAAO,oCAAK,KAAK,CAAC;KAC5D;IAUD,QAAQ,CACJ,IAAgD,EAChD,IAA4B,EAC5B,IAAmB;QAEnB,8CAAqB;YACjB,OAAO,yCAAgB,QAAQ,CAAC,IAAW,EAAE,IAAW,EAAE,IAAI,CAAC,CAAC;SACnE;QACD,IAAI,cAAc,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;YAC1B,IAAI,KAAa,CAAC;YAClB,IAAI,GAAW,CAAC;YAChB,IAAI,MAAoB,CAAC;YACzB,IAAI,WAAW,CAAC,IAAI,CAAC,EAAE;gBACnB,CAAC,KAAK,EAAE,GAAG,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;gBAC9B,MAAM,GAAG,IAAoB,CAAC;aACjC;iBAAM,IAAI,OAAO,CAAC,IAAI,CAAC,EAAE;gBACtB,CAAC,KAAK,EAAE,GAAG,CAAC,GAAG,IAAI,CAAC;gBACpB,MAAM,GAAG,IAAoB,CAAC;aACjC;iBAAM,IAAI,QAAQ,CAAC,IAAI,CAAC,IAAI,QAAQ,CAAC,IAAI,CAAC,EAAE;gBACzC,KAAK,GAAG,IAAI,CAAC;gBACb,GAAG,GAAG,IAAI,CAAC;gBACX,MAAM,GAAG,IAAoB,CAAC;aACjC;iBAAM;gBACH,KAAK,GAAG,CAAC,CAAC;gBACV,GAAG,GAAG,CAAC,CAAC,CAAC;gBACT,MAAM,GAAG,IAAoB,CAAC;aACjC;YACD,IAAI,MAAM,KAAK,OAAO,IAAI,KAAK,KAAK,CAAC,IAAI,GAAG,KAAK,CAAC,CAAC,EAAE;gBACjD,OAAO,cAAc,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC;aACzC;SACJ;QACD,OAAO,SAAS,CAAC;KACpB;;;;IAKD,QAAQ,CAAC,KAAc,EAAE,OAAuB;QAC5C,8CAAqB;YACjB,yCAAgB,QAAQ,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;YACzC,OAAO;SACV;QACD,IAAI,cAAc,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;YAC1B,cAAc,CAAC,GAAG,CAAC,IAAI,EAAE;gBACrB,KAAK;gBACL,SAAS,EAAE,EAAE,MAAM,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,SAAS,EAAE,SAAS,EAAE;gBACtD,OAAO,EAAE,cAAc,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,OAAO;aAC5C,CAAC,CAAC;YACH,OAAO;SACV;QACD,cAAc,CAAC,GAAG,CAAC,IAAI,EAAE;YACrB,KAAK;YACL,SAAS,EAAE,EAAE,MAAM,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,SAAS,EAAE,SAAS,EAAE;YACtD,OAAO,EAAE,wBAAwB,CAAC,IAAI,CAAC;SAC1C,CAAC,CAAC;KACN;;;;;;;;IASD,QAAQ;;QACJ,qGAAwB,QAAQ,qCAAM,KAAK,CAAC;KAC/C;;;;;;;IAOD,KAAK;;QACD,wFAAiB,KAAK,GAAG;KAC5B;;;;;;;;IAQD,IAAI;;QACA,wFAAiB,IAAI,GAAG;KAC3B;;;;;IAMD,MAAM;;QACF,wFAAiB,MAAM,GAAG;KAC7B;;;;;;;;;;;;IAYD,MAAM,CAAC,CAAS,EAAE,OAAuB;;QACrC,qGAAwB,MAAM,CAAC,CAAC,EAAE,OAAO,oCAAK,KAAK,CAAC;KACvD;;;;;;;;;;;;;;;;;IAiBD,UAAU,CAAC,KAAY;;QACnB,+FAAwB,UAAU,CAAC,KAAK,EAAE;KAC7C;;;;;;;;IASD,IAAI,UAAU;;QACV,qGAAwB,aAAa,qCAAM,IAAI,CAAC;KACnD;IACD,IAAI,UAAU,CAAC,KAA+B;;QAC1C,wFAAiB,aAAa,CAAC,KAAK,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,EAAE;KACpD;;;;;;;;;IASD,aAAa,CAAC,CAAS,EAAE,CAAS;;QAC9B,qGAAwB,aAAa,CAAC,CAAC,EAAE,CAAC,oCAAK,KAAK,CAAC;KACxD;;;;;;;IAQD,IAAI,CAAC,KAAsB;;QACvB,qGAAwB,IAAI,CAAC,KAAK,oCAAK,EAAE,CAAC;KAC7C;;;;;IAKD,iBAAiB;QACb,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC;YAAE,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;;QAErE,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC;YAAE,IAAI,CAAC,YAAY,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC;QAEvE,uBAAA,IAAI,cAAc,IAAI,gBAAgB,CAClC,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,aAAa,CAAC,EAC5C;YACI,MAAM,EAAE;gBACJ,IAAI,CAAC,aAAa,CACd,IAAI,KAAK,CAAC,MAAM,EAAE;oBACd,UAAU,EAAE,KAAK;oBACjB,OAAO,EAAE,KAAK;iBACjB,CAAC,CACL,CAAC;aACL;YACD,kBAAkB,EAAE;gBAChB,IAAI,CAAC,aAAa,CACd,IAAI,KAAK,CAAC,OAAO,EAAE;oBACf,UAAU,EAAE,KAAK;oBACjB,OAAO,EAAE,IAAI;iBAChB,CAAC,CACL,CAAC;aACL;YACD,OAAO,EAAE,CAAC,GAMT;gBACG,IAAI,CAAC,aAAa,CACd,IAAI,WAAW,CAAiB,YAAY,EAAE;oBAC1C,MAAM,EAAE;wBACJ,IAAI,EAAE,GAAG,CAAC,IAAI;wBACd,GAAG,EAAE,GAAG,CAAC,GAAG;wBACZ,KAAK,EAAE,GAAG,CAAC,KAAK;wBAChB,MAAM,EAAE,GAAG,CAAC,MAAM;wBAClB,KAAK,EAAE,GAAG,CAAC,KAAK;qBACnB;oBACD,UAAU,EAAE,KAAK;oBACjB,OAAO,EAAE,IAAI;iBAChB,CAAC,CACL,CAAC;aACL;YACD,OAAO,EAAE;gBACL,IAAI,CAAC,aAAa,CACd,IAAI,KAAK,CAAC,OAAO,EAAE;oBACf,UAAU,EAAE,KAAK;oBACjB,OAAO,EAAE,KAAK;iBACjB,CAAC,CACL,CAAC;aACL;YACD,WAAW,EAAE,CACT,OAAkB,EAClB,SAAiB,EACjB,EAAiB;gBAEjB,OAAO,IAAI,CAAC,aAAa,CACrB,IAAI,WAAW,CAAiB,WAAW,EAAE;oBACzC,MAAM,EAAE;wBACJ,SAAS;wBACT,KAAK,EAAE,EAAE;qBACZ;oBACD,UAAU,EAAE,IAAI;oBAChB,OAAO,EAAE,IAAI;iBAChB,CAAC,CACL,CAAC;aACL;YACD,YAAY,EAAE,CAAC,OAAkB,EAAE,KAAgB;gBAC/C,IAAI,CAAC,aAAa,CACd,IAAI,KAAK,CAAC,aAAa,EAAE;oBACrB,UAAU,EAAE,KAAK;oBACjB,OAAO,EAAE,IAAI;iBAChB,CAAC,CACL,CAAC;aACL;YACD,QAAQ,EAAE,CAAC,OAAkB;;;;gBAIzB,IAAI,CAAC,aAAa,CACd,IAAI,KAAK,CAAC,QAAQ,EAAE;oBAChB,UAAU,EAAE,KAAK;oBACjB,OAAO,EAAE,IAAI;iBAChB,CAAC,CACL,CAAC;aACL;YACD,WAAW,EAAE,CACT,OAAkB,EAClB,SAAyD;gBAEzD,OAAO,IAAI,CAAC,aAAa,CACrB,IAAI,WAAW,CAAgB,WAAW,EAAE;oBACxC,MAAM,EAAE,EAAE,SAAS,EAAE;oBACrB,UAAU,EAAE,IAAI;oBAChB,OAAO,EAAE,IAAI;iBAChB,CAAC,CACL,CAAC;aACL;YACD,UAAU,EAAE,CACR,OAAkB,EAClB,SAAiC;gBAEjC,OAAO,IAAI,CAAC,aAAa,CACrB,IAAI,WAAW,CAAgB,WAAW,EAAE;oBACxC,MAAM,EAAE,EAAE,SAAS,EAAE;oBACrB,UAAU,EAAE,IAAI;oBAChB,OAAO,EAAE,IAAI;iBAChB,CAAC,CACL,CAAC;aACL;YACD,iBAAiB,EAAE;gBACf,IAAI,CAAC,aAAa,CACd,IAAI,KAAK,CAAC,0BAA0B,EAAE;oBAClC,UAAU,EAAE,KAAK;oBACjB,OAAO,EAAE,IAAI;iBAChB,CAAC,CACL,CAAC;aACL;YACD,oBAAoB,EAAE;gBAClB,IAAI,CAAC,aAAa,CACd,IAAI,KAAK,CAAC,kBAAkB,EAAE;oBAC1B,UAAU,EAAE,KAAK;oBACjB,OAAO,EAAE,IAAI;iBAChB,CAAC,CACL,CAAC;aACL;YACD,oBAAoB,EAAE;gBAClB,IAAI,CAAC,aAAa,CACd,IAAI,KAAK,CAAC,mBAAmB,EAAE;oBAC3B,UAAU,EAAE,KAAK;oBACjB,OAAO,EAAE,IAAI;iBAChB,CAAC,CACL,CAAC;aACL;YACD,uBAAuB,EAAE,CACrB,OAAkB,EAClB,QAAiB,EACjB,gBAA6B;gBAE7B,IAAI,CAAC,aAAa,CACd,IAAI,KAAK,CAAC,yBAAyB,EAAE;oBACjC,OAAO,EAAE,IAAI;oBACb,UAAU,EAAE,KAAK;iBACpB,CAAC,CACL,CAAC;aACL;YACD,GAAG,wBAAwB,CAAC,IAAI,CAAC;YACjC,IAAI,cAAc,CAAC,GAAG,CAAC,IAAI,CAAC;kBACtB,cAAc,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,OAAO;kBAChC,EAAE,CAAC;SACZ,CACJ,EAAC;QAEF,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,CAAC;;QAGjC,IAAI,yCAAgB,IAAI,CAAC,yCAAgB,KAAK,EAAE;YAC5C,uBAAA,IAAI,cAAc,IAAI,EAAC;YACvB,OAAO;SACV;QAED,yCAAgB,KAAK,CAAC,aAAa,CAAC,gBAAgB,CAChD,OAAO,EACP,CAAC,MAAM;YACH,IAAI,CAAC,KAAK,EAAE,CAAC;SAChB,EACD,IAAI,CACP,CAAC;QAEF,IAAI,cAAc,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;YAC1B,yCAAgB,KAAK,CAAC,kBAAkB,CACpC,EAAE,OAAO,EAAE,KAAK,EAAE,SAAS,EAAE,KAAK,EAAE,EACpC;gBACI,yCAAgB,QAAQ,CAAC,cAAc,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,CAAC;gBACzD,yCAAgB,SAAS,GAAG,cAAc,CAAC,GAAG,CAC1C,IAAI,CACP,CAAC,SAAS,CAAC;gBACZ,cAAc,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;aAC/B,CACJ,CAAC;SACL;;QAGD,IAAI,CAAC,aAAa,CACd,IAAI,KAAK,CAAC,OAAO,EAAE;YACf,UAAU,EAAE,KAAK;YACjB,OAAO,EAAE,IAAI;SAChB,CAAC,CACL,CAAC;KACL;;;;;IAMD,oBAAoB;;QAEhB,IAAI,CAAC,aAAa,CACd,IAAI,KAAK,CAAC,SAAS,EAAE;YACjB,UAAU,EAAE,KAAK;YACjB,OAAO,EAAE,IAAI;SAChB,CAAC,CACL,CAAC;QAEF,IAAI,yCAAgB;YAAE,OAAO;;QAG7B,MAAM,OAAO,GAAG,EAAE,CAAC;QACnB,MAAM,CAAC,IAAI,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;YACtD,OAAO,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,GAAG,yCAAgB,SAAS,CAC/C,WAAW,CAAC,CAAC,CAAQ,CACxB,CAAC;SACL,CAAC,CAAC;QACH,cAAc,CAAC,GAAG,CAAC,IAAI,EAAE;YACrB,KAAK,EAAE,yCAAgB,QAAQ,EAAE;YACjC,SAAS,EAAE,yCAAgB,SAAS;YACpC,OAAO;SACV,CAAC,CAAC;;QAGH,yCAAgB,OAAO,EAAE,CAAC;QAC1B,uBAAA,IAAI,cAAc,IAAI,EAAC;KAC1B;;;;;IAMD,eAAe,CAAC,IAAY;QACxB,IAAI,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE;YAC3B,MAAM,KAAK,GAAY,IAAI,CAAC,IAAI,CAAC,CAAC;;;;YAIlC,OAAO,IAAI,CAAC,IAAI,CAAC,CAAC;YAClB,IAAI,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC;SACtB;KACJ;;;;;IAMD,wBAAwB,CACpB,IAAY,EACZ,QAAiB,EACjB,QAAiB;QAEjB,IAAI,QAAQ,KAAK,QAAQ;YAAE,OAAO;QAClC,MAAM,QAAQ,GAAY,QAAQ,KAAK,IAAI,CAAC;QAC5C,QAAQ,IAAI;YACR,KAAK,UAAU;gBACX,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;gBACzB,MAAM;SACb;KACJ;IAED,IAAI,QAAQ,CAAC,KAAc;QACvB,MAAM,UAAU,GAAG,OAAO,CAAC,KAAK,CAAC,CAAC;QAClC,IAAI,UAAU;YAAE,IAAI,CAAC,YAAY,CAAC,UAAU,EAAE,EAAE,CAAC,CAAC;;YAC7C,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,CAAC;QAEtC,IAAI,CAAC,YAAY,CAAC,eAAe,EAAE,UAAU,GAAG,MAAM,GAAG,OAAO,CAAC,CAAC;QAClE,IAAI,CAAC,UAAU,CAAC,EAAE,QAAQ,EAAE,UAAU,EAAE,CAAC,CAAC;KAC7C;IAED,IAAI,QAAQ;QACR,OAAO,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;KACxC;;;;IAKD,IAAI,KAAK,CAAC,KAAa;QACnB,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;KACxB;;;;;;;;IASD,IAAI,KAAK;QACL,OAAO,IAAI,CAAC,QAAQ,EAAE,CAAC;KAC1B;;;;;;;;;;IAWD,IAAI,SAAS;QACT,8CAAqB;YACjB,OAAO,yCAAgB,SAAS,CAAC;SACpC;QACD,IAAI,cAAc,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;YAC1B,OAAO,cAAc,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,SAAS,CAAC;SAC7C;QACD,OAAO,EAAE,MAAM,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,SAAS,EAAE,SAAS,EAAE,CAAC;KACrD;;;;;IAMD,IAAI,SAAS,CAAC,KAAgB;QAC1B,8CAAqB;YACjB,yCAAgB,SAAS,GAAG,KAAK,CAAC;SACrC;QACD,IAAI,cAAc,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;YAC1B,cAAc,CAAC,GAAG,CAAC,IAAI,EAAE;gBACrB,KAAK,EAAE,cAAc,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,KAAK;gBACrC,SAAS,EAAE,KAAK;gBAChB,OAAO,EAAE,cAAc,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,OAAO;aAC5C,CAAC,CAAC;YACH,OAAO;SACV;QACD,cAAc,CAAC,GAAG,CAAC,IAAI,EAAE;YACrB,KAAK,EAAE,EAAE;YACT,SAAS,EAAE,KAAK;YAChB,OAAO,EAAE,wBAAwB,CAAC,IAAI,CAAC;SAC1C,CAAC,CAAC;KACN;;;;;;;IAQD,IAAI,QAAQ;QACR,OAAO,yCAAgB,KAAK,CAAC,QAAQ,CAAC;KACzC;;;;IAKD,IAAI,QAAQ,CAAC,MAAc;QACvB,yCAAgB,KAAK,CAAC,QAAQ,GAAG,MAAM,CAAC;KAC3C;;;;;IAMD,IAAI,UAAU;;QACV,qGAAwB,UAAU,mCAAI,CAAC,CAAC,CAAC;KAC5C;CACJ;;AAED,SAAS,WAAW,CAAC,CAAS;IAC1B,OAAO,CAAC;SACH,WAAW,EAAE;SACb,OAAO,CAAC,mBAAmB,EAAE,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,WAAW,EAAE,CAAC,CAAC;AACjE,CAAC;AAED,SAAS,iBAAiB,CAAC,EAAoB;IAC3C,MAAM,cAAc,GAAGA,UAAiB,EAAE,CAAC;IAC3C,MAAM,OAAO,GAAG,EAAE,CAAC,UAAU,EAAE,CAAC;IAChC,MAAM,CAAC,IAAI,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;QACtD,MAAM,IAAI,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC;QAC5B,IAAI,cAAc,CAAC,IAAI,CAAC,KAAK,OAAO,CAAC,IAAI,CAAC,EAAE;YACxC,IAAI,gBAAgB,CAAC,iBAAiB,CAAC,CAAC,CAAC,KAAK,SAAS,EAAE;gBACrD,IAAI,OAAO,CAAC,IAAI,CAAC,EAAE;;oBAEf,EAAE,CAAC,YAAY,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;iBAC1B;qBAAM;;oBAEH,EAAE,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;iBACzB;aACJ;iBAAM;;gBAEH,EAAE,CAAC,YAAY,CAAC,CAAC,EAAE,OAAO,CAAC,IAAI,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;aAChD;SACJ;KACJ,CAAC,CAAC;AACP,CAAC;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,SAAS,wBAAwB,CAC7B,GAAqB;IAErB,MAAM,MAAM,GAAG,EAAE,CAAC;IAClB,MAAM,OAAO,GAAG,gBAAgB,CAAC,iBAAiB,CAAC;IACnD,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;QAC3B,IAAI,GAAG,CAAC,YAAY,CAAC,CAAC,CAAC,EAAE;YACrB,MAAM,KAAK,GAAG,GAAG,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;YAClC,IAAI,OAAO,CAAC,CAAC,CAAC,KAAK,SAAS,EAAE;gBAC1B,MAAM,OAAO,GAAG,KAAK,CAAC,WAAW,EAAE,CAAC;gBACpC,IACI,OAAO,KAAK,MAAM;oBAClB,OAAO,KAAK,KAAK;oBACjB,OAAO,KAAK,IAAI,EAClB;oBACE,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC;iBACjC;qBAAM;oBACH,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC;iBAClC;aACJ;iBAAM,IAAI,OAAO,CAAC,CAAC,CAAC,KAAK,QAAQ,EAAE;gBAChC,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC,KAAK,CAAC,CAAC;aAC9C;iBAAM;gBACH,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC;aAClC;SACJ;KACJ,CAAC,CAAC;IACH,OAAO,MAAM,CAAC;AAClB,CAAC;AAWD,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,GAAG,CAAC,YAAY,CAAC,EAAE;IAC1C,MAAM,CAAC,gBAAgB,GAAG,gBAAgB,CAAC;IAC3C,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,YAAY,EAAE,gBAAgB,CAAC,CAAC;;;SCnkCjD,aAAa,CACzB,OAAoB,EACpB,UAAqC,EAAE;;IAEvC,OAAO,CAAC,SAAS,SAAG,OAAO,CAAC,SAAS,mCAAI,gBAAgB,CAAC;IAC1D,OAAO,CAAC,aAAa,SAAG,OAAO,CAAC,aAAa,mCAAI,oBAAoB,CAAC;IACtE,OAAO,IAAI,gBAAgB,CAAC,UAAU,CAAC,OAAO,CAAC,EAAE,OAAO,CAAC,CAAC;AAC9D,CAAC;AAED;AACA,SAASN,eAAa,CAClB,IAAY,EACZ,OAMC;IAED,OAAO,oBAAoB,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;AAC/C,CAAC;SAEe,oBAAoB,CAChC,IAAY,EACZ,OAMC;;IAED,OAAO,GAAG,OAAO,aAAP,OAAO,cAAP,OAAO,GAAI,EAAE,CAAC;IACxB,OAAO,CAAC,SAAS,GAAG,OAAO,CAAC,SAAS,IAAI,cAAc,CAAC;IACxD,OAAO,CAAC,gBAAgB,GAAG,OAAO,CAAC,gBAAgB,IAAI,MAAM,CAAC;IAC9D,OAAO,CAAC,MAAM,GAAG,EAAE,GAAG,MAAM,EAAE,UAAI,OAAO,CAAC,MAAM,mCAAI,EAAE,CAAC,EAAE,CAAC;;;;IAM1D,MAAM,KAAK,GAAG,WAAW,CACrB,IAAI,EACJ,MAAM,EACN,IAAI,EACJ,OAAO,CAAC,MAAM,EACd,KAAK,EACL,OAAO,CAAC,OAAO,CAClB,CAAC;;;;;IAMF,IAAI,KAAK,GAAG,IAAI,CAAC,MAAM,CACnB;QACI,SAAS,EAAE,UAAU,CAAC,OAAO,CAAC,SAAS,CAAC;QACxC,gBAAgB,EAAE,OAAO,CAAC,gBAAgB;KAC7C,EACD,KAAK,CACR,CAAC;;;;;;IAOF,KAAK,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC;;;;IAKxB,MAAM,OAAO,GAAG,UAAU,CAAC,QAAQ,CAAC,KAAK,EAAE,UAAU,CAAC,EAAE,cAAc,CAAC,CAAC;;;;IAMxE,OAAO,OAAO,CAAC,QAAQ,CAAC,EAAE,MAAM,EAAE,GAAG,EAAE,CAAC,CAAC;AAC7C,CAAC;SAEe,oBAAoB,CAChC,KAAa,EACb,UAIK,EAAE;;IAEP,OAAO,CAAC,MAAM,GAAG,EAAE,GAAG,MAAM,EAAE,UAAI,OAAO,CAAC,MAAM,mCAAI,EAAE,CAAC,EAAE,CAAC;IAE1D,OAAO,aAAa,CAChB,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,EAAE,EAAE,OAAO,CAAC,MAAM,EAAE,KAAK,EAAE,OAAO,CAAC,OAAO,CAAC,EACtE,OAAO,CACV,CAAC;AACN,CAAC;AAED;AACA,SAAS,aAAa,CAClB,KAAa,EACb,OAIE;IAEF,OAAO,oBAAoB,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;AAChD,CAAC;AAED;AACA,SAAS,UAAU,CACf,KAAa,EACb,OAGC;;IAED,OAAO,GAAG,OAAO,aAAP,OAAO,cAAP,OAAO,GAAI,EAAE,CAAC;IACxB,OAAO,CAAC,MAAM,GAAG,EAAE,GAAG,MAAM,EAAE,UAAI,OAAO,CAAC,MAAM,mCAAI,EAAE,CAAC,EAAE,CAAC;;IAI1D,OAAO,cAAc,CACjB,WAAW,CACP,KAAK,EACL,MAAM,EACN,IAAI,EACJ,OAAO,CAAC,MAAM,EACd,KAAK,EACL,OAAO,CAAC,OAAO,CAClB,EACD,OAAO,CACV,CAAC;AACN,CAAC;AAED;SACgB,UAAU,CACtB,IAAc,EACd,OAA6B;IAE7B,OAAO,WAAW,CACd,OAAO,IAAI,KAAK,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,IAAI,EAClD,OAAO,CACV,CAAC;;AAEN,CAAC;SAEe,2BAA2B,CACvC,KAAa,EACb,UAKI,EAAE;;IAEN,OAAO,CAAC,MAAM,SAAG,OAAO,CAAC,MAAM,mCAAI,EAAE,CAAC;IACtC,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;IAEtC,MAAM,QAAQ,GAAG,WAAW,CACxB,KAAK,EACL,MAAM,EACN,IAAI,EACJ,OAAO,CAAC,MAAM,EACd,KAAK,EACL,OAAO,CAAC,OAAO,CAClB,CAAC;IAEF,OAAO,mBAAmB,CACtB,QAAQ,EACR,OAAwC,CAC3C,CAAC;AACN,CAAC;AACD;AACA,SAAS,oBAAoB,CACzB,KAAa,EACb,OAKC;IAED,OAAO,2BAA2B,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;AACvD,CAAC;SAEe,oBAAoB,CAAC,OAAiC;IAClEY,qBAAmB,CAAC,QAAQ,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;AAChD,CAAC;AAED,SAAS,UAAU,CAAC,OAA6B;IAC7C,IAAI,OAAO,OAAO,KAAK,QAAQ,EAAE;QAC7B,MAAM,MAAM,GAAgB,QAAQ,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC;QAC7D,IAAI,MAAM,KAAK,IAAI,EAAE;YACjB,MAAM,KAAK,CAAC,wBAAwB,OAAO,uBAAuB,CAAC,CAAC;SACvE;QACD,OAAO,MAAM,CAAC;KACjB;IACD,OAAO,OAAO,CAAC;AACnB,CAAC;SAEeA,qBAAmB,CAC/B,OAAoB,EACpB,OAAiC;;IAEjC,OAAO,GAAG,OAAO,aAAP,OAAO,cAAP,OAAO,GAAI,EAAE,CAAC;IACxB,OAAO,CAAC,cAAc,SAAG,OAAO,CAAC,cAAc,mCAAI,oBAAoB,CAAC;IACxE,OAAO,CAAC,cAAc,SAAG,OAAO,CAAC,cAAc,mCAAI,oBAAoB,CAAC;IACxE,OAAO,CAAC,qBAAqB,SACzB,OAAO,CAAC,qBAAqB,mCAAI,2BAA2B,CAAC;IACjE,OAAO,CAAC,MAAM,SAAG,OAAO,CAAC,MAAM,mCAAI,MAAM,CAAC;IAC1C,UAAU,CAAC,mBAAmB,CAAC,UAAU,CAAC,OAAO,CAAC,EAAE,OAAO,CAAC,CAAC;AACjE,CAAC;AAED,SAAS,iBAAiB,CAAC,OAAO;IAC9B,IAAI,OAAO,OAAO,CAAC,SAAS,KAAK,QAAQ,EAAE;QACvC,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,EAAE;YACzC,MAAM,KAAK,CACP,iEAAiE,CACpE,CAAC;SACL;QACD,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,EAAE;YAC/B,OAAO,CAAC,SAAS,IAAI,GAAG,CAAC;SAC5B;KACJ;AACL,CAAC;AAED;AACA,SAAS,uBAAuB,CAC5B,OAA6B,EAC7B,OAAiC;;IAEjCC,YAAU,CAAC,yBAAyB,CAAC,CAAC;;;;;IAKtC,OAAO,GAAG,UAAU,CAAC,OAAO,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAgB,CAAC;IACzD,OAAO,GAAG,OAAO,aAAP,OAAO,cAAP,OAAO,GAAI,EAAE,CAAC;IACxB,iBAAiB,CAAC,OAAO,CAAC,CAAC;IAC3B,MAAM,IAAI,GAAG,OAAO,CAAC,YAAY,CAC7B,OAAO,UAAI,OAAO,CAAC,SAAS,mCAAI,EAAE,CAAC,GAAG,kBAAkB,CAC3D,CAAC;IACF,OAAO,CAAC,SAAS;QACb,OAAO,OAAO,CAAC,UAAU,KAAK,UAAU;cAClC,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC;cACxB,IAAI,CAAC;;AAEnB,CAAC;AAED;AACA,SAAS,kBAAkB,CACvB,OAA6B,EAC7B,OAAiC;;IAEjCA,YAAU,CAAC,oBAAoB,CAAC,CAAC;IACjC,IAAI,OAAO,YAAY,gBAAgB,EAAE;QACrC,OAAO,OAAO,CAAC,eAAe,CAAC;KAClC;;IAED,OAAO,GAAG,UAAU,CAAC,OAAO,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAgB,CAAC;IACzD,OAAO,GAAG,OAAO,aAAP,OAAO,cAAP,OAAO,GAAI,EAAE,CAAC;IACxB,iBAAiB,CAAC,OAAO,CAAC,CAAC;IAC3B,OAAO,OAAO,CAAC,YAAY,CACvB,OAAO,UAAI,OAAO,CAAC,SAAS,mCAAI,EAAE,CAAC,GAAG,kBAAkB,CAC3D,CAAC;AACN,CAAC;AAED;AACA,MAAM,OAAO,GAAG,iBAAiB,CAAC;AAElC,SAASA,YAAU,CAAC,MAAc;IAC9B,OAAO,CAAC,IAAI,CAAC,aAAa,MAAM,iBAAiB,CAAC,CAAC;AACvD,CAAC;MACY,KAAK,GAAG;IACjB,QAAQ,EAAE,aAAa,CAAC,QAAQ;IAChC,OAAO,EAAE,aAAa,CAAC,OAAO;IAC9B,YAAY,EAAE,aAAa,CAAC,YAAY;IACxC,QAAQ,EAAE,aAAa,CAAC,QAAQ;IAChC,gBAAgB,EAAE,aAAa,CAAC,gBAAgB;IAChD,gBAAgB,EAAE,aAAa,CAAC,gBAAgB;IAChD,SAAS,EAAE,aAAa,CAAC,SAAS;IAClC,YAAY,EAAE,aAAa,CAAC,YAAY;IACxC,YAAY,EAAE,aAAa,CAAC,YAAY;IACxC,YAAY,EAAE,aAAa,CAAC,YAAY;IACxC,MAAM,EAAE,aAAa,CAAC,MAAM;IAC5B,mBAAmB,EAAE,aAAa,CAAC,mBAAmB;IACtD,mBAAmB,EAAE,aAAa,CAAC,mBAAmB;EACxD;AAEF,eAAe;IACX,OAAO,EAAE;QACLA,YAAU,CAAC,wBAAwB,CAAC,CAAC;QACrC,OAAO,OAAO,CAAC;KAClB;IACD,aAAa,EAAE,CACX,IAAY,EACZ,OAMC;QAEDA,YAAU,CAAC,8BAA8B,CAAC,CAAC;QAC3C,OAAOb,eAAa,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;KACvC;IACD,aAAa,EAAE,CACX,KAAa,EACb,OAIE;QAEFa,YAAU,CAAC,8BAA8B,CAAC,CAAC;QAC3C,OAAO,aAAa,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;KACxC;IACD,oBAAoB,EAAE,CAClB,KAAa,EACb,OAKC;QAEDA,YAAU,CAAC,qCAAqC,CAAC,CAAC;QAClD,OAAO,oBAAoB,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;KAC/C;IACD,UAAU,EAAE,CACR,KAAa,EACb,OAGC;QAEDA,YAAU,CAAC,yCAAyC,CAAC,CAAC;QACtD,OAAO,UAAU,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;KACrC;IACD,UAAU,EAAE,CAAC,IAAc,EAAE,OAA6B;QACtDA,YAAU,CAAC,yCAAyC,CAAC,CAAC;QACtD,OAAO,UAAU,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;KACpC;IACD,aAAa,EAAE,CACX,OAAoB,EACpB,OAAkC;QAElCA,YAAU,CAAC,8BAA8B,CAAC,CAAC;QAC3C,OAAO,aAAa,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;KAC1C;IACD,oBAAoB,EAAE,CAAC,OAAkC;QACrDA,YAAU,CAAC,qCAAqC,CAAC,CAAC;QAClD,oBAAoB,CAAC,OAAO,CAAC,CAAC;KACjC;IACD,mBAAmB,EAAE,CACjB,EAAe,EACf,OAAiC;QAEjCA,YAAU,CAAC,oCAAoC,CAAC,CAAC;QACjDD,qBAAmB,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC;KACpC;IACD,uBAAuB,EAAE,CACrB,EAAwB,EACxB,OAAiC;QAEjCC,YAAU,CAAC,wCAAwC,CAAC,CAAC;QACrD,uBAAuB,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC;KACxC;IACD,kBAAkB,EAAE,CAChB,EAAwB,EACxB,OAAiC;QAEjCA,YAAU,CAAC,mCAAmC,CAAC,CAAC;QAChD,kBAAkB,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC;KACnC;IAED,SAAS,EAAE,CACP,OAAoB,EACpB,IAAY,EACZ,MAAiC;QAEjCA,YAAU,CAAC,0BAA0B,CAAC,CAAC;QACvC,OAAO,oBAAoB,CAAC,OAAO,EAAE,IAAI,EAAE,MAAM,CAAC,CAAC;KACtD;IACD,eAAe,EAAE;QACbA,YAAU,CAAC,gCAAgC,CAAC,CAAC;QAC7C,OAAO,eAAe,EAAE,CAAC;KAC5B;IACD,cAAc,EAAE;QACZA,YAAU,CAAC,+BAA+B,CAAC,CAAC;QAC5C,cAAc,EAAE,CAAC;KACpB;IACD,eAAe,EAAE;QACbA,YAAU,CAAC,gCAAgC,CAAC,CAAC;QAC7C,eAAe,EAAE,CAAC;KACrB;IACD,aAAa,EAAE,CAAC,KAAa,EAAE,KAAa;QACxCA,YAAU,CAAC,8BAA8B,CAAC,CAAC;QAC3C,aAAa,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;KAC/B;CACJ;;;;;"}